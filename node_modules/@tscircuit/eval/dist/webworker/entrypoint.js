var Bpt=Object.create;var Tx=Object.defineProperty;var Ypt=Object.getOwnPropertyDescriptor;var Xpt=Object.getOwnPropertyNames;var Upt=Object.getPrototypeOf,Vpt=Object.prototype.hasOwnProperty;var Gpt=(n,e,t)=>e in n?Tx(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Jy=(n=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(n,{get:(e,t)=>(typeof require<"u"?require:e)[t]}):n)(function(n){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+n+'" is not supported')});var qt=(n,e)=>()=>(n&&(e=n(n=0)),e);var ue=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),xh=(n,e)=>{for(var t in e)Tx(n,t,{get:e[t],enumerable:!0})},Hpt=(n,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of Xpt(e))!Vpt.call(n,r)&&r!==t&&Tx(n,r,{get:()=>e[r],enumerable:!(i=Ypt(e,r))||i.enumerable});return n};var Gt=(n,e,t)=>(t=n!=null?Bpt(Upt(n)):{},Hpt(e||!n||!n.__esModule?Tx(t,"default",{value:n,enumerable:!0}):t,n));var d=(n,e,t)=>Gpt(n,typeof e!="symbol"?e+"":e,t);var k$=ue(Ie=>{"use strict";var L3=Symbol.for("react.transitional.element"),cht=Symbol.for("react.portal"),lht=Symbol.for("react.fragment"),uht=Symbol.for("react.strict_mode"),pht=Symbol.for("react.profiler"),hht=Symbol.for("react.consumer"),dht=Symbol.for("react.context"),fht=Symbol.for("react.forward_ref"),mht=Symbol.for("react.suspense"),_ht=Symbol.for("react.memo"),x$=Symbol.for("react.lazy"),yht=Symbol.for("react.activity"),m$=Symbol.iterator;function ght(n){return n===null||typeof n!="object"?null:(n=m$&&n[m$]||n["@@iterator"],typeof n=="function"?n:null)}var b$={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v$=Object.assign,S$={};function vm(n,e,t){this.props=n,this.context=e,this.refs=S$,this.updater=t||b$}vm.prototype.isReactComponent={};vm.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};vm.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function w$(){}w$.prototype=vm.prototype;function F3(n,e,t){this.props=n,this.context=e,this.refs=S$,this.updater=t||b$}var z3=F3.prototype=new w$;z3.constructor=F3;v$(z3,vm.prototype);z3.isPureReactComponent=!0;var _$=Array.isArray;function O3(){}var $n={H:null,A:null,T:null,S:null},P$=Object.prototype.hasOwnProperty;function $3(n,e,t){var i=t.ref;return{$$typeof:L3,type:n,key:e,ref:i!==void 0?i:null,props:t}}function xht(n,e){return $3(n.type,e,n.props)}function D3(n){return typeof n=="object"&&n!==null&&n.$$typeof===L3}function bht(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var y$=/\/+/g;function R3(n,e){return typeof n=="object"&&n!==null&&n.key!=null?bht(""+n.key):e.toString(36)}function vht(n){switch(n.status){case"fulfilled":return n.value;case"rejected":throw n.reason;default:switch(typeof n.status=="string"?n.then(O3,O3):(n.status="pending",n.then(function(e){n.status==="pending"&&(n.status="fulfilled",n.value=e)},function(e){n.status==="pending"&&(n.status="rejected",n.reason=e)})),n.status){case"fulfilled":return n.value;case"rejected":throw n.reason}}throw n}function bm(n,e,t,i,r){var s=typeof n;(s==="undefined"||s==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(s){case"bigint":case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case L3:case cht:o=!0;break;case x$:return o=n._init,bm(o(n._payload),e,t,i,r)}}if(o)return r=r(n),o=i===""?"."+R3(n,0):i,_$(r)?(t="",o!=null&&(t=o.replace(y$,"$&/")+"/"),bm(r,e,t,"",function(l){return l})):r!=null&&(D3(r)&&(r=xht(r,t+(r.key==null||n&&n.key===r.key?"":(""+r.key).replace(y$,"$&/")+"/")+o)),e.push(r)),1;o=0;var a=i===""?".":i+":";if(_$(n))for(var c=0;c<n.length;c++)i=n[c],s=a+R3(i,c),o+=bm(i,e,t,s,r);else if(c=ght(n),typeof c=="function")for(n=c.call(n),c=0;!(i=n.next()).done;)i=i.value,s=a+R3(i,c++),o+=bm(i,e,t,s,r);else if(s==="object"){if(typeof n.then=="function")return bm(vht(n),e,t,i,r);throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.")}return o}function Rx(n,e,t){if(n==null)return n;var i=[],r=0;return bm(n,i,"","",function(s){return e.call(t,s,r++)}),i}function Sht(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var g$=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(e))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},wht={map:Rx,forEach:function(n,e,t){Rx(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Rx(n,function(){e++}),e},toArray:function(n){return Rx(n,function(e){return e})||[]},only:function(n){if(!D3(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};Ie.Activity=yht;Ie.Children=wht;Ie.Component=vm;Ie.Fragment=lht;Ie.Profiler=pht;Ie.PureComponent=F3;Ie.StrictMode=uht;Ie.Suspense=mht;Ie.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=$n;Ie.__COMPILER_RUNTIME={__proto__:null,c:function(n){return $n.H.useMemoCache(n)}};Ie.cache=function(n){return function(){return n.apply(null,arguments)}};Ie.cacheSignal=function(){return null};Ie.cloneElement=function(n,e,t){if(n==null)throw Error("The argument must be a React element, but you passed "+n+".");var i=v$({},n.props),r=n.key;if(e!=null)for(s in e.key!==void 0&&(r=""+e.key),e)!P$.call(e,s)||s==="key"||s==="__self"||s==="__source"||s==="ref"&&e.ref===void 0||(i[s]=e[s]);var s=arguments.length-2;if(s===1)i.children=t;else if(1<s){for(var o=Array(s),a=0;a<s;a++)o[a]=arguments[a+2];i.children=o}return $3(n.type,r,i)};Ie.createContext=function(n){return n={$$typeof:dht,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null},n.Provider=n,n.Consumer={$$typeof:hht,_context:n},n};Ie.createElement=function(n,e,t){var i,r={},s=null;if(e!=null)for(i in e.key!==void 0&&(s=""+e.key),e)P$.call(e,i)&&i!=="key"&&i!=="__self"&&i!=="__source"&&(r[i]=e[i]);var o=arguments.length-2;if(o===1)r.children=t;else if(1<o){for(var a=Array(o),c=0;c<o;c++)a[c]=arguments[c+2];r.children=a}if(n&&n.defaultProps)for(i in o=n.defaultProps,o)r[i]===void 0&&(r[i]=o[i]);return $3(n,s,r)};Ie.createRef=function(){return{current:null}};Ie.forwardRef=function(n){return{$$typeof:fht,render:n}};Ie.isValidElement=D3;Ie.lazy=function(n){return{$$typeof:x$,_payload:{_status:-1,_result:n},_init:Sht}};Ie.memo=function(n,e){return{$$typeof:_ht,type:n,compare:e===void 0?null:e}};Ie.startTransition=function(n){var e=$n.T,t={};$n.T=t;try{var i=n(),r=$n.S;r!==null&&r(t,i),typeof i=="object"&&i!==null&&typeof i.then=="function"&&i.then(O3,g$)}catch(s){g$(s)}finally{e!==null&&t.types!==null&&(e.types=t.types),$n.T=e}};Ie.unstable_useCacheRefresh=function(){return $n.H.useCacheRefresh()};Ie.use=function(n){return $n.H.use(n)};Ie.useActionState=function(n,e,t){return $n.H.useActionState(n,e,t)};Ie.useCallback=function(n,e){return $n.H.useCallback(n,e)};Ie.useContext=function(n){return $n.H.useContext(n)};Ie.useDebugValue=function(){};Ie.useDeferredValue=function(n,e){return $n.H.useDeferredValue(n,e)};Ie.useEffect=function(n,e){return $n.H.useEffect(n,e)};Ie.useEffectEvent=function(n){return $n.H.useEffectEvent(n)};Ie.useId=function(){return $n.H.useId()};Ie.useImperativeHandle=function(n,e,t){return $n.H.useImperativeHandle(n,e,t)};Ie.useInsertionEffect=function(n,e){return $n.H.useInsertionEffect(n,e)};Ie.useLayoutEffect=function(n,e){return $n.H.useLayoutEffect(n,e)};Ie.useMemo=function(n,e){return $n.H.useMemo(n,e)};Ie.useOptimistic=function(n,e){return $n.H.useOptimistic(n,e)};Ie.useReducer=function(n,e,t){return $n.H.useReducer(n,e,t)};Ie.useRef=function(n){return $n.H.useRef(n)};Ie.useState=function(n){return $n.H.useState(n)};Ie.useSyncExternalStore=function(n,e,t){return $n.H.useSyncExternalStore(n,e,t)};Ie.useTransition=function(){return $n.H.useTransition()};Ie.version="19.2.0"});var qs=ue((iXt,T$)=>{"use strict";T$.exports=k$()});var Ve,j3,Ht,Mo,Qy=qt(()=>{"use strict";(function(n){n.assertEqual=r=>{};function e(r){}n.assertIs=e;function t(r){throw new Error}n.assertNever=t,n.arrayToEnum=r=>{let s={};for(let o of r)s[o]=o;return s},n.getValidEnumValues=r=>{let s=n.objectKeys(r).filter(a=>typeof r[r[a]]!="number"),o={};for(let a of s)o[a]=r[a];return n.objectValues(o)},n.objectValues=r=>n.objectKeys(r).map(function(s){return r[s]}),n.objectKeys=typeof Object.keys=="function"?r=>Object.keys(r):r=>{let s=[];for(let o in r)Object.prototype.hasOwnProperty.call(r,o)&&s.push(o);return s},n.find=(r,s)=>{for(let o of r)if(s(o))return o},n.isInteger=typeof Number.isInteger=="function"?r=>Number.isInteger(r):r=>typeof r=="number"&&Number.isFinite(r)&&Math.floor(r)===r;function i(r,s=" | "){return r.map(o=>typeof o=="string"?`'${o}'`:o).join(s)}n.joinValues=i,n.jsonStringifyReplacer=(r,s)=>typeof s=="bigint"?s.toString():s})(Ve||(Ve={}));(function(n){n.mergeShapes=(e,t)=>({...e,...t})})(j3||(j3={}));Ht=Ve.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Mo=n=>{switch(typeof n){case"undefined":return Ht.undefined;case"string":return Ht.string;case"number":return Number.isNaN(n)?Ht.nan:Ht.number;case"boolean":return Ht.boolean;case"function":return Ht.function;case"bigint":return Ht.bigint;case"symbol":return Ht.symbol;case"object":return Array.isArray(n)?Ht.array:n===null?Ht.null:n.then&&typeof n.then=="function"&&n.catch&&typeof n.catch=="function"?Ht.promise:typeof Map<"u"&&n instanceof Map?Ht.map:typeof Set<"u"&&n instanceof Set?Ht.set:typeof Date<"u"&&n instanceof Date?Ht.date:Ht.object;default:return Ht.unknown}}});var Nt,Pht,Fr,Ox=qt(()=>{"use strict";Qy();Nt=Ve.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Pht=n=>JSON.stringify(n,null,2).replace(/"([^"]+)":/g,"$1:"),Fr=class n extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=i=>{this.issues=[...this.issues,i]},this.addIssues=(i=[])=>{this.issues=[...this.issues,...i]};let t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){let t=e||function(s){return s.message},i={_errors:[]},r=s=>{for(let o of s.issues)if(o.code==="invalid_union")o.unionErrors.map(r);else if(o.code==="invalid_return_type")r(o.returnTypeError);else if(o.code==="invalid_arguments")r(o.argumentsError);else if(o.path.length===0)i._errors.push(t(o));else{let a=i,c=0;for(;c<o.path.length;){let l=o.path[c];c===o.path.length-1?(a[l]=a[l]||{_errors:[]},a[l]._errors.push(t(o))):a[l]=a[l]||{_errors:[]},a=a[l],c++}}};return r(this),i}static assert(e){if(!(e instanceof n))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ve.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){let t={},i=[];for(let r of this.issues)if(r.path.length>0){let s=r.path[0];t[s]=t[s]||[],t[s].push(e(r))}else i.push(e(r));return{formErrors:i,fieldErrors:t}}get formErrors(){return this.flatten()}};Fr.create=n=>new Fr(n)});var kht,ya,B3=qt(()=>{"use strict";Ox();Qy();kht=(n,e)=>{let t;switch(n.code){case Nt.invalid_type:n.received===Ht.undefined?t="Required":t=`Expected ${n.expected}, received ${n.received}`;break;case Nt.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(n.expected,Ve.jsonStringifyReplacer)}`;break;case Nt.unrecognized_keys:t=`Unrecognized key(s) in object: ${Ve.joinValues(n.keys,", ")}`;break;case Nt.invalid_union:t="Invalid input";break;case Nt.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${Ve.joinValues(n.options)}`;break;case Nt.invalid_enum_value:t=`Invalid enum value. Expected ${Ve.joinValues(n.options)}, received '${n.received}'`;break;case Nt.invalid_arguments:t="Invalid function arguments";break;case Nt.invalid_return_type:t="Invalid function return type";break;case Nt.invalid_date:t="Invalid date";break;case Nt.invalid_string:typeof n.validation=="object"?"includes"in n.validation?(t=`Invalid input: must include "${n.validation.includes}"`,typeof n.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${n.validation.position}`)):"startsWith"in n.validation?t=`Invalid input: must start with "${n.validation.startsWith}"`:"endsWith"in n.validation?t=`Invalid input: must end with "${n.validation.endsWith}"`:Ve.assertNever(n.validation):n.validation!=="regex"?t=`Invalid ${n.validation}`:t="Invalid";break;case Nt.too_small:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at least":"more than"} ${n.minimum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at least":"over"} ${n.minimum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="bigint"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(n.minimum))}`:t="Invalid input";break;case Nt.too_big:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at most":"less than"} ${n.maximum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at most":"under"} ${n.maximum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="bigint"?t=`BigInt must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly":n.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(n.maximum))}`:t="Invalid input";break;case Nt.custom:t="Invalid input";break;case Nt.invalid_intersection_types:t="Intersection results could not be merged";break;case Nt.not_multiple_of:t=`Number must be a multiple of ${n.multipleOf}`;break;case Nt.not_finite:t="Number must be finite";break;default:t=e.defaultError,Ve.assertNever(n)}return{message:t}},ya=kht});function Tht(n){E$=n}function Sm(){return E$}var E$,Lx=qt(()=>{"use strict";B3();E$=ya});function Bt(n,e){let t=Sm(),i=tg({issueData:e,data:n.data,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,t,t===ya?void 0:ya].filter(r=>!!r)});n.common.issues.push(i)}var tg,Eht,Ji,ye,vh,ur,Fx,zx,Ac,wm,Y3=qt(()=>{"use strict";Lx();B3();tg=n=>{let{data:e,path:t,errorMaps:i,issueData:r}=n,s=[...t,...r.path||[]],o={...r,path:s};if(r.message!==void 0)return{...r,path:s,message:r.message};let a="",c=i.filter(l=>!!l).slice().reverse();for(let l of c)a=l(o,{data:e,defaultError:a}).message;return{...r,path:s,message:a}},Eht=[];Ji=class n{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){let i=[];for(let r of t){if(r.status==="aborted")return ye;r.status==="dirty"&&e.dirty(),i.push(r.value)}return{status:e.value,value:i}}static async mergeObjectAsync(e,t){let i=[];for(let r of t){let s=await r.key,o=await r.value;i.push({key:s,value:o})}return n.mergeObjectSync(e,i)}static mergeObjectSync(e,t){let i={};for(let r of t){let{key:s,value:o}=r;if(s.status==="aborted"||o.status==="aborted")return ye;s.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),s.value!=="__proto__"&&(typeof o.value<"u"||r.alwaysSet)&&(i[s.value]=o.value)}return{status:e.value,value:i}}},ye=Object.freeze({status:"aborted"}),vh=n=>({status:"dirty",value:n}),ur=n=>({status:"valid",value:n}),Fx=n=>n.status==="aborted",zx=n=>n.status==="dirty",Ac=n=>n.status==="valid",wm=n=>typeof Promise<"u"&&n instanceof Promise});var M$=qt(()=>{"use strict"});var se,C$=qt(()=>{"use strict";(function(n){n.errToObj=e=>typeof e=="string"?{message:e}:e||{},n.toString=e=>typeof e=="string"?e:e?.message})(se||(se={}))});function Ne(n){if(!n)return{};let{errorMap:e,invalid_type_error:t,required_error:i,description:r}=n;if(e&&(t||i))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:r}:{errorMap:(o,a)=>{let{message:c}=n;return o.code==="invalid_enum_value"?{message:c??a.defaultError}:typeof a.data>"u"?{message:c??i??a.defaultError}:o.code!=="invalid_type"?{message:a.defaultError}:{message:c??t??a.defaultError}},description:r}}function R$(n){let e="[0-5]\\d";n.precision?e=`${e}\\.\\d{${n.precision}}`:n.precision==null&&(e=`${e}(\\.\\d+)?`);let t=n.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${t}`}function Uht(n){return new RegExp(`^${R$(n)}$`)}function O$(n){let e=`${A$}T${R$(n)}`,t=[];return t.push(n.local?"Z?":"Z"),n.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function Vht(n,e){return!!((e==="v4"||!e)&&zht.test(n)||(e==="v6"||!e)&&Dht.test(n))}function Ght(n,e){if(!Rht.test(n))return!1;try{let[t]=n.split(".");if(!t)return!1;let i=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),r=JSON.parse(atob(i));return!(typeof r!="object"||r===null||"typ"in r&&r?.typ!=="JWT"||!r.alg||e&&r.alg!==e)}catch{return!1}}function Hht(n,e){return!!((e==="v4"||!e)&&$ht.test(n)||(e==="v6"||!e)&&jht.test(n))}function Wht(n,e){let t=(n.toString().split(".")[1]||"").length,i=(e.toString().split(".")[1]||"").length,r=t>i?t:i,s=Number.parseInt(n.toFixed(r).replace(".","")),o=Number.parseInt(e.toFixed(r).replace(".",""));return s%o/10**r}function Pm(n){if(n instanceof zr){let e={};for(let t in n.shape){let i=n.shape[t];e[t]=ws.create(Pm(i))}return new zr({...n._def,shape:()=>e})}else return n instanceof ba?new ba({...n._def,type:Pm(n.element)}):n instanceof ws?ws.create(Pm(n.unwrap())):n instanceof Io?Io.create(Pm(n.unwrap())):n instanceof Co?Co.create(n.items.map(e=>Pm(e))):n}function U3(n,e){let t=Mo(n),i=Mo(e);if(n===e)return{valid:!0,data:n};if(t===Ht.object&&i===Ht.object){let r=Ve.objectKeys(e),s=Ve.objectKeys(n).filter(a=>r.indexOf(a)!==-1),o={...n,...e};for(let a of s){let c=U3(n[a],e[a]);if(!c.valid)return{valid:!1};o[a]=c.data}return{valid:!0,data:o}}else if(t===Ht.array&&i===Ht.array){if(n.length!==e.length)return{valid:!1};let r=[];for(let s=0;s<n.length;s++){let o=n[s],a=e[s],c=U3(o,a);if(!c.valid)return{valid:!1};r.push(c.data)}return{valid:!0,data:r}}else return t===Ht.date&&i===Ht.date&&+n==+e?{valid:!0,data:n}:{valid:!1}}function L$(n,e){return new Ah({values:n,typeName:we.ZodEnum,...Ne(e)})}function N$(n,e){let t=typeof n=="function"?n(e):typeof n=="string"?{message:n}:n;return typeof t=="string"?{message:t}:t}function F$(n,e={},t){return n?Oc.create().superRefine((i,r)=>{let s=n(i);if(s instanceof Promise)return s.then(o=>{if(!o){let a=N$(e,i),c=a.fatal??t??!0;r.addIssue({code:"custom",...a,fatal:c})}});if(!s){let o=N$(e,i),a=o.fatal??t??!0;r.addIssue({code:"custom",...o,fatal:a})}}):Oc.create()}var Ps,I$,ze,Mht,Cht,Iht,Nht,Aht,Rht,Oht,Lht,Fht,X3,zht,$ht,Dht,jht,Bht,Yht,A$,Xht,Rc,Sh,wh,Ph,kh,km,Th,Eh,Oc,xa,Zs,Tm,ba,zr,Mh,ga,$x,Ch,Co,Dx,Em,Mm,jx,Ih,Nh,Ah,Rh,Lc,ks,ws,Io,Oh,Lh,Cm,qht,eg,ng,Fh,Zht,we,Kht,z$,$$,Jht,Qht,D$,tdt,edt,ndt,idt,rdt,sdt,odt,adt,cdt,ldt,udt,pdt,hdt,ddt,fdt,mdt,_dt,ydt,gdt,xdt,bdt,vdt,Sdt,wdt,Pdt,kdt,Tdt,Edt,Mdt,Cdt,Idt,Ndt,Adt,Rdt,j$=qt(()=>{"use strict";Ox();Lx();C$();Y3();Qy();Ps=class{constructor(e,t,i,r){this._cachedPath=[],this.parent=e,this.data=t,this._path=i,this._key=r}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},I$=(n,e)=>{if(Ac(e))return{success:!0,data:e.value};if(!n.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new Fr(n.common.issues);return this._error=t,this._error}}};ze=class{get description(){return this._def.description}_getType(e){return Mo(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Mo(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ji,ctx:{common:e.parent.common,data:e.data,parsedType:Mo(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if(wm(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){let t=this._parse(e);return Promise.resolve(t)}parse(e,t){let i=this.safeParse(e,t);if(i.success)return i.data;throw i.error}safeParse(e,t){let i={common:{issues:[],async:t?.async??!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Mo(e)},r=this._parseSync({data:e,path:i.path,parent:i});return I$(i,r)}"~validate"(e){let t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Mo(e)};if(!this["~standard"].async)try{let i=this._parseSync({data:e,path:[],parent:t});return Ac(i)?{value:i.value}:{issues:t.common.issues}}catch(i){i?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(i=>Ac(i)?{value:i.value}:{issues:t.common.issues})}async parseAsync(e,t){let i=await this.safeParseAsync(e,t);if(i.success)return i.data;throw i.error}async safeParseAsync(e,t){let i={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Mo(e)},r=this._parse({data:e,path:i.path,parent:i}),s=await(wm(r)?r:Promise.resolve(r));return I$(i,s)}refine(e,t){let i=r=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(r):t;return this._refinement((r,s)=>{let o=e(r),a=()=>s.addIssue({code:Nt.custom,...i(r)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,t){return this._refinement((i,r)=>e(i)?!0:(r.addIssue(typeof t=="function"?t(i,r):t),!1))}_refinement(e){return new ks({schema:this,typeName:we.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return ws.create(this,this._def)}nullable(){return Io.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ba.create(this)}promise(){return Lc.create(this,this._def)}or(e){return Mh.create([this,e],this._def)}and(e){return Ch.create(this,e,this._def)}transform(e){return new ks({...Ne(this._def),schema:this,typeName:we.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let t=typeof e=="function"?e:()=>e;return new Oh({...Ne(this._def),innerType:this,defaultValue:t,typeName:we.ZodDefault})}brand(){return new eg({typeName:we.ZodBranded,type:this,...Ne(this._def)})}catch(e){let t=typeof e=="function"?e:()=>e;return new Lh({...Ne(this._def),innerType:this,catchValue:t,typeName:we.ZodCatch})}describe(e){let t=this.constructor;return new t({...this._def,description:e})}pipe(e){return ng.create(this,e)}readonly(){return Fh.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},Mht=/^c[^\s-]{8,}$/i,Cht=/^[0-9a-z]+$/,Iht=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Nht=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Aht=/^[a-z0-9_-]{21}$/i,Rht=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Oht=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Lht=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Fht="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",zht=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,$ht=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Dht=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,jht=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Bht=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Yht=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,A$="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Xht=new RegExp(`^${A$}$`);Rc=class n extends ze{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==Ht.string){let s=this._getOrReturnCtx(e);return Bt(s,{code:Nt.invalid_type,expected:Ht.string,received:s.parsedType}),ye}let i=new Ji,r;for(let s of this._def.checks)if(s.kind==="min")e.data.length<s.value&&(r=this._getOrReturnCtx(e,r),Bt(r,{code:Nt.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),i.dirty());else if(s.kind==="max")e.data.length>s.value&&(r=this._getOrReturnCtx(e,r),Bt(r,{code:Nt.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),i.dirty());else if(s.kind==="length"){let o=e.data.length>s.value,a=e.data.length<s.value;(o||a)&&(r=this._getOrReturnCtx(e,r),o?Bt(r,{code:Nt.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):a&&Bt(r,{code:Nt.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),i.dirty())}else if(s.kind==="email")Lht.test(e.data)||(r=this._getOrReturnCtx(e,r),Bt(r,{validation:"email",code:Nt.invalid_string,message:s.message}),i.dirty());else if(s.kind==="emoji")X3||(X3=new RegExp(Fht,"u")),X3.test(e.data)||(r=this._getOrReturnCtx(e,r),Bt(r,{validation:"emoji",code:Nt.invalid_string,message:s.message}),i.dirty());else if(s.kind==="uuid")Nht.test(e.data)||(r=this._getOrReturnCtx(e,r),Bt(r,{validation:"uuid",code:Nt.invalid_string,message:s.message}),i.dirty());else if(s.kind==="nanoid")Aht.test(e.data)||(r=this._getOrReturnCtx(e,r),Bt(r,{validation:"nanoid",code:Nt.invalid_string,message:s.message}),i.dirty());else if(s.kind==="cuid")Mht.test(e.data)||(r=this._getOrReturnCtx(e,r),Bt(r,{validation:"cuid",code:Nt.invalid_string,message:s.message}),i.dirty());else if(s.kind==="cuid2")Cht.test(e.data)||(r=this._getOrReturnCtx(e,r),Bt(r,{validation:"cuid2",code:Nt.invalid_string,message:s.message}),i.dirty());else if(s.kind==="ulid")Iht.test(e.data)||(r=this._getOrReturnCtx(e,r),Bt(r,{validation:"ulid",code:Nt.invalid_string,message:s.message}),i.dirty());else if(s.kind==="url")try{new URL(e.data)}catch{r=this._getOrReturnCtx(e,r),Bt(r,{validation:"url",code:Nt.invalid_string,message:s.message}),i.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),Bt(r,{validation:"regex",code:Nt.invalid_string,message:s.message}),i.dirty())):s.kind==="trim"?e.data=e.data.trim():s.kind==="includes"?e.data.includes(s.value,s.position)||(r=this._getOrReturnCtx(e,r),Bt(r,{code:Nt.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),i.dirty()):s.kind==="toLowerCase"?e.data=e.data.toLowerCase():s.kind==="toUpperCase"?e.data=e.data.toUpperCase():s.kind==="startsWith"?e.data.startsWith(s.value)||(r=this._getOrReturnCtx(e,r),Bt(r,{code:Nt.invalid_string,validation:{startsWith:s.value},message:s.message}),i.dirty()):s.kind==="endsWith"?e.data.endsWith(s.value)||(r=this._getOrReturnCtx(e,r),Bt(r,{code:Nt.invalid_string,validation:{endsWith:s.value},message:s.message}),i.dirty()):s.kind==="datetime"?O$(s).test(e.data)||(r=this._getOrReturnCtx(e,r),Bt(r,{code:Nt.invalid_string,validation:"datetime",message:s.message}),i.dirty()):s.kind==="date"?Xht.test(e.data)||(r=this._getOrReturnCtx(e,r),Bt(r,{code:Nt.invalid_string,validation:"date",message:s.message}),i.dirty()):s.kind==="time"?Uht(s).test(e.data)||(r=this._getOrReturnCtx(e,r),Bt(r,{code:Nt.invalid_string,validation:"time",message:s.message}),i.dirty()):s.kind==="duration"?Oht.test(e.data)||(r=this._getOrReturnCtx(e,r),Bt(r,{validation:"duration",code:Nt.invalid_string,message:s.message}),i.dirty()):s.kind==="ip"?Vht(e.data,s.version)||(r=this._getOrReturnCtx(e,r),Bt(r,{validation:"ip",code:Nt.invalid_string,message:s.message}),i.dirty()):s.kind==="jwt"?Ght(e.data,s.alg)||(r=this._getOrReturnCtx(e,r),Bt(r,{validation:"jwt",code:Nt.invalid_string,message:s.message}),i.dirty()):s.kind==="cidr"?Hht(e.data,s.version)||(r=this._getOrReturnCtx(e,r),Bt(r,{validation:"cidr",code:Nt.invalid_string,message:s.message}),i.dirty()):s.kind==="base64"?Bht.test(e.data)||(r=this._getOrReturnCtx(e,r),Bt(r,{validation:"base64",code:Nt.invalid_string,message:s.message}),i.dirty()):s.kind==="base64url"?Yht.test(e.data)||(r=this._getOrReturnCtx(e,r),Bt(r,{validation:"base64url",code:Nt.invalid_string,message:s.message}),i.dirty()):Ve.assertNever(s);return{status:i.value,value:e.data}}_regex(e,t,i){return this.refinement(r=>e.test(r),{validation:t,code:Nt.invalid_string,...se.errToObj(i)})}_addCheck(e){return new n({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...se.errToObj(e)})}url(e){return this._addCheck({kind:"url",...se.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...se.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...se.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...se.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...se.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...se.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...se.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...se.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...se.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...se.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...se.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...se.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...se.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...se.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...se.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...se.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...se.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...se.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...se.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...se.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...se.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...se.errToObj(t)})}nonempty(e){return this.min(1,se.errToObj(e))}trim(){return new n({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new n({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new n({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}};Rc.create=n=>new Rc({checks:[],typeName:we.ZodString,coerce:n?.coerce??!1,...Ne(n)});Sh=class n extends ze{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==Ht.number){let s=this._getOrReturnCtx(e);return Bt(s,{code:Nt.invalid_type,expected:Ht.number,received:s.parsedType}),ye}let i,r=new Ji;for(let s of this._def.checks)s.kind==="int"?Ve.isInteger(e.data)||(i=this._getOrReturnCtx(e,i),Bt(i,{code:Nt.invalid_type,expected:"integer",received:"float",message:s.message}),r.dirty()):s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(i=this._getOrReturnCtx(e,i),Bt(i,{code:Nt.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),r.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(i=this._getOrReturnCtx(e,i),Bt(i,{code:Nt.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),r.dirty()):s.kind==="multipleOf"?Wht(e.data,s.value)!==0&&(i=this._getOrReturnCtx(e,i),Bt(i,{code:Nt.not_multiple_of,multipleOf:s.value,message:s.message}),r.dirty()):s.kind==="finite"?Number.isFinite(e.data)||(i=this._getOrReturnCtx(e,i),Bt(i,{code:Nt.not_finite,message:s.message}),r.dirty()):Ve.assertNever(s);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,se.toString(t))}gt(e,t){return this.setLimit("min",e,!1,se.toString(t))}lte(e,t){return this.setLimit("max",e,!0,se.toString(t))}lt(e,t){return this.setLimit("max",e,!1,se.toString(t))}setLimit(e,t,i,r){return new n({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:i,message:se.toString(r)}]})}_addCheck(e){return new n({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:se.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:se.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:se.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:se.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:se.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:se.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:se.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:se.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:se.toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Ve.isInteger(e.value))}get isFinite(){let e=null,t=null;for(let i of this._def.checks){if(i.kind==="finite"||i.kind==="int"||i.kind==="multipleOf")return!0;i.kind==="min"?(t===null||i.value>t)&&(t=i.value):i.kind==="max"&&(e===null||i.value<e)&&(e=i.value)}return Number.isFinite(t)&&Number.isFinite(e)}};Sh.create=n=>new Sh({checks:[],typeName:we.ZodNumber,coerce:n?.coerce||!1,...Ne(n)});wh=class n extends ze{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==Ht.bigint)return this._getInvalidInput(e);let i,r=new Ji;for(let s of this._def.checks)s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(i=this._getOrReturnCtx(e,i),Bt(i,{code:Nt.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),r.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(i=this._getOrReturnCtx(e,i),Bt(i,{code:Nt.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),r.dirty()):s.kind==="multipleOf"?e.data%s.value!==BigInt(0)&&(i=this._getOrReturnCtx(e,i),Bt(i,{code:Nt.not_multiple_of,multipleOf:s.value,message:s.message}),r.dirty()):Ve.assertNever(s);return{status:r.value,value:e.data}}_getInvalidInput(e){let t=this._getOrReturnCtx(e);return Bt(t,{code:Nt.invalid_type,expected:Ht.bigint,received:t.parsedType}),ye}gte(e,t){return this.setLimit("min",e,!0,se.toString(t))}gt(e,t){return this.setLimit("min",e,!1,se.toString(t))}lte(e,t){return this.setLimit("max",e,!0,se.toString(t))}lt(e,t){return this.setLimit("max",e,!1,se.toString(t))}setLimit(e,t,i,r){return new n({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:i,message:se.toString(r)}]})}_addCheck(e){return new n({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:se.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:se.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:se.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:se.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:se.toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}};wh.create=n=>new wh({checks:[],typeName:we.ZodBigInt,coerce:n?.coerce??!1,...Ne(n)});Ph=class extends ze{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==Ht.boolean){let i=this._getOrReturnCtx(e);return Bt(i,{code:Nt.invalid_type,expected:Ht.boolean,received:i.parsedType}),ye}return ur(e.data)}};Ph.create=n=>new Ph({typeName:we.ZodBoolean,coerce:n?.coerce||!1,...Ne(n)});kh=class n extends ze{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==Ht.date){let s=this._getOrReturnCtx(e);return Bt(s,{code:Nt.invalid_type,expected:Ht.date,received:s.parsedType}),ye}if(Number.isNaN(e.data.getTime())){let s=this._getOrReturnCtx(e);return Bt(s,{code:Nt.invalid_date}),ye}let i=new Ji,r;for(let s of this._def.checks)s.kind==="min"?e.data.getTime()<s.value&&(r=this._getOrReturnCtx(e,r),Bt(r,{code:Nt.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),i.dirty()):s.kind==="max"?e.data.getTime()>s.value&&(r=this._getOrReturnCtx(e,r),Bt(r,{code:Nt.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),i.dirty()):Ve.assertNever(s);return{status:i.value,value:new Date(e.data.getTime())}}_addCheck(e){return new n({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:se.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:se.toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}};kh.create=n=>new kh({checks:[],coerce:n?.coerce||!1,typeName:we.ZodDate,...Ne(n)});km=class extends ze{_parse(e){if(this._getType(e)!==Ht.symbol){let i=this._getOrReturnCtx(e);return Bt(i,{code:Nt.invalid_type,expected:Ht.symbol,received:i.parsedType}),ye}return ur(e.data)}};km.create=n=>new km({typeName:we.ZodSymbol,...Ne(n)});Th=class extends ze{_parse(e){if(this._getType(e)!==Ht.undefined){let i=this._getOrReturnCtx(e);return Bt(i,{code:Nt.invalid_type,expected:Ht.undefined,received:i.parsedType}),ye}return ur(e.data)}};Th.create=n=>new Th({typeName:we.ZodUndefined,...Ne(n)});Eh=class extends ze{_parse(e){if(this._getType(e)!==Ht.null){let i=this._getOrReturnCtx(e);return Bt(i,{code:Nt.invalid_type,expected:Ht.null,received:i.parsedType}),ye}return ur(e.data)}};Eh.create=n=>new Eh({typeName:we.ZodNull,...Ne(n)});Oc=class extends ze{constructor(){super(...arguments),this._any=!0}_parse(e){return ur(e.data)}};Oc.create=n=>new Oc({typeName:we.ZodAny,...Ne(n)});xa=class extends ze{constructor(){super(...arguments),this._unknown=!0}_parse(e){return ur(e.data)}};xa.create=n=>new xa({typeName:we.ZodUnknown,...Ne(n)});Zs=class extends ze{_parse(e){let t=this._getOrReturnCtx(e);return Bt(t,{code:Nt.invalid_type,expected:Ht.never,received:t.parsedType}),ye}};Zs.create=n=>new Zs({typeName:we.ZodNever,...Ne(n)});Tm=class extends ze{_parse(e){if(this._getType(e)!==Ht.undefined){let i=this._getOrReturnCtx(e);return Bt(i,{code:Nt.invalid_type,expected:Ht.void,received:i.parsedType}),ye}return ur(e.data)}};Tm.create=n=>new Tm({typeName:we.ZodVoid,...Ne(n)});ba=class n extends ze{_parse(e){let{ctx:t,status:i}=this._processInputParams(e),r=this._def;if(t.parsedType!==Ht.array)return Bt(t,{code:Nt.invalid_type,expected:Ht.array,received:t.parsedType}),ye;if(r.exactLength!==null){let o=t.data.length>r.exactLength.value,a=t.data.length<r.exactLength.value;(o||a)&&(Bt(t,{code:o?Nt.too_big:Nt.too_small,minimum:a?r.exactLength.value:void 0,maximum:o?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),i.dirty())}if(r.minLength!==null&&t.data.length<r.minLength.value&&(Bt(t,{code:Nt.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),i.dirty()),r.maxLength!==null&&t.data.length>r.maxLength.value&&(Bt(t,{code:Nt.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),i.dirty()),t.common.async)return Promise.all([...t.data].map((o,a)=>r.type._parseAsync(new Ps(t,o,t.path,a)))).then(o=>Ji.mergeArray(i,o));let s=[...t.data].map((o,a)=>r.type._parseSync(new Ps(t,o,t.path,a)));return Ji.mergeArray(i,s)}get element(){return this._def.type}min(e,t){return new n({...this._def,minLength:{value:e,message:se.toString(t)}})}max(e,t){return new n({...this._def,maxLength:{value:e,message:se.toString(t)}})}length(e,t){return new n({...this._def,exactLength:{value:e,message:se.toString(t)}})}nonempty(e){return this.min(1,e)}};ba.create=(n,e)=>new ba({type:n,minLength:null,maxLength:null,exactLength:null,typeName:we.ZodArray,...Ne(e)});zr=class n extends ze{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),t=Ve.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==Ht.object){let l=this._getOrReturnCtx(e);return Bt(l,{code:Nt.invalid_type,expected:Ht.object,received:l.parsedType}),ye}let{status:i,ctx:r}=this._processInputParams(e),{shape:s,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof Zs&&this._def.unknownKeys==="strip"))for(let l in r.data)o.includes(l)||a.push(l);let c=[];for(let l of o){let u=s[l],p=r.data[l];c.push({key:{status:"valid",value:l},value:u._parse(new Ps(r,p,r.path,l)),alwaysSet:l in r.data})}if(this._def.catchall instanceof Zs){let l=this._def.unknownKeys;if(l==="passthrough")for(let u of a)c.push({key:{status:"valid",value:u},value:{status:"valid",value:r.data[u]}});else if(l==="strict")a.length>0&&(Bt(r,{code:Nt.unrecognized_keys,keys:a}),i.dirty());else if(l!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let l=this._def.catchall;for(let u of a){let p=r.data[u];c.push({key:{status:"valid",value:u},value:l._parse(new Ps(r,p,r.path,u)),alwaysSet:u in r.data})}}return r.common.async?Promise.resolve().then(async()=>{let l=[];for(let u of c){let p=await u.key,f=await u.value;l.push({key:p,value:f,alwaysSet:u.alwaysSet})}return l}).then(l=>Ji.mergeObjectSync(i,l)):Ji.mergeObjectSync(i,c)}get shape(){return this._def.shape()}strict(e){return se.errToObj,new n({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,i)=>{let r=this._def.errorMap?.(t,i).message??i.defaultError;return t.code==="unrecognized_keys"?{message:se.errToObj(e).message??r}:{message:r}}}:{}})}strip(){return new n({...this._def,unknownKeys:"strip"})}passthrough(){return new n({...this._def,unknownKeys:"passthrough"})}extend(e){return new n({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new n({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:we.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new n({...this._def,catchall:e})}pick(e){let t={};for(let i of Ve.objectKeys(e))e[i]&&this.shape[i]&&(t[i]=this.shape[i]);return new n({...this._def,shape:()=>t})}omit(e){let t={};for(let i of Ve.objectKeys(this.shape))e[i]||(t[i]=this.shape[i]);return new n({...this._def,shape:()=>t})}deepPartial(){return Pm(this)}partial(e){let t={};for(let i of Ve.objectKeys(this.shape)){let r=this.shape[i];e&&!e[i]?t[i]=r:t[i]=r.optional()}return new n({...this._def,shape:()=>t})}required(e){let t={};for(let i of Ve.objectKeys(this.shape))if(e&&!e[i])t[i]=this.shape[i];else{let s=this.shape[i];for(;s instanceof ws;)s=s._def.innerType;t[i]=s}return new n({...this._def,shape:()=>t})}keyof(){return L$(Ve.objectKeys(this.shape))}};zr.create=(n,e)=>new zr({shape:()=>n,unknownKeys:"strip",catchall:Zs.create(),typeName:we.ZodObject,...Ne(e)});zr.strictCreate=(n,e)=>new zr({shape:()=>n,unknownKeys:"strict",catchall:Zs.create(),typeName:we.ZodObject,...Ne(e)});zr.lazycreate=(n,e)=>new zr({shape:n,unknownKeys:"strip",catchall:Zs.create(),typeName:we.ZodObject,...Ne(e)});Mh=class extends ze{_parse(e){let{ctx:t}=this._processInputParams(e),i=this._def.options;function r(s){for(let a of s)if(a.result.status==="valid")return a.result;for(let a of s)if(a.result.status==="dirty")return t.common.issues.push(...a.ctx.common.issues),a.result;let o=s.map(a=>new Fr(a.ctx.common.issues));return Bt(t,{code:Nt.invalid_union,unionErrors:o}),ye}if(t.common.async)return Promise.all(i.map(async s=>{let o={...t,common:{...t.common,issues:[]},parent:null};return{result:await s._parseAsync({data:t.data,path:t.path,parent:o}),ctx:o}})).then(r);{let s,o=[];for(let c of i){let l={...t,common:{...t.common,issues:[]},parent:null},u=c._parseSync({data:t.data,path:t.path,parent:l});if(u.status==="valid")return u;u.status==="dirty"&&!s&&(s={result:u,ctx:l}),l.common.issues.length&&o.push(l.common.issues)}if(s)return t.common.issues.push(...s.ctx.common.issues),s.result;let a=o.map(c=>new Fr(c));return Bt(t,{code:Nt.invalid_union,unionErrors:a}),ye}}get options(){return this._def.options}};Mh.create=(n,e)=>new Mh({options:n,typeName:we.ZodUnion,...Ne(e)});ga=n=>n instanceof Ih?ga(n.schema):n instanceof ks?ga(n.innerType()):n instanceof Nh?[n.value]:n instanceof Ah?n.options:n instanceof Rh?Ve.objectValues(n.enum):n instanceof Oh?ga(n._def.innerType):n instanceof Th?[void 0]:n instanceof Eh?[null]:n instanceof ws?[void 0,...ga(n.unwrap())]:n instanceof Io?[null,...ga(n.unwrap())]:n instanceof eg||n instanceof Fh?ga(n.unwrap()):n instanceof Lh?ga(n._def.innerType):[],$x=class n extends ze{_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==Ht.object)return Bt(t,{code:Nt.invalid_type,expected:Ht.object,received:t.parsedType}),ye;let i=this.discriminator,r=t.data[i],s=this.optionsMap.get(r);return s?t.common.async?s._parseAsync({data:t.data,path:t.path,parent:t}):s._parseSync({data:t.data,path:t.path,parent:t}):(Bt(t,{code:Nt.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[i]}),ye)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,i){let r=new Map;for(let s of t){let o=ga(s.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let a of o){if(r.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);r.set(a,s)}}return new n({typeName:we.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:r,...Ne(i)})}};Ch=class extends ze{_parse(e){let{status:t,ctx:i}=this._processInputParams(e),r=(s,o)=>{if(Fx(s)||Fx(o))return ye;let a=U3(s.value,o.value);return a.valid?((zx(s)||zx(o))&&t.dirty(),{status:t.value,value:a.data}):(Bt(i,{code:Nt.invalid_intersection_types}),ye)};return i.common.async?Promise.all([this._def.left._parseAsync({data:i.data,path:i.path,parent:i}),this._def.right._parseAsync({data:i.data,path:i.path,parent:i})]).then(([s,o])=>r(s,o)):r(this._def.left._parseSync({data:i.data,path:i.path,parent:i}),this._def.right._parseSync({data:i.data,path:i.path,parent:i}))}};Ch.create=(n,e,t)=>new Ch({left:n,right:e,typeName:we.ZodIntersection,...Ne(t)});Co=class n extends ze{_parse(e){let{status:t,ctx:i}=this._processInputParams(e);if(i.parsedType!==Ht.array)return Bt(i,{code:Nt.invalid_type,expected:Ht.array,received:i.parsedType}),ye;if(i.data.length<this._def.items.length)return Bt(i,{code:Nt.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),ye;!this._def.rest&&i.data.length>this._def.items.length&&(Bt(i,{code:Nt.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let s=[...i.data].map((o,a)=>{let c=this._def.items[a]||this._def.rest;return c?c._parse(new Ps(i,o,i.path,a)):null}).filter(o=>!!o);return i.common.async?Promise.all(s).then(o=>Ji.mergeArray(t,o)):Ji.mergeArray(t,s)}get items(){return this._def.items}rest(e){return new n({...this._def,rest:e})}};Co.create=(n,e)=>{if(!Array.isArray(n))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Co({items:n,typeName:we.ZodTuple,rest:null,...Ne(e)})};Dx=class n extends ze{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:i}=this._processInputParams(e);if(i.parsedType!==Ht.object)return Bt(i,{code:Nt.invalid_type,expected:Ht.object,received:i.parsedType}),ye;let r=[],s=this._def.keyType,o=this._def.valueType;for(let a in i.data)r.push({key:s._parse(new Ps(i,a,i.path,a)),value:o._parse(new Ps(i,i.data[a],i.path,a)),alwaysSet:a in i.data});return i.common.async?Ji.mergeObjectAsync(t,r):Ji.mergeObjectSync(t,r)}get element(){return this._def.valueType}static create(e,t,i){return t instanceof ze?new n({keyType:e,valueType:t,typeName:we.ZodRecord,...Ne(i)}):new n({keyType:Rc.create(),valueType:e,typeName:we.ZodRecord,...Ne(t)})}},Em=class extends ze{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:i}=this._processInputParams(e);if(i.parsedType!==Ht.map)return Bt(i,{code:Nt.invalid_type,expected:Ht.map,received:i.parsedType}),ye;let r=this._def.keyType,s=this._def.valueType,o=[...i.data.entries()].map(([a,c],l)=>({key:r._parse(new Ps(i,a,i.path,[l,"key"])),value:s._parse(new Ps(i,c,i.path,[l,"value"]))}));if(i.common.async){let a=new Map;return Promise.resolve().then(async()=>{for(let c of o){let l=await c.key,u=await c.value;if(l.status==="aborted"||u.status==="aborted")return ye;(l.status==="dirty"||u.status==="dirty")&&t.dirty(),a.set(l.value,u.value)}return{status:t.value,value:a}})}else{let a=new Map;for(let c of o){let l=c.key,u=c.value;if(l.status==="aborted"||u.status==="aborted")return ye;(l.status==="dirty"||u.status==="dirty")&&t.dirty(),a.set(l.value,u.value)}return{status:t.value,value:a}}}};Em.create=(n,e,t)=>new Em({valueType:e,keyType:n,typeName:we.ZodMap,...Ne(t)});Mm=class n extends ze{_parse(e){let{status:t,ctx:i}=this._processInputParams(e);if(i.parsedType!==Ht.set)return Bt(i,{code:Nt.invalid_type,expected:Ht.set,received:i.parsedType}),ye;let r=this._def;r.minSize!==null&&i.data.size<r.minSize.value&&(Bt(i,{code:Nt.too_small,minimum:r.minSize.value,type:"set",inclusive:!0,exact:!1,message:r.minSize.message}),t.dirty()),r.maxSize!==null&&i.data.size>r.maxSize.value&&(Bt(i,{code:Nt.too_big,maximum:r.maxSize.value,type:"set",inclusive:!0,exact:!1,message:r.maxSize.message}),t.dirty());let s=this._def.valueType;function o(c){let l=new Set;for(let u of c){if(u.status==="aborted")return ye;u.status==="dirty"&&t.dirty(),l.add(u.value)}return{status:t.value,value:l}}let a=[...i.data.values()].map((c,l)=>s._parse(new Ps(i,c,i.path,l)));return i.common.async?Promise.all(a).then(c=>o(c)):o(a)}min(e,t){return new n({...this._def,minSize:{value:e,message:se.toString(t)}})}max(e,t){return new n({...this._def,maxSize:{value:e,message:se.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}};Mm.create=(n,e)=>new Mm({valueType:n,minSize:null,maxSize:null,typeName:we.ZodSet,...Ne(e)});jx=class n extends ze{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==Ht.function)return Bt(t,{code:Nt.invalid_type,expected:Ht.function,received:t.parsedType}),ye;function i(a,c){return tg({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Sm(),ya].filter(l=>!!l),issueData:{code:Nt.invalid_arguments,argumentsError:c}})}function r(a,c){return tg({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Sm(),ya].filter(l=>!!l),issueData:{code:Nt.invalid_return_type,returnTypeError:c}})}let s={errorMap:t.common.contextualErrorMap},o=t.data;if(this._def.returns instanceof Lc){let a=this;return ur(async function(...c){let l=new Fr([]),u=await a._def.args.parseAsync(c,s).catch(y=>{throw l.addIssue(i(c,y)),l}),p=await Reflect.apply(o,this,u);return await a._def.returns._def.type.parseAsync(p,s).catch(y=>{throw l.addIssue(r(p,y)),l})})}else{let a=this;return ur(function(...c){let l=a._def.args.safeParse(c,s);if(!l.success)throw new Fr([i(c,l.error)]);let u=Reflect.apply(o,this,l.data),p=a._def.returns.safeParse(u,s);if(!p.success)throw new Fr([r(u,p.error)]);return p.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new n({...this._def,args:Co.create(e).rest(xa.create())})}returns(e){return new n({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,i){return new n({args:e||Co.create([]).rest(xa.create()),returns:t||xa.create(),typeName:we.ZodFunction,...Ne(i)})}},Ih=class extends ze{get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}};Ih.create=(n,e)=>new Ih({getter:n,typeName:we.ZodLazy,...Ne(e)});Nh=class extends ze{_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return Bt(t,{received:t.data,code:Nt.invalid_literal,expected:this._def.value}),ye}return{status:"valid",value:e.data}}get value(){return this._def.value}};Nh.create=(n,e)=>new Nh({value:n,typeName:we.ZodLiteral,...Ne(e)});Ah=class n extends ze{_parse(e){if(typeof e.data!="string"){let t=this._getOrReturnCtx(e),i=this._def.values;return Bt(t,{expected:Ve.joinValues(i),received:t.parsedType,code:Nt.invalid_type}),ye}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let t=this._getOrReturnCtx(e),i=this._def.values;return Bt(t,{received:t.data,code:Nt.invalid_enum_value,options:i}),ye}return ur(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return n.create(e,{...this._def,...t})}exclude(e,t=this._def){return n.create(this.options.filter(i=>!e.includes(i)),{...this._def,...t})}};Ah.create=L$;Rh=class extends ze{_parse(e){let t=Ve.getValidEnumValues(this._def.values),i=this._getOrReturnCtx(e);if(i.parsedType!==Ht.string&&i.parsedType!==Ht.number){let r=Ve.objectValues(t);return Bt(i,{expected:Ve.joinValues(r),received:i.parsedType,code:Nt.invalid_type}),ye}if(this._cache||(this._cache=new Set(Ve.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let r=Ve.objectValues(t);return Bt(i,{received:i.data,code:Nt.invalid_enum_value,options:r}),ye}return ur(e.data)}get enum(){return this._def.values}};Rh.create=(n,e)=>new Rh({values:n,typeName:we.ZodNativeEnum,...Ne(e)});Lc=class extends ze{unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==Ht.promise&&t.common.async===!1)return Bt(t,{code:Nt.invalid_type,expected:Ht.promise,received:t.parsedType}),ye;let i=t.parsedType===Ht.promise?t.data:Promise.resolve(t.data);return ur(i.then(r=>this._def.type.parseAsync(r,{path:t.path,errorMap:t.common.contextualErrorMap})))}};Lc.create=(n,e)=>new Lc({type:n,typeName:we.ZodPromise,...Ne(e)});ks=class extends ze{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===we.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:i}=this._processInputParams(e),r=this._def.effect||null,s={addIssue:o=>{Bt(i,o),o.fatal?t.abort():t.dirty()},get path(){return i.path}};if(s.addIssue=s.addIssue.bind(s),r.type==="preprocess"){let o=r.transform(i.data,s);if(i.common.async)return Promise.resolve(o).then(async a=>{if(t.value==="aborted")return ye;let c=await this._def.schema._parseAsync({data:a,path:i.path,parent:i});return c.status==="aborted"?ye:c.status==="dirty"?vh(c.value):t.value==="dirty"?vh(c.value):c});{if(t.value==="aborted")return ye;let a=this._def.schema._parseSync({data:o,path:i.path,parent:i});return a.status==="aborted"?ye:a.status==="dirty"?vh(a.value):t.value==="dirty"?vh(a.value):a}}if(r.type==="refinement"){let o=a=>{let c=r.refinement(a,s);if(i.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(i.common.async===!1){let a=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});return a.status==="aborted"?ye:(a.status==="dirty"&&t.dirty(),o(a.value),{status:t.value,value:a.value})}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(a=>a.status==="aborted"?ye:(a.status==="dirty"&&t.dirty(),o(a.value).then(()=>({status:t.value,value:a.value}))))}if(r.type==="transform")if(i.common.async===!1){let o=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});if(!Ac(o))return ye;let a=r.transform(o.value,s);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:a}}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(o=>Ac(o)?Promise.resolve(r.transform(o.value,s)).then(a=>({status:t.value,value:a})):ye);Ve.assertNever(r)}};ks.create=(n,e,t)=>new ks({schema:n,typeName:we.ZodEffects,effect:e,...Ne(t)});ks.createWithPreprocess=(n,e,t)=>new ks({schema:e,effect:{type:"preprocess",transform:n},typeName:we.ZodEffects,...Ne(t)});ws=class extends ze{_parse(e){return this._getType(e)===Ht.undefined?ur(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};ws.create=(n,e)=>new ws({innerType:n,typeName:we.ZodOptional,...Ne(e)});Io=class extends ze{_parse(e){return this._getType(e)===Ht.null?ur(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Io.create=(n,e)=>new Io({innerType:n,typeName:we.ZodNullable,...Ne(e)});Oh=class extends ze{_parse(e){let{ctx:t}=this._processInputParams(e),i=t.data;return t.parsedType===Ht.undefined&&(i=this._def.defaultValue()),this._def.innerType._parse({data:i,path:t.path,parent:t})}removeDefault(){return this._def.innerType}};Oh.create=(n,e)=>new Oh({innerType:n,typeName:we.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Ne(e)});Lh=class extends ze{_parse(e){let{ctx:t}=this._processInputParams(e),i={...t,common:{...t.common,issues:[]}},r=this._def.innerType._parse({data:i.data,path:i.path,parent:{...i}});return wm(r)?r.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Fr(i.common.issues)},input:i.data})})):{status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new Fr(i.common.issues)},input:i.data})}}removeCatch(){return this._def.innerType}};Lh.create=(n,e)=>new Lh({innerType:n,typeName:we.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Ne(e)});Cm=class extends ze{_parse(e){if(this._getType(e)!==Ht.nan){let i=this._getOrReturnCtx(e);return Bt(i,{code:Nt.invalid_type,expected:Ht.nan,received:i.parsedType}),ye}return{status:"valid",value:e.data}}};Cm.create=n=>new Cm({typeName:we.ZodNaN,...Ne(n)});qht=Symbol("zod_brand"),eg=class extends ze{_parse(e){let{ctx:t}=this._processInputParams(e),i=t.data;return this._def.type._parse({data:i,path:t.path,parent:t})}unwrap(){return this._def.type}},ng=class n extends ze{_parse(e){let{status:t,ctx:i}=this._processInputParams(e);if(i.common.async)return(async()=>{let s=await this._def.in._parseAsync({data:i.data,path:i.path,parent:i});return s.status==="aborted"?ye:s.status==="dirty"?(t.dirty(),vh(s.value)):this._def.out._parseAsync({data:s.value,path:i.path,parent:i})})();{let r=this._def.in._parseSync({data:i.data,path:i.path,parent:i});return r.status==="aborted"?ye:r.status==="dirty"?(t.dirty(),{status:"dirty",value:r.value}):this._def.out._parseSync({data:r.value,path:i.path,parent:i})}}static create(e,t){return new n({in:e,out:t,typeName:we.ZodPipeline})}},Fh=class extends ze{_parse(e){let t=this._def.innerType._parse(e),i=r=>(Ac(r)&&(r.value=Object.freeze(r.value)),r);return wm(t)?t.then(r=>i(r)):i(t)}unwrap(){return this._def.innerType}};Fh.create=(n,e)=>new Fh({innerType:n,typeName:we.ZodReadonly,...Ne(e)});Zht={object:zr.lazycreate};(function(n){n.ZodString="ZodString",n.ZodNumber="ZodNumber",n.ZodNaN="ZodNaN",n.ZodBigInt="ZodBigInt",n.ZodBoolean="ZodBoolean",n.ZodDate="ZodDate",n.ZodSymbol="ZodSymbol",n.ZodUndefined="ZodUndefined",n.ZodNull="ZodNull",n.ZodAny="ZodAny",n.ZodUnknown="ZodUnknown",n.ZodNever="ZodNever",n.ZodVoid="ZodVoid",n.ZodArray="ZodArray",n.ZodObject="ZodObject",n.ZodUnion="ZodUnion",n.ZodDiscriminatedUnion="ZodDiscriminatedUnion",n.ZodIntersection="ZodIntersection",n.ZodTuple="ZodTuple",n.ZodRecord="ZodRecord",n.ZodMap="ZodMap",n.ZodSet="ZodSet",n.ZodFunction="ZodFunction",n.ZodLazy="ZodLazy",n.ZodLiteral="ZodLiteral",n.ZodEnum="ZodEnum",n.ZodEffects="ZodEffects",n.ZodNativeEnum="ZodNativeEnum",n.ZodOptional="ZodOptional",n.ZodNullable="ZodNullable",n.ZodDefault="ZodDefault",n.ZodCatch="ZodCatch",n.ZodPromise="ZodPromise",n.ZodBranded="ZodBranded",n.ZodPipeline="ZodPipeline",n.ZodReadonly="ZodReadonly"})(we||(we={}));Kht=(n,e={message:`Input not instance of ${n.name}`})=>F$(t=>t instanceof n,e),z$=Rc.create,$$=Sh.create,Jht=Cm.create,Qht=wh.create,D$=Ph.create,tdt=kh.create,edt=km.create,ndt=Th.create,idt=Eh.create,rdt=Oc.create,sdt=xa.create,odt=Zs.create,adt=Tm.create,cdt=ba.create,ldt=zr.create,udt=zr.strictCreate,pdt=Mh.create,hdt=$x.create,ddt=Ch.create,fdt=Co.create,mdt=Dx.create,_dt=Em.create,ydt=Mm.create,gdt=jx.create,xdt=Ih.create,bdt=Nh.create,vdt=Ah.create,Sdt=Rh.create,wdt=Lc.create,Pdt=ks.create,kdt=ws.create,Tdt=Io.create,Edt=ks.createWithPreprocess,Mdt=ng.create,Cdt=()=>z$().optional(),Idt=()=>$$().optional(),Ndt=()=>D$().optional(),Adt={string:(n=>Rc.create({...n,coerce:!0})),number:(n=>Sh.create({...n,coerce:!0})),boolean:(n=>Ph.create({...n,coerce:!0})),bigint:(n=>wh.create({...n,coerce:!0})),date:(n=>kh.create({...n,coerce:!0}))},Rdt=ye});var h={};xh(h,{BRAND:()=>qht,DIRTY:()=>vh,EMPTY_PATH:()=>Eht,INVALID:()=>ye,NEVER:()=>Rdt,OK:()=>ur,ParseStatus:()=>Ji,Schema:()=>ze,ZodAny:()=>Oc,ZodArray:()=>ba,ZodBigInt:()=>wh,ZodBoolean:()=>Ph,ZodBranded:()=>eg,ZodCatch:()=>Lh,ZodDate:()=>kh,ZodDefault:()=>Oh,ZodDiscriminatedUnion:()=>$x,ZodEffects:()=>ks,ZodEnum:()=>Ah,ZodError:()=>Fr,ZodFirstPartyTypeKind:()=>we,ZodFunction:()=>jx,ZodIntersection:()=>Ch,ZodIssueCode:()=>Nt,ZodLazy:()=>Ih,ZodLiteral:()=>Nh,ZodMap:()=>Em,ZodNaN:()=>Cm,ZodNativeEnum:()=>Rh,ZodNever:()=>Zs,ZodNull:()=>Eh,ZodNullable:()=>Io,ZodNumber:()=>Sh,ZodObject:()=>zr,ZodOptional:()=>ws,ZodParsedType:()=>Ht,ZodPipeline:()=>ng,ZodPromise:()=>Lc,ZodReadonly:()=>Fh,ZodRecord:()=>Dx,ZodSchema:()=>ze,ZodSet:()=>Mm,ZodString:()=>Rc,ZodSymbol:()=>km,ZodTransformer:()=>ks,ZodTuple:()=>Co,ZodType:()=>ze,ZodUndefined:()=>Th,ZodUnion:()=>Mh,ZodUnknown:()=>xa,ZodVoid:()=>Tm,addIssueToContext:()=>Bt,any:()=>rdt,array:()=>cdt,bigint:()=>Qht,boolean:()=>D$,coerce:()=>Adt,custom:()=>F$,date:()=>tdt,datetimeRegex:()=>O$,defaultErrorMap:()=>ya,discriminatedUnion:()=>hdt,effect:()=>Pdt,enum:()=>vdt,function:()=>gdt,getErrorMap:()=>Sm,getParsedType:()=>Mo,instanceof:()=>Kht,intersection:()=>ddt,isAborted:()=>Fx,isAsync:()=>wm,isDirty:()=>zx,isValid:()=>Ac,late:()=>Zht,lazy:()=>xdt,literal:()=>bdt,makeIssue:()=>tg,map:()=>_dt,nan:()=>Jht,nativeEnum:()=>Sdt,never:()=>odt,null:()=>idt,nullable:()=>Tdt,number:()=>$$,object:()=>ldt,objectUtil:()=>j3,oboolean:()=>Ndt,onumber:()=>Idt,optional:()=>kdt,ostring:()=>Cdt,pipeline:()=>Mdt,preprocess:()=>Edt,promise:()=>wdt,quotelessJson:()=>Pht,record:()=>mdt,set:()=>ydt,setErrorMap:()=>Tht,strictObject:()=>udt,string:()=>z$,symbol:()=>edt,transformer:()=>Pdt,tuple:()=>fdt,undefined:()=>ndt,union:()=>pdt,unknown:()=>sdt,util:()=>Ve,void:()=>adt});var V3=qt(()=>{"use strict";Lx();Y3();M$();Qy();j$();Ox()});var Q=qt(()=>{"use strict";V3();V3()});var jh={};xh(jh,{all_layers:()=>Am,any_circuit_element:()=>rB,any_soup_element:()=>Dh,any_source_component:()=>J$,battery_capacity:()=>V$,brep_shape:()=>RD,cad_component:()=>Hj,capacitance:()=>va,circuit_json_footprint_load_error:()=>Wx,current:()=>Ldt,distance:()=>Y,duration_ms:()=>ig,experiment_type:()=>Jj,external_footprint_load_error:()=>Rm,frequency:()=>hr,getZodPrefixedIdWithDefault:()=>At,inductance:()=>Bx,layer_ref:()=>pe,layer_string:()=>H3,length:()=>D,ms:()=>pr,ninePointAnchor:()=>rg,pcb_autorouting_error:()=>Rj,pcb_board:()=>rj,pcb_breakout_point:()=>Oj,pcb_component:()=>LD,pcb_component_invalid_layer_error:()=>Om,pcb_component_outside_board_error:()=>Yj,pcb_copper_pour:()=>Bj,pcb_copper_pour_brep:()=>Dj,pcb_copper_pour_polygon:()=>jj,pcb_copper_pour_rect:()=>$j,pcb_copper_text:()=>pj,pcb_courtyard_outline:()=>Vj,pcb_courtyard_polygon:()=>Gj,pcb_courtyard_rect:()=>Uj,pcb_cutout:()=>Ij,pcb_cutout_circle:()=>Ej,pcb_cutout_path:()=>Cj,pcb_cutout_polygon:()=>Mj,pcb_cutout_rect:()=>Tj,pcb_fabrication_note_dimension:()=>gj,pcb_fabrication_note_path:()=>_j,pcb_fabrication_note_rect:()=>yj,pcb_fabrication_note_text:()=>mj,pcb_footprint_overlap_error:()=>Pj,pcb_ground_plane:()=>Lj,pcb_ground_plane_region:()=>Fj,pcb_group:()=>Aj,pcb_hole:()=>YD,pcb_hole_circle_or_square_shape:()=>Vdt,pcb_hole_circle_shape:()=>Xdt,pcb_hole_oval_shape:()=>Gdt,pcb_hole_pill_shape:()=>Hdt,pcb_hole_rect_shape:()=>Udt,pcb_hole_rotated_pill_shape:()=>Wdt,pcb_keepout:()=>kj,pcb_manual_edit_conflict_warning:()=>qx,pcb_missing_footprint_error:()=>Nj,pcb_net:()=>nj,pcb_note_dimension:()=>wj,pcb_note_line:()=>Sj,pcb_note_path:()=>vj,pcb_note_rect:()=>bj,pcb_note_text:()=>xj,pcb_panel:()=>sj,pcb_placement_error:()=>oj,pcb_plated_hole:()=>XD,pcb_port:()=>UD,pcb_port_not_connected_error:()=>ej,pcb_port_not_matched_error:()=>tj,pcb_route_hint:()=>OD,pcb_route_hints:()=>Ydt,pcb_silkscreen_circle:()=>dj,pcb_silkscreen_line:()=>cj,pcb_silkscreen_oval:()=>fj,pcb_silkscreen_path:()=>lj,pcb_silkscreen_rect:()=>hj,pcb_silkscreen_text:()=>uj,pcb_smtpad:()=>GD,pcb_smtpad_pill:()=>VD,pcb_solder_paste:()=>HD,pcb_text:()=>WD,pcb_thermal_spoke:()=>zj,pcb_trace:()=>KD,pcb_trace_error:()=>JD,pcb_trace_hint:()=>aj,pcb_trace_missing_error:()=>QD,pcb_trace_route_point:()=>Gx,pcb_trace_route_point_via:()=>ZD,pcb_trace_route_point_wire:()=>qD,pcb_via:()=>ij,pcb_via_clearance_error:()=>Xj,point:()=>Zt,point3:()=>zh,point_with_bulge:()=>AD,port_arrangement:()=>pD,position:()=>zdt,position3:()=>$dt,resistance:()=>Fc,ring:()=>W3,rotation:()=>He,route_hint_point:()=>Qi,schematic_arc:()=>_D,schematic_box:()=>oD,schematic_circle:()=>mD,schematic_component:()=>hD,schematic_component_port_arrangement_by_sides:()=>uD,schematic_component_port_arrangement_by_size:()=>lD,schematic_debug_line:()=>PD,schematic_debug_object:()=>TD,schematic_debug_object_base:()=>Ux,schematic_debug_point:()=>kD,schematic_debug_rect:()=>wD,schematic_error:()=>vD,schematic_group:()=>MD,schematic_layout_error:()=>SD,schematic_line:()=>dD,schematic_manual_edit_conflict_warning:()=>Vx,schematic_net_label:()=>bD,schematic_path:()=>aD,schematic_pin_styles:()=>cD,schematic_port:()=>xD,schematic_rect:()=>fD,schematic_sheet:()=>ND,schematic_table:()=>CD,schematic_table_cell:()=>ID,schematic_text:()=>gD,schematic_trace:()=>yD,schematic_voltage_probe:()=>ED,simulation_ac_voltage_source:()=>Zj,simulation_dc_voltage_source:()=>qj,simulation_experiment:()=>Qj,simulation_switch:()=>eB,simulation_transient_voltage_graph:()=>tB,simulation_unknown_experiment_error:()=>iB,simulation_voltage_probe:()=>nB,simulation_voltage_source:()=>Kj,size:()=>q3,source_board:()=>iD,source_component_base:()=>hi,source_failed_to_create_component_error:()=>q$,source_group:()=>eD,source_manually_placed_via:()=>sD,source_missing_property_error:()=>W$,source_net:()=>nD,source_pcb_ground_plane:()=>rD,source_pin_missing_trace_warning:()=>fE,source_port:()=>Q$,source_project_metadata:()=>hE,source_property_ignored_warning:()=>Z$,source_simple_battery:()=>eE,source_simple_capacitor:()=>Z3,source_simple_chip:()=>Q3,source_simple_crystal:()=>H$,source_simple_diode:()=>Yx,source_simple_ground:()=>G$,source_simple_inductor:()=>nE,source_simple_led:()=>J3,source_simple_mosfet:()=>uE,source_simple_pin_header:()=>sE,source_simple_pinout:()=>oE,source_simple_potentiometer:()=>rE,source_simple_power_source:()=>tE,source_simple_push_button:()=>iE,source_simple_resistor:()=>K3,source_simple_resonator:()=>aE,source_simple_switch:()=>pE,source_simple_test_point:()=>lE,source_simple_transistor:()=>cE,source_simple_voltage_probe:()=>K$,source_trace:()=>tD,source_trace_not_connected_error:()=>dE,supplier_name:()=>Nm,time:()=>Fdt,timestamp:()=>U$,unknown_error_finding_part:()=>Xx,visible_layer:()=>Js,voltage:()=>Pi,wave_shape:()=>Wj});function Odt(n){for(let[e,t]of Object.entries(X$))if(n in t.variants)return{baseUnit:t.baseUnit,conversionFactor:t.variants[n]};return{baseUnit:n,conversionFactor:1}}function Ks(n){if(n==null)return{parsedUnit:null,unitOfValue:null,value:null};if(typeof n=="string"&&n.match(/^-?[\d\.]+$/))return{value:Number.parseFloat(n),parsedUnit:null,unitOfValue:null};if(typeof n=="number")return{value:n,parsedUnit:null,unitOfValue:null};if(typeof n=="object"&&"x"in n&&"y"in n){let{parsedUnit:a,unitOfValue:c}=Ks(n.x),l=Ks(n.x),u=Ks(n.y);return l.value===null||u.value===null?{parsedUnit:null,unitOfValue:null,value:null}:{parsedUnit:a,unitOfValue:c,value:{x:l.value,y:u.value}}}let t=n.toString().split("").reverse().join("").match(/[^\d\s]+/)?.[0];if(!t)throw new Error(`Could not determine unit: "${n}"`);let i=t.split("").reverse().join(""),r=n.slice(0,-i.length);if(i in Y$&&!G3.has(i)){let a=Y$[i];return{parsedUnit:null,unitOfValue:null,value:Number.parseFloat(r)*a}}let{baseUnit:s,conversionFactor:o}=Odt(i);return{parsedUnit:i,unitOfValue:s,value:o*Number.parseFloat(r)}}var X$,G3,Y$,Fc,va,Bx,Pi,D,hr,Y,Ldt,ig,Fdt,pr,U$,He,V$,ft,$h,Zt,zdt,zh,$dt,q3,Ddt,At,rg,Nm,hi,Z3,K3,Yx,J3,G$,Q3,tE,jdt,eE,nE,iE,rE,H$,sE,oE,aE,cE,lE,uE,pE,hE,W$,q$,dE,Z$,fE,K$,J$,Q$,tD,eD,nD,iD,rD,Am,H3,pe,Js,sD,Xx,oD,aD,cD,lD,uD,pD,hD,dD,fD,mD,_D,yD,Bdt,gD,xD,bD,vD,SD,Ux,wD,PD,kD,TD,ED,Vx,MD,CD,ID,ND,AD,W3,RD,OD,Ydt,Qi,LD,FD,Xdt,zD,Udt,$D,Vdt,DD,Gdt,jD,Hdt,BD,Wdt,YD,qdt,Zdt,Kdt,Jdt,Qdt,tft,XD,UD,eft,nft,ift,VD,rft,sft,GD,oft,aft,cft,lft,uft,HD,WD,qD,ZD,Gx,KD,JD,QD,tj,ej,nj,ij,rj,sj,oj,aj,cj,lj,uj,pj,hj,dj,fj,mj,_j,yj,gj,xj,bj,vj,Sj,wj,Pj,kj,Hx,Tj,Ej,Mj,Cj,Ij,Nj,Rm,Wx,Aj,Rj,qx,Oj,Lj,Fj,zj,mE,$j,Dj,jj,Bj,Yj,Om,Xj,Uj,Vj,Gj,Hj,Wj,pft,qj,Zj,Kj,Jj,Qj,tB,eB,nB,iB,rB,Dh,St=qt(()=>{"use strict";Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();X$={Hz:{baseUnit:"Hz",variants:{MHz:1e6,kHz:1e3,Hz:1}},g:{baseUnit:"g",variants:{kg:1e3,g:1}},\u03A9:{baseUnit:"\u03A9",variants:{m\u03A9:.001,\u03A9:1,k\u03A9:1e3,K\u03A9:1e3,kohm:1e3,M\u03A9:1e6,G\u03A9:1e9,T\u03A9:1e12}},V:{baseUnit:"V",variants:{mV:.001,V:1,kV:1e3,KV:1e3,MV:1e6,GV:1e9,TV:1e12}},A:{baseUnit:"A",variants:{\u00B5A:1e-6,mA:.001,ma:.001,A:1,kA:1e3,MA:1e6}},F:{baseUnit:"F",variants:{pF:1e-12,nF:1e-9,\u00B5F:1e-6,uF:1e-6,mF:.001,F:1}},ml:{baseUnit:"ml",variants:{ml:1,mL:1,l:1e3,L:1e3}},deg:{baseUnit:"deg",variants:{rad:180/Math.PI}},ms:{baseUnit:"ms",variants:{fs:1e-12,ps:1e-9,ns:1e-6,us:.001,\u00B5s:.001,ms:1,s:1e3}},mm:{baseUnit:"mm",variants:{nm:1e-6,\u00B5m:.001,um:.001,mm:1,cm:10,dm:100,m:1e3,km:1e6,in:25.4,ft:304.8,IN:25.4,FT:304.8,yd:914.4,mi:1609344,mil:.0254}}},G3=new Set;for(let[n,e]of Object.entries(X$)){G3.add(n);for(let t of Object.keys(e.variants))G3.add(t)}Y$={tera:1e12,T:1e12,giga:1e9,G:1e9,mega:1e6,M:1e6,kilo:1e3,k:1e3,deci:.1,d:.1,centi:.01,c:.01,milli:.001,m:.001,micro:1e-6,u:1e-6,\u00B5:1e-6,nano:1e-9,n:1e-9,pico:1e-12,p:1e-12};Fc=h.string().or(h.number()).transform(n=>Ks(n).value),va=h.string().or(h.number()).transform(n=>Ks(n).value).transform(n=>Number.parseFloat(n.toPrecision(12))),Bx=h.string().or(h.number()).transform(n=>Ks(n).value),Pi=h.string().or(h.number()).transform(n=>Ks(n).value),D=h.string().or(h.number()).transform(n=>Ks(n).value),hr=h.string().or(h.number()).transform(n=>Ks(n).value),Y=D,Ldt=h.string().or(h.number()).transform(n=>Ks(n).value),ig=h.string().or(h.number()).transform(n=>Ks(n).value),Fdt=ig,pr=ig,U$=h.string().datetime(),He=h.string().or(h.number()).transform(n=>typeof n=="number"?n:n.endsWith("deg")?Number.parseFloat(n.split("deg")[0]):n.endsWith("rad")?Number.parseFloat(n.split("rad")[0])*180/Math.PI:Number.parseFloat(n)),V$=h.number().or(h.string().endsWith("mAh")).transform(n=>{if(typeof n=="string"){let e=n.replace("mAh",""),t=Number.parseFloat(e);if(Number.isNaN(t))throw new Error("Invalid capacity");return t}return n}).describe("Battery capacity in mAh"),ft=n=>{};ft("extra props b");ft("missing props b");ft(!0);ft("mismatched prop types: a");$h=n=>{};$h(!0);$h('T1 has extra: "c", T2 has extra: "d"');$h('T1 has extra: "c"');$h('T2 has extra: "c"');$h('T1 has extra: "d", T2 has extra: "c"');$h(!0);Zt=h.object({x:Y,y:Y}),zdt=Zt;ft(!0);ft(!0);zh=h.object({x:Y,y:Y,z:Y}),$dt=zh;ft(!0);q3=h.object({width:h.number(),height:h.number()});ft(!0);Ddt=n=>{let e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";return Array.from({length:n},()=>e[Math.floor(Math.random()*e.length)]).join("")},At=n=>h.string().optional().default(()=>`${n}_${Ddt(10)}`),rg=h.enum(["top_left","top_center","top_right","center_left","center","center_right","bottom_left","bottom_center","bottom_right"]);ft(!0);Nm=h.enum(["jlcpcb","macrofab","pcbway","digikey","mouser","lcsc"]);ft(!0);hi=h.object({type:h.literal("source_component"),ftype:h.string().optional(),source_component_id:h.string(),name:h.string(),manufacturer_part_number:h.string().optional(),supplier_part_numbers:h.record(Nm,h.array(h.string())).optional(),display_value:h.string().optional(),are_pins_interchangeable:h.boolean().optional(),internally_connected_source_port_ids:h.array(h.array(h.string())).optional(),source_group_id:h.string().optional(),subcircuit_id:h.string().optional()});ft(!0);Z3=hi.extend({ftype:h.literal("simple_capacitor"),capacitance:va,max_voltage_rating:Pi.optional(),display_capacitance:h.string().optional(),max_decoupling_trace_length:Y.optional()});ft(!0);K3=hi.extend({ftype:h.literal("simple_resistor"),resistance:Fc,display_resistance:h.string().optional()});ft(!0);Yx=hi.extend({ftype:h.literal("simple_diode")});ft(!0);J3=Yx.extend({ftype:h.literal("simple_led"),color:h.string().optional(),wavelength:h.string().optional()});ft(!0);G$=hi.extend({ftype:h.literal("simple_ground")});ft(!0);Q3=hi.extend({ftype:h.literal("simple_chip")});ft(!0);tE=hi.extend({ftype:h.literal("simple_power_source"),voltage:Pi});ft(!0);jdt=hi.extend({ftype:h.literal("simple_fuse"),current_rating_amps:h.number().describe("Nominal current in amps the fuse is rated for"),voltage_rating_volts:h.number().describe("Voltage rating in volts, e.g. \xB15V would be 5")});ft(!0);eE=hi.extend({ftype:h.literal("simple_battery"),capacity:V$});ft(!0);nE=hi.extend({ftype:h.literal("simple_inductor"),inductance:Bx,max_current_rating:h.number().optional()});ft(!0);iE=hi.extend({ftype:h.literal("simple_push_button")});ft(!0);rE=hi.extend({ftype:h.literal("simple_potentiometer"),max_resistance:Fc});ft(!0);H$=hi.extend({ftype:h.literal("simple_crystal"),frequency:h.number().describe("Frequency in Hz"),load_capacitance:h.number().optional().describe("Load capacitance in pF")});ft(!0);sE=hi.extend({ftype:h.literal("simple_pin_header"),pin_count:h.number(),gender:h.enum(["male","female"]).optional().default("male")});ft(!0);oE=hi.extend({ftype:h.literal("simple_pinout")});ft(!0);aE=hi.extend({ftype:h.literal("simple_resonator"),load_capacitance:va,equivalent_series_resistance:Fc.optional(),frequency:hr});ft(!0);cE=hi.extend({ftype:h.literal("simple_transistor"),transistor_type:h.enum(["npn","pnp"])});ft(!0);lE=hi.extend({ftype:h.literal("simple_test_point"),footprint_variant:h.enum(["pad","through_hole"]).optional(),pad_shape:h.enum(["rect","circle"]).optional(),pad_diameter:h.union([h.number(),h.string()]).optional(),hole_diameter:h.union([h.number(),h.string()]).optional(),width:h.union([h.number(),h.string()]).optional(),height:h.union([h.number(),h.string()]).optional()});ft(!0);uE=hi.extend({ftype:h.literal("simple_mosfet"),channel_type:h.enum(["n","p"]),mosfet_mode:h.enum(["enhancement","depletion"])});ft(!0);pE=hi.extend({ftype:h.literal("simple_switch")});ft(!0);hE=h.object({type:h.literal("source_project_metadata"),name:h.string().optional(),software_used_string:h.string().optional(),project_url:h.string().optional(),created_at:U$.optional()});ft(!0);W$=h.object({type:h.literal("source_missing_property_error"),source_missing_property_error_id:At("source_missing_property_error"),source_component_id:h.string(),property_name:h.string(),subcircuit_id:h.string().optional(),error_type:h.literal("source_missing_property_error").default("source_missing_property_error"),message:h.string()}).describe("The source code is missing a property");ft(!0);q$=h.object({type:h.literal("source_failed_to_create_component_error"),source_failed_to_create_component_error_id:At("source_failed_to_create_component_error"),error_type:h.literal("source_failed_to_create_component_error").default("source_failed_to_create_component_error"),component_name:h.string().optional(),subcircuit_id:h.string().optional(),parent_source_component_id:h.string().optional(),message:h.string(),pcb_center:h.object({x:h.number().optional(),y:h.number().optional()}).optional(),schematic_center:h.object({x:h.number().optional(),y:h.number().optional()}).optional()}).describe("Error emitted when a component fails to be constructed");ft(!0);dE=h.object({type:h.literal("source_trace_not_connected_error"),source_trace_not_connected_error_id:At("source_trace_not_connected_error"),error_type:h.literal("source_trace_not_connected_error").default("source_trace_not_connected_error"),message:h.string(),subcircuit_id:h.string().optional(),source_group_id:h.string().optional(),source_trace_id:h.string().optional(),connected_source_port_ids:h.array(h.string()).optional(),selectors_not_found:h.array(h.string()).optional()}).describe("Occurs when a source trace selector does not match any ports");ft(!0);Z$=h.object({type:h.literal("source_property_ignored_warning"),source_property_ignored_warning_id:At("source_property_ignored_warning"),source_component_id:h.string(),property_name:h.string(),subcircuit_id:h.string().optional(),error_type:h.literal("source_property_ignored_warning").default("source_property_ignored_warning"),message:h.string()}).describe("The source property was ignored");ft(!0);fE=h.object({type:h.literal("source_pin_missing_trace_warning"),source_pin_missing_trace_warning_id:At("source_pin_missing_trace_warning"),warning_type:h.literal("source_pin_missing_trace_warning").default("source_pin_missing_trace_warning"),message:h.string(),source_component_id:h.string(),source_port_id:h.string(),subcircuit_id:h.string().optional()}).describe("Warning emitted when a source component pin is missing a trace connection");ft(!0);K$=hi.extend({ftype:h.literal("simple_voltage_probe")});ft(!0);J$=h.union([K3,Z3,Yx,J3,G$,Q3,tE,eE,nE,iE,rE,H$,sE,oE,aE,pE,cE,lE,uE,jdt,K$,hE,W$,q$,dE,Z$,fE]);ft(!0);Q$=h.object({type:h.literal("source_port"),pin_number:h.number().optional(),port_hints:h.array(h.string()).optional(),name:h.string(),source_port_id:h.string(),source_component_id:h.string().optional(),source_group_id:h.string().optional(),subcircuit_id:h.string().optional(),subcircuit_connectivity_map_key:h.string().optional()});ft(!0);tD=h.object({type:h.literal("source_trace"),source_trace_id:h.string(),connected_source_port_ids:h.array(h.string()),connected_source_net_ids:h.array(h.string()),subcircuit_id:h.string().optional(),subcircuit_connectivity_map_key:h.string().optional(),max_length:h.number().optional(),min_trace_thickness:h.number().optional(),display_name:h.string().optional()});ft(!0);eD=h.object({type:h.literal("source_group"),source_group_id:h.string(),subcircuit_id:h.string().optional(),parent_subcircuit_id:h.string().optional(),parent_source_group_id:h.string().optional(),is_subcircuit:h.boolean().optional(),show_as_schematic_box:h.boolean().optional(),name:h.string().optional(),was_automatically_named:h.boolean().optional()});ft(!0);nD=h.object({type:h.literal("source_net"),source_net_id:h.string(),name:h.string(),member_source_group_ids:h.array(h.string()),is_power:h.boolean().optional(),is_ground:h.boolean().optional(),is_digital_signal:h.boolean().optional(),is_analog_signal:h.boolean().optional(),is_positive_voltage_source:h.boolean().optional(),trace_width:h.number().optional(),subcircuit_id:h.string().optional(),subcircuit_connectivity_map_key:h.string().optional()});ft(!0);iD=h.object({type:h.literal("source_board"),source_board_id:h.string(),source_group_id:h.string(),title:h.string().optional()}).describe("Defines a board in the source domain");ft(!0);rD=h.object({type:h.literal("source_pcb_ground_plane"),source_pcb_ground_plane_id:h.string(),source_group_id:h.string(),source_net_id:h.string(),subcircuit_id:h.string().optional()}).describe("Defines a ground plane in the source domain");ft(!0);Am=["top","bottom","inner1","inner2","inner3","inner4","inner5","inner6"],H3=h.enum(Am),pe=H3.or(h.object({name:H3})).transform(n=>typeof n=="string"?n:n.name);ft(!0);Js=h.enum(["top","bottom"]),sD=h.object({type:h.literal("source_manually_placed_via"),source_manually_placed_via_id:h.string(),source_group_id:h.string(),source_net_id:h.string(),subcircuit_id:h.string().optional(),source_trace_id:h.string().optional()}).describe("Defines a via that is manually placed in the source domain");ft(!0);Xx=h.object({type:h.literal("unknown_error_finding_part"),unknown_error_finding_part_id:At("unknown_error_finding_part"),error_type:h.literal("unknown_error_finding_part").default("unknown_error_finding_part"),message:h.string(),source_component_id:h.string().optional(),subcircuit_id:h.string().optional()}).describe("Error emitted when an unexpected error occurs while finding a part");ft(!0);oD=h.object({type:h.literal("schematic_box"),schematic_component_id:h.string().optional(),width:Y,height:Y,is_dashed:h.boolean().default(!1),x:Y,y:Y,subcircuit_id:h.string().optional()}).describe("Draws a box on the schematic");ft(!0);aD=h.object({type:h.literal("schematic_path"),schematic_component_id:h.string(),fill_color:h.enum(["red","blue"]).optional(),is_filled:h.boolean().optional(),points:h.array(Zt),subcircuit_id:h.string().optional()});ft(!0);cD=h.record(h.object({left_margin:D.optional(),right_margin:D.optional(),top_margin:D.optional(),bottom_margin:D.optional()})),lD=h.object({left_size:h.number(),right_size:h.number(),top_size:h.number().optional(),bottom_size:h.number().optional()});ft(!0);uD=h.object({left_side:h.object({pins:h.array(h.number()),direction:h.enum(["top-to-bottom","bottom-to-top"]).optional()}).optional(),right_side:h.object({pins:h.array(h.number()),direction:h.enum(["top-to-bottom","bottom-to-top"]).optional()}).optional(),top_side:h.object({pins:h.array(h.number()),direction:h.enum(["left-to-right","right-to-left"]).optional()}).optional(),bottom_side:h.object({pins:h.array(h.number()),direction:h.enum(["left-to-right","right-to-left"]).optional()}).optional()});ft(!0);pD=h.union([lD,uD]),hD=h.object({type:h.literal("schematic_component"),size:q3,center:Zt,source_component_id:h.string().optional(),schematic_component_id:h.string(),pin_spacing:D.optional(),pin_styles:cD.optional(),box_width:D.optional(),symbol_name:h.string().optional(),port_arrangement:pD.optional(),port_labels:h.record(h.string()).optional(),symbol_display_value:h.string().optional(),subcircuit_id:h.string().optional(),schematic_group_id:h.string().optional(),is_schematic_group:h.boolean().optional(),source_group_id:h.string().optional(),is_box_with_pins:h.boolean().optional().default(!0)});ft(!0);dD=h.object({type:h.literal("schematic_line"),schematic_line_id:At("schematic_line"),schematic_component_id:h.string(),x1:Y,y1:Y,x2:Y,y2:Y,stroke_width:Y.nullable().optional(),color:h.string().default("#000000"),is_dashed:h.boolean().default(!1),subcircuit_id:h.string().optional()}).describe("Draws a styled line on the schematic");ft(!0);fD=h.object({type:h.literal("schematic_rect"),schematic_rect_id:At("schematic_rect"),schematic_component_id:h.string(),center:Zt,width:Y,height:Y,rotation:He.default(0),stroke_width:Y.nullable().optional(),color:h.string().default("#000000"),is_filled:h.boolean().default(!1),fill_color:h.string().optional(),is_dashed:h.boolean().default(!1),subcircuit_id:h.string().optional()}).describe("Draws a styled rectangle on the schematic");ft(!0);mD=h.object({type:h.literal("schematic_circle"),schematic_circle_id:At("schematic_circle"),schematic_component_id:h.string(),center:Zt,radius:Y,stroke_width:Y.nullable().optional(),color:h.string().default("#000000"),is_filled:h.boolean().default(!1),fill_color:h.string().optional(),is_dashed:h.boolean().default(!1),subcircuit_id:h.string().optional()}).describe("Draws a styled circle on the schematic");ft(!0);_D=h.object({type:h.literal("schematic_arc"),schematic_arc_id:At("schematic_arc"),schematic_component_id:h.string(),center:Zt,radius:Y,start_angle_degrees:He,end_angle_degrees:He,direction:h.enum(["clockwise","counterclockwise"]).default("counterclockwise"),stroke_width:Y.nullable().optional(),color:h.string().default("#000000"),is_dashed:h.boolean().default(!1),subcircuit_id:h.string().optional()}).describe("Draws a styled arc on the schematic");ft(!0);yD=h.object({type:h.literal("schematic_trace"),schematic_trace_id:h.string(),source_trace_id:h.string().optional(),junctions:h.array(h.object({x:h.number(),y:h.number()})),edges:h.array(h.object({from:h.object({x:h.number(),y:h.number()}),to:h.object({x:h.number(),y:h.number()}),is_crossing:h.boolean().optional(),from_schematic_port_id:h.string().optional(),to_schematic_port_id:h.string().optional()})),subcircuit_id:h.string().optional(),subcircuit_connectivity_map_key:h.string().optional()});ft(!0);Bdt=h.enum(["center","left","right","top","bottom"]);ft(!0);gD=h.object({type:h.literal("schematic_text"),schematic_component_id:h.string().optional(),schematic_text_id:h.string(),text:h.string(),font_size:h.number().default(.18),position:h.object({x:Y,y:Y}),rotation:h.number().default(0),anchor:h.union([Bdt.describe("legacy"),rg]).default("center"),color:h.string().default("#000000"),subcircuit_id:h.string().optional()});ft(!0);xD=h.object({type:h.literal("schematic_port"),schematic_port_id:h.string(),source_port_id:h.string(),schematic_component_id:h.string().optional(),center:Zt,facing_direction:h.enum(["up","down","left","right"]).optional(),distance_from_component_edge:h.number().optional(),side_of_component:h.enum(["top","bottom","left","right"]).optional(),true_ccw_index:h.number().optional(),pin_number:h.number().optional(),display_pin_label:h.string().optional(),subcircuit_id:h.string().optional(),is_connected:h.boolean().optional(),has_input_arrow:h.boolean().optional(),has_output_arrow:h.boolean().optional()}).describe("Defines a port on a schematic component");ft(!0);bD=h.object({type:h.literal("schematic_net_label"),schematic_net_label_id:At("schematic_net_label"),schematic_trace_id:h.string().optional(),source_trace_id:h.string().optional(),source_net_id:h.string(),center:Zt,anchor_position:Zt.optional(),anchor_side:h.enum(["top","bottom","left","right"]),text:h.string(),symbol_name:h.string().optional(),is_movable:h.boolean().optional(),subcircuit_id:h.string().optional()});ft(!0);vD=h.object({type:h.literal("schematic_error"),schematic_error_id:h.string(),error_type:h.literal("schematic_port_not_found").default("schematic_port_not_found"),message:h.string(),subcircuit_id:h.string().optional()}).describe("Defines a schematic error on the schematic");ft(!0);SD=h.object({type:h.literal("schematic_layout_error"),schematic_layout_error_id:At("schematic_layout_error"),error_type:h.literal("schematic_layout_error").default("schematic_layout_error"),message:h.string(),source_group_id:h.string(),schematic_group_id:h.string(),subcircuit_id:h.string().optional()}).describe("Error emitted when schematic layout fails for a group");ft(!0);Ux=h.object({type:h.literal("schematic_debug_object"),label:h.string().optional(),subcircuit_id:h.string().optional()}),wD=Ux.extend({shape:h.literal("rect"),center:Zt,size:q3}),PD=Ux.extend({shape:h.literal("line"),start:Zt,end:Zt}),kD=Ux.extend({shape:h.literal("point"),center:Zt}),TD=h.discriminatedUnion("shape",[wD,PD,kD]);ft(!0);ED=h.object({type:h.literal("schematic_voltage_probe"),schematic_voltage_probe_id:h.string(),source_component_id:h.string().optional(),name:h.string().optional(),position:Zt,schematic_trace_id:h.string(),voltage:Pi.optional(),subcircuit_id:h.string().optional(),color:h.string().optional()}).describe("Defines a voltage probe measurement point on a schematic trace");ft(!0);Vx=h.object({type:h.literal("schematic_manual_edit_conflict_warning"),schematic_manual_edit_conflict_warning_id:At("schematic_manual_edit_conflict_warning"),warning_type:h.literal("schematic_manual_edit_conflict_warning").default("schematic_manual_edit_conflict_warning"),message:h.string(),schematic_component_id:h.string(),schematic_group_id:h.string().optional(),subcircuit_id:h.string().optional(),source_component_id:h.string()}).describe("Warning emitted when a component has both manual placement and explicit schX/schY coordinates");ft(!0);MD=h.object({type:h.literal("schematic_group"),schematic_group_id:At("schematic_group"),source_group_id:h.string(),is_subcircuit:h.boolean().optional(),subcircuit_id:h.string().optional(),width:D,height:D,center:Zt,schematic_component_ids:h.array(h.string()),show_as_schematic_box:h.boolean().optional(),name:h.string().optional(),description:h.string().optional()}).describe("Defines a group of components on the schematic");ft(!0);CD=h.object({type:h.literal("schematic_table"),schematic_table_id:At("schematic_table"),anchor_position:Zt,column_widths:h.array(Y),row_heights:h.array(Y),cell_padding:Y.optional(),border_width:Y.optional(),subcircuit_id:h.string().optional(),schematic_component_id:h.string().optional(),anchor:rg.optional()}).describe("Defines a table on the schematic");ft(!0);ID=h.object({type:h.literal("schematic_table_cell"),schematic_table_cell_id:At("schematic_table_cell"),schematic_table_id:h.string(),start_row_index:h.number(),end_row_index:h.number(),start_column_index:h.number(),end_column_index:h.number(),text:h.string().optional(),center:Zt,width:Y,height:Y,horizontal_align:h.enum(["left","center","right"]).optional(),vertical_align:h.enum(["top","middle","bottom"]).optional(),font_size:Y.optional(),subcircuit_id:h.string().optional()}).describe("Defines a cell within a schematic_table");ft(!0);ND=h.object({type:h.literal("schematic_sheet"),schematic_sheet_id:At("schematic_sheet"),name:h.string().optional(),subcircuit_id:h.string().optional()}).describe("Defines a schematic sheet or page that components can be placed on");ft(!0);AD=h.object({x:Y,y:Y,bulge:h.number().optional()});ft(!0);W3=h.object({vertices:h.array(AD)});ft(!0);RD=h.object({outer_ring:W3,inner_rings:h.array(W3).default([])});ft(!0);OD=h.object({x:Y,y:Y,via:h.boolean().optional(),via_to_layer:pe.optional()}),Ydt=h.array(OD);ft(!0);ft(!0);Qi=h.object({x:Y,y:Y,via:h.boolean().optional(),to_layer:pe.optional(),trace_width:Y.optional()});ft(!0);LD=h.object({type:h.literal("pcb_component"),pcb_component_id:At("pcb_component"),source_component_id:h.string(),center:Zt,layer:pe,rotation:He,width:D,height:D,do_not_place:h.boolean().optional(),subcircuit_id:h.string().optional(),pcb_group_id:h.string().optional(),position_mode:h.enum(["packed","relative_to_group_anchor","none"]).optional(),positioned_relative_to_pcb_group_id:h.string().optional(),obstructs_within_bounds:h.boolean().default(!0).describe("Does this component take up all the space within its bounds on a layer. This is generally true except for when separated pin headers are being represented by a single component (in which case, chips can be placed between the pin headers) or for tall modules where chips fit underneath")}).describe("Defines a component on the PCB");ft(!0);FD=h.object({type:h.literal("pcb_hole"),pcb_hole_id:At("pcb_hole"),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),hole_shape:h.literal("circle"),hole_diameter:h.number(),x:Y,y:Y,soldermask_margin:h.number().optional()}),Xdt=FD.describe("Defines a circular hole on the PCB");ft(!0);zD=h.object({type:h.literal("pcb_hole"),pcb_hole_id:At("pcb_hole"),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),hole_shape:h.literal("rect"),hole_width:h.number(),hole_height:h.number(),x:Y,y:Y,soldermask_margin:h.number().optional()}),Udt=zD.describe("Defines a rectangular (square-capable) hole on the PCB. Use equal width/height for square.");ft(!0);$D=h.object({type:h.literal("pcb_hole"),pcb_hole_id:At("pcb_hole"),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),hole_shape:h.enum(["circle","square"]),hole_diameter:h.number(),x:Y,y:Y,soldermask_margin:h.number().optional()}),Vdt=$D.describe("Defines a circular or square hole on the PCB");ft(!0);DD=h.object({type:h.literal("pcb_hole"),pcb_hole_id:At("pcb_hole"),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),hole_shape:h.literal("oval"),hole_width:h.number(),hole_height:h.number(),x:Y,y:Y,soldermask_margin:h.number().optional()}),Gdt=DD.describe("Defines an oval hole on the PCB");ft(!0);jD=h.object({type:h.literal("pcb_hole"),pcb_hole_id:At("pcb_hole"),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),hole_shape:h.literal("pill"),hole_width:h.number(),hole_height:h.number(),x:Y,y:Y,soldermask_margin:h.number().optional()}),Hdt=jD.describe("Defines a pill-shaped hole on the PCB");ft(!0);BD=h.object({type:h.literal("pcb_hole"),pcb_hole_id:At("pcb_hole"),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),hole_shape:h.literal("rotated_pill"),hole_width:h.number(),hole_height:h.number(),x:Y,y:Y,ccw_rotation:He,soldermask_margin:h.number().optional()}),Wdt=BD.describe("Defines a rotated pill-shaped hole on the PCB");ft(!0);YD=$D.or(DD).or(jD).or(BD).or(FD).or(zD),qdt=h.object({type:h.literal("pcb_plated_hole"),shape:h.literal("circle"),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),outer_diameter:h.number(),hole_diameter:h.number(),x:Y,y:Y,layers:h.array(pe),port_hints:h.array(h.string()).optional(),pcb_component_id:h.string().optional(),pcb_port_id:h.string().optional(),pcb_plated_hole_id:At("pcb_plated_hole"),soldermask_margin:h.number().optional()}),Zdt=h.object({type:h.literal("pcb_plated_hole"),shape:h.enum(["oval","pill"]),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),outer_width:h.number(),outer_height:h.number(),hole_width:h.number(),hole_height:h.number(),x:Y,y:Y,ccw_rotation:He,layers:h.array(pe),port_hints:h.array(h.string()).optional(),pcb_component_id:h.string().optional(),pcb_port_id:h.string().optional(),pcb_plated_hole_id:At("pcb_plated_hole"),soldermask_margin:h.number().optional()}),Kdt=h.object({type:h.literal("pcb_plated_hole"),shape:h.literal("circular_hole_with_rect_pad"),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),hole_shape:h.literal("circle"),pad_shape:h.literal("rect"),hole_diameter:h.number(),rect_pad_width:h.number(),rect_pad_height:h.number(),rect_border_radius:h.number().optional(),hole_offset_x:Y.default(0),hole_offset_y:Y.default(0),x:Y,y:Y,layers:h.array(pe),port_hints:h.array(h.string()).optional(),pcb_component_id:h.string().optional(),pcb_port_id:h.string().optional(),pcb_plated_hole_id:At("pcb_plated_hole"),soldermask_margin:h.number().optional()}),Jdt=h.object({type:h.literal("pcb_plated_hole"),shape:h.literal("pill_hole_with_rect_pad"),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),hole_shape:h.literal("pill"),pad_shape:h.literal("rect"),hole_width:h.number(),hole_height:h.number(),rect_pad_width:h.number(),rect_pad_height:h.number(),rect_border_radius:h.number().optional(),hole_offset_x:Y.default(0),hole_offset_y:Y.default(0),x:Y,y:Y,layers:h.array(pe),port_hints:h.array(h.string()).optional(),pcb_component_id:h.string().optional(),pcb_port_id:h.string().optional(),pcb_plated_hole_id:At("pcb_plated_hole"),soldermask_margin:h.number().optional()}),Qdt=h.object({type:h.literal("pcb_plated_hole"),shape:h.literal("rotated_pill_hole_with_rect_pad"),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),hole_shape:h.literal("rotated_pill"),pad_shape:h.literal("rect"),hole_width:h.number(),hole_height:h.number(),hole_ccw_rotation:He,rect_pad_width:h.number(),rect_pad_height:h.number(),rect_border_radius:h.number().optional(),rect_ccw_rotation:He,hole_offset_x:Y.default(0),hole_offset_y:Y.default(0),x:Y,y:Y,layers:h.array(pe),port_hints:h.array(h.string()).optional(),pcb_component_id:h.string().optional(),pcb_port_id:h.string().optional(),pcb_plated_hole_id:At("pcb_plated_hole"),soldermask_margin:h.number().optional()}),tft=h.object({type:h.literal("pcb_plated_hole"),shape:h.literal("hole_with_polygon_pad"),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),hole_shape:h.enum(["circle","oval","pill","rotated_pill"]),hole_diameter:h.number().optional(),hole_width:h.number().optional(),hole_height:h.number().optional(),pad_outline:h.array(h.object({x:Y,y:Y})).min(3),hole_offset_x:Y.default(0),hole_offset_y:Y.default(0),x:Y,y:Y,layers:h.array(pe),port_hints:h.array(h.string()).optional(),pcb_component_id:h.string().optional(),pcb_port_id:h.string().optional(),pcb_plated_hole_id:At("pcb_plated_hole"),soldermask_margin:h.number().optional()}),XD=h.union([qdt,Zdt,Kdt,Jdt,Qdt,tft]);ft(!0);ft(!0);ft(!0);ft(!0);ft(!0);ft(!0);UD=h.object({type:h.literal("pcb_port"),pcb_port_id:At("pcb_port"),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),source_port_id:h.string(),pcb_component_id:h.string().optional(),x:Y,y:Y,layers:h.array(pe),is_board_pinout:h.boolean().optional()}).describe("Defines a port on the PCB");ft(!0);eft=h.object({type:h.literal("pcb_smtpad"),shape:h.literal("circle"),pcb_smtpad_id:At("pcb_smtpad"),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),x:Y,y:Y,radius:h.number(),layer:pe,port_hints:h.array(h.string()).optional(),pcb_component_id:h.string().optional(),pcb_port_id:h.string().optional(),is_covered_with_solder_mask:h.boolean().optional(),soldermask_margin:h.number().optional()}),nft=h.object({type:h.literal("pcb_smtpad"),shape:h.literal("rect"),pcb_smtpad_id:At("pcb_smtpad"),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),x:Y,y:Y,width:h.number(),height:h.number(),rect_border_radius:h.number().optional(),corner_radius:h.number().optional(),layer:pe,port_hints:h.array(h.string()).optional(),pcb_component_id:h.string().optional(),pcb_port_id:h.string().optional(),is_covered_with_solder_mask:h.boolean().optional(),soldermask_margin:h.number().optional()}),ift=h.object({type:h.literal("pcb_smtpad"),shape:h.literal("rotated_rect"),pcb_smtpad_id:At("pcb_smtpad"),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),x:Y,y:Y,width:h.number(),height:h.number(),rect_border_radius:h.number().optional(),corner_radius:h.number().optional(),ccw_rotation:He,layer:pe,port_hints:h.array(h.string()).optional(),pcb_component_id:h.string().optional(),pcb_port_id:h.string().optional(),is_covered_with_solder_mask:h.boolean().optional(),soldermask_margin:h.number().optional()}),VD=h.object({type:h.literal("pcb_smtpad"),shape:h.literal("pill"),pcb_smtpad_id:At("pcb_smtpad"),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),x:Y,y:Y,width:h.number(),height:h.number(),radius:h.number(),layer:pe,port_hints:h.array(h.string()).optional(),pcb_component_id:h.string().optional(),pcb_port_id:h.string().optional(),is_covered_with_solder_mask:h.boolean().optional(),soldermask_margin:h.number().optional()}),rft=h.object({type:h.literal("pcb_smtpad"),shape:h.literal("rotated_pill"),pcb_smtpad_id:At("pcb_smtpad"),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),x:Y,y:Y,width:h.number(),height:h.number(),radius:h.number(),ccw_rotation:He,layer:pe,port_hints:h.array(h.string()).optional(),pcb_component_id:h.string().optional(),pcb_port_id:h.string().optional(),is_covered_with_solder_mask:h.boolean().optional(),soldermask_margin:h.number().optional()}),sft=h.object({type:h.literal("pcb_smtpad"),shape:h.literal("polygon"),pcb_smtpad_id:At("pcb_smtpad"),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),points:h.array(Zt),layer:pe,port_hints:h.array(h.string()).optional(),pcb_component_id:h.string().optional(),pcb_port_id:h.string().optional(),is_covered_with_solder_mask:h.boolean().optional(),soldermask_margin:h.number().optional()}),GD=h.discriminatedUnion("shape",[eft,nft,ift,rft,VD,sft]).describe("Defines an SMT pad on the PCB");ft(!0);ft(!0);ft(!0);ft(!0);ft(!0);ft(!0);oft=h.object({type:h.literal("pcb_solder_paste"),shape:h.literal("circle"),pcb_solder_paste_id:At("pcb_solder_paste"),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),x:Y,y:Y,radius:h.number(),layer:pe,pcb_component_id:h.string().optional(),pcb_smtpad_id:h.string().optional()}),aft=h.object({type:h.literal("pcb_solder_paste"),shape:h.literal("rect"),pcb_solder_paste_id:At("pcb_solder_paste"),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),x:Y,y:Y,width:h.number(),height:h.number(),layer:pe,pcb_component_id:h.string().optional(),pcb_smtpad_id:h.string().optional()}),cft=h.object({type:h.literal("pcb_solder_paste"),shape:h.literal("pill"),pcb_solder_paste_id:At("pcb_solder_paste"),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),x:Y,y:Y,width:h.number(),height:h.number(),radius:h.number(),layer:pe,pcb_component_id:h.string().optional(),pcb_smtpad_id:h.string().optional()}),lft=h.object({type:h.literal("pcb_solder_paste"),shape:h.literal("rotated_rect"),pcb_solder_paste_id:At("pcb_solder_paste"),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),x:Y,y:Y,width:h.number(),height:h.number(),ccw_rotation:Y,layer:pe,pcb_component_id:h.string().optional(),pcb_smtpad_id:h.string().optional()}),uft=h.object({type:h.literal("pcb_solder_paste"),shape:h.literal("oval"),pcb_solder_paste_id:At("pcb_solder_paste"),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),x:Y,y:Y,width:h.number(),height:h.number(),layer:pe,pcb_component_id:h.string().optional(),pcb_smtpad_id:h.string().optional()}),HD=h.union([oft,aft,cft,lft,uft]).describe("Defines solderpaste on the PCB");ft(!0);ft(!0);ft(!0);ft(!0);ft(!0);WD=h.object({type:h.literal("pcb_text"),pcb_text_id:At("pcb_text"),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),text:h.string(),center:Zt,layer:pe,width:D,height:D,lines:h.number(),align:h.enum(["bottom-left"])}).describe("Defines text on the PCB");ft(!0);qD=h.object({route_type:h.literal("wire"),x:Y,y:Y,width:Y,start_pcb_port_id:h.string().optional(),end_pcb_port_id:h.string().optional(),layer:pe}),ZD=h.object({route_type:h.literal("via"),x:Y,y:Y,hole_diameter:Y.optional(),outer_diameter:Y.optional(),from_layer:h.string(),to_layer:h.string()}),Gx=h.union([qD,ZD]),KD=h.object({type:h.literal("pcb_trace"),source_trace_id:h.string().optional(),pcb_component_id:h.string().optional(),pcb_trace_id:At("pcb_trace"),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),route_thickness_mode:h.enum(["constant","interpolated"]).default("constant").optional(),route_order_index:h.number().optional(),should_round_corners:h.boolean().optional(),trace_length:h.number().optional(),highlight_color:h.string().optional(),route:h.array(Gx)}).describe("Defines a trace on the PCB");ft(!0);ft(!0);JD=h.object({type:h.literal("pcb_trace_error"),pcb_trace_error_id:At("pcb_trace_error"),error_type:h.literal("pcb_trace_error").default("pcb_trace_error"),message:h.string(),center:Zt.optional(),pcb_trace_id:h.string(),source_trace_id:h.string(),pcb_component_ids:h.array(h.string()),pcb_port_ids:h.array(h.string()),subcircuit_id:h.string().optional()}).describe("Defines a trace error on the PCB");ft(!0);QD=h.object({type:h.literal("pcb_trace_missing_error"),pcb_trace_missing_error_id:At("pcb_trace_missing_error"),error_type:h.literal("pcb_trace_missing_error").default("pcb_trace_missing_error"),message:h.string(),center:Zt.optional(),source_trace_id:h.string(),pcb_component_ids:h.array(h.string()),pcb_port_ids:h.array(h.string()),subcircuit_id:h.string().optional()}).describe("Defines an error when a source trace has no corresponding PCB trace");ft(!0);tj=h.object({type:h.literal("pcb_port_not_matched_error"),pcb_error_id:At("pcb_error"),error_type:h.literal("pcb_port_not_matched_error").default("pcb_port_not_matched_error"),message:h.string(),pcb_component_ids:h.array(h.string()),subcircuit_id:h.string().optional()}).describe("Defines a trace error on the PCB where a port is not matched");ft(!0);ej=h.object({type:h.literal("pcb_port_not_connected_error"),pcb_port_not_connected_error_id:At("pcb_port_not_connected_error"),error_type:h.literal("pcb_port_not_connected_error").default("pcb_port_not_connected_error"),message:h.string(),pcb_port_ids:h.array(h.string()),pcb_component_ids:h.array(h.string()),subcircuit_id:h.string().optional()}).describe("Defines an error when a pcb port is not connected to any trace");ft(!0);nj=h.object({type:h.literal("pcb_net"),pcb_net_id:At("pcb_net"),source_net_id:h.string().optional(),highlight_color:h.string().optional()}).describe("Defines a net on the PCB");ft(!0);ij=h.object({type:h.literal("pcb_via"),pcb_via_id:At("pcb_via"),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),subcircuit_connectivity_map_key:h.string().optional(),x:Y,y:Y,outer_diameter:Y.default("0.6mm"),hole_diameter:Y.default("0.25mm"),from_layer:pe.optional(),to_layer:pe.optional(),layers:h.array(pe),pcb_trace_id:h.string().optional(),net_is_assignable:h.boolean().optional(),net_assigned:h.boolean().optional()}).describe("Defines a via on the PCB");ft(!0);rj=h.object({type:h.literal("pcb_board"),pcb_board_id:At("pcb_board"),pcb_panel_id:h.string().optional(),is_subcircuit:h.boolean().optional(),subcircuit_id:h.string().optional(),width:D.optional(),height:D.optional(),center:Zt,thickness:D.optional().default(1.4),num_layers:h.number().optional().default(4),outline:h.array(Zt).optional(),shape:h.enum(["rect","polygon"]).optional(),material:h.enum(["fr4","fr1"]).default("fr4")}).describe("Defines the board outline of the PCB");ft(!0);sj=h.object({type:h.literal("pcb_panel"),pcb_panel_id:At("pcb_panel"),width:D,height:D,center:Zt,covered_with_solder_mask:h.boolean().optional().default(!0)}).describe("Defines a PCB panel that can contain multiple boards");ft(!0);oj=h.object({type:h.literal("pcb_placement_error"),pcb_placement_error_id:At("pcb_placement_error"),error_type:h.literal("pcb_placement_error").default("pcb_placement_error"),message:h.string(),subcircuit_id:h.string().optional()}).describe("Defines a placement error on the PCB");ft(!0);aj=h.object({type:h.literal("pcb_trace_hint"),pcb_trace_hint_id:At("pcb_trace_hint"),pcb_port_id:h.string(),pcb_component_id:h.string(),route:h.array(Qi),subcircuit_id:h.string().optional()}).describe("A hint that can be used during generation of a PCB trace");ft(!0);cj=h.object({type:h.literal("pcb_silkscreen_line"),pcb_silkscreen_line_id:At("pcb_silkscreen_line"),pcb_component_id:h.string(),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),stroke_width:Y.default("0.1mm"),x1:Y,y1:Y,x2:Y,y2:Y,layer:Js}).describe("Defines a silkscreen line on the PCB");ft(!0);lj=h.object({type:h.literal("pcb_silkscreen_path"),pcb_silkscreen_path_id:At("pcb_silkscreen_path"),pcb_component_id:h.string(),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),layer:Js,route:h.array(Zt),stroke_width:D}).describe("Defines a silkscreen path on the PCB");ft(!0);uj=h.object({type:h.literal("pcb_silkscreen_text"),pcb_silkscreen_text_id:At("pcb_silkscreen_text"),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),font:h.literal("tscircuit2024").default("tscircuit2024"),font_size:Y.default("0.2mm"),pcb_component_id:h.string(),text:h.string(),is_knockout:h.boolean().default(!1).optional(),knockout_padding:h.object({left:D,top:D,bottom:D,right:D}).default({left:"0.2mm",top:"0.2mm",bottom:"0.2mm",right:"0.2mm"}).optional(),ccw_rotation:h.number().optional(),layer:pe,is_mirrored:h.boolean().default(!1).optional(),anchor_position:Zt.default({x:0,y:0}),anchor_alignment:rg.default("center")}).describe("Defines silkscreen text on the PCB");ft(!0);pj=h.object({type:h.literal("pcb_copper_text"),pcb_copper_text_id:At("pcb_copper_text"),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),font:h.literal("tscircuit2024").default("tscircuit2024"),font_size:Y.default("0.2mm"),pcb_component_id:h.string(),text:h.string(),is_knockout:h.boolean().default(!1).optional(),knockout_padding:h.object({left:D,top:D,bottom:D,right:D}).default({left:"0.2mm",top:"0.2mm",bottom:"0.2mm",right:"0.2mm"}).optional(),ccw_rotation:h.number().optional(),layer:pe,is_mirrored:h.boolean().default(!1).optional(),anchor_position:Zt.default({x:0,y:0}),anchor_alignment:rg.default("center")}).describe("Defines copper text on the PCB");ft(!0);hj=h.object({type:h.literal("pcb_silkscreen_rect"),pcb_silkscreen_rect_id:At("pcb_silkscreen_rect"),pcb_component_id:h.string(),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),center:Zt,width:D,height:D,layer:pe,stroke_width:D.default("1mm"),corner_radius:D.optional(),is_filled:h.boolean().default(!0).optional(),has_stroke:h.boolean().optional(),is_stroke_dashed:h.boolean().optional()}).describe("Defines a silkscreen rect on the PCB");ft(!0);dj=h.object({type:h.literal("pcb_silkscreen_circle"),pcb_silkscreen_circle_id:At("pcb_silkscreen_circle"),pcb_component_id:h.string(),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),center:Zt,radius:D,layer:Js,stroke_width:D.default("1mm")}).describe("Defines a silkscreen circle on the PCB");ft(!0);fj=h.object({type:h.literal("pcb_silkscreen_oval"),pcb_silkscreen_oval_id:At("pcb_silkscreen_oval"),pcb_component_id:h.string(),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),center:Zt,radius_x:Y,radius_y:Y,layer:Js}).describe("Defines a silkscreen oval on the PCB");ft(!0);mj=h.object({type:h.literal("pcb_fabrication_note_text"),pcb_fabrication_note_text_id:At("pcb_fabrication_note_text"),subcircuit_id:h.string().optional(),pcb_group_id:h.string().optional(),font:h.literal("tscircuit2024").default("tscircuit2024"),font_size:Y.default("1mm"),pcb_component_id:h.string(),text:h.string(),layer:Js,anchor_position:Zt.default({x:0,y:0}),anchor_alignment:h.enum(["center","top_left","top_right","bottom_left","bottom_right"]).default("center"),color:h.string().optional()}).describe("Defines a fabrication note in text on the PCB, useful for leaving notes for assemblers or fabricators");ft(!0);_j=h.object({type:h.literal("pcb_fabrication_note_path"),pcb_fabrication_note_path_id:At("pcb_fabrication_note_path"),pcb_component_id:h.string(),subcircuit_id:h.string().optional(),layer:pe,route:h.array(Zt),stroke_width:D,color:h.string().optional()}).describe("Defines a fabrication path on the PCB for fabricators or assemblers");ft(!0);yj=h.object({type:h.literal("pcb_fabrication_note_rect"),pcb_fabrication_note_rect_id:At("pcb_fabrication_note_rect"),pcb_component_id:h.string(),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),center:Zt,width:D,height:D,layer:Js,stroke_width:D.default("0.1mm"),corner_radius:D.optional(),is_filled:h.boolean().optional(),has_stroke:h.boolean().optional(),is_stroke_dashed:h.boolean().optional(),color:h.string().optional()}).describe("Defines a fabrication note rectangle on the PCB");ft(!0);gj=h.object({type:h.literal("pcb_fabrication_note_dimension"),pcb_fabrication_note_dimension_id:At("pcb_fabrication_note_dimension"),pcb_component_id:h.string(),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),layer:Js,from:Zt,to:Zt,text:h.string().optional(),text_ccw_rotation:h.number().optional(),offset:D.optional(),offset_distance:D.optional(),offset_direction:h.object({x:h.number(),y:h.number()}).optional(),font:h.literal("tscircuit2024").default("tscircuit2024"),font_size:D.default("1mm"),color:h.string().optional(),arrow_size:D.default("1mm")}).describe("Defines a measurement annotation within PCB fabrication notes");ft(!0);xj=h.object({type:h.literal("pcb_note_text"),pcb_note_text_id:At("pcb_note_text"),pcb_component_id:h.string().optional(),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),name:h.string().optional(),font:h.literal("tscircuit2024").default("tscircuit2024"),font_size:Y.default("1mm"),text:h.string().optional(),anchor_position:Zt.default({x:0,y:0}),anchor_alignment:h.enum(["center","top_left","top_right","bottom_left","bottom_right"]).default("center"),color:h.string().optional()}).describe("Defines a documentation note in text on the PCB");ft(!0);bj=h.object({type:h.literal("pcb_note_rect"),pcb_note_rect_id:At("pcb_note_rect"),pcb_component_id:h.string().optional(),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),name:h.string().optional(),text:h.string().optional(),center:Zt,width:D,height:D,stroke_width:D.default("0.1mm"),corner_radius:D.optional(),is_filled:h.boolean().optional(),has_stroke:h.boolean().optional(),is_stroke_dashed:h.boolean().optional(),color:h.string().optional()}).describe("Defines a rectangular documentation note on the PCB");ft(!0);vj=h.object({type:h.literal("pcb_note_path"),pcb_note_path_id:At("pcb_note_path"),pcb_component_id:h.string().optional(),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),name:h.string().optional(),text:h.string().optional(),route:h.array(Zt),stroke_width:D.default("0.1mm"),color:h.string().optional()}).describe("Defines a polyline documentation note on the PCB");ft(!0);Sj=h.object({type:h.literal("pcb_note_line"),pcb_note_line_id:At("pcb_note_line"),pcb_component_id:h.string().optional(),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),name:h.string().optional(),text:h.string().optional(),x1:Y,y1:Y,x2:Y,y2:Y,stroke_width:Y.default("0.1mm"),color:h.string().optional(),is_dashed:h.boolean().optional()}).describe("Defines a straight documentation note line on the PCB");ft(!0);wj=h.object({type:h.literal("pcb_note_dimension"),pcb_note_dimension_id:At("pcb_note_dimension"),pcb_component_id:h.string().optional(),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),name:h.string().optional(),from:Zt,to:Zt,text:h.string().optional(),text_ccw_rotation:h.number().optional(),offset_distance:D.optional(),offset_direction:h.object({x:h.number(),y:h.number()}).optional(),font:h.literal("tscircuit2024").default("tscircuit2024"),font_size:D.default("1mm"),color:h.string().optional(),arrow_size:D.default("1mm")}).describe("Defines a measurement annotation within PCB documentation notes");ft(!0);Pj=h.object({type:h.literal("pcb_footprint_overlap_error"),pcb_error_id:At("pcb_error"),error_type:h.literal("pcb_footprint_overlap_error").default("pcb_footprint_overlap_error"),message:h.string(),pcb_smtpad_ids:h.array(h.string()).optional(),pcb_plated_hole_ids:h.array(h.string()).optional(),pcb_hole_ids:h.array(h.string()).optional(),pcb_keepout_ids:h.array(h.string()).optional()}).describe("Error emitted when a pcb footprint overlaps with another element");ft(!0);kj=h.object({type:h.literal("pcb_keepout"),shape:h.literal("rect"),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),center:Zt,width:Y,height:Y,pcb_keepout_id:h.string(),layers:h.array(h.string()),description:h.string().optional()}).or(h.object({type:h.literal("pcb_keepout"),shape:h.literal("circle"),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),center:Zt,radius:Y,pcb_keepout_id:h.string(),layers:h.array(h.string()),description:h.string().optional()}));ft(!0);Hx=h.object({type:h.literal("pcb_cutout"),pcb_cutout_id:At("pcb_cutout"),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),pcb_board_id:h.string().optional(),pcb_panel_id:h.string().optional()}),Tj=Hx.extend({shape:h.literal("rect"),center:Zt,width:D,height:D,rotation:He.optional(),corner_radius:D.optional()});ft(!0);Ej=Hx.extend({shape:h.literal("circle"),center:Zt,radius:D});ft(!0);Mj=Hx.extend({shape:h.literal("polygon"),points:h.array(Zt)});ft(!0);Cj=Hx.extend({shape:h.literal("path"),route:h.array(Zt),slot_width:D,slot_length:D.optional(),space_between_slots:D.optional(),slot_corner_radius:D.optional()});ft(!0);Ij=h.discriminatedUnion("shape",[Tj,Ej,Mj,Cj]).describe("Defines a cutout on the PCB, removing board material.");ft(!0);Nj=h.object({type:h.literal("pcb_missing_footprint_error"),pcb_missing_footprint_error_id:At("pcb_missing_footprint_error"),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),error_type:h.literal("pcb_missing_footprint_error").default("pcb_missing_footprint_error"),source_component_id:h.string(),message:h.string()}).describe("Defines a missing footprint error on the PCB");ft(!0);Rm=h.object({type:h.literal("external_footprint_load_error"),external_footprint_load_error_id:At("external_footprint_load_error"),pcb_component_id:h.string(),source_component_id:h.string(),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),footprinter_string:h.string().optional(),error_type:h.literal("external_footprint_load_error").default("external_footprint_load_error"),message:h.string()}).describe("Defines an error when an external footprint fails to load");ft(!0);Wx=h.object({type:h.literal("circuit_json_footprint_load_error"),circuit_json_footprint_load_error_id:At("circuit_json_footprint_load_error"),pcb_component_id:h.string(),source_component_id:h.string(),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),error_type:h.literal("circuit_json_footprint_load_error").default("circuit_json_footprint_load_error"),message:h.string(),circuit_json:h.array(h.any()).optional()}).describe("Defines an error when a circuit JSON footprint fails to load");ft(!0);Aj=h.object({type:h.literal("pcb_group"),pcb_group_id:At("pcb_group"),source_group_id:h.string(),is_subcircuit:h.boolean().optional(),subcircuit_id:h.string().optional(),width:D.optional(),height:D.optional(),center:Zt,outline:h.array(Zt).optional(),anchor_position:Zt.optional(),anchor_alignment:h.enum(["center","top_left","top_right","bottom_left","bottom_right"]).optional(),pcb_component_ids:h.array(h.string()),child_layout_mode:h.enum(["packed","none"]).optional(),name:h.string().optional(),description:h.string().optional(),layout_mode:h.string().optional(),autorouter_configuration:h.object({trace_clearance:D}).optional(),autorouter_used_string:h.string().optional()}).describe("Defines a group of components on the PCB");ft(!0);Rj=h.object({type:h.literal("pcb_autorouting_error"),pcb_error_id:At("pcb_autorouting_error"),error_type:h.literal("pcb_autorouting_error").default("pcb_autorouting_error"),message:h.string(),subcircuit_id:h.string().optional()}).describe("The autorouting has failed to route a portion of the board");ft(!0);qx=h.object({type:h.literal("pcb_manual_edit_conflict_warning"),pcb_manual_edit_conflict_warning_id:At("pcb_manual_edit_conflict_warning"),warning_type:h.literal("pcb_manual_edit_conflict_warning").default("pcb_manual_edit_conflict_warning"),message:h.string(),pcb_component_id:h.string(),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),source_component_id:h.string()}).describe("Warning emitted when a component has both manual placement and explicit pcbX/pcbY coordinates");ft(!0);Oj=h.object({type:h.literal("pcb_breakout_point"),pcb_breakout_point_id:At("pcb_breakout_point"),pcb_group_id:h.string(),subcircuit_id:h.string().optional(),source_trace_id:h.string().optional(),source_port_id:h.string().optional(),source_net_id:h.string().optional(),x:Y,y:Y}).describe("Defines a routing target within a pcb_group for a source_trace or source_net");ft(!0);Lj=h.object({type:h.literal("pcb_ground_plane"),pcb_ground_plane_id:At("pcb_ground_plane"),source_pcb_ground_plane_id:h.string(),source_net_id:h.string(),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional()}).describe("Defines a ground plane on the PCB");ft(!0);Fj=h.object({type:h.literal("pcb_ground_plane_region"),pcb_ground_plane_region_id:At("pcb_ground_plane_region"),pcb_ground_plane_id:h.string(),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),layer:pe,points:h.array(Zt)}).describe("Defines a polygon region of a ground plane");ft(!0);zj=h.object({type:h.literal("pcb_thermal_spoke"),pcb_thermal_spoke_id:At("pcb_thermal_spoke"),pcb_ground_plane_id:h.string(),shape:h.string(),spoke_count:h.number(),spoke_thickness:Y,spoke_inner_diameter:Y,spoke_outer_diameter:Y,pcb_plated_hole_id:h.string().optional(),subcircuit_id:h.string().optional()}).describe("Pattern for connecting a ground plane to a plated hole");ft(!0);mE=h.object({type:h.literal("pcb_copper_pour"),pcb_copper_pour_id:At("pcb_copper_pour"),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),layer:pe,source_net_id:h.string().optional(),covered_with_solder_mask:h.boolean().optional().default(!0)}),$j=mE.extend({shape:h.literal("rect"),center:Zt,width:D,height:D,rotation:He.optional()});ft(!0);Dj=mE.extend({shape:h.literal("brep"),brep_shape:RD});ft(!0);jj=mE.extend({shape:h.literal("polygon"),points:h.array(Zt)});ft(!0);Bj=h.discriminatedUnion("shape",[$j,Dj,jj]).describe("Defines a copper pour on the PCB.");ft(!0);Yj=h.object({type:h.literal("pcb_component_outside_board_error"),pcb_component_outside_board_error_id:At("pcb_component_outside_board_error"),error_type:h.literal("pcb_component_outside_board_error").default("pcb_component_outside_board_error"),message:h.string(),pcb_component_id:h.string(),pcb_board_id:h.string(),component_center:Zt,component_bounds:h.object({min_x:h.number(),max_x:h.number(),min_y:h.number(),max_y:h.number()}),subcircuit_id:h.string().optional(),source_component_id:h.string().optional()}).describe("Error emitted when a PCB component is placed outside the board boundaries");ft(!0);Om=h.object({type:h.literal("pcb_component_invalid_layer_error"),pcb_component_invalid_layer_error_id:At("pcb_component_invalid_layer_error"),error_type:h.literal("pcb_component_invalid_layer_error").default("pcb_component_invalid_layer_error"),message:h.string(),pcb_component_id:h.string().optional(),source_component_id:h.string(),layer:pe,subcircuit_id:h.string().optional()}).describe("Error emitted when a component is placed on an invalid layer (components can only be on 'top' or 'bottom' layers)");ft(!0);Xj=h.object({type:h.literal("pcb_via_clearance_error"),pcb_error_id:At("pcb_error"),error_type:h.literal("pcb_via_clearance_error").default("pcb_via_clearance_error"),message:h.string(),pcb_via_ids:h.array(h.string()).min(2),minimum_clearance:Y.optional(),actual_clearance:Y.optional(),pcb_center:h.object({x:h.number().optional(),y:h.number().optional()}).optional(),subcircuit_id:h.string().optional()}).describe("Error emitted when vias are closer than the allowed clearance");ft(!0);Uj=h.object({type:h.literal("pcb_courtyard_rect"),pcb_courtyard_rect_id:At("pcb_courtyard_rect"),pcb_component_id:h.string(),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),center:Zt,width:D,height:D,layer:Js,color:h.string().optional()}).describe("Defines a courtyard rectangle on the PCB");ft(!0);Vj=h.object({type:h.literal("pcb_courtyard_outline"),pcb_courtyard_outline_id:At("pcb_courtyard_outline"),pcb_component_id:h.string(),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),layer:Js,outline:h.array(Zt).min(2),stroke_width:D.default("0.1mm"),is_closed:h.boolean().optional(),is_stroke_dashed:h.boolean().optional(),color:h.string().optional()}).describe("Defines a courtyard outline on the PCB");ft(!0);Gj=h.object({type:h.literal("pcb_courtyard_polygon"),pcb_courtyard_polygon_id:At("pcb_courtyard_polygon"),pcb_component_id:h.string(),pcb_group_id:h.string().optional(),subcircuit_id:h.string().optional(),layer:Js,points:h.array(Zt).min(3),color:h.string().optional()}).describe("Defines a courtyard polygon on the PCB");ft(!0);Hj=h.object({type:h.literal("cad_component"),cad_component_id:h.string(),pcb_component_id:h.string(),source_component_id:h.string(),position:zh,rotation:zh.optional(),size:zh.optional(),layer:pe.optional(),subcircuit_id:h.string().optional(),footprinter_string:h.string().optional(),model_obj_url:h.string().optional(),model_stl_url:h.string().optional(),model_3mf_url:h.string().optional(),model_gltf_url:h.string().optional(),model_glb_url:h.string().optional(),model_step_url:h.string().optional(),model_wrl_url:h.string().optional(),model_unit_to_mm_scale_factor:h.number().optional(),model_jscad:h.any().optional()}).describe("Defines a component on the PCB");ft(!0);Wj=h.enum(["sinewave","square","triangle","sawtooth"]),pft=h.union([h.string(),h.number()]).transform(n=>typeof n=="string"?n.endsWith("%")?parseFloat(n.slice(0,-1))/100:parseFloat(n):n).pipe(h.number().min(0,"Duty cycle must be non-negative").max(1,"Duty cycle cannot be greater than 100%")),qj=h.object({type:h.literal("simulation_voltage_source"),simulation_voltage_source_id:At("simulation_voltage_source"),is_dc_source:h.literal(!0).optional().default(!0),positive_source_port_id:h.string().optional(),negative_source_port_id:h.string().optional(),positive_source_net_id:h.string().optional(),negative_source_net_id:h.string().optional(),voltage:Pi}).describe("Defines a DC voltage source for simulation"),Zj=h.object({type:h.literal("simulation_voltage_source"),simulation_voltage_source_id:At("simulation_voltage_source"),is_dc_source:h.literal(!1),terminal1_source_port_id:h.string().optional(),terminal2_source_port_id:h.string().optional(),terminal1_source_net_id:h.string().optional(),terminal2_source_net_id:h.string().optional(),voltage:Pi.optional(),frequency:hr.optional(),peak_to_peak_voltage:Pi.optional(),wave_shape:Wj.optional(),phase:He.optional(),duty_cycle:pft.optional()}).describe("Defines an AC voltage source for simulation"),Kj=h.union([qj,Zj]).describe("Defines a voltage source for simulation");ft(!0);ft(!0);ft(!0);Jj=h.union([h.literal("spice_dc_sweep"),h.literal("spice_dc_operating_point"),h.literal("spice_transient_analysis"),h.literal("spice_ac_analysis")]),Qj=h.object({type:h.literal("simulation_experiment"),simulation_experiment_id:At("simulation_experiment"),name:h.string(),experiment_type:Jj,time_per_step:ig.optional(),start_time_ms:pr.optional(),end_time_ms:pr.optional()}).describe("Defines a simulation experiment configuration");ft(!0);tB=h.object({type:h.literal("simulation_transient_voltage_graph"),simulation_transient_voltage_graph_id:At("simulation_transient_voltage_graph"),simulation_experiment_id:h.string(),timestamps_ms:h.array(h.number()).optional(),voltage_levels:h.array(h.number()),source_component_id:h.string().optional(),subcircuit_connectivity_map_key:h.string().optional(),time_per_step:ig,start_time_ms:pr,end_time_ms:pr,name:h.string().optional(),color:h.string().optional()}).describe("Stores voltage measurements over time for a simulation");ft(!0);eB=h.object({type:h.literal("simulation_switch"),simulation_switch_id:At("simulation_switch"),source_component_id:h.string().optional(),closes_at:pr.optional(),opens_at:pr.optional(),starts_closed:h.boolean().optional(),switching_frequency:hr.optional()}).describe("Defines a switch for simulation timing control");ft(!0);nB=h.object({type:h.literal("simulation_voltage_probe"),simulation_voltage_probe_id:At("simulation_voltage_probe"),source_component_id:h.string().optional(),name:h.string().optional(),source_port_id:h.string().optional(),source_net_id:h.string().optional(),subcircuit_id:h.string().optional(),color:h.string().optional()}).describe("Defines a voltage probe for simulation, connected to a port or a net").refine(n=>!!n.source_port_id!=!!n.source_net_id,{message:"Exactly one of source_port_id or source_net_id must be provided to simulation_voltage_probe"});ft(!0);iB=h.object({type:h.literal("simulation_unknown_experiment_error"),simulation_unknown_experiment_error_id:At("simulation_unknown_experiment_error"),error_type:h.literal("simulation_unknown_experiment_error").default("simulation_unknown_experiment_error"),message:h.string(),simulation_experiment_id:h.string().optional(),subcircuit_id:h.string().optional()}).describe("An unknown error occurred during the simulation experiment.");ft(!0);rB=h.union([tD,Q$,J$,nD,eD,Q3,Z3,Yx,J3,K3,tE,eE,nE,sE,oE,aE,pE,cE,lE,uE,rE,iE,rD,sD,iD,hE,dE,fE,Xx,LD,YD,Nj,Rm,Wx,qx,XD,kj,UD,nj,WD,KD,ij,GD,HD,rj,sj,Aj,aj,cj,lj,uj,pj,hj,dj,fj,JD,QD,oj,tj,ej,Xj,_j,mj,yj,gj,xj,bj,vj,Sj,wj,Rj,Pj,Oj,Ij,Lj,Fj,zj,Bj,Yj,Om,Uj,Vj,Gj,oD,gD,dD,fD,mD,_D,hD,xD,yD,aD,vD,SD,bD,TD,ED,Vx,MD,ND,CD,ID,Hj,Kj,Qj,tB,eB,nB,iB]),Dh=rB;ft(!0);$h(!0)});var CB=ue((Lqt,MB)=>{"use strict";var Fm=1e3,zm=Fm*60,$m=zm*60,Xh=$m*24,Igt=Xh*7,Ngt=Xh*365.25;MB.exports=function(n,e){e=e||{};var t=typeof n;if(t==="string"&&n.length>0)return Agt(n);if(t==="number"&&isFinite(n))return e.long?Ogt(n):Rgt(n);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(n))};function Agt(n){if(n=String(n),!(n.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(n);if(e){var t=parseFloat(e[1]),i=(e[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"yrs":case"yr":case"y":return t*Ngt;case"weeks":case"week":case"w":return t*Igt;case"days":case"day":case"d":return t*Xh;case"hours":case"hour":case"hrs":case"hr":case"h":return t*$m;case"minutes":case"minute":case"mins":case"min":case"m":return t*zm;case"seconds":case"second":case"secs":case"sec":case"s":return t*Fm;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function Rgt(n){var e=Math.abs(n);return e>=Xh?Math.round(n/Xh)+"d":e>=$m?Math.round(n/$m)+"h":e>=zm?Math.round(n/zm)+"m":e>=Fm?Math.round(n/Fm)+"s":n+"ms"}function Ogt(n){var e=Math.abs(n);return e>=Xh?sb(n,e,Xh,"day"):e>=$m?sb(n,e,$m,"hour"):e>=zm?sb(n,e,zm,"minute"):e>=Fm?sb(n,e,Fm,"second"):n+" ms"}function sb(n,e,t,i){var r=e>=t*1.5;return Math.round(n/t)+" "+i+(r?"s":"")}});var NB=ue((Fqt,IB)=>{"use strict";function Lgt(n){t.debug=t,t.default=t,t.coerce=c,t.disable=o,t.enable=r,t.enabled=a,t.humanize=CB(),t.destroy=l,Object.keys(n).forEach(u=>{t[u]=n[u]}),t.names=[],t.skips=[],t.formatters={};function e(u){let p=0;for(let f=0;f<u.length;f++)p=(p<<5)-p+u.charCodeAt(f),p|=0;return t.colors[Math.abs(p)%t.colors.length]}t.selectColor=e;function t(u){let p,f=null,y,g;function x(...v){if(!x.enabled)return;let P=x,w=Number(new Date),k=w-(p||w);P.diff=k,P.prev=p,P.curr=w,p=w,v[0]=t.coerce(v[0]),typeof v[0]!="string"&&v.unshift("%O");let T=0;v[0]=v[0].replace(/%([a-zA-Z%])/g,(E,N)=>{if(E==="%%")return"%";T++;let M=t.formatters[N];if(typeof M=="function"){let A=v[T];E=M.call(P,A),v.splice(T,1),T--}return E}),t.formatArgs.call(P,v),(P.log||t.log).apply(P,v)}return x.namespace=u,x.useColors=t.useColors(),x.color=t.selectColor(u),x.extend=i,x.destroy=t.destroy,Object.defineProperty(x,"enabled",{enumerable:!0,configurable:!1,get:()=>f!==null?f:(y!==t.namespaces&&(y=t.namespaces,g=t.enabled(u)),g),set:v=>{f=v}}),typeof t.init=="function"&&t.init(x),x}function i(u,p){let f=t(this.namespace+(typeof p>"u"?":":p)+u);return f.log=this.log,f}function r(u){t.save(u),t.namespaces=u,t.names=[],t.skips=[];let p=(typeof u=="string"?u:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(let f of p)f[0]==="-"?t.skips.push(f.slice(1)):t.names.push(f)}function s(u,p){let f=0,y=0,g=-1,x=0;for(;f<u.length;)if(y<p.length&&(p[y]===u[f]||p[y]==="*"))p[y]==="*"?(g=y,x=f,y++):(f++,y++);else if(g!==-1)y=g+1,x++,f=x;else return!1;for(;y<p.length&&p[y]==="*";)y++;return y===p.length}function o(){let u=[...t.names,...t.skips.map(p=>"-"+p)].join(",");return t.enable(""),u}function a(u){for(let p of t.skips)if(s(u,p))return!1;for(let p of t.names)if(s(u,p))return!0;return!1}function c(u){return u instanceof Error?u.stack||u.message:u}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}IB.exports=Lgt});var Mn=ue(($r,ob)=>{"use strict";$r.formatArgs=zgt;$r.save=$gt;$r.load=Dgt;$r.useColors=Fgt;$r.storage=jgt();$r.destroy=(()=>{let n=!1;return()=>{n||(n=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();$r.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function Fgt(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let n;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(n=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(n[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function zgt(n){if(n[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+n[0]+(this.useColors?"%c ":" ")+"+"+ob.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;n.splice(1,0,e,"color: inherit");let t=0,i=0;n[0].replace(/%[a-zA-Z%]/g,r=>{r!=="%%"&&(t++,r==="%c"&&(i=t))}),n.splice(i,0,e)}$r.log=console.debug||console.log||(()=>{});function $gt(n){try{n?$r.storage.setItem("debug",n):$r.storage.removeItem("debug")}catch{}}function Dgt(){let n;try{n=$r.storage.getItem("debug")||$r.storage.getItem("DEBUG")}catch{}return!n&&typeof process<"u"&&"env"in process&&(n=process.env.DEBUG),n}function jgt(){try{return localStorage}catch{}}ob.exports=NB()($r);var{formatters:Bgt}=ob.exports;Bgt.j=function(n){try{return JSON.stringify(n)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var BB=ue(Vn=>{"use strict";function kE(n,e){var t=n.length;n.push(e);t:for(;0<t;){var i=t-1>>>1,r=n[i];if(0<ab(r,e))n[i]=e,n[t]=r,t=i;else break t}}function No(n){return n.length===0?null:n[0]}function lb(n){if(n.length===0)return null;var e=n[0],t=n.pop();if(t!==e){n[0]=t;t:for(var i=0,r=n.length,s=r>>>1;i<s;){var o=2*(i+1)-1,a=n[o],c=o+1,l=n[c];if(0>ab(a,t))c<r&&0>ab(l,a)?(n[i]=l,n[c]=t,i=c):(n[i]=a,n[o]=t,i=o);else if(c<r&&0>ab(l,t))n[i]=l,n[c]=t,i=c;else break t}}return e}function ab(n,e){var t=n.sortIndex-e.sortIndex;return t!==0?t:n.id-e.id}Vn.unstable_now=void 0;typeof performance=="object"&&typeof performance.now=="function"?(AB=performance,Vn.unstable_now=function(){return AB.now()}):(SE=Date,RB=SE.now(),Vn.unstable_now=function(){return SE.now()-RB});var AB,SE,RB,ka=[],Dc=[],Ygt=1,Ts=null,dr=3,TE=!1,og=!1,ag=!1,EE=!1,FB=typeof setTimeout=="function"?setTimeout:null,zB=typeof clearTimeout=="function"?clearTimeout:null,OB=typeof setImmediate<"u"?setImmediate:null;function cb(n){for(var e=No(Dc);e!==null;){if(e.callback===null)lb(Dc);else if(e.startTime<=n)lb(Dc),e.sortIndex=e.expirationTime,kE(ka,e);else break;e=No(Dc)}}function ME(n){if(ag=!1,cb(n),!og)if(No(ka)!==null)og=!0,jm||(jm=!0,Dm());else{var e=No(Dc);e!==null&&CE(ME,e.startTime-n)}}var jm=!1,cg=-1,$B=5,DB=-1;function jB(){return EE?!0:!(Vn.unstable_now()-DB<$B)}function wE(){if(EE=!1,jm){var n=Vn.unstable_now();DB=n;var e=!0;try{t:{og=!1,ag&&(ag=!1,zB(cg),cg=-1),TE=!0;var t=dr;try{e:{for(cb(n),Ts=No(ka);Ts!==null&&!(Ts.expirationTime>n&&jB());){var i=Ts.callback;if(typeof i=="function"){Ts.callback=null,dr=Ts.priorityLevel;var r=i(Ts.expirationTime<=n);if(n=Vn.unstable_now(),typeof r=="function"){Ts.callback=r,cb(n),e=!0;break e}Ts===No(ka)&&lb(ka),cb(n)}else lb(ka);Ts=No(ka)}if(Ts!==null)e=!0;else{var s=No(Dc);s!==null&&CE(ME,s.startTime-n),e=!1}}break t}finally{Ts=null,dr=t,TE=!1}e=void 0}}finally{e?Dm():jm=!1}}}var Dm;typeof OB=="function"?Dm=function(){OB(wE)}:typeof MessageChannel<"u"?(PE=new MessageChannel,LB=PE.port2,PE.port1.onmessage=wE,Dm=function(){LB.postMessage(null)}):Dm=function(){FB(wE,0)};var PE,LB;function CE(n,e){cg=FB(function(){n(Vn.unstable_now())},e)}Vn.unstable_IdlePriority=5;Vn.unstable_ImmediatePriority=1;Vn.unstable_LowPriority=4;Vn.unstable_NormalPriority=3;Vn.unstable_Profiling=null;Vn.unstable_UserBlockingPriority=2;Vn.unstable_cancelCallback=function(n){n.callback=null};Vn.unstable_forceFrameRate=function(n){0>n||125<n?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$B=0<n?Math.floor(1e3/n):5};Vn.unstable_getCurrentPriorityLevel=function(){return dr};Vn.unstable_next=function(n){switch(dr){case 1:case 2:case 3:var e=3;break;default:e=dr}var t=dr;dr=e;try{return n()}finally{dr=t}};Vn.unstable_requestPaint=function(){EE=!0};Vn.unstable_runWithPriority=function(n,e){switch(n){case 1:case 2:case 3:case 4:case 5:break;default:n=3}var t=dr;dr=n;try{return e()}finally{dr=t}};Vn.unstable_scheduleCallback=function(n,e,t){var i=Vn.unstable_now();switch(typeof t=="object"&&t!==null?(t=t.delay,t=typeof t=="number"&&0<t?i+t:i):t=i,n){case 1:var r=-1;break;case 2:r=250;break;case 5:r=1073741823;break;case 4:r=1e4;break;default:r=5e3}return r=t+r,n={id:Ygt++,callback:e,priorityLevel:n,startTime:t,expirationTime:r,sortIndex:-1},t>i?(n.sortIndex=t,kE(Dc,n),No(ka)===null&&n===No(Dc)&&(ag?(zB(cg),cg=-1):ag=!0,CE(ME,t-i))):(n.sortIndex=r,kE(ka,n),og||TE||(og=!0,jm||(jm=!0,Dm()))),n};Vn.unstable_shouldYield=jB;Vn.unstable_wrapCallback=function(n){var e=dr;return function(){var t=dr;dr=e;try{return n.apply(this,arguments)}finally{dr=t}}}});var XB=ue(($qt,YB)=>{"use strict";YB.exports=BB()});var UB=ue((Dqt,lg)=>{"use strict";lg.exports=function(n){function e(m,_,S,C){return new eut(m,_,S,C)}function t(){}function i(m){var _="https://react.dev/errors/"+m;if(1<arguments.length){_+="?args[]="+encodeURIComponent(arguments[1]);for(var S=2;S<arguments.length;S++)_+="&args[]="+encodeURIComponent(arguments[S])}return"Minified React error #"+m+"; visit "+_+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(m){var _=m,S=m;if(m.alternate)for(;_.return;)_=_.return;else{m=_;do _=m,(_.flags&4098)!==0&&(S=_.return),m=_.return;while(m)}return _.tag===3?S:null}function s(m){if(r(m)!==m)throw Error(i(188))}function o(m){var _=m.alternate;if(!_){if(_=r(m),_===null)throw Error(i(188));return _!==m?null:m}for(var S=m,C=_;;){var O=S.return;if(O===null)break;var $=O.alternate;if($===null){if(C=O.return,C!==null){S=C;continue}break}if(O.child===$.child){for($=O.child;$;){if($===S)return s(O),m;if($===C)return s(O),_;$=$.sibling}throw Error(i(188))}if(S.return!==C.return)S=O,C=$;else{for(var K=!1,ct=O.child;ct;){if(ct===S){K=!0,S=O,C=$;break}if(ct===C){K=!0,C=O,S=$;break}ct=ct.sibling}if(!K){for(ct=$.child;ct;){if(ct===S){K=!0,S=$,C=O;break}if(ct===C){K=!0,C=$,S=O;break}ct=ct.sibling}if(!K)throw Error(i(189))}}if(S.alternate!==C)throw Error(i(190))}if(S.tag!==3)throw Error(i(188));return S.stateNode.current===S?m:_}function a(m){var _=m.tag;if(_===5||_===26||_===27||_===6)return m;for(m=m.child;m!==null;){if(_=a(m),_!==null)return _;m=m.sibling}return null}function c(m){var _=m.tag;if(_===5||_===26||_===27||_===6)return m;for(m=m.child;m!==null;){if(m.tag!==4&&(_=c(m),_!==null))return _;m=m.sibling}return null}function l(m){return m===null||typeof m!="object"?null:(m=Ez&&m[Ez]||m["@@iterator"],typeof m=="function"?m:null)}function u(m){if(m==null)return null;if(typeof m=="function")return m.$$typeof===aut?null:m.displayName||m.name||null;if(typeof m=="string")return m;switch(m){case Zf:return"Fragment";case QT:return"Profiler";case kz:return"StrictMode";case e3:return"Suspense";case n3:return"SuspenseList";case r3:return"Activity"}if(typeof m=="object")switch(m.$$typeof){case qf:return"Portal";case vc:return(m.displayName||"Context")+".Provider";case Tz:return(m._context.displayName||"Context")+".Consumer";case t3:var _=m.render;return m=m.displayName,m||(m=_.displayName||_.name||"",m=m!==""?"ForwardRef("+m+")":"ForwardRef"),m;case i3:return _=m.displayName||null,_!==null?_:u(m.type)||"Memo";case Sc:_=m._payload,m=m._init;try{return u(m(_))}catch{}}return null}function p(m){return{current:m}}function f(m){0>Qf||(m.current=l3[Qf],l3[Qf]=null,Qf--)}function y(m,_){Qf++,l3[Qf]=m.current,m.current=_}function g(m){return m>>>=0,m===0?32:31-(Ppt(m)/kpt|0)|0}function x(m){var _=m&42;if(_!==0)return _;switch(m&-m){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return m&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return m}}function v(m,_,S){var C=m.pendingLanes;if(C===0)return 0;var O=0,$=m.suspendedLanes,K=m.pingedLanes;m=m.warmLanes;var ct=C&134217727;return ct!==0?(C=ct&~$,C!==0?O=x(C):(K&=ct,K!==0?O=x(K):S||(S=ct&~m,S!==0&&(O=x(S))))):(ct=C&~$,ct!==0?O=x(ct):K!==0?O=x(K):S||(S=C&~m,S!==0&&(O=x(S)))),O===0?0:_!==0&&_!==O&&(_&$)===0&&($=O&-O,S=_&-_,$>=S||$===32&&(S&4194048)!==0)?_:O}function P(m,_){return(m.pendingLanes&~(m.suspendedLanes&~m.pingedLanes)&_)===0}function w(m,_){switch(m){case 1:case 2:case 4:case 8:case 64:return _+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return _+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function k(){var m=sx;return sx<<=1,(sx&4194048)===0&&(sx=256),m}function T(){var m=ox;return ox<<=1,(ox&62914560)===0&&(ox=4194304),m}function I(m){for(var _=[],S=0;31>S;S++)_.push(m);return _}function E(m,_){m.pendingLanes|=_,_!==268435456&&(m.suspendedLanes=0,m.pingedLanes=0,m.warmLanes=0)}function N(m,_,S,C,O,$){var K=m.pendingLanes;m.pendingLanes=S,m.suspendedLanes=0,m.pingedLanes=0,m.warmLanes=0,m.expiredLanes&=S,m.entangledLanes&=S,m.errorRecoveryDisabledLanes&=S,m.shellSuspendCounter=0;var ct=m.entanglements,xt=m.expirationTimes,It=m.hiddenUpdates;for(S=K&~S;0<S;){var $t=31-es(S),Xt=1<<$t;ct[$t]=0,xt[$t]=-1;var Wt=It[$t];if(Wt!==null)for(It[$t]=null,$t=0;$t<Wt.length;$t++){var Le=Wt[$t];Le!==null&&(Le.lane&=-536870913)}S&=~Xt}C!==0&&M(m,C,0),$!==0&&O===0&&m.tag!==0&&(m.suspendedLanes|=$&~(K&~_))}function M(m,_,S){m.pendingLanes|=_,m.suspendedLanes&=~_;var C=31-es(_);m.entangledLanes|=_,m.entanglements[C]=m.entanglements[C]|1073741824|S&4194090}function A(m,_){var S=m.entangledLanes|=_;for(m=m.entanglements;S;){var C=31-es(S),O=1<<C;O&_|m[C]&_&&(m[C]|=_),S&=~O}}function R(m){switch(m){case 2:m=1;break;case 8:m=4;break;case 32:m=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:m=128;break;case 268435456:m=134217728;break;default:m=0}return m}function j(m){return m&=-m,2<m?8<m?(m&134217727)!==0?32:268435456:8:2}function B(m){if(typeof Ipt=="function"&&Npt(m),ns&&typeof ns.setStrictMode=="function")try{ns.setStrictMode(By,m)}catch{}}function G(m){if(h3===void 0)try{throw Error()}catch(S){var _=S.stack.trim().match(/\n( *(at )?)/);h3=_&&_[1]||"",Jz=-1<S.stack.indexOf(`
    at`)?" (<anonymous>)":-1<S.stack.indexOf("@")?"@unknown:0:0":""}return`
`+h3+m+Jz}function U(m,_){if(!m||d3)return"";d3=!0;var S=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var C={DetermineComponentFrameRoot:function(){try{if(_){var Xt=function(){throw Error()};if(Object.defineProperty(Xt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Xt,[])}catch(Le){var Wt=Le}Reflect.construct(m,[],Xt)}else{try{Xt.call()}catch(Le){Wt=Le}m.call(Xt.prototype)}}else{try{throw Error()}catch(Le){Wt=Le}(Xt=m())&&typeof Xt.catch=="function"&&Xt.catch(function(){})}}catch(Le){if(Le&&Wt&&typeof Le.stack=="string")return[Le.stack,Wt.stack]}return[null,null]}};C.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var O=Object.getOwnPropertyDescriptor(C.DetermineComponentFrameRoot,"name");O&&O.configurable&&Object.defineProperty(C.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var $=C.DetermineComponentFrameRoot(),K=$[0],ct=$[1];if(K&&ct){var xt=K.split(`
`),It=ct.split(`
`);for(O=C=0;C<xt.length&&!xt[C].includes("DetermineComponentFrameRoot");)C++;for(;O<It.length&&!It[O].includes("DetermineComponentFrameRoot");)O++;if(C===xt.length||O===It.length)for(C=xt.length-1,O=It.length-1;1<=C&&0<=O&&xt[C]!==It[O];)O--;for(;1<=C&&0<=O;C--,O--)if(xt[C]!==It[O]){if(C!==1||O!==1)do if(C--,O--,0>O||xt[C]!==It[O]){var $t=`
`+xt[C].replace(" at new "," at ");return m.displayName&&$t.includes("<anonymous>")&&($t=$t.replace("<anonymous>",m.displayName)),$t}while(1<=C&&0<=O);break}}}finally{d3=!1,Error.prepareStackTrace=S}return(S=m?m.displayName||m.name:"")?G(S):""}function H(m){switch(m.tag){case 26:case 27:case 5:return G(m.type);case 16:return G("Lazy");case 13:return G("Suspense");case 19:return G("SuspenseList");case 0:case 15:return U(m.type,!1);case 11:return U(m.type.render,!1);case 1:return U(m.type,!0);case 31:return G("Activity");default:return""}}function tt(m){try{var _="";do _+=H(m),m=m.return;while(m);return _}catch(S){return`
Error generating stack: `+S.message+`
`+S.stack}}function et(m,_){if(typeof m=="object"&&m!==null){var S=Qz.get(m);return S!==void 0?S:(_={value:m,source:_,stack:tt(_)},Qz.set(m,_),_)}return{value:m,source:_,stack:tt(_)}}function mt(m,_){em[nm++]=lx,em[nm++]=cx,cx=m,lx=_}function V(m,_,S){ys[gs++]=ha,ys[gs++]=da,ys[gs++]=hh,hh=m;var C=ha;m=da;var O=32-es(C)-1;C&=~(1<<O),S+=1;var $=32-es(_)+O;if(30<$){var K=O-O%5;$=(C&(1<<K)-1).toString(32),C>>=K,O-=K,ha=1<<32-es(_)+O|S<<O|C,da=$+m}else ha=1<<$|S<<O|C,da=m}function J(m){m.return!==null&&(mt(m,1),V(m,1,0))}function nt(m){for(;m===cx;)cx=em[--nm],em[nm]=null,lx=em[--nm],em[nm]=null;for(;m===hh;)hh=ys[--gs],ys[gs]=null,da=ys[--gs],ys[gs]=null,ha=ys[--gs],ys[gs]=null}function ut(m,_){y(Pc,_),y(Yy,m),y(Zi,null),m=uut(_),f(Zi),y(Zi,m)}function ht(){f(Zi),f(Yy),f(Pc)}function kt(m){m.memoizedState!==null&&y(ux,m);var _=Zi.current,S=put(_,m.type);_!==S&&(y(Yy,m),y(Zi,S))}function Mt(m){Yy.current===m&&(f(Zi),f(Yy)),ux.current===m&&(f(ux),ua?ph._currentValue=Kf:ph._currentValue2=Kf)}function ot(m){var _=Error(i(418,""));throw Z(et(_,m)),f3}function X(m,_){if(!_s)throw Error(i(175));cpt(m.stateNode,m.type,m.memoizedProps,_,m)||ot(m)}function W(m){for(Pr=m.return;Pr;)switch(Pr.tag){case 5:case 13:To=!1;return;case 27:case 3:To=!0;return;default:Pr=Pr.return}}function rt(m){if(!_s||m!==Pr)return!1;if(!mn)return W(m),mn=!0,!1;var _=m.tag;if(vi?_!==3&&_!==27&&(_!==5||jz(m.type)&&!rx(m.type,m.memoizedProps))&&Si&&ot(m):_!==3&&(_!==5||jz(m.type)&&!rx(m.type,m.memoizedProps))&&Si&&ot(m),W(m),_===13){if(!_s)throw Error(i(316));if(m=m.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(i(317));Si=ppt(m)}else Si=vi&&_===27?tpt(m.type,Si):Pr?Dz(m.stateNode):null;return!0}function pt(){_s&&(Si=Pr=null,mn=!1)}function yt(){var m=dh;return m!==null&&(Lr===null?Lr=m:Lr.push.apply(Lr,m),dh=null),m}function Z(m){dh===null?dh=[m]:dh.push(m)}function at(m,_){return m===_&&(m!==0||1/m===1/_)||m!==m&&_!==_}function Et(m,_,S){ua?(y(px,_._currentValue),_._currentValue=S):(y(px,_._currentValue2),_._currentValue2=S)}function Ft(m){var _=px.current;ua?m._currentValue=_:m._currentValue2=_,f(px)}function Ot(m,_,S){for(;m!==null;){var C=m.alternate;if((m.childLanes&_)!==_?(m.childLanes|=_,C!==null&&(C.childLanes|=_)):C!==null&&(C.childLanes&_)!==_&&(C.childLanes|=_),m===S)break;m=m.return}}function Ce(m,_,S,C){var O=m.child;for(O!==null&&(O.return=m);O!==null;){var $=O.dependencies;if($!==null){var K=O.child;$=$.firstContext;t:for(;$!==null;){var ct=$;$=O;for(var xt=0;xt<_.length;xt++)if(ct.context===_[xt]){$.lanes|=S,ct=$.alternate,ct!==null&&(ct.lanes|=S),Ot($.return,S,m),C||(K=null);break t}$=ct.next}}else if(O.tag===18){if(K=O.return,K===null)throw Error(i(341));K.lanes|=S,$=K.alternate,$!==null&&($.lanes|=S),Ot(K,S,m),K=null}else K=O.child;if(K!==null)K.return=O;else for(K=O;K!==null;){if(K===m){K=null;break}if(O=K.sibling,O!==null){O.return=K.return,K=O;break}K=K.return}O=K}}function Se(m,_,S,C){m=null;for(var O=_,$=!1;O!==null;){if(!$){if((O.flags&524288)!==0)$=!0;else if((O.flags&262144)!==0)break}if(O.tag===10){var K=O.alternate;if(K===null)throw Error(i(387));if(K=K.memoizedProps,K!==null){var ct=O.type;is(O.pendingProps.value,K.value)||(m!==null?m.push(ct):m=[ct])}}else if(O===ux.current){if(K=O.alternate,K===null)throw Error(i(387));K.memoizedState.memoizedState!==O.memoizedState.memoizedState&&(m!==null?m.push(ph):m=[ph])}O=O.return}m!==null&&Ce(_,m,S,C),_.flags|=262144}function Kt(m){for(m=m.firstContext;m!==null;){var _=m.context;if(!is(ua?_._currentValue:_._currentValue2,m.memoizedValue))return!0;m=m.next}return!1}function le(m){fh=m,fa=null,m=m.dependencies,m!==null&&(m.firstContext=null)}function Jt(m){return Ii(fh,m)}function qn(m,_){return fh===null&&le(m),Ii(m,_)}function Ii(m,_){var S=ua?_._currentValue:_._currentValue2;if(_={context:_,memoizedValue:S,next:null},fa===null){if(m===null)throw Error(i(308));fa=_,m.dependencies={lanes:0,firstContext:_},m.flags|=524288}else fa=fa.next=_;return S}function Nr(){return{controller:new Apt,data:new Map,refCount:0}}function Xs(m){m.refCount--,m.refCount===0&&Rpt(Opt,function(){m.controller.abort()})}function Ar(m){m!==im&&m.next===null&&(im===null?hx=im=m:im=im.next=m),dx=!0,m3||(m3=!0,xy())}function So(m,_){if(!_3&&dx){_3=!0;do for(var S=!1,C=hx;C!==null;){if(!_)if(m!==0){var O=C.pendingLanes;if(O===0)var $=0;else{var K=C.suspendedLanes,ct=C.pingedLanes;$=(1<<31-es(42|m)+1)-1,$&=O&~(K&~ct),$=$&201326741?$&201326741|1:$?$|2:0}$!==0&&(S=!0,Af(C,$))}else $=tn,$=v(C,C===An?$:0,C.cancelPendingCommit!==null||C.timeoutHandle!==uh),($&3)===0||P(C,$)||(S=!0,Af(C,$));C=C.next}while(S);_3=!1}}function Mf(){Cf()}function Cf(){dx=m3=!1;var m=0;rm!==0&&(but()&&(m=rm),rm=0);for(var _=Hs(),S=null,C=hx;C!==null;){var O=C.next,$=If(C,_);$===0?(C.next=null,S===null?hx=O:S.next=O,O===null&&(im=S)):(S=C,(m!==0||($&3)!==0)&&(dx=!0)),C=O}So(m,!1)}function If(m,_){for(var S=m.suspendedLanes,C=m.pingedLanes,O=m.expirationTimes,$=m.pendingLanes&-62914561;0<$;){var K=31-es($),ct=1<<K,xt=O[K];xt===-1?((ct&S)===0||(ct&C)!==0)&&(O[K]=w(ct,_)):xt<=_&&(m.expiredLanes|=ct),$&=~ct}if(_=An,S=tn,S=v(m,m===_?S:0,m.cancelPendingCommit!==null||m.timeoutHandle!==uh),C=m.callbackNode,S===0||m===_&&(xn===2||xn===9)||m.cancelPendingCommit!==null)return C!==null&&C!==null&&u3(C),m.callbackNode=null,m.callbackPriority=0;if((S&3)===0||P(m,S)){if(_=S&-S,_===m.callbackPriority)return _;switch(C!==null&&u3(C),j(S)){case 2:case 8:S=Mpt;break;case 32:S=p3;break;case 268435456:S=Cpt;break;default:S=p3}return C=Nf.bind(null,m),S=ax(S,C),m.callbackPriority=_,m.callbackNode=S,_}return C!==null&&C!==null&&u3(C),m.callbackPriority=2,m.callbackNode=null,2}function Nf(m,_){if(Ki!==0&&Ki!==5)return m.callbackNode=null,m.callbackPriority=0,null;var S=m.callbackNode;if(zy(!0)&&m.callbackNode!==S)return null;var C=tn;return C=v(m,m===An?C:0,m.cancelPendingCommit!==null||m.timeoutHandle!==uh),C===0?null:(ez(m,C,_),If(m,Hs()),m.callbackNode!=null&&m.callbackNode===S?Nf.bind(null,m):null)}function Af(m,_){if(zy())return null;ez(m,_,!0)}function xy(){Tut?Eut(function(){(Qe&6)!==0?ax(Kz,Mf):Cf()}):ax(Kz,Mf)}function qp(){return rm===0&&(rm=k()),rm}function by(m,_){if(Xy===null){var S=Xy=[];y3=0,sm=qp(),om={status:"pending",value:void 0,then:function(C){S.push(C)}}}return y3++,_.then(Rf,Rf),_}function Rf(){if(--y3===0&&Xy!==null){om!==null&&(om.status="fulfilled");var m=Xy;Xy=null,sm=0,om=null;for(var _=0;_<m.length;_++)(0,m[_])()}}function vy(m,_){var S=[],C={status:"pending",value:null,reason:null,then:function(O){S.push(O)}};return m.then(function(){C.status="fulfilled",C.value=_;for(var O=0;O<S.length;O++)(0,S[O])(_)},function(O){for(C.status="rejected",C.reason=O,O=0;O<S.length;O++)(0,S[O])(void 0)}),C}function Zp(){var m=mh.current;return m!==null?m:An.pooledCache}function lc(m,_){_===null?y(mh,mh.current):y(mh,_.pool)}function Of(){var m=Zp();return m===null?null:{parent:ua?ni._currentValue:ni._currentValue2,pool:m}}function uc(m,_){if(is(m,_))return!0;if(typeof m!="object"||m===null||typeof _!="object"||_===null)return!1;var S=Object.keys(m),C=Object.keys(_);if(S.length!==C.length)return!1;for(C=0;C<S.length;C++){var O=S[C];if(!Lpt.call(_,O)||!is(m[O],_[O]))return!1}return!0}function Lf(m){return m=m.status,m==="fulfilled"||m==="rejected"}function pc(){}function Ff(m,_,S){switch(S=m[S],S===void 0?m.push(_):S!==_&&(_.then(pc,pc),_=S),_.status){case"fulfilled":return _.value;case"rejected":throw m=_.reason,$f(m),m;default:if(typeof _.status=="string")_.then(pc,pc);else{if(m=An,m!==null&&100<m.shellSuspendCounter)throw Error(i(482));m=_,m.status="pending",m.then(function(C){if(_.status==="pending"){var O=_;O.status="fulfilled",O.value=C}},function(C){if(_.status==="pending"){var O=_;O.status="rejected",O.reason=C}})}switch(_.status){case"fulfilled":return _.value;case"rejected":throw m=_.reason,$f(m),m}throw am=_,Uy}}function zf(){if(am===null)throw Error(i(459));var m=am;return am=null,m}function $f(m){if(m===Uy||m===fx)throw Error(i(483))}function hc(){for(var m=cm,_=x3=cm=0;_<m;){var S=xs[_];xs[_++]=null;var C=xs[_];xs[_++]=null;var O=xs[_];xs[_++]=null;var $=xs[_];if(xs[_++]=null,C!==null&&O!==null){var K=C.pending;K===null?O.next=O:(O.next=K.next,K.next=O),C.pending=O}$!==0&&Df(S,O,$)}}function dc(m,_,S,C){xs[cm++]=m,xs[cm++]=_,xs[cm++]=S,xs[cm++]=C,x3|=C,m.lanes|=C,m=m.alternate,m!==null&&(m.lanes|=C)}function Kp(m,_,S,C){return dc(m,_,S,C),fc(m)}function wo(m,_){return dc(m,null,null,_),fc(m)}function Df(m,_,S){m.lanes|=S;var C=m.alternate;C!==null&&(C.lanes|=S);for(var O=!1,$=m.return;$!==null;)$.childLanes|=S,C=$.alternate,C!==null&&(C.childLanes|=S),$.tag===22&&(m=$.stateNode,m===null||m._visibility&1||(O=!0)),m=$,$=$.return;return m.tag===3?($=m.stateNode,O&&_!==null&&(O=31-es(S),m=$.hiddenUpdates,C=m[O],C===null?m[O]=[_]:C.push(_),_.lane=S|536870912),$):null}function fc(m){if(50<Zy)throw Zy=0,I3=null,Error(i(185));for(var _=m.return;_!==null;)m=_,_=m.return;return m.tag===3?m.stateNode:null}function Jp(m){m.updateQueue={baseState:m.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Qp(m,_){m=m.updateQueue,_.updateQueue===m&&(_.updateQueue={baseState:m.baseState,firstBaseUpdate:m.firstBaseUpdate,lastBaseUpdate:m.lastBaseUpdate,shared:m.shared,callbacks:null})}function fs(m){return{lane:m,tag:0,payload:null,callback:null,next:null}}function ms(m,_,S){var C=m.updateQueue;if(C===null)return null;if(C=C.shared,(Qe&2)!==0){var O=C.pending;return O===null?_.next=_:(_.next=O.next,O.next=_),C.pending=_,_=fc(m),Df(m,null,S),_}return dc(m,C,_,S),fc(m)}function ra(m,_,S){if(_=_.updateQueue,_!==null&&(_=_.shared,(S&4194048)!==0)){var C=_.lanes;C&=m.pendingLanes,S|=C,_.lanes=S,A(m,S)}}function th(m,_){var S=m.updateQueue,C=m.alternate;if(C!==null&&(C=C.updateQueue,S===C)){var O=null,$=null;if(S=S.firstBaseUpdate,S!==null){do{var K={lane:S.lane,tag:S.tag,payload:S.payload,callback:null,next:null};$===null?O=$=K:$=$.next=K,S=S.next}while(S!==null);$===null?O=$=_:$=$.next=_}else O=$=_;S={baseState:C.baseState,firstBaseUpdate:O,lastBaseUpdate:$,shared:C.shared,callbacks:C.callbacks},m.updateQueue=S;return}m=S.lastBaseUpdate,m===null?S.firstBaseUpdate=_:m.next=_,S.lastBaseUpdate=_}function sa(){if(b3){var m=om;if(m!==null)throw m}}function oa(m,_,S,C){b3=!1;var O=m.updateQueue;kc=!1;var $=O.firstBaseUpdate,K=O.lastBaseUpdate,ct=O.shared.pending;if(ct!==null){O.shared.pending=null;var xt=ct,It=xt.next;xt.next=null,K===null?$=It:K.next=It,K=xt;var $t=m.alternate;$t!==null&&($t=$t.updateQueue,ct=$t.lastBaseUpdate,ct!==K&&(ct===null?$t.firstBaseUpdate=It:ct.next=It,$t.lastBaseUpdate=xt))}if($!==null){var Xt=O.baseState;K=0,$t=It=xt=null,ct=$;do{var Wt=ct.lane&-536870913,Le=Wt!==ct.lane;if(Le?(tn&Wt)===Wt:(C&Wt)===Wt){Wt!==0&&Wt===sm&&(b3=!0),$t!==null&&($t=$t.next={lane:0,tag:ct.tag,payload:ct.payload,callback:null,next:null});t:{var Ss=m,Ky=ct;Wt=_;var gh=S;switch(Ky.tag){case 1:if(Ss=Ky.payload,typeof Ss=="function"){Xt=Ss.call(gh,Xt,Wt);break t}Xt=Ss;break t;case 3:Ss.flags=Ss.flags&-65537|128;case 0:if(Ss=Ky.payload,Wt=typeof Ss=="function"?Ss.call(gh,Xt,Wt):Ss,Wt==null)break t;Xt=JT({},Xt,Wt);break t;case 2:kc=!0}}Wt=ct.callback,Wt!==null&&(m.flags|=64,Le&&(m.flags|=8192),Le=O.callbacks,Le===null?O.callbacks=[Wt]:Le.push(Wt))}else Le={lane:Wt,tag:ct.tag,payload:ct.payload,callback:ct.callback,next:null},$t===null?(It=$t=Le,xt=Xt):$t=$t.next=Le,K|=Wt;if(ct=ct.next,ct===null){if(ct=O.shared.pending,ct===null)break;Le=ct,ct=Le.next,Le.next=null,O.lastBaseUpdate=Le,O.shared.pending=null}}while(!0);$t===null&&(xt=Xt),O.baseState=xt,O.firstBaseUpdate=It,O.lastBaseUpdate=$t,$===null&&(O.shared.lanes=0),Mc|=K,m.lanes=K,m.memoizedState=Xt}}function jf(m,_){if(typeof m!="function")throw Error(i(191,m));m.call(_)}function Bf(m,_){var S=m.callbacks;if(S!==null)for(m.callbacks=null,m=0;m<S.length;m++)jf(S[m],_)}function Yf(m,_){m=_a,y(_x,m),y(lm,_),_a=m|_.baseLanes}function eh(){y(_x,_a),y(lm,lm.current)}function nh(){_a=_x.current,f(lm),f(_x)}function Fn(){throw Error(i(321))}function ih(m,_){if(_===null)return!1;for(var S=0;S<_.length&&S<m.length;S++)if(!is(m[S],_[S]))return!1;return!0}function rh(m,_,S,C,O,$){return Tc=$,De=_,_.memoizedState=null,_.updateQueue=null,_.lanes=0,_e.H=m===null||m.memoizedState===null?e$:n$,_h=!1,$=S(C,O),_h=!1,um&&($=B0(_,S,C,O)),j0(m),$}function j0(m){_e.H=xx;var _=wn!==null&&wn.next!==null;if(Tc=0,fi=wn=De=null,yx=!1,Vy=0,pm=null,_)throw Error(i(300));m===null||Ai||(m=m.dependencies,m!==null&&Kt(m)&&(Ai=!0))}function B0(m,_,S,C){De=m;var O=0;do{if(um&&(pm=null),Vy=0,um=!1,25<=O)throw Error(i(301));if(O+=1,fi=wn=null,m.updateQueue!=null){var $=m.updateQueue;$.lastEffect=null,$.events=null,$.stores=null,$.memoCache!=null&&($.memoCache.index=0)}_e.H=zpt,$=_(S,C)}while(um);return $}function fT(){var m=_e.H,_=m.useState()[0];return _=typeof _.then=="function"?sh(_):_,m=m.useState()[0],(wn!==null?wn.memoizedState:null)!==m&&(De.flags|=1024),_}function Sy(){var m=gx!==0;return gx=0,m}function wy(m,_,S){_.updateQueue=m.updateQueue,_.flags&=-2053,m.lanes&=~S}function Py(m){if(yx){for(m=m.memoizedState;m!==null;){var _=m.queue;_!==null&&(_.pending=null),m=m.next}yx=!1}Tc=0,fi=wn=De=null,um=!1,Vy=gx=0,pm=null}function cr(){var m={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return fi===null?De.memoizedState=fi=m:fi=fi.next=m,fi}function ei(){if(wn===null){var m=De.alternate;m=m!==null?m.memoizedState:null}else m=wn.next;var _=fi===null?De.memoizedState:fi.next;if(_!==null)fi=_,wn=m;else{if(m===null)throw De.alternate===null?Error(i(467)):Error(i(310));wn=m,m={memoizedState:wn.memoizedState,baseState:wn.baseState,baseQueue:wn.baseQueue,queue:wn.queue,next:null},fi===null?De.memoizedState=fi=m:fi=fi.next=m}return fi}function ky(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function sh(m){var _=Vy;return Vy+=1,pm===null&&(pm=[]),m=Ff(pm,m,_),_=De,(fi===null?_.memoizedState:fi.next)===null&&(_=_.alternate,_e.H=_===null||_.memoizedState===null?e$:n$),m}function Xf(m){if(m!==null&&typeof m=="object"){if(typeof m.then=="function")return sh(m);if(m.$$typeof===vc)return Jt(m)}throw Error(i(438,String(m)))}function Ty(m){var _=null,S=De.updateQueue;if(S!==null&&(_=S.memoCache),_==null){var C=De.alternate;C!==null&&(C=C.updateQueue,C!==null&&(C=C.memoCache,C!=null&&(_={data:C.data.map(function(O){return O.slice()}),index:0})))}if(_==null&&(_={data:[],index:0}),S===null&&(S=ky(),De.updateQueue=S),S.memoCache=_,S=_.data[_.index],S===void 0)for(S=_.data[_.index]=Array(m),C=0;C<m;C++)S[C]=out;return _.index++,S}function Us(m,_){return typeof _=="function"?_(m):_}function Uf(m){var _=ei();return Ey(_,wn,m)}function Ey(m,_,S){var C=m.queue;if(C===null)throw Error(i(311));C.lastRenderedReducer=S;var O=m.baseQueue,$=C.pending;if($!==null){if(O!==null){var K=O.next;O.next=$.next,$.next=K}_.baseQueue=O=$,C.pending=null}if($=m.baseState,O===null)m.memoizedState=$;else{_=O.next;var ct=K=null,xt=null,It=_,$t=!1;do{var Xt=It.lane&-536870913;if(Xt!==It.lane?(tn&Xt)===Xt:(Tc&Xt)===Xt){var Wt=It.revertLane;if(Wt===0)xt!==null&&(xt=xt.next={lane:0,revertLane:0,action:It.action,hasEagerState:It.hasEagerState,eagerState:It.eagerState,next:null}),Xt===sm&&($t=!0);else if((Tc&Wt)===Wt){It=It.next,Wt===sm&&($t=!0);continue}else Xt={lane:0,revertLane:It.revertLane,action:It.action,hasEagerState:It.hasEagerState,eagerState:It.eagerState,next:null},xt===null?(ct=xt=Xt,K=$):xt=xt.next=Xt,De.lanes|=Wt,Mc|=Wt;Xt=It.action,_h&&S($,Xt),$=It.hasEagerState?It.eagerState:S($,Xt)}else Wt={lane:Xt,revertLane:It.revertLane,action:It.action,hasEagerState:It.hasEagerState,eagerState:It.eagerState,next:null},xt===null?(ct=xt=Wt,K=$):xt=xt.next=Wt,De.lanes|=Xt,Mc|=Xt;It=It.next}while(It!==null&&It!==_);if(xt===null?K=$:xt.next=ct,!is($,m.memoizedState)&&(Ai=!0,$t&&(S=om,S!==null)))throw S;m.memoizedState=$,m.baseState=K,m.baseQueue=xt,C.lastRenderedState=$}return O===null&&(C.lanes=0),[m.memoizedState,C.dispatch]}function My(m){var _=ei(),S=_.queue;if(S===null)throw Error(i(311));S.lastRenderedReducer=m;var C=S.dispatch,O=S.pending,$=_.memoizedState;if(O!==null){S.pending=null;var K=O=O.next;do $=m($,K.action),K=K.next;while(K!==O);is($,_.memoizedState)||(Ai=!0),_.memoizedState=$,_.baseQueue===null&&(_.baseState=$),S.lastRenderedState=$}return[$,C]}function R7(m,_,S){var C=De,O=ei(),$=mn;if($){if(S===void 0)throw Error(i(407));S=S()}else S=_();var K=!is((wn||O).memoizedState,S);K&&(O.memoizedState=S,Ai=!0),O=O.queue;var ct=F7.bind(null,C,O,m);if(Cy(2048,8,ct,[m]),O.getSnapshot!==_||K||fi!==null&&fi.memoizedState.tag&1){if(C.flags|=2048,Vf(9,Y0(),L7.bind(null,C,O,S,_),null),An===null)throw Error(i(349));$||(Tc&124)!==0||O7(C,_,S)}return S}function O7(m,_,S){m.flags|=16384,m={getSnapshot:_,value:S},_=De.updateQueue,_===null?(_=ky(),De.updateQueue=_,_.stores=[m]):(S=_.stores,S===null?_.stores=[m]:S.push(m))}function L7(m,_,S,C){_.value=S,_.getSnapshot=C,z7(_)&&$7(m)}function F7(m,_,S){return S(function(){z7(_)&&$7(m)})}function z7(m){var _=m.getSnapshot;m=m.value;try{var S=_();return!is(m,S)}catch{return!0}}function $7(m){var _=wo(m,2);_!==null&&Qr(_,m,2)}function mT(m){var _=cr();if(typeof m=="function"){var S=m;if(m=S(),_h){B(!0);try{S()}finally{B(!1)}}}return _.memoizedState=_.baseState=m,_.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Us,lastRenderedState:m},_}function D7(m,_,S,C){return m.baseState=S,Ey(m,wn,typeof C=="function"?C:Us)}function zlt(m,_,S,C,O){if(U0(m))throw Error(i(485));if(m=_.action,m!==null){var $={payload:O,action:m,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(K){$.listeners.push(K)}};_e.T!==null?S(!0):$.isTransition=!1,C($),S=_.pending,S===null?($.next=_.pending=$,j7(_,$)):($.next=S.next,_.pending=S.next=$)}}function j7(m,_){var S=_.action,C=_.payload,O=m.state;if(_.isTransition){var $=_e.T,K={};_e.T=K;try{var ct=S(O,C),xt=_e.S;xt!==null&&xt(K,ct),B7(m,_,ct)}catch(It){_T(m,_,It)}finally{_e.T=$}}else try{$=S(O,C),B7(m,_,$)}catch(It){_T(m,_,It)}}function B7(m,_,S){S!==null&&typeof S=="object"&&typeof S.then=="function"?S.then(function(C){Y7(m,_,C)},function(C){return _T(m,_,C)}):Y7(m,_,S)}function Y7(m,_,S){_.status="fulfilled",_.value=S,X7(_),m.state=S,_=m.pending,_!==null&&(S=_.next,S===_?m.pending=null:(S=S.next,_.next=S,j7(m,S)))}function _T(m,_,S){var C=m.pending;if(m.pending=null,C!==null){C=C.next;do _.status="rejected",_.reason=S,X7(_),_=_.next;while(_!==C)}m.action=null}function X7(m){m=m.listeners;for(var _=0;_<m.length;_++)(0,m[_])()}function U7(m,_){return _}function V7(m,_){if(mn){var S=An.formState;if(S!==null){t:{var C=De;if(mn){if(Si){var O=Jut(Si,To);if(O){Si=Dz(O),C=Qut(O);break t}}ot(C)}C=!1}C&&(_=S[0])}}S=cr(),S.memoizedState=S.baseState=_,C={pending:null,lanes:0,dispatch:null,lastRenderedReducer:U7,lastRenderedState:_},S.queue=C,S=lF.bind(null,De,C),C.dispatch=S,C=mT(!1);var $=bT.bind(null,De,!1,C.queue);return C=cr(),O={state:_,dispatch:null,action:m,pending:null},C.queue=O,S=zlt.bind(null,De,O,$,S),O.dispatch=S,C.memoizedState=m,[_,S,!1]}function G7(m){var _=ei();return H7(_,wn,m)}function H7(m,_,S){if(_=Ey(m,_,U7)[0],m=Uf(Us)[0],typeof _=="object"&&_!==null&&typeof _.then=="function")try{var C=sh(_)}catch(K){throw K===Uy?fx:K}else C=_;_=ei();var O=_.queue,$=O.dispatch;return S!==_.memoizedState&&(De.flags|=2048,Vf(9,Y0(),$lt.bind(null,O,S),null)),[C,$,m]}function $lt(m,_){m.action=_}function W7(m){var _=ei(),S=wn;if(S!==null)return H7(_,S,m);ei(),_=_.memoizedState,S=ei();var C=S.queue.dispatch;return S.memoizedState=m,[_,C,!1]}function Vf(m,_,S,C){return m={tag:m,create:S,deps:C,inst:_,next:null},_=De.updateQueue,_===null&&(_=ky(),De.updateQueue=_),S=_.lastEffect,S===null?_.lastEffect=m.next=m:(C=S.next,S.next=m,m.next=C,_.lastEffect=m),m}function Y0(){return{destroy:void 0,resource:void 0}}function q7(){return ei().memoizedState}function X0(m,_,S,C){var O=cr();C=C===void 0?null:C,De.flags|=m,O.memoizedState=Vf(1|_,Y0(),S,C)}function Cy(m,_,S,C){var O=ei();C=C===void 0?null:C;var $=O.memoizedState.inst;wn!==null&&C!==null&&ih(C,wn.memoizedState.deps)?O.memoizedState=Vf(_,$,S,C):(De.flags|=m,O.memoizedState=Vf(1|_,$,S,C))}function Z7(m,_){X0(8390656,8,m,_)}function K7(m,_){Cy(2048,8,m,_)}function J7(m,_){return Cy(4,2,m,_)}function Q7(m,_){return Cy(4,4,m,_)}function tF(m,_){if(typeof _=="function"){m=m();var S=_(m);return function(){typeof S=="function"?S():_(null)}}if(_!=null)return m=m(),_.current=m,function(){_.current=null}}function eF(m,_,S){S=S!=null?S.concat([m]):null,Cy(4,4,tF.bind(null,_,m),S)}function yT(){}function nF(m,_){var S=ei();_=_===void 0?null:_;var C=S.memoizedState;return _!==null&&ih(_,C[1])?C[0]:(S.memoizedState=[m,_],m)}function iF(m,_){var S=ei();_=_===void 0?null:_;var C=S.memoizedState;if(_!==null&&ih(_,C[1]))return C[0];if(C=m(),_h){B(!0);try{m()}finally{B(!1)}}return S.memoizedState=[C,_],C}function gT(m,_,S){return S===void 0||(Tc&1073741824)!==0?m.memoizedState=_:(m.memoizedState=S,m=tz(),De.lanes|=m,Mc|=m,S)}function rF(m,_,S,C){return is(S,_)?S:lm.current!==null?(m=gT(m,S,C),is(m,_)||(Ai=!0),m):(Tc&42)===0?(Ai=!0,m.memoizedState=S):(m=tz(),De.lanes|=m,Mc|=m,_)}function sF(m,_,S,C,O){var $=pa();Ni($!==0&&8>$?$:8);var K=_e.T,ct={};_e.T=ct,bT(m,!1,_,S);try{var xt=O(),It=_e.S;if(It!==null&&It(ct,xt),xt!==null&&typeof xt=="object"&&typeof xt.then=="function"){var $t=vy(xt,C);Iy(m,_,$t,Jr(m))}else Iy(m,_,C,Jr(m))}catch(Xt){Iy(m,_,{then:function(){},status:"rejected",reason:Xt},Jr())}finally{Ni($),_e.T=K}}function oF(m){var _=m.memoizedState;if(_!==null)return _;_={memoizedState:Kf,baseState:Kf,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Us,lastRenderedState:Kf},next:null};var S={};return _.next={memoizedState:S,baseState:S,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Us,lastRenderedState:S},next:null},m.memoizedState=_,m=m.alternate,m!==null&&(m.memoizedState=_),_}function xT(){return Jt(ph)}function aF(){return ei().memoizedState}function cF(){return ei().memoizedState}function Dlt(m){for(var _=m.return;_!==null;){switch(_.tag){case 24:case 3:var S=Jr();m=fs(S);var C=ms(_,m,S);C!==null&&(Qr(C,_,S),ra(C,_,S)),_={cache:Nr()},m.payload=_;return}_=_.return}}function jlt(m,_,S){var C=Jr();S={lane:C,revertLane:0,action:S,hasEagerState:!1,eagerState:null,next:null},U0(m)?uF(_,S):(S=Kp(m,_,S,C),S!==null&&(Qr(S,m,C),pF(S,_,C)))}function lF(m,_,S){var C=Jr();Iy(m,_,S,C)}function Iy(m,_,S,C){var O={lane:C,revertLane:0,action:S,hasEagerState:!1,eagerState:null,next:null};if(U0(m))uF(_,O);else{var $=m.alternate;if(m.lanes===0&&($===null||$.lanes===0)&&($=_.lastRenderedReducer,$!==null))try{var K=_.lastRenderedState,ct=$(K,S);if(O.hasEagerState=!0,O.eagerState=ct,is(ct,K))return dc(m,_,O,0),An===null&&hc(),!1}catch{}finally{}if(S=Kp(m,_,O,C),S!==null)return Qr(S,m,C),pF(S,_,C),!0}return!1}function bT(m,_,S,C){if(C={lane:2,revertLane:qp(),action:C,hasEagerState:!1,eagerState:null,next:null},U0(m)){if(_)throw Error(i(479))}else _=Kp(m,S,C,2),_!==null&&Qr(_,m,2)}function U0(m){var _=m.alternate;return m===De||_!==null&&_===De}function uF(m,_){um=yx=!0;var S=m.pending;S===null?_.next=_:(_.next=S.next,S.next=_),m.pending=_}function pF(m,_,S){if((S&4194048)!==0){var C=_.lanes;C&=m.pendingLanes,S|=C,_.lanes=S,A(m,S)}}function V0(m){var _=Gy;return Gy+=1,hm===null&&(hm=[]),Ff(hm,m,_)}function Ny(m,_){_=_.props.ref,m.ref=_!==void 0?_:null}function G0(m,_){throw _.$$typeof===rut?Error(i(525)):(m=Object.prototype.toString.call(_),Error(i(31,m==="[object Object]"?"object with keys {"+Object.keys(_).join(", ")+"}":m)))}function hF(m){var _=m._init;return _(m._payload)}function dF(m){function _(gt,dt){if(m){var vt=gt.deletions;vt===null?(gt.deletions=[dt],gt.flags|=16):vt.push(dt)}}function S(gt,dt){if(!m)return null;for(;dt!==null;)_(gt,dt),dt=dt.sibling;return null}function C(gt){for(var dt=new Map;gt!==null;)gt.key!==null?dt.set(gt.key,gt):dt.set(gt.index,gt),gt=gt.sibling;return dt}function O(gt,dt){return gt=la(gt,dt),gt.index=0,gt.sibling=null,gt}function $(gt,dt,vt){return gt.index=vt,m?(vt=gt.alternate,vt!==null?(vt=vt.index,vt<dt?(gt.flags|=67108866,dt):vt):(gt.flags|=67108866,dt)):(gt.flags|=1048576,dt)}function K(gt){return m&&gt.alternate===null&&(gt.flags|=67108866),gt}function ct(gt,dt,vt,zt){return dt===null||dt.tag!==6?(dt=qT(vt,gt.mode,zt),dt.return=gt,dt):(dt=O(dt,vt),dt.return=gt,dt)}function xt(gt,dt,vt,zt){var ce=vt.type;return ce===Zf?$t(gt,dt,vt.props.children,zt,vt.key):dt!==null&&(dt.elementType===ce||typeof ce=="object"&&ce!==null&&ce.$$typeof===Sc&&hF(ce)===dt.type)?(dt=O(dt,vt.props),Ny(dt,vt),dt.return=gt,dt):(dt=ex(vt.type,vt.key,vt.props,null,gt.mode,zt),Ny(dt,vt),dt.return=gt,dt)}function It(gt,dt,vt,zt){return dt===null||dt.tag!==4||dt.stateNode.containerInfo!==vt.containerInfo||dt.stateNode.implementation!==vt.implementation?(dt=ZT(vt,gt.mode,zt),dt.return=gt,dt):(dt=O(dt,vt.children||[]),dt.return=gt,dt)}function $t(gt,dt,vt,zt,ce){return dt===null||dt.tag!==7?(dt=lh(vt,gt.mode,zt,ce),dt.return=gt,dt):(dt=O(dt,vt),dt.return=gt,dt)}function Xt(gt,dt,vt){if(typeof dt=="string"&&dt!==""||typeof dt=="number"||typeof dt=="bigint")return dt=qT(""+dt,gt.mode,vt),dt.return=gt,dt;if(typeof dt=="object"&&dt!==null){switch(dt.$$typeof){case nx:return vt=ex(dt.type,dt.key,dt.props,null,gt.mode,vt),Ny(vt,dt),vt.return=gt,vt;case qf:return dt=ZT(dt,gt.mode,vt),dt.return=gt,dt;case Sc:var zt=dt._init;return dt=zt(dt._payload),Xt(gt,dt,vt)}if(ix(dt)||l(dt))return dt=lh(dt,gt.mode,vt,null),dt.return=gt,dt;if(typeof dt.then=="function")return Xt(gt,V0(dt),vt);if(dt.$$typeof===vc)return Xt(gt,qn(gt,dt),vt);G0(gt,dt)}return null}function Wt(gt,dt,vt,zt){var ce=dt!==null?dt.key:null;if(typeof vt=="string"&&vt!==""||typeof vt=="number"||typeof vt=="bigint")return ce!==null?null:ct(gt,dt,""+vt,zt);if(typeof vt=="object"&&vt!==null){switch(vt.$$typeof){case nx:return vt.key===ce?xt(gt,dt,vt,zt):null;case qf:return vt.key===ce?It(gt,dt,vt,zt):null;case Sc:return ce=vt._init,vt=ce(vt._payload),Wt(gt,dt,vt,zt)}if(ix(vt)||l(vt))return ce!==null?null:$t(gt,dt,vt,zt,null);if(typeof vt.then=="function")return Wt(gt,dt,V0(vt),zt);if(vt.$$typeof===vc)return Wt(gt,dt,qn(gt,vt),zt);G0(gt,vt)}return null}function Le(gt,dt,vt,zt,ce){if(typeof zt=="string"&&zt!==""||typeof zt=="number"||typeof zt=="bigint")return gt=gt.get(vt)||null,ct(dt,gt,""+zt,ce);if(typeof zt=="object"&&zt!==null){switch(zt.$$typeof){case nx:return gt=gt.get(zt.key===null?vt:zt.key)||null,xt(dt,gt,zt,ce);case qf:return gt=gt.get(zt.key===null?vt:zt.key)||null,It(dt,gt,zt,ce);case Sc:var zn=zt._init;return zt=zn(zt._payload),Le(gt,dt,vt,zt,ce)}if(ix(zt)||l(zt))return gt=gt.get(vt)||null,$t(dt,gt,zt,ce,null);if(typeof zt.then=="function")return Le(gt,dt,vt,V0(zt),ce);if(zt.$$typeof===vc)return Le(gt,dt,vt,qn(dt,zt),ce);G0(dt,zt)}return null}function Ss(gt,dt,vt,zt){for(var ce=null,zn=null,ke=dt,sn=dt=0,Oi=null;ke!==null&&sn<vt.length;sn++){ke.index>sn?(Oi=ke,ke=null):Oi=ke.sibling;var on=Wt(gt,ke,vt[sn],zt);if(on===null){ke===null&&(ke=Oi);break}m&&ke&&on.alternate===null&&_(gt,ke),dt=$(on,dt,sn),zn===null?ce=on:zn.sibling=on,zn=on,ke=Oi}if(sn===vt.length)return S(gt,ke),mn&&mt(gt,sn),ce;if(ke===null){for(;sn<vt.length;sn++)ke=Xt(gt,vt[sn],zt),ke!==null&&(dt=$(ke,dt,sn),zn===null?ce=ke:zn.sibling=ke,zn=ke);return mn&&mt(gt,sn),ce}for(ke=C(ke);sn<vt.length;sn++)Oi=Le(ke,gt,sn,vt[sn],zt),Oi!==null&&(m&&Oi.alternate!==null&&ke.delete(Oi.key===null?sn:Oi.key),dt=$(Oi,dt,sn),zn===null?ce=Oi:zn.sibling=Oi,zn=Oi);return m&&ke.forEach(function(Nc){return _(gt,Nc)}),mn&&mt(gt,sn),ce}function Ky(gt,dt,vt,zt){if(vt==null)throw Error(i(151));for(var ce=null,zn=null,ke=dt,sn=dt=0,Oi=null,on=vt.next();ke!==null&&!on.done;sn++,on=vt.next()){ke.index>sn?(Oi=ke,ke=null):Oi=ke.sibling;var Nc=Wt(gt,ke,on.value,zt);if(Nc===null){ke===null&&(ke=Oi);break}m&&ke&&Nc.alternate===null&&_(gt,ke),dt=$(Nc,dt,sn),zn===null?ce=Nc:zn.sibling=Nc,zn=Nc,ke=Oi}if(on.done)return S(gt,ke),mn&&mt(gt,sn),ce;if(ke===null){for(;!on.done;sn++,on=vt.next())on=Xt(gt,on.value,zt),on!==null&&(dt=$(on,dt,sn),zn===null?ce=on:zn.sibling=on,zn=on);return mn&&mt(gt,sn),ce}for(ke=C(ke);!on.done;sn++,on=vt.next())on=Le(ke,gt,sn,on.value,zt),on!==null&&(m&&on.alternate!==null&&ke.delete(on.key===null?sn:on.key),dt=$(on,dt,sn),zn===null?ce=on:zn.sibling=on,zn=on);return m&&ke.forEach(function(jpt){return _(gt,jpt)}),mn&&mt(gt,sn),ce}function gh(gt,dt,vt,zt){if(typeof vt=="object"&&vt!==null&&vt.type===Zf&&vt.key===null&&(vt=vt.props.children),typeof vt=="object"&&vt!==null){switch(vt.$$typeof){case nx:t:{for(var ce=vt.key;dt!==null;){if(dt.key===ce){if(ce=vt.type,ce===Zf){if(dt.tag===7){S(gt,dt.sibling),zt=O(dt,vt.props.children),zt.return=gt,gt=zt;break t}}else if(dt.elementType===ce||typeof ce=="object"&&ce!==null&&ce.$$typeof===Sc&&hF(ce)===dt.type){S(gt,dt.sibling),zt=O(dt,vt.props),Ny(zt,vt),zt.return=gt,gt=zt;break t}S(gt,dt);break}else _(gt,dt);dt=dt.sibling}vt.type===Zf?(zt=lh(vt.props.children,gt.mode,zt,vt.key),zt.return=gt,gt=zt):(zt=ex(vt.type,vt.key,vt.props,null,gt.mode,zt),Ny(zt,vt),zt.return=gt,gt=zt)}return K(gt);case qf:t:{for(ce=vt.key;dt!==null;){if(dt.key===ce)if(dt.tag===4&&dt.stateNode.containerInfo===vt.containerInfo&&dt.stateNode.implementation===vt.implementation){S(gt,dt.sibling),zt=O(dt,vt.children||[]),zt.return=gt,gt=zt;break t}else{S(gt,dt);break}else _(gt,dt);dt=dt.sibling}zt=ZT(vt,gt.mode,zt),zt.return=gt,gt=zt}return K(gt);case Sc:return ce=vt._init,vt=ce(vt._payload),gh(gt,dt,vt,zt)}if(ix(vt))return Ss(gt,dt,vt,zt);if(l(vt)){if(ce=l(vt),typeof ce!="function")throw Error(i(150));return vt=ce.call(vt),Ky(gt,dt,vt,zt)}if(typeof vt.then=="function")return gh(gt,dt,V0(vt),zt);if(vt.$$typeof===vc)return gh(gt,dt,qn(gt,vt),zt);G0(gt,vt)}return typeof vt=="string"&&vt!==""||typeof vt=="number"||typeof vt=="bigint"?(vt=""+vt,dt!==null&&dt.tag===6?(S(gt,dt.sibling),zt=O(dt,vt),zt.return=gt,gt=zt):(S(gt,dt),zt=qT(vt,gt.mode,zt),zt.return=gt,gt=zt),K(gt)):S(gt,dt)}return function(gt,dt,vt,zt){try{Gy=0;var ce=gh(gt,dt,vt,zt);return hm=null,ce}catch(ke){if(ke===Uy||ke===fx)throw ke;var zn=e(29,ke,null,gt.mode);return zn.lanes=zt,zn.return=gt,zn}finally{}}}function mc(m){var _=m.alternate;y(wi,wi.current&1),y(bs,m),Eo===null&&(_===null||lm.current!==null||_.memoizedState!==null)&&(Eo=m)}function fF(m){if(m.tag===22){if(y(wi,wi.current),y(bs,m),Eo===null){var _=m.alternate;_!==null&&_.memoizedState!==null&&(Eo=m)}}else _c(m)}function _c(){y(wi,wi.current),y(bs,bs.current)}function aa(m){f(bs),Eo===m&&(Eo=null),f(wi)}function H0(m){for(var _=m;_!==null;){if(_.tag===13){var S=_.memoizedState;if(S!==null&&(S=S.dehydrated,S===null||o3(S)||a3(S)))return _}else if(_.tag===19&&_.memoizedProps.revealOrder!==void 0){if((_.flags&128)!==0)return _}else if(_.child!==null){_.child.return=_,_=_.child;continue}if(_===m)break;for(;_.sibling===null;){if(_.return===null||_.return===m)return null;_=_.return}_.sibling.return=_.return,_=_.sibling}return null}function vT(m,_,S,C){_=m.memoizedState,S=S(C,_),S=S==null?_:JT({},_,S),m.memoizedState=S,m.lanes===0&&(m.updateQueue.baseState=S)}function mF(m,_,S,C,O,$,K){return m=m.stateNode,typeof m.shouldComponentUpdate=="function"?m.shouldComponentUpdate(C,$,K):_.prototype&&_.prototype.isPureReactComponent?!uc(S,C)||!uc(O,$):!0}function _F(m,_,S,C){m=_.state,typeof _.componentWillReceiveProps=="function"&&_.componentWillReceiveProps(S,C),typeof _.UNSAFE_componentWillReceiveProps=="function"&&_.UNSAFE_componentWillReceiveProps(S,C),_.state!==m&&v3.enqueueReplaceState(_,_.state,null)}function oh(m,_){var S=_;if("ref"in _){S={};for(var C in _)C!=="ref"&&(S[C]=_[C])}if(m=m.defaultProps){S===_&&(S=JT({},S));for(var O in m)S[O]===void 0&&(S[O]=m[O])}return S}function W0(m,_){try{var S=m.onUncaughtError;S(_.value,{componentStack:_.stack})}catch(C){setTimeout(function(){throw C})}}function yF(m,_,S){try{var C=m.onCaughtError;C(S.value,{componentStack:S.stack,errorBoundary:_.tag===1?_.stateNode:null})}catch(O){setTimeout(function(){throw O})}}function ST(m,_,S){return S=fs(S),S.tag=3,S.payload={element:null},S.callback=function(){W0(m,_)},S}function gF(m){return m=fs(m),m.tag=3,m}function xF(m,_,S,C){var O=S.type.getDerivedStateFromError;if(typeof O=="function"){var $=C.value;m.payload=function(){return O($)},m.callback=function(){yF(_,S,C)}}var K=S.stateNode;K!==null&&typeof K.componentDidCatch=="function"&&(m.callback=function(){yF(_,S,C),typeof O!="function"&&(Cc===null?Cc=new Set([this]):Cc.add(this));var ct=C.stack;this.componentDidCatch(C.value,{componentStack:ct!==null?ct:""})})}function Blt(m,_,S,C,O){if(S.flags|=32768,C!==null&&typeof C=="object"&&typeof C.then=="function"){if(_=S.alternate,_!==null&&Se(_,S,O,!0),S=bs.current,S!==null){switch(S.tag){case 13:return Eo===null?VT():S.alternate===null&&ii===0&&(ii=3),S.flags&=-257,S.flags|=65536,S.lanes=O,C===mx?S.flags|=16384:(_=S.updateQueue,_===null?S.updateQueue=new Set([C]):_.add(C),HT(m,C,O)),!1;case 22:return S.flags|=65536,C===mx?S.flags|=16384:(_=S.updateQueue,_===null?(_={transitions:null,markerInstances:null,retryQueue:new Set([C])},S.updateQueue=_):(S=_.retryQueue,S===null?_.retryQueue=new Set([C]):S.add(C)),HT(m,C,O)),!1}throw Error(i(435,S.tag))}return HT(m,C,O),VT(),!1}if(mn)return _=bs.current,_!==null?((_.flags&65536)===0&&(_.flags|=256),_.flags|=65536,_.lanes=O,C!==f3&&(m=Error(i(422),{cause:C}),Z(et(m,S)))):(C!==f3&&(_=Error(i(423),{cause:C}),Z(et(_,S))),m=m.current.alternate,m.flags|=65536,O&=-O,m.lanes|=O,C=et(C,S),O=ST(m.stateNode,C,O),th(m,O),ii!==4&&(ii=2)),!1;var $=Error(i(520),{cause:C});if($=et($,S),Wy===null?Wy=[$]:Wy.push($),ii!==4&&(ii=2),_===null)return!0;C=et(C,S),S=_;do{switch(S.tag){case 3:return S.flags|=65536,m=O&-O,S.lanes|=m,m=ST(S.stateNode,C,m),th(S,m),!1;case 1:if(_=S.type,$=S.stateNode,(S.flags&128)===0&&(typeof _.getDerivedStateFromError=="function"||$!==null&&typeof $.componentDidCatch=="function"&&(Cc===null||!Cc.has($))))return S.flags|=65536,O&=-O,S.lanes|=O,O=gF(O),xF(O,m,S,C),th(S,O),!1}S=S.return}while(S!==null);return!1}function qi(m,_,S,C){_.child=m===null?i$(_,null,S,C):dm(_,m.child,S,C)}function bF(m,_,S,C,O){S=S.render;var $=_.ref;if("ref"in C){var K={};for(var ct in C)ct!=="ref"&&(K[ct]=C[ct])}else K=C;return le(_),C=rh(m,_,S,K,$,O),ct=Sy(),m!==null&&!Ai?(wy(m,_,O),ca(m,_,O)):(mn&&ct&&J(_),_.flags|=1,qi(m,_,C,O),_.child)}function vF(m,_,S,C,O){if(m===null){var $=S.type;return typeof $=="function"&&!WT($)&&$.defaultProps===void 0&&S.compare===null?(_.tag=15,_.type=$,SF(m,_,$,C,O)):(m=ex(S.type,null,C,_,_.mode,O),m.ref=_.ref,m.return=_,_.child=m)}if($=m.child,!CT(m,O)){var K=$.memoizedProps;if(S=S.compare,S=S!==null?S:uc,S(K,C)&&m.ref===_.ref)return ca(m,_,O)}return _.flags|=1,m=la($,C),m.ref=_.ref,m.return=_,_.child=m}function SF(m,_,S,C,O){if(m!==null){var $=m.memoizedProps;if(uc($,C)&&m.ref===_.ref)if(Ai=!1,_.pendingProps=C=$,CT(m,O))(m.flags&131072)!==0&&(Ai=!0);else return _.lanes=m.lanes,ca(m,_,O)}return wT(m,_,S,C,O)}function wF(m,_,S){var C=_.pendingProps,O=C.children,$=m!==null?m.memoizedState:null;if(C.mode==="hidden"){if((_.flags&128)!==0){if(C=$!==null?$.baseLanes|S:S,m!==null){for(O=_.child=m.child,$=0;O!==null;)$=$|O.lanes|O.childLanes,O=O.sibling;_.childLanes=$&~C}else _.childLanes=0,_.child=null;return PF(m,_,C,S)}if((S&536870912)!==0)_.memoizedState={baseLanes:0,cachePool:null},m!==null&&lc(_,$!==null?$.cachePool:null),$!==null?Yf(_,$):eh(),fF(_);else return _.lanes=_.childLanes=536870912,PF(m,_,$!==null?$.baseLanes|S:S,S)}else $!==null?(lc(_,$.cachePool),Yf(_,$),_c(_),_.memoizedState=null):(m!==null&&lc(_,null),eh(),_c(_));return qi(m,_,O,S),_.child}function PF(m,_,S,C){var O=Zp();return O=O===null?null:{parent:ua?ni._currentValue:ni._currentValue2,pool:O},_.memoizedState={baseLanes:S,cachePool:O},m!==null&&lc(_,null),eh(),fF(_),m!==null&&Se(m,_,C,!0),null}function q0(m,_){var S=_.ref;if(S===null)m!==null&&m.ref!==null&&(_.flags|=4194816);else{if(typeof S!="function"&&typeof S!="object")throw Error(i(284));(m===null||m.ref!==S)&&(_.flags|=4194816)}}function wT(m,_,S,C,O){return le(_),S=rh(m,_,S,C,void 0,O),C=Sy(),m!==null&&!Ai?(wy(m,_,O),ca(m,_,O)):(mn&&C&&J(_),_.flags|=1,qi(m,_,S,O),_.child)}function kF(m,_,S,C,O,$){return le(_),_.updateQueue=null,S=B0(_,C,S,O),j0(m),C=Sy(),m!==null&&!Ai?(wy(m,_,$),ca(m,_,$)):(mn&&C&&J(_),_.flags|=1,qi(m,_,S,$),_.child)}function TF(m,_,S,C,O){if(le(_),_.stateNode===null){var $=tm,K=S.contextType;typeof K=="object"&&K!==null&&($=Jt(K)),$=new S(C,$),_.memoizedState=$.state!==null&&$.state!==void 0?$.state:null,$.updater=v3,_.stateNode=$,$._reactInternals=_,$=_.stateNode,$.props=C,$.state=_.memoizedState,$.refs={},Jp(_),K=S.contextType,$.context=typeof K=="object"&&K!==null?Jt(K):tm,$.state=_.memoizedState,K=S.getDerivedStateFromProps,typeof K=="function"&&(vT(_,S,K,C),$.state=_.memoizedState),typeof S.getDerivedStateFromProps=="function"||typeof $.getSnapshotBeforeUpdate=="function"||typeof $.UNSAFE_componentWillMount!="function"&&typeof $.componentWillMount!="function"||(K=$.state,typeof $.componentWillMount=="function"&&$.componentWillMount(),typeof $.UNSAFE_componentWillMount=="function"&&$.UNSAFE_componentWillMount(),K!==$.state&&v3.enqueueReplaceState($,$.state,null),oa(_,C,$,O),sa(),$.state=_.memoizedState),typeof $.componentDidMount=="function"&&(_.flags|=4194308),C=!0}else if(m===null){$=_.stateNode;var ct=_.memoizedProps,xt=oh(S,ct);$.props=xt;var It=$.context,$t=S.contextType;K=tm,typeof $t=="object"&&$t!==null&&(K=Jt($t));var Xt=S.getDerivedStateFromProps;$t=typeof Xt=="function"||typeof $.getSnapshotBeforeUpdate=="function",ct=_.pendingProps!==ct,$t||typeof $.UNSAFE_componentWillReceiveProps!="function"&&typeof $.componentWillReceiveProps!="function"||(ct||It!==K)&&_F(_,$,C,K),kc=!1;var Wt=_.memoizedState;$.state=Wt,oa(_,C,$,O),sa(),It=_.memoizedState,ct||Wt!==It||kc?(typeof Xt=="function"&&(vT(_,S,Xt,C),It=_.memoizedState),(xt=kc||mF(_,S,xt,C,Wt,It,K))?($t||typeof $.UNSAFE_componentWillMount!="function"&&typeof $.componentWillMount!="function"||(typeof $.componentWillMount=="function"&&$.componentWillMount(),typeof $.UNSAFE_componentWillMount=="function"&&$.UNSAFE_componentWillMount()),typeof $.componentDidMount=="function"&&(_.flags|=4194308)):(typeof $.componentDidMount=="function"&&(_.flags|=4194308),_.memoizedProps=C,_.memoizedState=It),$.props=C,$.state=It,$.context=K,C=xt):(typeof $.componentDidMount=="function"&&(_.flags|=4194308),C=!1)}else{$=_.stateNode,Qp(m,_),K=_.memoizedProps,$t=oh(S,K),$.props=$t,Xt=_.pendingProps,Wt=$.context,It=S.contextType,xt=tm,typeof It=="object"&&It!==null&&(xt=Jt(It)),ct=S.getDerivedStateFromProps,(It=typeof ct=="function"||typeof $.getSnapshotBeforeUpdate=="function")||typeof $.UNSAFE_componentWillReceiveProps!="function"&&typeof $.componentWillReceiveProps!="function"||(K!==Xt||Wt!==xt)&&_F(_,$,C,xt),kc=!1,Wt=_.memoizedState,$.state=Wt,oa(_,C,$,O),sa();var Le=_.memoizedState;K!==Xt||Wt!==Le||kc||m!==null&&m.dependencies!==null&&Kt(m.dependencies)?(typeof ct=="function"&&(vT(_,S,ct,C),Le=_.memoizedState),($t=kc||mF(_,S,$t,C,Wt,Le,xt)||m!==null&&m.dependencies!==null&&Kt(m.dependencies))?(It||typeof $.UNSAFE_componentWillUpdate!="function"&&typeof $.componentWillUpdate!="function"||(typeof $.componentWillUpdate=="function"&&$.componentWillUpdate(C,Le,xt),typeof $.UNSAFE_componentWillUpdate=="function"&&$.UNSAFE_componentWillUpdate(C,Le,xt)),typeof $.componentDidUpdate=="function"&&(_.flags|=4),typeof $.getSnapshotBeforeUpdate=="function"&&(_.flags|=1024)):(typeof $.componentDidUpdate!="function"||K===m.memoizedProps&&Wt===m.memoizedState||(_.flags|=4),typeof $.getSnapshotBeforeUpdate!="function"||K===m.memoizedProps&&Wt===m.memoizedState||(_.flags|=1024),_.memoizedProps=C,_.memoizedState=Le),$.props=C,$.state=Le,$.context=xt,C=$t):(typeof $.componentDidUpdate!="function"||K===m.memoizedProps&&Wt===m.memoizedState||(_.flags|=4),typeof $.getSnapshotBeforeUpdate!="function"||K===m.memoizedProps&&Wt===m.memoizedState||(_.flags|=1024),C=!1)}return $=C,q0(m,_),C=(_.flags&128)!==0,$||C?($=_.stateNode,S=C&&typeof S.getDerivedStateFromError!="function"?null:$.render(),_.flags|=1,m!==null&&C?(_.child=dm(_,m.child,null,O),_.child=dm(_,null,S,O)):qi(m,_,S,O),_.memoizedState=$.state,m=_.child):m=ca(m,_,O),m}function EF(m,_,S,C){return pt(),_.flags|=256,qi(m,_,S,C),_.child}function PT(m){return{baseLanes:m,cachePool:Of()}}function kT(m,_,S){return m=m!==null?m.childLanes&~S:0,_&&(m|=vs),m}function MF(m,_,S){var C=_.pendingProps,O=!1,$=(_.flags&128)!==0,K;if((K=$)||(K=m!==null&&m.memoizedState===null?!1:(wi.current&2)!==0),K&&(O=!0,_.flags&=-129),K=(_.flags&32)!==0,_.flags&=-33,m===null){if(mn){if(O?mc(_):_c(_),mn){var ct=Si,xt;(xt=ct)&&(ct=apt(ct,To),ct!==null?(_.memoizedState={dehydrated:ct,treeContext:hh!==null?{id:ha,overflow:da}:null,retryLane:536870912,hydrationErrors:null},xt=e(18,null,null,0),xt.stateNode=ct,xt.return=_,_.child=xt,Pr=_,Si=null,xt=!0):xt=!1),xt||ot(_)}if(ct=_.memoizedState,ct!==null&&(ct=ct.dehydrated,ct!==null))return a3(ct)?_.lanes=32:_.lanes=536870912,null;aa(_)}return ct=C.children,C=C.fallback,O?(_c(_),O=_.mode,ct=Z0({mode:"hidden",children:ct},O),C=lh(C,O,S,null),ct.return=_,C.return=_,ct.sibling=C,_.child=ct,O=_.child,O.memoizedState=PT(S),O.childLanes=kT(m,K,S),_.memoizedState=S3,C):(mc(_),TT(_,ct))}if(xt=m.memoizedState,xt!==null&&(ct=xt.dehydrated,ct!==null)){if($)_.flags&256?(mc(_),_.flags&=-257,_=ET(m,_,S)):_.memoizedState!==null?(_c(_),_.child=m.child,_.flags|=128,_=null):(_c(_),O=C.fallback,ct=_.mode,C=Z0({mode:"visible",children:C.children},ct),O=lh(O,ct,S,null),O.flags|=2,C.return=_,O.return=_,C.sibling=O,_.child=C,dm(_,m.child,null,S),C=_.child,C.memoizedState=PT(S),C.childLanes=kT(m,K,S),_.memoizedState=S3,_=O);else if(mc(_),a3(ct))K=Zut(ct).digest,C=Error(i(419)),C.stack="",C.digest=K,Z({value:C,source:null,stack:null}),_=ET(m,_,S);else if(Ai||Se(m,_,S,!1),K=(S&m.childLanes)!==0,Ai||K){if(K=An,K!==null&&(C=S&-S,C=(C&42)!==0?1:R(C),C=(C&(K.suspendedLanes|S))!==0?0:C,C!==0&&C!==xt.retryLane))throw xt.retryLane=C,wo(m,C),Qr(K,m,C),s$;o3(ct)||VT(),_=ET(m,_,S)}else o3(ct)?(_.flags|=192,_.child=m.child,_=null):(m=xt.treeContext,_s&&(Si=ipt(ct),Pr=_,mn=!0,dh=null,To=!1,m!==null&&(ys[gs++]=ha,ys[gs++]=da,ys[gs++]=hh,ha=m.id,da=m.overflow,hh=_)),_=TT(_,C.children),_.flags|=4096);return _}return O?(_c(_),O=C.fallback,ct=_.mode,xt=m.child,$=xt.sibling,C=la(xt,{mode:"hidden",children:C.children}),C.subtreeFlags=xt.subtreeFlags&65011712,$!==null?O=la($,O):(O=lh(O,ct,S,null),O.flags|=2),O.return=_,C.return=_,C.sibling=O,_.child=C,C=O,O=_.child,ct=m.child.memoizedState,ct===null?ct=PT(S):(xt=ct.cachePool,xt!==null?($=ua?ni._currentValue:ni._currentValue2,xt=xt.parent!==$?{parent:$,pool:$}:xt):xt=Of(),ct={baseLanes:ct.baseLanes|S,cachePool:xt}),O.memoizedState=ct,O.childLanes=kT(m,K,S),_.memoizedState=S3,C):(mc(_),S=m.child,m=S.sibling,S=la(S,{mode:"visible",children:C.children}),S.return=_,S.sibling=null,m!==null&&(K=_.deletions,K===null?(_.deletions=[m],_.flags|=16):K.push(m)),_.child=S,_.memoizedState=null,S)}function TT(m,_){return _=Z0({mode:"visible",children:_},m.mode),_.return=m,m.child=_}function Z0(m,_){return m=e(22,m,null,_),m.lanes=0,m.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},m}function ET(m,_,S){return dm(_,m.child,null,S),m=TT(_,_.pendingProps.children),m.flags|=2,_.memoizedState=null,m}function CF(m,_,S){m.lanes|=_;var C=m.alternate;C!==null&&(C.lanes|=_),Ot(m.return,_,S)}function MT(m,_,S,C,O){var $=m.memoizedState;$===null?m.memoizedState={isBackwards:_,rendering:null,renderingStartTime:0,last:C,tail:S,tailMode:O}:($.isBackwards=_,$.rendering=null,$.renderingStartTime=0,$.last=C,$.tail=S,$.tailMode=O)}function IF(m,_,S){var C=_.pendingProps,O=C.revealOrder,$=C.tail;if(qi(m,_,C.children,S),C=wi.current,(C&2)!==0)C=C&1|2,_.flags|=128;else{if(m!==null&&(m.flags&128)!==0)t:for(m=_.child;m!==null;){if(m.tag===13)m.memoizedState!==null&&CF(m,S,_);else if(m.tag===19)CF(m,S,_);else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===_)break t;for(;m.sibling===null;){if(m.return===null||m.return===_)break t;m=m.return}m.sibling.return=m.return,m=m.sibling}C&=1}switch(y(wi,C),O){case"forwards":for(S=_.child,O=null;S!==null;)m=S.alternate,m!==null&&H0(m)===null&&(O=S),S=S.sibling;S=O,S===null?(O=_.child,_.child=null):(O=S.sibling,S.sibling=null),MT(_,!1,O,S,$);break;case"backwards":for(S=null,O=_.child,_.child=null;O!==null;){if(m=O.alternate,m!==null&&H0(m)===null){_.child=O;break}m=O.sibling,O.sibling=S,S=O,O=m}MT(_,!0,S,null,$);break;case"together":MT(_,!1,null,null,void 0);break;default:_.memoizedState=null}return _.child}function ca(m,_,S){if(m!==null&&(_.dependencies=m.dependencies),Mc|=_.lanes,(S&_.childLanes)===0)if(m!==null){if(Se(m,_,S,!1),(S&_.childLanes)===0)return null}else return null;if(m!==null&&_.child!==m.child)throw Error(i(153));if(_.child!==null){for(m=_.child,S=la(m,m.pendingProps),_.child=S,S.return=_;m.sibling!==null;)m=m.sibling,S=S.sibling=la(m,m.pendingProps),S.return=_;S.sibling=null}return _.child}function CT(m,_){return(m.lanes&_)!==0?!0:(m=m.dependencies,!!(m!==null&&Kt(m)))}function Ylt(m,_,S){switch(_.tag){case 3:ut(_,_.stateNode.containerInfo),Et(_,ni,m.memoizedState.cache),pt();break;case 27:case 5:kt(_);break;case 4:ut(_,_.stateNode.containerInfo);break;case 10:Et(_,_.type,_.memoizedProps.value);break;case 13:var C=_.memoizedState;if(C!==null)return C.dehydrated!==null?(mc(_),_.flags|=128,null):(S&_.child.childLanes)!==0?MF(m,_,S):(mc(_),m=ca(m,_,S),m!==null?m.sibling:null);mc(_);break;case 19:var O=(m.flags&128)!==0;if(C=(S&_.childLanes)!==0,C||(Se(m,_,S,!1),C=(S&_.childLanes)!==0),O){if(C)return IF(m,_,S);_.flags|=128}if(O=_.memoizedState,O!==null&&(O.rendering=null,O.tail=null,O.lastEffect=null),y(wi,wi.current),C)break;return null;case 22:case 23:return _.lanes=0,wF(m,_,S);case 24:Et(_,ni,m.memoizedState.cache)}return ca(m,_,S)}function NF(m,_,S){if(m!==null)if(m.memoizedProps!==_.pendingProps)Ai=!0;else{if(!CT(m,S)&&(_.flags&128)===0)return Ai=!1,Ylt(m,_,S);Ai=(m.flags&131072)!==0}else Ai=!1,mn&&(_.flags&1048576)!==0&&V(_,lx,_.index);switch(_.lanes=0,_.tag){case 16:t:{m=_.pendingProps;var C=_.elementType,O=C._init;if(C=O(C._payload),_.type=C,typeof C=="function")WT(C)?(m=oh(C,m),_.tag=1,_=TF(null,_,C,m,S)):(_.tag=0,_=wT(null,_,C,m,S));else{if(C!=null){if(O=C.$$typeof,O===t3){_.tag=11,_=bF(null,_,C,m,S);break t}else if(O===i3){_.tag=14,_=vF(null,_,C,m,S);break t}}throw _=u(C)||C,Error(i(306,_,""))}}return _;case 0:return wT(m,_,_.type,_.pendingProps,S);case 1:return C=_.type,O=oh(C,_.pendingProps),TF(m,_,C,O,S);case 3:t:{if(ut(_,_.stateNode.containerInfo),m===null)throw Error(i(387));var $=_.pendingProps;O=_.memoizedState,C=O.element,Qp(m,_),oa(_,$,null,S);var K=_.memoizedState;if($=K.cache,Et(_,ni,$),$!==O.cache&&Ce(_,[ni],S,!0),sa(),$=K.element,_s&&O.isDehydrated)if(O={element:$,isDehydrated:!1,cache:K.cache},_.updateQueue.baseState=O,_.memoizedState=O,_.flags&256){_=EF(m,_,$,S);break t}else if($!==C){C=et(Error(i(424)),_),Z(C),_=EF(m,_,$,S);break t}else for(_s&&(Si=npt(_.stateNode.containerInfo),Pr=_,mn=!0,dh=null,To=!0),S=i$(_,null,$,S),_.child=S;S;)S.flags=S.flags&-3|4096,S=S.sibling;else{if(pt(),$===C){_=ca(m,_,S);break t}qi(m,_,$,S)}_=_.child}return _;case 26:if(Gs)return q0(m,_),m===null?(S=Yz(_.type,null,_.pendingProps,null))?_.memoizedState=S:mn||(_.stateNode=xpt(_.type,_.pendingProps,Pc.current,_)):_.memoizedState=Yz(_.type,m.memoizedProps,_.pendingProps,m.memoizedState),null;case 27:if(vi)return kt(_),m===null&&vi&&mn&&(C=_.stateNode=Wz(_.type,_.pendingProps,Pc.current,Zi.current,!1),Pr=_,To=!0,Si=rpt(_.type,C,Si)),qi(m,_,_.pendingProps.children,S),q0(m,_),m===null&&(_.flags|=4194304),_.child;case 5:return m===null&&mn&&(_pt(_.type,_.pendingProps,Zi.current),(O=C=Si)&&(C=spt(C,_.type,_.pendingProps,To),C!==null?(_.stateNode=C,Pr=_,Si=ept(C),To=!1,O=!0):O=!1),O||ot(_)),kt(_),O=_.type,$=_.pendingProps,K=m!==null?m.memoizedProps:null,C=$.children,rx(O,$)?C=null:K!==null&&rx(O,K)&&(_.flags|=32),_.memoizedState!==null&&(O=rh(m,_,fT,null,null,S),ua?ph._currentValue=O:ph._currentValue2=O),q0(m,_),qi(m,_,C,S),_.child;case 6:return m===null&&mn&&(ypt(_.pendingProps,Zi.current),(m=S=Si)&&(S=opt(S,_.pendingProps,To),S!==null?(_.stateNode=S,Pr=_,Si=null,m=!0):m=!1),m||ot(_)),null;case 13:return MF(m,_,S);case 4:return ut(_,_.stateNode.containerInfo),C=_.pendingProps,m===null?_.child=dm(_,null,C,S):qi(m,_,C,S),_.child;case 11:return bF(m,_,_.type,_.pendingProps,S);case 7:return qi(m,_,_.pendingProps,S),_.child;case 8:return qi(m,_,_.pendingProps.children,S),_.child;case 12:return qi(m,_,_.pendingProps.children,S),_.child;case 10:return C=_.pendingProps,Et(_,_.type,C.value),qi(m,_,C.children,S),_.child;case 9:return O=_.type._context,C=_.pendingProps.children,le(_),O=Jt(O),C=C(O),_.flags|=1,qi(m,_,C,S),_.child;case 14:return vF(m,_,_.type,_.pendingProps,S);case 15:return SF(m,_,_.type,_.pendingProps,S);case 19:return IF(m,_,S);case 31:return C=_.pendingProps,S=_.mode,C={mode:C.mode,children:C.children},m===null?(S=Z0(C,S),S.ref=_.ref,_.child=S,S.return=_,_=S):(S=la(m.child,C),S.ref=_.ref,_.child=S,S.return=_,_=S),_;case 22:return wF(m,_,S);case 24:return le(_),C=Jt(ni),m===null?(O=Zp(),O===null&&(O=An,$=Nr(),O.pooledCache=$,$.refCount++,$!==null&&(O.pooledCacheLanes|=S),O=$),_.memoizedState={parent:C,cache:O},Jp(_),Et(_,ni,O)):((m.lanes&S)!==0&&(Qp(m,_),oa(_,null,null,S),sa()),O=m.memoizedState,$=_.memoizedState,O.parent!==C?(O={parent:C,cache:C},_.memoizedState=O,_.lanes===0&&(_.memoizedState=_.updateQueue.baseState=O),Et(_,ni,C)):(C=$.cache,Et(_,ni,C),C!==O.cache&&Ce(_,[ni],S,!0))),qi(m,_,_.pendingProps.children,S),_.child;case 29:throw _.pendingProps}throw Error(i(156,_.tag))}function Kr(m){m.flags|=4}function AF(m,_){if(m!==null&&m.child===_.child)return!1;if((_.flags&16)!==0)return!0;for(m=_.child;m!==null;){if((m.flags&13878)!==0||(m.subtreeFlags&13878)!==0)return!0;m=m.sibling}return!1}function IT(m,_,S,C){if(lr)for(S=_.child;S!==null;){if(S.tag===5||S.tag===6)s3(m,S.stateNode);else if(!(S.tag===4||vi&&S.tag===27)&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===_)break;for(;S.sibling===null;){if(S.return===null||S.return===_)return;S=S.return}S.sibling.return=S.return,S=S.sibling}else if(wc)for(var O=_.child;O!==null;){if(O.tag===5){var $=O.stateNode;S&&C&&($=zz($,O.type,O.memoizedProps)),s3(m,$)}else if(O.tag===6)$=O.stateNode,S&&C&&($=$z($,O.memoizedProps)),s3(m,$);else if(O.tag!==4){if(O.tag===22&&O.memoizedState!==null)$=O.child,$!==null&&($.return=O),IT(m,O,!0,!0);else if(O.child!==null){O.child.return=O,O=O.child;continue}}if(O===_)break;for(;O.sibling===null;){if(O.return===null||O.return===_)return;O=O.return}O.sibling.return=O.return,O=O.sibling}}function RF(m,_,S,C){var O=!1;if(wc)for(var $=_.child;$!==null;){if($.tag===5){var K=$.stateNode;S&&C&&(K=zz(K,$.type,$.memoizedProps)),Lz(m,K)}else if($.tag===6)K=$.stateNode,S&&C&&(K=$z(K,$.memoizedProps)),Lz(m,K);else if($.tag!==4){if($.tag===22&&$.memoizedState!==null)O=$.child,O!==null&&(O.return=$),RF(m,$,!0,!0),O=!0;else if($.child!==null){$.child.return=$,$=$.child;continue}}if($===_)break;for(;$.sibling===null;){if($.return===null||$.return===_)return O;$=$.return}$.sibling.return=$.return,$=$.sibling}return O}function OF(m,_){if(wc&&AF(m,_)){m=_.stateNode;var S=m.containerInfo,C=Oz();RF(C,_,!1,!1),m.pendingChildren=C,Kr(_),qut(S,C)}}function NT(m,_,S,C){if(lr)m.memoizedProps!==C&&Kr(_);else if(wc){var O=m.stateNode,$=m.memoizedProps;if((m=AF(m,_))||$!==C){var K=Zi.current;$=Wut(O,S,$,C,!m,null),$===O?_.stateNode=O:(Cz($,S,C,K)&&Kr(_),_.stateNode=$,m?IT($,_,!1,!1):Kr(_))}else _.stateNode=O}}function AT(m,_,S){if(Sut(_,S)){if(m.flags|=16777216,!Nz(_,S))if(sz())m.flags|=8192;else throw am=mx,g3}else m.flags&=-16777217}function LF(m,_){if(vpt(_)){if(m.flags|=16777216,!Hz(_))if(sz())m.flags|=8192;else throw am=mx,g3}else m.flags&=-16777217}function K0(m,_){_!==null&&(m.flags|=4),m.flags&16384&&(_=m.tag!==22?T():536870912,m.lanes|=_,_m|=_)}function Ay(m,_){if(!mn)switch(m.tailMode){case"hidden":_=m.tail;for(var S=null;_!==null;)_.alternate!==null&&(S=_),_=_.sibling;S===null?m.tail=null:S.sibling=null;break;case"collapsed":S=m.tail;for(var C=null;S!==null;)S.alternate!==null&&(C=S),S=S.sibling;C===null?_||m.tail===null?m.tail=null:m.tail.sibling=null:C.sibling=null}}function Zn(m){var _=m.alternate!==null&&m.alternate.child===m.child,S=0,C=0;if(_)for(var O=m.child;O!==null;)S|=O.lanes|O.childLanes,C|=O.subtreeFlags&65011712,C|=O.flags&65011712,O.return=m,O=O.sibling;else for(O=m.child;O!==null;)S|=O.lanes|O.childLanes,C|=O.subtreeFlags,C|=O.flags,O.return=m,O=O.sibling;return m.subtreeFlags|=C,m.childLanes=S,_}function Xlt(m,_,S){var C=_.pendingProps;switch(nt(_),_.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zn(_),null;case 1:return Zn(_),null;case 3:return S=_.stateNode,C=null,m!==null&&(C=m.memoizedState.cache),_.memoizedState.cache!==C&&(_.flags|=2048),Ft(ni),ht(),S.pendingContext&&(S.context=S.pendingContext,S.pendingContext=null),(m===null||m.child===null)&&(rt(_)?Kr(_):m===null||m.memoizedState.isDehydrated&&(_.flags&256)===0||(_.flags|=1024,yt())),OF(m,_),Zn(_),null;case 26:if(Gs){S=_.type;var O=_.memoizedState;return m===null?(Kr(_),O!==null?(Zn(_),LF(_,O)):(Zn(_),AT(_,S,C))):O?O!==m.memoizedState?(Kr(_),Zn(_),LF(_,O)):(Zn(_),_.flags&=-16777217):(lr?m.memoizedProps!==C&&Kr(_):NT(m,_,S,C),Zn(_),AT(_,S,C)),null}case 27:if(vi){if(Mt(_),S=Pc.current,O=_.type,m!==null&&_.stateNode!=null)lr?m.memoizedProps!==C&&Kr(_):NT(m,_,O,C);else{if(!C){if(_.stateNode===null)throw Error(i(166));return Zn(_),null}m=Zi.current,rt(_)?X(_,m):(m=Wz(O,C,S,m,!0),_.stateNode=m,Kr(_))}return Zn(_),null}case 5:if(Mt(_),S=_.type,m!==null&&_.stateNode!=null)NT(m,_,S,C);else{if(!C){if(_.stateNode===null)throw Error(i(166));return Zn(_),null}m=Zi.current,rt(_)?X(_,m):(O=fut(S,C,Pc.current,m,_),IT(O,_,!1,!1),_.stateNode=O,Cz(O,S,C,m)&&Kr(_))}return Zn(_),AT(_,_.type,_.pendingProps),null;case 6:if(m&&_.stateNode!=null)S=m.memoizedProps,lr?S!==C&&Kr(_):wc&&(S!==C?(_.stateNode=Iz(C,Pc.current,Zi.current,_),Kr(_)):_.stateNode=m.stateNode);else{if(typeof C!="string"&&_.stateNode===null)throw Error(i(166));if(m=Pc.current,S=Zi.current,rt(_)){if(!_s)throw Error(i(176));if(m=_.stateNode,S=_.memoizedProps,C=null,O=Pr,O!==null)switch(O.tag){case 27:case 5:C=O.memoizedProps}lpt(m,S,_,C)||ot(_)}else _.stateNode=Iz(C,m,S,_)}return Zn(_),null;case 13:if(C=_.memoizedState,m===null||m.memoizedState!==null&&m.memoizedState.dehydrated!==null){if(O=rt(_),C!==null&&C.dehydrated!==null){if(m===null){if(!O)throw Error(i(318));if(!_s)throw Error(i(344));if(O=_.memoizedState,O=O!==null?O.dehydrated:null,!O)throw Error(i(317));upt(O,_)}else pt(),(_.flags&128)===0&&(_.memoizedState=null),_.flags|=4;Zn(_),O=!1}else O=yt(),m!==null&&m.memoizedState!==null&&(m.memoizedState.hydrationErrors=O),O=!0;if(!O)return _.flags&256?(aa(_),_):(aa(_),null)}if(aa(_),(_.flags&128)!==0)return _.lanes=S,_;if(S=C!==null,m=m!==null&&m.memoizedState!==null,S){C=_.child,O=null,C.alternate!==null&&C.alternate.memoizedState!==null&&C.alternate.memoizedState.cachePool!==null&&(O=C.alternate.memoizedState.cachePool.pool);var $=null;C.memoizedState!==null&&C.memoizedState.cachePool!==null&&($=C.memoizedState.cachePool.pool),$!==O&&(C.flags|=2048)}return S!==m&&S&&(_.child.flags|=8192),K0(_,_.updateQueue),Zn(_),null;case 4:return ht(),OF(m,_),m===null&&gut(_.stateNode.containerInfo),Zn(_),null;case 10:return Ft(_.type),Zn(_),null;case 19:if(f(wi),O=_.memoizedState,O===null)return Zn(_),null;if(C=(_.flags&128)!==0,$=O.rendering,$===null)if(C)Ay(O,!1);else{if(ii!==0||m!==null&&(m.flags&128)!==0)for(m=_.child;m!==null;){if($=H0(m),$!==null){for(_.flags|=128,Ay(O,!1),m=$.updateQueue,_.updateQueue=m,K0(_,m),_.subtreeFlags=0,m=S,S=_.child;S!==null;)xz(S,m),S=S.sibling;return y(wi,wi.current&1|2),_.child}m=m.sibling}O.tail!==null&&Hs()>qy&&(_.flags|=128,C=!0,Ay(O,!1),_.lanes=4194304)}else{if(!C)if(m=H0($),m!==null){if(_.flags|=128,C=!0,m=m.updateQueue,_.updateQueue=m,K0(_,m),Ay(O,!0),O.tail===null&&O.tailMode==="hidden"&&!$.alternate&&!mn)return Zn(_),null}else 2*Hs()-O.renderingStartTime>qy&&S!==536870912&&(_.flags|=128,C=!0,Ay(O,!1),_.lanes=4194304);O.isBackwards?($.sibling=_.child,_.child=$):(m=O.last,m!==null?m.sibling=$:_.child=$,O.last=$)}return O.tail!==null?(_=O.tail,O.rendering=_,O.tail=_.sibling,O.renderingStartTime=Hs(),_.sibling=null,m=wi.current,y(wi,C?m&1|2:m&1),_):(Zn(_),null);case 22:case 23:return aa(_),nh(),C=_.memoizedState!==null,m!==null?m.memoizedState!==null!==C&&(_.flags|=8192):C&&(_.flags|=8192),C?(S&536870912)!==0&&(_.flags&128)===0&&(Zn(_),_.subtreeFlags&6&&(_.flags|=8192)):Zn(_),S=_.updateQueue,S!==null&&K0(_,S.retryQueue),S=null,m!==null&&m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(S=m.memoizedState.cachePool.pool),C=null,_.memoizedState!==null&&_.memoizedState.cachePool!==null&&(C=_.memoizedState.cachePool.pool),C!==S&&(_.flags|=2048),m!==null&&f(mh),null;case 24:return S=null,m!==null&&(S=m.memoizedState.cache),_.memoizedState.cache!==S&&(_.flags|=2048),Ft(ni),Zn(_),null;case 25:return null;case 30:return null}throw Error(i(156,_.tag))}function Ult(m,_){switch(nt(_),_.tag){case 1:return m=_.flags,m&65536?(_.flags=m&-65537|128,_):null;case 3:return Ft(ni),ht(),m=_.flags,(m&65536)!==0&&(m&128)===0?(_.flags=m&-65537|128,_):null;case 26:case 27:case 5:return Mt(_),null;case 13:if(aa(_),m=_.memoizedState,m!==null&&m.dehydrated!==null){if(_.alternate===null)throw Error(i(340));pt()}return m=_.flags,m&65536?(_.flags=m&-65537|128,_):null;case 19:return f(wi),null;case 4:return ht(),null;case 10:return Ft(_.type),null;case 22:case 23:return aa(_),nh(),m!==null&&f(mh),m=_.flags,m&65536?(_.flags=m&-65537|128,_):null;case 24:return Ft(ni),null;case 25:return null;default:return null}}function FF(m,_){switch(nt(_),_.tag){case 3:Ft(ni),ht();break;case 26:case 27:case 5:Mt(_);break;case 4:ht();break;case 13:aa(_);break;case 19:f(wi);break;case 10:Ft(_.type);break;case 22:case 23:aa(_),nh(),m!==null&&f(mh);break;case 24:Ft(ni)}}function Ry(m,_){try{var S=_.updateQueue,C=S!==null?S.lastEffect:null;if(C!==null){var O=C.next;S=O;do{if((S.tag&m)===m){C=void 0;var $=S.create,K=S.inst;C=$(),K.destroy=C}S=S.next}while(S!==O)}}catch(ct){gn(_,_.return,ct)}}function yc(m,_,S){try{var C=_.updateQueue,O=C!==null?C.lastEffect:null;if(O!==null){var $=O.next;C=$;do{if((C.tag&m)===m){var K=C.inst,ct=K.destroy;if(ct!==void 0){K.destroy=void 0,O=_;var xt=S,It=ct;try{It()}catch($t){gn(O,xt,$t)}}}C=C.next}while(C!==$)}}catch($t){gn(_,_.return,$t)}}function zF(m){var _=m.updateQueue;if(_!==null){var S=m.stateNode;try{Bf(_,S)}catch(C){gn(m,m.return,C)}}}function $F(m,_,S){S.props=oh(m.type,m.memoizedProps),S.state=m.memoizedState;try{S.componentWillUnmount()}catch(C){gn(m,_,C)}}function Oy(m,_){try{var S=m.ref;if(S!==null){switch(m.tag){case 26:case 27:case 5:var C=$y(m.stateNode);break;case 30:C=m.stateNode;break;default:C=m.stateNode}typeof S=="function"?m.refCleanup=S(C):S.current=C}}catch(O){gn(m,_,O)}}function Po(m,_){var S=m.ref,C=m.refCleanup;if(S!==null)if(typeof C=="function")try{C()}catch(O){gn(m,_,O)}finally{m.refCleanup=null,m=m.alternate,m!=null&&(m.refCleanup=null)}else if(typeof S=="function")try{S(null)}catch(O){gn(m,_,O)}else S.current=null}function DF(m){var _=m.type,S=m.memoizedProps,C=m.stateNode;try{zut(C,_,S,m)}catch(O){gn(m,m.return,O)}}function RT(m,_,S){try{$ut(m.stateNode,m.type,S,_,m)}catch(C){gn(m,m.return,C)}}function jF(m){return m.tag===5||m.tag===3||(Gs?m.tag===26:!1)||(vi?m.tag===27&&Jf(m.type):!1)||m.tag===4}function OT(m){t:for(;;){for(;m.sibling===null;){if(m.return===null||jF(m.return))return null;m=m.return}for(m.sibling.return=m.return,m=m.sibling;m.tag!==5&&m.tag!==6&&m.tag!==18;){if(vi&&m.tag===27&&Jf(m.type)||m.flags&2||m.child===null||m.tag===4)continue t;m.child.return=m,m=m.child}if(!(m.flags&2))return m.stateNode}}function LT(m,_,S){var C=m.tag;if(C===5||C===6)m=m.stateNode,_?jut(S,m,_):Lut(S,m);else if(C!==4&&(vi&&C===27&&Jf(m.type)&&(S=m.stateNode,_=null),m=m.child,m!==null))for(LT(m,_,S),m=m.sibling;m!==null;)LT(m,_,S),m=m.sibling}function J0(m,_,S){var C=m.tag;if(C===5||C===6)m=m.stateNode,_?Dut(S,m,_):Out(S,m);else if(C!==4&&(vi&&C===27&&Jf(m.type)&&(S=m.stateNode),m=m.child,m!==null))for(J0(m,_,S),m=m.sibling;m!==null;)J0(m,_,S),m=m.sibling}function BF(m,_,S){m=m.containerInfo;try{Fz(m,S)}catch(C){gn(_,_.return,C)}}function YF(m){var _=m.stateNode,S=m.memoizedProps;try{wpt(m.type,S,_,m)}catch(C){gn(m,m.return,C)}}function Vlt(m,_){for(hut(m.containerInfo),Ri=_;Ri!==null;)if(m=Ri,_=m.child,(m.subtreeFlags&1024)!==0&&_!==null)_.return=m,Ri=_;else for(;Ri!==null;){m=Ri;var S=m.alternate;switch(_=m.flags,m.tag){case 0:break;case 11:case 15:break;case 1:if((_&1024)!==0&&S!==null){_=void 0;var C=m,O=S.memoizedProps;S=S.memoizedState;var $=C.stateNode;try{var K=oh(C.type,O,C.elementType===C.type);_=$.getSnapshotBeforeUpdate(K,S),$.__reactInternalSnapshotBeforeUpdate=_}catch(ct){gn(C,C.return,ct)}}break;case 3:(_&1024)!==0&&lr&&Hut(m.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((_&1024)!==0)throw Error(i(163))}if(_=m.sibling,_!==null){_.return=m.return,Ri=_;break}Ri=m.return}}function XF(m,_,S){var C=S.flags;switch(S.tag){case 0:case 11:case 15:gc(m,S),C&4&&Ry(5,S);break;case 1:if(gc(m,S),C&4)if(m=S.stateNode,_===null)try{m.componentDidMount()}catch(K){gn(S,S.return,K)}else{var O=oh(S.type,_.memoizedProps);_=_.memoizedState;try{m.componentDidUpdate(O,_,m.__reactInternalSnapshotBeforeUpdate)}catch(K){gn(S,S.return,K)}}C&64&&zF(S),C&512&&Oy(S,S.return);break;case 3:if(gc(m,S),C&64&&(m=S.updateQueue,m!==null)){if(_=null,S.child!==null)switch(S.child.tag){case 27:case 5:_=$y(S.child.stateNode);break;case 1:_=S.child.stateNode}try{Bf(m,_)}catch(K){gn(S,S.return,K)}}break;case 27:vi&&_===null&&C&4&&YF(S);case 26:case 5:gc(m,S),_===null&&C&4&&DF(S),C&512&&Oy(S,S.return);break;case 12:gc(m,S);break;case 13:gc(m,S),C&4&&VF(m,S),C&64&&(m=S.memoizedState,m!==null&&(m=m.dehydrated,m!==null&&(S=Jlt.bind(null,S),Kut(m,S))));break;case 22:if(C=S.memoizedState!==null||ma,!C){_=_!==null&&_.memoizedState!==null||pi,O=ma;var $=pi;ma=C,(pi=_)&&!$?xc(m,S,(S.subtreeFlags&8772)!==0):gc(m,S),ma=O,pi=$}break;case 30:break;default:gc(m,S)}}function UF(m){var _=m.alternate;_!==null&&(m.alternate=null,UF(_)),m.child=null,m.deletions=null,m.sibling=null,m.tag===5&&(_=m.stateNode,_!==null&&vut(_)),m.stateNode=null,m.return=null,m.dependencies=null,m.memoizedProps=null,m.memoizedState=null,m.pendingProps=null,m.stateNode=null,m.updateQueue=null}function Vs(m,_,S){for(S=S.child;S!==null;)FT(m,_,S),S=S.sibling}function FT(m,_,S){if(ns&&typeof ns.onCommitFiberUnmount=="function")try{ns.onCommitFiberUnmount(By,S)}catch{}switch(S.tag){case 26:if(Gs){pi||Po(S,_),Vs(m,_,S),S.memoizedState?Uz(S.memoizedState):S.stateNode&&Gz(S.stateNode);break}case 27:if(vi){pi||Po(S,_);var C=mi,O=Or;Jf(S.type)&&(mi=S.stateNode,Or=!1),Vs(m,_,S),qz(S.stateNode),mi=C,Or=O;break}case 5:pi||Po(S,_);case 6:if(lr){if(C=mi,O=Or,mi=null,Vs(m,_,S),mi=C,Or=O,mi!==null)if(Or)try{Yut(mi,S.stateNode)}catch($){gn(S,_,$)}else try{But(mi,S.stateNode)}catch($){gn(S,_,$)}}else Vs(m,_,S);break;case 18:lr&&mi!==null&&(Or?mpt(mi,S.stateNode):fpt(mi,S.stateNode));break;case 4:lr?(C=mi,O=Or,mi=S.stateNode.containerInfo,Or=!0,Vs(m,_,S),mi=C,Or=O):(wc&&BF(S.stateNode,S,Oz()),Vs(m,_,S));break;case 0:case 11:case 14:case 15:pi||yc(2,S,_),pi||yc(4,S,_),Vs(m,_,S);break;case 1:pi||(Po(S,_),C=S.stateNode,typeof C.componentWillUnmount=="function"&&$F(S,_,C)),Vs(m,_,S);break;case 21:Vs(m,_,S);break;case 22:pi=(C=pi)||S.memoizedState!==null,Vs(m,_,S),pi=C;break;default:Vs(m,_,S)}}function VF(m,_){if(_s&&_.memoizedState===null&&(m=_.alternate,m!==null&&(m=m.memoizedState,m!==null&&(m=m.dehydrated,m!==null))))try{dpt(m)}catch(S){gn(_,_.return,S)}}function Glt(m){switch(m.tag){case 13:case 19:var _=m.stateNode;return _===null&&(_=m.stateNode=new o$),_;case 22:return m=m.stateNode,_=m._retryCache,_===null&&(_=m._retryCache=new o$),_;default:throw Error(i(435,m.tag))}}function zT(m,_){var S=Glt(m);_.forEach(function(C){var O=Qlt.bind(null,m,C);S.has(C)||(S.add(C),C.then(O,O))})}function wr(m,_){var S=_.deletions;if(S!==null)for(var C=0;C<S.length;C++){var O=S[C],$=m,K=_;if(lr){var ct=K;t:for(;ct!==null;){switch(ct.tag){case 27:if(vi){if(Jf(ct.type)){mi=ct.stateNode,Or=!1;break t}break}case 5:mi=ct.stateNode,Or=!1;break t;case 3:case 4:mi=ct.stateNode.containerInfo,Or=!0;break t}ct=ct.return}if(mi===null)throw Error(i(160));FT($,K,O),mi=null,Or=!1}else FT($,K,O);$=O.alternate,$!==null&&($.return=null),O.return=null}if(_.subtreeFlags&13878)for(_=_.child;_!==null;)GF(_,m),_=_.sibling}function GF(m,_){var S=m.alternate,C=m.flags;switch(m.tag){case 0:case 11:case 14:case 15:wr(_,m),Rr(m),C&4&&(yc(3,m,m.return),Ry(3,m),yc(5,m,m.return));break;case 1:wr(_,m),Rr(m),C&512&&(pi||S===null||Po(S,S.return)),C&64&&ma&&(m=m.updateQueue,m!==null&&(C=m.callbacks,C!==null&&(S=m.shared.hiddenCallbacks,m.shared.hiddenCallbacks=S===null?C:S.concat(C))));break;case 26:if(Gs){var O=Ws;if(wr(_,m),Rr(m),C&512&&(pi||S===null||Po(S,S.return)),C&4){C=S!==null?S.memoizedState:null;var $=m.memoizedState;S===null?$===null?m.stateNode===null?m.stateNode=gpt(O,m.type,m.memoizedProps,m):Vz(O,m.type,m.stateNode):m.stateNode=Xz(O,$,m.memoizedProps):C!==$?(C===null?S.stateNode!==null&&Gz(S.stateNode):Uz(C),$===null?Vz(O,m.type,m.stateNode):Xz(O,$,m.memoizedProps)):$===null&&m.stateNode!==null&&RT(m,m.memoizedProps,S.memoizedProps)}break}case 27:if(vi){wr(_,m),Rr(m),C&512&&(pi||S===null||Po(S,S.return)),S!==null&&C&4&&RT(m,m.memoizedProps,S.memoizedProps);break}case 5:if(wr(_,m),Rr(m),C&512&&(pi||S===null||Po(S,S.return)),lr){if(m.flags&32){O=m.stateNode;try{Rz(O)}catch($t){gn(m,m.return,$t)}}C&4&&m.stateNode!=null&&(O=m.memoizedProps,RT(m,O,S!==null?S.memoizedProps:O)),C&1024&&(w3=!0)}break;case 6:if(wr(_,m),Rr(m),C&4&&lr){if(m.stateNode===null)throw Error(i(162));C=m.memoizedProps,S=S!==null?S.memoizedProps:C,O=m.stateNode;try{Fut(O,S,C)}catch($t){gn(m,m.return,$t)}}break;case 3:if(Gs?(bpt(),O=Ws,Ws=c3(_.containerInfo),wr(_,m),Ws=O):wr(_,m),Rr(m),C&4){if(lr&&_s&&S!==null&&S.memoizedState.isDehydrated)try{hpt(_.containerInfo)}catch($t){gn(m,m.return,$t)}if(wc){C=_.containerInfo,S=_.pendingChildren;try{Fz(C,S)}catch($t){gn(m,m.return,$t)}}}w3&&(w3=!1,HF(m));break;case 4:Gs?(S=Ws,Ws=c3(m.stateNode.containerInfo),wr(_,m),Rr(m),Ws=S):(wr(_,m),Rr(m)),C&4&&wc&&BF(m.stateNode,m,m.stateNode.pendingChildren);break;case 12:wr(_,m),Rr(m);break;case 13:wr(_,m),Rr(m),m.child.flags&8192&&m.memoizedState!==null!=(S!==null&&S.memoizedState!==null)&&(E3=Hs()),C&4&&(C=m.updateQueue,C!==null&&(m.updateQueue=null,zT(m,C)));break;case 22:O=m.memoizedState!==null;var K=S!==null&&S.memoizedState!==null,ct=ma,xt=pi;if(ma=ct||O,pi=xt||K,wr(_,m),pi=xt,ma=ct,Rr(m),C&8192&&(_=m.stateNode,_._visibility=O?_._visibility&-2:_._visibility|1,O&&(S===null||K||ma||pi||ah(m)),lr)){t:if(S=null,lr)for(_=m;;){if(_.tag===5||Gs&&_.tag===26){if(S===null){K=S=_;try{$=K.stateNode,O?Xut($):Vut(K.stateNode,K.memoizedProps)}catch($t){gn(K,K.return,$t)}}}else if(_.tag===6){if(S===null){K=_;try{var It=K.stateNode;O?Uut(It):Gut(It,K.memoizedProps)}catch($t){gn(K,K.return,$t)}}}else if((_.tag!==22&&_.tag!==23||_.memoizedState===null||_===m)&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===m)break t;for(;_.sibling===null;){if(_.return===null||_.return===m)break t;S===_&&(S=null),_=_.return}S===_&&(S=null),_.sibling.return=_.return,_=_.sibling}}C&4&&(C=m.updateQueue,C!==null&&(S=C.retryQueue,S!==null&&(C.retryQueue=null,zT(m,S))));break;case 19:wr(_,m),Rr(m),C&4&&(C=m.updateQueue,C!==null&&(m.updateQueue=null,zT(m,C)));break;case 30:break;case 21:break;default:wr(_,m),Rr(m)}}function Rr(m){var _=m.flags;if(_&2){try{if(lr){for(var S,C=m.return;C!==null;){if(jF(C)){S=C;break}C=C.return}if(S==null)throw Error(i(160));switch(S.tag){case 27:if(vi){var O=S.stateNode,$=OT(m);J0(m,$,O);break}case 5:var K=S.stateNode;S.flags&32&&(Rz(K),S.flags&=-33);var ct=OT(m);J0(m,ct,K);break;case 3:case 4:var xt=S.stateNode.containerInfo,It=OT(m);LT(m,It,xt);break;default:throw Error(i(161))}}}catch($t){gn(m,m.return,$t)}m.flags&=-3}_&4096&&(m.flags&=-4097)}function HF(m){if(m.subtreeFlags&1024)for(m=m.child;m!==null;){var _=m;HF(_),_.tag===5&&_.flags&1024&&kut(_.stateNode),m=m.sibling}}function gc(m,_){if(_.subtreeFlags&8772)for(_=_.child;_!==null;)XF(m,_.alternate,_),_=_.sibling}function ah(m){for(m=m.child;m!==null;){var _=m;switch(_.tag){case 0:case 11:case 14:case 15:yc(4,_,_.return),ah(_);break;case 1:Po(_,_.return);var S=_.stateNode;typeof S.componentWillUnmount=="function"&&$F(_,_.return,S),ah(_);break;case 27:vi&&qz(_.stateNode);case 26:case 5:Po(_,_.return),ah(_);break;case 22:_.memoizedState===null&&ah(_);break;case 30:ah(_);break;default:ah(_)}m=m.sibling}}function xc(m,_,S){for(S=S&&(_.subtreeFlags&8772)!==0,_=_.child;_!==null;){var C=_.alternate,O=m,$=_,K=$.flags;switch($.tag){case 0:case 11:case 15:xc(O,$,S),Ry(4,$);break;case 1:if(xc(O,$,S),C=$,O=C.stateNode,typeof O.componentDidMount=="function")try{O.componentDidMount()}catch(It){gn(C,C.return,It)}if(C=$,O=C.updateQueue,O!==null){var ct=C.stateNode;try{var xt=O.shared.hiddenCallbacks;if(xt!==null)for(O.shared.hiddenCallbacks=null,O=0;O<xt.length;O++)jf(xt[O],ct)}catch(It){gn(C,C.return,It)}}S&&K&64&&zF($),Oy($,$.return);break;case 27:vi&&YF($);case 26:case 5:xc(O,$,S),S&&C===null&&K&4&&DF($),Oy($,$.return);break;case 12:xc(O,$,S);break;case 13:xc(O,$,S),S&&K&4&&VF(O,$);break;case 22:$.memoizedState===null&&xc(O,$,S),Oy($,$.return);break;case 30:break;default:xc(O,$,S)}_=_.sibling}}function $T(m,_){var S=null;m!==null&&m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(S=m.memoizedState.cachePool.pool),m=null,_.memoizedState!==null&&_.memoizedState.cachePool!==null&&(m=_.memoizedState.cachePool.pool),m!==S&&(m!=null&&m.refCount++,S!=null&&Xs(S))}function DT(m,_){m=null,_.alternate!==null&&(m=_.alternate.memoizedState.cache),_=_.memoizedState.cache,_!==m&&(_.refCount++,m!=null&&Xs(m))}function ko(m,_,S,C){if(_.subtreeFlags&10256)for(_=_.child;_!==null;)WF(m,_,S,C),_=_.sibling}function WF(m,_,S,C){var O=_.flags;switch(_.tag){case 0:case 11:case 15:ko(m,_,S,C),O&2048&&Ry(9,_);break;case 1:ko(m,_,S,C);break;case 3:ko(m,_,S,C),O&2048&&(m=null,_.alternate!==null&&(m=_.alternate.memoizedState.cache),_=_.memoizedState.cache,_!==m&&(_.refCount++,m!=null&&Xs(m)));break;case 12:if(O&2048){ko(m,_,S,C),m=_.stateNode;try{var $=_.memoizedProps,K=$.id,ct=$.onPostCommit;typeof ct=="function"&&ct(K,_.alternate===null?"mount":"update",m.passiveEffectDuration,-0)}catch(xt){gn(_,_.return,xt)}}else ko(m,_,S,C);break;case 13:ko(m,_,S,C);break;case 23:break;case 22:$=_.stateNode,K=_.alternate,_.memoizedState!==null?$._visibility&2?ko(m,_,S,C):Ly(m,_):$._visibility&2?ko(m,_,S,C):($._visibility|=2,Gf(m,_,S,C,(_.subtreeFlags&10256)!==0)),O&2048&&$T(K,_);break;case 24:ko(m,_,S,C),O&2048&&DT(_.alternate,_);break;default:ko(m,_,S,C)}}function Gf(m,_,S,C,O){for(O=O&&(_.subtreeFlags&10256)!==0,_=_.child;_!==null;){var $=m,K=_,ct=S,xt=C,It=K.flags;switch(K.tag){case 0:case 11:case 15:Gf($,K,ct,xt,O),Ry(8,K);break;case 23:break;case 22:var $t=K.stateNode;K.memoizedState!==null?$t._visibility&2?Gf($,K,ct,xt,O):Ly($,K):($t._visibility|=2,Gf($,K,ct,xt,O)),O&&It&2048&&$T(K.alternate,K);break;case 24:Gf($,K,ct,xt,O),O&&It&2048&&DT(K.alternate,K);break;default:Gf($,K,ct,xt,O)}_=_.sibling}}function Ly(m,_){if(_.subtreeFlags&10256)for(_=_.child;_!==null;){var S=m,C=_,O=C.flags;switch(C.tag){case 22:Ly(S,C),O&2048&&$T(C.alternate,C);break;case 24:Ly(S,C),O&2048&&DT(C.alternate,C);break;default:Ly(S,C)}_=_.sibling}}function ch(m){if(m.subtreeFlags&fm)for(m=m.child;m!==null;)qF(m),m=m.sibling}function qF(m){switch(m.tag){case 26:ch(m),m.flags&fm&&(m.memoizedState!==null?Spt(Ws,m.memoizedState,m.memoizedProps):Az(m.type,m.memoizedProps));break;case 5:ch(m),m.flags&fm&&Az(m.type,m.memoizedProps);break;case 3:case 4:if(Gs){var _=Ws;Ws=c3(m.stateNode.containerInfo),ch(m),Ws=_}else ch(m);break;case 22:m.memoizedState===null&&(_=m.alternate,_!==null&&_.memoizedState!==null?(_=fm,fm=16777216,ch(m),fm=_):ch(m));break;default:ch(m)}}function ZF(m){var _=m.alternate;if(_!==null&&(m=_.child,m!==null)){_.child=null;do _=m.sibling,m.sibling=null,m=_;while(m!==null)}}function Fy(m){var _=m.deletions;if((m.flags&16)!==0){if(_!==null)for(var S=0;S<_.length;S++){var C=_[S];Ri=C,JF(C,m)}ZF(m)}if(m.subtreeFlags&10256)for(m=m.child;m!==null;)KF(m),m=m.sibling}function KF(m){switch(m.tag){case 0:case 11:case 15:Fy(m),m.flags&2048&&yc(9,m,m.return);break;case 3:Fy(m);break;case 12:Fy(m);break;case 22:var _=m.stateNode;m.memoizedState!==null&&_._visibility&2&&(m.return===null||m.return.tag!==13)?(_._visibility&=-3,Q0(m)):Fy(m);break;default:Fy(m)}}function Q0(m){var _=m.deletions;if((m.flags&16)!==0){if(_!==null)for(var S=0;S<_.length;S++){var C=_[S];Ri=C,JF(C,m)}ZF(m)}for(m=m.child;m!==null;){switch(_=m,_.tag){case 0:case 11:case 15:yc(8,_,_.return),Q0(_);break;case 22:S=_.stateNode,S._visibility&2&&(S._visibility&=-3,Q0(_));break;default:Q0(_)}m=m.sibling}}function JF(m,_){for(;Ri!==null;){var S=Ri;switch(S.tag){case 0:case 11:case 15:yc(8,S,_);break;case 23:case 22:if(S.memoizedState!==null&&S.memoizedState.cachePool!==null){var C=S.memoizedState.cachePool.pool;C!=null&&C.refCount++}break;case 24:Xs(S.memoizedState.cache)}if(C=S.child,C!==null)C.return=S,Ri=C;else t:for(S=m;Ri!==null;){C=Ri;var O=C.sibling,$=C.return;if(UF(C),C===S){Ri=null;break t}if(O!==null){O.return=$,Ri=O;break t}Ri=$}}}function jT(m){var _=yut(m);if(_!=null){if(typeof _.memoizedProps["data-testname"]!="string")throw Error(i(364));return _}if(m=Mut(m),m===null)throw Error(i(362));return m.stateNode.current}function BT(m,_){var S=m.tag;switch(_.$$typeof){case bx:if(m.type===_.value)return!0;break;case vx:t:{for(_=_.value,m=[m,0],S=0;S<m.length;){var C=m[S++],O=C.tag,$=m[S++],K=_[$];if(O!==5&&O!==26&&O!==27||!jy(C)){for(;K!=null&&BT(C,K);)$++,K=_[$];if($===_.length){_=!0;break t}else for(C=C.child;C!==null;)m.push(C,$),C=C.sibling}}_=!1}return _;case Sx:if((S===5||S===26||S===27)&&Nut(m.stateNode,_.value))return!0;break;case Px:if((S===5||S===6||S===26||S===27)&&(m=Iut(m),m!==null&&0<=m.indexOf(_.value)))return!0;break;case wx:if((S===5||S===26||S===27)&&(m=m.memoizedProps["data-testname"],typeof m=="string"&&m.toLowerCase()===_.value.toLowerCase()))return!0;break;default:throw Error(i(365))}return!1}function YT(m){switch(m.$$typeof){case bx:return"<"+(u(m.value)||"Unknown")+">";case vx:return":has("+(YT(m)||"")+")";case Sx:return'[role="'+m.value+'"]';case Px:return'"'+m.value+'"';case wx:return'[data-testname="'+m.value+'"]';default:throw Error(i(365))}}function QF(m,_){var S=[];m=[m,0];for(var C=0;C<m.length;){var O=m[C++],$=O.tag,K=m[C++],ct=_[K];if($!==5&&$!==26&&$!==27||!jy(O)){for(;ct!=null&&BT(O,ct);)K++,ct=_[K];if(K===_.length)S.push(O);else for(O=O.child;O!==null;)m.push(O,K),O=O.sibling}}return S}function XT(m,_){if(!Dy)throw Error(i(363));m=jT(m),m=QF(m,_),_=[],m=Array.from(m);for(var S=0;S<m.length;){var C=m[S++],O=C.tag;if(O===5||O===26||O===27)jy(C)||_.push(C.stateNode);else for(C=C.child;C!==null;)m.push(C),C=C.sibling}return _}function Jr(){if((Qe&2)!==0&&tn!==0)return tn&-tn;if(_e.T!==null){var m=sm;return m!==0?m:qp()}return xut()}function tz(){vs===0&&(vs=(tn&536870912)===0||mn?k():536870912);var m=bs.current;return m!==null&&(m.flags|=32),vs}function Qr(m,_,S){(m===An&&(xn===2||xn===9)||m.cancelPendingCommit!==null)&&(Hf(m,0),bc(m,tn,vs,!1)),E(m,S),((Qe&2)===0||m!==An)&&(m===An&&((Qe&2)===0&&(yh|=S),ii===4&&bc(m,tn,vs,!1)),Ar(m))}function ez(m,_,S){if((Qe&6)!==0)throw Error(i(327));var C=!S&&(_&124)===0&&(_&m.expiredLanes)===0||P(m,_),O=C?qlt(m,_):GT(m,_,!0),$=C;do{if(O===0){mm&&!C&&bc(m,_,0,!1);break}else{if(S=m.current.alternate,$&&!Hlt(S)){O=GT(m,_,!1),$=!1;continue}if(O===2){if($=_,m.errorRecoveryDisabledLanes&$)var K=0;else K=m.pendingLanes&-536870913,K=K!==0?K:K&536870912?536870912:0;if(K!==0){_=K;t:{var ct=m;O=Wy;var xt=_s&&ct.current.memoizedState.isDehydrated;if(xt&&(Hf(ct,K).flags|=256),K=GT(ct,K,!1),K!==2){if(P3&&!xt){ct.errorRecoveryDisabledLanes|=$,yh|=$,O=4;break t}$=Lr,Lr=O,$!==null&&(Lr===null?Lr=$:Lr.push.apply(Lr,$))}O=K}if($=!1,O!==2)continue}}if(O===1){Hf(m,0),bc(m,_,0,!0);break}t:{switch(C=m,$=O,$){case 0:case 1:throw Error(i(345));case 4:if((_&4194048)!==_)break;case 6:bc(C,_,vs,!Ec);break t;case 2:Lr=null;break;case 3:case 5:break;default:throw Error(i(329))}if((_&62914560)===_&&(O=E3+300-Hs(),10<O)){if(bc(C,_,vs,!Ec),v(C,0,!0)!==0)break t;C.timeoutHandle=mut(nz.bind(null,C,S,Lr,kx,T3,_,vs,yh,_m,Ec,$,2,-0,0),O);break t}nz(C,S,Lr,kx,T3,_,vs,yh,_m,Ec,$,0,-0,0)}}break}while(!0);Ar(m)}function nz(m,_,S,C,O,$,K,ct,xt,It,$t,Xt,Wt,Le){if(m.timeoutHandle=uh,Xt=_.subtreeFlags,(Xt&8192||(Xt&16785408)===16785408)&&(wut(),qF(_),Xt=Put(),Xt!==null)){m.cancelPendingCommit=Xt(pz.bind(null,m,_,$,S,C,O,K,ct,xt,$t,1,Wt,Le)),bc(m,$,K,!It);return}pz(m,_,$,S,C,O,K,ct,xt)}function Hlt(m){for(var _=m;;){var S=_.tag;if((S===0||S===11||S===15)&&_.flags&16384&&(S=_.updateQueue,S!==null&&(S=S.stores,S!==null)))for(var C=0;C<S.length;C++){var O=S[C],$=O.getSnapshot;O=O.value;try{if(!is($(),O))return!1}catch{return!1}}if(S=_.child,_.subtreeFlags&16384&&S!==null)S.return=_,_=S;else{if(_===m)break;for(;_.sibling===null;){if(_.return===null||_.return===m)return!0;_=_.return}_.sibling.return=_.return,_=_.sibling}}return!0}function bc(m,_,S,C){_&=~k3,_&=~yh,m.suspendedLanes|=_,m.pingedLanes&=~_,C&&(m.warmLanes|=_),C=m.expirationTimes;for(var O=_;0<O;){var $=31-es(O),K=1<<$;C[$]=-1,O&=~K}S!==0&&M(m,S,_)}function iz(){return(Qe&6)===0?(So(0,!1),!1):!0}function UT(){if(Ue!==null){if(xn===0)var m=Ue.return;else m=Ue,fa=fh=null,Py(m),hm=null,Gy=0,m=Ue;for(;m!==null;)FF(m.alternate,m),m=m.return;Ue=null}}function Hf(m,_){var S=m.timeoutHandle;S!==uh&&(m.timeoutHandle=uh,_ut(S)),S=m.cancelPendingCommit,S!==null&&(m.cancelPendingCommit=null,S()),UT(),An=m,Ue=S=la(m.current,null),tn=_,xn=0,rs=null,Ec=!1,mm=P(m,_),P3=!1,_m=vs=k3=yh=Mc=ii=0,Lr=Wy=null,T3=!1,(_&8)!==0&&(_|=_&32);var C=m.entangledLanes;if(C!==0)for(m=m.entanglements,C&=_;0<C;){var O=31-es(C),$=1<<O;_|=m[O],C&=~$}return _a=_,hc(),S}function rz(m,_){De=null,_e.H=xx,_===Uy||_===fx?(_=zf(),xn=3):_===g3?(_=zf(),xn=4):xn=_===s$?8:_!==null&&typeof _=="object"&&typeof _.then=="function"?6:1,rs=_,Ue===null&&(ii=1,W0(m,et(_,m.current)))}function sz(){var m=bs.current;return m===null?!0:(tn&4194048)===tn?Eo===null:(tn&62914560)===tn||(tn&536870912)!==0?m===Eo:!1}function oz(){var m=_e.H;return _e.H=xx,m===null?xx:m}function az(){var m=_e.A;return _e.A=$pt,m}function VT(){ii=4,Ec||(tn&4194048)!==tn&&bs.current!==null||(mm=!0),(Mc&134217727)===0&&(yh&134217727)===0||An===null||bc(An,tn,vs,!1)}function GT(m,_,S){var C=Qe;Qe|=2;var O=oz(),$=az();(An!==m||tn!==_)&&(kx=null,Hf(m,_)),_=!1;var K=ii;t:do try{if(xn!==0&&Ue!==null){var ct=Ue,xt=rs;switch(xn){case 8:UT(),K=6;break t;case 3:case 2:case 9:case 6:bs.current===null&&(_=!0);var It=xn;if(xn=0,rs=null,Wf(m,ct,xt,It),S&&mm){K=0;break t}break;default:It=xn,xn=0,rs=null,Wf(m,ct,xt,It)}}Wlt(),K=ii;break}catch($t){rz(m,$t)}while(!0);return _&&m.shellSuspendCounter++,fa=fh=null,Qe=C,_e.H=O,_e.A=$,Ue===null&&(An=null,tn=0,hc()),K}function Wlt(){for(;Ue!==null;)cz(Ue)}function qlt(m,_){var S=Qe;Qe|=2;var C=oz(),O=az();An!==m||tn!==_?(kx=null,qy=Hs()+500,Hf(m,_)):mm=P(m,_);t:do try{if(xn!==0&&Ue!==null){_=Ue;var $=rs;e:switch(xn){case 1:xn=0,rs=null,Wf(m,_,$,1);break;case 2:case 9:if(Lf($)){xn=0,rs=null,lz(_);break}_=function(){xn!==2&&xn!==9||An!==m||(xn=7),Ar(m)},$.then(_,_);break t;case 3:xn=7;break t;case 4:xn=5;break t;case 7:Lf($)?(xn=0,rs=null,lz(_)):(xn=0,rs=null,Wf(m,_,$,7));break;case 5:var K=null;switch(Ue.tag){case 26:K=Ue.memoizedState;case 5:case 27:var ct=Ue,xt=ct.type,It=ct.pendingProps;if(K?Hz(K):Nz(xt,It)){xn=0,rs=null;var $t=ct.sibling;if($t!==null)Ue=$t;else{var Xt=ct.return;Xt!==null?(Ue=Xt,tx(Xt)):Ue=null}break e}}xn=0,rs=null,Wf(m,_,$,5);break;case 6:xn=0,rs=null,Wf(m,_,$,6);break;case 8:UT(),ii=6;break t;default:throw Error(i(462))}}Zlt();break}catch(Wt){rz(m,Wt)}while(!0);return fa=fh=null,_e.H=C,_e.A=O,Qe=S,Ue!==null?0:(An=null,tn=0,hc(),ii)}function Zlt(){for(;Ue!==null&&!Tpt();)cz(Ue)}function cz(m){var _=NF(m.alternate,m,_a);m.memoizedProps=m.pendingProps,_===null?tx(m):Ue=_}function lz(m){var _=m,S=_.alternate;switch(_.tag){case 15:case 0:_=kF(S,_,_.pendingProps,_.type,void 0,tn);break;case 11:_=kF(S,_,_.pendingProps,_.type.render,_.ref,tn);break;case 5:Py(_);default:FF(S,_),_=Ue=xz(_,_a),_=NF(S,_,_a)}m.memoizedProps=m.pendingProps,_===null?tx(m):Ue=_}function Wf(m,_,S,C){fa=fh=null,Py(_),hm=null,Gy=0;var O=_.return;try{if(Blt(m,O,_,S,tn)){ii=1,W0(m,et(S,m.current)),Ue=null;return}}catch($){if(O!==null)throw Ue=O,$;ii=1,W0(m,et(S,m.current)),Ue=null;return}_.flags&32768?(mn||C===1?m=!0:mm||(tn&536870912)!==0?m=!1:(Ec=m=!0,(C===2||C===9||C===3||C===6)&&(C=bs.current,C!==null&&C.tag===13&&(C.flags|=16384))),uz(_,m)):tx(_)}function tx(m){var _=m;do{if((_.flags&32768)!==0){uz(_,Ec);return}m=_.return;var S=Xlt(_.alternate,_,_a);if(S!==null){Ue=S;return}if(_=_.sibling,_!==null){Ue=_;return}Ue=_=m}while(_!==null);ii===0&&(ii=5)}function uz(m,_){do{var S=Ult(m.alternate,m);if(S!==null){S.flags&=32767,Ue=S;return}if(S=m.return,S!==null&&(S.flags|=32768,S.subtreeFlags=0,S.deletions=null),!_&&(m=m.sibling,m!==null)){Ue=m;return}Ue=m=S}while(m!==null);ii=6,Ue=null}function pz(m,_,S,C,O,$,K,ct,xt){m.cancelPendingCommit=null;do zy();while(Ki!==0);if((Qe&6)!==0)throw Error(i(327));if(_!==null){if(_===m.current)throw Error(i(177));if($=_.lanes|_.childLanes,$|=x3,N(m,S,$,K,ct,xt),m===An&&(Ue=An=null,tn=0),ym=_,Ic=m,gm=S,M3=$,C3=O,a$=C,(_.subtreeFlags&10256)!==0||(_.flags&10256)!==0?(m.callbackNode=null,m.callbackPriority=0,tut(p3,function(){return _z(!0),null})):(m.callbackNode=null,m.callbackPriority=0),C=(_.flags&13878)!==0,(_.subtreeFlags&13878)!==0||C){C=_e.T,_e.T=null,O=pa(),Ni(2),K=Qe,Qe|=4;try{Vlt(m,_,S)}finally{Qe=K,Ni(O),_e.T=C}}Ki=1,hz(),dz(),fz()}}function hz(){if(Ki===1){Ki=0;var m=Ic,_=ym,S=(_.flags&13878)!==0;if((_.subtreeFlags&13878)!==0||S){S=_e.T,_e.T=null;var C=pa();Ni(2);var O=Qe;Qe|=4;try{GF(_,m),dut(m.containerInfo)}finally{Qe=O,Ni(C),_e.T=S}}m.current=_,Ki=2}}function dz(){if(Ki===2){Ki=0;var m=Ic,_=ym,S=(_.flags&8772)!==0;if((_.subtreeFlags&8772)!==0||S){S=_e.T,_e.T=null;var C=pa();Ni(2);var O=Qe;Qe|=4;try{XF(m,_.alternate,_)}finally{Qe=O,Ni(C),_e.T=S}}Ki=3}}function fz(){if(Ki===4||Ki===3){Ki=0,Ept();var m=Ic,_=ym,S=gm,C=a$;(_.subtreeFlags&10256)!==0||(_.flags&10256)!==0?Ki=5:(Ki=0,ym=Ic=null,mz(m,m.pendingLanes));var O=m.pendingLanes;if(O===0&&(Cc=null),j(S),_=_.stateNode,ns&&typeof ns.onCommitFiberRoot=="function")try{ns.onCommitFiberRoot(By,_,void 0,(_.current.flags&128)===128)}catch{}if(C!==null){_=_e.T,O=pa(),Ni(2),_e.T=null;try{for(var $=m.onRecoverableError,K=0;K<C.length;K++){var ct=C[K];$(ct.value,{componentStack:ct.stack})}}finally{_e.T=_,Ni(O)}}(gm&3)!==0&&zy(),Ar(m),O=m.pendingLanes,(S&4194090)!==0&&(O&42)!==0?m===I3?Zy++:(Zy=0,I3=m):Zy=0,So(0,!1)}}function mz(m,_){(m.pooledCacheLanes&=_)===0&&(_=m.pooledCache,_!=null&&(m.pooledCache=null,Xs(_)))}function zy(m){return hz(),dz(),fz(),_z(m)}function _z(){if(Ki!==5)return!1;var m=Ic,_=M3;M3=0;var S=j(gm),C=32>S?32:S;S=_e.T;var O=pa();try{Ni(C),_e.T=null,C=C3,C3=null;var $=Ic,K=gm;if(Ki=0,ym=Ic=null,gm=0,(Qe&6)!==0)throw Error(i(331));var ct=Qe;if(Qe|=4,KF($.current),WF($,$.current,K,C),Qe=ct,So(0,!1),ns&&typeof ns.onPostCommitFiberRoot=="function")try{ns.onPostCommitFiberRoot(By,$)}catch{}return!0}finally{Ni(O),_e.T=S,mz(m,_)}}function yz(m,_,S){_=et(S,_),_=ST(m.stateNode,_,2),m=ms(m,_,2),m!==null&&(E(m,2),Ar(m))}function gn(m,_,S){if(m.tag===3)yz(m,m,S);else for(;_!==null;){if(_.tag===3){yz(_,m,S);break}else if(_.tag===1){var C=_.stateNode;if(typeof _.type.getDerivedStateFromError=="function"||typeof C.componentDidCatch=="function"&&(Cc===null||!Cc.has(C))){m=et(S,m),S=gF(2),C=ms(_,S,2),C!==null&&(xF(S,C,_,m),E(C,2),Ar(C));break}}_=_.return}}function HT(m,_,S){var C=m.pingCache;if(C===null){C=m.pingCache=new Dpt;var O=new Set;C.set(_,O)}else O=C.get(_),O===void 0&&(O=new Set,C.set(_,O));O.has(S)||(P3=!0,O.add(S),m=Klt.bind(null,m,_,S),_.then(m,m))}function Klt(m,_,S){var C=m.pingCache;C!==null&&C.delete(_),m.pingedLanes|=m.suspendedLanes&S,m.warmLanes&=~S,An===m&&(tn&S)===S&&(ii===4||ii===3&&(tn&62914560)===tn&&300>Hs()-E3?(Qe&2)===0&&Hf(m,0):k3|=S,_m===tn&&(_m=0)),Ar(m)}function gz(m,_){_===0&&(_=T()),m=wo(m,_),m!==null&&(E(m,_),Ar(m))}function Jlt(m){var _=m.memoizedState,S=0;_!==null&&(S=_.retryLane),gz(m,S)}function Qlt(m,_){var S=0;switch(m.tag){case 13:var C=m.stateNode,O=m.memoizedState;O!==null&&(S=O.retryLane);break;case 19:C=m.stateNode;break;case 22:C=m.stateNode._retryCache;break;default:throw Error(i(314))}C!==null&&C.delete(_),gz(m,S)}function tut(m,_){return ax(m,_)}function eut(m,_,S,C){this.tag=m,this.key=S,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=_,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=C,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function WT(m){return m=m.prototype,!(!m||!m.isReactComponent)}function la(m,_){var S=m.alternate;return S===null?(S=e(m.tag,_,m.key,m.mode),S.elementType=m.elementType,S.type=m.type,S.stateNode=m.stateNode,S.alternate=m,m.alternate=S):(S.pendingProps=_,S.type=m.type,S.flags=0,S.subtreeFlags=0,S.deletions=null),S.flags=m.flags&65011712,S.childLanes=m.childLanes,S.lanes=m.lanes,S.child=m.child,S.memoizedProps=m.memoizedProps,S.memoizedState=m.memoizedState,S.updateQueue=m.updateQueue,_=m.dependencies,S.dependencies=_===null?null:{lanes:_.lanes,firstContext:_.firstContext},S.sibling=m.sibling,S.index=m.index,S.ref=m.ref,S.refCleanup=m.refCleanup,S}function xz(m,_){m.flags&=65011714;var S=m.alternate;return S===null?(m.childLanes=0,m.lanes=_,m.child=null,m.subtreeFlags=0,m.memoizedProps=null,m.memoizedState=null,m.updateQueue=null,m.dependencies=null,m.stateNode=null):(m.childLanes=S.childLanes,m.lanes=S.lanes,m.child=S.child,m.subtreeFlags=0,m.deletions=null,m.memoizedProps=S.memoizedProps,m.memoizedState=S.memoizedState,m.updateQueue=S.updateQueue,m.type=S.type,_=S.dependencies,m.dependencies=_===null?null:{lanes:_.lanes,firstContext:_.firstContext}),m}function ex(m,_,S,C,O,$){var K=0;if(C=m,typeof m=="function")WT(m)&&(K=1);else if(typeof m=="string")K=Gs&&vi?Bz(m,S,Zi.current)?26:Zz(m)?27:5:Gs?Bz(m,S,Zi.current)?26:5:vi&&Zz(m)?27:5;else t:switch(m){case r3:return m=e(31,S,_,O),m.elementType=r3,m.lanes=$,m;case Zf:return lh(S.children,O,$,_);case kz:K=8,O|=24;break;case QT:return m=e(12,S,_,O|2),m.elementType=QT,m.lanes=$,m;case e3:return m=e(13,S,_,O),m.elementType=e3,m.lanes=$,m;case n3:return m=e(19,S,_,O),m.elementType=n3,m.lanes=$,m;default:if(typeof m=="object"&&m!==null)switch(m.$$typeof){case sut:case vc:K=10;break t;case Tz:K=9;break t;case t3:K=11;break t;case i3:K=14;break t;case Sc:K=16,C=null;break t}K=29,S=Error(i(130,m===null?"null":typeof m,"")),C=null}return _=e(K,S,_,O),_.elementType=m,_.type=C,_.lanes=$,_}function lh(m,_,S,C){return m=e(7,m,C,_),m.lanes=S,m}function qT(m,_,S){return m=e(6,m,null,_),m.lanes=S,m}function ZT(m,_,S){return _=e(4,m.children!==null?m.children:[],m.key,_),_.lanes=S,_.stateNode={containerInfo:m.containerInfo,pendingChildren:null,implementation:m.implementation},_}function nut(m,_,S,C,O,$,K,ct){this.tag=1,this.containerInfo=m,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=uh,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=I(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=I(0),this.hiddenUpdates=I(null),this.identifierPrefix=C,this.onUncaughtError=O,this.onCaughtError=$,this.onRecoverableError=K,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ct,this.incompleteTransitions=new Map}function bz(m,_,S,C,O,$,K,ct,xt,It,$t,Xt){return m=new nut(m,_,S,K,ct,xt,It,Xt),_=1,$===!0&&(_|=24),$=e(3,null,null,_),m.current=$,$.stateNode=m,_=Nr(),_.refCount++,m.pooledCache=_,_.refCount++,$.memoizedState={element:C,isDehydrated:S,cache:_},Jp($),m}function vz(m){return m?(m=tm,m):tm}function Sz(m){var _=m._reactInternals;if(_===void 0)throw typeof m.render=="function"?Error(i(188)):(m=Object.keys(m).join(","),Error(i(268,m)));return m=o(_),m=m!==null?a(m):null,m===null?null:$y(m.stateNode)}function wz(m,_,S,C,O,$){O=vz(O),C.context===null?C.context=O:C.pendingContext=O,C=fs(_),C.payload={element:S},$=$===void 0?null:$,$!==null&&(C.callback=$),S=ms(m,C,_),S!==null&&(Qr(S,m,_),ra(S,m,_))}function Pz(m,_){if(m=m.memoizedState,m!==null&&m.dehydrated!==null){var S=m.retryLane;m.retryLane=S!==0&&S<_?S:_}}function KT(m,_){Pz(m,_),(m=m.alternate)&&Pz(m,_)}var Xe={},iut=qs(),ts=XB(),JT=Object.assign,rut=Symbol.for("react.element"),nx=Symbol.for("react.transitional.element"),qf=Symbol.for("react.portal"),Zf=Symbol.for("react.fragment"),kz=Symbol.for("react.strict_mode"),QT=Symbol.for("react.profiler"),sut=Symbol.for("react.provider"),Tz=Symbol.for("react.consumer"),vc=Symbol.for("react.context"),t3=Symbol.for("react.forward_ref"),e3=Symbol.for("react.suspense"),n3=Symbol.for("react.suspense_list"),i3=Symbol.for("react.memo"),Sc=Symbol.for("react.lazy");Symbol.for("react.scope");var r3=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var out=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var Ez=Symbol.iterator,aut=Symbol.for("react.client.reference"),ix=Array.isArray,_e=iut.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,cut=n.rendererVersion,lut=n.rendererPackageName,Mz=n.extraDevToolsConfig,$y=n.getPublicInstance,uut=n.getRootHostContext,put=n.getChildHostContext,hut=n.prepareForCommit,dut=n.resetAfterCommit,fut=n.createInstance;n.cloneMutableInstance;var s3=n.appendInitialChild,Cz=n.finalizeInitialChildren,rx=n.shouldSetTextContent,Iz=n.createTextInstance;n.cloneMutableTextInstance;var mut=n.scheduleTimeout,_ut=n.cancelTimeout,uh=n.noTimeout,ua=n.isPrimaryRenderer;n.warnsIfNotActing;var lr=n.supportsMutation,wc=n.supportsPersistence,_s=n.supportsHydration,yut=n.getInstanceFromNode;n.beforeActiveInstanceBlur;var gut=n.preparePortalMount;n.prepareScopeUpdate,n.getInstanceFromScope;var Ni=n.setCurrentUpdatePriority,pa=n.getCurrentUpdatePriority,xut=n.resolveUpdatePriority;n.trackSchedulerEvent,n.resolveEventType,n.resolveEventTimeStamp;var but=n.shouldAttemptEagerTransition,vut=n.detachDeletedInstance;n.requestPostPaintCallback;var Sut=n.maySuspendCommit,Nz=n.preloadInstance,wut=n.startSuspendingCommit,Az=n.suspendInstance;n.suspendOnActiveViewTransition;var Put=n.waitForCommitToBeReady,Kf=n.NotPendingTransition,ph=n.HostTransitionContext,kut=n.resetFormInstance;n.bindToConsole;var Tut=n.supportsMicrotasks,Eut=n.scheduleMicrotask,Dy=n.supportsTestSelectors,Mut=n.findFiberRoot,Cut=n.getBoundingRect,Iut=n.getTextContent,jy=n.isHiddenSubtree,Nut=n.matchAccessibilityRole,Aut=n.setFocusIfFocusable,Rut=n.setupIntersectionObserver,Out=n.appendChild,Lut=n.appendChildToContainer,Fut=n.commitTextUpdate,zut=n.commitMount,$ut=n.commitUpdate,Dut=n.insertBefore,jut=n.insertInContainerBefore,But=n.removeChild,Yut=n.removeChildFromContainer,Rz=n.resetTextContent,Xut=n.hideInstance,Uut=n.hideTextInstance,Vut=n.unhideInstance,Gut=n.unhideTextInstance;n.cancelViewTransitionName,n.cancelRootViewTransitionName,n.restoreRootViewTransitionName,n.cloneRootViewTransitionContainer,n.removeRootViewTransitionClone,n.measureClonedInstance,n.hasInstanceChanged,n.hasInstanceAffectedParent,n.startViewTransition,n.startGestureTransition,n.stopGestureTransition,n.getCurrentGestureOffset,n.subscribeToGestureDirection,n.createViewTransitionInstance;var Hut=n.clearContainer;n.createFragmentInstance,n.updateFragmentInstanceFiber,n.commitNewChildToFragmentInstance,n.deleteChildFromFragmentInstance;var Wut=n.cloneInstance,Oz=n.createContainerChildSet,Lz=n.appendChildToContainerChildSet,qut=n.finalizeContainerChildren,Fz=n.replaceContainerChildren,zz=n.cloneHiddenInstance,$z=n.cloneHiddenTextInstance,o3=n.isSuspenseInstancePending,a3=n.isSuspenseInstanceFallback,Zut=n.getSuspenseInstanceFallbackErrorDetails,Kut=n.registerSuspenseInstanceRetry,Jut=n.canHydrateFormStateMarker,Qut=n.isFormStateMarkerMatching,Dz=n.getNextHydratableSibling,tpt=n.getNextHydratableSiblingAfterSingleton,ept=n.getFirstHydratableChild,npt=n.getFirstHydratableChildWithinContainer,ipt=n.getFirstHydratableChildWithinSuspenseInstance,rpt=n.getFirstHydratableChildWithinSingleton,spt=n.canHydrateInstance,opt=n.canHydrateTextInstance,apt=n.canHydrateSuspenseInstance,cpt=n.hydrateInstance,lpt=n.hydrateTextInstance,upt=n.hydrateSuspenseInstance,ppt=n.getNextHydratableInstanceAfterSuspenseInstance,hpt=n.commitHydratedContainer,dpt=n.commitHydratedSuspenseInstance,fpt=n.clearSuspenseBoundary,mpt=n.clearSuspenseBoundaryFromContainer,jz=n.shouldDeleteUnhydratedTailInstances;n.diffHydratedPropsForDevWarnings,n.diffHydratedTextForDevWarnings,n.describeHydratableInstanceForDevWarnings;var _pt=n.validateHydratableInstance,ypt=n.validateHydratableTextInstance,Gs=n.supportsResources,Bz=n.isHostHoistableType,c3=n.getHoistableRoot,Yz=n.getResource,Xz=n.acquireResource,Uz=n.releaseResource,gpt=n.hydrateHoistable,Vz=n.mountHoistable,Gz=n.unmountHoistable,xpt=n.createHoistableInstance,bpt=n.prepareToCommitHoistables,vpt=n.mayResourceSuspendCommit,Hz=n.preloadResource,Spt=n.suspendResource,vi=n.supportsSingletons,Wz=n.resolveSingletonInstance,wpt=n.acquireSingletonInstance,qz=n.releaseSingletonInstance,Zz=n.isHostSingletonType,Jf=n.isSingletonScope,l3=[],Qf=-1,tm={},es=Math.clz32?Math.clz32:g,Ppt=Math.log,kpt=Math.LN2,sx=256,ox=4194304,ax=ts.unstable_scheduleCallback,u3=ts.unstable_cancelCallback,Tpt=ts.unstable_shouldYield,Ept=ts.unstable_requestPaint,Hs=ts.unstable_now,Kz=ts.unstable_ImmediatePriority,Mpt=ts.unstable_UserBlockingPriority,p3=ts.unstable_NormalPriority,Cpt=ts.unstable_IdlePriority,Ipt=ts.log,Npt=ts.unstable_setDisableYieldValue,By=null,ns=null,h3,Jz,d3=!1,Qz=new WeakMap,em=[],nm=0,cx=null,lx=0,ys=[],gs=0,hh=null,ha=1,da="",Zi=p(null),Yy=p(null),Pc=p(null),ux=p(null),Pr=null,Si=null,mn=!1,dh=null,To=!1,f3=Error(i(519)),is=typeof Object.is=="function"?Object.is:at,px=p(null),fh=null,fa=null,Apt=typeof AbortController<"u"?AbortController:function(){var m=[],_=this.signal={aborted:!1,addEventListener:function(S,C){m.push(C)}};this.abort=function(){_.aborted=!0,m.forEach(function(S){return S()})}},Rpt=ts.unstable_scheduleCallback,Opt=ts.unstable_NormalPriority,ni={$$typeof:vc,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},hx=null,im=null,m3=!1,dx=!1,_3=!1,rm=0,Xy=null,y3=0,sm=0,om=null,t$=_e.S;_e.S=function(m,_){typeof _=="object"&&_!==null&&typeof _.then=="function"&&by(m,_),t$!==null&&t$(m,_)};var mh=p(null),Lpt=Object.prototype.hasOwnProperty,Uy=Error(i(460)),g3=Error(i(474)),fx=Error(i(542)),mx={then:function(){}},am=null,xs=[],cm=0,x3=0,kc=!1,b3=!1,lm=p(null),_x=p(0),Tc=0,De=null,wn=null,fi=null,yx=!1,um=!1,_h=!1,gx=0,Vy=0,pm=null,Fpt=0,xx={readContext:Jt,use:Xf,useCallback:Fn,useContext:Fn,useEffect:Fn,useImperativeHandle:Fn,useLayoutEffect:Fn,useInsertionEffect:Fn,useMemo:Fn,useReducer:Fn,useRef:Fn,useState:Fn,useDebugValue:Fn,useDeferredValue:Fn,useTransition:Fn,useSyncExternalStore:Fn,useId:Fn,useHostTransitionStatus:Fn,useFormState:Fn,useActionState:Fn,useOptimistic:Fn,useMemoCache:Fn,useCacheRefresh:Fn},e$={readContext:Jt,use:Xf,useCallback:function(m,_){return cr().memoizedState=[m,_===void 0?null:_],m},useContext:Jt,useEffect:Z7,useImperativeHandle:function(m,_,S){S=S!=null?S.concat([m]):null,X0(4194308,4,tF.bind(null,_,m),S)},useLayoutEffect:function(m,_){return X0(4194308,4,m,_)},useInsertionEffect:function(m,_){X0(4,2,m,_)},useMemo:function(m,_){var S=cr();_=_===void 0?null:_;var C=m();if(_h){B(!0);try{m()}finally{B(!1)}}return S.memoizedState=[C,_],C},useReducer:function(m,_,S){var C=cr();if(S!==void 0){var O=S(_);if(_h){B(!0);try{S(_)}finally{B(!1)}}}else O=_;return C.memoizedState=C.baseState=O,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:m,lastRenderedState:O},C.queue=m,m=m.dispatch=jlt.bind(null,De,m),[C.memoizedState,m]},useRef:function(m){var _=cr();return m={current:m},_.memoizedState=m},useState:function(m){m=mT(m);var _=m.queue,S=lF.bind(null,De,_);return _.dispatch=S,[m.memoizedState,S]},useDebugValue:yT,useDeferredValue:function(m,_){var S=cr();return gT(S,m,_)},useTransition:function(){var m=mT(!1);return m=sF.bind(null,De,m.queue,!0,!1),cr().memoizedState=m,[!1,m]},useSyncExternalStore:function(m,_,S){var C=De,O=cr();if(mn){if(S===void 0)throw Error(i(407));S=S()}else{if(S=_(),An===null)throw Error(i(349));(tn&124)!==0||O7(C,_,S)}O.memoizedState=S;var $={value:S,getSnapshot:_};return O.queue=$,Z7(F7.bind(null,C,$,m),[m]),C.flags|=2048,Vf(9,Y0(),L7.bind(null,C,$,S,_),null),S},useId:function(){var m=cr(),_=An.identifierPrefix;if(mn){var S=da,C=ha;S=(C&~(1<<32-es(C)-1)).toString(32)+S,_="\xAB"+_+"R"+S,S=gx++,0<S&&(_+="H"+S.toString(32)),_+="\xBB"}else S=Fpt++,_="\xAB"+_+"r"+S.toString(32)+"\xBB";return m.memoizedState=_},useHostTransitionStatus:xT,useFormState:V7,useActionState:V7,useOptimistic:function(m){var _=cr();_.memoizedState=_.baseState=m;var S={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return _.queue=S,_=bT.bind(null,De,!0,S),S.dispatch=_,[m,_]},useMemoCache:Ty,useCacheRefresh:function(){return cr().memoizedState=Dlt.bind(null,De)}},n$={readContext:Jt,use:Xf,useCallback:nF,useContext:Jt,useEffect:K7,useImperativeHandle:eF,useInsertionEffect:J7,useLayoutEffect:Q7,useMemo:iF,useReducer:Uf,useRef:q7,useState:function(){return Uf(Us)},useDebugValue:yT,useDeferredValue:function(m,_){var S=ei();return rF(S,wn.memoizedState,m,_)},useTransition:function(){var m=Uf(Us)[0],_=ei().memoizedState;return[typeof m=="boolean"?m:sh(m),_]},useSyncExternalStore:R7,useId:aF,useHostTransitionStatus:xT,useFormState:G7,useActionState:G7,useOptimistic:function(m,_){var S=ei();return D7(S,wn,m,_)},useMemoCache:Ty,useCacheRefresh:cF},zpt={readContext:Jt,use:Xf,useCallback:nF,useContext:Jt,useEffect:K7,useImperativeHandle:eF,useInsertionEffect:J7,useLayoutEffect:Q7,useMemo:iF,useReducer:My,useRef:q7,useState:function(){return My(Us)},useDebugValue:yT,useDeferredValue:function(m,_){var S=ei();return wn===null?gT(S,m,_):rF(S,wn.memoizedState,m,_)},useTransition:function(){var m=My(Us)[0],_=ei().memoizedState;return[typeof m=="boolean"?m:sh(m),_]},useSyncExternalStore:R7,useId:aF,useHostTransitionStatus:xT,useFormState:W7,useActionState:W7,useOptimistic:function(m,_){var S=ei();return wn!==null?D7(S,wn,m,_):(S.baseState=m,[m,S.queue.dispatch])},useMemoCache:Ty,useCacheRefresh:cF},hm=null,Gy=0,dm=dF(!0),i$=dF(!1),bs=p(null),Eo=null,wi=p(0),v3={enqueueSetState:function(m,_,S){m=m._reactInternals;var C=Jr(),O=fs(C);O.payload=_,S!=null&&(O.callback=S),_=ms(m,O,C),_!==null&&(Qr(_,m,C),ra(_,m,C))},enqueueReplaceState:function(m,_,S){m=m._reactInternals;var C=Jr(),O=fs(C);O.tag=1,O.payload=_,S!=null&&(O.callback=S),_=ms(m,O,C),_!==null&&(Qr(_,m,C),ra(_,m,C))},enqueueForceUpdate:function(m,_){m=m._reactInternals;var S=Jr(),C=fs(S);C.tag=2,_!=null&&(C.callback=_),_=ms(m,C,S),_!==null&&(Qr(_,m,S),ra(_,m,S))}},r$=typeof reportError=="function"?reportError:function(m){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var _=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof m=="object"&&m!==null&&typeof m.message=="string"?String(m.message):String(m),error:m});if(!window.dispatchEvent(_))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",m);return}console.error(m)},s$=Error(i(461)),Ai=!1,S3={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null},ma=!1,pi=!1,w3=!1,o$=typeof WeakSet=="function"?WeakSet:Set,Ri=null,mi=null,Or=!1,Ws=null,fm=8192,$pt={getCacheForType:function(m){var _=Jt(ni),S=_.data.get(m);return S===void 0&&(S=m(),_.data.set(m,S)),S}},bx=0,vx=1,Sx=2,wx=3,Px=4;if(typeof Symbol=="function"&&Symbol.for){var Hy=Symbol.for;bx=Hy("selector.component"),vx=Hy("selector.has_pseudo_class"),Sx=Hy("selector.role"),wx=Hy("selector.test_id"),Px=Hy("selector.text")}var Dpt=typeof WeakMap=="function"?WeakMap:Map,Qe=0,An=null,Ue=null,tn=0,xn=0,rs=null,Ec=!1,mm=!1,P3=!1,_a=0,ii=0,Mc=0,yh=0,k3=0,vs=0,_m=0,Wy=null,Lr=null,T3=!1,E3=0,qy=1/0,kx=null,Cc=null,Ki=0,Ic=null,ym=null,gm=0,M3=0,C3=null,a$=null,Zy=0,I3=null;return Xe.attemptContinuousHydration=function(m){if(m.tag===13){var _=wo(m,67108864);_!==null&&Qr(_,m,67108864),KT(m,67108864)}},Xe.attemptHydrationAtCurrentPriority=function(m){if(m.tag===13){var _=Jr();_=R(_);var S=wo(m,_);S!==null&&Qr(S,m,_),KT(m,_)}},Xe.attemptSynchronousHydration=function(m){switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var _=x(m.pendingLanes);if(_!==0){for(m.pendingLanes|=2,m.entangledLanes|=2;_;){var S=1<<31-es(_);m.entanglements[1]|=S,_&=~S}Ar(m),(Qe&6)===0&&(qy=Hs()+500,So(0,!1))}}break;case 13:_=wo(m,2),_!==null&&Qr(_,m,2),iz(),KT(m,2)}},Xe.batchedUpdates=function(m,_){return m(_)},Xe.createComponentSelector=function(m){return{$$typeof:bx,value:m}},Xe.createContainer=function(m,_,S,C,O,$,K,ct,xt,It){return bz(m,_,!1,null,S,C,$,K,ct,xt,It,null)},Xe.createHasPseudoClassSelector=function(m){return{$$typeof:vx,value:m}},Xe.createHydrationContainer=function(m,_,S,C,O,$,K,ct,xt,It,$t,Xt,Wt){return m=bz(S,C,!0,m,O,$,ct,xt,It,$t,Xt,Wt),m.context=vz(null),S=m.current,C=Jr(),C=R(C),O=fs(C),O.callback=_??null,ms(S,O,C),_=C,m.current.lanes=_,E(m,_),Ar(m),m},Xe.createPortal=function(m,_,S){var C=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:qf,key:C==null?null:""+C,children:m,containerInfo:_,implementation:S}},Xe.createRoleSelector=function(m){return{$$typeof:Sx,value:m}},Xe.createTestNameSelector=function(m){return{$$typeof:wx,value:m}},Xe.createTextSelector=function(m){return{$$typeof:Px,value:m}},Xe.defaultOnCaughtError=function(m){console.error(m)},Xe.defaultOnRecoverableError=function(m){r$(m)},Xe.defaultOnUncaughtError=function(m){r$(m)},Xe.deferredUpdates=function(m){var _=_e.T,S=pa();try{return Ni(32),_e.T=null,m()}finally{Ni(S),_e.T=_}},Xe.discreteUpdates=function(m,_,S,C,O){var $=_e.T,K=pa();try{return Ni(2),_e.T=null,m(_,S,C,O)}finally{Ni(K),_e.T=$,Qe===0&&(qy=Hs()+500)}},Xe.findAllNodes=XT,Xe.findBoundingRects=function(m,_){if(!Dy)throw Error(i(363));_=XT(m,_),m=[];for(var S=0;S<_.length;S++)m.push(Cut(_[S]));for(_=m.length-1;0<_;_--){S=m[_];for(var C=S.x,O=C+S.width,$=S.y,K=$+S.height,ct=_-1;0<=ct;ct--)if(_!==ct){var xt=m[ct],It=xt.x,$t=It+xt.width,Xt=xt.y,Wt=Xt+xt.height;if(C>=It&&$>=Xt&&O<=$t&&K<=Wt){m.splice(_,1);break}else if(C!==It||S.width!==xt.width||Wt<$||Xt>K){if(!($!==Xt||S.height!==xt.height||$t<C||It>O)){It>C&&(xt.width+=It-C,xt.x=C),$t<O&&(xt.width=O-It),m.splice(_,1);break}}else{Xt>$&&(xt.height+=Xt-$,xt.y=$),Wt<K&&(xt.height=K-Xt),m.splice(_,1);break}}}return m},Xe.findHostInstance=Sz,Xe.findHostInstanceWithNoPortals=function(m){return m=o(m),m=m!==null?c(m):null,m===null?null:$y(m.stateNode)},Xe.findHostInstanceWithWarning=function(m){return Sz(m)},Xe.flushPassiveEffects=zy,Xe.flushSyncFromReconciler=function(m){var _=Qe;Qe|=1;var S=_e.T,C=pa();try{if(Ni(2),_e.T=null,m)return m()}finally{Ni(C),_e.T=S,Qe=_,(Qe&6)===0&&So(0,!1)}},Xe.flushSyncWork=iz,Xe.focusWithin=function(m,_){if(!Dy)throw Error(i(363));for(m=jT(m),_=QF(m,_),_=Array.from(_),m=0;m<_.length;){var S=_[m++],C=S.tag;if(!jy(S)){if((C===5||C===26||C===27)&&Aut(S.stateNode))return!0;for(S=S.child;S!==null;)_.push(S),S=S.sibling}}return!1},Xe.getFindAllNodesFailureDescription=function(m,_){if(!Dy)throw Error(i(363));var S=0,C=[];m=[jT(m),0];for(var O=0;O<m.length;){var $=m[O++],K=$.tag,ct=m[O++],xt=_[ct];if((K!==5&&K!==26&&K!==27||!jy($))&&(BT($,xt)&&(C.push(YT(xt)),ct++,ct>S&&(S=ct)),ct<_.length))for($=$.child;$!==null;)m.push($,ct),$=$.sibling}if(S<_.length){for(m=[];S<_.length;S++)m.push(YT(_[S]));return`findAllNodes was able to match part of the selector:
  `+(C.join(" > ")+`

No matching component was found for:
  `)+m.join(" > ")}return null},Xe.getPublicRootInstance=function(m){if(m=m.current,!m.child)return null;switch(m.child.tag){case 27:case 5:return $y(m.child.stateNode);default:return m.child.stateNode}},Xe.injectIntoDevTools=function(){var m={bundleType:0,version:cut,rendererPackageName:lut,currentDispatcherRef:_e,reconcilerVersion:"19.1.0"};if(Mz!==null&&(m.rendererConfig=Mz),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")m=!1;else{var _=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(_.isDisabled||!_.supportsFiber)m=!0;else{try{By=_.inject(m),ns=_}catch{}m=!!_.checkDCE}}return m},Xe.isAlreadyRendering=function(){return(Qe&6)!==0},Xe.observeVisibleRects=function(m,_,S,C){if(!Dy)throw Error(i(363));m=XT(m,_);var O=Rut(m,S,C).disconnect;return{disconnect:function(){O()}}},Xe.shouldError=function(){return null},Xe.shouldSuspend=function(){return!1},Xe.startHostTransition=function(m,_,S,C){if(m.tag!==5)throw Error(i(476));var O=oF(m).queue;sF(m,O,_,Kf,S===null?t:function(){var $=oF(m).next.queue;return Iy(m,$,{},Jr()),S(C)})},Xe.updateContainer=function(m,_,S,C){var O=_.current,$=Jr();return wz(O,$,m,_,S,C),$},Xe.updateContainerSync=function(m,_,S,C){return wz(_.current,2,m,_,S,C),2},Xe};lg.exports.default=lg.exports;Object.defineProperty(lg.exports,"__esModule",{value:!0})});var GB=ue((jqt,VB)=>{"use strict";VB.exports=UB()});var HB=ue(jc=>{"use strict";jc.ConcurrentRoot=1;jc.ContinuousEventPriority=8;jc.DefaultEventPriority=32;jc.DiscreteEventPriority=2;jc.IdleEventPriority=268435456;jc.LegacyRoot=0;jc.NoEventPriority=0});var qB=ue((Yqt,WB)=>{"use strict";WB.exports=HB()});function ss(n,e){return Array.isArray(e)?[n.a*e[0]+n.c*e[1]+n.e,n.b*e[0]+n.d*e[1]+n.f]:{x:n.a*e.x+n.c*e.y+n.e,y:n.b*e.x+n.d*e.y+n.f}}function ZB(n){return typeof n>"u"}function KB(n,e=0){return{a:1,c:0,e:n,b:0,d:1,f:e}}function Qv(...n){n=Array.isArray(n[0])?n[0]:n;let e=(t,i)=>({a:t.a*i.a+t.c*i.b,c:t.a*i.c+t.c*i.d,e:t.a*i.e+t.c*i.f+t.e,b:t.b*i.a+t.d*i.b,d:t.b*i.c+t.d*i.d,f:t.b*i.e+t.d*i.f+t.f});switch(n.length){case 0:throw new Error("no matrices provided");case 1:return n[0];case 2:return e(n[0],n[1]);default:{let[t,i,...r]=n,s=e(t,i);return Qv(s,...r)}}}function Vgt(n,e,t){let i=Xgt(n),r=Ugt(n),s={a:i,c:-r,e:0,b:r,d:i,f:0};return ZB(e)||ZB(t)?s:Qv([KB(e,t),s,KB(-e,-t)])}function Ggt(n,e){function t(){this.constructor=n}t.prototype=e.prototype,n.prototype=new t}function t2(n,e,t,i){var r=Error.call(this,n);return Object.setPrototypeOf&&Object.setPrototypeOf(r,t2.prototype),r.expected=e,r.found=t,r.location=i,r.name="SyntaxError",r}function IE(n,e,t){return t=t||" ",n.length>e?n:(e-=n.length,t+=t.repeat(e),n+t.slice(0,e))}function iM(n){if(n.length===0)return{minX:0,maxX:0,minY:0,maxY:0};let e=1/0,t=-1/0,i=1/0,r=-1/0,s=o=>{e=Math.min(e,o.x),t=Math.max(t,o.x),i=Math.min(i,o.y),r=Math.max(r,o.y)};return n.forEach(o=>{switch(o.type){case"path":o.points.forEach(s);break;case"text":s({x:o.x,y:o.y});break;case"circle":{let{x:a,y:c,radius:l}=o;s({x:a-l,y:c-l}),s({x:a+l,y:c+l});break}case"box":{let{x:a,y:c,width:l,height:u}=o,p=l/2,f=u/2;s({x:a-p,y:c-f}),s({x:a+p,y:c+f});break}}}),{minX:e,maxX:t,minY:i,maxY:r}}function en(n){let e=n.size;if(!e){let t=iM(n.primitives);e={width:t.maxX-t.minX,height:t.maxY-t.minY}}return{...n,size:e}}function wxt(n){return typeof n=="object"&&n!==null&&n.type==="path"&&Array.isArray(n.points)&&typeof n.color=="string"}function Pxt(n){return typeof n=="object"&&n!==null&&n.type==="text"&&typeof n.text=="string"&&typeof n.x=="number"&&typeof n.y=="number"&&typeof n.anchor=="string"}function Txt(n){return typeof n=="object"}function rvt(n){return typeof n=="object"}function OPt(n){return typeof n=="object"}function wkt(n){return typeof n=="object"}function B2(n,e){let{width:t,height:i}=n.size,r=1,s=1;e.width!==void 0&&e.height!==void 0?(r=e.width/t,s=e.height/i):e.width!==void 0?r=s=e.width/t:e.height!==void 0&&(r=s=e.height/i);let o=n.primitives.map(a=>{switch(a.type){case"path":return{...a,points:a.points.map(c=>({x:c.x*r,y:c.y*s}))};case"text":return{...a,x:a.x*r,y:a.y*s,fontSize:a.fontSize?a.fontSize*r:void 0};case"circle":return{...a,x:a.x*r,y:a.y*s,radius:a.radius*r};case"box":return{...a,x:a.x*r,y:a.y*s,width:a.width*r,height:a.height*s};default:return a}});return{...n,primitives:o,center:{x:n.center.x*r,y:n.center.y*s},ports:n.ports.map(a=>({...a,x:a.x*r,y:a.y*s})),size:{width:t*r,height:i*s}}}function jkt(n){return typeof n=="object"}function Wkt(n){return typeof n=="object"}var Xgt,Ugt,Xqt,Uqt,Hgt,e2,pg,rM,Lt,Wgt,_t,Bm,qgt,Vqt,ub,JB,Zgt,Kgt,Jgt,Gqt,pb,QB,Qgt,t1t,e1t,Hqt,hb,tY,n1t,i1t,r1t,Wqt,db,eY,s1t,o1t,a1t,qqt,fb,nY,c1t,l1t,u1t,Zqt,mb,iY,p1t,h1t,Ym,d1t,Kqt,_b,rY,f1t,m1t,_1t,y1t,Jqt,yb,sY,g1t,x1t,b1t,v1t,Qqt,gb,oY,S1t,w1t,P1t,tZt,xb,aY,k1t,T1t,n2,E1t,eZt,bb,cY,M1t,C1t,I1t,nZt,vb,lY,N1t,pU,A1t,iZt,Sb,uY,R1t,O1t,rZt,sZt,oZt,aZt,cZt,sM,oM,aM,L1t,F1t,z1t,pY,wb,hY,$1t,hU,D1t,i2,j1t,lZt,dY,fY,B1t,Y1t,X1t,uZt,mY,_Y,U1t,V1t,G1t,pZt,yY,gY,H1t,W1t,r2,q1t,hZt,Pb,xY,Z1t,K1t,J1t,dZt,kb,bY,Q1t,t0t,e0t,fZt,Tb,vY,n0t,i0t,r0t,mZt,Eb,SY,s0t,o0t,a0t,_Zt,wY,PY,c0t,l0t,cM,u0t,yZt,kY,TY,p0t,h0t,d0t,gZt,EY,MY,f0t,dU,m0t,_0t,xZt,CY,IY,y0t,g0t,s2,x0t,bZt,Mb,NY,b0t,v0t,S0t,o2,w0t,vZt,Cb,AY,P0t,k0t,T0t,E0t,SZt,Ib,RY,M0t,C0t,I0t,wZt,Nb,OY,N0t,A0t,R0t,O0t,PZt,Ab,LY,L0t,F0t,Xm,z0t,kZt,Rb,FY,$0t,D0t,j0t,B0t,TZt,Ob,zY,Y0t,X0t,U0t,V0t,EZt,Lb,$Y,G0t,H0t,W0t,MZt,Fb,DY,q0t,Z0t,a2,K0t,CZt,zb,$b,J0t,Q0t,txt,ext,nxt,IZt,Db,jb,ixt,rxt,c2,sxt,NZt,Bb,jY,oxt,axt,cxt,lxt,uxt,AZt,Yb,BY,pxt,hxt,Um,dxt,fxt,mxt,_xt,yxt,gxt,xxt,bxt,vxt,Xb,YY,Sxt,lM,eM,nM,kxt,XY,Ext,Vm,Mxt,RZt,Ub,UY,Cxt,Ixt,Nxt,OZt,Vb,VY,Axt,Rxt,Oxt,LZt,Gb,GY,Lxt,Fxt,zxt,FZt,Hb,HY,$xt,Dxt,jxt,zZt,Wb,WY,Bxt,Yxt,Xxt,$Zt,qb,qY,Uxt,Vxt,Gm,Gxt,Hxt,Wxt,qxt,Zxt,Kxt,l2,Jxt,ZY,Qxt,tbt,ebt,KY,nbt,ibt,rbt,JY,sbt,obt,abt,QY,cbt,lbt,ubt,u2,pbt,hbt,dbt,fbt,p2,uM,pM,hM,mbt,dM,fM,mM,_bt,_M,yM,gM,ybt,gbt,h2,xM,bM,vM,xbt,SM,wM,PM,bbt,kM,TM,EM,vbt,Sbt,d2,MM,CM,IM,wbt,NM,AM,RM,Pbt,OM,LM,FM,kbt,Tbt,f2,zM,$M,DM,Ebt,jM,BM,YM,Mbt,XM,UM,VM,Cbt,fU,Ibt,DZt,Zb,tX,Nbt,mU,GM,HM,WM,Abt,_U,Rbt,Hm,Obt,jZt,Kb,eX,Lbt,Fbt,zbt,BZt,Jb,nX,$bt,Dbt,jbt,YZt,Qb,iX,Bbt,Ybt,Xbt,XZt,tv,rX,Ubt,Vbt,Gbt,UZt,ev,sX,Hbt,Wbt,qbt,VZt,nv,oX,Zbt,Kbt,Jbt,Qbt,tvt,iv,aX,evt,qM,nvt,ivt,cX,svt,ovt,avt,cvt,rv,lX,yU,lvt,Wm,uvt,pvt,hvt,dvt,fvt,mvt,ZM,GZt,HZt,WZt,qZt,ZZt,_vt,yvt,gvt,m2,xvt,bvt,KM,JM,QM,vvt,Svt,gU,tC,eC,xU,wvt,Pvt,bU,vU,SU,nC,iC,kvt,Tvt,Evt,uX,sv,pX,Mvt,rC,wU,Cvt,Ivt,PU,_2,sC,oC,aC,Nvt,cC,lC,uC,Avt,pC,hC,dC,Rvt,Ovt,Lvt,hX,ov,dX,Fvt,fC,mC,_C,yC,kU,gC,xC,bC,zvt,$vt,Dvt,jvt,fX,av,mX,Bvt,TU,EU,MU,vC,SC,Yvt,Xvt,Uvt,_X,cv,NE,CU,wC,IU,PC,Vvt,Gvt,Hvt,yX,lv,gX,Wvt,NU,kC,ug,Jv,qvt,Zvt,Kvt,xX,uv,AE,Jvt,AU,RU,OU,TC,EC,Qvt,t2t,e2t,bX,pv,RE,n2t,LU,FU,zU,MC,CC,i2t,r2t,s2t,vX,hv,OE,o2t,$U,DU,jU,IC,NC,a2t,c2t,l2t,SX,u2t,y2,p2t,h2t,d2t,Uh,f2t,KZt,dv,LE,m2t,_2t,JZt,QZt,tKt,eKt,nKt,y2t,g2t,iKt,fv,FE,x2t,b2t,v2t,rKt,mv,zE,S2t,w2t,P2t,sKt,_v,$E,k2t,T2t,E2t,oKt,yv,DE,M2t,C2t,I2t,g2,N2t,A2t,R2t,O2t,x2,L2t,F2t,z2t,$2t,D2t,wX,gv,jE,j2t,BU,YU,XU,AC,RC,B2t,Y2t,X2t,PX,xv,BE,U2t,UU,VU,GU,OC,LC,V2t,G2t,HU,WU,H2t,qU,W2t,q2t,Z2t,kX,bv,YE,K2t,ZU,KU,JU,FC,zC,J2t,Vh,Q2t,aKt,vv,XE,tSt,eSt,cKt,lKt,uKt,pKt,hKt,nSt,iSt,dKt,Sv,UE,rSt,sSt,oSt,fKt,wv,VE,aSt,cSt,lSt,mKt,Pv,GE,uSt,pSt,hSt,_Kt,kv,HE,dSt,fSt,mSt,_St,TX,Tv,EX,QU,ySt,gSt,xSt,bSt,MX,Ev,CX,b2,$C,DC,jC,vSt,BC,YC,XC,SSt,UC,VC,GC,wSt,v2,PSt,yKt,Mv,WE,kSt,TSt,ESt,gKt,Cv,qE,MSt,CSt,ISt,NSt,xKt,Iv,ZE,ASt,RSt,OSt,LSt,bKt,Nv,IX,FSt,tV,eV,HC,WC,qC,ZC,zSt,$St,DSt,NX,Av,AX,jSt,nV,BSt,YSt,XSt,RX,Rv,OX,USt,iV,VSt,S2,GSt,vKt,LX,HSt,WSt,qSt,ZSt,SKt,FX,KSt,JSt,QSt,twt,wKt,zX,ewt,nwt,iwt,rwt,PKt,$X,swt,owt,awt,cwt,DX,Ov,Lv,lwt,rV,KC,uwt,pwt,hwt,w2,dwt,kKt,Fv,jX,fwt,mwt,_wt,TKt,zv,BX,ywt,gwt,xwt,EKt,$v,YX,bwt,vwt,Swt,MKt,Dv,XX,wwt,Pwt,sV,kwt,UX,jv,KE,Twt,P2,JC,QC,tI,Ewt,Mwt,CKt,Bv,JE,Cwt,oV,eI,nI,iI,Iwt,rI,sI,oI,Nwt,Awt,Rwt,k2,aI,cI,lI,Owt,uI,pI,hI,Lwt,dI,fI,mI,Fwt,aV,IKt,NKt,AKt,RKt,OKt,cV,lV,zwt,uV,$wt,T2,Dwt,jwt,Bwt,Ywt,E2,Xwt,Uwt,Vwt,Gwt,M2,Hwt,Wwt,qwt,Zwt,C2,Kwt,Jwt,Qwt,tPt,I2,ePt,nPt,iPt,rPt,N2,sPt,oPt,aPt,cPt,lPt,A2,_I,yI,gI,uPt,xI,bI,vI,pPt,SI,wI,PI,hPt,dPt,R2,kI,TI,EI,fPt,MI,CI,II,mPt,NI,AI,RI,_Pt,O2,L2,OI,LI,FI,yPt,zI,$I,DI,gPt,jI,BI,YI,xPt,F2,z2,XI,UI,VI,bPt,GI,HI,WI,vPt,qI,ZI,KI,SPt,$2,wPt,PPt,kPt,TPt,pV,LKt,FKt,zKt,$Kt,DKt,hV,EPt,MPt,CPt,IPt,Yv,VX,NPt,JI,APt,RPt,GX,LPt,D2,dV,HX,FPt,zPt,fV,WX,$Pt,DPt,QI,t5,e5,n5,mV,i5,r5,s5,jPt,o5,a5,c5,BPt,_V,jKt,BKt,YKt,XKt,UKt,yV,gV,xV,YPt,XPt,UPt,VPt,GPt,qX,Xv,ZX,HPt,bV,l5,WPt,qPt,ZPt,KPt,JPt,KX,Uv,QE,QPt,vV,SV,wV,tkt,PV,ekt,nkt,ikt,rkt,skt,tM,Vv,JX,okt,kV,akt,ckt,lkt,QX,Gv,tU,ukt,TV,u5,pkt,hkt,dkt,fkt,mkt,eU,Hv,nU,EV,_kt,ykt,gkt,xkt,Wv,iU,bkt,p5,vkt,Skt,rU,Pkt,j2,kkt,Tkt,Ekt,Mkt,Ckt,Ikt,Nkt,Akt,MV,VKt,GKt,HKt,WKt,qKt,CV,Rkt,Okt,Lkt,Fkt,qv,sU,zkt,h5,$kt,Dkt,oU,Bkt,Ykt,Xkt,Ukt,Zv,aU,Vkt,d5,Gkt,Hkt,cU,qkt,Zkt,Kkt,lU,Kv,uU,Jkt,IV,f5,Qkt,tTt,eTt,yi,ZKt,Ta=qt(()=>{"use strict";({cos:Xgt,sin:Ugt,PI:Xqt}=Math);({tan:Uqt}=Math);Ggt(t2,Error);t2.prototype.format=function(n){var e="Error: "+this.message;if(this.location){var t=null,i;for(i=0;i<n.length;i++)if(n[i].source===this.location.source){t=n[i].text.split(/\r\n|\n|\r/g);break}var r=this.location.start,s=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(r):r,o=this.location.source+":"+s.line+":"+s.column;if(t){var a=this.location.end,c=IE("",s.line.toString().length," "),l=t[r.line-1],u=r.line===a.line?a.column:l.length+1,p=u-r.column||1;e+=`
 --> `+o+`
`+c+` |
`+s.line+" | "+l+`
`+c+" | "+IE("",r.column-1," ")+IE("",p,"^")}else e+=`
 at `+o}return e};t2.buildMessage=function(n,e){var t={literal:function(l){return'"'+r(l.text)+'"'},class:function(l){var u=l.parts.map(function(p){return Array.isArray(p)?s(p[0])+"-"+s(p[1]):s(p)});return"["+(l.inverted?"^":"")+u.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(l){return l.description}};function i(l){return l.charCodeAt(0).toString(16).toUpperCase()}function r(l){return l.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(u){return"\\x0"+i(u)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(u){return"\\x"+i(u)})}function s(l){return l.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(u){return"\\x0"+i(u)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(u){return"\\x"+i(u)})}function o(l){return t[l.type](l)}function a(l){var u=l.map(o),p,f;if(u.sort(),u.length>0){for(p=1,f=1;p<u.length;p++)u[p-1]!==u[p]&&(u[f]=u[p],f++);u.length=f}switch(u.length){case 1:return u[0];case 2:return u[0]+" or "+u[1];default:return u.slice(0,-1).join(", ")+", or "+u[u.length-1]}}function c(l){return l?'"'+r(l)+'"':"end of input"}return"Expected "+a(n)+" but "+c(e)+" found."};Hgt=(n,e="right")=>{switch(e){case"down":switch(n){case"middle_top":return"middle_right";case"middle_bottom":return"middle_left";case"middle_left":return"middle_bottom";case"middle_right":return"middle_top"}break;case"up":switch(n){case"middle_top":return"middle_left";case"middle_bottom":return"middle_right";case"middle_left":return"middle_top";case"middle_right":return"middle_bottom"}break;case"left":switch(n){case"middle_top":return"middle_bottom";case"middle_bottom":return"middle_top";case"middle_left":return"middle_right";case"middle_right":return"middle_left"}break;case"right":return n}return n},e2=(n,e)=>{let{primitives:t,center:i,ports:r,size:s}=n,o=Qv({a:1,b:0,c:0,d:-1,e:0,f:2*i.y}),a=t.map(l=>{switch(l={...l},l.type){case"path":return{...l,points:l.points.map(y=>ss(o,y))};case"text":let u=ss(o,{x:l.x,y:l.y}),p={top_left:"bottom_left",top_right:"bottom_right",bottom_left:"top_left",bottom_right:"top_right",center:"center",middle_top:"middle_bottom",middle_bottom:"middle_top",middle_left:"middle_left",middle_right:"middle_right"};return{...l,x:u.x,y:u.y,anchor:p[l.anchor]};case"circle":case"box":let f=ss(o,{x:l.x,y:l.y});return{...l,x:f.x,y:f.y}}}),c=r.map(l=>({...l,...ss(o,l)}));return{primitives:a,center:i,ports:c,size:s,...e}},pg=(n,e)=>{let{primitives:t,center:i,ports:r,size:s}=n,o=Qv({a:-1,b:0,c:0,d:1,e:0,f:2*i.x}),a=t.map(l=>{switch(l={...l},l.type){case"path":return{...l,points:l.points.map(y=>ss(o,y))};case"text":let u=ss(o,{x:l.x,y:l.y}),p={top_left:"top_right",top_right:"top_left",bottom_left:"bottom_right",bottom_right:"bottom_left",center:"center",middle_top:"middle_top",middle_bottom:"middle_bottom",middle_left:"middle_right",middle_right:"middle_left"};return{...l,x:u.x,y:u.y,anchor:p[l.anchor]};case"circle":case"box":let f=ss(o,{x:l.x,y:l.y});return{...l,x:f.x,y:f.y}}}),c=r.map(l=>({...l,...ss(o,l)}));return{primitives:a,center:i,ports:c,size:s,...e}},rM=(n,e)=>{let{newOrientation:t,overrides:i}=e,r={up:Math.PI/2,right:0,down:-Math.PI/2,left:-Math.PI},s=Vgt(t?r[t]:Math.PI/2,n.center.x,n.center.y),{primitives:o,center:a,size:c,ports:l}=n,u=o.map(y=>{switch(y={...y},y.type){case"path":return{...y,points:y.points.map(P=>ss(s,P))};case"text":let g=ss(s,{x:y.x,y:y.y});return y.anchor=Hgt(y.anchor,t??"right"),{...y,x:g.x,y:g.y};case"circle":let x=ss(s,{x:y.x,y:y.y});return{...y,x:x.x,y:x.y};case"box":let v=ss(s,{x:y.x,y:y.y});return{...y,x:v.x,y:v.y,width:y.height,height:y.width}}}),p=l.map(y=>({...y,...ss(s,y)})),f=iM(u);return{primitives:u,center:a,ports:p,size:{width:f.maxX-f.minX,height:f.maxY-f.minY},...i}},Lt=(n,e="down",t={})=>rM(n,{newOrientation:e,overrides:t}),Wgt=class{constructor(n){d(this,"symbol");this.symbol=JSON.parse(JSON.stringify(n)),this.symbol.size=this.computeSize()}changeTextAnchor(n,e,t){return this.symbol={...this.symbol,primitives:this.symbol.primitives.map(i=>i.type==="text"&&i.text===n?{...i,anchor:e,...t?{x:i.x+t.x,y:i.y+t.y}:{}}:i)},this}labelPort(n,e){return this.symbol={...this.symbol,ports:this.symbol.ports.map(t=>t.labels.includes(n)?{...t,labels:e}:t)},this}rotateRightFacingSymbol(n){return this.symbol=rM(this.symbol,{newOrientation:n}),this}computeSize(){let n=iM(this.symbol.primitives);return{width:n.maxX-n.minX,height:n.maxY-n.minY}}build(){return{...this.symbol,size:this.computeSize()}}},_t=n=>{let e=n.primitives??[...Object.values(n.paths??{}),...Object.values(n.texts??{}),...Object.values(n.circles??{}),...Object.values(n.rects??{})],t=n.ports??Object.entries(n.refblocks).flatMap(([r,s])=>[{...s,labels:[r]}]),i=n.center??{x:n.bounds.centerX,y:n.bounds.centerY};return t.length===2&&(i={x:(t[0].x+t[1].x)/2,y:(t[0].y+t[1].y)/2}),new Wgt({...n,primitives:e,ports:t,center:i})},Bm={paths:{path11:{type:"path",points:[{x:-.54,y:.03},{x:-.3,y:.04}],color:"primary",fill:!1},path12:{type:"path",points:[{x:.29,y:.04},{x:.54,y:.04}],color:"primary",fill:!1},"path11-5-5":{type:"path",points:[{x:.1,y:.13},{x:0,y:-.06},{x:-.11,y:.13}],color:"primary",fill:!1},path17:{type:"path",points:[{x:0,y:-.13},{x:.07,y:-.11}],color:"primary",fill:!1},path18:{type:"path",points:[{x:.07,y:-.11},{x:.14,y:-.13}],color:"primary",fill:!1},path19:{type:"path",points:[{x:-.15,y:-.13},{x:-.07,y:-.11}],color:"primary",fill:!1},path20:{type:"path",points:[{x:-.07,y:-.11},{x:0,y:-.13}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.17,y:.4},bottom1:{type:"text",text:"{VAL}",x:-.01,y:-.4}},refblocks:{left1:{x:-.54,y:.03},right1:{x:.54,y:.04}},bounds:{minX:-.57,maxX:.57,minY:-.4,maxY:.4,width:1.14,height:.79,centerX:0,centerY:0},circles:{path1:{type:"circle",x:0,y:.04,radius:.29,color:"primary",fill:!1}}},{paths:qgt,texts:Vqt,bounds:ub,refblocks:JB,circles:Zgt}=Bm,Kgt=_t({primitives:[...Object.values(qgt),...Object.values(Zgt),{type:"text",text:"{REF}",x:-.15,y:.3894553499999995},{type:"text",text:"{VAL}",x:.15,y:.3894553499999995}],ports:[{...JB.left1,labels:["1"]},{...JB.right1,labels:["2"]}],size:{width:ub.width,height:ub.height},center:{x:ub.centerX,y:ub.centerY}}).rotateRightFacingSymbol("down").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_left").changeTextAnchor("{VAL}","middle_left").build(),{paths:Jgt,texts:Gqt,bounds:pb,refblocks:QB,circles:Qgt}=Bm,t1t=_t({primitives:[...Object.values(Jgt),...Object.values(Qgt),{type:"text",text:"{REF}",x:-0,y:.4094553499999995},{type:"text",text:"{VAL}",x:0,y:-.4094553499999995}],ports:[{...QB.left1,labels:["1"]},{...QB.right1,labels:["2"]}],size:{width:pb.width,height:pb.height},center:{x:pb.centerX,y:pb.centerY}}).changeTextAnchor("{VAL}","middle_top").rotateRightFacingSymbol("right").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_bottom").build(),{paths:e1t,texts:Hqt,bounds:hb,refblocks:tY,circles:n1t}=Bm,i1t=_t({primitives:[...Object.values(e1t),...Object.values(n1t),{type:"text",text:"{REF}",x:-0,y:-.3094553499999995},{type:"text",text:"{VAL}",x:0,y:.4094553499999995}],ports:[{...tY.left1,labels:["1"]},{...tY.right1,labels:["2"]}],size:{width:hb.width,height:hb.height},center:{x:hb.centerX,y:hb.centerY}}).changeTextAnchor("{VAL}","middle_bottom").rotateRightFacingSymbol("left").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_bottom").build(),{paths:r1t,texts:Wqt,bounds:db,refblocks:eY,circles:s1t}=Bm,o1t=_t({primitives:[...Object.values(r1t),...Object.values(s1t),{type:"text",text:"{REF}",x:-0,y:.4094553499999995},{type:"text",text:"{VAL}",x:0,y:-.4094553499999995}],ports:[{...eY.left1,labels:["1"]},{...eY.right1,labels:["2"]}],size:{width:db.width,height:db.height},center:{x:db.centerX,y:db.centerY}}).changeTextAnchor("{VAL}","middle_top").rotateRightFacingSymbol("right").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_bottom").build(),{paths:a1t,texts:qqt,bounds:fb,refblocks:nY,circles:c1t}=Bm,l1t=_t({primitives:[...Object.values(a1t),...Object.values(c1t),{type:"text",text:"{REF}",x:.15,y:-.2894553499999995},{type:"text",text:"{VAL}",x:-.15,y:-.2894553499999995}],ports:[{...nY.left1,labels:["1"]},{...nY.right1,labels:["2"]}],size:{width:fb.width,height:fb.height},center:{x:fb.centerX,y:fb.centerY}}).rotateRightFacingSymbol("up").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_left").changeTextAnchor("{VAL}","middle_left").build(),{paths:u1t,texts:Zqt,bounds:mb,refblocks:iY,circles:p1t}=Bm,h1t=_t({primitives:[...Object.values(u1t),...Object.values(p1t),{type:"text",text:"{REF}",x:.15,y:-.2894553499999995},{type:"text",text:"{VAL}",x:-.15,y:-.2894553499999995}],ports:[{...iY.left1,labels:["1"]},{...iY.right1,labels:["2"]}],size:{width:mb.width,height:mb.height},center:{x:mb.centerX,y:mb.centerY}}).rotateRightFacingSymbol("up").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_left").changeTextAnchor("{VAL}","middle_left").build(),Ym={paths:{path40:{type:"path",points:[{x:.14,y:.04},{x:-.12,y:-.09}],color:"primary",fill:!1},path41:{type:"path",points:[{x:-.12,y:.18},{x:.14,y:.04}],color:"primary",fill:!1},path42:{type:"path",points:[{x:-.12,y:-.09},{x:-.12,y:.18}],color:"primary",fill:!1},path43:{type:"path",points:[{x:.14,y:.18},{x:.14,y:-.09}],color:"primary",fill:!1},path44:{type:"path",points:[{x:-.12,y:.04},{x:-.52,y:.04}],color:"primary",fill:!1},"path44-0":{type:"path",points:[{x:.52,y:.04},{x:.15,y:.04}],color:"primary",fill:!1},"path43-8":{type:"path",points:[{x:.14,y:.18},{x:.08,y:.2}],color:"primary",fill:!1},"path43-8-3":{type:"path",points:[{x:.21,y:-.11},{x:.15,y:-.09}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.01,y:.27},bottom1:{type:"text",text:"{VAL}",x:0,y:-.27}},refblocks:{left1:{x:-.52,y:.04},right1:{x:.52,y:.04}},bounds:{minX:-.55,maxX:.55,minY:-.27,maxY:.27,width:1.09,height:.55,centerX:0,centerY:0},circles:{}},{paths:d1t,texts:Kqt,bounds:_b,refblocks:rY,circles:f1t}=Ym,m1t=_t({primitives:[...Object.values(d1t),...Object.values(f1t),{type:"text",text:"{REF}",x:-.15,y:.3294553499999995},{type:"text",text:"{VAL}",x:.15,y:.3294553499999995}],ports:[{...rY.left1,labels:["1"]},{...rY.right1,labels:["2"]}],size:{width:_b.width,height:_b.height},center:{x:_b.centerX,y:_b.centerY}}).rotateRightFacingSymbol("down").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_left").changeTextAnchor("{VAL}","middle_left").build(),_1t=_t(Ym).changeTextAnchor("{VAL}","middle_top").labelPort("left1",["1","neg"]).labelPort("right1",["2","pos"]).changeTextAnchor("{REF}","middle_bottom").build(),{paths:y1t,texts:Jqt,bounds:yb,refblocks:sY,circles:g1t}=Ym,x1t=_t({primitives:[...Object.values(y1t),...Object.values(g1t),{type:"text",text:"{REF}",x:-0,y:-.2294553499999995},{type:"text",text:"{VAL}",x:0,y:.3294553499999995}],ports:[{...sY.left1,labels:["1"]},{...sY.right1,labels:["2"]}],size:{width:yb.width,height:yb.height},center:{x:yb.centerX,y:yb.centerY}}).changeTextAnchor("{VAL}","middle_bottom").rotateRightFacingSymbol("left").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_bottom").build(),b1t=_t(Ym).changeTextAnchor("{VAL}","middle_top").labelPort("left1",["1","neg"]).labelPort("right1",["2","pos"]).changeTextAnchor("{REF}","middle_bottom").build(),{paths:v1t,texts:Qqt,bounds:gb,refblocks:oY,circles:S1t}=Ym,w1t=_t({primitives:[...Object.values(v1t),...Object.values(S1t),{type:"text",text:"{REF}",x:.15,y:-.2294553499999995},{type:"text",text:"{VAL}",x:-.15,y:-.2294553499999995}],ports:[{...oY.left1,labels:["1"]},{...oY.right1,labels:["2"]}],size:{width:gb.width,height:gb.height},center:{x:gb.centerX,y:gb.centerY}}).rotateRightFacingSymbol("up").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_left").changeTextAnchor("{VAL}","middle_left").build(),{paths:P1t,texts:tZt,bounds:xb,refblocks:aY,circles:k1t}=Ym,T1t=_t({primitives:[...Object.values(P1t),...Object.values(k1t),{type:"text",text:"{REF}",x:.15,y:-.2294553499999995},{type:"text",text:"{VAL}",x:-.15,y:-.2294553499999995}],ports:[{...aY.left1,labels:["1"]},{...aY.right1,labels:["2"]}],size:{width:xb.width,height:xb.height},center:{x:xb.centerX,y:xb.centerY}}).rotateRightFacingSymbol("up").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_left").changeTextAnchor("{VAL}","middle_left").build(),n2={paths:{path40:{type:"path",points:[{x:.14,y:.04},{x:-.12,y:-.09}],color:"primary",fill:!1},path41:{type:"path",points:[{x:-.12,y:.18},{x:.14,y:.04}],color:"primary",fill:!1},path42:{type:"path",points:[{x:-.12,y:-.09},{x:-.12,y:.18}],color:"primary",fill:!1},path43:{type:"path",points:[{x:.14,y:.18},{x:.14,y:-.09}],color:"primary",fill:!1},path44:{type:"path",points:[{x:.14,y:.04},{x:-.52,y:.04}],color:"primary",fill:!1},"path44-0":{type:"path",points:[{x:.52,y:.04},{x:.15,y:.04}],color:"primary",fill:!1},"path43-8":{type:"path",points:[{x:.18,y:.18},{x:.11,y:.18}],color:"primary",fill:!1},"path43-8-8":{type:"path",points:[{x:.18,y:-.09},{x:.11,y:-.09}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.01,y:.27},bottom1:{type:"text",text:"{VAL}",x:0,y:-.27}},refblocks:{left1:{x:-.52,y:.04},right1:{x:.52,y:.04}},bounds:{minX:-.55,maxX:.55,minY:-.27,maxY:.27,width:1.09,height:.55,centerX:0,centerY:0},circles:{}},{paths:E1t,texts:eZt,bounds:bb,refblocks:cY,circles:M1t}=n2,C1t=_t({primitives:[...Object.values(E1t),...Object.values(M1t),{type:"text",text:"{REF}",x:-.16,y:.2294553499999995},{type:"text",text:"{VAL}",x:.16,y:.2294553499999995}],ports:[{...cY.left1,labels:["1"]},{...cY.right1,labels:["2"]}],size:{width:bb.width,height:bb.height},center:{x:bb.centerX,y:bb.centerY}}).changeTextAnchor("{VAL}","middle_bottom").rotateRightFacingSymbol("down").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_left").build(),{paths:I1t,texts:nZt,bounds:vb,refblocks:lY,circles:N1t}=n2,pU=_t({primitives:[...Object.values(I1t),...Object.values(N1t),{type:"text",text:"{REF}",x:-1118e-7,y:-.18},{type:"text",text:"{VAL}",x:1118e-7,y:.2738453}],ports:[{...lY.left1,labels:["1"]},{...lY.right1,labels:["2"]}],size:{width:vb.width,height:vb.height},center:{x:vb.centerX,y:vb.centerY}}).changeTextAnchor("{VAL}","middle_bottom").rotateRightFacingSymbol("left").labelPort("left1",["2"]).labelPort("right1",["1"]).changeTextAnchor("{REF}","middle_bottom").build(),{paths:A1t,texts:iZt,bounds:Sb,refblocks:uY,circles:R1t}=n2,O1t=_t({primitives:[...Object.values(A1t),...Object.values(R1t),{type:"text",text:"{REF}",x:-.0050250999999996715,y:.27384529999999985,anchor:"middle_left"},{type:"text",text:"{VAL}",x:-.00011179999999999524,y:-.27384530000000007,anchor:"middle_left"}],ports:[{...uY.left1,labels:["1"]},{...uY.right1,labels:["2"]}],size:{width:Sb.width,height:Sb.height},center:{x:Sb.centerX,y:Sb.centerY}}).changeTextAnchor("{VAL}","middle_top").labelPort("right1",["2"]).labelPort("left1",["1"]).changeTextAnchor("{REF}","middle_bottom").build(),{paths:rZt,texts:sZt,bounds:oZt,refblocks:aZt,circles:cZt}=n2,sM=Lt(pU,"down"),oM=sM.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),aM=sM.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");oM.anchor="middle_left";aM.anchor="middle_left";oM.x=.25;oM.y+=.21;aM.y-=.21;aM.x=.25;L1t=sM;F1t={paths:{path43:{type:"path",points:[{x:-.06,y:.19},{x:-.06,y:-.12}],color:"primary",fill:!1},"path43-6":{type:"path",points:[{x:.02,y:.13},{x:.02,y:-.06}],color:"primary",fill:!1},path44:{type:"path",points:[{x:-.06,y:.03},{x:-.45,y:.03}],color:"primary",fill:!1},"path44-0":{type:"path",points:[{x:.45,y:.03},{x:.03,y:.03}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.03,y:.27},bottom1:{type:"text",text:"{VAL}",x:-.03,y:-.28}},refblocks:{left1:{x:-.45,y:.03},right1:{x:.45,y:.03}},bounds:{minX:-.47,maxX:.47,minY:-.38,maxY:.27,width:.95,height:.29,centerX:0,centerY:.06},circles:{}},{paths:z1t,texts:pY,bounds:wb,refblocks:hY,circles:$1t}=F1t,hU=en({primitives:[...Object.values(z1t),...Object.values($1t),{...pY.top1,anchor:"middle_bottom"},{...pY.bottom1,anchor:"middle_top"}],ports:[{...hY.left1,labels:["1"]},{...hY.right1,labels:["2"]}],size:{width:wb.width,height:wb.height},center:{x:wb.centerX,y:wb.centerY}}),D1t=rM(hU,{newOrientation:"up"}),i2={paths:{path1:{type:"path",points:[{x:-.53,y:.05},{x:-.25,y:.05}],color:"primary",fill:!1},path2:{type:"path",points:[{x:.28,y:.05},{x:.57,y:.05}],color:"primary",fill:!1},path3:{type:"path",points:[{x:.02,y:.18},{x:.28,y:.18},{x:.28,y:-.09},{x:-.25,y:-.09},{x:-.25,y:.18},{x:.02,y:.18}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:0,y:.25},bottom1:{type:"text",text:"{VAL}",x:0,y:-.25}},refblocks:{left1:{x:-.53,y:.05},right1:{x:.57,y:.05}},bounds:{minX:-.56,maxX:.56,minY:-.25,maxY:.25,width:1.12,height:.5,centerX:0,centerY:0},circles:{}},{paths:j1t,texts:lZt,bounds:dY,refblocks:fY,circles:B1t}=i2,Y1t=_t({primitives:[...Object.values(j1t),...Object.values(B1t),{type:"text",text:"{REF}",x:-.16,y:.2294553499999995},{type:"text",text:"{VAL}",x:.16,y:.2294553499999995}],ports:[{...fY.left1,labels:["1"]},{...fY.right1,labels:["2"]}],center:{x:dY.centerX,y:dY.centerY}}).changeTextAnchor("{VAL}","middle_bottom").rotateRightFacingSymbol("down").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_left").build(),{paths:X1t,texts:uZt,bounds:mY,refblocks:_Y,circles:U1t}=i2,V1t=_t({primitives:[...Object.values(X1t),...Object.values(U1t),{type:"text",text:"{REF}",x:0,y:-.1994553499999995},{type:"text",text:"{VAL}",x:0,y:.2694553499999995}],ports:[{..._Y.left1,labels:["1"]},{..._Y.right1,labels:["2"]}],center:{x:mY.centerX,y:mY.centerY}}).changeTextAnchor("{VAL}","middle_bottom").rotateRightFacingSymbol("left").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_bottom").build(),{paths:G1t,texts:pZt,bounds:yY,refblocks:gY,circles:H1t}=i2,W1t=_t({primitives:[...Object.values(G1t),...Object.values(H1t),{type:"text",text:"{REF}",x:0,y:.2294553499999995},{type:"text",text:"{VAL}",x:0,y:-.1594553499999995}],ports:[{...gY.left1,labels:["1"]},{...gY.right1,labels:["2"]}],center:{x:yY.centerX,y:yY.centerY}}).changeTextAnchor("{VAL}","middle_top").rotateRightFacingSymbol("right").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_bottom").build(),r2={paths:{path2:{type:"path",points:[{x:.15,y:-.01},{x:.55,y:-.01}],color:"primary",fill:!0},"path2-5":{type:"path",points:[{x:-.15,y:.06},{x:.14,y:.06}],color:"primary",fill:!0},"path2-5-1":{type:"path",points:[{x:.14,y:.06},{x:.14,y:-.08}],color:"primary",fill:!0},"path2-5-1-6":{type:"path",points:[{x:-.16,y:.06},{x:-.16,y:-.08}],color:"primary",fill:!0},"path2-5-4":{type:"path",points:[{x:-.15,y:-.08},{x:.14,y:-.08}],color:"primary",fill:!0},"path2-9":{type:"path",points:[{x:-.55,y:-.01},{x:-.17,y:-.01}],color:"primary",fill:!0}},texts:{top1:{type:"text",text:"{REF}",x:-.01,y:.17},bottom1:{type:"text",text:"{VAL}",x:0,y:-.17}},refblocks:{left1:{x:-.55,y:-.01},right1:{x:.55,y:-.01}},bounds:{minX:-.58,maxX:.58,minY:-.17,maxY:.17,width:1.16,height:.35,centerX:0,centerY:0},circles:{}},{paths:q1t,texts:hZt,bounds:Pb,refblocks:xY,circles:Z1t}=r2,K1t=_t({primitives:[...Object.values(q1t),...Object.values(Z1t),{type:"text",text:"{REF}",x:-.2,y:.1404553499999995},{type:"text",text:"{VAL}",x:.2,y:.1494553499999995}],ports:[{...xY.left1,labels:["1"]},{...xY.right1,labels:["2"]}],size:{width:Pb.width,height:Pb.height},center:{x:Pb.centerX,y:Pb.centerY}}).rotateRightFacingSymbol("down").labelPort("left",["1"]).labelPort("right",["2"]).changeTextAnchor("{REF}","middle_left").changeTextAnchor("{VAL}","middle_left").build(),{paths:J1t,texts:dZt,bounds:kb,refblocks:bY,circles:Q1t}=r2,t0t=_t({primitives:[...Object.values(J1t),...Object.values(Q1t),{type:"text",text:"{REF}",x:0,y:-.2294553499999995},{type:"text",text:"{VAL}",x:0,y:.1704553499999995}],ports:[{...bY.left1,labels:["1"]},{...bY.right1,labels:["2"]}],size:{width:kb.width,height:kb.height},center:{x:kb.centerX,y:kb.centerY}}).rotateRightFacingSymbol("left").labelPort("left",["1"]).labelPort("right",["2"]).changeTextAnchor("{REF}","middle_bottom").changeTextAnchor("{VAL}","middle_top").build(),{paths:e0t,texts:fZt,bounds:Tb,refblocks:vY,circles:n0t}=r2,i0t=_t({primitives:[...Object.values(e0t),...Object.values(n0t),{type:"text",text:"{REF}",x:0,y:.2294553499999995},{type:"text",text:"{VAL}",x:0,y:-.1704553499999995}],ports:[{...vY.left1,labels:["1"]},{...vY.right1,labels:["2"]}],size:{width:Tb.width,height:Tb.height},center:{x:Tb.centerX,y:Tb.centerY}}).rotateRightFacingSymbol("right").labelPort("left",["1"]).labelPort("right",["2"]).changeTextAnchor("{REF}","middle_bottom").changeTextAnchor("{VAL}","middle_top").build(),{paths:r0t,texts:mZt,bounds:Eb,refblocks:SY,circles:s0t}=r2,o0t=_t({primitives:[...Object.values(r0t),...Object.values(s0t),{type:"text",text:"{REF}",x:.2,y:-.1404553499999995},{type:"text",text:"{VAL}",x:-.2,y:-.1494553499999995}],ports:[{...SY.left1,labels:["1"]},{...SY.right1,labels:["2"]}],size:{width:Eb.width,height:Eb.height},center:{x:Eb.centerX,y:Eb.centerY}}).rotateRightFacingSymbol("up").labelPort("left",["1"]).labelPort("right",["2"]).changeTextAnchor("{REF}","middle_left").changeTextAnchor("{VAL}","middle_left").build(),{paths:a0t,texts:_Zt,bounds:wY,refblocks:PY,circles:c0t}=i2,l0t=_t({primitives:[...Object.values(a0t),...Object.values(c0t),{type:"text",text:"{REF}",x:.16,y:-.2294553499999995},{type:"text",text:"{VAL}",x:-.16,y:-.2294553499999995}],ports:[{...PY.left1,labels:["1"]},{...PY.right1,labels:["2"]}],center:{x:wY.centerX,y:wY.centerY}}).changeTextAnchor("{VAL}","middle_top").rotateRightFacingSymbol("up").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_left").build(),cM={paths:{"horizontal-bar":{type:"path",points:[{x:-.4,y:0},{x:.4,y:0}],color:"primary",fill:!1},"middle-dash-1":{type:"path",points:[{x:0,y:.2},{x:0,y:.07}],color:"primary",fill:!1},"middle-dash-2":{type:"path",points:[{x:0,y:.01},{x:0,y:-.12}],color:"primary",fill:!1},"middle-dash-3":{type:"path",points:[{x:0,y:-.18},{x:0,y:-.31}],color:"primary",fill:!1},"left-vertical":{type:"path",points:[{x:-.25,y:0},{x:-.25,y:-.2}],color:"primary",fill:!1},"right-vertical":{type:"path",points:[{x:.25,y:0},{x:.25,y:-.2}],color:"primary",fill:!1},"left-ground":{type:"path",points:[{x:-.3,y:-.2},{x:-.25,y:-.3},{x:-.2,y:-.2},{x:-.3,y:-.2}],color:"primary",fill:!1},"right-ground":{type:"path",points:[{x:.2,y:-.2},{x:.25,y:-.3},{x:.3,y:-.2},{x:.2,y:-.2}],color:"primary",fill:!1}},refblocks:{left1:{x:-.4,y:0},right1:{x:.4,y:0}},texts:{ref:{type:"text",text:"{REF}",x:0,y:.35}},bounds:{minX:-.4,maxX:.4,minY:-.4,maxY:.35,width:.8,height:.75,centerX:0,centerY:-.02},circles:{}},{paths:u0t,texts:yZt,bounds:kY,refblocks:TY,circles:p0t}=cM,h0t=_t({primitives:[...Object.values(u0t),...Object.values(p0t),{type:"text",text:"{REF}",x:0,y:.2594553499999995}],ports:[{...TY.left1,labels:["1"]},{...TY.right1,labels:["2"]}],center:{x:kY.centerX,y:kY.centerY}}).changeTextAnchor("{VAL}","middle_bottom").rotateRightFacingSymbol("down").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_left").build(),{paths:d0t,texts:gZt,bounds:EY,refblocks:MY,circles:f0t}=cM,dU=_t({primitives:[...Object.values(d0t),...Object.values(f0t),{type:"text",text:"{REF}",x:0,y:.2594553499999995}],ports:[{...MY.left1,labels:["1"]},{...MY.right1,labels:["2"]}],center:{x:EY.centerX,y:EY.centerY}}).rotateRightFacingSymbol("right").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_bottom").build(),m0t=pg(dU),{paths:_0t,texts:xZt,bounds:CY,refblocks:IY,circles:y0t}=cM,g0t=_t({primitives:[...Object.values(_0t),...Object.values(y0t),{type:"text",text:"{REF}",x:0,y:.2594553499999995}],ports:[{...IY.left1,labels:["1"]},{...IY.right1,labels:["2"]}],center:{x:CY.centerX,y:CY.centerY}}).rotateRightFacingSymbol("up").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_right").build(),s2={paths:{path27:{type:"path",points:[{x:.55,y:.02},{x:.07,y:.02}],color:"primary",fill:!1},path28:{type:"path",points:[{x:-.09,y:.02},{x:-.55,y:.02}],color:"primary",fill:!1},path29:{type:"path",points:[{x:.07,y:.28},{x:.07,y:-.25}],color:"primary",fill:!1},path30:{type:"path",points:[{x:-.09,y:.28},{x:-.09,y:-.25}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.01,y:.42},bottom1:{type:"text",text:"{VAL}",x:0,y:-.42}},refblocks:{left1:{x:-.55,y:.02},right1:{x:.55,y:.02}},bounds:{minX:-.58,maxX:.58,minY:-.42,maxY:.42,width:1.16,height:.84,centerX:0,centerY:0},circles:{}},{paths:x0t,texts:bZt,bounds:Mb,refblocks:NY,circles:b0t}=s2,v0t=_t({primitives:[...Object.values(x0t),...Object.values(b0t),{type:"text",text:"{REF}",x:-.2,y:.115},{type:"text",text:"{VAL}",x:.2,y:.115}],ports:[{...NY.left1,labels:["1"]},{...NY.right1,labels:["2"]}],size:{width:Mb.width,height:Mb.height},center:{x:Mb.centerX,y:Mb.centerY}}).changeTextAnchor("{VAL}","top_left").rotateRightFacingSymbol("down").labelPort("left1",["1","pos"]).labelPort("right1",["2","neg"]).changeTextAnchor("{REF}","bottom_left").build(),S0t=_t(s2).changeTextAnchor("{VAL}","middle_top").rotateRightFacingSymbol("right").labelPort("left1",["2","neg"]).labelPort("right1",["1","pos"]).changeTextAnchor("{REF}","middle_bottom").build(),o2={paths:{"path27-5":{type:"path",points:[{x:.45,y:.02},{x:0,y:.02}],color:"primary",fill:!1},"path28-5":{type:"path",points:[{x:-.09,y:.02},{x:-.54,y:.02}],color:"primary",fill:!1},"path30-7":{type:"path",points:[{x:0,y:.28},{x:0,y:-.25}],color:"primary",fill:!1},path8704:{type:"path",points:[{x:-.14,y:-.24},{x:-.14,y:-.24},{x:-.14,y:-.24},{x:-.14,y:-.24},{x:-.14,y:-.24},{x:-.14,y:-.24},{x:-.14,y:-.24},{x:-.14,y:-.24},{x:-.14,y:-.24},{x:-.14,y:-.23},{x:-.14,y:-.23},{x:-.14,y:-.23},{x:-.14,y:-.23},{x:-.13,y:-.23},{x:-.13,y:-.23},{x:-.13,y:-.23},{x:-.13,y:-.23},{x:-.13,y:-.22},{x:-.13,y:-.22},{x:-.13,y:-.22},{x:-.13,y:-.22},{x:-.13,y:-.22},{x:-.13,y:-.22},{x:-.13,y:-.22},{x:-.13,y:-.22},{x:-.13,y:-.21},{x:-.13,y:-.21},{x:-.13,y:-.21},{x:-.12,y:-.21},{x:-.12,y:-.21},{x:-.12,y:-.21},{x:-.12,y:-.21},{x:-.12,y:-.21},{x:-.12,y:-.2},{x:-.12,y:-.2},{x:-.12,y:-.2},{x:-.12,y:-.2},{x:-.12,y:-.2},{x:-.12,y:-.2},{x:-.12,y:-.2},{x:-.12,y:-.2},{x:-.12,y:-.19},{x:-.12,y:-.19},{x:-.12,y:-.19},{x:-.12,y:-.19},{x:-.11,y:-.19},{x:-.11,y:-.19},{x:-.11,y:-.19},{x:-.11,y:-.18},{x:-.11,y:-.18},{x:-.11,y:-.18},{x:-.11,y:-.18},{x:-.11,y:-.18},{x:-.11,y:-.18},{x:-.11,y:-.18},{x:-.11,y:-.18},{x:-.11,y:-.17},{x:-.11,y:-.17},{x:-.11,y:-.17},{x:-.11,y:-.17},{x:-.11,y:-.17},{x:-.11,y:-.17},{x:-.11,y:-.17},{x:-.11,y:-.17},{x:-.1,y:-.16},{x:-.1,y:-.16},{x:-.1,y:-.16},{x:-.1,y:-.16},{x:-.1,y:-.16},{x:-.1,y:-.16},{x:-.1,y:-.16},{x:-.1,y:-.16},{x:-.1,y:-.15},{x:-.1,y:-.15},{x:-.1,y:-.15},{x:-.1,y:-.15},{x:-.1,y:-.15},{x:-.1,y:-.15},{x:-.1,y:-.15},{x:-.1,y:-.14},{x:-.1,y:-.14},{x:-.1,y:-.14},{x:-.1,y:-.14},{x:-.1,y:-.14},{x:-.1,y:-.14},{x:-.1,y:-.14},{x:-.09,y:-.14},{x:-.09,y:-.13},{x:-.09,y:-.13},{x:-.09,y:-.13},{x:-.09,y:-.13},{x:-.09,y:-.13},{x:-.09,y:-.13},{x:-.09,y:-.13},{x:-.09,y:-.13},{x:-.09,y:-.12},{x:-.09,y:-.12},{x:-.09,y:-.12},{x:-.09,y:-.12},{x:-.09,y:-.12},{x:-.09,y:-.12},{x:-.09,y:-.12},{x:-.09,y:-.12},{x:-.09,y:-.11},{x:-.09,y:-.11},{x:-.09,y:-.11},{x:-.09,y:-.11},{x:-.09,y:-.11},{x:-.09,y:-.11},{x:-.09,y:-.1},{x:-.09,y:-.1},{x:-.09,y:-.1},{x:-.09,y:-.1},{x:-.09,y:-.1},{x:-.09,y:-.1},{x:-.08,y:-.09},{x:-.08,y:-.09},{x:-.08,y:-.09},{x:-.08,y:-.09},{x:-.08,y:-.09},{x:-.08,y:-.09},{x:-.08,y:-.08},{x:-.08,y:-.08},{x:-.08,y:-.08},{x:-.08,y:-.08},{x:-.08,y:-.08},{x:-.08,y:-.08},{x:-.08,y:-.07},{x:-.08,y:-.07},{x:-.08,y:-.07},{x:-.08,y:-.07},{x:-.08,y:-.07},{x:-.08,y:-.07},{x:-.08,y:-.06},{x:-.08,y:-.06},{x:-.08,y:-.06},{x:-.08,y:-.06},{x:-.08,y:-.06},{x:-.08,y:-.05},{x:-.08,y:-.05},{x:-.08,y:-.05},{x:-.08,y:-.05},{x:-.08,y:-.05},{x:-.08,y:-.05},{x:-.08,y:-.04},{x:-.08,y:-.04},{x:-.08,y:-.04},{x:-.08,y:-.04},{x:-.08,y:-.04},{x:-.08,y:-.04},{x:-.08,y:-.03},{x:-.08,y:-.03},{x:-.08,y:-.03},{x:-.08,y:-.03},{x:-.08,y:-.03},{x:-.08,y:-.03},{x:-.08,y:-.02},{x:-.08,y:-.02},{x:-.08,y:-.02},{x:-.08,y:-.02},{x:-.08,y:-.02},{x:-.08,y:-.02},{x:-.08,y:-.01},{x:-.08,y:-.01},{x:-.08,y:-.01},{x:-.08,y:-.01},{x:-.08,y:-.01},{x:-.08,y:0},{x:-.08,y:0},{x:-.08,y:0},{x:-.08,y:0},{x:-.08,y:0},{x:-.08,y:0},{x:-.08,y:.01},{x:-.07,y:.01},{x:-.07,y:.01},{x:-.07,y:.01},{x:-.07,y:.01},{x:-.07,y:.01},{x:-.08,y:.02},{x:-.08,y:.02},{x:-.08,y:.02},{x:-.08,y:.02},{x:-.08,y:.02},{x:-.08,y:.02},{x:-.08,y:.03},{x:-.08,y:.03},{x:-.08,y:.03},{x:-.08,y:.03},{x:-.08,y:.03},{x:-.08,y:.03},{x:-.08,y:.04},{x:-.08,y:.04},{x:-.08,y:.04},{x:-.08,y:.04},{x:-.08,y:.04},{x:-.08,y:.05},{x:-.08,y:.05},{x:-.08,y:.05},{x:-.08,y:.05},{x:-.08,y:.05},{x:-.08,y:.05},{x:-.08,y:.06},{x:-.08,y:.06},{x:-.08,y:.06},{x:-.08,y:.06},{x:-.08,y:.06},{x:-.08,y:.06},{x:-.08,y:.06},{x:-.08,y:.06},{x:-.08,y:.07},{x:-.08,y:.07},{x:-.08,y:.07},{x:-.08,y:.07},{x:-.08,y:.07},{x:-.08,y:.07},{x:-.08,y:.07},{x:-.08,y:.08},{x:-.08,y:.08},{x:-.08,y:.08},{x:-.08,y:.08},{x:-.08,y:.08},{x:-.08,y:.08},{x:-.08,y:.09},{x:-.08,y:.09},{x:-.08,y:.09},{x:-.08,y:.09},{x:-.08,y:.09},{x:-.08,y:.09},{x:-.08,y:.09},{x:-.08,y:.1},{x:-.08,y:.1},{x:-.08,y:.1},{x:-.08,y:.1},{x:-.08,y:.1},{x:-.08,y:.1},{x:-.08,y:.1},{x:-.08,y:.11},{x:-.08,y:.11},{x:-.08,y:.11},{x:-.08,y:.11},{x:-.08,y:.11},{x:-.08,y:.11},{x:-.08,y:.11},{x:-.08,y:.12},{x:-.08,y:.12},{x:-.08,y:.12},{x:-.08,y:.12},{x:-.09,y:.12},{x:-.09,y:.12},{x:-.09,y:.12},{x:-.09,y:.13},{x:-.09,y:.13},{x:-.09,y:.13},{x:-.09,y:.13},{x:-.09,y:.13},{x:-.09,y:.13},{x:-.09,y:.14},{x:-.09,y:.14},{x:-.09,y:.14},{x:-.09,y:.14},{x:-.09,y:.14},{x:-.09,y:.14},{x:-.09,y:.14},{x:-.09,y:.15},{x:-.09,y:.15},{x:-.09,y:.15},{x:-.09,y:.15},{x:-.09,y:.15},{x:-.09,y:.15},{x:-.09,y:.15},{x:-.09,y:.16},{x:-.09,y:.16},{x:-.09,y:.16},{x:-.09,y:.16},{x:-.09,y:.16},{x:-.09,y:.16},{x:-.09,y:.16},{x:-.09,y:.17},{x:-.09,y:.17},{x:-.1,y:.17},{x:-.1,y:.17},{x:-.1,y:.17},{x:-.1,y:.17},{x:-.1,y:.17},{x:-.1,y:.18},{x:-.1,y:.18},{x:-.1,y:.18},{x:-.1,y:.18},{x:-.1,y:.18},{x:-.1,y:.18},{x:-.1,y:.18},{x:-.1,y:.19},{x:-.1,y:.19},{x:-.1,y:.19},{x:-.1,y:.19},{x:-.1,y:.19},{x:-.1,y:.19},{x:-.1,y:.19},{x:-.1,y:.2},{x:-.1,y:.2},{x:-.1,y:.2},{x:-.1,y:.2},{x:-.1,y:.2},{x:-.1,y:.2},{x:-.11,y:.2},{x:-.11,y:.2},{x:-.11,y:.2},{x:-.11,y:.21},{x:-.11,y:.21},{x:-.11,y:.21},{x:-.11,y:.21},{x:-.11,y:.21},{x:-.11,y:.21},{x:-.11,y:.21},{x:-.11,y:.21},{x:-.11,y:.21},{x:-.11,y:.21},{x:-.11,y:.21},{x:-.11,y:.21},{x:-.11,y:.21},{x:-.11,y:.22},{x:-.11,y:.22},{x:-.11,y:.22},{x:-.11,y:.22},{x:-.11,y:.22},{x:-.11,y:.22},{x:-.11,y:.22},{x:-.11,y:.22},{x:-.11,y:.22},{x:-.11,y:.22},{x:-.11,y:.22},{x:-.11,y:.22},{x:-.11,y:.23},{x:-.11,y:.23},{x:-.11,y:.23},{x:-.11,y:.23},{x:-.12,y:.23},{x:-.12,y:.23},{x:-.12,y:.23},{x:-.12,y:.23},{x:-.12,y:.23},{x:-.12,y:.23},{x:-.12,y:.23},{x:-.12,y:.23},{x:-.12,y:.24},{x:-.12,y:.24},{x:-.12,y:.24},{x:-.12,y:.24},{x:-.12,y:.24},{x:-.12,y:.24},{x:-.12,y:.24},{x:-.12,y:.24},{x:-.12,y:.24},{x:-.12,y:.24},{x:-.12,y:.24},{x:-.12,y:.24},{x:-.12,y:.25},{x:-.12,y:.25},{x:-.12,y:.25},{x:-.12,y:.25},{x:-.12,y:.25},{x:-.12,y:.25},{x:-.13,y:.25},{x:-.13,y:.25},{x:-.13,y:.25},{x:-.13,y:.25},{x:-.13,y:.25},{x:-.13,y:.25},{x:-.13,y:.25},{x:-.13,y:.26},{x:-.13,y:.26},{x:-.13,y:.26},{x:-.13,y:.26},{x:-.13,y:.26},{x:-.13,y:.26},{x:-.13,y:.26},{x:-.13,y:.26},{x:-.13,y:.26},{x:-.13,y:.26},{x:-.13,y:.26},{x:-.13,y:.26},{x:-.13,y:.26},{x:-.13,y:.27},{x:-.13,y:.27},{x:-.13,y:.27},{x:-.13,y:.27},{x:-.14,y:.27},{x:-.14,y:.27},{x:-.14,y:.27},{x:-.14,y:.27},{x:-.14,y:.27},{x:-.14,y:.27},{x:-.14,y:.27},{x:-.14,y:.27},{x:-.14,y:.27},{x:-.14,y:.28},{x:-.14,y:.28},{x:-.14,y:.28},{x:-.14,y:.28},{x:-.14,y:.28},{x:-.14,y:.28},{x:-.14,y:.28},{x:-.14,y:.28},{x:-.14,y:.28}],color:"primary",fill:!1},"rect1577-4":{type:"path",points:[{x:.26,y:.25},{x:.12,y:.25},{x:.12,y:.25},{x:.26,y:.25}],color:"primary",fill:!0},"rect1577-4-7":{type:"path",points:[{x:.2,y:.32},{x:.2,y:.18},{x:.19,y:.18},{x:.19,y:.32}],color:"primary",fill:!0}},texts:{top1:{type:"text",text:"{REF}",x:-.01,y:.42},bottom1:{type:"text",text:"{VAL}",x:0,y:-.42}},refblocks:{left1:{x:-.54,y:.02},right1:{x:.45,y:.02}},bounds:{minX:-.58,maxX:.58,minY:-.42,maxY:.42,width:1.16,height:.84,centerX:0,centerY:0},circles:{}},{paths:w0t,texts:vZt,bounds:Cb,refblocks:AY,circles:P0t}=o2,k0t=_t({primitives:[...Object.values(w0t),...Object.values(P0t),{type:"text",text:"{REF}",x:.1,y:-.2094553499999995},{type:"text",text:"{VAL}",x:-.2,y:-.2094553499999995}],ports:[{...AY.left1,labels:["2","neg"]},{...AY.right1,labels:["1","pos"]}],size:{width:Cb.width,height:Cb.height},center:{x:Cb.centerX,y:Cb.centerY}}).changeTextAnchor("{VAL}","top_left").rotateRightFacingSymbol("up").changeTextAnchor("{REF}","bottom_left").build(),T0t=_t(o2).changeTextAnchor("{VAL}","middle_top").labelPort("left1",["2","neg"]).labelPort("right1",["1","pos"]).changeTextAnchor("{REF}","middle_bottom").build(),{paths:E0t,texts:SZt,bounds:Ib,refblocks:RY,circles:M0t}=o2,C0t=_t({primitives:[...Object.values(E0t),...Object.values(M0t),{type:"text",text:"{REF}",x:0,y:-.4094553499999995},{type:"text",text:"{VAL}",x:-0,y:.4094553499999995}],ports:[{...RY.left1,labels:["2","neg"]},{...RY.right1,labels:["1","pos"]}],size:{width:Ib.width,height:Ib.height},center:{x:Ib.centerX,y:Ib.centerY}}).changeTextAnchor("{VAL}","middle_bottom").rotateRightFacingSymbol("left").changeTextAnchor("{REF}","middle_bottom").build(),{paths:I0t,texts:wZt,bounds:Nb,refblocks:OY,circles:N0t}=o2,A0t=_t({primitives:[...Object.values(I0t),...Object.values(N0t),{type:"text",text:"{REF}",x:-.2,y:.2094553499999995},{type:"text",text:"{VAL}",x:.3,y:.2094553499999995}],ports:[{...OY.left1,labels:["2","neg"]},{...OY.right1,labels:["1","pos"]}],size:{width:Nb.width,height:Nb.height},center:{x:Nb.centerX,y:Nb.centerY}}).changeTextAnchor("{VAL}","top_left").rotateRightFacingSymbol("down").changeTextAnchor("{REF}","bottom_left").build(),R0t=_t(s2).rotateRightFacingSymbol("right").changeTextAnchor("{VAL}","middle_top").labelPort("left1",["1","pos"]).labelPort("right1",["2","neg"]).changeTextAnchor("{REF}","middle_bottom").build(),{paths:O0t,texts:PZt,bounds:Ab,refblocks:LY,circles:L0t}=s2,F0t=_t({primitives:[...Object.values(O0t),...Object.values(L0t),{type:"text",text:"{REF}",x:.2,y:-.095},{type:"text",text:"{VAL}",x:-.2,y:-.095}],ports:[{...LY.left1,labels:["1"]},{...LY.right1,labels:["2"]}],size:{width:Ab.width,height:Ab.height},center:{x:Ab.centerX,y:Ab.centerY}}).changeTextAnchor("{VAL}","top_left").rotateRightFacingSymbol("up").labelPort("left1",["1","pos"]).labelPort("right1",["2","neg"]).changeTextAnchor("{REF}","bottom_left").build(),Xm={paths:{path11:{type:"path",points:[{x:-.54,y:.03},{x:-.3,y:.03}],color:"primary",fill:!1},path12:{type:"path",points:[{x:.29,y:.03},{x:.54,y:.03}],color:"primary",fill:!1},path2:{type:"path",points:[{x:.29,y:.29},{x:.29,y:-.23}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.02,y:.37},bottom1:{type:"text",text:"{VAL}",x:-.01,y:-.37}},refblocks:{left1:{x:-.54,y:.03},right1:{x:.54,y:.03}},bounds:{minX:-.57,maxX:.57,minY:-.37,maxY:.37,width:1.14,height:.74,centerX:0,centerY:0},circles:{path1:{type:"circle",x:0,y:.04,radius:.29,color:"primary",fill:!1}}},{paths:z0t,texts:kZt,bounds:Rb,refblocks:FY,circles:$0t}=Xm,D0t=_t({primitives:[...Object.values(z0t),...Object.values($0t),{type:"text",text:"{REF}",x:-.15,y:.3894553499999995},{type:"text",text:"{VAL}",x:.15,y:.3894553499999995}],ports:[{...FY.left1,labels:["1"]},{...FY.right1,labels:["2"]}],size:{width:Rb.width,height:Rb.height},center:{x:Rb.centerX,y:Rb.centerY}}).rotateRightFacingSymbol("down").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_left").changeTextAnchor("{VAL}","middle_left").build(),j0t=_t(Xm).changeTextAnchor("{VAL}","middle_top").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_bottom").build(),{paths:B0t,texts:TZt,bounds:Ob,refblocks:zY,circles:Y0t}=Xm,X0t=_t({primitives:[...Object.values(B0t),...Object.values(Y0t),{type:"text",text:"{REF}",x:-0,y:-.2894553499999995},{type:"text",text:"{VAL}",x:0,y:.3894553499999995}],ports:[{...zY.left1,labels:["1"]},{...zY.right1,labels:["2"]}],size:{width:Ob.width,height:Ob.height},center:{x:Ob.centerX,y:Ob.centerY}}).changeTextAnchor("{VAL}","middle_bottom").rotateRightFacingSymbol("left").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_bottom").build(),U0t=_t(Xm).changeTextAnchor("{VAL}","middle_top").labelPort("left1",["1","neg"]).labelPort("right1",["2","pos"]).changeTextAnchor("{REF}","middle_bottom").build(),{paths:V0t,texts:EZt,bounds:Lb,refblocks:$Y,circles:G0t}=Xm,H0t=_t({primitives:[...Object.values(V0t),...Object.values(G0t),{type:"text",text:"{REF}",x:.15,y:-.2894553499999995},{type:"text",text:"{VAL}",x:-.15,y:-.2894553499999995}],ports:[{...$Y.left1,labels:["1"]},{...$Y.right1,labels:["2"]}],size:{width:Lb.width,height:Lb.height},center:{x:Lb.centerX,y:Lb.centerY}}).rotateRightFacingSymbol("up").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_left").changeTextAnchor("{VAL}","middle_left").build(),{paths:W0t,texts:MZt,bounds:Fb,refblocks:DY,circles:q0t}=Xm,Z0t=_t({primitives:[...Object.values(W0t),...Object.values(q0t),{type:"text",text:"{REF}",x:.15,y:-.2894553499999995},{type:"text",text:"{VAL}",x:-.15,y:-.2894553499999995}],ports:[{...DY.left1,labels:["1"]},{...DY.right1,labels:["2"]}],size:{width:Fb.width,height:Fb.height},center:{x:Fb.centerX,y:Fb.centerY}}).rotateRightFacingSymbol("up").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_left").changeTextAnchor("{VAL}","middle_left").build(),a2={paths:{path27:{type:"path",points:[{x:.54,y:-.01},{x:.13,y:-.01}],color:"primary",fill:!1},path29:{type:"path",points:[{x:.13,y:.25},{x:.13,y:-.27}],color:"primary",fill:!1},"path29-2":{type:"path",points:[{x:.07,y:.25},{x:.07,y:-.28}],color:"primary",fill:!1},path30:{type:"path",points:[{x:-.14,y:.25},{x:-.14,y:-.27}],color:"primary",fill:!1},"path29-5":{type:"path",points:[{x:-.08,y:.26},{x:-.08,y:-.27}],color:"primary",fill:!1},"path29-2-7":{type:"path",points:[{x:.07,y:.26},{x:-.08,y:.26}],color:"primary",fill:!1},"path29-2-7-6":{type:"path",points:[{x:.07,y:-.28},{x:-.08,y:-.28}],color:"primary",fill:!1},path43:{type:"path",points:[{x:-.21,y:.32},{x:.2,y:.32}],color:"primary",fill:!1},"path44-0":{type:"path",points:[{x:0,y:.71},{x:0,y:.33},{x:0,y:.32}],color:"primary",fill:!1},"path43-8":{type:"path",points:[{x:-.21,y:.32},{x:-.21,y:.25}],color:"primary",fill:!1},"path43-8-8":{type:"path",points:[{x:.2,y:.32},{x:.2,y:.25}],color:"primary",fill:!1},"path43-9":{type:"path",points:[{x:.19,y:-.35},{x:-.22,y:-.35}],color:"primary",fill:!1},"path44-0-5":{type:"path",points:[{x:-.02,y:-.71},{x:-.02,y:-.36},{x:-.02,y:-.35}],color:"primary",fill:!1},"path43-8-1":{type:"path",points:[{x:.19,y:-.35},{x:.19,y:-.28}],color:"primary",fill:!1},"path43-8-8-9":{type:"path",points:[{x:-.22,y:-.35},{x:-.22,y:-.28}],color:"primary",fill:!1},path28:{type:"path",points:[{x:-.14,y:-.01},{x:-.54,y:-.01}],color:"primary",fill:!1}},texts:{left1:{type:"text",text:"{REF}",x:.53,y:.28},right1:{type:"text",text:"{VAL}",x:.54,y:-.28}},refblocks:{top1:{x:0,y:.71},bottom1:{x:-.02,y:-.71},left1:{x:-.54,y:-.01},right1:{x:.54,y:-.01}},bounds:{minX:-.57,maxX:.57,minY:-.74,maxY:.74,width:1.14,height:1.48,centerX:0,centerY:0},circles:{}},{paths:K0t,texts:CZt,bounds:zb,refblocks:$b,circles:J0t}=a2,Q0t=_t({primitives:[...Object.values(K0t),...Object.values(J0t),{type:"text",text:"{REF}",x:-.4,y:.4094554499999995},{type:"text",text:"{VAL}",x:.4,y:.4094553499999995}],ports:[{...$b.left1,labels:["1"]},{...$b.right1,labels:["3"]},{...$b.bottom1,labels:["2"]},{...$b.top1,labels:["4"]}],size:{width:zb.width,height:zb.height},center:{x:zb.centerX,y:zb.centerY}}).rotateRightFacingSymbol("down").changeTextAnchor("{REF}","bottom_left").changeTextAnchor("{VAL}","top_left").build(),txt=_t(a2).labelPort("top1",["2","gnd1"]).labelPort("bottom1",["4","gnd2"]).labelPort("left1",["3"]).labelPort("right1",["1"]).changeTextAnchor("{REF}","bottom_left").changeTextAnchor("{VAL}","top_left").build(),ext=_t(a2).labelPort("top1",["4","gnd1"]).labelPort("bottom1",["2","gnd2"]).labelPort("left1",["1"]).labelPort("right1",["3"]).changeTextAnchor("{REF}","bottom_left").changeTextAnchor("{VAL}","top_left").build(),{paths:nxt,texts:IZt,bounds:Db,refblocks:jb,circles:ixt}=a2,rxt=_t({primitives:[...Object.values(nxt),...Object.values(ixt),{type:"text",text:"{VAL}",x:-.4,y:-.4094554499999995},{type:"text",text:"{REF}",x:.4,y:-.4094553499999995}],ports:[{...jb.left1,labels:["1"]},{...jb.right1,labels:["3"]},{...jb.bottom1,labels:["2"]},{...jb.top1,labels:["4"]}],size:{width:Db.width,height:Db.height},center:{x:Db.centerX,y:Db.centerY}}).rotateRightFacingSymbol("up").changeTextAnchor("{REF}","bottom_left").changeTextAnchor("{VAL}","top_left").build(),c2={paths:{path27:{type:"path",points:[{x:.55,y:-.01},{x:.13,y:-.01}],color:"primary",fill:!1},path28:{type:"path",points:[{x:-.14,y:-.01},{x:-.55,y:-.01}],color:"primary",fill:!1},path29:{type:"path",points:[{x:.13,y:-.28},{x:.13,y:.25}],color:"primary",fill:!1},"path29-2":{type:"path",points:[{x:.07,y:-.28},{x:.07,y:.25}],color:"primary",fill:!1},path30:{type:"path",points:[{x:-.14,y:-.28},{x:-.14,y:.25}],color:"primary",fill:!1},"path29-5":{type:"path",points:[{x:-.08,y:-.28},{x:-.08,y:.25}],color:"primary",fill:!1},"path29-2-7":{type:"path",points:[{x:.07,y:-.28},{x:-.08,y:-.28}],color:"primary",fill:!1},"path29-2-7-6":{type:"path",points:[{x:.07,y:.26},{x:-.08,y:.26}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{VAL}",x:-.01,y:-.42},bottom1:{type:"text",text:"{REF}",x:0,y:.43}},refblocks:{left1:{x:-.55,y:-.01},right1:{x:.55,y:-.01}},bounds:{minX:-.58,maxX:.58,minY:-.52,maxY:.43,width:1.16,height:1,centerX:0,centerY:-.04},circles:{}},{paths:sxt,texts:NZt,bounds:Bb,refblocks:jY,circles:oxt}=c2,axt=_t({primitives:[...Object.values(sxt),...Object.values(oxt),{type:"text",text:"{REF}",x:-.3,y:.3094553499999995},{type:"text",text:"{VAL}",x:.3,y:.3094553499999995}],ports:[{...jY.left1,labels:["1"]},{...jY.right1,labels:["2"]}],size:{width:Bb.width,height:Bb.height},center:{x:Bb.centerX,y:Bb.centerY}}).changeTextAnchor("{VAL}","top_left").rotateRightFacingSymbol("down").labelPort("left1",["1","pos"]).labelPort("right1",["2","neg"]).changeTextAnchor("{REF}","bottom_left").build(),cxt=_t(c2).changeTextAnchor("{VAL}","middle_top").rotateRightFacingSymbol("right").labelPort("left1",["2","neg"]).labelPort("right1",["1","pos"]).changeTextAnchor("{REF}","middle_bottom").build(),lxt=_t(c2).changeTextAnchor("{VAL}","middle_top").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_bottom").build(),{paths:uxt,texts:AZt,bounds:Yb,refblocks:BY,circles:pxt}=c2,hxt=_t({primitives:[...Object.values(uxt),...Object.values(pxt),{type:"text",text:"{REF}",x:.3,y:-.3094553499999995},{type:"text",text:"{VAL}",x:-.3,y:-.3094553499999995}],ports:[{...BY.left1,labels:["1"]},{...BY.right1,labels:["2"]}],size:{width:Yb.width,height:Yb.height},center:{x:Yb.centerX,y:Yb.centerY}}).changeTextAnchor("{VAL}","middle_top").rotateRightFacingSymbol("up").labelPort("left1",["1","pos"]).labelPort("right1",["2","neg"]).changeTextAnchor("{REF}","bottom_left").build(),Um={paths:{path11:{type:"path",points:[{x:1.99,y:-1.64},{x:2.1,y:-1.64}],color:"primary",fill:!1},"path40-0":{type:"path",points:[{x:2.1,y:-1.48},{x:2.1,y:-1.8}],color:"primary",fill:!1},"path40-0-5":{type:"path",points:[{x:2.22,y:-1.5},{x:2.11,y:-1.58}],color:"primary",fill:!1},"path40-0-5-0":{type:"path",points:[{x:2.23,y:-1.78},{x:2.11,y:-1.7}],color:"primary",fill:!1},"path12-1-5":{type:"path",points:[{x:2.23,y:-1.49},{x:2.23,y:-1.14}],color:"primary",fill:!1},"path12-1-5-3":{type:"path",points:[{x:2.23,y:-1.97},{x:2.23,y:-1.79}],color:"primary",fill:!1},"arrow-2":{type:"path",points:[{x:2.17,y:-1.7},{x:2.13,y:-1.76},{x:2.19,y:-1.76},{x:2.17,y:-1.7}],color:"primary",fill:!0},path1:{type:"path",points:[{x:1.6,y:-1.5},{x:1.86,y:-1.5}],color:"primary",fill:!1},path2:{type:"path",points:[{x:1.87,y:-1.34},{x:1.87,y:-1.66}],color:"primary",fill:!1},path3:{type:"path",points:[{x:1.99,y:-1.36},{x:1.87,y:-1.44}],color:"primary",fill:!1},path4:{type:"path",points:[{x:1.99,y:-1.64},{x:1.88,y:-1.56}],color:"primary",fill:!1},"arrow-1":{type:"path",points:[{x:1.94,y:-1.56},{x:1.89,y:-1.62},{x:1.96,y:-1.62},{x:1.94,y:-1.56}],color:"primary",fill:!0},path9:{type:"path",points:[{x:1.99,y:-1.35},{x:2.23,y:-1.36}],color:"primary",fill:!1}},texts:{bottom1:{type:"text",text:"{VAL}",x:1.88,y:-1.94},right1:{type:"text",text:"{REF}",x:1.88,y:-1.14}},refblocks:{right1:{x:2.23,y:-1.97},right2:{x:1.6,y:-1.5},right3:{x:2.23,y:-1.14}},bounds:{minX:1.58,maxX:2.35,minY:-1.98,maxY:-1.12,width:.77,height:.86,centerX:1.96,centerY:-1.55},circles:{"path1-0":{type:"circle",x:2.05,y:-1.54,radius:.3,color:"primary",fill:!1}}},dxt=_t(Um).rotateRightFacingSymbol("down").labelPort("right2",["1"]).labelPort("right1",["2"]).labelPort("right3",["3"]).changeTextAnchor("{VAL}","middle_left",{x:.8,y:-.15}).changeTextAnchor("{REF}","middle_left",{x:0,y:.15}).build(),fxt=_t(Um).rotateRightFacingSymbol("right").labelPort("right2",["1"]).labelPort("right1",["2"]).labelPort("right3",["3"]).changeTextAnchor("{VAL}","middle_right").changeTextAnchor("{REF}","middle_right").build(),mxt=_t(Um).rotateRightFacingSymbol("left").labelPort("right2",["1"]).labelPort("right1",["2"]).labelPort("right3",["3"]).changeTextAnchor("{VAL}","middle_left",{x:0,y:-.8}).changeTextAnchor("{REF}","middle_left",{x:0,y:.8}).build(),_xt=_t(Um).rotateRightFacingSymbol("right").labelPort("right2",["1"]).labelPort("right1",["2"]).labelPort("right3",["3"]).changeTextAnchor("{VAL}","middle_right").changeTextAnchor("{REF}","middle_right").build(),yxt=_t(Um).rotateRightFacingSymbol("up").labelPort("right2",["1"]).labelPort("right1",["2"]).labelPort("right3",["3"]).changeTextAnchor("{VAL}","middle_left",{x:0,y:-.15}).changeTextAnchor("{REF}","middle_left",{x:.8,y:.15}).build(),gxt=_t(Um).rotateRightFacingSymbol("up").labelPort("right2",["1"]).labelPort("right1",["2"]).labelPort("right3",["3"]).changeTextAnchor("{VAL}","middle_left",{x:0,y:-.15}).changeTextAnchor("{REF}","middle_left",{x:.8,y:.15}).build(),xxt={paths:{path11:{type:"path",points:[{x:-.54,y:0},{x:-.3,y:0}],color:"primary",fill:!1},path12:{type:"path",points:[{x:.29,y:0},{x:.54,y:0}],color:"primary",fill:!1},path2:{type:"path",points:[{x:-.12,y:.09},{x:.12,y:.09}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.18,y:-.45},bottom1:{type:"text",text:"{VAL}",x:-.01,y:.35},left1:{type:"text",text:"A",x:0,y:-.1}},refblocks:{left1:{x:-.54,y:0},right1:{x:.54,y:0}},bounds:{minX:-.53,maxX:.53,minY:-.09,maxY:.09,width:1.06,height:1,centerX:0,centerY:0},circles:{path1:{type:"circle",x:0,y:0,radius:.29,color:"primary",fill:!1}}},{paths:bxt,texts:vxt,bounds:Xb,refblocks:YY,circles:Sxt}=xxt,lM=en({primitives:[...Object.values(bxt),...Object.values(Sxt),{type:"text",text:"{REF}",x:0,y:-.3594553499999995,anchor:"middle_top"},{type:"text",text:"{VAL}",x:0,y:.35,anchor:"middle_bottom"},{...vxt.left1,x:0,y:.01,anchor:"center",fontSize:.3}],ports:[{...YY.left1,labels:["1"]},{...YY.right1,labels:["2"]}],size:{width:Xb.width,height:Xb.height},center:{x:Xb.centerX,y:Xb.centerY}});({6:eM,2:nM,...kxt}=lM.primitives);wxt(nM)&&nM.points.map(n=>{n.y+=.05});Pxt(eM)&&(eM.y+=.025);XY=Lt({...lM,primitives:Object.values(kxt).filter(Txt)}),Ext={...XY,primitives:[...XY.primitives,eM,nM]},Vm={paths:{path11:{type:"path",points:[{x:-.54,y:.03},{x:-.3,y:.04}],color:"primary",fill:!1},path12:{type:"path",points:[{x:.29,y:.04},{x:.54,y:.04}],color:"primary",fill:!1},"path11-5-5":{type:"path",points:[{x:.1,y:.13},{x:0,y:-.06},{x:-.11,y:.13}],color:"primary",fill:!1},path2:{type:"path",points:[{x:-.12,y:-.14},{x:.12,y:-.14}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.17,y:.4},bottom1:{type:"text",text:"{VAL}",x:-.01,y:-.4}},refblocks:{left1:{x:-.54,y:.03},right1:{x:.54,y:.04}},bounds:{minX:-.57,maxX:.57,minY:-.4,maxY:.4,width:1.14,height:.79,centerX:0,centerY:0},circles:{path1:{type:"circle",x:0,y:.04,radius:.29,color:"primary",fill:!1}}},{paths:Mxt,texts:RZt,bounds:Ub,refblocks:UY,circles:Cxt}=Vm,Ixt=_t({primitives:[...Object.values(Mxt),...Object.values(Cxt),{type:"text",text:"{REF}",x:-.15,y:.3894553499999995},{type:"text",text:"{VAL}",x:.15,y:.3894553499999995}],ports:[{...UY.left1,labels:["1"]},{...UY.right1,labels:["2"]}],size:{width:Ub.width,height:Ub.height},center:{x:Ub.centerX,y:Ub.centerY}}).rotateRightFacingSymbol("down").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_left").changeTextAnchor("{VAL}","middle_left").build(),{paths:Nxt,texts:OZt,bounds:Vb,refblocks:VY,circles:Axt}=Vm,Rxt=_t({primitives:[...Object.values(Nxt),...Object.values(Axt),{type:"text",text:"{REF}",x:-0,y:.3894553499999995},{type:"text",text:"{VAL}",x:0,y:-.3294553499999995}],ports:[{...VY.left1,labels:["1"]},{...VY.right1,labels:["2"]}],size:{width:Vb.width,height:Vb.height},center:{x:Vb.centerX,y:Vb.centerY}}).changeTextAnchor("{VAL}","middle_top").rotateRightFacingSymbol("right").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_bottom").build(),{paths:Oxt,texts:LZt,bounds:Gb,refblocks:GY,circles:Lxt}=Vm,Fxt=_t({primitives:[...Object.values(Oxt),...Object.values(Lxt),{type:"text",text:"{REF}",x:-0,y:-.3294553499999995},{type:"text",text:"{VAL}",x:0,y:.4294553499999995}],ports:[{...GY.left1,labels:["1"]},{...GY.right1,labels:["2"]}],size:{width:Gb.width,height:Gb.height},center:{x:Gb.centerX,y:Gb.centerY}}).changeTextAnchor("{VAL}","middle_bottom").rotateRightFacingSymbol("left").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_bottom").build(),{paths:zxt,texts:FZt,bounds:Hb,refblocks:HY,circles:$xt}=Vm,Dxt=_t({primitives:[...Object.values(zxt),...Object.values($xt),{type:"text",text:"{REF}",x:-0,y:.3894553499999995},{type:"text",text:"{VAL}",x:0,y:-.3294553499999995}],ports:[{...HY.left1,labels:["1"]},{...HY.right1,labels:["2"]}],size:{width:Hb.width,height:Hb.height},center:{x:Hb.centerX,y:Hb.centerY}}).changeTextAnchor("{VAL}","middle_top").rotateRightFacingSymbol("right").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_bottom").build(),{paths:jxt,texts:zZt,bounds:Wb,refblocks:WY,circles:Bxt}=Vm,Yxt=_t({primitives:[...Object.values(jxt),...Object.values(Bxt),{type:"text",text:"{REF}",x:.15,y:-.2894553499999995},{type:"text",text:"{VAL}",x:-.15,y:-.2894553499999995}],ports:[{...WY.left1,labels:["1"]},{...WY.right1,labels:["2"]}],size:{width:Wb.width,height:Wb.height},center:{x:Wb.centerX,y:Wb.centerY}}).rotateRightFacingSymbol("up").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_left").changeTextAnchor("{VAL}","middle_left").build(),{paths:Xxt,texts:$Zt,bounds:qb,refblocks:qY,circles:Uxt}=Vm,Vxt=_t({primitives:[...Object.values(Xxt),...Object.values(Uxt),{type:"text",text:"{REF}",x:.15,y:-.2894553499999995},{type:"text",text:"{VAL}",x:-.15,y:-.2894553499999995}],ports:[{...qY.left1,labels:["1"]},{...qY.right1,labels:["2"]}],size:{width:qb.width,height:qb.height},center:{x:qb.centerX,y:qb.centerY}}).rotateRightFacingSymbol("up").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_left").changeTextAnchor("{VAL}","middle_left").build(),Gm={paths:{path11:{type:"path",points:[{x:-.54,y:.04},{x:-.11,y:.04}],color:"primary",fill:!1},path12:{type:"path",points:[{x:.1,y:.04},{x:.54,y:.04}],color:"primary",fill:!1},"path11-0":{type:"path",points:[{x:-.09,y:-.15},{x:-.09,y:.26}],color:"primary",fill:!1},"path11-0-3":{type:"path",points:[{x:.09,y:-.15},{x:.09,y:.26}],color:"primary",fill:!1},"path11-0-9":{type:"path",points:[{x:-.08,y:.06},{x:-.08,y:-.15},{x:.09,y:-.05},{x:-.08,y:.06}],color:"primary",fill:!0},"path11-0-9-0":{type:"path",points:[{x:.08,y:.26},{x:.08,y:.05},{x:-.09,y:.15},{x:.07,y:.26}],color:"primary",fill:!0}},texts:{top1:{type:"text",text:"{REF}",x:-.03,y:.42},bottom1:{type:"text",text:"{VAL}",x:-.03,y:-.42}},refblocks:{left1:{x:-.54,y:.04},right1:{x:.54,y:.04}},bounds:{minX:-.57,maxX:.57,minY:-.42,maxY:.42,width:1.14,height:.83,centerX:0,centerY:0},circles:{path1:{type:"circle",x:0,y:.05,radius:.29,color:"primary",fill:!1}}},Gxt=_t(Gm).rotateRightFacingSymbol("down").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_left",{x:-.03,y:.2}).changeTextAnchor("{VAL}","middle_left",{x:.8,y:-.2}).build(),Hxt=_t(Gm).rotateRightFacingSymbol("right").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_bottom",{x:0,y:.1}).changeTextAnchor("{VAL}","middle_top").build(),Wxt=_t(Gm).rotateRightFacingSymbol("left").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_bottom",{x:0,y:.8}).changeTextAnchor("{VAL}","middle_top",{x:0,y:-.9}).build(),qxt=_t(Gm).rotateRightFacingSymbol("right").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_bottom",{x:0,y:.1}).changeTextAnchor("{VAL}","middle_top").build(),Zxt=_t(Gm).rotateRightFacingSymbol("up").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_left",{x:.7,y:.2}).changeTextAnchor("{VAL}","middle_left",{x:-.13,y:-.2}).build(),Kxt=_t(Gm).rotateRightFacingSymbol("up").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_left",{x:.7,y:.2}).changeTextAnchor("{VAL}","middle_left",{x:-.13,y:-.2}).build(),l2={paths:{triangle:{type:"path",points:[{x:-.06,y:-.09},{x:-.06,y:.09},{x:.06,y:0},{x:-.06,y:-.09}],color:"primary",fill:!1},stem:{type:"path",points:[{x:-.11,y:0},{x:-.06,y:0}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:0,y:.03}},refblocks:{left1:{x:-.11,y:0}},bounds:{minX:-.57,maxX:.57,minY:-.37,maxY:.37,width:1.14,height:.74,centerX:0,centerY:0},circles:{}},{paths:Jxt,bounds:ZY,refblocks:Qxt}=l2,tbt=_t({primitives:[...Object.values(Jxt),{type:"text",text:"{REF}",x:-.13,y:-0}],ports:[{...Qxt.left1,labels:["1"]}],center:{x:ZY.centerX,y:ZY.centerY}}).rotateRightFacingSymbol("up").labelPort("left1",["1"]).changeTextAnchor("{REF}","middle_top").build(),{paths:ebt,bounds:KY,refblocks:nbt}=l2,ibt=_t({primitives:[...Object.values(ebt),{type:"text",text:"{REF}",x:-.13,y:0}],ports:[{...nbt.left1,labels:["1"]}],center:{x:KY.centerX,y:KY.centerY}}).rotateRightFacingSymbol("right").labelPort("left1",["1"]).changeTextAnchor("{REF}","middle_right").build(),{paths:rbt,bounds:JY,refblocks:sbt}=l2,obt=_t({primitives:[...Object.values(rbt),{type:"text",text:"{REF}",x:-.13,y:-0}],ports:[{...sbt.left1,labels:["1"]}],center:{x:JY.centerX,y:JY.centerY}}).rotateRightFacingSymbol("left").labelPort("left1",["1"]).changeTextAnchor("{REF}","middle_left").build(),{paths:abt,bounds:QY,refblocks:cbt}=l2,lbt=_t({primitives:[...Object.values(abt),{type:"text",text:"{REF}",x:-.13,y:0}],ports:[{...cbt.left1,labels:["1"]}],center:{x:QY.centerX,y:QY.centerY}}).rotateRightFacingSymbol("down").labelPort("left1",["1"]).changeTextAnchor("{REF}","middle_bottom").build(),ubt={paths:{path40:{type:"path",points:[{x:.14,y:.04},{x:-.12,y:-.09}],color:"primary",fill:!1},path41:{type:"path",points:[{x:-.12,y:.18},{x:.14,y:.04}],color:"primary",fill:!1},path42:{type:"path",points:[{x:-.12,y:-.09},{x:-.12,y:.18}],color:"primary",fill:!1},path43:{type:"path",points:[{x:.14,y:.18},{x:.14,y:-.09}],color:"primary",fill:!1},path44:{type:"path",points:[{x:-.12,y:.04},{x:-.52,y:.04}],color:"primary",fill:!1},"path44-0":{type:"path",points:[{x:.52,y:.04},{x:.15,y:.04}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.01,y:.27},bottom1:{type:"text",text:"{VAL}",x:0,y:-.27}},refblocks:{left1:{x:-.52,y:.04},right1:{x:.52,y:.04}},bounds:{minX:-.55,maxX:.55,minY:-.27,maxY:.27,width:1.09,height:.55,centerX:0,centerY:0},circles:{}},u2=_t(ubt).labelPort("left1",["1","pos"]).labelPort("right1",["2","neg"]).changeTextAnchor("{REF}","middle_bottom").changeTextAnchor("{VAL}","middle_top").build(),pbt=Lt(u2,"down"),hbt=Lt(u2,"left"),dbt=Lt(u2,"up"),fbt={paths:{path1:{type:"path",points:[{x:-.37,y:.22},{x:-.13,y:.22}],color:"primary",fill:!1},"path-1-2":{type:"path",points:[{x:-.07,y:.22},{x:.11,y:.16}],color:"primary",fill:!1},path2:{type:"path",points:[{x:.1,y:.13},{x:.37,y:.13}],color:"primary",fill:!1},path3:{type:"path",points:[{x:.12,y:.36},{x:.37,y:.36}],color:"primary",fill:!1},path4:{type:"path",points:[{x:-.37,y:-.18},{x:-.13,y:-.18}],color:"primary",fill:!1},"path4-5":{type:"path",points:[{x:-.07,y:-.19},{x:.1,y:-.24}],color:"primary",fill:!1},path5:{type:"path",points:[{x:.1,y:-.27},{x:.37,y:-.27}],color:"primary",fill:!1},path6:{type:"path",points:[{x:.12,y:-.04},{x:.37,y:-.04}],color:"primary",fill:!1},"path1-4-join":{type:"path",points:[{x:0,y:-.2},{x:0,y:.19}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:0,y:.56},bottom1:{type:"text",text:"{VAL}",x:0,y:-.42}},refblocks:{left1:{x:-.37,y:.22},left2:{x:-.37,y:-.18},right1:{x:.37,y:.36},right2:{x:.37,y:.13},right3:{x:.37,y:-.04},right5:{x:.37,y:-.27}},bounds:{minX:-.4,maxX:.4,minY:-.47,maxY:.56,width:1,height:1.04,centerX:0,centerY:.05},circles:{"circle-2":{type:"circle",x:.08,y:.13,radius:.02,color:"primary",fill:!1},"circle-5":{type:"circle",x:.08,y:-.27,radius:.02,color:"primary",fill:!1},"circle-3":{type:"circle",x:.08,y:.37,radius:.02,color:"primary",fill:!1},"circle-6":{type:"circle",x:.08,y:-.04,radius:.02,color:"primary",fill:!1},"circle-1":{type:"circle",x:-.1,y:.22,radius:.02,color:"primary",fill:!1},"circle-4":{type:"circle",x:-.1,y:-.18,radius:.02,color:"primary",fill:!1}}},p2=_t(fbt).labelPort("left1",["1"]).labelPort("right1",["3"]).labelPort("right2",["2"]).labelPort("right3",["6"]).labelPort("left2",["4"]).labelPort("right5",["5"]).changeTextAnchor("{REF}","middle_bottom").changeTextAnchor("{VAL}","middle_top").build(),uM=Lt(p2,"down"),pM=uM.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),hM=uM.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");pM.anchor="middle_bottom";hM.anchor="middle_top";pM.x=0;pM.y+=.537;hM.y-=.5375;hM.x=0;mbt=uM,dM=Lt(p2,"left"),fM=dM.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),mM=dM.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");fM.anchor="middle_bottom";mM.anchor="middle_top";fM.x=0;fM.y+=1;mM.y-=1;mM.x=0;_bt=dM,_M=Lt(p2,"up"),yM=_M.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),gM=_M.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");yM.anchor="middle_bottom";gM.anchor="middle_top";yM.x=0;yM.y+=.537;gM.y-=.5375;gM.x=0;ybt=_M,gbt={paths:{path1:{type:"path",points:[{x:-.37,y:.22},{x:-.13,y:.22}],color:"primary",fill:!1},"path-1-3":{type:"path",points:[{x:-.07,y:.23},{x:.11,y:.33}],color:"primary",fill:!1},path2:{type:"path",points:[{x:.1,y:.13},{x:.37,y:.13}],color:"primary",fill:!1},path3:{type:"path",points:[{x:.12,y:.36},{x:.37,y:.36}],color:"primary",fill:!1},path4:{type:"path",points:[{x:-.37,y:-.18},{x:-.13,y:-.18}],color:"primary",fill:!1},"path4-6":{type:"path",points:[{x:-.07,y:-.18},{x:.11,y:-.07}],color:"primary",fill:!1},path5:{type:"path",points:[{x:.1,y:-.27},{x:.37,y:-.27}],color:"primary",fill:!1},path6:{type:"path",points:[{x:.12,y:-.04},{x:.37,y:-.04}],color:"primary",fill:!1},"path1-4-join":{type:"path",points:[{x:0,y:-.12},{x:0,y:.27}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:0,y:.61},bottom1:{type:"text",text:"{VAL}",x:0,y:-.52}},refblocks:{left1:{x:-.37,y:.22},left2:{x:-.37,y:-.18},right1:{x:.37,y:.36},right2:{x:.37,y:.13},right3:{x:.37,y:-.04},right5:{x:.37,y:-.27}},bounds:{minX:-.4,maxX:.4,minY:-.47,maxY:.56,width:1,height:1.04,centerX:0,centerY:.05},circles:{"circle-2":{type:"circle",x:.08,y:.13,radius:.02,color:"primary",fill:!1},"circle-5":{type:"circle",x:.08,y:-.27,radius:.02,color:"primary",fill:!1},"circle-3":{type:"circle",x:.08,y:.37,radius:.02,color:"primary",fill:!1},"circle-6":{type:"circle",x:.08,y:-.04,radius:.02,color:"primary",fill:!1},"circle-1":{type:"circle",x:-.1,y:.22,radius:.02,color:"primary",fill:!1},"circle-4":{type:"circle",x:-.1,y:-.18,radius:.02,color:"primary",fill:!1}}},h2=_t(gbt).labelPort("left1",["1"]).labelPort("right1",["3"]).labelPort("right2",["2"]).labelPort("right3",["6"]).labelPort("left2",["4"]).labelPort("right5",["5"]).changeTextAnchor("{REF}","middle_bottom").changeTextAnchor("{VAL}","middle_top").build(),xM=Lt(h2,"down"),bM=xM.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),vM=xM.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");bM.anchor="middle_bottom";vM.anchor="middle_top";bM.x=0;bM.y+=.565;vM.y-=.555;vM.x=0;xbt=xM,SM=Lt(h2,"left"),wM=SM.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),PM=SM.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");wM.anchor="middle_bottom";PM.anchor="middle_top";wM.x=0;wM.y+=1.09;PM.y-=1.09;PM.x=0;bbt=SM,kM=Lt(h2,"up"),TM=kM.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),EM=kM.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");TM.anchor="middle_bottom";EM.anchor="middle_top";TM.x=0;TM.y+=.565;EM.y-=.555;EM.x=0;vbt=kM,Sbt={paths:{path11:{type:"path",points:[{x:-.38,y:.06},{x:-.14,y:.06}],color:"primary",fill:!1},"path11-0":{type:"path",points:[{x:-.09,y:.07},{x:.11,y:.11}],color:"primary",fill:!1},path12:{type:"path",points:[{x:.13,y:.06},{x:.38,y:.06}],color:"primary",fill:!1},"path11-5":{type:"path",points:[{x:-.38,y:-.17},{x:-.14,y:-.17}],color:"primary",fill:!1},"path11-0-3":{type:"path",points:[{x:-.09,y:-.17},{x:.11,y:-.12}],color:"primary",fill:!1},"path12-0":{type:"path",points:[{x:.13,y:-.17},{x:.38,y:-.17}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:0,y:.31},bottom1:{type:"text",text:"{VAL}",x:0,y:-.31}},refblocks:{left1:{x:-.38,y:-.17},left3:{x:-.38,y:.06},right1:{x:.38,y:-.17},right3:{x:.38,y:.06}},bounds:{minX:-.4,maxX:.4,minY:-.4,maxY:.4,width:.81,height:.79,centerX:0,centerY:0},circles:{"circle-4":{type:"circle",x:.1,y:.06,radius:.02,color:"primary",fill:!1},"circle-2":{type:"circle",x:.1,y:-.17,radius:.02,color:"primary",fill:!1},"circle-3":{type:"circle",x:-.11,y:.06,radius:.02,color:"primary",fill:!1},"circle-1":{type:"circle",x:-.11,y:-.17,radius:.02,color:"primary",fill:!1}}},d2=_t(Sbt).labelPort("left1",["1"]).labelPort("right1",["2"]).labelPort("right3",["4"]).labelPort("left3",["3"]).changeTextAnchor("{REF}","middle_bottom").changeTextAnchor("{VAL}","middle_top").build(),MM=Lt(d2,"down"),CM=MM.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),IM=MM.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");CM.anchor="middle_bottom";IM.anchor="middle_top";CM.x=.4;CM.y+=.265;IM.y-=.265;IM.x=.4;wbt=MM,NM=Lt(d2,"left"),AM=NM.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),RM=NM.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");AM.anchor="middle_bottom";RM.anchor="middle_top";AM.x=0;AM.y+=.67;RM.y-=.67;RM.x=0;Pbt=NM,OM=Lt(d2,"up"),LM=OM.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),FM=OM.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");LM.anchor="middle_bottom";FM.anchor="middle_top";LM.x=.46;LM.y+=.265;FM.y-=.265;FM.x=.46;kbt=OM,Tbt={paths:{path11:{type:"path",points:[{x:-.38,y:.06},{x:-.14,y:.06}],color:"primary",fill:!1},"path11-0":{type:"path",points:[{x:-.09,y:.07},{x:.1,y:.2}],color:"primary",fill:!1},path12:{type:"path",points:[{x:.13,y:.06},{x:.38,y:.06}],color:"primary",fill:!1},"path11-5":{type:"path",points:[{x:-.38,y:-.17},{x:-.14,y:-.17}],color:"primary",fill:!1},"path11-0-3":{type:"path",points:[{x:-.09,y:-.16},{x:.1,y:-.03}],color:"primary",fill:!1},"path12-0":{type:"path",points:[{x:.13,y:-.17},{x:.38,y:-.17}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:0,y:.42},bottom1:{type:"text",text:"{VAL}",x:0,y:-.42}},refblocks:{left1:{x:-.38,y:-.17},left3:{x:-.38,y:.06},right1:{x:.38,y:-.17},right3:{x:.38,y:.06}},bounds:{minX:-.4,maxX:.4,minY:-.4,maxY:.4,width:.81,height:.79,centerX:0,centerY:0},circles:{"circle-4":{type:"circle",x:.1,y:.06,radius:.02,color:"primary",fill:!1},"circle-2":{type:"circle",x:.1,y:-.17,radius:.02,color:"primary",fill:!1},"circle-3":{type:"circle",x:-.11,y:.06,radius:.02,color:"primary",fill:!1},"circle-1":{type:"circle",x:-.11,y:-.17,radius:.02,color:"primary",fill:!1}}},f2=_t(Tbt).labelPort("left1",["1"]).labelPort("right1",["2"]).labelPort("right3",["4"]).labelPort("left3",["3"]).changeTextAnchor("{REF}","middle_bottom").changeTextAnchor("{VAL}","middle_top").build(),zM=Lt(f2,"down"),$M=zM.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),DM=zM.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");$M.anchor="middle_bottom";DM.anchor="middle_top";$M.x=.4;$M.y+=.295;DM.y-=.295;DM.x=.42;Ebt=zM,jM=Lt(f2,"left"),BM=jM.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),YM=jM.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");BM.anchor="middle_bottom";YM.anchor="middle_top";BM.x=0;BM.y+=.795;YM.y-=.795;YM.x=0;Mbt=jM,XM=Lt(f2,"up"),UM=XM.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),VM=XM.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");UM.anchor="middle_bottom";VM.anchor="middle_top";UM.x=.46;UM.y+=.315;VM.y-=.315;VM.x=.46;Cbt=XM,fU={paths:{path5:{type:"path",points:[{x:-.44,y:0},{x:-.16,y:0}],color:"primary",fill:!1},path6:{type:"path",points:[{x:.17,y:0},{x:.44,y:.01}],color:"primary",fill:!1},path9:{type:"path",points:[{x:-.25,y:-.16},{x:.02,y:.3},{x:.25,y:.17},{x:-.02,y:-.29},{x:-.25,y:-.16}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:0,y:.37},bottom1:{type:"text",text:"{VAL}",x:0,y:-.37}},refblocks:{left1:{x:-.44,y:0},right1:{x:.44,y:.01}},bounds:{minX:-.57,maxX:.57,minY:-.25,maxY:.25,width:1.13,height:.5,centerX:0,centerY:0},circles:{}},{paths:Ibt,texts:DZt,bounds:Zb,refblocks:tX,circles:Nbt}=fU,mU=_t({primitives:[...Object.values(Ibt),...Object.values(Nbt),{type:"text",text:"{REF}",x:.18,y:-.3204553499999995},{type:"text",text:"{VAL}",x:-.25,y:-.3294553499999995}],ports:[{...tX.left1,labels:["1"]},{...tX.right1,labels:["2"]}],size:{width:Zb.width,height:Zb.height},center:{x:Zb.centerX,y:Zb.centerY}}).rotateRightFacingSymbol("up").labelPort("left",["1"]).labelPort("right",["2"]).changeTextAnchor("{REF}","middle_left").changeTextAnchor("{VAL}","middle_left").build(),GM=e2(mU),HM=GM.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),WM=GM.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");HM.anchor="middle_left";WM.anchor="middle_left";HM.y+=.4;HM.x=.32;WM.y-=.45;WM.x=.32;Abt=GM,_U=_t(fU).labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_bottom").changeTextAnchor("{VAL}","middle_top").build(),Rbt=pg(_U),Hm={paths:{path11:{type:"path",points:[{x:-.56,y:.04},{x:-.22,y:.04}],color:"primary",fill:!1},path12:{type:"path",points:[{x:.14,y:.05},{x:.48,y:.05}],color:"primary",fill:!1},"path12-6":{type:"path",points:[{x:.14,y:-.15},{x:.14,y:.25}],color:"primary",fill:!1},"path11-0-9":{type:"path",points:[{x:-.22,y:.25},{x:-.21,y:-.15},{x:.14,y:.05},{x:-.22,y:.25}],color:"primary",fill:!0}},texts:{top1:{type:"text",text:"{REF}",x:-.09,y:.38},bottom1:{type:"text",text:"{VAL}",x:-.07,y:-.38},right1:{type:"text",text:"",x:.59,y:-.33}},refblocks:{left1:{x:-.56,y:.04},right1:{x:.48,y:.05}},bounds:{minX:-.59,maxX:.59,minY:-.38,maxY:.38,width:1.18,height:.76,centerX:0,centerY:0},circles:{}},{paths:Obt,texts:jZt,bounds:Kb,refblocks:eX,circles:Lbt}=Hm,Fbt=_t({primitives:[...Object.values(Obt),...Object.values(Lbt),{type:"text",text:"{REF}",x:-.15,y:.3294553499999995},{type:"text",text:"{VAL}",x:.15,y:.3294553499999995}],ports:[{...eX.left1,labels:["1"]},{...eX.right1,labels:["2"]}],size:{width:Kb.width,height:Kb.height},center:{x:Kb.centerX,y:Kb.centerY}}).rotateRightFacingSymbol("down").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_left").changeTextAnchor("{VAL}","middle_left").build(),{paths:zbt,texts:BZt,bounds:Jb,refblocks:nX,circles:$bt}=Hm,Dbt=_t({primitives:[...Object.values(zbt),...Object.values($bt),{type:"text",text:"{REF}",x:-0,y:.4094553499999995},{type:"text",text:"{VAL}",x:0,y:-.4094553499999995}],ports:[{...nX.left1,labels:["1"]},{...nX.right1,labels:["2"]}],size:{width:Jb.width,height:Jb.height},center:{x:Jb.centerX,y:Jb.centerY}}).changeTextAnchor("{VAL}","middle_top").rotateRightFacingSymbol("right").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_bottom").build(),{paths:jbt,texts:YZt,bounds:Qb,refblocks:iX,circles:Bbt}=Hm,Ybt=_t({primitives:[...Object.values(jbt),...Object.values(Bbt),{type:"text",text:"{REF}",x:-0,y:-.3094553499999995},{type:"text",text:"{VAL}",x:0,y:.4094553499999995}],ports:[{...iX.left1,labels:["1"]},{...iX.right1,labels:["2"]}],size:{width:Qb.width,height:Qb.height},center:{x:Qb.centerX,y:Qb.centerY}}).changeTextAnchor("{VAL}","middle_bottom").rotateRightFacingSymbol("left").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_bottom").build(),{paths:Xbt,texts:XZt,bounds:tv,refblocks:rX,circles:Ubt}=Hm,Vbt=_t({primitives:[...Object.values(Xbt),...Object.values(Ubt),{type:"text",text:"{REF}",x:-0,y:.4094553499999995},{type:"text",text:"{VAL}",x:0,y:-.4094553499999995}],ports:[{...rX.left1,labels:["1"]},{...rX.right1,labels:["2"]}],size:{width:tv.width,height:tv.height},center:{x:tv.centerX,y:tv.centerY}}).changeTextAnchor("{VAL}","middle_top").rotateRightFacingSymbol("right").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_bottom").build(),{paths:Gbt,texts:UZt,bounds:ev,refblocks:sX,circles:Hbt}=Hm,Wbt=_t({primitives:[...Object.values(Gbt),...Object.values(Hbt),{type:"text",text:"{REF}",x:.15,y:-.2894553499999995},{type:"text",text:"{VAL}",x:-.15,y:-.2894553499999995}],ports:[{...sX.left1,labels:["1"]},{...sX.right1,labels:["2"]}],size:{width:ev.width,height:ev.height},center:{x:ev.centerX,y:ev.centerY}}).rotateRightFacingSymbol("up").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_left").changeTextAnchor("{VAL}","middle_left").build(),{paths:qbt,texts:VZt,bounds:nv,refblocks:oX,circles:Zbt}=Hm,Kbt=_t({primitives:[...Object.values(qbt),...Object.values(Zbt),{type:"text",text:"{REF}",x:.15,y:-.2894553499999995},{type:"text",text:"{VAL}",x:-.15,y:-.2894553499999995}],ports:[{...oX.left1,labels:["1"]},{...oX.right1,labels:["2"]}],size:{width:nv.width,height:nv.height},center:{x:nv.centerX,y:nv.centerY}}).rotateRightFacingSymbol("up").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_left").changeTextAnchor("{VAL}","middle_left").build(),Jbt={paths:{path11:{type:"path",points:[{x:-.54,y:0},{x:-.3,y:0}],color:"primary",fill:!1},path12:{type:"path",points:[{x:.29,y:0},{x:.54,y:0}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.18,y:-.36},bottom1:{type:"text",text:"{VAL}",x:-.01,y:.43},left1:{type:"text",text:"Hz",x:0,y:-.04}},refblocks:{left1:{x:-.54,y:0},right1:{x:.54,y:0}},bounds:{minX:-.53,maxX:.53,minY:0,maxY:0,width:1.06,height:1,centerX:0,centerY:0},circles:{path1:{type:"circle",x:-.01,y:-.01,radius:.29,color:"primary",fill:!1}}},{paths:Qbt,texts:tvt,bounds:iv,refblocks:aX,circles:evt}=Jbt,qM=en({primitives:[...Object.values(Qbt),...Object.values(evt),{type:"text",text:"{REF}",x:0,y:-.3594553499999995,anchor:"middle_top"},{type:"text",text:"{VAL}",x:0,y:.35,anchor:"middle_bottom"},{...tvt.left1,x:0,y:.01,anchor:"center",fontSize:.2}],ports:[{...aX.left1,labels:["1"]},{...aX.right1,labels:["2"]}],size:{width:iv.width,height:iv.height},center:{x:iv.centerX,y:iv.centerY}}),{5:nvt,...ivt}=qM.primitives;cX=Lt({...qM,primitives:Object.values(ivt).filter(rvt)}),svt={...cX,primitives:[...cX.primitives,nvt]},ovt={paths:{path10:{type:"path",points:[{x:-.53,y:.04},{x:.53,y:.04}],color:"primary",fill:!1},path14:{type:"path",points:[{x:0,y:.17},{x:.27,y:.17},{x:.27,y:-.1},{x:-.26,y:-.1},{x:-.26,y:.17},{x:0,y:.17}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.01,y:.24},bottom1:{type:"text",text:"{VAL}",x:-.17,y:-.24}},refblocks:{left1:{x:-.53,y:.04},right1:{x:.53,y:.04}},bounds:{minX:-.56,maxX:.56,minY:-.24,maxY:.24,width:1.13,height:.47,centerX:0,centerY:0},circles:{}},{paths:avt,texts:cvt,bounds:rv,refblocks:lX}=ovt,yU=en({primitives:[...Object.values(avt),{...cvt.top1,anchor:"middle_bottom"},{type:"text",text:"{VAL}",x:0,y:-.2,anchor:"middle_top"}],ports:[{...lX.left1,labels:["1"]},{...lX.right1,labels:["2"]}],size:{width:rv.width,height:rv.height},center:{x:rv.centerX,y:rv.centerY}}),lvt=Lt(yU),Wm={paths:{path1:{type:"path",points:[{x:-.29,y:.01},{x:.04,y:0}],color:"primary",fill:!0},path2:{type:"path",points:[{x:.04,y:-.22},{x:.04,y:.22}],color:"primary",fill:!0},path3:{type:"path",points:[{x:.12,y:-.17},{x:.12,y:.17}],color:"primary",fill:!0},path4:{type:"path",points:[{x:.19,y:-.06},{x:.19,y:.06}],color:"primary",fill:!0}},texts:{right1:{type:"text",text:"{REF}",x:.31,y:-.02}},refblocks:{left1:{x:-.29,y:.01}},bounds:{minX:-.31,maxX:.31,minY:-.22,maxY:.22,width:.62,height:.45,centerX:0,centerY:0},circles:{}},uvt=_t(Wm).rotateRightFacingSymbol("down").labelPort("left1",["1"]).changeTextAnchor("{REF}","middle_top").build(),pvt=_t(Wm).rotateRightFacingSymbol("right").labelPort("left1",["1"]).changeTextAnchor("{REF}","middle_left").build(),hvt=_t(Wm).rotateRightFacingSymbol("left").labelPort("left1",["1"]).changeTextAnchor("{REF}","middle_right").build(),dvt=_t(Wm).rotateRightFacingSymbol("right").labelPort("left1",["1"]).changeTextAnchor("{REF}","middle_left").build(),fvt=_t(Wm).rotateRightFacingSymbol("up").labelPort("left1",["1"]).changeTextAnchor("{REF}","middle_bottom").build(),mvt=_t(Wm).rotateRightFacingSymbol("up").labelPort("left1",["1"]).changeTextAnchor("{REF}","middle_bottom").build(),ZM={paths:{path11:{type:"path",points:[{x:-.52,y:.03},{x:-.18,y:.04}],color:"primary",fill:!1},path12:{type:"path",points:[{x:.19,y:.04},{x:.52,y:.04}],color:"primary",fill:!1},"path11-0-9":{type:"path",points:[{x:-.31,y:.2},{x:-.31,y:-.11},{x:-.01,y:.04},{x:-.3,y:.2}],color:"primary",fill:!0},"path11-0-9-5":{type:"path",points:[{x:.33,y:.2},{x:.33,y:-.1},{x:.04,y:.04},{x:.33,y:.2}],color:"primary",fill:!0}},texts:{top1:{type:"text",text:"{REF}",x:.04,y:.32},bottom1:{type:"text",text:"{VAL}",x:.04,y:-.32}},refblocks:{left1:{x:-.52,y:.03},right1:{x:.52,y:.04}},bounds:{minX:-.55,maxX:.55,minY:-.32,maxY:.32,width:1.09,height:.63,centerX:0,centerY:0},circles:{}},{paths:GZt,texts:HZt,bounds:WZt,refblocks:qZt,circles:ZZt}=ZM,_vt=_t(ZM).changeTextAnchor("{VAL}","middle_top").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_bottom").build(),yvt=_t(ZM).rotateRightFacingSymbol("down").changeTextAnchor("{VAL}","middle_right").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_left").build(),gvt={paths:{path45:{type:"path",points:[{x:.14,y:0},{x:-.13,y:-.14}],color:"primary",fill:!1},"path1-8":{type:"path",points:[{x:.13,y:0},{x:.3,y:0}],color:"primary",fill:!1},path46:{type:"path",points:[{x:-.13,y:.13},{x:.14,y:0}],color:"primary",fill:!1},path47:{type:"path",points:[{x:-.13,y:-.14},{x:-.13,y:.13}],color:"primary",fill:!1},path48:{type:"path",points:[{x:.14,y:.13},{x:.14,y:-.14}],color:"primary",fill:!1},path49:{type:"path",points:[{x:-.13,y:0},{x:-.3,y:0}],color:"primary",fill:!1},path25:{type:"path",points:[{x:.16,y:.29},{x:.25,y:.3},{x:.22,y:.21}],color:"primary",fill:!0},path78:{type:"path",points:[{x:.08,y:.17},{x:.09,y:.17},{x:.21,y:.27},{x:.21,y:.27}],color:"primary",fill:!1},"path25-0":{type:"path",points:[{x:-.02,y:.31},{x:.08,y:.32},{x:.04,y:.23}],color:"primary",fill:!0},"path78-6":{type:"path",points:[{x:-.1,y:.19},{x:-.09,y:.2},{x:.04,y:.29},{x:.04,y:.29}],color:"primary",fill:!1},box:{type:"path",points:[{x:-.3,y:-.4},{x:.3,y:-.4},{x:.3,y:.4},{x:-.3,y:.4},{x:-.3,y:-.4},{x:-.3,y:.4}],color:"primary",fill:!1},"path48-1":{type:"path",points:[{x:-.3,y:.13},{x:-.54,y:.13}],color:"primary",fill:!1},"path48-2":{type:"path",points:[{x:-.3,y:-.13},{x:-.54,y:-.13}],color:"primary",fill:!1},"path48-3":{type:"path",points:[{x:.3,y:-.13},{x:.54,y:-.13}],color:"primary",fill:!1},"path48-4":{type:"path",points:[{x:.3,y:.13},{x:.54,y:.13}],color:"primary",fill:!1}},texts:{bottom1:{type:"text",text:"{VAL}",x:0,y:-.43},right1:{type:"text",text:"{REF}",x:0,y:.43}},refblocks:{left1:{x:-.54,y:.13},left2:{x:-.54,y:-.13},right1:{x:.54,y:-.13},right2:{x:.54,y:.13}},bounds:{minX:-.56,maxX:.56,minY:-.32,maxY:.32,width:1.13,height:.65,centerX:0,centerY:0},circles:{}},m2=_t(gvt).labelPort("left1",["1","DIN"]).labelPort("left2",["2","POWER"]).labelPort("right1",["3","GND"]).labelPort("right2",["4","DOUT"]).changeTextAnchor("{REF}","middle_bottom").changeTextAnchor("{VAL}","middle_top").build(),xvt=Lt(m2,"down"),bvt=pg(m2),KM=Lt(m2,"up"),JM=KM.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),QM=KM.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");JM.anchor="middle_left";QM.anchor="middle_left";JM.y+=.21;JM.x=.44;QM.y-=.21;QM.x=.44;vvt=KM,Svt={paths:{path11:{type:"path",points:[{x:-.4,y:0},{x:-.01,y:0}],color:"primary",fill:!1},path40:{type:"path",points:[{x:.07,y:.19},{x:.07,y:-.18}],color:"primary",fill:!1},path42:{type:"path",points:[{x:.01,y:-.12},{x:.01,y:.14}],color:"primary",fill:!1},path12:{type:"path",points:[{x:.28,y:-.25},{x:.28,y:-.56}],color:"primary",fill:!1},"path12-1":{type:"path",points:[{x:.28,y:.56},{x:.28,y:.27}],color:"primary",fill:!1},path15:{type:"path",points:[{x:.17,y:-.22},{x:.28,y:-.23},{x:.23,y:-.14}],color:"primary",fill:!0},path17:{type:"path",points:[{x:.08,y:-.09},{x:.23,y:-.2}],color:"primary",fill:!1},path2:{type:"path",points:[{x:.07,y:.11},{x:.28,y:.26}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.01,y:.36},bottom1:{type:"text",text:"{VAL}",x:.02,y:-.42}},refblocks:{top1:{x:.28,y:.56},bottom1:{x:.28,y:-.56},left1:{x:-.4,y:0}},bounds:{minX:-.43,maxX:.43,minY:-.58,maxY:.58,width:.85,height:1.17,centerX:0,centerY:0},circles:{path1:{type:"circle",x:.14,y:.01,radius:.29,color:"primary",fill:!1}}},gU=_t(Svt).changeTextAnchor("{VAL}","middle_right").labelPort("left1",["3"]).labelPort("top1",["2"]).labelPort("bottom1",["1"]).changeTextAnchor("{REF}","middle_right").build(),tC=Lt(gU),eC=tC.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),xU=tC.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");eC.anchor="middle_left";xU.anchor="middle_right";eC.x=.45;eC.y+=.065;xU.y+=.065;wvt=tC,Pvt={paths:{"path12-1-8-6-9":{type:"path",points:[{x:.02,y:-.02},{x:.02,y:-.1}],color:"primary",fill:!1},"path12-1-5-6":{type:"path",points:[{x:-.47,y:-.19},{x:-.17,y:-.19}],color:"primary",fill:!1},"path12-1-5-6-8":{type:"path",points:[{x:.02,y:.17},{x:.02,y:.11}],color:"primary",fill:!1},"path12-1-8-0":{type:"path",points:[{x:-.15,y:-.03},{x:.2,y:-.19}],color:"primary",fill:!1},"path12-1-0":{type:"path",points:[{x:.2,y:-.19},{x:.47,y:-.19}],color:"primary",fill:!1},"path12-1-8-6-9-4":{type:"path",points:[{x:.02,y:.12},{x:.02,y:.02}],color:"primary",fill:!1},"path12-1-8-6-9-4-3":{type:"path",points:[{x:.08,y:.11},{x:.08,y:.05}],color:"primary",fill:!1},"path12-1-8-6-9-4-3-1":{type:"path",points:[{x:-.04,y:.11},{x:-.04,y:.05}],color:"primary",fill:!1},"path12-1-8-6-9-4-4":{type:"path",points:[{x:.08,y:.11},{x:-.04,y:.11}],color:"primary",fill:!1},"path14-5":{type:"path",points:[{x:-.01,y:.28},{x:.01,y:.25},{x:.04,y:.23},{x:.06,y:.2}],color:"primary",fill:!0},"path14-5-3":{type:"path",points:[{x:-.01,y:.2},{x:.01,y:.23},{x:.04,y:.25},{x:.06,y:.28}],color:"primary",fill:!0}},texts:{top1:{type:"text",text:"{REF}",x:.01,y:.38},bottom1:{type:"text",text:"{VAL}",x:.06,y:-.38}},refblocks:{left1:{x:-.47,y:-.19},right1:{x:.47,y:-.19}},bounds:{minX:-.5,maxX:.5,minY:-.38,maxY:.38,width:1,height:.76,centerX:0,centerY:0},circles:{path9:{type:"circle",x:.02,y:.24,radius:.06,color:"primary",fill:!1}}},bU=_t(Pvt).changeTextAnchor("{VAL}","middle_top").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_bottom").build(),vU=Lt(bU),SU=vU.primitives.filter(n=>n.type==="text"),nC=SU.find(n=>n.text==="{VAL}");nC.x=-.35;nC.y=0;nC.anchor="middle_right";iC=SU.find(n=>n.text==="{REF}");iC.y=0;iC.x=.35;iC.anchor="middle_left";kvt=vU,Tvt={paths:{path8698:{type:"path",points:[{x:-.2,y:-.02},{x:-.2,y:-.02},{x:-.21,y:-.01},{x:-.21,y:-.01},{x:-.21,y:0},{x:-.21,y:0},{x:-.21,y:0},{x:-.22,y:.01},{x:-.22,y:.01},{x:-.22,y:.02},{x:-.22,y:.02},{x:-.23,y:.03},{x:-.23,y:.03},{x:-.23,y:.03},{x:-.23,y:.04},{x:-.24,y:.04},{x:-.24,y:.04},{x:-.24,y:.05},{x:-.24,y:.05},{x:-.25,y:.05},{x:-.25,y:.06},{x:-.25,y:.06},{x:-.25,y:.06},{x:-.26,y:.06},{x:-.26,y:.06},{x:-.26,y:.07},{x:-.26,y:.07},{x:-.27,y:.07},{x:-.27,y:.07},{x:-.27,y:.07},{x:-.27,y:.07},{x:-.28,y:.07},{x:-.28,y:.07},{x:-.28,y:.07},{x:-.28,y:.07},{x:-.29,y:.07},{x:-.29,y:.08},{x:-.29,y:.08},{x:-.29,y:.08},{x:-.3,y:.08},{x:-.3,y:.08},{x:-.3,y:.08},{x:-.3,y:.08},{x:-.31,y:.08},{x:-.31,y:.08},{x:-.31,y:.07},{x:-.31,y:.07},{x:-.32,y:.07},{x:-.32,y:.07},{x:-.32,y:.07},{x:-.32,y:.07},{x:-.33,y:.07},{x:-.33,y:.07},{x:-.33,y:.07},{x:-.33,y:.07},{x:-.34,y:.07},{x:-.34,y:.06},{x:-.34,y:.06},{x:-.34,y:.06},{x:-.35,y:.06},{x:-.35,y:.06},{x:-.35,y:.05},{x:-.35,y:.05},{x:-.36,y:.05},{x:-.36,y:.04},{x:-.36,y:.04},{x:-.36,y:.04},{x:-.37,y:.03},{x:-.37,y:.03},{x:-.37,y:.03},{x:-.37,y:.02},{x:-.38,y:.02},{x:-.38,y:.01},{x:-.38,y:.01},{x:-.38,y:0},{x:-.39,y:0},{x:-.39,y:0},{x:-.39,y:-.01},{x:-.39,y:-.01},{x:-.4,y:-.02},{x:-.4,y:-.02}],color:"primary",fill:!1},path8700:{type:"path",points:[{x:0,y:-.02},{x:0,y:-.02},{x:-.01,y:-.01},{x:-.01,y:-.01},{x:-.01,y:0},{x:-.01,y:0},{x:-.02,y:0},{x:-.02,y:.01},{x:-.02,y:.01},{x:-.02,y:.02},{x:-.03,y:.02},{x:-.03,y:.03},{x:-.03,y:.03},{x:-.03,y:.03},{x:-.04,y:.04},{x:-.04,y:.04},{x:-.04,y:.04},{x:-.04,y:.05},{x:-.05,y:.05},{x:-.05,y:.05},{x:-.05,y:.06},{x:-.05,y:.06},{x:-.06,y:.06},{x:-.06,y:.06},{x:-.06,y:.06},{x:-.06,y:.07},{x:-.07,y:.07},{x:-.07,y:.07},{x:-.07,y:.07},{x:-.07,y:.07},{x:-.08,y:.07},{x:-.08,y:.07},{x:-.08,y:.07},{x:-.08,y:.07},{x:-.09,y:.07},{x:-.09,y:.07},{x:-.09,y:.08},{x:-.09,y:.08},{x:-.1,y:.08},{x:-.1,y:.08},{x:-.1,y:.08},{x:-.1,y:.08},{x:-.11,y:.08},{x:-.11,y:.08},{x:-.11,y:.08},{x:-.11,y:.07},{x:-.12,y:.07},{x:-.12,y:.07},{x:-.12,y:.07},{x:-.12,y:.07},{x:-.13,y:.07},{x:-.13,y:.07},{x:-.13,y:.07},{x:-.13,y:.07},{x:-.14,y:.07},{x:-.14,y:.07},{x:-.14,y:.06},{x:-.14,y:.06},{x:-.15,y:.06},{x:-.15,y:.06},{x:-.15,y:.06},{x:-.15,y:.05},{x:-.16,y:.05},{x:-.16,y:.05},{x:-.16,y:.04},{x:-.16,y:.04},{x:-.17,y:.04},{x:-.17,y:.03},{x:-.17,y:.03},{x:-.17,y:.03},{x:-.18,y:.02},{x:-.18,y:.02},{x:-.18,y:.01},{x:-.18,y:.01},{x:-.19,y:0},{x:-.19,y:0},{x:-.19,y:0},{x:-.19,y:-.01},{x:-.2,y:-.01},{x:-.2,y:-.02},{x:-.2,y:-.02}],color:"primary",fill:!1},path8702:{type:"path",points:[{x:.2,y:-.02},{x:.2,y:-.02},{x:.19,y:-.01},{x:.19,y:-.01},{x:.19,y:0},{x:.19,y:0},{x:.18,y:0},{x:.18,y:.01},{x:.18,y:.01},{x:.18,y:.02},{x:.17,y:.02},{x:.17,y:.03},{x:.17,y:.03},{x:.17,y:.03},{x:.16,y:.04},{x:.16,y:.04},{x:.16,y:.04},{x:.16,y:.05},{x:.15,y:.05},{x:.15,y:.05},{x:.15,y:.06},{x:.15,y:.06},{x:.14,y:.06},{x:.14,y:.06},{x:.14,y:.06},{x:.14,y:.07},{x:.13,y:.07},{x:.13,y:.07},{x:.13,y:.07},{x:.13,y:.07},{x:.12,y:.07},{x:.12,y:.07},{x:.12,y:.07},{x:.12,y:.07},{x:.11,y:.07},{x:.11,y:.07},{x:.11,y:.08},{x:.11,y:.08},{x:.1,y:.08},{x:.1,y:.08},{x:.1,y:.08},{x:.1,y:.08},{x:.09,y:.08},{x:.09,y:.08},{x:.09,y:.08},{x:.09,y:.07},{x:.08,y:.07},{x:.08,y:.07},{x:.08,y:.07},{x:.08,y:.07},{x:.07,y:.07},{x:.07,y:.07},{x:.07,y:.07},{x:.07,y:.07},{x:.06,y:.07},{x:.06,y:.07},{x:.06,y:.06},{x:.06,y:.06},{x:.05,y:.06},{x:.05,y:.06},{x:.05,y:.06},{x:.05,y:.05},{x:.04,y:.05},{x:.04,y:.05},{x:.04,y:.04},{x:.04,y:.04},{x:.03,y:.04},{x:.03,y:.03},{x:.03,y:.03},{x:.03,y:.03},{x:.02,y:.02},{x:.02,y:.02},{x:.02,y:.01},{x:.02,y:.01},{x:.01,y:0},{x:.01,y:0},{x:.01,y:0},{x:.01,y:-.01},{x:0,y:-.01},{x:0,y:-.02},{x:0,y:-.02}],color:"primary",fill:!1},path8704:{type:"path",points:[{x:.4,y:-.02},{x:.39,y:-.02},{x:.39,y:-.01},{x:.39,y:-.01},{x:.39,y:0},{x:.39,y:0},{x:.38,y:0},{x:.38,y:.01},{x:.38,y:.01},{x:.38,y:.02},{x:.37,y:.02},{x:.37,y:.03},{x:.37,y:.03},{x:.37,y:.03},{x:.36,y:.04},{x:.36,y:.04},{x:.36,y:.04},{x:.36,y:.05},{x:.35,y:.05},{x:.35,y:.05},{x:.35,y:.06},{x:.35,y:.06},{x:.34,y:.06},{x:.34,y:.06},{x:.34,y:.06},{x:.34,y:.07},{x:.33,y:.07},{x:.33,y:.07},{x:.33,y:.07},{x:.33,y:.07},{x:.32,y:.07},{x:.32,y:.07},{x:.32,y:.07},{x:.32,y:.07},{x:.31,y:.07},{x:.31,y:.07},{x:.31,y:.08},{x:.31,y:.08},{x:.3,y:.08},{x:.3,y:.08},{x:.3,y:.08},{x:.3,y:.08},{x:.29,y:.08},{x:.29,y:.08},{x:.29,y:.08},{x:.29,y:.07},{x:.28,y:.07},{x:.28,y:.07},{x:.28,y:.07},{x:.28,y:.07},{x:.27,y:.07},{x:.27,y:.07},{x:.27,y:.07},{x:.27,y:.07},{x:.26,y:.07},{x:.26,y:.07},{x:.26,y:.06},{x:.26,y:.06},{x:.25,y:.06},{x:.25,y:.06},{x:.25,y:.06},{x:.25,y:.05},{x:.24,y:.05},{x:.24,y:.05},{x:.24,y:.04},{x:.24,y:.04},{x:.23,y:.04},{x:.23,y:.03},{x:.23,y:.03},{x:.23,y:.03},{x:.22,y:.02},{x:.22,y:.02},{x:.22,y:.01},{x:.22,y:.01},{x:.21,y:0},{x:.21,y:0},{x:.21,y:0},{x:.21,y:-.01},{x:.2,y:-.01},{x:.2,y:-.02},{x:.2,y:-.02}],color:"primary",fill:!1},path8706:{type:"path",points:[{x:-.4,y:-.02},{x:-.55,y:-.02}],color:"primary",fill:!1},"path8706-5":{type:"path",points:[{x:.55,y:-.03},{x:.4,y:-.03}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:0,y:.23},bottom1:{type:"text",text:"{VAL}",x:0,y:-.23}},refblocks:{left1:{x:-.55,y:-.02},right1:{x:.55,y:-.03}},bounds:{minX:-.58,maxX:.58,minY:-.23,maxY:.23,width:1.16,height:.46,centerX:0,centerY:0},circles:{}},{paths:Evt,texts:uX,bounds:sv,refblocks:pX,circles:Mvt}=Tvt,rC=en({primitives:[...Object.values(Evt),...Object.values(Mvt),{...uX.top1,anchor:"middle_bottom"},{...uX.bottom1,anchor:"middle_top"}],ports:[{...pX.left1,labels:["1"]},{...pX.right1,labels:["2"]}],size:{width:sv.width,height:sv.height},center:{x:sv.centerX,y:sv.centerY}}),wU=Lt(rC,"up"),Cvt=e2(wU),Ivt=pg(rC),PU={paths:{path11:{type:"path",points:[{x:-.54,y:-.06},{x:-.15,y:-.06}],color:"primary",fill:!1},path40:{type:"path",points:[{x:.13,y:-.05},{x:-.13,y:-.18}],color:"primary",fill:!1},path41:{type:"path",points:[{x:-.13,y:.08},{x:.13,y:-.05}],color:"primary",fill:!1},path42:{type:"path",points:[{x:-.13,y:-.18},{x:-.13,y:.08}],color:"primary",fill:!1},path43:{type:"path",points:[{x:.13,y:.08},{x:.13,y:-.18}],color:"primary",fill:!1},path12:{type:"path",points:[{x:.14,y:-.05},{x:.54,y:-.06}],color:"primary",fill:!1},"path25-0-9-8":{type:"path",points:[{x:-.03,y:.39},{x:-.05,y:.47},{x:-.08,y:.39}],color:"primary",fill:!0},"path78-6-5-5":{type:"path",points:[{x:-.05,y:.27},{x:-.05,y:.29},{x:-.05,y:.41},{x:-.05,y:.42}],color:"primary",fill:!1},"path25-0-9-8-2":{type:"path",points:[{x:.07,y:.39},{x:.04,y:.47},{x:.02,y:.39}],color:"primary",fill:!0},"path78-6-5-5-7":{type:"path",points:[{x:.04,y:.27},{x:.04,y:.29},{x:.04,y:.41},{x:.04,y:.42}],color:"primary",fill:!1},"path43-1":{type:"path",points:[{x:.03,y:.06},{x:.03,y:-.16}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:.38,y:.38},bottom1:{type:"text",text:"{VAL}",x:.38,y:-.47}},refblocks:{left1:{x:-.54,y:-.06},right1:{x:.54,y:-.06}},bounds:{minX:-.57,maxX:.57,minY:-.47,maxY:.47,width:1.14,height:.93,centerX:0,centerY:0},circles:{path1:{type:"circle",x:0,y:-.05,radius:.29,color:"primary",fill:!1}}};PU.bounds.width+=.2;_2=_t(PU).changeTextAnchor("{VAL}","middle_top").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_bottom").build(),sC=Lt(_2,"down"),oC=sC.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),aC=sC.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");oC.anchor="middle_left";aC.anchor="middle_left";oC.y+=.9;oC.x=.3;aC.y-=.1;aC.x=.3;Nvt=sC,cC=Lt(_2,"left"),lC=cC.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),uC=cC.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");lC.anchor="middle_left";uC.anchor="middle_left";lC.y+=.71;lC.x=.44;uC.y-=.71;uC.x=.44;Avt=cC,pC=Lt(_2,"up"),hC=pC.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),dC=pC.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");hC.anchor="middle_left";dC.anchor="middle_left";hC.y+=.1;hC.x=.3;dC.y-=.71;dC.x=.3;Rvt=pC,Ovt={paths:{path45:{type:"path",points:[{x:.14,y:0},{x:-.13,y:-.14}],color:"primary",fill:!1},"path1-8":{type:"path",points:[{x:.13,y:0},{x:.54,y:0}],color:"primary",fill:!1},path46:{type:"path",points:[{x:-.13,y:.13},{x:.14,y:0}],color:"primary",fill:!1},path47:{type:"path",points:[{x:-.13,y:-.14},{x:-.13,y:.13}],color:"primary",fill:!1},path48:{type:"path",points:[{x:.14,y:.13},{x:.14,y:-.14}],color:"primary",fill:!1},path49:{type:"path",points:[{x:-.13,y:0},{x:-.54,y:0}],color:"primary",fill:!1},path25:{type:"path",points:[{x:.16,y:.29},{x:.25,y:.3},{x:.22,y:.21}],color:"primary",fill:!0},path78:{type:"path",points:[{x:.08,y:.17},{x:.09,y:.17},{x:.21,y:.27},{x:.21,y:.27}],color:"primary",fill:!1},"path25-0":{type:"path",points:[{x:-.02,y:.31},{x:.08,y:.32},{x:.04,y:.23}],color:"primary",fill:!0},"path78-6":{type:"path",points:[{x:-.1,y:.19},{x:-.09,y:.2},{x:.04,y:.29},{x:.04,y:.29}],color:"primary",fill:!1}},texts:{bottom1:{type:"text",text:"{VAL}",x:0,y:-.21},right1:{type:"text",text:"{REF}",x:0,y:.41}},refblocks:{left1:{x:-.54,y:0},right1:{x:.54,y:0}},bounds:{minX:-.56,maxX:.56,minY:-.32,maxY:.32,width:1.13,height:.65,centerX:0,centerY:0},circles:{}},{paths:Lvt,texts:hX,bounds:ov,refblocks:dX,circles:Fvt}=Ovt,fC=en({primitives:[...Object.values(Lvt),...Object.values(Fvt),{...hX.bottom1,anchor:"middle_top"},{...hX.right1,anchor:"middle_bottom"}],ports:[{...dX.left1,labels:["1"]},{...dX.right1,labels:["2"]}],size:{width:ov.width,height:ov.height},center:{x:ov.centerX,y:ov.centerY}}),mC=Lt(fC,"up"),_C=mC.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),yC=mC.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");_C.anchor="middle_left";yC.anchor="middle_left";_C.y+=.21;_C.x=.21;yC.y-=.21;yC.x=.21;kU=mC,gC=e2(kU),xC=gC.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),bC=gC.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");xC.anchor="middle_left";bC.anchor="middle_left";xC.y+=.4;xC.x=.2;bC.y-=.41;bC.x=.2;zvt=gC,$vt=pg(fC),Dvt={paths:{path11:{type:"path",points:[{x:-.52,y:-.01},{x:-.18,y:-.01}],color:"primary",fill:!1},"path11-2":{type:"path",points:[{x:-.17,y:-.11},{x:-.17,y:.08}],color:"primary",fill:!1},"path11-5":{type:"path",points:[{x:-.17,y:-.12},{x:.16,y:-.12}],color:"primary",fill:!1},"path11-5-5":{type:"path",points:[{x:-.17,y:.08},{x:.16,y:.08}],color:"primary",fill:!1},path12:{type:"path",points:[{x:.17,y:-.01},{x:.52,y:-.01}],color:"primary",fill:!1},"path11-2-1":{type:"path",points:[{x:.16,y:-.12},{x:.16,y:.08}],color:"primary",fill:!1},"path25-0-9":{type:"path",points:[{x:-.4,y:-.21},{x:-.33,y:-.18},{x:-.34,y:-.27}],color:"primary",fill:!0},"path78-6-5":{type:"path",points:[{x:-.45,y:-.34},{x:-.44,y:-.32},{x:-.35,y:-.22},{x:-.35,y:-.22}],color:"primary",fill:!1},"path25-0-9-0":{type:"path",points:[{x:-.3,y:-.34},{x:-.22,y:-.31},{x:-.24,y:-.4}],color:"primary",fill:!0},"path78-6-5-9":{type:"path",points:[{x:-.35,y:-.46},{x:-.34,y:-.45},{x:-.25,y:-.35},{x:-.25,y:-.35}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.17,y:-.41},bottom1:{type:"text",text:"{VAL}",x:-.01,y:.46}},refblocks:{left1:{x:-.52,y:-.01},right1:{x:.52,y:-.01}},bounds:{minX:-.55,maxX:.55,minY:-.51,maxY:.46,width:1.1,height:.62,centerX:0,centerY:-.02},circles:{path1:{type:"circle",x:0,y:-.02,radius:.28,color:"primary",fill:!1}}},{paths:jvt,texts:fX,bounds:av,refblocks:mX,circles:Bvt}=Dvt,TU=en({primitives:[...Object.values(jvt),...Object.values(Bvt),{...fX.top1,anchor:"middle_left",x:0},{...fX.bottom1,anchor:"middle_left",x:0}],ports:[{...mX.left1,labels:["1"]},{...mX.right1,labels:["2"]}],size:{width:av.width,height:av.height},center:{x:av.centerX,y:av.centerY}}),EU=Lt(TU),MU=EU.primitives.filter(n=>n.type==="text"),vC=MU.find(n=>n.text==="{VAL}");vC.x=-.35;vC.y=0;vC.anchor="middle_right";SC=MU.find(n=>n.text==="{REF}");SC.y=0;SC.x=.35;SC.anchor="middle_left";Yvt=EU,Xvt={paths:{path208:{type:"path",points:[{x:.38,y:.13},{x:.52,y:-.13}],color:"primary",fill:!1},path209:{type:"path",points:[{x:.25,y:-.13},{x:.38,y:.13}],color:"primary",fill:!1},path210:{type:"path",points:[{x:.52,y:-.13},{x:.25,y:-.13}],color:"primary",fill:!1},path211:{type:"path",points:[{x:.25,y:.13},{x:.52,y:.13}],color:"primary",fill:!1},path212:{type:"path",points:[{x:.12,y:-.4},{x:.38,y:-.4}],color:"primary",fill:!1},path213:{type:"path",points:[{x:.38,y:.4},{x:.12,y:.4}],color:"primary",fill:!1},path214:{type:"path",points:[{x:.12,y:.54},{x:.12,y:.18}],color:"primary",fill:!1},path215:{type:"path",points:[{x:.12,y:-.54},{x:.12,y:0}],color:"primary",fill:!1},path216:{type:"path",points:[{x:.38,y:-.4},{x:.38,y:.4}],color:"primary",fill:!1},path217:{type:"path",points:[{x:-.14,y:.26},{x:-.14,y:-.27}],color:"primary",fill:!1},path218:{type:"path",points:[{x:-.22,y:-.27},{x:-.22,y:.26}],color:"primary",fill:!1},path219:{type:"path",points:[{x:-.54,y:-.27},{x:-.22,y:-.27}],color:"primary",fill:!1},path220:{type:"path",points:[{x:-.14,y:-.19},{x:.12,y:-.19}],color:"primary",fill:!1},path221:{type:"path",points:[{x:-.14,y:.18},{x:.12,y:.18}],color:"primary",fill:!1},path222:{type:"path",points:[{x:-.07,y:0},{x:.12,y:0}],color:"primary",fill:!1}},texts:{right1:{type:"text",text:"{VAL}",x:.57,y:.02},right2:{type:"text",text:"{REF}",x:.57,y:.21}},refblocks:{top1:{x:.12,y:.54},bottom1:{x:.12,y:-.54},left1:{x:-.54,y:-.27}},bounds:{minX:-.57,maxX:.57,minY:-.57,maxY:.57,width:1.14,height:1.14,centerX:0,centerY:0},circles:{}},{paths:Uvt,texts:_X,bounds:cv,refblocks:NE}=Xvt,CU=en({primitives:[...Object.values(Uvt),{..._X.right1,anchor:"middle_left"},{..._X.right2,anchor:"middle_left"}],ports:[{...NE.top1,labels:["1"]},{...NE.bottom1,labels:["2"]},{...NE.left1,labels:["3"]}],size:{width:cv.width+.4,height:cv.height},center:{x:cv.centerX+.2,y:cv.centerY}}),wC=Lt(CU),IU=wC.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),PC=wC.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");IU.anchor="middle_top";PC.anchor="middle_top";IU.x=PC.x;PC.y+=.15;Vvt=wC,Gvt={paths:{"path12-1-8-6-9":{type:"path",points:[{x:.01,y:.07},{x:.01,y:-.01}],color:"primary",fill:!1},"path12-1-5-6":{type:"path",points:[{x:-.47,y:-.09},{x:-.17,y:-.09}],color:"primary",fill:!1},"path12-1-8-0":{type:"path",points:[{x:-.16,y:-.01},{x:.17,y:-.01}],color:"primary",fill:!1},"path12-1-0":{type:"path",points:[{x:.2,y:-.09},{x:.47,y:-.09}],color:"primary",fill:!1},path2:{type:"path",points:[{x:-.1,y:.06},{x:-.1,y:.06},{x:-.1,y:.07},{x:-.1,y:.07},{x:-.1,y:.07},{x:-.1,y:.08},{x:-.1,y:.08},{x:-.1,y:.08},{x:-.1,y:.09},{x:-.09,y:.09},{x:-.09,y:.09},{x:-.09,y:.1},{x:-.09,y:.1},{x:-.09,y:.1},{x:-.09,y:.1},{x:-.09,y:.11},{x:-.09,y:.11},{x:-.08,y:.11},{x:-.08,y:.12},{x:-.08,y:.12},{x:-.08,y:.12},{x:-.08,y:.12},{x:-.07,y:.13},{x:-.07,y:.13},{x:-.07,y:.13},{x:-.07,y:.13},{x:-.06,y:.14},{x:-.06,y:.14},{x:-.06,y:.14},{x:-.06,y:.14},{x:-.05,y:.14},{x:-.05,y:.15},{x:-.05,y:.15},{x:-.04,y:.15},{x:-.04,y:.15},{x:-.04,y:.15},{x:-.04,y:.15},{x:-.03,y:.16},{x:-.03,y:.16},{x:-.03,y:.16},{x:-.02,y:.16},{x:-.02,y:.16},{x:-.02,y:.16},{x:-.01,y:.16},{x:-.01,y:.16},{x:0,y:.16},{x:0,y:.16},{x:0,y:.16},{x:.01,y:.16},{x:.01,y:.16},{x:.01,y:.16},{x:.02,y:.16},{x:.02,y:.16},{x:.02,y:.16},{x:.03,y:.16},{x:.03,y:.16},{x:.03,y:.16},{x:.04,y:.16},{x:.04,y:.16},{x:.04,y:.16},{x:.05,y:.15},{x:.05,y:.15},{x:.05,y:.15},{x:.06,y:.15},{x:.06,y:.15},{x:.06,y:.15},{x:.06,y:.14},{x:.07,y:.14},{x:.07,y:.14},{x:.07,y:.14},{x:.08,y:.14},{x:.08,y:.13},{x:.08,y:.13},{x:.08,y:.13},{x:.09,y:.13},{x:.09,y:.12},{x:.09,y:.12},{x:.09,y:.12},{x:.09,y:.12},{x:.1,y:.11},{x:.1,y:.11},{x:.1,y:.1},{x:.1,y:.1},{x:.11,y:.09},{x:.11,y:.09},{x:.11,y:.09},{x:.11,y:.08},{x:.11,y:.08},{x:.11,y:.08},{x:.11,y:.07},{x:.11,y:.07},{x:.11,y:.07},{x:.11,y:.06},{x:.11,y:.06},{x:.1,y:.06},{x:.1,y:.06},{x:.09,y:.06},{x:.09,y:.06},{x:.08,y:.06},{x:.07,y:.06},{x:.07,y:.06},{x:.06,y:.06},{x:.05,y:.06},{x:.05,y:.06},{x:.04,y:.06},{x:.03,y:.06},{x:.03,y:.06},{x:.02,y:.06},{x:.01,y:.06},{x:.01,y:.06},{x:0,y:.06},{x:-.01,y:.06},{x:-.01,y:.06},{x:-.02,y:.06},{x:-.03,y:.06},{x:-.03,y:.06},{x:-.04,y:.06},{x:-.05,y:.06},{x:-.05,y:.06},{x:-.06,y:.06},{x:-.07,y:.06},{x:-.07,y:.06},{x:-.08,y:.06},{x:-.09,y:.06},{x:-.09,y:.06}],color:"primary",fill:!0}},texts:{top1:{type:"text",text:"{REF}",x:.01,y:.27},bottom1:{type:"text",text:"{VAL}",x:-.16,y:-.27}},refblocks:{left1:{x:-.47,y:-.09},right1:{x:.47,y:-.09}},bounds:{minX:-.5,maxX:.5,minY:-.27,maxY:.27,width:1,height:.53,centerX:0,centerY:0},circles:{}},{paths:Hvt,texts:yX,bounds:lv,refblocks:gX,circles:Wvt}=Gvt,NU=en({primitives:[...Object.values(Hvt),...Object.values(Wvt),{...yX.top1,anchor:"middle_bottom",x:0},{...yX.bottom1,anchor:"middle_top",x:0}],ports:[{...gX.left1,labels:["1"]},{...gX.right1,labels:["2"]}],size:{width:lv.width,height:lv.height},center:{x:lv.centerX+.006,y:lv.centerY+.06}}),kC=Lt(NU),ug=kC.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),Jv=kC.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");ug.anchor="middle_left";Jv.anchor="middle_right";ug.x=ug.x-.03;ug.y=ug.y;Jv.x=Jv.x;Jv.y=0;qvt=kC,Zvt={paths:{path11:{type:"path",points:[{x:-.42,y:-.1},{x:.05,y:-.11}],color:"primary",fill:!1},path40:{type:"path",points:[{x:.09,y:.19},{x:.09,y:-.18}],color:"primary",fill:!1},"path12-1":{type:"path",points:[{x:.3,y:.55},{x:.3,y:.11}],color:"primary",fill:!1},"path12-1-5":{type:"path",points:[{x:.31,y:-.55},{x:.31,y:-.01}],color:"primary",fill:!1},path2:{type:"path",points:[{x:.09,y:.11},{x:.31,y:.11}],color:"primary",fill:!1},"path2-5":{type:"path",points:[{x:.09,y:-.1},{x:.31,y:-.1}],color:"primary",fill:!1},path15:{type:"path",points:[{x:.27,y:-.04},{x:.27,y:.03},{x:.2,y:0},{x:.27,y:-.04}],color:"primary",fill:!0},"path2-0":{type:"path",points:[{x:.09,y:0},{x:.31,y:-.01}],color:"primary",fill:!1},"path12-1-0":{type:"path",points:[{x:.05,y:.17},{x:.05,y:-.11}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.13,y:.36},bottom1:{type:"text",text:"{VAL}",x:.06,y:-.42}},refblocks:{top1:{x:.3,y:.55},bottom1:{x:.31,y:-.55},left1:{x:-.42,y:-.1}},bounds:{minX:-.45,maxX:.45,minY:-.58,maxY:.58,width:.89,height:1.16,centerX:0,centerY:0},circles:{path1:{type:"circle",x:.16,y:0,radius:.29,color:"primary",fill:!1}}},{paths:Kvt,texts:xX,bounds:uv,refblocks:AE,circles:Jvt}=Zvt,AU=en({primitives:[...Object.values(Kvt),...Object.values(Jvt),{...xX.top1,anchor:"middle_right",x:0},{...xX.bottom1,anchor:"middle_right",x:0}],ports:[{...AE.top1,labels:["1","drain"]},{...AE.bottom1,labels:["2","source"]},{...AE.left1,labels:["3","gate"]}],size:{width:uv.width,height:uv.height},center:{x:uv.centerX,y:uv.centerY}}),RU=Lt(AU),OU=RU.primitives.filter(n=>n.type==="text"),TC=OU.find(n=>n.text==="{VAL}");TC.x=-.35;TC.y=0;TC.anchor="middle_right";EC=OU.find(n=>n.text==="{REF}");EC.y=0;EC.x=.35;EC.anchor="middle_left";Qvt=RU,t2t={paths:{path11:{type:"path",points:[{x:-.42,y:-.1},{x:.05,y:-.11}],color:"primary",fill:!1},"path12-1":{type:"path",points:[{x:.3,y:.55},{x:.3,y:.11}],color:"primary",fill:!1},"path12-1-5":{type:"path",points:[{x:.31,y:-.55},{x:.31,y:-.01}],color:"primary",fill:!1},path2:{type:"path",points:[{x:.09,y:.11},{x:.31,y:.11}],color:"primary",fill:!1},"path2-8-3-7":{type:"path",points:[{x:.09,y:.15},{x:.09,y:.07}],color:"primary",fill:!1},"path2-5":{type:"path",points:[{x:.09,y:-.1},{x:.31,y:-.1}],color:"primary",fill:!1},"path2-8-3":{type:"path",points:[{x:.09,y:-.08},{x:.09,y:-.15}],color:"primary",fill:!1},"path2-8-3-2":{type:"path",points:[{x:.09,y:.03},{x:.09,y:-.04}],color:"primary",fill:!1},path15:{type:"path",points:[{x:.27,y:-.04},{x:.27,y:.03},{x:.2,y:0},{x:.27,y:-.04}],color:"primary",fill:!0},"path2-0":{type:"path",points:[{x:.09,y:0},{x:.31,y:-.01}],color:"primary",fill:!1},"path12-1-0":{type:"path",points:[{x:.05,y:.11},{x:.05,y:-.11}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.13,y:.36},bottom1:{type:"text",text:"{VAL}",x:.06,y:-.42}},refblocks:{top1:{x:.3,y:.55},bottom1:{x:.31,y:-.55},left1:{x:-.42,y:-.1}},bounds:{minX:-.45,maxX:.45,minY:-.58,maxY:.58,width:.89,height:1.16,centerX:0,centerY:0},circles:{path1:{type:"circle",x:.16,y:0,radius:.29,color:"primary",fill:!1}}},{paths:e2t,texts:bX,bounds:pv,refblocks:RE,circles:n2t}=t2t,LU=en({primitives:[...Object.values(e2t),...Object.values(n2t),{...bX.top1,anchor:"middle_right",x:0},{...bX.bottom1,anchor:"middle_right",x:0}],ports:[{...RE.top1,labels:["1","drain"]},{...RE.bottom1,labels:["2","source"]},{...RE.left1,labels:["3","gate"]}],size:{width:pv.width,height:pv.height},center:{x:pv.centerX,y:pv.centerY}}),FU=Lt(LU),zU=FU.primitives.filter(n=>n.type==="text"),MC=zU.find(n=>n.text==="{VAL}");MC.x=-.35;MC.y=0;MC.anchor="middle_right";CC=zU.find(n=>n.text==="{REF}");CC.y=0;CC.x=.35;CC.anchor="middle_left";i2t=FU,r2t={paths:{path11:{type:"path",points:[{x:-.4,y:0},{x:.06,y:-.01}],color:"primary",fill:!1},path40:{type:"path",points:[{x:.07,y:.19},{x:.07,y:-.18}],color:"primary",fill:!1},"path12-1":{type:"path",points:[{x:.28,y:.55},{x:.28,y:.11}],color:"primary",fill:!1},"path12-1-5":{type:"path",points:[{x:.29,y:-.55},{x:.29,y:-.1}],color:"primary",fill:!1},path2:{type:"path",points:[{x:.07,y:.11},{x:.29,y:.11}],color:"primary",fill:!1},"path2-5":{type:"path",points:[{x:.07,y:-.1},{x:.29,y:-.1}],color:"primary",fill:!1},path15:{type:"path",points:[{x:-.08,y:.06},{x:-.08,y:-.07},{x:.01,y:0},{x:-.08,y:.06}],color:"primary",fill:!0}},texts:{top1:{type:"text",text:"{REF}",x:-.15,y:.36},bottom1:{type:"text",text:"{VAL}",x:.04,y:-.42}},refblocks:{top1:{x:.28,y:.55},bottom1:{x:.29,y:-.55},left1:{x:-.4,y:0}},bounds:{minX:-.43,maxX:.43,minY:-.58,maxY:.58,width:.85,height:1.16,centerX:0,centerY:0},circles:{path1:{type:"circle",x:.14,y:0,radius:.29,color:"primary",fill:!1}}},{paths:s2t,texts:vX,bounds:hv,refblocks:OE,circles:o2t}=r2t,$U=en({primitives:[...Object.values(s2t),...Object.values(o2t),{...vX.top1,anchor:"middle_right",x:0},{...vX.bottom1,anchor:"middle_right",x:0}],ports:[{...OE.top1,labels:["1","drain"]},{...OE.bottom1,labels:["2","source"]},{...OE.left1,labels:["3","gate"]}],size:{width:hv.width,height:hv.height},center:{x:hv.centerX,y:hv.centerY}}),DU=Lt($U),jU=DU.primitives.filter(n=>n.type==="text"),IC=jU.find(n=>n.text==="{VAL}");IC.x=-.35;IC.y=0;IC.anchor="middle_right";NC=jU.find(n=>n.text==="{REF}");NC.y=0;NC.x=.35;NC.anchor="middle_left";a2t=DU,c2t={paths:{diag1:{type:"path",points:[{x:-.1,y:-.1},{x:.1,y:.1}],color:"primary",fill:!1},diag2:{type:"path",points:[{x:-.1,y:.1},{x:.1,y:-.1}],color:"primary",fill:!1},stem:{type:"path",points:[{x:-.2,y:0},{x:0,y:0}],color:"primary",fill:!1}},texts:{},refblocks:{left1:{x:-.2,y:0}},bounds:{minX:-.19,maxX:.2,minY:-.12,maxY:.12,width:.39,height:.24,centerX:0,centerY:0},circles:{}},{paths:l2t,bounds:SX,refblocks:u2t}=c2t,y2=_t({primitives:[...Object.values(l2t)],ports:[{...u2t.left1,labels:["1"]}],center:{x:SX.centerX,y:SX.centerY}}).rotateRightFacingSymbol("right").labelPort("left1",["1"]).build(),p2t=Lt(y2,"down"),h2t=Lt(y2,"left"),d2t=Lt(y2,"up"),Uh={paths:{path11:{type:"path",points:[{x:-.4,y:0},{x:.06,y:-.01}],color:"primary",fill:!1},"path40-0":{type:"path",points:[{x:.07,y:.27},{x:.07,y:-.28}],color:"primary",fill:!1},"path40-0-5":{type:"path",points:[{x:.28,y:.24},{x:.08,y:.11}],color:"primary",fill:!1},"path40-0-5-0":{type:"path",points:[{x:.29,y:-.24},{x:.09,y:-.11}],color:"primary",fill:!1},"path12-1-5":{type:"path",points:[{x:.29,y:.25},{x:.29,y:.55}],color:"primary",fill:!1},"path12-1-5-3":{type:"path",points:[{x:.29,y:-.55},{x:.29,y:-.25}],color:"primary",fill:!1},path15:{type:"path",points:[{x:.19,y:-.1},{x:.12,y:-.2},{x:.22,y:-.2},{x:.19,y:-.1}],color:"primary",fill:!0}},texts:{top1:{type:"text",text:"{REF}",x:-.08,y:.36},bottom1:{type:"text",text:"{VAL}",x:-.07,y:-.41}},refblocks:{top1:{x:.29,y:.55},bottom1:{x:.29,y:-.55},left1:{x:-.4,y:0}},bounds:{minX:-.43,maxX:.43,minY:-.58,maxY:.58,width:.85,height:1.16,centerX:0,centerY:0},circles:{"path1-0":{type:"circle",x:.14,y:0,radius:.29,color:"primary",fill:!1}}},{paths:f2t,texts:KZt,bounds:dv,refblocks:LE,circles:m2t}=Uh,_2t=_t({primitives:[...Object.values(f2t),...Object.values(m2t),{type:"text",text:"{REF}",x:-.1,y:.3094553499999995},{type:"text",text:"{VAL}",x:-.1,y:-.3094553499999995}],ports:[{...LE.top1,labels:["1","collector"]},{...LE.bottom1,labels:["2","emitter"]},{...LE.left1,labels:["3","base"]}],size:{width:dv.width,height:dv.height},center:{x:dv.centerX,y:dv.centerY}}).rotateRightFacingSymbol("right").changeTextAnchor("{REF}","middle_right").changeTextAnchor("{VAL}","middle_right").build(),{paths:JZt,texts:QZt,bounds:tKt,refblocks:eKt,circles:nKt}=Uh,y2t=_t(Uh).rotateRightFacingSymbol("up").changeTextAnchor("{VAL}","middle_left").labelPort("left1",["3","base"]).labelPort("top1",["1","collector"]).labelPort("bottom1",["2","emitter"]).changeTextAnchor("{REF}","middle_right").build(),{paths:g2t,texts:iKt,bounds:fv,refblocks:FE,circles:x2t}=Uh,b2t=_t({primitives:[...Object.values(g2t),...Object.values(x2t),{type:"text",text:"{REF}",x:-.1,y:-.3094553499999995},{type:"text",text:"{VAL}",x:-.1,y:.3094553499999995}],ports:[{...FE.top1,labels:["1","collector"]},{...FE.bottom1,labels:["2","emitter"]},{...FE.left1,labels:["3","base"]}],size:{width:fv.width,height:fv.height},center:{x:fv.centerX,y:fv.centerY}}).rotateRightFacingSymbol("down").changeTextAnchor("{REF}","middle_bottom").changeTextAnchor("{VAL}","middle_bottom").build(),{paths:v2t,texts:rKt,bounds:mv,refblocks:zE,circles:S2t}=Uh,w2t=_t({primitives:[...Object.values(v2t),...Object.values(S2t),{type:"text",text:"{REF}",x:-.1,y:-.3094553499999995},{type:"text",text:"{VAL}",x:-.1,y:.3094553499999995}],ports:[{...zE.top1,labels:["1","collector"]},{...zE.bottom1,labels:["2","emitter"]},{...zE.left1,labels:["3","base"]}],size:{width:mv.width,height:mv.height},center:{x:mv.centerX,y:mv.centerY}}).rotateRightFacingSymbol("up").changeTextAnchor("{REF}","middle_top").changeTextAnchor("{VAL}","middle_top").build(),{paths:P2t,texts:sKt,bounds:_v,refblocks:$E,circles:k2t}=Uh,T2t=_t({primitives:[...Object.values(P2t),...Object.values(k2t),{type:"text",text:"{REF}",x:-.1,y:-.3094553499999995},{type:"text",text:"{VAL}",x:-.1,y:.3094553499999995}],ports:[{...$E.top1,labels:["1","collector"]},{...$E.bottom1,labels:["2","emitter"]},{...$E.left1,labels:["3","base"]}],size:{width:_v.width,height:_v.height},center:{x:_v.centerX,y:_v.centerY}}).rotateRightFacingSymbol("left").changeTextAnchor("{REF}","middle_left").changeTextAnchor("{VAL}","middle_left").build(),{paths:E2t,texts:oKt,bounds:yv,refblocks:DE,circles:M2t}=Uh,C2t=_t({primitives:[...Object.values(E2t),...Object.values(M2t),{type:"text",text:"{REF}",x:-.1,y:-.3094553499999995},{type:"text",text:"{VAL}",x:-.1,y:.3094553499999995}],ports:[{...DE.top1,labels:["1","collector"]},{...DE.bottom1,labels:["2","emitter"]},{...DE.left1,labels:["3","base"]}],size:{width:yv.width,height:yv.height},center:{x:yv.centerX,y:yv.centerY}}).rotateRightFacingSymbol("left").changeTextAnchor("{REF}","middle_left").changeTextAnchor("{VAL}","middle_left").build(),I2t={paths:{path40:{type:"path",points:[{x:.14,y:.04},{x:-.32,y:-.21}],color:"primary",fill:!1},path41:{type:"path",points:[{x:-.32,y:.31},{x:.14,y:.04}],color:"primary",fill:!1},path42:{type:"path",points:[{x:-.32,y:-.21},{x:-.32,y:.31}],color:"primary",fill:!1},path44:{type:"path",points:[{x:-.32,y:.18},{x:-.57,y:.18}],color:"primary",fill:!1},path45:{type:"path",points:[{x:-.32,y:-.09},{x:-.57,y:-.09}],color:"primary",fill:!1},"path44-0":{type:"path",points:[{x:.43,y:.04},{x:.15,y:.04}],color:"primary",fill:!1},"rect1577-3":{type:"path",points:[{x:-.2,y:.18},{x:-.27,y:.18}],color:"primary",fill:!0},"rect1577-4":{type:"path",points:[{x:-.2,y:-.09},{x:-.27,y:-.09}],color:"primary",fill:!0},"rect1577-4-7":{type:"path",points:[{x:-.23,y:-.05},{x:-.23,y:-.12}],color:"primary",fill:!0}},texts:{top1:{type:"text",text:"{REF}",x:-.01,y:.42},bottom1:{type:"text",text:"{VAL}",x:0,y:-.3}},refblocks:{left1:{x:-.57,y:.18},left2:{x:-.57,y:-.09},right1:{x:.43,y:.04}},bounds:{minX:-.55,maxX:.55,minY:-.38,maxY:.27,width:1.09,height:.3,centerX:0,centerY:.05},circles:{}},g2=_t(I2t).labelPort("left1",["1","inp1"]).labelPort("left2",["2","inp2"]).labelPort("right1",["3","out"]).changeTextAnchor("{REF}","middle_bottom").changeTextAnchor("{VAL}","middle_top").build(),N2t=Lt(g2,"down"),A2t=Lt(g2,"left"),R2t=Lt(g2,"up"),O2t={paths:{path40:{type:"path",points:[{x:.14,y:.04},{x:-.32,y:-.21}],color:"primary",fill:!1},path41:{type:"path",points:[{x:-.32,y:.31},{x:.14,y:.04}],color:"primary",fill:!1},path42:{type:"path",points:[{x:-.32,y:-.21},{x:-.32,y:.31}],color:"primary",fill:!1},path44:{type:"path",points:[{x:-.32,y:.18},{x:-.57,y:.18}],color:"primary",fill:!1},path45:{type:"path",points:[{x:-.32,y:-.09},{x:-.57,y:-.09}],color:"primary",fill:!1},"path44-0":{type:"path",points:[{x:.43,y:.04},{x:.15,y:.04}],color:"primary",fill:!1},"path44-1":{type:"path",points:[{x:-.1,y:.44},{x:-.1,y:.18}],color:"primary",fill:!1},"path44-2":{type:"path",points:[{x:-.09,y:-.34},{x:-.09,y:-.09}],color:"primary",fill:!1},"rect1577-3":{type:"path",points:[{x:-.2,y:.18},{x:-.27,y:.18}],color:"primary",fill:!0},"rect1577-4":{type:"path",points:[{x:-.2,y:-.09},{x:-.27,y:-.09}],color:"primary",fill:!0},"rect1577-4-7":{type:"path",points:[{x:-.23,y:.14},{x:-.23,y:.22}],color:"primary",fill:!0}},texts:{top1:{type:"text",text:"{REF}",x:.25,y:.32},bottom1:{type:"text",text:"{VAL}",x:.25,y:-.24}},refblocks:{left1:{x:-.57,y:.18},left2:{x:-.57,y:-.09},right1:{x:.43,y:.04},top2:{x:-.1,y:.44},bottom1:{x:-.09,y:-.34}},bounds:{minX:-.55,maxX:.55,minY:-.38,maxY:.27,width:1.09,height:.3,centerX:0,centerY:.05},circles:{}},x2=_t(O2t).labelPort("left1",["1","inp1"]).labelPort("left2",["2","inp2"]).labelPort("right1",["4","out"]).labelPort("top2",["5","V+"]).labelPort("bottom1",["3","V-"]).changeTextAnchor("{REF}","middle_bottom").changeTextAnchor("{VAL}","middle_top").build(),L2t=Lt(x2,"down"),F2t=Lt(x2,"left"),z2t=Lt(x2,"up"),$2t={paths:{path11:{type:"path",points:[{x:-.42,y:-.1},{x:.05,y:-.11}],color:"primary",fill:!1},path40:{type:"path",points:[{x:.09,y:.19},{x:.09,y:-.18}],color:"primary",fill:!1},"path12-1":{type:"path",points:[{x:.3,y:.55},{x:.3,y:.11}],color:"primary",fill:!1},"path12-1-5":{type:"path",points:[{x:.31,y:-.55},{x:.31,y:-.01}],color:"primary",fill:!1},path2:{type:"path",points:[{x:.09,y:.11},{x:.31,y:.11}],color:"primary",fill:!1},"path2-5":{type:"path",points:[{x:.09,y:-.1},{x:.31,y:-.1}],color:"primary",fill:!1},path15:{type:"path",points:[{x:.2,y:.03},{x:.2,y:-.04},{x:.27,y:-.01},{x:.2,y:.03}],color:"primary",fill:!0},"path2-0":{type:"path",points:[{x:.09,y:0},{x:.31,y:-.01}],color:"primary",fill:!1},"path12-1-0":{type:"path",points:[{x:.05,y:.17},{x:.05,y:-.11}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.13,y:.36},bottom1:{type:"text",text:"{VAL}",x:.06,y:-.42}},refblocks:{top1:{x:.3,y:.55},bottom1:{x:.31,y:-.55},left1:{x:-.42,y:-.1}},bounds:{minX:-.45,maxX:.45,minY:-.58,maxY:.58,width:.89,height:1.16,centerX:0,centerY:0},circles:{path1:{type:"circle",x:.16,y:0,radius:.29,color:"primary",fill:!1}}},{paths:D2t,texts:wX,bounds:gv,refblocks:jE,circles:j2t}=$2t,BU=en({primitives:[...Object.values(D2t),...Object.values(j2t),{...wX.top1,anchor:"middle_right",x:0},{...wX.bottom1,anchor:"middle_right",x:0}],ports:[{...jE.top1,labels:["1","drain"]},{...jE.bottom1,labels:["2","source"]},{...jE.left1,labels:["3","gate"]}],size:{width:gv.width,height:gv.height},center:{x:gv.centerX,y:gv.centerY}}),YU=Lt(BU),XU=YU.primitives.filter(n=>n.type==="text"),AC=XU.find(n=>n.text==="{VAL}");AC.x=-.35;AC.y=0;AC.anchor="middle_right";RC=XU.find(n=>n.text==="{REF}");RC.y=0;RC.x=.35;RC.anchor="middle_left";B2t=YU,Y2t={paths:{path11:{type:"path",points:[{x:-.42,y:-.1},{x:.05,y:-.11}],color:"primary",fill:!1},"path12-1":{type:"path",points:[{x:.3,y:.55},{x:.3,y:.11}],color:"primary",fill:!1},"path12-1-5":{type:"path",points:[{x:.31,y:-.55},{x:.31,y:-.01}],color:"primary",fill:!1},path2:{type:"path",points:[{x:.09,y:.11},{x:.31,y:.11}],color:"primary",fill:!1},"path2-8-3-7":{type:"path",points:[{x:.09,y:.15},{x:.09,y:.07}],color:"primary",fill:!1},"path2-5":{type:"path",points:[{x:.09,y:-.1},{x:.31,y:-.1}],color:"primary",fill:!1},"path2-8-3":{type:"path",points:[{x:.09,y:-.08},{x:.09,y:-.15}],color:"primary",fill:!1},"path2-8-3-2":{type:"path",points:[{x:.09,y:.03},{x:.09,y:-.04}],color:"primary",fill:!1},path15:{type:"path",points:[{x:.2,y:.03},{x:.2,y:-.04},{x:.27,y:-.01},{x:.2,y:.03}],color:"primary",fill:!0},"path2-0":{type:"path",points:[{x:.09,y:0},{x:.31,y:-.01}],color:"primary",fill:!1},"path12-1-0":{type:"path",points:[{x:.05,y:.11},{x:.05,y:-.11}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.13,y:.36},bottom1:{type:"text",text:"{VAL}",x:.06,y:-.42}},refblocks:{top1:{x:.3,y:.55},bottom1:{x:.31,y:-.55},left1:{x:-.42,y:-.1}},bounds:{minX:-.45,maxX:.45,minY:-.58,maxY:.58,width:.89,height:1.16,centerX:0,centerY:0},circles:{path1:{type:"circle",x:.16,y:0,radius:.29,color:"primary",fill:!1}}},{paths:X2t,texts:PX,bounds:xv,refblocks:BE,circles:U2t}=Y2t,UU=en({primitives:[...Object.values(X2t),...Object.values(U2t),{...PX.top1,anchor:"middle_right",x:0},{...PX.bottom1,anchor:"middle_right",x:0}],ports:[{...BE.top1,labels:["1","drain"]},{...BE.bottom1,labels:["2","source"]},{...BE.left1,labels:["3","gate"]}],size:{width:xv.width,height:xv.height},center:{x:xv.centerX,y:xv.centerY}}),VU=Lt(UU),GU=VU.primitives.filter(n=>n.type==="text"),OC=GU.find(n=>n.text==="{VAL}");OC.x=-.35;OC.y=0;OC.anchor="middle_right";LC=GU.find(n=>n.text==="{REF}");LC.y=0;LC.x=.35;LC.anchor="middle_left";V2t=VU,G2t={paths:{path11:{type:"path",points:[{x:-.54,y:-.01},{x:-.15,y:-.02}],color:"primary",fill:!1},path40:{type:"path",points:[{x:.13,y:0},{x:-.13,y:-.13}],color:"primary",fill:!1},path41:{type:"path",points:[{x:-.13,y:.13},{x:.13,y:0}],color:"primary",fill:!1},path42:{type:"path",points:[{x:-.13,y:-.13},{x:-.13,y:.13}],color:"primary",fill:!1},path43:{type:"path",points:[{x:.13,y:.13},{x:.13,y:-.13}],color:"primary",fill:!1},path12:{type:"path",points:[{x:.14,y:0},{x:.54,y:-.01}],color:"primary",fill:!1},"path25-0":{type:"path",points:[{x:.2,y:.38},{x:.16,y:.28},{x:.26,y:.3}],color:"primary",fill:!0},"path78-6":{type:"path",points:[{x:.33,y:.43},{x:.32,y:.42},{x:.21,y:.31},{x:.21,y:.31}],color:"primary",fill:!1},"path25-0-9":{type:"path",points:[{x:.35,y:.35},{x:.31,y:.26},{x:.41,y:.27}],color:"primary",fill:!0},"path78-6-5":{type:"path",points:[{x:.48,y:.4},{x:.47,y:.39},{x:.35,y:.29},{x:.35,y:.29}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.1,y:.35},bottom1:{type:"text",text:"{VAL}",x:0,y:-.43}},refblocks:{left1:{x:-.54,y:-.01},right1:{x:.54,y:-.01}},bounds:{minX:-.57,maxX:.57,minY:-.43,maxY:.43,width:1.14,height:.85,centerX:0,centerY:0},circles:{path1:{type:"circle",x:0,y:-.01,radius:.29,color:"primary",fill:!1}}},HU=_t(G2t).changeTextAnchor("{VAL}","middle_top").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_bottom").build(),WU=Lt(HU),H2t=WU.primitives.filter(n=>n.type==="text"),qU=H2t.find(n=>n.text==="{REF}");qU.y=0;qU.anchor="middle_left";W2t=WU,q2t={paths:{path11:{type:"path",points:[{x:-.4,y:0},{x:.06,y:-.01}],color:"primary",fill:!1},path40:{type:"path",points:[{x:.07,y:.19},{x:.07,y:-.18}],color:"primary",fill:!1},"path12-1":{type:"path",points:[{x:.28,y:.55},{x:.28,y:.11}],color:"primary",fill:!1},"path12-1-5":{type:"path",points:[{x:.29,y:-.55},{x:.29,y:-.1}],color:"primary",fill:!1},path2:{type:"path",points:[{x:.07,y:.11},{x:.29,y:.11}],color:"primary",fill:!1},"path2-5":{type:"path",points:[{x:.07,y:-.1},{x:.29,y:-.1}],color:"primary",fill:!1},path15:{type:"path",points:[{x:.01,y:-.07},{x:.01,y:.06},{x:-.08,y:0},{x:.01,y:-.07}],color:"primary",fill:!0}},texts:{top1:{type:"text",text:"{REF}",x:-.15,y:.36},bottom1:{type:"text",text:"{VAL}",x:.04,y:-.42}},refblocks:{top1:{x:.28,y:.55},bottom1:{x:.29,y:-.55},left1:{x:-.4,y:0}},bounds:{minX:-.43,maxX:.43,minY:-.58,maxY:.58,width:.85,height:1.16,centerX:0,centerY:0},circles:{path1:{type:"circle",x:.14,y:0,radius:.29,color:"primary",fill:!1}}},{paths:Z2t,texts:kX,bounds:bv,refblocks:YE,circles:K2t}=q2t,ZU=en({primitives:[...Object.values(Z2t),...Object.values(K2t),{...kX.top1,anchor:"middle_right",x:0},{...kX.bottom1,anchor:"middle_right"}],ports:[{...YE.top1,labels:["1","drain"]},{...YE.bottom1,labels:["2","source"]},{...YE.left1,labels:["3","gate"]}],size:{width:bv.width,height:bv.height},center:{x:bv.centerX,y:bv.centerY}}),KU=Lt(ZU),JU=KU.primitives.filter(n=>n.type==="text"),FC=JU.find(n=>n.text==="{VAL}");FC.x=-.35;FC.y=0;FC.anchor="middle_right";zC=JU.find(n=>n.text==="{REF}");zC.y=0;zC.x=.35;zC.anchor="middle_left";J2t=KU,Vh={paths:{path11:{type:"path",points:[{x:-.4,y:0},{x:.06,y:-.01}],color:"primary",fill:!1},"path40-0":{type:"path",points:[{x:.07,y:.27},{x:.07,y:-.28}],color:"primary",fill:!1},"path40-0-5":{type:"path",points:[{x:.28,y:.24},{x:.08,y:.11}],color:"primary",fill:!1},"path40-0-5-0":{type:"path",points:[{x:.29,y:-.24},{x:.09,y:-.11}],color:"primary",fill:!1},"path12-1-5":{type:"path",points:[{x:.29,y:.25},{x:.29,y:.55}],color:"primary",fill:!1},"path12-1-5-3":{type:"path",points:[{x:.29,y:-.55},{x:.29,y:-.25}],color:"primary",fill:!1},path15:{type:"path",points:[{x:.15,y:-.23},{x:.22,y:-.12},{x:.12,y:-.12},{x:.15,y:-.23}],color:"primary",fill:!0}},texts:{top1:{type:"text",text:"{REF}",x:-.08,y:.37},bottom1:{type:"text",text:"{VAL}",x:-.07,y:-.41}},refblocks:{top1:{x:.29,y:.55},bottom1:{x:.29,y:-.55},left1:{x:-.4,y:0}},bounds:{minX:-.43,maxX:.43,minY:-.58,maxY:.58,width:.85,height:1.16,centerX:0,centerY:0},circles:{"path1-0":{type:"circle",x:.14,y:0,radius:.29,color:"primary",fill:!1}}},{paths:Q2t,texts:aKt,bounds:vv,refblocks:XE,circles:tSt}=Vh,eSt=_t({primitives:[...Object.values(Q2t),...Object.values(tSt),{type:"text",text:"{REF}",x:-.1,y:.3094553499999995},{type:"text",text:"{VAL}",x:-.1,y:-.3094553499999995}],ports:[{...XE.top1,labels:["1","collector"]},{...XE.bottom1,labels:["2","emitter"]},{...XE.left1,labels:["3","base"]}],size:{width:vv.width,height:vv.height},center:{x:vv.centerX,y:vv.centerY}}).rotateRightFacingSymbol("right").changeTextAnchor("{REF}","middle_right").changeTextAnchor("{VAL}","middle_right").build(),{paths:cKt,texts:lKt,bounds:uKt,refblocks:pKt,circles:hKt}=Vh,nSt=_t(Vh).rotateRightFacingSymbol("up").changeTextAnchor("{VAL}","middle_left").labelPort("left1",["3","base"]).labelPort("top1",["1","collector"]).labelPort("bottom1",["2","emitter"]).changeTextAnchor("{REF}","middle_right").build(),{paths:iSt,texts:dKt,bounds:Sv,refblocks:UE,circles:rSt}=Vh,sSt=_t({primitives:[...Object.values(iSt),...Object.values(rSt),{type:"text",text:"{REF}",x:-.1,y:-.3094553499999995},{type:"text",text:"{VAL}",x:-.1,y:.3094553499999995}],ports:[{...UE.top1,labels:["1","collector"]},{...UE.bottom1,labels:["2","emitter"]},{...UE.left1,labels:["3","base"]}],size:{width:Sv.width,height:Sv.height},center:{x:Sv.centerX,y:Sv.centerY}}).rotateRightFacingSymbol("down").changeTextAnchor("{REF}","middle_bottom").changeTextAnchor("{VAL}","middle_bottom").build(),{paths:oSt,texts:fKt,bounds:wv,refblocks:VE,circles:aSt}=Vh,cSt=_t({primitives:[...Object.values(oSt),...Object.values(aSt),{type:"text",text:"{REF}",x:-.1,y:-.3094553499999995},{type:"text",text:"{VAL}",x:-.1,y:.3094553499999995}],ports:[{...VE.top1,labels:["1","collector"]},{...VE.bottom1,labels:["2","emitter"]},{...VE.left1,labels:["3","base"]}],size:{width:wv.width,height:wv.height},center:{x:wv.centerX,y:wv.centerY}}).rotateRightFacingSymbol("up").changeTextAnchor("{REF}","middle_top").changeTextAnchor("{VAL}","middle_top").build(),{paths:lSt,texts:mKt,bounds:Pv,refblocks:GE,circles:uSt}=Vh,pSt=_t({primitives:[...Object.values(lSt),...Object.values(uSt),{type:"text",text:"{REF}",x:-.1,y:-.3094553499999995},{type:"text",text:"{VAL}",x:-.1,y:.3094553499999995}],ports:[{...GE.top1,labels:["1","collector"]},{...GE.bottom1,labels:["2","emitter"]},{...GE.left1,labels:["3","base"]}],size:{width:Pv.width,height:Pv.height},center:{x:Pv.centerX,y:Pv.centerY}}).rotateRightFacingSymbol("left").changeTextAnchor("{REF}","middle_left").changeTextAnchor("{VAL}","middle_left").build(),{paths:hSt,texts:_Kt,bounds:kv,refblocks:HE,circles:dSt}=Vh,fSt=_t({primitives:[...Object.values(hSt),...Object.values(dSt),{type:"text",text:"{REF}",x:-.1,y:-.3094553499999995},{type:"text",text:"{VAL}",x:-.1,y:.3094553499999995}],ports:[{...HE.top1,labels:["1","collector"]},{...HE.bottom1,labels:["2","emitter"]},{...HE.left1,labels:["3","base"]}],size:{width:kv.width,height:kv.height},center:{x:kv.centerX,y:kv.centerY}}).rotateRightFacingSymbol("left").changeTextAnchor("{REF}","middle_left").changeTextAnchor("{VAL}","middle_left").build(),mSt={paths:{path40:{type:"path",points:[{x:-.19,y:.33},{x:-.26,y:.14}],color:"primary",fill:!1},path41:{type:"path",points:[{x:-.38,y:.26},{x:-.19,y:.33}],color:"primary",fill:!1},path42:{type:"path",points:[{x:-.26,y:.14},{x:-.38,y:.26}],color:"primary",fill:!1},path43:{type:"path",points:[{x:-.26,y:.39},{x:-.13,y:.26}],color:"primary",fill:!1},path44:{type:"path",points:[{x:-.32,y:.2},{x:-.52,y:0}],color:"primary",fill:!1},"path44-0":{type:"path",points:[{x:0,y:.52},{x:-.19,y:.33}],color:"primary",fill:!1},"path40-4":{type:"path",points:[{x:-.19,y:-.32},{x:-.38,y:-.26}],color:"primary",fill:!1},"path41-1":{type:"path",points:[{x:-.26,y:-.13},{x:-.19,y:-.32}],color:"primary",fill:!1},"path42-7":{type:"path",points:[{x:-.38,y:-.26},{x:-.26,y:-.13}],color:"primary",fill:!1},"path43-1":{type:"path",points:[{x:-.13,y:-.26},{x:-.26,y:-.39}],color:"primary",fill:!1},"path44-8":{type:"path",points:[{x:-.32,y:-.19},{x:-.51,y:-.01}],color:"primary",fill:!1},"path44-0-7":{type:"path",points:[{x:-.01,y:-.5},{x:-.19,y:-.32}],color:"primary",fill:!1},"path40-4-0":{type:"path",points:[{x:.32,y:.19},{x:.13,y:.26}],color:"primary",fill:!1},"path41-1-2":{type:"path",points:[{x:.26,y:.38},{x:.32,y:.19}],color:"primary",fill:!1},"path42-7-1":{type:"path",points:[{x:.13,y:.26},{x:.26,y:.38}],color:"primary",fill:!1},"path43-1-8":{type:"path",points:[{x:.39,y:.26},{x:.26,y:.13}],color:"primary",fill:!1},"path44-8-7":{type:"path",points:[{x:.2,y:.32},{x:.01,y:.51}],color:"primary",fill:!1},"path44-0-7-1":{type:"path",points:[{x:.52,y:0},{x:.32,y:.19}],color:"primary",fill:!1},"path40-4-8":{type:"path",points:[{x:.32,y:-.19},{x:.26,y:-.38}],color:"primary",fill:!1},"path41-1-4":{type:"path",points:[{x:.13,y:-.26},{x:.32,y:-.19}],color:"primary",fill:!1},"path42-7-0":{type:"path",points:[{x:.26,y:-.38},{x:.13,y:-.26}],color:"primary",fill:!1},"path43-1-0":{type:"path",points:[{x:.26,y:-.13},{x:.39,y:-.26}],color:"primary",fill:!1},"path44-8-9":{type:"path",points:[{x:.19,y:-.32},{x:0,y:-.52}],color:"primary",fill:!1},"path44-0-7-3":{type:"path",points:[{x:.5,y:-.01},{x:.32,y:-.19}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.29,y:.46},bottom1:{type:"text",text:"{VAL}",x:-.29,y:-.5}},refblocks:{top1:{x:0,y:.52},bottom1:{x:0,y:-.52},left1:{x:-.52,y:0},right1:{x:.52,y:0}},bounds:{minX:-.55,maxX:.55,minY:-.55,maxY:.55,width:1.09,height:1.09,centerX:0,centerY:0},circles:{}},{paths:_St,texts:TX,bounds:Tv,refblocks:EX}=mSt,QU=en({primitives:[...Object.values(_St),{...TX.bottom1,y:.35,anchor:"middle_top"},{...TX.top1,anchor:"middle_left"}],ports:[{...EX.left1,labels:["1"]},{...EX.right1,labels:["2"]}],size:{width:Tv.width+.05,height:Tv.height},center:{x:Tv.centerX,y:Tv.centerY}}),ySt=Lt(QU),gSt=ySt,xSt={paths:{path18:{type:"path",points:[{x:-.53,y:0},{x:-.27,y:0}],color:"primary",fill:!1},path19:{type:"path",points:[{x:.26,y:0},{x:.53,y:0}],color:"primary",fill:!1},path20:{type:"path",points:[{x:0,y:.13},{x:.26,y:.13},{x:.26,y:-.13},{x:-.27,y:-.13},{x:-.27,y:.13},{x:0,y:.13}],color:"primary",fill:!1},path23:{type:"path",points:[{x:.28,y:-.28},{x:.18,y:-.25},{x:.25,y:-.18}],color:"primary",fill:!0},path24:{type:"path",points:[{x:.29,y:-.29},{x:.25,y:-.17},{x:.16,y:-.26}],color:"primary",fill:!0},path26:{type:"path",points:[{x:-.3,y:.29},{x:.23,y:-.23}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:.06,y:.2},bottom1:{type:"text",text:"{VAL}",x:-.1,y:-.28}},refblocks:{left1:{x:-.53,y:0},right1:{x:.53,y:0}},bounds:{minX:-.56,maxX:.56,minY:-.29,maxY:.29,width:1.13,height:.58,centerX:0,centerY:0},circles:{}},{paths:bSt,texts:MX,bounds:Ev,refblocks:CX}=xSt,b2=en({primitives:[...Object.values(bSt),{...MX.bottom1,x:0,y:-.35,anchor:"middle_top"},{...MX.top1,x:0,y:.35,anchor:"middle_bottom"}],ports:[{...CX.left1,labels:["1"]},{...CX.right1,labels:["2"]}],size:{width:Ev.width+.05,height:Ev.height},center:{x:Ev.centerX,y:Ev.centerY}}),$C=Lt(b2,"down"),DC=$C.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),jC=$C.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");DC.anchor="middle_left";jC.anchor="middle_left";DC.y+=.31;DC.x=.34;jC.y-=.31;jC.x=.34;vSt=$C,BC=Lt(b2,"left"),YC=BC.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),XC=BC.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");YC.anchor="middle_bottom";XC.anchor="middle_top";YC.y+=.73;YC.x=0;XC.y-=.7;XC.x=0;SSt=BC,UC=Lt(b2,"up"),VC=UC.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),GC=UC.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");VC.anchor="middle_left";GC.anchor="middle_left";VC.y+=.21;VC.x=.34;GC.y-=.21;GC.x=.34;wSt=UC,v2={paths:{path1:{type:"path",points:[{x:-.42,y:0},{x:-.3,y:0}],color:"primary",fill:!1},"path1-2-1":{type:"path",points:[{x:-.3,y:0},{x:-.25,y:.1},{x:-.15,y:-.1},{x:-.05,y:.1},{x:.05,y:-.1},{x:.15,y:.1},{x:.25,y:-.1},{x:.3,y:0}],color:"primary",fill:!1},path2:{type:"path",points:[{x:.3,y:0},{x:.42,y:0}],color:"primary",fill:!1},path3:{type:"path",points:[{x:0,y:-.17},{x:0,y:-.4}],color:"primary",fill:!1},path15:{type:"path",points:[{x:0,y:-.12},{x:.05,y:-.2},{x:-.05,y:-.2},{x:0,y:-.12}],color:"primary",fill:!0}},texts:{top1:{type:"text",text:"{REF}",x:.3,y:.25},bottom1:{type:"text",text:"{VAL}",x:.3,y:-.25}},refblocks:{left:{x:-.42,y:0},right:{x:.42,y:0},bottom:{x:0,y:-.4}},bounds:{minX:-.42,maxX:.42,minY:-.2,maxY:.2,width:.84,height:.4,centerX:0,centerY:0},circles:{}},{paths:PSt,texts:yKt,bounds:Mv,refblocks:WE,circles:kSt}=v2,TSt=_t({primitives:[...Object.values(PSt),...Object.values(kSt),{type:"text",text:"{REF}",x:-.15,y:.2394553499999995},{type:"text",text:"{VAL}",x:.15,y:.2394553499999995}],ports:[{...WE.left,labels:["1"]},{...WE.right,labels:["3"]},{...WE.bottom,labels:["2"]}],size:{width:Mv.width,height:Mv.height},center:{x:Mv.centerX,y:Mv.centerY}}).rotateRightFacingSymbol("down").labelPort("left",["1"]).labelPort("right",["2"]).labelPort("bottom",["3"]).changeTextAnchor("{REF}","middle_left").changeTextAnchor("{VAL}","middle_left").build(),{paths:ESt,texts:gKt,bounds:Cv,refblocks:qE,circles:MSt}=v2,CSt=_t({primitives:[...Object.values(ESt),...Object.values(MSt),{type:"text",text:"{REF}",x:-.3,y:-.3894553499999995},{type:"text",text:"{VAL}",x:-.3,y:.3194553499999995}],ports:[{...qE.left,labels:["1"]},{...qE.right,labels:["3"]},{...qE.bottom,labels:["2"]}],size:{width:Cv.width,height:Cv.height},center:{x:Cv.centerX,y:Cv.centerY}}).rotateRightFacingSymbol("left").labelPort("left",["1"]).labelPort("right",["2"]).labelPort("bottom",["3"]).changeTextAnchor("{REF}","middle_bottom").changeTextAnchor("{VAL}","middle_top").build(),ISt=_t(v2).labelPort("left",["1"]).labelPort("right",["3"]).labelPort("bottom",["2"]).changeTextAnchor("{REF}","middle_bottom").changeTextAnchor("{VAL}","middle_top").build(),{paths:NSt,texts:xKt,bounds:Iv,refblocks:ZE,circles:ASt}=v2,RSt=_t({primitives:[...Object.values(NSt),...Object.values(ASt),{type:"text",text:"{REF}",x:.3,y:-.2894553499999995},{type:"text",text:"{VAL}",x:-.3,y:-.2894553499999995}],ports:[{...ZE.left,labels:["1"]},{...ZE.right,labels:["3"]},{...ZE.bottom,labels:["2"]}],size:{width:Iv.width,height:Iv.height},center:{x:Iv.centerX,y:Iv.centerY}}).rotateRightFacingSymbol("up").labelPort("left",["1"]).labelPort("right",["2"]).labelPort("bottom",["3"]).changeTextAnchor("{REF}","middle_left").changeTextAnchor("{VAL}","middle_left").build(),OSt={paths:{path11:{type:"path",points:[{x:-.54,y:.03},{x:-.3,y:.03}],color:"primary",fill:!1},path12:{type:"path",points:[{x:.29,y:.03},{x:.54,y:.03}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.16,y:.4},bottom1:{type:"text",text:"{VAL}",x:0,y:-.4},left1:{type:"text",text:"COS \u03C6",x:-.15,y:.01}},refblocks:{left1:{x:-.54,y:.03},right1:{x:.54,y:.03}},bounds:{minX:-.57,maxX:.57,minY:-.4,maxY:.4,width:1.14,height:.79,centerX:0,centerY:0},circles:{path1:{type:"circle",x:0,y:.04,radius:.29,color:"primary",fill:!1}}},{paths:LSt,texts:bKt,bounds:Nv,refblocks:IX,circles:FSt}=OSt,tV=en({primitives:[...Object.values(LSt),...Object.values(FSt),{type:"text",text:"{REF}",x:-.15,y:-.42330070000000064,anchor:"middle_top"},{type:"text",text:"{VAL}",x:-.15,y:.42330070000000064,anchor:"middle_bottom"},{type:"text",text:"COS \u03C6",x:0,y:.014279000000000375,anchor:"center"}],ports:[{...IX.left1,labels:["1"]},{...IX.right1,labels:["2"]}],size:{width:Nv.width,height:Nv.height},center:{x:Nv.centerX,y:Nv.centerY}}),eV=Lt(tV),HC=eV.primitives.filter(n=>n.type==="text"),WC=HC.find(n=>n.text==="{REF}"),qC=HC.find(n=>n.text==="{VAL}"),ZC=HC.find(n=>n.text==="COS \u03C6");WC.x=.35;WC.y=0;WC.anchor="middle_left";qC.anchor="middle_right";qC.x=-.35;qC.y=0;ZC.x=0;ZC.y=0;ZC.anchor="center";zSt=eV,$St={paths:{"path12-1-8-6-9-9":{type:"path",points:[{x:.01,y:.03},{x:.01,y:-.09}],color:"primary",fill:!1},"path12-1-5-6-4":{type:"path",points:[{x:-.47,y:-.05},{x:-.17,y:-.05}],color:"primary",fill:!1},"path12-1-8-0-0":{type:"path",points:[{x:-.16,y:-.09},{x:.18,y:-.09}],color:"primary",fill:!1},"path12-1-0-1":{type:"path",points:[{x:.2,y:-.05},{x:.47,y:-.05}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:.01,y:.22},bottom1:{type:"text",text:"{VAL}",x:-.16,y:-.22}},refblocks:{left1:{x:-.47,y:-.05},right1:{x:.47,y:-.05}},bounds:{minX:-.5,maxX:.5,minY:-.22,maxY:.22,width:1,height:.45,centerX:0,centerY:0},circles:{"circle-2":{type:"circle",x:-.14,y:-.05,radius:.02,color:"primary",fill:!1},circle:{type:"circle",x:.17,y:-.05,radius:.02,color:"primary",fill:!1}}},{paths:DSt,texts:NX,bounds:Av,refblocks:AX,circles:jSt}=$St,nV=en({primitives:[...Object.values(DSt),...Object.values(jSt),{...NX.top1,anchor:"middle_left"},{...NX.bottom1,anchor:"middle_left"}],ports:[{...AX.left1,labels:["1"]},{...AX.right1,labels:["2"]}],size:{width:Av.width,height:Av.height},center:{x:Av.centerX,y:Av.centerY}}),BSt=Lt(nV,"up"),YSt={paths:{"path12-1-8-6-9-9":{type:"path",points:[{x:-.05,y:.09},{x:-.05,y:.04}],color:"primary",fill:!1},"path12-1-8-7-9-9":{type:"path",points:[{x:-.05,y:.09},{x:.07,y:.09}],color:"primary",fill:!1},"path12-1-8-6-9-10":{type:"path",points:[{x:.07,y:.09},{x:.07,y:.04}],color:"primary",fill:!1},"path12-1-5-6-4":{type:"path",points:[{x:-.47,y:-.05},{x:-.17,y:-.05}],color:"primary",fill:!1},"path12-1-8-0-0":{type:"path",points:[{x:-.16,y:.04},{x:.18,y:.04}],color:"primary",fill:!1},"path12-1-0-1":{type:"path",points:[{x:.2,y:-.05},{x:.47,y:-.05}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:.01,y:.29},bottom1:{type:"text",text:"{VAL}",x:-.16,y:-.22}},refblocks:{left1:{x:-.47,y:-.05},right1:{x:.47,y:-.05}},bounds:{minX:-.5,maxX:.5,minY:-.22,maxY:.22,width:1,height:.45,centerX:0,centerY:0},circles:{"circle-2":{type:"circle",x:-.14,y:-.05,radius:.02,color:"primary",fill:!1},circle:{type:"circle",x:.17,y:-.05,radius:.02,color:"primary",fill:!1}}},{paths:XSt,texts:RX,bounds:Rv,refblocks:OX,circles:USt}=YSt,iV=en({primitives:[...Object.values(XSt),...Object.values(USt),{...RX.top1,anchor:"middle_left"},{...RX.bottom1,anchor:"middle_left"}],ports:[{...OX.left1,labels:["1"]},{...OX.right1,labels:["2"]}],size:{width:Rv.width,height:Rv.height},center:{x:Rv.centerX,y:Rv.centerY}}),VSt=Lt(iV,"up"),S2={paths:{path12_rotated:{type:"path",points:[{x:-.09,y:.12},{x:-.09,y:-.12}],color:"primary",fill:!1},path2_rotated:{type:"path",points:[{x:-.09,y:0},{x:.09,y:0}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:0,y:.03}},refblocks:{left1:{x:.09,y:0}},bounds:{minX:-.57,maxX:.57,minY:-.37,maxY:.37,width:1.14,height:.74,centerX:0,centerY:0},circles:{}},{paths:GSt,texts:vKt,bounds:LX,refblocks:HSt,circles:WSt}=S2,qSt=_t({primitives:[...Object.values(GSt),...Object.values(WSt),{type:"text",text:"{REF}",x:-.14,y:-0}],ports:[{...HSt.left1,labels:["1"]}],center:{x:LX.centerX,y:LX.centerY}}).rotateRightFacingSymbol("up").labelPort("left1",["1"]).changeTextAnchor("{REF}","middle_top").build(),{paths:ZSt,texts:SKt,bounds:FX,refblocks:KSt,circles:JSt}=S2,QSt=_t({primitives:[...Object.values(ZSt),...Object.values(JSt),{type:"text",text:"{REF}",x:-.13,y:0}],ports:[{...KSt.left1,labels:["1"]}],center:{x:FX.centerX,y:FX.centerY}}).changeTextAnchor("{VAL}","middle_top").rotateRightFacingSymbol("right").labelPort("left1",["1"]).changeTextAnchor("{REF}","middle_right").build(),{paths:twt,texts:wKt,bounds:zX,refblocks:ewt,circles:nwt}=S2,iwt=_t({primitives:[...Object.values(twt),...Object.values(nwt),{type:"text",text:"{REF}",x:-.14,y:-0}],ports:[{...ewt.left1,labels:["1"]}],center:{x:zX.centerX,y:zX.centerY}}).rotateRightFacingSymbol("left").labelPort("left1",["1"]).changeTextAnchor("{REF}","middle_left").build(),{paths:rwt,texts:PKt,bounds:$X,refblocks:swt}=S2,owt=_t({primitives:[...Object.values(rwt),{type:"text",text:"{REF}",x:-.14,y:0}],ports:[{...swt.left1,labels:["1"]}],center:{x:$X.centerX,y:$X.centerY}}).rotateRightFacingSymbol("down").labelPort("left1",["1"]).changeTextAnchor("{REF}","middle_bottom").build(),awt={paths:{path40:{type:"path",points:[{x:-.19,y:-.33},{x:-.26,y:-.14}],color:"primary",fill:!1},path41:{type:"path",points:[{x:-.38,y:-.26},{x:-.19,y:-.33}],color:"primary",fill:!1},path42:{type:"path",points:[{x:-.26,y:-.14},{x:-.38,y:-.26}],color:"primary",fill:!1},path43:{type:"path",points:[{x:-.26,y:-.39},{x:-.13,y:-.26}],color:"primary",fill:!1},path44:{type:"path",points:[{x:-.32,y:-.2},{x:-.52,y:0}],color:"primary",fill:!1},"path44-0":{type:"path",points:[{x:0,y:-.52},{x:-.19,y:-.33}],color:"primary",fill:!1},"path40-4":{type:"path",points:[{x:-.19,y:.32},{x:-.38,y:.26}],color:"primary",fill:!1},"path41-1":{type:"path",points:[{x:-.26,y:.13},{x:-.19,y:.32}],color:"primary",fill:!1},"path42-7":{type:"path",points:[{x:-.38,y:.26},{x:-.26,y:.13}],color:"primary",fill:!1},"path43-1":{type:"path",points:[{x:-.13,y:.26},{x:-.26,y:.39}],color:"primary",fill:!1},"path44-8":{type:"path",points:[{x:-.32,y:.19},{x:-.51,y:.01}],color:"primary",fill:!1},"path44-0-7":{type:"path",points:[{x:-.01,y:.5},{x:-.19,y:.32}],color:"primary",fill:!1},"path40-4-0":{type:"path",points:[{x:.32,y:-.19},{x:.13,y:-.26}],color:"primary",fill:!1},"path41-1-2":{type:"path",points:[{x:.26,y:-.38},{x:.32,y:-.19}],color:"primary",fill:!1},"path42-7-1":{type:"path",points:[{x:.13,y:-.26},{x:.26,y:-.38}],color:"primary",fill:!1},"path43-1-8":{type:"path",points:[{x:.39,y:-.26},{x:.26,y:-.13}],color:"primary",fill:!1},"path44-8-7":{type:"path",points:[{x:.2,y:-.32},{x:.01,y:-.51}],color:"primary",fill:!1},"path44-0-7-1":{type:"path",points:[{x:.52,y:0},{x:.32,y:-.19}],color:"primary",fill:!1},"path40-4-8":{type:"path",points:[{x:.32,y:.19},{x:.26,y:.38}],color:"primary",fill:!1},"path41-1-4":{type:"path",points:[{x:.13,y:.26},{x:.32,y:.19}],color:"primary",fill:!1},"path42-7-0":{type:"path",points:[{x:.26,y:.38},{x:.13,y:.26}],color:"primary",fill:!1},"path43-1-0":{type:"path",points:[{x:.26,y:.13},{x:.39,y:.26}],color:"primary",fill:!1},"path44-8-9":{type:"path",points:[{x:.19,y:.32},{x:0,y:.52}],color:"primary",fill:!1},"path44-0-7-3":{type:"path",points:[{x:.5,y:.01},{x:.32,y:.19}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.29,y:-.46},bottom1:{type:"text",text:"{VAL}",x:-.29,y:.5}},refblocks:{top1:{x:0,y:-.52},bottom1:{x:0,y:.52},left1:{x:-.52,y:0},right1:{x:.52,y:0}},bounds:{minX:-.55,maxX:.55,minY:-.56,maxY:.55,width:1.09,height:1.1,centerX:0,centerY:0},circles:{}},{paths:cwt,texts:DX,bounds:Ov,refblocks:Lv,circles:lwt}=awt,rV=en({primitives:[...Object.values(cwt),...Object.values(lwt),{...DX.top1,anchor:"middle_right"},{...DX.bottom1,anchor:"middle_right"}],ports:[{...Lv.top1,labels:["1"]},{...Lv.bottom1,labels:["2"]},{...Lv.left1,labels:["3"]},{...Lv.right1,labels:["4"]}],size:{width:Ov.width,height:Ov.height},center:{x:Ov.centerX,y:Ov.centerY}}),KC=Lt(rV),uwt=KC.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),pwt=KC.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");uwt.anchor="middle_left";pwt.anchor="middle_right";hwt=KC,w2={paths:{path27:{type:"path",points:[{x:.47,y:.04},{x:.21,y:.04}],color:"primary",fill:!1},"path27-0":{type:"path",points:[{x:-.21,y:.04},{x:-.47,y:.04}],color:"primary",fill:!1},"path27-8-2-4":{type:"path",points:[{x:.21,y:.04},{x:.19,y:-.05}],color:"primary",fill:!1},"path27-8-2-4-29":{type:"path",points:[{x:-.19,y:.14},{x:-.21,y:.04}],color:"primary",fill:!1},"path27-8-2-4-5":{type:"path",points:[{x:.19,y:-.05},{x:.13,y:.14}],color:"primary",fill:!1},"path27-8-2-4-5-1":{type:"path",points:[{x:.08,y:-.05},{x:.13,y:.14}],color:"primary",fill:!1},"path27-8-2-4-5-1-9":{type:"path",points:[{x:.08,y:-.05},{x:.03,y:.14}],color:"primary",fill:!1},"path27-8-2-4-5-1-9-2":{type:"path",points:[{x:-.03,y:-.05},{x:.03,y:.14}],color:"primary",fill:!1},"path27-8-2-4-5-1-9-2-1":{type:"path",points:[{x:-.03,y:-.05},{x:-.08,y:.14}],color:"primary",fill:!1},"path27-8-2-4-5-1-9-2-1-2":{type:"path",points:[{x:-.13,y:-.05},{x:-.08,y:.14}],color:"primary",fill:!1},"path27-8-2-4-5-1-9-2-1-2-2":{type:"path",points:[{x:-.13,y:-.05},{x:-.19,y:.14}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.05,y:.42},bottom1:{type:"text",text:"{VAL}",x:-.04,y:-.42}},refblocks:{left1:{x:-.47,y:.04},right1:{x:.47,y:.04}},bounds:{minX:-.49,maxX:.49,minY:-.42,maxY:.42,width:.99,height:.84,centerX:0,centerY:0},circles:{}},{paths:dwt,texts:kKt,bounds:Fv,refblocks:jX,circles:fwt}=w2,mwt=_t({primitives:[...Object.values(dwt),...Object.values(fwt),{type:"text",text:"{REF}",x:-.2,y:.2194553499999995},{type:"text",text:"{VAL}",x:.2,y:.2194553499999995}],ports:[{...jX.left1,labels:["1"]},{...jX.right1,labels:["2"]}],size:{width:Fv.width,height:Fv.height},center:{x:Fv.centerX,y:Fv.centerY}}).rotateRightFacingSymbol("down").labelPort("left",["1"]).labelPort("right",["2"]).changeTextAnchor("{REF}","middle_left").changeTextAnchor("{VAL}","middle_left").build(),{paths:_wt,texts:TKt,bounds:zv,refblocks:BX,circles:ywt}=w2,gwt=_t({primitives:[...Object.values(_wt),...Object.values(ywt),{type:"text",text:"{REF}",x:0,y:-.1704553499999995},{type:"text",text:"{VAL}",x:0,y:.2294553499999995}],ports:[{...BX.left1,labels:["1"]},{...BX.right1,labels:["2"]}],size:{width:zv.width,height:zv.height},center:{x:zv.centerX,y:zv.centerY}}).rotateRightFacingSymbol("left").labelPort("left",["1"]).labelPort("right",["2"]).changeTextAnchor("{REF}","middle_bottom").changeTextAnchor("{VAL}","middle_top").build(),{paths:xwt,texts:EKt,bounds:$v,refblocks:YX,circles:bwt}=w2,vwt=_t({primitives:[...Object.values(xwt),...Object.values(bwt),{type:"text",text:"{REF}",x:0,y:.2294553499999995},{type:"text",text:"{VAL}",x:0,y:-.1704553499999995}],ports:[{...YX.left1,labels:["1"]},{...YX.right1,labels:["2"]}],size:{width:$v.width,height:$v.height},center:{x:$v.centerX,y:$v.centerY}}).rotateRightFacingSymbol("right").labelPort("left",["1"]).labelPort("right",["2"]).changeTextAnchor("{REF}","middle_bottom").changeTextAnchor("{VAL}","middle_top").build(),{paths:Swt,texts:MKt,bounds:Dv,refblocks:XX,circles:wwt}=w2,Pwt=_t({primitives:[...Object.values(Swt),...Object.values(wwt),{type:"text",text:"{REF}",x:.2,y:-.1404553499999995},{type:"text",text:"{VAL}",x:-.2,y:-.1494553499999995}],ports:[{...XX.left1,labels:["1"]},{...XX.right1,labels:["2"]}],size:{width:Dv.width,height:Dv.height},center:{x:Dv.centerX,y:Dv.centerY}}).rotateRightFacingSymbol("up").labelPort("left",["1"]).labelPort("right",["2"]).changeTextAnchor("{REF}","middle_left").changeTextAnchor("{VAL}","middle_left").build(),sV={paths:{path27:{type:"path",points:[{x:.76,y:-.28},{x:.31,y:-.28}],color:"primary",fill:!1},path28:{type:"path",points:[{x:-.3,y:-.02},{x:-.77,y:-.02}],color:"primary",fill:!1},path30:{type:"path",points:[{x:-.3,y:.35},{x:-.3,y:-.28}],color:"primary",fill:!1},"path27-3":{type:"path",points:[{x:.77,y:.35},{x:.32,y:.35}],color:"primary",fill:!1},"path29-5":{type:"path",points:[{x:-.07,y:-.28},{x:-.3,y:-.28}],color:"primary",fill:!1},"path29-5-7":{type:"path",points:[{x:.33,y:-.28},{x:.11,y:-.28}],color:"primary",fill:!1},"path29-5-7-6":{type:"path",points:[{x:-.06,y:-.17},{x:-.06,y:-.39}],color:"primary",fill:!1},"path29-5-7-6-6":{type:"path",points:[{x:.09,y:-.17},{x:.09,y:-.39}],color:"primary",fill:!1},"path29-5-9":{type:"path",points:[{x:-.07,y:.35},{x:-.3,y:.35}],color:"primary",fill:!1},"path29-5-7-2":{type:"path",points:[{x:.33,y:.35},{x:.11,y:.35}],color:"primary",fill:!1},"path29-5-7-6-0":{type:"path",points:[{x:-.06,y:.46},{x:-.06,y:.24}],color:"primary",fill:!1},"path29-5-7-6-6-2":{type:"path",points:[{x:.09,y:.46},{x:.09,y:.24}],color:"primary",fill:!1},"path29-5-92":{type:"path",points:[{x:.33,y:.13},{x:.33,y:.35}],color:"primary",fill:!1},"path29-5-7-28":{type:"path",points:[{x:.33,y:-.28},{x:.33,y:-.05}],color:"primary",fill:!1},"path29-5-7-6-9":{type:"path",points:[{x:.44,y:.11},{x:.22,y:.11}],color:"primary",fill:!1},"path29-5-7-6-6-7":{type:"path",points:[{x:.44,y:-.04},{x:.22,y:-.04}],color:"primary",fill:!1},"path29-5-7-6-9-2":{type:"path",points:[{x:.44,y:.07},{x:.22,y:.07}],color:"primary",fill:!1},"path29-5-7-6-9-2-4":{type:"path",points:[{x:.44,y:0},{x:.44,y:.07}],color:"primary",fill:!1},"path29-5-7-6-9-2-4-6":{type:"path",points:[{x:.22,y:0},{x:.22,y:.07}],color:"primary",fill:!1},"path29-5-7-6-9-2-9":{type:"path",points:[{x:.44,y:0},{x:.22,y:0}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:.02,y:.53},bottom1:{type:"text",text:"{VAL}",x:.01,y:-.54}},refblocks:{left1:{x:-.77,y:-.02},right1:{x:.76,y:-.28},right2:{x:.77,y:.35}},bounds:{minX:-.79,maxX:.79,minY:-.54,maxY:.54,width:1.59,height:1.07,centerX:0,centerY:0},circles:{}},{paths:kwt,texts:UX,bounds:jv,refblocks:KE,circles:Twt}=sV,P2=en({primitives:[...Object.values(kwt),...Object.values(Twt),{...UX.top1,anchor:"middle_bottom"},{...UX.bottom1,anchor:"middle_top"}],ports:[{...KE.left1,labels:["1"]},{...KE.right1,labels:["2"]},{...KE.right2,labels:["3"]}],size:{width:jv.width,height:jv.height},center:{x:jv.centerX,y:jv.centerY}}),JC=Lt(P2,"down"),QC=JC.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),tI=JC.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");QC.anchor="middle_bottom";tI.anchor="middle_top";QC.y+=.3;QC.x+=.101;tI.y-=.49999;tI.x+=1.19999;Ewt=JC,{paths:Mwt,texts:CKt,bounds:Bv,refblocks:JE,circles:Cwt}=sV,oV=en({primitives:[...Object.values(Mwt),...Object.values(Cwt),{type:"text",text:"{REF}",x:.01596175000000022,y:-.5308501500000009,anchor:"middle_top"},{type:"text",text:"{VAL}",x:.013116750000000454,y:.5408501499999989,anchor:"middle_bottom"}],ports:[{...JE.left1,labels:["1"]},{...JE.right1,labels:["2"]},{...JE.right2,labels:["3"]}],size:{width:Bv.width,height:Bv.height},center:{x:Bv.centerX,y:Bv.centerY}}),eI=Lt(P2,"left"),nI=eI.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),iI=eI.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");nI.anchor="middle_bottom";iI.anchor="middle_top";nI.y+=.99;nI.x-=0;iI.y-=1.10999;iI.x=0;Iwt=eI,rI=Lt(P2,"up"),sI=rI.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),oI=rI.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");sI.anchor="middle_bottom";oI.anchor="middle_top";sI.y+=.499;sI.x=.62;oI.y-=.29999;oI.x+=.1;Nwt=rI,Awt=Lt(oV),Rwt={paths:{path40:{type:"path",points:[{x:.14,y:.04},{x:-.12,y:-.09}],color:"primary",fill:!1},path41:{type:"path",points:[{x:-.12,y:.18},{x:.14,y:.04}],color:"primary",fill:!1},path42:{type:"path",points:[{x:-.12,y:-.09},{x:-.12,y:.18}],color:"primary",fill:!1},path43:{type:"path",points:[{x:.14,y:.18},{x:.14,y:-.09}],color:"primary",fill:!1},path44:{type:"path",points:[{x:-.12,y:.04},{x:-.52,y:.04}],color:"primary",fill:!1},"path44-0":{type:"path",points:[{x:.52,y:.04},{x:.15,y:.04}],color:"primary",fill:!1},"path43-7":{type:"path",points:[{x:.21,y:.18},{x:.14,y:.18}],color:"primary",fill:!1},"path43-7-9":{type:"path",points:[{x:.21,y:.13},{x:.21,y:.18}],color:"primary",fill:!1},"path43-7-2":{type:"path",points:[{x:.08,y:-.09},{x:.14,y:-.09}],color:"primary",fill:!1},"path43-7-9-3":{type:"path",points:[{x:.08,y:-.04},{x:.08,y:-.09}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.01,y:.27},bottom1:{type:"text",text:"{VAL}",x:0,y:-.27}},refblocks:{left1:{x:-.52,y:.04},right1:{x:.52,y:.04}},bounds:{minX:-.55,maxX:.55,minY:-.27,maxY:.27,width:1.09,height:.55,centerX:0,centerY:0},circles:{}},k2=_t(Rwt).labelPort("left1",["1","pos"]).labelPort("right1",["2","neg"]).changeTextAnchor("{VAL}","middle_top").changeTextAnchor("{REF}","middle_bottom").build(),aI=Lt(k2,"down"),cI=aI.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),lI=aI.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");cI.anchor="middle_left";lI.anchor="middle_left";cI.y+=.3;cI.x=.3;lI.y-=.3;lI.x=.3;Owt=aI,uI=Lt(k2,"left"),pI=uI.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),hI=uI.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");pI.anchor="middle_bottom";hI.anchor="middle_top";pI.y+=.5;pI.x=0;hI.y-=.55;hI.x=0;Lwt=uI,dI=Lt(k2,"up"),fI=dI.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),mI=dI.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");fI.anchor="middle_left";mI.anchor="middle_left";fI.y+=.3;fI.x=.3;mI.y-=.3;mI.x=.3;Fwt=dI,aV={paths:{path11:{type:"path",points:[{x:-.52,y:.04},{x:-.18,y:.04}],color:"primary",fill:!1},path12:{type:"path",points:[{x:.19,y:.05},{x:.52,y:.05}],color:"primary",fill:!1},"path12-6":{type:"path",points:[{x:.18,y:-.15},{x:.18,y:.25}],color:"primary",fill:!1},"path12-2":{type:"path",points:[{x:.19,y:0},{x:.35,y:-.14}],color:"primary",fill:!1},"path12-2-9":{type:"path",points:[{x:.35,y:-.14},{x:.34,y:-.35}],color:"primary",fill:!1},"path11-0-9":{type:"path",points:[{x:-.17,y:.27},{x:-.17,y:-.15},{x:.18,y:.05},{x:-.17,y:.27}],color:"primary",fill:!0}},texts:{top1:{type:"text",text:"{REF}",x:-.22,y:.38},bottom1:{type:"text",text:"{VAL}",x:.11,y:-.38}},refblocks:{bottom1:{x:.34,y:-.35},left1:{x:-.52,y:.04},right1:{x:.52,y:.05}},bounds:{minX:-.55,maxX:.55,minY:-.38,maxY:.38,width:1.09,height:.77,centerX:0,centerY:0},circles:{}},{paths:IKt,texts:NKt,bounds:AKt,refblocks:RKt,circles:OKt}=aV,cV=_t(aV).changeTextAnchor("{VAL}","middle_top").labelPort("left1",["1"]).labelPort("right1",["2"]).labelPort("bottom1",["3"]).changeTextAnchor("{REF}","middle_bottom").build(),lV=Lt(cV),zwt=lV.primitives.filter(n=>n.type==="text"),uV=zwt.find(n=>n.text==="{REF}");uV.y=0;uV.anchor="middle_left";$wt=lV,T2={paths:{path44:{type:"path",points:[{x:-.18,y:-.03},{x:-.45,y:-.03}],color:"primary",fill:!1},"path44-0":{type:"path",points:[{x:.45,y:-.03},{x:.18,y:-.02}],color:"primary",fill:!1},"path44-0-7":{type:"path",points:[{x:.07,y:-.02},{x:-.07,y:-.02}],color:"primary",fill:!1},path2:{type:"path",points:[{x:.07,y:.1},{x:.07,y:-.15}],color:"primary",fill:!0},"path2-8":{type:"path",points:[{x:-.07,y:.1},{x:-.07,y:-.15}],color:"primary",fill:!0},"path8704-1":{type:"path",points:[{x:-.07,y:-.15},{x:-.07,y:-.15},{x:-.09,y:-.15},{x:-.1,y:-.14},{x:-.11,y:-.13},{x:-.13,y:-.12},{x:-.14,y:-.11},{x:-.14,y:-.1},{x:-.15,y:-.09},{x:-.16,y:-.08},{x:-.16,y:-.07},{x:-.16,y:-.06},{x:-.17,y:-.05},{x:-.17,y:-.04},{x:-.17,y:-.03},{x:-.17,y:-.02},{x:-.17,y:-.01},{x:-.16,y:0},{x:-.16,y:.01},{x:-.16,y:.02},{x:-.15,y:.03},{x:-.15,y:.04},{x:-.14,y:.05},{x:-.14,y:.05},{x:-.13,y:.06},{x:-.12,y:.07},{x:-.11,y:.08},{x:-.11,y:.08},{x:-.1,y:.09},{x:-.09,y:.09},{x:-.08,y:.1},{x:-.07,y:.1},{x:-.07,y:.1}],color:"primary",fill:!1},"path8704-1-7":{type:"path",points:[{x:.07,y:-.15},{x:.07,y:-.15},{x:.09,y:-.15},{x:.1,y:-.14},{x:.12,y:-.13},{x:.13,y:-.12},{x:.14,y:-.11},{x:.14,y:-.1},{x:.15,y:-.09},{x:.16,y:-.08},{x:.16,y:-.07},{x:.17,y:-.06},{x:.17,y:-.05},{x:.17,y:-.04},{x:.17,y:-.03},{x:.17,y:-.02},{x:.17,y:-.01},{x:.16,y:0},{x:.16,y:.01},{x:.16,y:.02},{x:.15,y:.03},{x:.15,y:.04},{x:.14,y:.05},{x:.14,y:.05},{x:.13,y:.06},{x:.12,y:.07},{x:.11,y:.08},{x:.11,y:.08},{x:.1,y:.09},{x:.09,y:.09},{x:.08,y:.1},{x:.07,y:.1},{x:.07,y:.1}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.02,y:.15}},refblocks:{left1:{x:-.45,y:-.03},right1:{x:.45,y:-.03}},bounds:{minX:-.47,maxX:.47,minY:-.15,maxY:.15,width:.95,height:.31,centerX:0,centerY:0},circles:{}},Dwt=_t(T2).rotateRightFacingSymbol("down").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_left").build(),jwt=_t(T2).rotateRightFacingSymbol("left").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_top").build(),Bwt=_t(T2).rotateRightFacingSymbol("right").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_bottom").build(),Ywt=_t(T2).rotateRightFacingSymbol("up").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_right").build(),E2={paths:{path44:{type:"path",points:[{x:-.18,y:-.03},{x:-.45,y:-.03}],color:"primary",fill:!1},"path44-0":{type:"path",points:[{x:.45,y:-.03},{x:.18,y:-.02}],color:"primary",fill:!1},path2:{type:"path",points:[{x:.07,y:.1},{x:.07,y:-.15}],color:"primary",fill:!0},"path2-8":{type:"path",points:[{x:-.07,y:.1},{x:-.07,y:-.15}],color:"primary",fill:!0},"path8704-1":{type:"path",points:[{x:-.07,y:-.15},{x:-.07,y:-.15},{x:-.09,y:-.15},{x:-.1,y:-.14},{x:-.11,y:-.13},{x:-.13,y:-.12},{x:-.14,y:-.11},{x:-.14,y:-.1},{x:-.15,y:-.09},{x:-.16,y:-.08},{x:-.16,y:-.07},{x:-.16,y:-.06},{x:-.17,y:-.05},{x:-.17,y:-.04},{x:-.17,y:-.03},{x:-.17,y:-.02},{x:-.17,y:-.01},{x:-.16,y:0},{x:-.16,y:.01},{x:-.16,y:.02},{x:-.15,y:.03},{x:-.15,y:.04},{x:-.14,y:.05},{x:-.14,y:.05},{x:-.13,y:.06},{x:-.12,y:.07},{x:-.11,y:.08},{x:-.11,y:.08},{x:-.1,y:.09},{x:-.09,y:.09},{x:-.08,y:.1},{x:-.07,y:.1},{x:-.07,y:.1}],color:"primary",fill:!1},"path8704-1-7":{type:"path",points:[{x:.07,y:-.15},{x:.07,y:-.15},{x:.09,y:-.15},{x:.1,y:-.14},{x:.12,y:-.13},{x:.13,y:-.12},{x:.14,y:-.11},{x:.14,y:-.1},{x:.15,y:-.09},{x:.16,y:-.08},{x:.16,y:-.07},{x:.17,y:-.06},{x:.17,y:-.05},{x:.17,y:-.04},{x:.17,y:-.03},{x:.17,y:-.02},{x:.17,y:-.01},{x:.16,y:0},{x:.16,y:.01},{x:.16,y:.02},{x:.15,y:.03},{x:.15,y:.04},{x:.14,y:.05},{x:.14,y:.05},{x:.13,y:.06},{x:.12,y:.07},{x:.11,y:.08},{x:.11,y:.08},{x:.1,y:.09},{x:.09,y:.09},{x:.08,y:.1},{x:.07,y:.1},{x:.07,y:.1}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.02,y:.15}},refblocks:{left1:{x:-.45,y:-.03},right1:{x:.45,y:-.03}},bounds:{minX:-.47,maxX:.47,minY:-.15,maxY:.15,width:.95,height:.31,centerX:0,centerY:0},circles:{}},Xwt=_t(E2).rotateRightFacingSymbol("down").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_left").build(),Uwt=_t(E2).rotateRightFacingSymbol("left").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_top").build(),Vwt=_t(E2).rotateRightFacingSymbol("right").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_bottom").build(),Gwt=_t(E2).rotateRightFacingSymbol("up").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_right").build(),M2={paths:{path44:{type:"path",points:[{x:-.22,y:.1},{x:-.45,y:.1}],color:"primary",fill:!1},"path44-0":{type:"path",points:[{x:.45,y:.1},{x:.22,y:.1}],color:"primary",fill:!1},"path44-5":{type:"path",points:[{x:0,y:-.03},{x:0,y:-.25}],color:"primary",fill:!1},path2:{type:"path",points:[{x:.12,y:.23},{x:.12,y:-.02}],color:"primary",fill:!0},"path2-88":{type:"path",points:[{x:.04,y:.22},{x:.04,y:-.02}],color:"primary",fill:!0},"path2-88-5":{type:"path",points:[{x:-.05,y:.22},{x:-.05,y:-.02}],color:"primary",fill:!0},"path2-88-5-1":{type:"path",points:[{x:.04,y:.22},{x:-.05,y:.22}],color:"primary",fill:!0},"path2-88-5-1-6":{type:"path",points:[{x:.04,y:-.02},{x:-.05,y:-.02}],color:"primary",fill:!0},"path2-8":{type:"path",points:[{x:-.12,y:.23},{x:-.12,y:-.02}],color:"primary",fill:!0},"path8704-1":{type:"path",points:[{x:-.13,y:-.03},{x:-.13,y:-.03},{x:-.14,y:-.02},{x:-.16,y:-.01},{x:-.17,y:0},{x:-.18,y:.01},{x:-.19,y:.02},{x:-.2,y:.03},{x:-.2,y:.04},{x:-.21,y:.05},{x:-.21,y:.06},{x:-.22,y:.07},{x:-.22,y:.08},{x:-.22,y:.09},{x:-.22,y:.1},{x:-.22,y:.11},{x:-.22,y:.12},{x:-.22,y:.13},{x:-.21,y:.14},{x:-.21,y:.15},{x:-.21,y:.15},{x:-.2,y:.16},{x:-.19,y:.17},{x:-.19,y:.18},{x:-.18,y:.19},{x:-.17,y:.2},{x:-.17,y:.2},{x:-.16,y:.21},{x:-.15,y:.22},{x:-.14,y:.22},{x:-.13,y:.23},{x:-.13,y:.23},{x:-.13,y:.23}],color:"primary",fill:!1},"path8704-1-7":{type:"path",points:[{x:.12,y:-.03},{x:.12,y:-.03},{x:.14,y:-.02},{x:.15,y:-.01},{x:.17,y:0},{x:.18,y:.01},{x:.19,y:.02},{x:.2,y:.03},{x:.2,y:.04},{x:.21,y:.05},{x:.21,y:.06},{x:.22,y:.07},{x:.22,y:.08},{x:.22,y:.09},{x:.22,y:.1},{x:.22,y:.11},{x:.22,y:.12},{x:.22,y:.13},{x:.21,y:.14},{x:.21,y:.15},{x:.2,y:.15},{x:.2,y:.16},{x:.19,y:.17},{x:.19,y:.18},{x:.18,y:.19},{x:.17,y:.2},{x:.17,y:.2},{x:.16,y:.21},{x:.15,y:.21},{x:.14,y:.22},{x:.13,y:.23},{x:.12,y:.23},{x:.12,y:.23}],color:"primary",fill:!1},path1:{type:"path",points:[{x:-.05,y:.1},{x:-.12,y:.1}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.02,y:.28}},refblocks:{bottom1:{x:0,y:-.25},left1:{x:-.45,y:.1},right1:{x:.45,y:.1}},bounds:{minX:-.47,maxX:.47,minY:-.28,maxY:.28,width:.95,height:.56,centerX:0,centerY:0},circles:{}},Hwt=_t(M2).rotateRightFacingSymbol("down").labelPort("left1",["1"]).labelPort("bottom1",["2"]).labelPort("right1",["3"]).changeTextAnchor("{REF}","middle_left").build(),Wwt=_t(M2).rotateRightFacingSymbol("left").labelPort("left1",["1"]).labelPort("bottom1",["2"]).labelPort("right1",["3"]).changeTextAnchor("{REF}","middle_top").build(),qwt=_t(M2).rotateRightFacingSymbol("right").labelPort("left1",["1"]).labelPort("bottom1",["2"]).labelPort("right1",["3"]).changeTextAnchor("{REF}","middle_bottom").build(),Zwt=_t(M2).rotateRightFacingSymbol("up").labelPort("left1",["1"]).labelPort("bottom1",["2"]).labelPort("right1",["3"]).changeTextAnchor("{REF}","middle_right").build(),C2={paths:{path44:{type:"path",points:[{x:-.22,y:.1},{x:-.45,y:.1}],color:"primary",fill:!1},"path44-0":{type:"path",points:[{x:.45,y:.1},{x:.22,y:.1}],color:"primary",fill:!1},"path44-0-7":{type:"path",points:[{x:.12,y:.1},{x:.04,y:.1}],color:"primary",fill:!1},"path44-5":{type:"path",points:[{x:0,y:-.03},{x:0,y:-.25}],color:"primary",fill:!1},path2:{type:"path",points:[{x:.12,y:.23},{x:.12,y:-.02}],color:"primary",fill:!0},"path2-88":{type:"path",points:[{x:.04,y:.22},{x:.04,y:-.02}],color:"primary",fill:!0},"path2-88-5":{type:"path",points:[{x:-.05,y:.22},{x:-.05,y:-.02}],color:"primary",fill:!0},"path2-88-5-1":{type:"path",points:[{x:.04,y:.22},{x:-.05,y:.22}],color:"primary",fill:!0},"path2-88-5-1-6":{type:"path",points:[{x:.04,y:-.02},{x:-.05,y:-.02}],color:"primary",fill:!0},"path2-8":{type:"path",points:[{x:-.12,y:.23},{x:-.12,y:-.02}],color:"primary",fill:!0},"path8704-1":{type:"path",points:[{x:-.13,y:-.03},{x:-.13,y:-.03},{x:-.14,y:-.02},{x:-.16,y:-.01},{x:-.17,y:0},{x:-.18,y:.01},{x:-.19,y:.02},{x:-.2,y:.03},{x:-.2,y:.04},{x:-.21,y:.05},{x:-.21,y:.06},{x:-.22,y:.07},{x:-.22,y:.08},{x:-.22,y:.09},{x:-.22,y:.1},{x:-.22,y:.11},{x:-.22,y:.12},{x:-.22,y:.13},{x:-.21,y:.14},{x:-.21,y:.15},{x:-.21,y:.15},{x:-.2,y:.16},{x:-.19,y:.17},{x:-.19,y:.18},{x:-.18,y:.19},{x:-.17,y:.2},{x:-.17,y:.2},{x:-.16,y:.21},{x:-.15,y:.22},{x:-.14,y:.22},{x:-.13,y:.23},{x:-.13,y:.23},{x:-.13,y:.23}],color:"primary",fill:!1},"path8704-1-7":{type:"path",points:[{x:.12,y:-.03},{x:.12,y:-.03},{x:.14,y:-.02},{x:.15,y:-.01},{x:.17,y:0},{x:.18,y:.01},{x:.19,y:.02},{x:.2,y:.03},{x:.2,y:.04},{x:.21,y:.05},{x:.21,y:.06},{x:.22,y:.07},{x:.22,y:.08},{x:.22,y:.09},{x:.22,y:.1},{x:.22,y:.11},{x:.22,y:.12},{x:.22,y:.13},{x:.21,y:.14},{x:.21,y:.15},{x:.2,y:.15},{x:.2,y:.16},{x:.19,y:.17},{x:.19,y:.18},{x:.18,y:.19},{x:.17,y:.2},{x:.17,y:.2},{x:.16,y:.21},{x:.15,y:.21},{x:.14,y:.22},{x:.13,y:.23},{x:.12,y:.23},{x:.12,y:.23}],color:"primary",fill:!1},path1:{type:"path",points:[{x:-.05,y:.1},{x:-.12,y:.1}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.02,y:.28}},refblocks:{bottom1:{x:0,y:-.25},left1:{x:-.45,y:.1},right1:{x:.45,y:.1}},bounds:{minX:-.47,maxX:.47,minY:-.28,maxY:.28,width:.95,height:.56,centerX:0,centerY:0},circles:{}},Kwt=_t(C2).rotateRightFacingSymbol("down").labelPort("left1",["1"]).labelPort("bottom1",["2"]).labelPort("right1",["3"]).changeTextAnchor("{REF}","middle_left").build(),Jwt=_t(C2).rotateRightFacingSymbol("left").labelPort("left1",["1"]).labelPort("bottom1",["2"]).labelPort("right1",["3"]).changeTextAnchor("{REF}","middle_top").build(),Qwt=_t(C2).rotateRightFacingSymbol("right").labelPort("left1",["1"]).labelPort("bottom1",["2"]).labelPort("right1",["3"]).changeTextAnchor("{REF}","middle_bottom").build(),tPt=_t(C2).rotateRightFacingSymbol("up").labelPort("left1",["1"]).labelPort("bottom1",["2"]).labelPort("right1",["3"]).changeTextAnchor("{REF}","middle_right").build(),I2={paths:{path44:{type:"path",points:[{x:-.22,y:.1},{x:-.45,y:.1}],color:"primary",fill:!1},"path44-0":{type:"path",points:[{x:.45,y:.1},{x:.22,y:.1}],color:"primary",fill:!1},"path44-0-7":{type:"path",points:[{x:.12,y:.1},{x:.04,y:.1}],color:"primary",fill:!1},"path44-5":{type:"path",points:[{x:0,y:-.03},{x:0,y:-.25}],color:"primary",fill:!1},path2:{type:"path",points:[{x:.12,y:.23},{x:.12,y:-.02}],color:"primary",fill:!0},"path2-88":{type:"path",points:[{x:.04,y:.22},{x:.04,y:-.02}],color:"primary",fill:!0},"path2-88-5":{type:"path",points:[{x:-.05,y:.22},{x:-.05,y:-.02}],color:"primary",fill:!0},"path2-88-5-1":{type:"path",points:[{x:.04,y:.22},{x:-.05,y:.22}],color:"primary",fill:!0},"path2-88-5-1-6":{type:"path",points:[{x:.04,y:-.02},{x:-.05,y:-.02}],color:"primary",fill:!0},"path2-8":{type:"path",points:[{x:-.12,y:.23},{x:-.12,y:-.02}],color:"primary",fill:!0},"path8704-1":{type:"path",points:[{x:-.13,y:-.03},{x:-.13,y:-.03},{x:-.14,y:-.02},{x:-.16,y:-.01},{x:-.17,y:0},{x:-.18,y:.01},{x:-.19,y:.02},{x:-.2,y:.03},{x:-.2,y:.04},{x:-.21,y:.05},{x:-.21,y:.06},{x:-.22,y:.07},{x:-.22,y:.08},{x:-.22,y:.09},{x:-.22,y:.1},{x:-.22,y:.11},{x:-.22,y:.12},{x:-.22,y:.13},{x:-.21,y:.14},{x:-.21,y:.15},{x:-.21,y:.15},{x:-.2,y:.16},{x:-.19,y:.17},{x:-.19,y:.18},{x:-.18,y:.19},{x:-.17,y:.2},{x:-.17,y:.2},{x:-.16,y:.21},{x:-.15,y:.22},{x:-.14,y:.22},{x:-.13,y:.23},{x:-.13,y:.23},{x:-.13,y:.23}],color:"primary",fill:!1},"path8704-1-7":{type:"path",points:[{x:.12,y:-.03},{x:.12,y:-.03},{x:.14,y:-.02},{x:.15,y:-.01},{x:.17,y:0},{x:.18,y:.01},{x:.19,y:.02},{x:.2,y:.03},{x:.2,y:.04},{x:.21,y:.05},{x:.21,y:.06},{x:.22,y:.07},{x:.22,y:.08},{x:.22,y:.09},{x:.22,y:.1},{x:.22,y:.11},{x:.22,y:.12},{x:.22,y:.13},{x:.21,y:.14},{x:.21,y:.15},{x:.2,y:.15},{x:.2,y:.16},{x:.19,y:.17},{x:.19,y:.18},{x:.18,y:.19},{x:.17,y:.2},{x:.17,y:.2},{x:.16,y:.21},{x:.15,y:.21},{x:.14,y:.22},{x:.13,y:.23},{x:.12,y:.23},{x:.12,y:.23}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.02,y:.28}},refblocks:{bottom1:{x:0,y:-.25},left1:{x:-.45,y:.1},right1:{x:.45,y:.1}},bounds:{minX:-.47,maxX:.47,minY:-.28,maxY:.28,width:.95,height:.56,centerX:0,centerY:0},circles:{}},ePt=_t(I2).rotateRightFacingSymbol("down").labelPort("left1",["1"]).labelPort("bottom1",["2"]).labelPort("right1",["3"]).changeTextAnchor("{REF}","middle_left").build(),nPt=_t(I2).rotateRightFacingSymbol("left").labelPort("left1",["1"]).labelPort("bottom1",["2"]).labelPort("right1",["3"]).changeTextAnchor("{REF}","middle_top").build(),iPt=_t(I2).rotateRightFacingSymbol("right").labelPort("left1",["1"]).labelPort("bottom1",["2"]).labelPort("right1",["3"]).changeTextAnchor("{REF}","middle_bottom").build(),rPt=_t(I2).rotateRightFacingSymbol("up").labelPort("left1",["1"]).labelPort("bottom1",["2"]).labelPort("right1",["3"]).changeTextAnchor("{REF}","middle_right").build(),N2={paths:{path44:{type:"path",points:[{x:-.22,y:.1},{x:-.45,y:.1}],color:"primary",fill:!1},"path44-0":{type:"path",points:[{x:.45,y:.1},{x:.22,y:.1}],color:"primary",fill:!1},"path44-5":{type:"path",points:[{x:0,y:-.03},{x:0,y:-.25}],color:"primary",fill:!1},path2:{type:"path",points:[{x:.12,y:.23},{x:.12,y:-.02}],color:"primary",fill:!0},"path2-88":{type:"path",points:[{x:.04,y:.22},{x:.04,y:-.02}],color:"primary",fill:!0},"path2-88-5":{type:"path",points:[{x:-.05,y:.22},{x:-.05,y:-.02}],color:"primary",fill:!0},"path2-88-5-1":{type:"path",points:[{x:.04,y:.22},{x:-.05,y:.22}],color:"primary",fill:!0},"path2-88-5-1-6":{type:"path",points:[{x:.04,y:-.02},{x:-.05,y:-.02}],color:"primary",fill:!0},"path2-8":{type:"path",points:[{x:-.12,y:.23},{x:-.12,y:-.02}],color:"primary",fill:!0},"path8704-1":{type:"path",points:[{x:-.13,y:-.03},{x:-.13,y:-.03},{x:-.14,y:-.02},{x:-.16,y:-.01},{x:-.17,y:0},{x:-.18,y:.01},{x:-.19,y:.02},{x:-.2,y:.03},{x:-.2,y:.04},{x:-.21,y:.05},{x:-.21,y:.06},{x:-.22,y:.07},{x:-.22,y:.08},{x:-.22,y:.09},{x:-.22,y:.1},{x:-.22,y:.11},{x:-.22,y:.12},{x:-.22,y:.13},{x:-.21,y:.14},{x:-.21,y:.15},{x:-.21,y:.15},{x:-.2,y:.16},{x:-.19,y:.17},{x:-.19,y:.18},{x:-.18,y:.19},{x:-.17,y:.2},{x:-.17,y:.2},{x:-.16,y:.21},{x:-.15,y:.22},{x:-.14,y:.22},{x:-.13,y:.23},{x:-.13,y:.23},{x:-.13,y:.23}],color:"primary",fill:!1},"path8704-1-7":{type:"path",points:[{x:.12,y:-.03},{x:.12,y:-.03},{x:.14,y:-.02},{x:.15,y:-.01},{x:.17,y:0},{x:.18,y:.01},{x:.19,y:.02},{x:.2,y:.03},{x:.2,y:.04},{x:.21,y:.05},{x:.21,y:.06},{x:.22,y:.07},{x:.22,y:.08},{x:.22,y:.09},{x:.22,y:.1},{x:.22,y:.11},{x:.22,y:.12},{x:.22,y:.13},{x:.21,y:.14},{x:.21,y:.15},{x:.2,y:.15},{x:.2,y:.16},{x:.19,y:.17},{x:.19,y:.18},{x:.18,y:.19},{x:.17,y:.2},{x:.17,y:.2},{x:.16,y:.21},{x:.15,y:.21},{x:.14,y:.22},{x:.13,y:.23},{x:.12,y:.23},{x:.12,y:.23}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.02,y:.28}},refblocks:{bottom1:{x:0,y:-.25},left1:{x:-.45,y:.1},right1:{x:.45,y:.1}},bounds:{minX:-.47,maxX:.47,minY:-.28,maxY:.28,width:.95,height:.56,centerX:0,centerY:0},circles:{}},sPt=_t(N2).rotateRightFacingSymbol("down").labelPort("left1",["1"]).labelPort("bottom1",["2"]).labelPort("right1",["3"]).changeTextAnchor("{REF}","middle_left").build(),oPt=_t(N2).rotateRightFacingSymbol("left").labelPort("left1",["1"]).labelPort("bottom1",["2"]).labelPort("right1",["3"]).changeTextAnchor("{REF}","middle_top").build(),aPt=_t(N2).rotateRightFacingSymbol("right").labelPort("left1",["1"]).labelPort("bottom1",["2"]).labelPort("right1",["3"]).changeTextAnchor("{REF}","middle_bottom").build(),cPt=_t(N2).rotateRightFacingSymbol("up").labelPort("left1",["1"]).labelPort("bottom1",["2"]).labelPort("right1",["3"]).changeTextAnchor("{REF}","middle_right").build(),lPt={paths:{path1:{type:"path",points:[{x:-.37,y:.03},{x:-.13,y:.03}],color:"primary",fill:!1},"path-1-3":{type:"path",points:[{x:-.07,y:.03},{x:.11,y:-.03}],color:"primary",fill:!1},path2:{type:"path",points:[{x:.1,y:-.06},{x:.37,y:-.06}],color:"primary",fill:!1},path3:{type:"path",points:[{x:.12,y:.17},{x:.37,y:.17}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:0,y:.37},bottom1:{type:"text",text:"{VAL}",x:0,y:-.37}},refblocks:{left1:{x:-.37,y:.03},right1:{x:.37,y:-.06},right2:{x:.37,y:.17}},bounds:{minX:-.4,maxX:.4,minY:-.4,maxY:.4,width:.79,height:.79,centerX:0,centerY:0},circles:{"circle-3":{type:"circle",x:.08,y:-.07,radius:.02,color:"primary",fill:!1},"circle-1":{type:"circle",x:-.1,y:.03,radius:.02,color:"primary",fill:!1},"circle-2":{type:"circle",x:.08,y:.17,radius:.02,color:"primary",fill:!1}}},A2=_t(lPt).changeTextAnchor("{VAL}","middle_top").labelPort("left1",["1"]).labelPort("right2",["2"]).labelPort("right1",["3"]).changeTextAnchor("{REF}","middle_bottom").build(),_I=Lt(A2,"down"),yI=_I.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),gI=_I.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");yI.anchor="middle_bottom";gI.anchor="middle_top";yI.x=.44;yI.y+=.28;gI.y-=.28;gI.x=.44;uPt=_I,xI=Lt(A2,"left"),bI=xI.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),vI=xI.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");bI.anchor="middle_bottom";vI.anchor="middle_top";bI.x=0;bI.y+=.625;vI.y-=.695;vI.x=0;pPt=xI,SI=Lt(A2,"up"),wI=SI.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),PI=SI.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");wI.anchor="middle_bottom";PI.anchor="middle_top";wI.x=.4;wI.y+=.28;PI.y-=.28;PI.x=.4;hPt=SI,dPt={paths:{path1:{type:"path",points:[{x:-.37,y:.03},{x:-.13,y:.03}],color:"primary",fill:!1},"path-1-3":{type:"path",points:[{x:-.07,y:.03},{x:.11,y:.14}],color:"primary",fill:!1},path2:{type:"path",points:[{x:.1,y:-.06},{x:.37,y:-.06}],color:"primary",fill:!1},path3:{type:"path",points:[{x:.12,y:.17},{x:.37,y:.17}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:0,y:.4},bottom1:{type:"text",text:"{VAL}",x:0,y:-.4}},refblocks:{left1:{x:-.37,y:.03},right1:{x:.37,y:-.06},right3:{x:.37,y:.17}},bounds:{minX:-.4,maxX:.4,minY:-.4,maxY:.4,width:.79,height:.79,centerX:0,centerY:0},circles:{"circle-3":{type:"circle",x:.08,y:-.07,radius:.02,color:"primary",fill:!1},"circle-1":{type:"circle",x:-.1,y:.03,radius:.02,color:"primary",fill:!1},"circle-2":{type:"circle",x:.08,y:.17,radius:.02,color:"primary",fill:!1}}},R2=_t(dPt).changeTextAnchor("{VAL}","middle_top").labelPort("left1",["1"]).labelPort("right3",["2"]).labelPort("right1",["3"]).changeTextAnchor("{REF}","middle_bottom").build(),kI=Lt(R2,"down"),TI=kI.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),EI=kI.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");TI.anchor="middle_bottom";EI.anchor="middle_top";TI.x=.44;TI.y+=.28;EI.y-=.28;EI.x=.44;fPt=kI,MI=Lt(R2,"left"),CI=MI.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),II=MI.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");CI.anchor="middle_bottom";II.anchor="middle_top";CI.x=0;CI.y+=.625;II.y-=.695;II.x=0;mPt=MI,NI=Lt(R2,"up"),AI=NI.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),RI=NI.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");AI.anchor="middle_bottom";RI.anchor="middle_top";AI.x=.4;AI.y+=.28;RI.y-=.28;RI.x=.4;_Pt=NI,O2={paths:{path11:{type:"path",points:[{x:-.38,y:0},{x:-.12,y:-.01}],color:"primary",fill:!1},"path11-0":{type:"path",points:[{x:-.07,y:0},{x:.11,y:.05}],color:"primary",fill:!1},path12:{type:"path",points:[{x:.12,y:-.01},{x:.38,y:0}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:0,y:.31},bottom1:{type:"text",text:"{VAL}",x:0,y:-.28}},refblocks:{left1:{x:-.12,y:-.01},left2:{x:-.38,y:0},right1:{x:.12,y:-.01},right2:{x:.38,y:0}},bounds:{minX:-.4,maxX:.4,minY:-.25,maxY:.25,width:.81,height:.5,centerX:0,centerY:0},circles:{"circle-2":{type:"circle",x:.1,y:0,radius:.02,color:"primary",fill:!1},"circle-1":{type:"circle",x:-.1,y:0,radius:.02,color:"primary",fill:!1}}};delete O2.refblocks.left1;delete O2.refblocks.right1;O2.bounds.width+=.2;L2=_t(O2).changeTextAnchor("{VAL}","middle_top").labelPort("left2",["1"]).labelPort("right2",["2"]).changeTextAnchor("{REF}","middle_bottom").build(),OI=Lt(L2,"down"),LI=OI.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),FI=OI.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");LI.anchor="middle_bottom";FI.anchor="middle_top";LI.x=.3;LI.y+=.265;FI.y-=.265;FI.x=.3;yPt=OI,zI=Lt(L2,"left"),$I=zI.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),DI=zI.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");$I.anchor="middle_bottom";DI.anchor="middle_top";$I.x=0;$I.y+=.57;DI.y-=.57;DI.x=0;gPt=zI,jI=Lt(L2,"up"),BI=jI.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),YI=jI.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");BI.anchor="middle_bottom";YI.anchor="middle_top";BI.x=.3;BI.y+=.265;YI.y-=.265;YI.x=.3;xPt=jI,F2={paths:{path11:{type:"path",points:[{x:-.38,y:0},{x:-.12,y:-.01}],color:"primary",fill:!1},"path11-0":{type:"path",points:[{x:-.07,y:.01},{x:.1,y:.14}],color:"primary",fill:!1},path12:{type:"path",points:[{x:.12,y:-.01},{x:.38,y:0}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:0,y:.25},bottom1:{type:"text",text:"{VAL}",x:0,y:-.25}},refblocks:{left1:{x:-.12,y:-.01},left2:{x:-.38,y:0},right1:{x:.12,y:-.01},right2:{x:.38,y:0}},bounds:{minX:-.4,maxX:.4,minY:-.25,maxY:.25,width:.81,height:.5,centerX:0,centerY:0},circles:{"circle-2":{type:"circle",x:.1,y:0,radius:.02,color:"primary",fill:!1},"circle-1":{type:"circle",x:-.1,y:0,radius:.02,color:"primary",fill:!1}}};delete F2.refblocks.left1;delete F2.refblocks.right1;F2.bounds.width+=.2;z2=_t(F2).changeTextAnchor("{VAL}","middle_top").labelPort("left2",["1"]).labelPort("right2",["2"]).changeTextAnchor("{REF}","middle_bottom").build(),XI=Lt(z2,"down"),UI=XI.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),VI=XI.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");UI.anchor="middle_bottom";VI.anchor="middle_top";UI.x=.3;UI.y+=.265;VI.y-=.265;VI.x=.3;bPt=XI,GI=Lt(z2,"left"),HI=GI.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),WI=GI.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");HI.anchor="middle_bottom";WI.anchor="middle_top";HI.x=0;HI.y+=.57;WI.y-=.57;WI.x=0;vPt=GI,qI=Lt(z2,"up"),ZI=qI.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),KI=qI.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");ZI.anchor="middle_bottom";KI.anchor="middle_top";ZI.x=.3;ZI.y+=.265;KI.y-=.265;KI.x=.3;SPt=qI,$2={paths:{path44:{type:"path",points:[{x:-.16845120000000047,y:.02621170000000017},{x:-.4458008,y:.02709619999999968}],color:"primary",fill:!1},"path44-0":{type:"path",points:[{x:.4458008,y:.026971799999999657},{x:.1677968999999997,y:.027926399999999685}],color:"primary",fill:!1},"path8704-1":{type:"path",points:[{x:-.0040837000000002455,y:-.13467459999999964},{x:-.0040837000000002455,y:-.13467459999999964},{x:-.017668143940740948,y:-.1311205263185182},{x:-.03043520885925943,y:-.12727072121481456},{x:-.04240966440000013,y:-.1231399985999998},{x:-.05361628020740751,y:-.11874317238518502},{x:-.064079825925926,y:-.11409505648148131},{x:-.07382507120000005,y:-.10921046479999987},{x:-.0828767856740741,y:-.10410421125185171},{x:-.0912597389925926,y:-.09879110974814802},{x:-.09899870079999995,y:-.0932859741999998},{x:-.10611844074074069,y:-.08760361851851838},{x:-.11264372845925916,y:-.0817588566148146},{x:-.11859933359999993,y:-.07576650239999982},{x:-.12401002580740728,y:-.06964136978518495},{x:-.12890057472592584,y:-.06339827268148127},{x:-.13329574999999985,y:-.05705202499999972},{x:-.13722032127407394,y:-.05061744065185156},{x:-.14069905819259243,y:-.04410933354814783},{x:-.14375673039999987,y:-.03754251759999966},{x:-.14641810754074058,y:-.030931806718518143},{x:-.1487079592592591,y:-.0242920148148144},{x:-.15065105519999983,y:-.017637955799999563},{x:-.15227216500740723,y:-.01098444358518472},{x:-.15359605832592574,y:-.004346292081480994},{x:-.1546475047999998,y:.00226168480000051},{x:-.15545127407407386,y:.008824673148148676},{x:-.1560321357925924,y:.015327859051852397},{x:-.1564148595999998,y:.02175642860000056},{x:-.1566242151407405,y:.028095567881482052},{x:-.15668497205925902,y:.03433046298518576},{x:-.15662189999999976,y:.04044630000000058},{x:-.15662189999999976,y:.0404463000000006},{x:-.15662189999999976,y:.0404463000000006},{x:-.15622857394444417,y:.04717166472222282},{x:-.1553217675555553,y:.05388046444444503},{x:-.15392183849999977,y:.060558907500000585},{x:-.1520491444444442,y:.0671932022222228},{x:-.1497240430555553,y:.07376955694444502},{x:-.14696689199999974,y:.08027418000000058},{x:-.14379804894444415,y:.0866932797222228},{x:-.1402378715555553,y:.09301306444444506},{x:-.13630671749999965,y:.09921974250000057},{x:-.13202494444444415,y:.10529952222222282},{x:-.12741291005555522,y:.11123861194444501},{x:-.1224909719999997,y:.1170232200000006},{x:-.11727948794444407,y:.12263955472222278},{x:-.11179881555555524,y:.12807382444444504},{x:-.10606931249999965,y:.13331223750000057},{x:-.1001113364444441,y:.13834100222222284},{x:-.09394524505555521,y:.14314632694444504},{x:-.08759139599999967,y:.14771442000000062},{x:-.08107014694444413,y:.15203148972222283},{x:-.07440185555555523,y:.15608374444444503},{x:-.0676068794999997,y:.15985739250000058},{x:-.06070557644444415,y:.16333864222222283},{x:-.05371830405555529,y:.16651370194444504},{x:-.04666541999999976,y:.1693687800000006},{x:-.03956728194444424,y:.1718900847222228},{x:-.03244424755555539,y:.17406382444444501},{x:-.025316674499999876,y:.17587620750000055},{x:-.01820492044444437,y:.17731344222222278},{x:-.01112934305555553,y:.178361736944445},{x:-.004110300000000034,y:.17900730000000054},{x:-.004110300000000011,y:.17900730000000054}],color:"primary",fill:!1},"path8704-1-9":{type:"path",points:[{x:.004158700000000071,y:-.1355885000000001},{x:.004158700000000071,y:-.1355885000000001},{x:.017743143940740766,y:-.1320344263185187},{x:.03051020885925925,y:-.12818462121481505},{x:.042484664399999955,y:-.12405389860000024},{x:.053691280207407335,y:-.11965707238518546},{x:.0641548259259258,y:-.11500895648148178},{x:.07390007119999986,y:-.1101243648000003},{x:.0829517856740739,y:-.10501811125185218},{x:.0913347389925924,y:-.09970500974814848},{x:.09907370079999973,y:-.09419987420000027},{x:.10619344074074046,y:-.08851751851851883},{x:.11271872845925893,y:-.08267275661481507},{x:.11867433359999968,y:-.07668040240000029},{x:.12408502580740703,y:-.0705552697851854},{x:.12897557472592555,y:-.06431217268148172},{x:.13337074999999957,y:-.05796592500000018},{x:.13729532127407365,y:-.05153134065185202},{x:.14077405819259214,y:-.045023233548148286},{x:.14383173039999952,y:-.038456417600000126},{x:.14649310754074024,y:-.03184570671851861},{x:.14878295925925875,y:-.02520591481481487},{x:.1507260551999995,y:-.01855185580000003},{x:.15234716500740686,y:-.011898343585185192},{x:.15367105832592537,y:-.005260192081481464},{x:.15472250479999944,y:.001347784800000043},{x:.1555262740740735,y:.007910773148148207},{x:.156107135792592,y:.01441395905185193},{x:.1564898595999994,y:.020842528600000094},{x:.15669921514074014,y:.02718166788148159},{x:.15675997205925862,y:.03341656298518529},{x:.15669689999999936,y:.03953240000000011},{x:.15669689999999936,y:.039532400000000134},{x:.15669689999999936,y:.039532400000000134},{x:.1563035739444438,y:.04625776472222235},{x:.15539676755555493,y:.05296656444444457},{x:.15399683849999934,y:.05964500750000013},{x:.1521241444444438,y:.06627930222222234},{x:.14979904305555491,y:.07285565694444456},{x:.14704189199999937,y:.07936028000000013},{x:.1438730489444438,y:.08577937972222234},{x:.1403128715555549,y:.09209916444444458},{x:.13638171749999925,y:.0983058425000001},{x:.13209994444444376,y:.10438562222222235},{x:.12748791005555482,y:.11032471194444453},{x:.12256597199999929,y:.11610932000000013},{x:.1173544879444437,y:.1217256547222223},{x:.11187381555555485,y:.12715992444444457},{x:.10614431249999925,y:.1323983375000001},{x:.10018633644444369,y:.13742710222222235},{x:.09402024505555481,y:.14223242694444457},{x:.08766639599999927,y:.14680052000000016},{x:.08114514694444372,y:.15111758972222236},{x:.07447685555555483,y:.15516984444444457},{x:.06768187949999929,y:.15894349250000012},{x:.06078057644444377,y:.16242474222222236},{x:.053793304055554894,y:.16559980194444457},{x:.046740419999999366,y:.16845488000000014},{x:.039642281944443844,y:.17097618472222234},{x:.03251924755555499,y:.17314992444444455},{x:.02539167449999948,y:.17496230750000008},{x:.018279920444443973,y:.17639954222222232},{x:.011204343055555134,y:.17744783694444452},{x:.004185299999999637,y:.17809340000000007},{x:.004185299999999614,y:.17809340000000007}],color:"primary",fill:!1},path4:{type:"path",points:[{x:-.08039130000000005,y:.0179576999999993},{x:-.08039130000000005,y:.09650599999999931}],color:"primary",fill:!0},"path4-5":{type:"path",points:[{x:.01494479999999987,y:-.055216500000000224},{x:.01494479999999987,y:.09691909999999937}],color:"primary",fill:!0},"path4-5-8":{type:"path",points:[{x:.06871169999999927,y:-.056870000000000864},{x:.06871169999999927,y:.018784499999999538}],color:"primary",fill:!0},"path4-1":{type:"path",points:[{x:-.08179359999999969,y:.09650570000000003},{x:.015771699999999722,y:.09650570000000003}],color:"primary",fill:!0},"path4-1-6":{type:"path",points:[{x:.0117995999999998,y:-.05594970000000088},{x:.06843709999999925,y:-.05594970000000088}],color:"primary",fill:!0},"rect1577-4":{type:"path",points:[{x:-.17162450000000073,y:.11125030000000025},{x:-.2688274000000015,y:.11125030000000025},{x:-.2688274000000015,y:.11469129999999961},{x:-.17162450000000073,y:.11469129999999961}],color:"primary",fill:!0},"rect1577-4-7":{type:"path",points:[{x:-.2184661999999995,y:.16159429999999997},{x:-.2184661999999995,y:.06439139999999943},{x:-.22190719999999908,y:.06439139999999943},{x:-.22190719999999908,y:.16159429999999997}],color:"primary",fill:!0}},texts:{top1:{type:"text",text:"{REF}",x:-.0024445000000006267,y:.23933980000000044},bottom1:{type:"text",text:"{VAL}",x:.00341719999999901,y:-.23933980000000066}},refblocks:{left1:{x:-.4458008,y:.02709619999999968},right1:{x:.4458008,y:.026971799999999657}},bounds:{minX:-.473959241,maxX:.473959241,minY:-.23933980000000066,maxY:.23933980000000044,width:.947918482,height:.4786796000000011,centerX:0,centerY:-11102230246251565e-32},circles:{}},wPt=_t($2).rotateRightFacingSymbol("down").labelPort("left1",["1","pos"]).labelPort("right1",["2","neg"]).changeTextAnchor("{REF}","middle_left",{x:.02,y:.2}).changeTextAnchor("{VAL}","middle_left",{x:.5,y:-.2}).build(),PPt=_t($2).rotateRightFacingSymbol("left").labelPort("left1",["1","pos"]).labelPort("right1",["2","neg"]).changeTextAnchor("{REF}","middle_bottom",{x:0,y:.45}).changeTextAnchor("{VAL}","middle_top",{x:0,y:-.55}).build(),kPt=_t($2).rotateRightFacingSymbol("right").labelPort("left1",["1","pos"]).labelPort("right1",["2","neg"]).changeTextAnchor("{REF}","middle_bottom").changeTextAnchor("{VAL}","middle_top").build(),TPt=_t($2).rotateRightFacingSymbol("up").labelPort("left1",["1","pos"]).labelPort("right1",["2","neg"]).changeTextAnchor("{VAL}","middle_left",{x:.02,y:-.2}).changeTextAnchor("{REF}","middle_left",{x:.5,y:.2}).build(),pV={paths:{path40:{type:"path",points:[{x:.14,y:.04},{x:-.12,y:-.09}],color:"primary",fill:!1},path41:{type:"path",points:[{x:-.12,y:.18},{x:.14,y:.04}],color:"primary",fill:!1},path42:{type:"path",points:[{x:-.12,y:-.09},{x:-.12,y:.18}],color:"primary",fill:!1},path43:{type:"path",points:[{x:.14,y:.18},{x:.14,y:-.09}],color:"primary",fill:!1},path44:{type:"path",points:[{x:-.12,y:.04},{x:-.52,y:.04}],color:"primary",fill:!1},"path44-0":{type:"path",points:[{x:.52,y:.04},{x:.15,y:.04}],color:"primary",fill:!1},"path43-5":{type:"path",points:[{x:.19,y:-.09},{x:.15,y:-.09}],color:"primary",fill:!1},"path43-5-2":{type:"path",points:[{x:.19,y:-.14},{x:.19,y:-.09}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.01,y:.27},bottom1:{type:"text",text:"{VAL}",x:0,y:-.27}},refblocks:{left1:{x:-.52,y:.04},right1:{x:.52,y:.04}},bounds:{minX:-.55,maxX:.55,minY:-.27,maxY:.27,width:1.09,height:.55,centerX:0,centerY:0},circles:{}},{paths:LKt,texts:FKt,bounds:zKt,refblocks:$Kt,circles:DKt}=pV,hV=_t(pV).changeTextAnchor("{VAL}","middle_top").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_bottom").build(),EPt=Lt(hV),MPt={paths:{path11:{type:"path",points:[{x:-.54,y:0},{x:-.3,y:0}],color:"primary",fill:!1},path12:{type:"path",points:[{x:.29,y:0},{x:.54,y:0}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.18,y:-.36},bottom1:{type:"text",text:"{VAL}",x:-.01,y:.43},left1:{type:"text",text:"RPM",x:0,y:-.02}},refblocks:{left1:{x:-.54,y:0},right1:{x:.54,y:0}},bounds:{minX:-.53,maxX:.53,minY:0,maxY:0,width:1.06,height:1,centerX:0,centerY:0},circles:{path1:{type:"circle",x:-.01,y:-.01,radius:.29,color:"primary",fill:!1}}},{paths:CPt,texts:IPt,bounds:Yv,refblocks:VX,circles:NPt}=MPt,JI=en({primitives:[...Object.values(CPt),...Object.values(NPt),{type:"text",text:"{REF}",x:0,y:-.3594553499999995,anchor:"middle_top"},{type:"text",text:"{VAL}",x:0,y:.35,anchor:"middle_bottom"},{...IPt.left1,y:.01,anchor:"center",fontSize:.2}],ports:[{...VX.left1,labels:["1"]},{...VX.right1,labels:["2"]}],size:{width:Yv.width,height:Yv.height},center:{x:Yv.centerX,y:Yv.centerY}}),{5:APt,...RPt}=JI.primitives;GX=Lt({...JI,primitives:Object.values(RPt).filter(OPt)}),LPt={...GX,primitives:[...GX.primitives,APt]},D2=en({primitives:[{type:"path",points:[{x:-.2,y:0},{x:0,y:0}],color:"primary",fill:!1},{type:"path",points:Array.from({length:8},(n,e)=>{let t=Math.PI/2-e*Math.PI/7,i=.1;return{x:.1-i*Math.cos(t),y:i*Math.sin(t)}}),color:"primary",fill:!1},{type:"text",text:"{REF}",x:.125,y:0,anchor:"middle_left"}],ports:[{x:-.2,y:0,labels:["1"]}],center:{x:0,y:0}}),dV=Lt(D2,"down"),HX=dV.primitives.find(n=>n.type==="text"&&n.text==="{REF}");HX&&(HX.anchor="middle_top");FPt=dV,zPt=Lt(D2,"left"),fV=Lt(D2,"up"),WX=fV.primitives.find(n=>n.type==="text"&&n.text==="{REF}");WX&&(WX.anchor="middle_bottom");$Pt=fV,DPt={paths:{path40:{type:"path",points:[{x:.44,y:.04},{x:.19,y:-.09}],color:"primary",fill:!1},path41:{type:"path",points:[{x:.19,y:.18},{x:.44,y:.04}],color:"primary",fill:!1},path42:{type:"path",points:[{x:.19,y:-.09},{x:.19,y:.18}],color:"primary",fill:!1},path44:{type:"path",points:[{x:.19,y:.04},{x:-.11,y:.04}],color:"primary",fill:!1},path45:{type:"path",points:[{x:-.43,y:.22},{x:-.11,y:.04}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.01,y:.27},bottom1:{type:"text",text:"{VAL}",x:0,y:-.27}},refblocks:{right1:{x:-.43,y:.22}},bounds:{minX:-.55,maxX:.55,minY:-.27,maxY:.27,width:1.09,height:.55,centerX:0,centerY:0},circles:{}},QI=_t(DPt).labelPort("right1",["1"]).changeTextAnchor("{REF}","middle_bottom").changeTextAnchor("{VAL}","middle_top").build(),t5=Lt(QI,"up"),e5=t5.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),n5=t5.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");e5.anchor="middle_bottom";n5.anchor="middle_top";e5.x=.4;e5.y+=.2;n5.y-=.3;n5.x=.4;mV=t5,i5=e2(mV),r5=i5.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),s5=i5.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");r5.anchor="middle_bottom";s5.anchor="middle_top";r5.x=.35;r5.y+=.4;s5.y-=.4;s5.x=.35;jPt=i5,o5=Lt(QI,"left"),a5=o5.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),c5=o5.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");a5.anchor="middle_bottom";c5.anchor="middle_top";a5.x=0;a5.y+=.5;c5.y-=.6;c5.x=0;BPt=o5,_V={paths:{path11:{type:"path",points:[{x:-.54,y:.04},{x:-.11,y:.04}],color:"primary",fill:!1},path12:{type:"path",points:[{x:.1,y:.04},{x:.54,y:.04}],color:"primary",fill:!1},"path11-0":{type:"path",points:[{x:-.09,y:-.15},{x:-.09,y:.26}],color:"primary",fill:!1},"path11-0-3":{type:"path",points:[{x:.09,y:-.15},{x:.09,y:.26}],color:"primary",fill:!1},"path11-0-9":{type:"path",points:[{x:-.08,y:.06},{x:-.08,y:-.15},{x:.09,y:-.05},{x:-.08,y:.06}],color:"primary",fill:!0},"path11-0-9-0":{type:"path",points:[{x:.08,y:.26},{x:.08,y:.05},{x:-.09,y:.15},{x:.07,y:.26}],color:"primary",fill:!0},"path12-2":{type:"path",points:[{x:.09,y:-.06},{x:.27,y:-.17}],color:"primary",fill:!1},"path12-2-9":{type:"path",points:[{x:.27,y:-.18},{x:.27,y:-.31}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:.01,y:.42},bottom1:{type:"text",text:"{VAL}",x:-.03,y:-.42}},refblocks:{bottom1:{x:.27,y:-.31},left1:{x:-.54,y:.04},right1:{x:.54,y:.04}},bounds:{minX:-.57,maxX:.57,minY:-.42,maxY:.42,width:1.14,height:.83,centerX:0,centerY:0},circles:{path1:{type:"circle",x:0,y:.05,radius:.29,color:"primary",fill:!1}}},{paths:jKt,texts:BKt,bounds:YKt,refblocks:XKt,circles:UKt}=_V,yV=_t(_V).changeTextAnchor("{VAL}","middle_top").labelPort("left1",["1"]).labelPort("right1",["2"]).labelPort("bottom1",["3"]).changeTextAnchor("{REF}","middle_bottom").build(),gV=Lt(yV),xV=gV.primitives.filter(n=>n.type==="text"),YPt=xV.find(n=>n.text==="{REF}"),XPt=xV.find(n=>n.text==="{VAL}");YPt.y=0;XPt.y=0;UPt=gV,VPt={paths:{path40:{type:"path",points:[{x:.14,y:.04},{x:-.12,y:-.09}],color:"primary",fill:!1},path41:{type:"path",points:[{x:-.12,y:.18},{x:.14,y:.04}],color:"primary",fill:!1},path42:{type:"path",points:[{x:-.12,y:-.09},{x:-.12,y:.18}],color:"primary",fill:!1},path43:{type:"path",points:[{x:.14,y:.18},{x:.14,y:-.09}],color:"primary",fill:!1},path44:{type:"path",points:[{x:-.12,y:.04},{x:-.52,y:.04}],color:"primary",fill:!1},"path44-0":{type:"path",points:[{x:.52,y:.04},{x:.15,y:.04}],color:"primary",fill:!1},"path43-8":{type:"path",points:[{x:.14,y:.18},{x:.08,y:.18}],color:"primary",fill:!1},"path43-8-8":{type:"path",points:[{x:.14,y:-.09},{x:.08,y:-.09}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.01,y:.27},bottom1:{type:"text",text:"{VAL}",x:0,y:-.27}},refblocks:{left1:{x:-.52,y:.04},right1:{x:.52,y:.04}},bounds:{minX:-.55,maxX:.55,minY:-.27,maxY:.27,width:1.09,height:.55,centerX:0,centerY:0},circles:{}},{paths:GPt,texts:qX,bounds:Xv,refblocks:ZX,circles:HPt}=VPt,bV=en({primitives:[...Object.values(GPt),...Object.values(HPt),{...qX.top1,anchor:"middle_bottom"},{...qX.bottom1,anchor:"middle_top"}],ports:[{...ZX.left1,labels:["1"]},{...ZX.right1,labels:["2"]}],size:{width:Xv.width,height:Xv.height},center:{x:Xv.centerX,y:Xv.centerY}}),l5=Lt(bV),WPt=l5.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),qPt=l5.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");WPt.anchor="middle_left";qPt.anchor="middle_right";ZPt=l5,KPt={paths:{path11:{type:"path",points:[{x:-.34,y:.22},{x:-.02,y:.01}],color:"primary",fill:!1},path12:{type:"path",points:[{x:.23,y:.13},{x:.23,y:.4}],color:"primary",fill:!1},"path12-2":{type:"path",points:[{x:.23,y:-.08},{x:.23,y:-.35}],color:"primary",fill:!1},"path11-0":{type:"path",points:[{x:-.01,y:-.18},{x:-.01,y:.23}],color:"primary",fill:!1},"path11-0-3":{type:"path",points:[{x:.23,y:.12},{x:-.01,y:.12}],color:"primary",fill:!1},"path11-0-9":{type:"path",points:[{x:-.11,y:.13},{x:-.17,y:.04},{x:-.06,y:.03},{x:-.11,y:.13}],color:"primary",fill:!0},"path11-0-3-8":{type:"path",points:[{x:.23,y:-.08},{x:-.01,y:-.08}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.2,y:.39},bottom1:{type:"text",text:"{VAL}",x:-.03,y:-.42}},refblocks:{top1:{x:.23,y:.4},bottom1:{x:.23,y:-.35},left1:{x:-.34,y:.22}},bounds:{minX:-.37,maxX:.37,minY:-.42,maxY:.42,width:.74,height:.85,centerX:0,centerY:0},circles:{path1:{type:"circle",x:.08,y:.01,radius:.29,color:"primary",fill:!1}}},{paths:JPt,texts:KX,bounds:Uv,refblocks:QE,circles:QPt}=KPt,vV=en({primitives:[...Object.values(JPt),...Object.values(QPt),{...KX.top1,anchor:"middle_left"},{...KX.bottom1,anchor:"middle_right"}],ports:[{...QE.top1,labels:["1"]},{...QE.bottom1,labels:["2"]},{...QE.left1,labels:["3"]}],size:{width:Uv.width,height:Uv.height},center:{x:Uv.centerX,y:Uv.centerY}}),SV=Lt(vV),wV=SV.primitives.filter(n=>n.type==="text"),tkt=wV.find(n=>n.text==="{REF}");tkt.y=.1;PV=wV.find(n=>n.text==="{VAL}");PV.y=.1;PV.x=-.4;ekt=SV,nkt={paths:{capsule_outer:{type:"path",points:[{x:-.44,y:.34},{x:-.45,y:.39},{x:-.46,y:.42},{x:-.49,y:.44},{x:-.52,y:.46},{x:-.56,y:.46},{x:-.6,y:.46},{x:-.63,y:.44},{x:-.65,y:.42},{x:-.67,y:.39},{x:-.68,y:.34},{x:-.68,y:-.34},{x:-.67,y:-.39},{x:-.65,y:-.42},{x:-.63,y:-.44},{x:-.6,y:-.45},{x:-.56,y:-.46},{x:-.52,y:-.45},{x:-.49,y:-.44},{x:-.46,y:-.42},{x:-.45,y:-.39},{x:-.44,y:-.34},{x:-.44,y:.34}],color:"primary",fill:!1},capsule_inner:{type:"path",points:[{x:-.51,y:.28},{x:-.52,y:.32},{x:-.53,y:.34},{x:-.56,y:.35},{x:-.57,y:.35},{x:-.58,y:.34},{x:-.6,y:.32},{x:-.61,y:.28},{x:-.61,y:-.28},{x:-.6,y:-.32},{x:-.58,y:-.34},{x:-.57,y:-.35},{x:-.56,y:-.35},{x:-.53,y:-.34},{x:-.52,y:-.32},{x:-.51,y:-.28},{x:-.51,y:.28}],color:"primary",fill:!0},usb_vertical:{type:"path",points:[{x:.1,y:-.4},{x:.1,y:.4}],color:"primary",fill:!1},usb_left_branch:{type:"path",points:[{x:.1,y:-.1},{x:-.03,y:.05},{x:-.03,y:.15}],color:"primary",fill:!1},usb_right_branch:{type:"path",points:[{x:.1,y:0},{x:.25,y:.15},{x:.25,y:.25}],color:"primary",fill:!1},usb_arrow:{type:"path",points:[{x:.05,y:.4},{x:.1,y:.5},{x:.15,y:.4},{x:.05,y:.4}],color:"primary",fill:!0},usb_square:{type:"path",points:[{x:.2,y:.25},{x:.3,y:.25},{x:.3,y:.35},{x:.2,y:.35},{x:.2,y:.25}],color:"primary",fill:!0}},circles:{usb_base:{type:"circle",x:.1,y:-.4,radius:.07,color:"primary",fill:!0},usb_tip_circle:{type:"circle",x:-.03,y:.15,radius:.04,color:"primary",fill:!0}},texts:{top1:{type:"text",text:"{REF}",x:-.25,y:.7}},refblocks:{},bounds:{minX:-.75,maxX:.35,minY:-.6,maxY:.75,width:1.1,height:1.35,centerX:-.2,centerY:.08}},ikt=_t(nkt).changeTextAnchor("{REF}","middle_bottom").build(),rkt={paths:{path11:{type:"path",points:[{x:-.54,y:0},{x:-.3,y:0}],color:"primary",fill:!1},path12:{type:"path",points:[{x:.29,y:0},{x:.54,y:0}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.18,y:-.36},bottom1:{type:"text",text:"{VAL}",x:-.01,y:.43},left1:{type:"text",text:"Var",x:-.19,y:.07}},refblocks:{left1:{x:-.54,y:0},right1:{x:.54,y:0}},bounds:{minX:-.53,maxX:.53,minY:0,maxY:0,width:1.06,height:1,centerX:0,centerY:0},circles:{path1:{type:"circle",x:-.01,y:-.01,radius:.29,color:"primary",fill:!1}}},{paths:skt,texts:tM,bounds:Vv,refblocks:JX,circles:okt}=rkt,kV=en({primitives:[...Object.values(skt),...Object.values(okt),{...tM.top1,x:0,y:-.3594553499999995,anchor:"middle_top"},{...tM.bottom1,x:0,y:.35,anchor:"middle_bottom"},{...tM.left1,x:-.02,y:.01,fontSize:.2,anchor:"center"}],ports:[{...JX.left1,labels:["1"]},{...JX.right1,labels:["2"]}],size:{width:Vv.width,height:Vv.height},center:{x:Vv.centerX,y:Vv.centerY}}),akt=Lt(kV),ckt={paths:{path40:{type:"path",points:[{x:.08,y:.04},{x:-.18,y:-.09}],color:"primary",fill:!1},path41:{type:"path",points:[{x:-.18,y:.18},{x:.08,y:.04}],color:"primary",fill:!1},path42:{type:"path",points:[{x:-.18,y:-.09},{x:-.18,y:.18}],color:"primary",fill:!1},path43:{type:"path",points:[{x:.09,y:.17},{x:.1,y:-.09}],color:"primary",fill:!1},path44:{type:"path",points:[{x:-.2,y:.04},{x:-.52,y:.04}],color:"primary",fill:!1},"path44-0":{type:"path",points:[{x:.52,y:.04},{x:.21,y:.04}],color:"primary",fill:!1},"path43-6":{type:"path",points:[{x:.19,y:.17},{x:.19,y:-.09}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.01,y:.27},bottom1:{type:"text",text:"{VAL}",x:0,y:-.27}},refblocks:{left1:{x:-.52,y:.04},right1:{x:.52,y:.04}},bounds:{minX:-.55,maxX:.55,minY:-.27,maxY:.27,width:1.09,height:.55,centerX:0,centerY:0},circles:{}},{paths:lkt,texts:QX,bounds:Gv,refblocks:tU,circles:ukt}=ckt,TV=en({primitives:[...Object.values(lkt),...Object.values(ukt),{...QX.top1,anchor:"middle_bottom"},{...QX.bottom1,anchor:"middle_top"}],ports:[{...tU.left1,labels:["1"]},{...tU.right1,labels:["2"]}],size:{width:Gv.width,height:Gv.height},center:{x:Gv.centerX,y:Gv.centerY}}),u5=Lt(TV),pkt=u5.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),hkt=u5.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");pkt.anchor="middle_left";hkt.anchor="middle_right";dkt=u5,fkt={paths:{path5:{type:"path",points:[{x:-.54,y:0},{x:-.26,y:0}],color:"primary",fill:!1},path6:{type:"path",points:[{x:.27,y:0},{x:.54,y:.01}],color:"primary",fill:!1},path7:{type:"path",points:[{x:.27,y:-.23},{x:-.26,y:.24}],color:"primary",fill:!1},path8:{type:"path",points:[{x:.38,y:-.23},{x:.27,y:-.23}],color:"primary",fill:!1},path9:{type:"path",points:[{x:0,y:.14},{x:.27,y:.14},{x:.27,y:-.13},{x:-.26,y:-.13},{x:-.26,y:.14},{x:0,y:.14}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.06,y:.25},bottom1:{type:"text",text:"{VAL}",x:.01,y:-.25}},refblocks:{left1:{x:-.54,y:0},right1:{x:.54,y:.01}},bounds:{minX:-.57,maxX:.57,minY:-.25,maxY:.25,width:1.13,height:.5,centerX:0,centerY:0},circles:{}},{paths:mkt,texts:eU,bounds:Hv,refblocks:nU}=fkt,EV=en({primitives:[...Object.values(mkt),{...eU.top1,anchor:"middle_left"},{...eU.bottom1,anchor:"middle_right"}],ports:[{...nU.left1,labels:["1","-"]},{...nU.right1,labels:["2","+"]}],size:{width:Hv.width,height:Hv.height},center:{x:Hv.centerX,y:Hv.centerY}}),_kt=Lt(EV),ykt={paths:{path11:{type:"path",points:[{x:-.54,y:0},{x:-.3,y:0}],color:"primary",fill:!1},path12:{type:"path",points:[{x:.29,y:0},{x:.54,y:0}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.18,y:-.36},bottom1:{type:"text",text:"{VAL}",x:-.01,y:.43},left1:{type:"text",text:"Var",x:0,y:-.02}},refblocks:{left1:{x:-.54,y:0},right1:{x:.54,y:0}},bounds:{minX:-.53,maxX:.53,minY:0,maxY:0,width:1.06,height:1,centerX:0,centerY:0},circles:{path1:{type:"circle",x:-.01,y:-.01,radius:.29,color:"primary",fill:!1}}},{paths:gkt,texts:xkt,bounds:Wv,refblocks:iU,circles:bkt}=ykt,p5=en({primitives:[...Object.values(gkt),...Object.values(bkt),{type:"text",text:"{REF}",x:0,y:-.3594553499999995,anchor:"middle_top"},{type:"text",text:"{VAL}",x:0,y:.35,anchor:"middle_bottom"},{...xkt.left1,anchor:"center",y:.02,fontSize:.2}],ports:[{...iU.left1,labels:["1"]},{...iU.right1,labels:["2"]}],size:{width:Wv.width,height:Wv.height},center:{x:Wv.centerX,y:Wv.centerY}}),{5:vkt,...Skt}=p5.primitives;rU=Lt({...p5,primitives:Object.values(Skt).filter(wkt)}),Pkt={...rU,primitives:[...rU.primitives,vkt]},j2={paths:{"path28-2":{type:"path",points:[{x:.19,y:0},{x:0,y:.09}],color:"primary",fill:!1},"path28-2-6":{type:"path",points:[{x:.19,y:0},{x:0,y:-.09}],color:"primary",fill:!1},"path29-3":{type:"path",points:[{x:.19,y:0},{x:-.23,y:0}],color:"primary",fill:!1}},texts:{right1:{type:"text",text:"{REF}",x:.25,y:0}},refblocks:{left1:{x:-.23,y:0}},bounds:{minX:-.25,maxX:.25,minY:-.09,maxY:.09,width:.5,height:.19,centerX:0,centerY:0},circles:{}};kkt=_t(j2).rotateRightFacingSymbol("down").labelPort("left1",["1"]).changeTextAnchor("{REF}","middle_top").build(),Tkt=B2(kkt,{width:.24,height:.23}),Ekt=_t(j2).rotateRightFacingSymbol("left").labelPort("left1",["1"]).changeTextAnchor("{REF}","middle_right").build(),Mkt=B2(Ekt,{width:.23,height:.24}),Ckt=_t(j2).rotateRightFacingSymbol("right").labelPort("left1",["1"]).changeTextAnchor("{REF}","middle_left").build(),Ikt=B2(Ckt,{width:.23,height:.24}),Nkt=_t(j2).rotateRightFacingSymbol("up").labelPort("left1",["1"]).changeTextAnchor("{REF}","middle_bottom").build(),Akt=B2(Nkt,{width:.24,height:.23}),MV={paths:{path11:{type:"path",points:[{x:-.54,y:.03},{x:-.3,y:.03}],color:"primary",fill:!1},"path11-5-5":{type:"path",points:[{x:.1,y:.13},{x:0,y:-.06},{x:-.11,y:.13}],color:"primary",fill:!1},path12:{type:"path",points:[{x:.29,y:.03},{x:.54,y:.03}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.02,y:.4},bottom1:{type:"text",text:"{VAL}",x:-.01,y:-.4}},refblocks:{left1:{x:-.54,y:.03},right1:{x:.54,y:.03}},bounds:{minX:-.57,maxX:.57,minY:-.4,maxY:.4,width:1.14,height:.8,centerX:0,centerY:0},circles:{path1:{type:"circle",x:0,y:.04,radius:.29,color:"primary",fill:!1}}},{paths:VKt,texts:GKt,bounds:HKt,circles:WKt,refblocks:qKt}=MV,CV=_t(MV).changeTextAnchor("{VAL}","middle_top").labelPort("left1",["1"]).labelPort("right1",["2"]).changeTextAnchor("{REF}","middle_bottom").build(),Rkt=Lt(CV),Okt={paths:{path11:{type:"path",points:[{x:-.54,y:0},{x:-.3,y:0}],color:"primary",fill:!1},path12:{type:"path",points:[{x:.29,y:0},{x:.54,y:0}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.18,y:-.36},bottom1:{type:"text",text:"{VAL}",x:-.01,y:.43},left1:{type:"text",text:"Wh",x:0,y:-.02}},refblocks:{left1:{x:-.54,y:0},right1:{x:.54,y:0}},bounds:{minX:-.53,maxX:.53,minY:0,maxY:0,width:1.06,height:1,centerX:0,centerY:0},circles:{path1:{type:"circle",x:-.01,y:-.01,radius:.29,color:"primary",fill:!1}}},{paths:Lkt,texts:Fkt,bounds:qv,refblocks:sU,circles:zkt}=Okt,h5=en({primitives:[...Object.values(Lkt),...Object.values(zkt),{type:"text",text:"{REF}",x:0,y:-.3594553499999995,anchor:"middle_top"},{type:"text",text:"{VAL}",x:0,y:.35,anchor:"middle_bottom"},{...Fkt.left1,anchor:"center",y:.01,fontSize:.2}],ports:[{...sU.left1,labels:["1"]},{...sU.right1,labels:["2"]}],size:{width:qv.width,height:qv.height},center:{x:qv.centerX,y:qv.centerY}}),{5:$kt,...Dkt}=h5.primitives;oU=Lt({...h5,primitives:Object.values(Dkt).filter(jkt)}),Bkt={...oU,primitives:[...oU.primitives,$kt]},Ykt={paths:{path11:{type:"path",points:[{x:-.54,y:0},{x:-.3,y:0}],color:"primary",fill:!1},path12:{type:"path",points:[{x:.29,y:0},{x:.54,y:0}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.18,y:-.36},bottom1:{type:"text",text:"{VAL}",x:-.01,y:.43},left1:{type:"text",text:"W",x:0,y:-.02}},refblocks:{left1:{x:-.54,y:0},right1:{x:.54,y:0}},bounds:{minX:-.53,maxX:.53,minY:0,maxY:0,width:1.06,height:1,centerX:0,centerY:0},circles:{path1:{type:"circle",x:-.01,y:-.01,radius:.29,color:"primary",fill:!1}}},{paths:Xkt,texts:Ukt,bounds:Zv,refblocks:aU,circles:Vkt}=Ykt,d5=en({primitives:[...Object.values(Xkt),...Object.values(Vkt),{type:"text",text:"{REF}",x:0,y:-.3594553499999995,anchor:"middle_top"},{type:"text",text:"{VAL}",x:0,y:.35,anchor:"middle_bottom"},{...Ukt.left1,anchor:"center",y:.01,fontSize:.3}],ports:[{...aU.left1,labels:["1"]},{...aU.right1,labels:["2"]}],size:{width:Zv.width,height:Zv.height},center:{x:Zv.centerX,y:Zv.centerY}}),{5:Gkt,...Hkt}=d5.primitives;cU=Lt({...d5,primitives:Object.values(Hkt).filter(Wkt)}),qkt={...cU,primitives:[...cU.primitives,Gkt]},Zkt={paths:{path40:{type:"path",points:[{x:.14,y:.04},{x:-.12,y:-.09}],color:"primary",fill:!1},path41:{type:"path",points:[{x:-.12,y:.18},{x:.14,y:.04}],color:"primary",fill:!1},path42:{type:"path",points:[{x:-.12,y:-.09},{x:-.12,y:.18}],color:"primary",fill:!1},path43:{type:"path",points:[{x:.14,y:.18},{x:.14,y:-.09}],color:"primary",fill:!1},path44:{type:"path",points:[{x:-.12,y:.04},{x:-.52,y:.04}],color:"primary",fill:!1},"path44-0":{type:"path",points:[{x:.52,y:.04},{x:.15,y:.04}],color:"primary",fill:!1},"path43-8":{type:"path",points:[{x:.14,y:.18},{x:.08,y:.18}],color:"primary",fill:!1}},texts:{top1:{type:"text",text:"{REF}",x:-.01,y:.27},bottom1:{type:"text",text:"{VAL}",x:0,y:-.27}},refblocks:{left1:{x:-.52,y:.04},right1:{x:.52,y:.04}},bounds:{minX:-.55,maxX:.55,minY:-.27,maxY:.27,width:1.09,height:.55,centerX:0,centerY:0},circles:{}},{paths:Kkt,texts:lU,bounds:Kv,refblocks:uU,circles:Jkt}=Zkt,IV=en({primitives:[...Object.values(Kkt),...Object.values(Jkt),{...lU.top1,anchor:"middle_bottom"},{...lU.bottom1,anchor:"middle_top"}],ports:[{...uU.left1,labels:["1"]},{...uU.right1,labels:["2"]}],size:{width:Kv.width,height:Kv.height},center:{x:Kv.centerX,y:Kv.centerY}}),f5=Lt(IV),Qkt=f5.primitives.find(n=>n.type==="text"&&n.text==="{REF}"),tTt=f5.primitives.find(n=>n.type==="text"&&n.text==="{VAL}");Qkt.anchor="middle_left";tTt.anchor="middle_right";eTt=f5,yi={ac_voltmeter_down:Kgt,ac_voltmeter_horz:t1t,ac_voltmeter_left:i1t,ac_voltmeter_right:o1t,ac_voltmeter_up:l1t,ac_voltmeter_vert:h1t,avalanche_diode_down:m1t,avalanche_diode_horz:_1t,avalanche_diode_left:x1t,avalanche_diode_right:b1t,avalanche_diode_up:w1t,avalanche_diode_vert:T1t,backward_diode_down:C1t,backward_diode_left:pU,backward_diode_right:O1t,backward_diode_up:L1t,battery_horz:hU,battery_vert:D1t,boxresistor_down:Y1t,boxresistor_left:V1t,boxresistor_right:W1t,boxresistor_small_down:K1t,boxresistor_small_left:t0t,boxresistor_small_right:i0t,boxresistor_small_up:o0t,boxresistor_up:l0t,bridged_ground_down:h0t,bridged_ground_left:m0t,bridged_ground_right:dU,bridged_ground_up:g0t,capacitor_down:v0t,capacitor_left:S0t,capacitor_polarized_down:k0t,capacitor_polarized_left:T0t,capacitor_polarized_right:C0t,capacitor_polarized_up:A0t,capacitor_right:R0t,capacitor_up:F0t,constant_current_diode_down:D0t,constant_current_diode_horz:j0t,constant_current_diode_left:X0t,constant_current_diode_right:U0t,constant_current_diode_up:H0t,constant_current_diode_vert:Z0t,crystal_4pin_down:Q0t,crystal_4pin_left:txt,crystal_4pin_right:ext,crystal_4pin_up:rxt,crystal_down:axt,crystal_left:cxt,crystal_right:lxt,crystal_up:hxt,darlington_pair_transistor_down:dxt,darlington_pair_transistor_horz:fxt,darlington_pair_transistor_left:mxt,darlington_pair_transistor_right:_xt,darlington_pair_transistor_up:yxt,darlington_pair_transistor_vert:gxt,dc_ammeter_horz:lM,dc_ammeter_vert:Ext,dc_voltmeter_down:Ixt,dc_voltmeter_horz:Rxt,dc_voltmeter_left:Fxt,dc_voltmeter_right:Dxt,dc_voltmeter_up:Yxt,dc_voltmeter_vert:Vxt,diac_down:Gxt,diac_horz:Hxt,diac_left:Wxt,diac_right:qxt,diac_up:Zxt,diac_vert:Kxt,digital_ground_down:tbt,digital_ground_left:ibt,digital_ground_right:obt,digital_ground_up:lbt,diode_down:pbt,diode_left:hbt,diode_right:u2,diode_up:dbt,dpdt_normally_closed_switch_down:mbt,dpdt_normally_closed_switch_left:_bt,dpdt_normally_closed_switch_right:p2,dpdt_normally_closed_switch_up:ybt,dpdt_switch_down:xbt,dpdt_switch_left:bbt,dpdt_switch_right:h2,dpdt_switch_up:vbt,dpst_normally_closed_switch_down:wbt,dpst_normally_closed_switch_left:Pbt,dpst_normally_closed_switch_right:d2,dpst_normally_closed_switch_up:kbt,dpst_switch_down:Ebt,dpst_switch_left:Mbt,dpst_switch_right:f2,dpst_switch_up:Cbt,ferrite_bead_down:Abt,ferrite_bead_left:Rbt,ferrite_bead_right:_U,ferrite_bead_up:mU,filled_diode_down:Fbt,filled_diode_horz:Dbt,filled_diode_left:Ybt,filled_diode_right:Vbt,filled_diode_up:Wbt,filled_diode_vert:Kbt,frequency_meter_horz:qM,frequency_meter_vert:svt,fuse_horz:yU,fuse_vert:lvt,ground_down:uvt,ground_horz:pvt,ground_left:hvt,ground_right:dvt,ground_up:fvt,ground_vert:mvt,gunn_diode_horz:_vt,gunn_diode_vert:yvt,icled_down:xvt,icled_left:bvt,icled_right:m2,icled_up:vvt,igbt_transistor_horz:gU,igbt_transistor_vert:wvt,illuminated_push_button_normally_open_horz:bU,illuminated_push_button_normally_open_vert:kvt,inductor_down:Cvt,inductor_left:Ivt,inductor_right:rC,inductor_up:wU,laser_diode_down:Nvt,laser_diode_left:Avt,laser_diode_right:_2,laser_diode_up:Rvt,led_down:zvt,led_left:$vt,led_right:fC,led_up:kU,light_dependent_resistor_horz:TU,light_dependent_resistor_vert:Yvt,mosfet_depletion_normally_on_horz:CU,mosfet_depletion_normally_on_vert:Vvt,mushroom_head_normally_open_momentary_horz:NU,mushroom_head_normally_open_momentary_vert:qvt,n_channel_d_mosfet_transistor_horz:AU,n_channel_d_mosfet_transistor_vert:Qvt,n_channel_e_mosfet_transistor_horz:LU,n_channel_e_mosfet_transistor_vert:i2t,njfet_transistor_horz:$U,njfet_transistor_vert:a2t,not_connected_down:p2t,not_connected_left:h2t,not_connected_right:y2,not_connected_up:d2t,npn_bipolar_transistor_down:_2t,npn_bipolar_transistor_horz:y2t,npn_bipolar_transistor_left:b2t,npn_bipolar_transistor_right:w2t,npn_bipolar_transistor_up:T2t,npn_bipolar_transistor_vert:C2t,opamp_no_power_down:N2t,opamp_no_power_left:A2t,opamp_no_power_right:g2,opamp_no_power_up:R2t,opamp_with_power_down:L2t,opamp_with_power_left:F2t,opamp_with_power_right:x2,opamp_with_power_up:z2t,p_channel_d_mosfet_transistor_horz:BU,p_channel_d_mosfet_transistor_vert:B2t,p_channel_e_mosfet_transistor_horz:UU,p_channel_e_mosfet_transistor_vert:V2t,photodiode_horz:HU,photodiode_vert:W2t,pjfet_transistor_horz:ZU,pjfet_transistor_vert:J2t,pnp_bipolar_transistor_down:eSt,pnp_bipolar_transistor_horz:nSt,pnp_bipolar_transistor_left:sSt,pnp_bipolar_transistor_right:cSt,pnp_bipolar_transistor_up:pSt,pnp_bipolar_transistor_vert:fSt,potentiometer_horz:QU,potentiometer_vert:gSt,potentiometer2_down:vSt,potentiometer2_left:SSt,potentiometer2_right:b2,potentiometer2_up:wSt,potentiometer3_down:TSt,potentiometer3_left:CSt,potentiometer3_right:ISt,potentiometer3_up:RSt,power_factor_meter_horz:tV,power_factor_meter_vert:zSt,push_button_normally_closed_momentary_horz:nV,push_button_normally_closed_momentary_vert:BSt,push_button_normally_open_momentary_horz:iV,push_button_normally_open_momentary_vert:VSt,rail_down:qSt,rail_left:QSt,rail_right:iwt,rail_up:owt,rectifier_diode_horz:rV,rectifier_diode_vert:hwt,resistor_down:mwt,resistor_left:gwt,resistor_right:vwt,resistor_up:Pwt,resonator_down:Ewt,resonator_horz:oV,resonator_left:Iwt,resonator_right:P2,resonator_up:Nwt,resonator_vert:Awt,schottky_diode_down:Owt,schottky_diode_left:Lwt,schottky_diode_right:k2,schottky_diode_up:Fwt,silicon_controlled_rectifier_horz:cV,silicon_controlled_rectifier_vert:$wt,solderjumper2_bridged12_down:Dwt,solderjumper2_bridged12_left:jwt,solderjumper2_bridged12_right:Bwt,solderjumper2_bridged12_up:Ywt,solderjumper2_down:Xwt,solderjumper2_left:Uwt,solderjumper2_right:Vwt,solderjumper2_up:Gwt,solderjumper3_bridged12_down:Hwt,solderjumper3_bridged12_left:Wwt,solderjumper3_bridged12_right:qwt,solderjumper3_bridged12_up:Zwt,solderjumper3_bridged123_down:Kwt,solderjumper3_bridged123_left:Jwt,solderjumper3_bridged123_right:Qwt,solderjumper3_bridged123_up:tPt,solderjumper3_bridged23_down:ePt,solderjumper3_bridged23_left:nPt,solderjumper3_bridged23_right:iPt,solderjumper3_bridged23_up:rPt,solderjumper3_down:sPt,solderjumper3_left:oPt,solderjumper3_right:aPt,solderjumper3_up:cPt,spdt_normally_closed_switch_down:uPt,spdt_normally_closed_switch_left:pPt,spdt_normally_closed_switch_right:A2,spdt_normally_closed_switch_up:hPt,spdt_switch_down:fPt,spdt_switch_left:mPt,spdt_switch_right:R2,spdt_switch_up:_Pt,spst_normally_closed_switch_down:yPt,spst_normally_closed_switch_left:gPt,spst_normally_closed_switch_right:L2,spst_normally_closed_switch_up:xPt,spst_switch_down:bPt,spst_switch_left:vPt,spst_switch_right:z2,spst_switch_up:SPt,square_wave_down:wPt,square_wave_left:PPt,square_wave_right:kPt,square_wave_up:TPt,step_recovery_diode_horz:hV,step_recovery_diode_vert:EPt,tachometer_horz:JI,tachometer_vert:LPt,testpoint_down:FPt,testpoint_left:zPt,testpoint_right:D2,testpoint_up:$Pt,tilted_ground_down:jPt,tilted_ground_left:BPt,tilted_ground_right:QI,tilted_ground_up:mV,triac_horz:yV,triac_vert:UPt,tunnel_diode_horz:bV,tunnel_diode_vert:ZPt,unijunction_transistor_horz:vV,unijunction_transistor_vert:ekt,usbc:ikt,var_meter_horz:kV,var_meter_vert:akt,varactor_diode_horz:TV,varactor_diode_vert:dkt,varistor_horz:EV,varistor_vert:_kt,varmeter_horz:p5,varmeter_vert:Pkt,vcc_down:Tkt,vcc_left:Mkt,vcc_right:Ikt,vcc_up:Akt,volt_meter_horz:CV,volt_meter_vert:Rkt,watt_hour_meter_horz:h5,watt_hour_meter_vert:Bkt,wattmeter_horz:d5,wattmeter_vert:qkt,zener_diode_horz:IV,zener_diode_vert:eTt},ZKt=Object.fromEntries(Object.keys(yi).map(n=>[n,n]))});var Hh=ue((hQt,uG)=>{"use strict";uG.exports={trueFunc:function(){return!0},falseFunc:function(){return!1}}});function oe(n,e){return Array.isArray(e)?[n.a*e[0]+n.c*e[1]+n.e,n.b*e[0]+n.d*e[1]+n.f]:{x:n.a*e.x+n.c*e.y+n.e,y:n.b*e.x+n.d*e.y+n.f}}var B5=qt(()=>{"use strict"});var Y5=qt(()=>{"use strict"});var CG=qt(()=>{"use strict"});var IG=qt(()=>{"use strict"});var X5=qt(()=>{"use strict"});function qh(n){return typeof n>"u"}var rS=qt(()=>{"use strict"});var NG=qt(()=>{"use strict";rS()});function Kn(n,e=0){return{a:1,c:0,e:n,b:0,d:1,f:e}}var Km=qt(()=>{"use strict"});function Zh(...n){n=Array.isArray(n[0])?n[0]:n;let e=(t,i)=>({a:t.a*i.a+t.c*i.b,c:t.a*i.c+t.c*i.d,e:t.a*i.e+t.c*i.f+t.e,b:t.b*i.a+t.d*i.b,d:t.b*i.c+t.d*i.d,f:t.b*i.e+t.d*i.f+t.f});switch(n.length){case 0:throw new Error("no matrices provided");case 1:return n[0];case 2:return e(n[0],n[1]);default:{let[t,i,...r]=n,s=e(t,i);return Zh(s,...r)}}}function eo(...n){return Zh(...n)}var Kh=qt(()=>{"use strict"});function AG(n,e,t){let i=m3t(n),r=_3t(n),s={a:i,c:-r,e:0,b:r,d:i,f:0};return qh(e)||qh(t)?s:Zh([Kn(e,t),s,Kn(-e,-t)])}function sS(n,e=void 0,t=void 0){return AG(n*y3t/180,e,t)}var m3t,_3t,y3t,oS=qt(()=>{"use strict";rS();Km();Kh();({cos:m3t,sin:_3t,PI:y3t}=Math)});function Cs(n,e=void 0,t=void 0,i=void 0){qh(e)&&(e=n);let r={a:n,c:0,e:0,b:0,d:e,f:0};return qh(t)||qh(i)?r:Zh([Kn(t,i),r,Kn(-t,-i)])}var vg=qt(()=>{"use strict";rS();Km();Kh()});var U5=qt(()=>{"use strict"});var wte,V5=qt(()=>{"use strict";({tan:wte}=Math)});var RG=qt(()=>{"use strict"});var G5=qt(()=>{"use strict"});var OG=qt(()=>{"use strict";X5();Kh();G5()});var LG=qt(()=>{"use strict";Y5();Km();vg();oS();V5();U5()});var FG=qt(()=>{"use strict"});var zG=qt(()=>{"use strict";FG()});function aS(n,e=!1,t=!1){e?t?n=eo(n,Cs(-1,-1)):n=eo(n,Cs(1,-1)):t&&(n=eo(n,Cs(-1,1)));let i=n.a,r=n.b,s=n.c,o=n.d,a,c,l;if(i!==0||s!==0){let u=Math.hypot(i,s);a=u,c=(i*o-r*s)/u;let p=Math.acos(i/u);l=s>0?-p:p}else if(r!==0||o!==0){let u=Math.hypot(r,o);a=(i*o-r*s)/u,c=u;let p=Math.acos(r/u);l=Math.PI/2+(o>0?-p:p)}else a=0,c=0,l=0;return t&&(a=-a),e&&(c=-c),{translate:{tx:n.e,ty:n.f},scale:{sx:a,sy:c},rotation:{angle:l}}}var $G=qt(()=>{"use strict";vg();Kh()});var DG=qt(()=>{"use strict"});var jG=qt(()=>{"use strict";Km();B5();oS();vg();Kh()});var si=qt(()=>{"use strict";B5();Y5();CG();IG();X5();NG();oS();vg();U5();V5();RG();Kh();Km();OG();G5();LG();zG();$G();DG();jG()});var H5=qt(()=>{"use strict"});var UG=ue((XG,Sg)=>{"use strict";(function(){var n,e,t,i,r,s;typeof performance<"u"&&performance!==null&&performance.now?Sg.exports=function(){return performance.now()}:typeof process<"u"&&process!==null&&process.hrtime?(Sg.exports=function(){return(n()-r)/1e6},e=process.hrtime,n=function(){var o;return o=e(),o[0]*1e9+o[1]},i=n(),s=process.uptime()*1e9,r=i-s):Date.now?(Sg.exports=function(){return Date.now()-t},t=Date.now()):(Sg.exports=function(){return new Date().getTime()-t},t=new Date().getTime())}).call(XG)});var VG=qt(()=>{"use strict"});var GG=qt(()=>{"use strict"});function Z5([n,e],[t,i],{lineThickness:r=0}={}){return r===0?K5(n,e,t,i):x3t(n,e,t,i)<=r}function K5(n,e,t,i){let r=wg(n,e,t),s=wg(n,e,i),o=wg(t,i,n),a=wg(t,i,e);return!!(r!==s&&o!==a||r===0&&Pg(n,t,e)||s===0&&Pg(n,i,e)||o===0&&Pg(t,n,i)||a===0&&Pg(t,e,i))}function wg(n,e,t){let i=(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y);return i===0?0:i>0?1:2}function Pg(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function x3t(n,e,t,i){if(n.x===e.x&&n.y===e.y)return Jh(n,t,i);if(t.x===i.x&&t.y===i.y)return Jh(t,n,e);if(K5(n,e,t,i))return 0;let r=[Jh(n,t,i),Jh(e,t,i),Jh(t,n,e),Jh(i,n,e)];return Math.min(...r)}function Jh(n,e,t){let i=(t.x-e.x)**2+(t.y-e.y)**2;if(i===0)return q5(n,e);let r=((n.x-e.x)*(t.x-e.x)+(n.y-e.y)*(t.y-e.y))/i;r=Math.max(0,Math.min(1,r));let s={x:e.x+r*(t.x-e.x),y:e.y+r*(t.y-e.y)};return q5(n,s)}function q5(n,e){let t=n.x-e.x,i=n.y-e.y;return Math.sqrt(t*t+i*i)}var HG=qt(()=>{"use strict"});var WG=qt(()=>{"use strict"});var qG=qt(()=>{"use strict";VG();GG();HG();WG()});function J5(n){let e=new Map,t=0;function i(r){for(let[,o]of e)if(o.has(r))return o;let s=new Set;return e.set(`connectivity_net${t++}`,s),s}for(let r of n){let s=null;for(let o of r){if(!s)s=i(o);else if(!s.has(o)){let a=i(o);if(a!==s){for(let c of a)s.add(c);e.delete(Array.from(e.entries()).find(([,c])=>c===a)[0])}}s.add(o)}}return Object.fromEntries(Array.from(e.entries()).map(([r,s])=>[r,Array.from(s)]))}var Jm,ZG,nr,cS,ir=qt(()=>{"use strict";qG();Jm=class{constructor(n){d(this,"netMap");d(this,"idToNetMap");this.netMap=n,this.idToNetMap={};for(let[e,t]of Object.entries(n))for(let i of t)this.idToNetMap[i]=e}addConnections(n){for(let e of n){let t=new Set;for(let r of e){let s=this.idToNetMap[r];s&&t.add(s)}let i;if(t.size===0)i=`connectivity_net${Object.keys(this.netMap).length}`,this.netMap[i]=[];else if(t.size===1)i=t.values().next().value??`connectivity_net${Object.keys(this.netMap).length}`;else{i=t.values().next().value??`connectivity_net${Object.keys(this.netMap).length}`;for(let r of t)if(r!==i){this.netMap[i].push(...this.netMap[r]),this.netMap[r]=this.netMap[i];for(let s of this.netMap[i])this.idToNetMap[s]=i}}for(let r of e)this.netMap[i].includes(r)||this.netMap[i].push(r),this.idToNetMap[r]=i}}getIdsConnectedToNet(n){return this.netMap[n]||[]}getNetConnectedToId(n){return this.idToNetMap[n]}areIdsConnected(n,e){if(n===e)return!0;let t=this.getNetConnectedToId(n);if(!t)return!1;let i=this.getNetConnectedToId(e);return i?t===i||i===n||i===n:!1}areAllIdsConnected(n){let e=this.getNetConnectedToId(n[0]);for(let t of n){let i=this.getNetConnectedToId(t);if(i===void 0||i!==e)return!1}return!0}},ZG=n=>{let e=[];for(let i of n)if(i.type==="source_trace")e.push([...i.connected_source_port_ids??[],...i.connected_source_net_ids??[]]);else if(i.type==="source_component"&&i.internally_connected_source_port_ids)for(let r of i.internally_connected_source_port_ids)e.push(r);let t=J5(e);return new Jm(t)},nr=n=>{let e=[];for(let i of n)if(i.type==="source_trace")e.push([i.source_trace_id,...i.connected_source_port_ids??[],...i.connected_source_net_ids??[]].filter(Boolean));else if(i.type==="pcb_port"){let{pcb_port_id:r,source_port_id:s}=i;s&&r&&e.push([s,r])}else if(i.type==="pcb_smtpad"){let{pcb_smtpad_id:r,pcb_port_id:s}=i;s&&r&&e.push([r,s])}else if(i.type==="pcb_plated_hole"){let{pcb_plated_hole_id:r,pcb_port_id:s}=i;s&&r&&e.push([r,s])}else if(i.type==="pcb_trace"){let{pcb_trace_id:r,source_trace_id:s}=i,o=Array.isArray(i.route)?i.route.filter(a=>a&&a.route_type==="wire"):[];if(s&&r&&e.push([r,s]),Array.isArray(o)){let a=o.find(l=>l&&l.start_pcb_port_id)?.start_pcb_port_id,c=o.find(l=>l&&l.end_pcb_port_id)?.end_pcb_port_id;a&&r&&c&&e.push([a,r,c])}}else if(i.type==="pcb_via"){let{pcb_via_id:r,pcb_trace_id:s}=i;s&&r&&e.push([r,s])}else if(i.type==="source_component"&&i.internally_connected_source_port_ids)for(let r of i.internally_connected_source_port_ids)e.push(r);let t=J5(e);return new Jm(t)},cS=class{constructor(n){d(this,"circuitJson");d(this,"traceIdToElm");d(this,"portIdToElm");d(this,"connMap");this.circuitJson=n||[],this.traceIdToElm=new Map,this.portIdToElm=new Map,n?(this._buildTraceMap(),this._buildPortMap(),this.connMap=this._buildTraceConnectivityMap()):this.connMap=new Jm({})}_buildPortMap(){for(let n of this.circuitJson)n.type==="pcb_port"&&this.portIdToElm.set(n.pcb_port_id,n)}_buildTraceMap(){for(let n of this.circuitJson)n.type==="pcb_trace"&&this.traceIdToElm.set(n.pcb_trace_id,n)}_buildTraceConnectivityMap(){let n=[],e=Array.from(this.traceIdToElm.keys());for(let t=0;t<e.length;t++)for(let i=t+1;i<e.length;i++){let r=this.traceIdToElm.get(e[t]),s=this.traceIdToElm.get(e[i]);this._arePcbTracesConnected(r,s)&&n.push([e[t],e[i]])}for(let t of this.portIdToElm.values())for(let i of this.traceIdToElm.values())for(let r of i.route)r.route_type==="wire"&&(r.start_pcb_port_id===t.pcb_port_id?n.push([t.pcb_port_id,i.pcb_trace_id]):r.end_pcb_port_id===t.pcb_port_id&&n.push([i.pcb_trace_id,t.pcb_port_id]));return new Jm(J5(n))}addTrace(n){this.traceIdToElm.set(n.pcb_trace_id,n);let e=[];for(let t of n.route)t.route_type==="wire"&&(t.start_pcb_port_id&&e.push([t.start_pcb_port_id,n.pcb_trace_id]),t.end_pcb_port_id&&e.push([t.end_pcb_port_id,n.pcb_trace_id]));this.connMap.addConnections(e)}_arePcbTracesConnected(n,e){for(let t=0;t<n.route.length-1;t++){let i=n.route[t],r=n.route[t+1];if(i.route_type==="wire"&&r.route_type==="wire")for(let s=0;s<e.route.length-1;s++){let o=e.route[s],a=e.route[s+1];if(o.route_type!=="wire"||a.route_type!=="wire")continue;if(Z5([i,r],[o,a],{lineThickness:(i.width+o.width)/2}))return!0}}return!1}areTracesConnected(n,e){return this.connMap.areIdsConnected(n,e)}getAllTracesConnectedToTrace(n){let e=this.connMap.getNetConnectedToId(n);return e?this.connMap.getIdsConnectedToNet(e).filter(t=>this.traceIdToElm.has(t)).map(t=>this.traceIdToElm.get(t)):[]}getAllTracesConnectedToPort(n){let e=this.connMap.getNetConnectedToId(n);return e?this.connMap.getIdsConnectedToNet(e).filter(t=>this.traceIdToElm.has(t)).map(t=>this.traceIdToElm.get(t)):[]}}});var aMt,Wc,Ag=qt(()=>{"use strict";aMt=(n,e,t)=>{let i=[{x:n.x,y:n.y}],r=(n.x+e.x)/2,s=(n.y+e.y)/2,o={x:e.x,y:e.y};switch(e.facingDirection){case"x+":o.x+=t;break;case"x-":o.x-=t;break;case"y+":o.y+=t;break;case"y-":o.y-=t;break}let a=n.facingDirection??"none",c=e.facingDirection??"none",l=f=>{let y=i[i.length-1];(y.x!==f.x||y.y!==f.y)&&i.push(f)},u=Math.abs(n.y-e.y)<=Math.max(1e-6,t*.1),p=Math.abs(n.x-e.x)<=Math.max(1e-6,t*.1);if(a==="none"&&c==="none")l({x:r,y:n.y}),l({x:r,y:e.y});else if(a==="x+"&&c==="y+")n.x>e.x&&n.y<e.y?(l({x:n.x+t,y:n.y}),l({x:n.x+t,y:e.y+t}),l({x:e.x,y:e.y+t})):!p&&!u&&n.x<e.x&&n.y>e.y?l({x:e.x,y:n.y}):p?(l({x:n.x+t,y:n.y}),l({x:n.x+t,y:e.y+t}),l({x:e.x,y:e.y+t})):n.x<e.x?(l({x:r,y:n.y}),l({x:r,y:o.y}),l({x:e.x,y:o.y})):n.y<=e.y+t?(l({x:n.x+t,y:n.y}),l({x:n.x+t,y:n.y+t}),l({x:e.x,y:n.y+t}),l({x:e.x,y:e.y})):(l({x:n.x+t,y:n.y}),l({x:n.x+t,y:(n.y+e.y)/2}),l({x:e.x,y:(n.y+e.y)/2}));else if(a==="x+"&&c==="x+"&&!u){let f=Math.max(n.x+t,o.x);l({x:f,y:n.y}),l({x:f,y:e.y})}else if(a==="x+"&&c==="x+"&&u)l({x:n.x+t,y:n.y}),l({x:n.x+t,y:n.y+t}),l({x:e.x+t,y:n.y+t}),l({x:e.x+t,y:e.y});else if(a==="x+"&&c==="y-")if(p&&n.y<=e.y)l({x:n.x+t,y:n.y}),l({x:n.x+t,y:s}),l({x:e.x,y:s});else if(p&&n.y>e.y)l({x:n.x+t,y:n.y}),l({x:n.x+t,y:e.y-t}),l({x:e.x,y:e.y-t});else if(n.x<e.x&&n.y<e.y)l({x:e.x,y:n.y});else if(n.x>e.x&&n.y<e.y){let f=n.x+t;l({x:f,y:n.y}),l({x:f,y:s}),l({x:e.x,y:s})}else if(n.x>e.x&&n.y>e.y){let f=n.x+t;l({x:f,y:n.y}),l({x:f,y:o.y}),l({x:e.x,y:o.y})}else n.y===e.y?(l({x:n.x+t,y:n.y}),l({x:n.x+t,y:n.y-t}),l({x:e.x,y:n.y-t})):(l({x:r,y:n.y}),l({x:r,y:o.y}),l({x:e.x,y:o.y}));else if(a==="x+"&&c==="x-"&&n.x+t>=e.x-t&&!u){let f=n.x+t;l({x:f,y:n.y}),l({x:f,y:s}),l({x:o.x,y:s}),l({x:o.x,y:o.y})}else a==="x+"&&c==="x-"&&u&&e.x>n.x||(a==="x+"&&c==="x-"&&u?(l({x:n.x+t,y:n.y}),l({x:n.x+t,y:n.y+t}),l({x:e.x-t,y:n.y+t}),l({x:e.x-t,y:n.y})):(a==="x+"&&l({x:n.x+t,y:n.y}),l({x:r,y:i[i.length-1].y}),l({x:r,y:o.y}),l({x:o.x,y:o.y})));return l({x:e.x,y:e.y}),i},Wc=(n,e,t={})=>{let i=n,r=e,s=!1;(i.x>r.x||i.x===r.x&&i.y>r.y)&&(s=!0,[i,r]=[r,i]);let o=i.facingDirection==="x-",a=i.facingDirection==="y-",c=w=>{let k=o?i.x-(w.x-i.x):w.x,T=a?i.y-(w.y-i.y):w.y,I=w.facingDirection;return o&&(I==="x+"?I="x-":I==="x-"&&(I="x+")),a&&(I==="y+"?I="y-":I==="y-"&&(I="y+")),{x:k,y:T,facingDirection:I}},l=(w,k)=>{let T=w.x-k.x,I=w.y-k.y,E=k.x+I,N=k.y-T,M=w.facingDirection;switch(M){case"x+":M="y-";break;case"y-":M="x-";break;case"x-":M="y+";break;case"y+":M="x+";break}return{x:E,y:N,facingDirection:M}},u=(w,k)=>{let T=w.x-k.x,I=w.y-k.y;return{x:k.x-I,y:k.y+T}},p=o||a?c(i):i,f=o||a?c(r):r,y=p,g=f,x=!1;p.facingDirection==="y+"&&(x=!0,y={...p,facingDirection:"x+"},g=l(f,p));let v=t?.overshoot??.1*Math.max(Math.abs(y.x-g.x),Math.abs(y.y-g.y)),P=aMt(y,g,v);return x&&(P=P.map(w=>u(w,y))),(o||a)&&(P=P.map(({x:w,y:k})=>({x:o?i.x-(w-i.x):w,y:a?i.y-(k-i.y):k}))),s?P.reverse():P}});function nq(n,e,t){if(!e||!t)return;let i=n.get(e);i||(i=new Set,n.set(e,i)),i.add(t);let r=n.get(t);r||(r=new Set,n.set(t,r)),r.add(e)}function Rg(n,e){if(!e.subcircuit_id&&!e.source_group_id)return[...n];let t=new Map;for(let o of n){let a=o[`${o.type}_id`];typeof a=="string"&&t.set(a,o)}let i=new Map;for(let o of n){let a=Object.entries(o);for(let[c,l]of a)if(c!=="parent_source_group_id"){if(c.endsWith("_id")&&typeof l=="string"){let u=t.get(l);nq(i,o,u)}else if(c.endsWith("_ids")&&Array.isArray(l)){for(let u of l)if(typeof u=="string"){let p=t.get(u);nq(i,o,p)}}}}let r=[],s=new Set;for(let o of n)(e.subcircuit_id&&o.subcircuit_id===e.subcircuit_id||e.source_group_id&&(o.source_group_id===e.source_group_id||Array.isArray(o.member_source_group_ids)&&o.member_source_group_ids.includes(e.source_group_id)))&&(r.push(o),s.add(o));for(;r.length>0;){let o=r.shift(),a=i.get(o);if(a)for(let c of a)s.has(c)||(s.add(c),r.push(c))}return n.filter(o=>s.has(o))}function y4(n){let e=n.type;return`${e}:${n[`${e}_id`]}`}function fMt(n,e){let t=kr(n).pcb_trace.get(e);if(!t)return`trace[${e}]`;let i=t.route.flatMap(o=>[o.start_pcb_port_id,o.end_pcb_port_id]).filter(Boolean);if(i.length===0)return`trace[${e}]`;function r(o){let a=kr(n).pcb_port.get(o);if(!a)return null;let c=kr(n).pcb_component.get(a.pcb_component_id);if(!c)return null;let l=kr(n).source_component.get(c.source_component_id);if(!l)return null;let u=kr(n).source_port.get(a.source_port_id),p=u?.port_hints?u.port_hints[1]:"";return{componentName:l.name,portHint:p}}return`trace[${i.map(o=>{let a=r(o);return a?`.${a.componentName} > port.${a.portHint}`:`port[${o}]`}).join(", ")}]`}function mMt(n,e){let t=kr(n).pcb_smtpad.get(e);return!t||!t.pcb_port_id?`smtpad[${e}]`:x4(n,t.pcb_port_id)}function _Mt(n){let e=0;if(n.length==0)return e;for(var t=0;t<n.length;t++){var i=n.charCodeAt(t);e=(e<<5)-e+i,e=e&e}return Math.abs(e)}function ES(n,e={}){if(n.length===0)return{width:0,height:0};let t=e.direction??"row",i=e.columnGap??0,r=e.rowGap??0;if(t==="row"||t==="row-reverse"){let a=n.reduce((l,u)=>l+u.width,0)+i*Math.max(0,n.length-1),c=n.reduce((l,u)=>Math.max(l,u.height),0);return{width:a,height:c}}else{let a=n.reduce((l,u)=>l+u.height,0)+r*Math.max(0,n.length-1);return{width:n.reduce((l,u)=>Math.max(l,u.width),0),height:a}}}var kr,Me,Ke,iq,lMt,uMt,pMt,sq,hMt,oq,g4,s_,aq,dMt,x4,Ns,o_,rq,yMt,gMt,cq,Lo,kS,lq,TS,uq,pq,hq,a_,Ae=qt(()=>{"use strict";St();St();si();H5();si();si();si();si();kr=((n,e={})=>{let t=n,i=t._internal_store;if(!i){i={counts:{},editCount:0},t._internal_store=i;for(let s of t){let o=s.type,a=s[`${o}_id`];if(!a)continue;let c=Number.parseInt(a.split("_").pop());Number.isNaN(c)||(i.counts[o]=Math.max(i.counts[o]??0,c))}}return new Proxy({},{get:(s,o)=>{if(o==="toArray")return()=>(t.editCount=i.editCount,t);if(o==="editCount")return i.editCount;if(o==="subtree")return c=>kr(Rg(t,c),e);let a=o;return{get:c=>t.find(l=>l.type===a&&l[`${a}_id`]===c),getUsing:c=>{let l=Object.keys(c);if(l.length!==1)throw new Error("getUsing requires exactly one key, e.g. { pcb_component_id }");let u=l[0],p=u.replace("_id",""),f=t.find(y=>y.type===p&&y[u]===c[u]);return f?t.find(y=>y.type===a&&y[`${a}_id`]===f[`${a}_id`]):null},getWhere:c=>{let l=Object.keys(c);return t.find(u=>u.type===a&&l.every(p=>u[p]===c[p]))},list:c=>{let l=c?Object.keys(c):[];return t.filter(u=>u.type===a&&l.every(p=>u[p]===c[p]))},insert:c=>{var p;(p=i.counts)[a]??(p[a]=-1),i.counts[a]++;let l=i.counts[a],u={type:a,[`${a}_id`]:`${a}_${l}`,...c};return e.validateInserts&&(jh[a]??Dh).parse(u),t.push(u),i.editCount++,u},delete:c=>{let l=t.find(u=>u[`${a}_id`]===c);l&&(t.splice(t.indexOf(l),1),i.editCount++)},update:(c,l)=>{let u=t.find(p=>p.type===a&&p[`${a}_id`]===c);return u?(Object.assign(u,l),i.editCount++,u):null},select:c=>{if(a==="source_component")return t.find(l=>l.type==="source_component"&&l.name===c.replace(/\./g,""));if(a==="pcb_port"||a==="source_port"||a==="schematic_port"){let[l,u]=c.replace(/\./g,"").split(/[\s\>]+/),p=t.find(y=>y.type==="source_component"&&y.name===l);if(!p)return null;let f=t.find(y=>y.type==="source_port"&&y.source_component_id===p.source_component_id&&(y.name===u||(y.port_hints??[]).includes(u)));if(!f)return null;if(a==="source_port")return f;if(a==="pcb_port")return t.find(y=>y.type==="pcb_port"&&y.source_port_id===f.source_port_id);if(a==="schematic_port")return t.find(y=>y.type==="schematic_port"&&y.source_port_id===f.source_port_id)}}}}})});kr.unparsed=kr;Me=kr,Ke=kr;iq=((n,e={})=>{let t=n._internal_store_indexed;if(!t){t={counts:{},editCount:0,indexes:{}};for(let o of n){let a=o.type,c=o[`${a}_id`];if(!c)continue;let l=Number.parseInt(c.split("_").pop()||"");Number.isNaN(l)||(t.counts[a]=Math.max(t.counts[a]??0,l))}let r=e.indexConfig||{},s=t.indexes;if(r.byId&&(s.byId=new Map),r.byType&&(s.byType=new Map),r.byRelation&&(s.byRelation=new Map),r.bySubcircuit&&(s.bySubcircuit=new Map),r.byCustomField&&r.byCustomField.length>0){s.byCustomField=new Map;for(let o of r.byCustomField)s.byCustomField.set(o,new Map)}for(let o of n){if(r.byId){let a=y4(o);s.byId.set(a,o)}if(r.byType){let a=s.byType.get(o.type)||[];a.push(o),s.byType.set(o.type,a)}if(r.byRelation){let a=Object.entries(o);for(let[c,l]of a)if(c.endsWith("_id")&&c!==`${o.type}_id`&&typeof l=="string"){let u=s.byRelation.get(c)||new Map,p=u.get(l)||[];p.push(o),u.set(l,p),s.byRelation.set(c,u)}}if(r.bySubcircuit&&"subcircuit_id"in o){let a=o.subcircuit_id;if(a&&typeof a=="string"){let c=s.bySubcircuit.get(a)||[];c.push(o),s.bySubcircuit.set(a,c)}}if(r.byCustomField&&s.byCustomField){for(let a of r.byCustomField)if(a in o){let c=o[a];if(c!==void 0&&(typeof c=="string"||typeof c=="number")){let l=String(c),u=s.byCustomField.get(a),p=u.get(l)||[];p.push(o),u.set(l,p)}}}}n._internal_store_indexed=t}return new Proxy({},{get:(r,s)=>{if(s==="toArray")return()=>(n.editCount=t.editCount,n);if(s==="editCount")return t.editCount;let o=s;return{get:a=>{let c=e.indexConfig||{};return c.byId&&t.indexes.byId?t.indexes.byId.get(`${o}:${a}`)||null:c.byType&&t.indexes.byType?(t.indexes.byType.get(o)||[]).find(u=>u[`${o}_id`]===a)||null:n.find(l=>l.type===o&&l[`${o}_id`]===a)||null},getUsing:a=>{let c=e.indexConfig||{},l=Object.keys(a);if(l.length!==1)throw new Error("getUsing requires exactly one key, e.g. { pcb_component_id }");let u=l[0],p=u.replace("_id","");if(c.byRelation&&t.indexes.byRelation){let y=t.indexes.byRelation.get(u);if(y){let x=(y.get(a[u])||[]).find(P=>P.type===p);if(!x)return null;let v=x[`${o}_id`];return c.byId&&t.indexes.byId?t.indexes.byId.get(`${o}:${v}`)||null:c.byType&&t.indexes.byType?(t.indexes.byType.get(o)||[]).find(w=>w[`${o}_id`]===v)||null:n.find(P=>P.type===o&&P[`${o}_id`]===v)||null}}let f=n.find(y=>y.type===p&&y[u]===a[u]);return f&&n.find(y=>y.type===o&&y[`${o}_id`]===f[`${o}_id`])||null},getWhere:a=>{let c=e.indexConfig||{},l=Object.keys(a);if(l.length===1&&c.byCustomField&&t.indexes.byCustomField){let u=l[0],p=t.indexes.byCustomField.get(u);if(p){let f=String(a[u]);return(p.get(f)||[]).find(g=>g.type===o)||null}}if("subcircuit_id"in a&&c.bySubcircuit&&t.indexes.bySubcircuit){let u=a.subcircuit_id;return(t.indexes.bySubcircuit.get(u)||[]).find(f=>f.type===o&&l.every(y=>f[y]===a[y]))||null}return c.byType&&t.indexes.byType?(t.indexes.byType.get(o)||[]).find(p=>l.every(f=>p[f]===a[f]))||null:n.find(u=>u.type===o&&l.every(p=>u[p]===a[p]))||null},list:a=>{let c=e.indexConfig||{},l=a?Object.keys(a):[];if(l.length===0&&c.byType&&t.indexes.byType)return t.indexes.byType.get(o)||[];if(l.length===1&&l[0]==="subcircuit_id"&&c.bySubcircuit&&t.indexes.bySubcircuit){let p=a.subcircuit_id;return(t.indexes.bySubcircuit.get(p)||[]).filter(y=>y.type===o)}let u;return c.byType&&t.indexes.byType?u=t.indexes.byType.get(o)||[]:u=n.filter(p=>p.type===o),l.length>0?u.filter(p=>l.every(f=>p[f]===a[f])):u},insert:a=>{var p;(p=t.counts)[o]??(p[o]=-1),t.counts[o]++;let c=t.counts[o],l={type:o,[`${o}_id`]:`${o}_${c}`,...a};e.validateInserts&&(jh[o]??Dh).parse(l),n.push(l),t.editCount++;let u=e.indexConfig||{};if(u.byId&&t.indexes.byId){let f=y4(l);t.indexes.byId.set(f,l)}if(u.byType&&t.indexes.byType){let f=t.indexes.byType.get(o)||[];f.push(l),t.indexes.byType.set(o,f)}if(u.byRelation&&t.indexes.byRelation){let f=Object.entries(l);for(let[y,g]of f)if(y.endsWith("_id")&&y!==`${l.type}_id`&&typeof g=="string"){let x=t.indexes.byRelation.get(y)||new Map,v=x.get(g)||[];v.push(l),x.set(g,v),t.indexes.byRelation.set(y,x)}}if(u.bySubcircuit&&t.indexes.bySubcircuit&&"subcircuit_id"in l){let f=l.subcircuit_id;if(f&&typeof f=="string"){let y=t.indexes.bySubcircuit.get(f)||[];y.push(l),t.indexes.bySubcircuit.set(f,y)}}if(u.byCustomField&&t.indexes.byCustomField){for(let f of u.byCustomField)if(f in l){let y=l[f];if(y!==void 0&&(typeof y=="string"||typeof y=="number")){let g=String(y),x=t.indexes.byCustomField.get(f),v=x.get(g)||[];v.push(l),x.set(g,v)}}}return l},delete:a=>{let c=e.indexConfig||{},l;if(c.byId&&t.indexes.byId?l=t.indexes.byId.get(`${o}:${a}`):c.byType&&t.indexes.byType?l=(t.indexes.byType.get(o)||[]).find(f=>f[`${o}_id`]===a):l=n.find(p=>p[`${o}_id`]===a),!l)return;let u=n.indexOf(l);if(u>=0&&(n.splice(u,1),t.editCount++),c.byId&&t.indexes.byId){let p=y4(l);t.indexes.byId.delete(p)}if(c.byType&&t.indexes.byType){let f=(t.indexes.byType.get(o)||[]).filter(y=>y[`${o}_id`]!==a);t.indexes.byType.set(o,f)}if(c.byRelation&&t.indexes.byRelation)for(let[p,f]of t.indexes.byRelation.entries())for(let[y,g]of f.entries()){let x=g.filter(v=>v!==l);x.length===0?f.delete(y):f.set(y,x)}if(c.bySubcircuit&&t.indexes.bySubcircuit&&"subcircuit_id"in l){let p=l.subcircuit_id;if(p){let y=(t.indexes.bySubcircuit.get(p)||[]).filter(g=>g!==l);y.length===0?t.indexes.bySubcircuit.delete(p):t.indexes.bySubcircuit.set(p,y)}}if(c.byCustomField&&t.indexes.byCustomField)for(let p of t.indexes.byCustomField.values())for(let[f,y]of p.entries()){let g=y.filter(x=>x!==l);g.length===0?p.delete(f):p.set(f,g)}},update:(a,c)=>{let l=e.indexConfig||{},u;if(l.byId&&t.indexes.byId?u=t.indexes.byId.get(`${o}:${a}`):l.byType&&t.indexes.byType?u=(t.indexes.byType.get(o)||[]).find(f=>f[`${o}_id`]===a):u=n.find(p=>p.type===o&&p[`${o}_id`]===a),!u)return null;if(l.byRelation&&t.indexes.byRelation){let p=Object.entries(u);for(let[f,y]of p)if(f.endsWith("_id")&&f!==`${u.type}_id`&&typeof y=="string"&&f in c&&c[f]!==y){let g=t.indexes.byRelation.get(f);if(g){let v=(g.get(y)||[]).filter(P=>P!==u);v.length===0?g.delete(y):g.set(y,v)}}}if(l.bySubcircuit&&t.indexes.bySubcircuit&&"subcircuit_id"in u&&"subcircuit_id"in c){let p=u.subcircuit_id,f=c.subcircuit_id;if(p!==f){let g=(t.indexes.bySubcircuit.get(p)||[]).filter(x=>x!==u);g.length===0?t.indexes.bySubcircuit.delete(p):t.indexes.bySubcircuit.set(p,g)}}if(l.byCustomField&&t.indexes.byCustomField){for(let p of l.byCustomField)if(p in u&&p in c&&u[p]!==c[p]){let f=t.indexes.byCustomField.get(p);if(f){let y=String(u[p]),x=(f.get(y)||[]).filter(v=>v!==u);x.length===0?f.delete(y):f.set(y,x)}}}if(Object.assign(u,c),t.editCount++,l.byRelation&&t.indexes.byRelation){let p=Object.entries(u);for(let[f,y]of p)if(f.endsWith("_id")&&f!==`${u.type}_id`&&typeof y=="string"&&f in c){let g=t.indexes.byRelation.get(f)||new Map,x=g.get(y)||[];x.includes(u)||(x.push(u),g.set(y,x),t.indexes.byRelation.set(f,g))}}if(l.bySubcircuit&&t.indexes.bySubcircuit&&"subcircuit_id"in u&&"subcircuit_id"in c){let p=u.subcircuit_id;if(p&&typeof p=="string"){let f=t.indexes.bySubcircuit.get(p)||[];f.includes(u)||(f.push(u),t.indexes.bySubcircuit.set(p,f))}}if(l.byCustomField&&t.indexes.byCustomField){for(let p of l.byCustomField)if(p in u&&p in c){let f=u[p];if(f!==void 0&&(typeof f=="string"||typeof f=="number")){let y=String(f),g=t.indexes.byCustomField.get(p),x=g.get(y)||[];x.includes(u)||(x.push(u),g.set(y,x))}}}return u},select:a=>{if(o==="source_component")return n.find(c=>c.type==="source_component"&&c.name===a.replace(/\./g,""))||null;if(o==="pcb_port"||o==="source_port"||o==="schematic_port"){let[c,l]=a.replace(/\./g,"").split(/[\s\>]+/),u=n.find(f=>f.type==="source_component"&&f.name===c);if(!u)return null;let p=n.find(f=>f.type==="source_port"&&f.source_component_id===u.source_component_id&&(f.name===l||(f.port_hints??[]).includes(l)));if(!p)return null;if(o==="source_port")return p;if(o==="pcb_port")return n.find(f=>f.type==="pcb_port"&&f.source_port_id===p.source_port_id)||null;if(o==="schematic_port")return n.find(f=>f.type==="schematic_port"&&f.source_port_id===p.source_port_id)||null}return null}}}})});iq.unparsed=iq;lMt=n=>{if(n==="up")return"right";if(n==="right")return"down";if(n==="down")return"left";if(n==="left")return"up";throw new Error(`Invalid direction: ${n}`)},uMt=n=>{if(n==="up")return"left";if(n==="left")return"down";if(n==="down")return"right";if(n==="right")return"up";throw new Error(`Invalid direction: ${n}`)},pMt=(n,e)=>{for(;e>0;)n=lMt(n),e--;for(;e<0;)n=uMt(n),e++;return n},sq=n=>{if(n==="top"||n==="up")return"bottom";if(n==="bottom"||n==="down")return"top";if(n==="left")return"right";if(n==="right")return"left";throw new Error(`Invalid sideOrDir: ${n}`)},hMt=(n,e)=>{if(n.type==="schematic_component")n.center=oe(e,n.center);else if(n.type==="schematic_port")n.center=oe(e,n.center),n.facing_direction&&(n.facing_direction=pMt(n.facing_direction,-(Math.atan2(e.b,e.a)/Math.PI)*2));else if(n.type==="schematic_text")n.position=oe(e,n.position);else if(n.type==="schematic_trace"){let t=n;t.route=(t.route??[]).map(i=>{let r=oe(e,i);return i.x=r.x,i.y=r.y,i}),Array.isArray(t.junctions)&&(t.junctions=t.junctions.map(i=>{let r=oe(e,i);return i.x=r.x,i.y=r.y,i})),Array.isArray(t.edges)&&(t.edges=t.edges.map(i=>(i.from=oe(e,i.from),i.to=oe(e,i.to),i)))}else if(n.type==="schematic_box"){let{x:t,y:i}=oe(e,{x:n.x,y:n.y});n.x=t,n.y=i}else if(n.type==="schematic_line"){let{x:t,y:i}=oe(e,{x:n.x1,y:n.y1}),{x:r,y:s}=oe(e,{x:n.x2,y:n.y2});n.x1=t,n.y1=i,n.x2=r,n.y2=s}return n},oq=(n,e)=>n.map(t=>hMt(t,e)),g4=(n,e)=>{let t=aS(e),i=Math.round(t.rotation.angle/(Math.PI/2))%2===1;if(n.type==="pcb_plated_hole"||n.type==="pcb_hole"||n.type==="pcb_via"||n.type==="pcb_smtpad"||n.type==="pcb_port"){let{x:r,y:s}=oe(e,{x:Number(n.x),y:Number(n.y)});n.x=r,n.y=s}else if(n.type==="pcb_keepout"||n.type==="pcb_board")n.center=oe(e,n.center);else if(n.type==="pcb_silkscreen_text"||n.type==="pcb_fabrication_note_text")n.anchor_position=oe(e,n.anchor_position);else if(n.type==="pcb_silkscreen_circle"||n.type==="pcb_silkscreen_rect")n.center=oe(e,n.center);else if(n.type==="pcb_component")n.center=oe(e,n.center),n.rotation=n.rotation+t.rotation.angle/Math.PI*180,n.rotation=n.rotation%360,i&&([n.width,n.height]=[n.height,n.width]);else if(n.type==="pcb_silkscreen_path"||n.type==="pcb_trace"||n.type==="pcb_fabrication_note_path")n.route=n.route.map(r=>{let s=oe(e,r);return r.x=s.x,r.y=s.y,r});else if(n.type==="pcb_silkscreen_line"){let r={x:n.x1,y:n.y1},s={x:n.x2,y:n.y2},o=oe(e,r),a=oe(e,s);n.x1=o.x,n.y1=o.y,n.x2=a.x,n.y2=a.y}else if(n.type==="cad_component"){let r=oe(e,{x:n.position.x,y:n.position.y});n.position.x=r.x,n.position.y=r.y}return n},s_=(n,e)=>{let t=aS(e),i=Math.round(t.rotation.angle/(Math.PI/2)),r=Math.abs(i)%2===1,s=n.map(o=>g4(o,e));return r&&(s=s.map(o=>(o.type==="pcb_smtpad"&&o.shape==="rect"&&([o.width,o.height]=[o.height,o.width]),o))),s},aq=n=>{let e=n.type;return n[`${e}_id`]},dMt=(n,e)=>n.find(t=>aq(t)===e)??null;x4=(n,e)=>{let t=kr(n).pcb_port.get(e);if(!t)return`pcb_port[#${e}]`;let i=kr(n).pcb_component.get(t?.pcb_component_id);if(!i)return`pcb_port[#${e}]`;let r=kr(n).source_component.get(i.source_component_id);if(!r)return`pcb_port[#${e}]`;let s=kr(n).source_port.get(t.source_port_id);if(!s)return`pcb_port[#${e}]`;let o;return s?.port_hints&&s.port_hints.length>0||s.port_hints&&s.port_hints.length>0?o=s.port_hints[0]:o=e,`pcb_port[.${r.name} > .${o}]`};Ns=(n,e)=>{if(typeof e=="string"){let t=dMt(n,e);return t||`${e}`,Ns(n,t)}switch(e.type){case"pcb_port":return x4(n,e.pcb_port_id);case"pcb_smtpad":return mMt(n,e.pcb_smtpad_id);case"pcb_trace":return fMt(n,e.pcb_trace_id);case"source_component":return`source_component[${e.name}]`;default:return`${e.type}[#${aq(e)}]`}},o_=n=>{let e=Number.POSITIVE_INFINITY,t=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,r=Number.NEGATIVE_INFINITY;for(let s of n){if(!s.type.startsWith("pcb_"))continue;let o,a,c,l;if("x"in s&&"y"in s&&(o=Number(s.x),a=Number(s.y)),"outer_diameter"in s&&(c=Number(s.outer_diameter),l=Number(s.outer_diameter)),"width"in s&&(c=Number(s.width)),"height"in s&&(l=Number(s.height)),"center"in s&&(o=s.center.x,a=s.center.y),o!==void 0&&a!==void 0)e=Math.min(e,o),t=Math.min(t,a),i=Math.max(i,o),r=Math.max(r,a),c!==void 0&&l!==void 0&&(e=Math.min(e,o-c/2),t=Math.min(t,a-l/2),i=Math.max(i,o+c/2),r=Math.max(r,a+l/2)),"radius"in s&&(e=Math.min(e,o-s.radius),t=Math.min(t,a-s.radius),i=Math.max(i,o+s.radius),r=Math.max(r,a+s.radius));else if(s.type==="pcb_trace")for(let u of s.route)e=Math.min(e,u.x),t=Math.min(t,u.y),i=Math.max(i,u.x),r=Math.max(r,u.y)}return{minX:e,minY:t,maxX:i,maxY:r}};rq=[["#69d2e7","#a7dbd8","#e0e4cc","#f38630","#fa6900"],["#fe4365","#fc9d9a","#f9cdad","#c8c8a9","#83af9b"],["#ecd078","#d95b43","#c02942","#542437","#53777a"],["#556270","#4ecdc4","#c7f464","#ff6b6b","#c44d58"],["#774f38","#e08e79","#f1d4af","#ece5ce","#c5e0dc"],["#e8ddcb","#cdb380","#036564","#033649","#031634"],["#490a3d","#bd1550","#e97f02","#f8ca00","#8a9b0f"],["#594f4f","#547980","#45ada8","#9de0ad","#e5fcc2"],["#00a0b0","#6a4a3c","#cc333f","#eb6841","#edc951"],["#e94e77","#d68189","#c6a49a","#c6e5d9","#f4ead5"],["#3fb8af","#7fc7af","#dad8a7","#ff9e9d","#ff3d7f"],["#d9ceb2","#948c75","#d5ded9","#7a6a53","#99b2b7"],["#ffffff","#cbe86b","#f2e9e1","#1c140d","#cbe86b"],["#efffcd","#dce9be","#555152","#2e2633","#99173c"],["#343838","#005f6b","#008c9e","#00b4cc","#00dffc"],["#413e4a","#73626e","#b38184","#f0b49e","#f7e4be"],["#ff4e50","#fc913a","#f9d423","#ede574","#e1f5c4"],["#99b898","#fecea8","#ff847c","#e84a5f","#2a363b"],["#655643","#80bca3","#f6f7bd","#e6ac27","#bf4d28"],["#00a8c6","#40c0cb","#f9f2e7","#aee239","#8fbe00"],["#351330","#424254","#64908a","#e8caa4","#cc2a41"],["#554236","#f77825","#d3ce3d","#f1efa5","#60b99a"],["#5d4157","#838689","#a8caba","#cad7b2","#ebe3aa"],["#8c2318","#5e8c6a","#88a65e","#bfb35a","#f2c45a"],["#fad089","#ff9c5b","#f5634a","#ed303c","#3b8183"],["#ff4242","#f4fad2","#d4ee5e","#e1edb9","#f0f2eb"],["#f8b195","#f67280","#c06c84","#6c5b7b","#355c7d"],["#d1e751","#ffffff","#000000","#4dbce9","#26ade4"],["#1b676b","#519548","#88c425","#bef202","#eafde6"],["#5e412f","#fcebb6","#78c0a8","#f07818","#f0a830"],["#bcbdac","#cfbe27","#f27435","#f02475","#3b2d38"],["#452632","#91204d","#e4844a","#e8bf56","#e2f7ce"],["#eee6ab","#c5bc8e","#696758","#45484b","#36393b"],["#f0d8a8","#3d1c00","#86b8b1","#f2d694","#fa2a00"],["#2a044a","#0b2e59","#0d6759","#7ab317","#a0c55f"],["#f04155","#ff823a","#f2f26f","#fff7bd","#95cfb7"],["#b9d7d9","#668284","#2a2829","#493736","#7b3b3b"],["#bbbb88","#ccc68d","#eedd99","#eec290","#eeaa88"],["#b3cc57","#ecf081","#ffbe40","#ef746f","#ab3e5b"],["#a3a948","#edb92e","#f85931","#ce1836","#009989"],["#300030","#480048","#601848","#c04848","#f07241"],["#67917a","#170409","#b8af03","#ccbf82","#e33258"],["#aab3ab","#c4cbb7","#ebefc9","#eee0b7","#e8caaf"],["#e8d5b7","#0e2430","#fc3a51","#f5b349","#e8d5b9"],["#ab526b","#bca297","#c5ceae","#f0e2a4","#f4ebc3"],["#607848","#789048","#c0d860","#f0f0d8","#604848"],["#b6d8c0","#c8d9bf","#dadabd","#ecdbbc","#fedcba"],["#a8e6ce","#dcedc2","#ffd3b5","#ffaaa6","#ff8c94"],["#3e4147","#fffedf","#dfba69","#5a2e2e","#2a2c31"],["#fc354c","#29221f","#13747d","#0abfbc","#fcf7c5"],["#cc0c39","#e6781e","#c8cf02","#f8fcc1","#1693a7"],["#1c2130","#028f76","#b3e099","#ffeaad","#d14334"],["#a7c5bd","#e5ddcb","#eb7b59","#cf4647","#524656"],["#dad6ca","#1bb0ce","#4f8699","#6a5e72","#563444"],["#5c323e","#a82743","#e15e32","#c0d23e","#e5f04c"],["#edebe6","#d6e1c7","#94c7b6","#403b33","#d3643b"],["#fdf1cc","#c6d6b8","#987f69","#e3ad40","#fcd036"],["#230f2b","#f21d41","#ebebbc","#bce3c5","#82b3ae"],["#b9d3b0","#81bda4","#b28774","#f88f79","#f6aa93"],["#3a111c","#574951","#83988e","#bcdea5","#e6f9bc"],["#5e3929","#cd8c52","#b7d1a3","#dee8be","#fcf7d3"],["#1c0113","#6b0103","#a30006","#c21a01","#f03c02"],["#000000","#9f111b","#b11623","#292c37","#cccccc"],["#382f32","#ffeaf2","#fcd9e5","#fbc5d8","#f1396d"],["#e3dfba","#c8d6bf","#93ccc6","#6cbdb5","#1a1f1e"],["#f6f6f6","#e8e8e8","#333333","#990100","#b90504"],["#1b325f","#9cc4e4","#e9f2f9","#3a89c9","#f26c4f"],["#a1dbb2","#fee5ad","#faca66","#f7a541","#f45d4c"],["#c1b398","#605951","#fbeec2","#61a6ab","#accec0"],["#5e9fa3","#dcd1b4","#fab87f","#f87e7b","#b05574"],["#951f2b","#f5f4d7","#e0dfb1","#a5a36c","#535233"],["#8dccad","#988864","#fea6a2","#f9d6ac","#ffe9af"],["#2d2d29","#215a6d","#3ca2a2","#92c7a3","#dfece6"],["#413d3d","#040004","#c8ff00","#fa023c","#4b000f"],["#eff3cd","#b2d5ba","#61ada0","#248f8d","#605063"],["#ffefd3","#fffee4","#d0ecea","#9fd6d2","#8b7a5e"],["#cfffdd","#b4dec1","#5c5863","#a85163","#ff1f4c"],["#9dc9ac","#fffec7","#f56218","#ff9d2e","#919167"],["#4e395d","#827085","#8ebe94","#ccfc8e","#dc5b3e"],["#a8a7a7","#cc527a","#e8175d","#474747","#363636"],["#f8edd1","#d88a8a","#474843","#9d9d93","#c5cfc6"],["#046d8b","#309292","#2fb8ac","#93a42a","#ecbe13"],["#f38a8a","#55443d","#a0cab5","#cde9ca","#f1edd0"],["#a70267","#f10c49","#fb6b41","#f6d86b","#339194"],["#ff003c","#ff8a00","#fabe28","#88c100","#00c176"],["#ffedbf","#f7803c","#f54828","#2e0d23","#f8e4c1"],["#4e4d4a","#353432","#94ba65","#2790b0","#2b4e72"],["#0ca5b0","#4e3f30","#fefeeb","#f8f4e4","#a5b3aa"],["#4d3b3b","#de6262","#ffb88c","#ffd0b3","#f5e0d3"],["#fffbb7","#a6f6af","#66b6ab","#5b7c8d","#4f2958"],["#edf6ee","#d1c089","#b3204d","#412e28","#151101"],["#9d7e79","#ccac95","#9a947c","#748b83","#5b756c"],["#fcfef5","#e9ffe1","#cdcfb7","#d6e6c3","#fafbe3"],["#9cddc8","#bfd8ad","#ddd9ab","#f7af63","#633d2e"],["#30261c","#403831","#36544f","#1f5f61","#0b8185"],["#aaff00","#ffaa00","#ff00aa","#aa00ff","#00aaff"],["#d1313d","#e5625c","#f9bf76","#8eb2c5","#615375"],["#ffe181","#eee9e5","#fad3b2","#ffba7f","#ff9c97"],["#73c8a9","#dee1b6","#e1b866","#bd5532","#373b44"],["#805841","#dcf7f3","#fffcdd","#ffd8d8","#f5a2a2"]],yMt=n=>{let{x:e,y:t,width:i,height:r}={...n,...n.size,...n.center,...n.position};if(n.x1!==void 0&&n.x2!==void 0&&n.y1!==void 0&&n.y2!==void 0&&(e=(n.x1+n.x2)/2,t=(n.y1+n.y2)/2,i=Math.abs(n.x1-n.x2),r=Math.abs(n.y1-n.y2)),n.points&&Array.isArray(n.points)&&n.points.length>0){let a=n.points.map(y=>y.x),c=n.points.map(y=>y.y),l=Math.min(...a),u=Math.max(...a),p=Math.min(...c),f=Math.max(...c);e=(l+u)/2,t=(p+f)/2,i=u-l,r=f-p}let s=n.text||n.name||n.source?.text||n.source?.name||"?",o=n;return e===void 0||t===void 0?null:(i===void 0&&"outer_diameter"in n&&(i=n.outer_diameter,r=n.outer_diameter),(i===void 0||r===void 0)&&(i=.1,r=.1),{x:e,y:t,width:i,height:r,title:s,content:o,bg_color:rq[_Mt(n.type||s)%rq.length]?.[4]??"#f00"})},gMt=n=>!!n,cq=n=>{let e=n.filter(l=>l.type.startsWith("pcb_")||l.type.startsWith("schematic_")).concat(n.filter(l=>l.type==="pcb_trace"||l.type==="schematic_trace").flatMap(l=>l.route)).map(l=>yMt(l)).filter(gMt);if(e.length===0)return{center:{x:0,y:0},width:0,height:0};let t=e[0].x-e[0].width/2,i=e[0].x+e[0].width/2,r=e[0].y-e[0].height/2,s=e[0].y+e[0].height/2;for(let l of e.slice(1))t=Math.min(t,l.x-l.width/2),i=Math.max(i,l.x+l.width/2),r=Math.min(r,l.y-l.height/2),s=Math.max(s,l.y+l.height/2);let o=i-t,a=s-r;return{center:{x:t+o/2,y:r+a/2},width:o,height:a}},Lo=n=>n[`${n.type}_id`],kS=(n,e,t)=>{let i=n.find(u=>u.type==="pcb_component"&&u.pcb_component_id===e);if(!i)return;let r="center"in i?i.center:{x:i.x,y:i.y},s=t.x-r.x,o=t.y-r.y,a=n.filter(u=>u.type==="pcb_port"&&u.pcb_component_id===e).map(u=>u.pcb_port_id),c=n.filter(u=>{if(u===i)return!0;let p=u;return!!(p.pcb_component_id===e||Array.isArray(p.pcb_component_ids)&&p.pcb_component_ids.includes(e)||p.pcb_port_id&&a.includes(p.pcb_port_id)||Array.isArray(p.pcb_port_ids)&&p.pcb_port_ids.some(f=>a.includes(f))||p.start_pcb_port_id&&a.includes(p.start_pcb_port_id)||p.end_pcb_port_id&&a.includes(p.end_pcb_port_id)||Array.isArray(p.route)&&p.route.some(f=>f.start_pcb_port_id&&a.includes(f.start_pcb_port_id)||f.end_pcb_port_id&&a.includes(f.end_pcb_port_id)))}),l=Kn(s,o);s_(c,l)},lq=(n,e)=>{let t=[],i=n.filter(r=>r.type==="source_group"&&r.parent_source_group_id===e).map(r=>r.source_group_id);t.push(...i);for(let r of i)t.push(...lq(n,r));return t},TS=(n,e,t)=>{let i=[e,...lq(n,e)],r=new Set;for(let f of i)Rg(n,{source_group_id:f}).forEach(g=>r.add(g));let s=Array.from(r).filter(f=>f.type==="pcb_port").map(f=>f.pcb_port_id);n.filter(f=>{if(f.type!=="pcb_trace"||r.has(f))return!1;let y=f;return!!(y.start_pcb_port_id&&s.includes(y.start_pcb_port_id)||y.end_pcb_port_id&&s.includes(y.end_pcb_port_id)||Array.isArray(y.route)&&y.route.some(g=>g.start_pcb_port_id&&s.includes(g.start_pcb_port_id)||g.end_pcb_port_id&&s.includes(g.end_pcb_port_id)))}).forEach(f=>r.add(f));let a=Array.from(r).filter(f=>f.type.startsWith("pcb_"));if(a.length===0)return;let{center:c}=cq(a),l=t.x-c.x,u=t.y-c.y,p=Kn(l,u);s_(a,p)},uq=(n,e,t)=>{let i=n.find(u=>u.type==="schematic_component"&&u.schematic_component_id===e);if(!i)return;let r="center"in i?i.center:{x:i.x,y:i.y},s=t.x-r.x,o=t.y-r.y,a=n.filter(u=>u.type==="schematic_port"&&u.schematic_component_id===e).map(u=>u.schematic_port_id),c=n.filter(u=>{if(u===i)return!0;let p=u;return!!(p.schematic_component_id===e||Array.isArray(p.schematic_component_ids)&&p.schematic_component_ids.includes(e)||p.schematic_port_id&&a.includes(p.schematic_port_id)||Array.isArray(p.schematic_port_ids)&&p.schematic_port_ids.some(f=>a.includes(f))||p.start_schematic_port_id&&a.includes(p.start_schematic_port_id)||p.end_schematic_port_id&&a.includes(p.end_schematic_port_id)||Array.isArray(p.route)&&p.route.some(f=>f.start_schematic_port_id&&a.includes(f.start_schematic_port_id)||f.end_schematic_port_id&&a.includes(f.end_schematic_port_id)))}),l=Kn(s,o);oq(c,l)},pq=(n,e)=>{let t=[],i=n.filter(r=>r.type==="source_group"&&r.parent_source_group_id===e).map(r=>r.source_group_id);t.push(...i);for(let r of i)t.push(...pq(n,r));return t},hq=(n,e,t)=>{let i=[e,...pq(n,e)],r=new Set;for(let f of i)Rg(n,{source_group_id:f}).forEach(g=>r.add(g));let s=Array.from(r).filter(f=>f.type==="schematic_port").map(f=>f.schematic_port_id);n.filter(f=>{if(f.type!=="schematic_trace"||r.has(f))return!1;let y=f;return!!(y.start_schematic_port_id&&s.includes(y.start_schematic_port_id)||y.end_schematic_port_id&&s.includes(y.end_schematic_port_id)||Array.isArray(y.route)&&y.route.some(g=>g.start_schematic_port_id&&s.includes(g.start_schematic_port_id)||g.end_schematic_port_id&&s.includes(g.end_schematic_port_id)))}).forEach(f=>r.add(f));let a=Array.from(r).filter(f=>f.type.startsWith("schematic_"));if(a.length===0)return;let{center:c}=cq(a),l=t.x-c.x,u=t.y-c.y,p=Kn(l,u);oq(a,p)},a_=(n,e)=>{let t=new Map,i=new Set;for(let l of n)l.type==="source_group"&&i.add(l.source_group_id);let r=[];for(let l of n)if(l.type==="source_group"&&l.parent_source_group_id){let u=l.parent_source_group_id,p=l.source_group_id;if(!i.has(u))r.push(p),t.has(p)||t.set(p,[]);else{let f=t.get(u)??[];f.push(p),t.set(u,f),t.has(p)||t.set(p,[])}}for(let l of n)l.type==="source_group"&&!t.has(l.source_group_id)&&t.set(l.source_group_id,[]);let s=new Map,o=()=>{for(let[l,u]of t)if(!s.has(l)&&u.every(p=>s.has(p)))return l;return null},a=null;for(;;){let l=o();if(!l)break;let p={nodeType:"group",sourceGroup:n.find(f=>f.type==="source_group"&&f.source_group_id===l),otherChildElements:[],childNodes:[...t.get(l)?.map(f=>s.get(f))??[],...n.filter(f=>f.type==="source_component"&&f.source_group_id===l).map(f=>({nodeType:"component",sourceComponent:f,childNodes:[],otherChildElements:[...n.filter(y=>y.type==="pcb_component"&&y.source_component_id===f.source_component_id)]}))]};s.set(l,p),a=l}if(!a)return console.warn("No groups were processed, returning tree without sourceGroup"),{nodeType:"group",childNodes:[],otherChildElements:n};let c=null;return e&&e.source_group_id!==void 0?c=e.source_group_id:r.length>0?c=r[0]:c=a,c?s.get(c):(console.warn("No valid root group found, returning tree without sourceGroup"),{nodeType:"group",childNodes:[],otherChildElements:n})}});var MS=ue((dq,fq)=>{"use strict";(function(n){var e;typeof dq=="object"?fq.exports=n():typeof define=="function"&&define.amd?define(n):(typeof window<"u"?e=window:typeof global<"u"?e=global:typeof self<"u"&&(e=self),e.objectHash=n())})(function(){return(function n(e,t,i){function r(a,c){if(!t[a]){if(!e[a]){var l=typeof Jy=="function"&&Jy;if(!c&&l)return l(a,!0);if(s)return s(a,!0);throw new Error("Cannot find module '"+a+"'")}c=t[a]={exports:{}},e[a][0].call(c.exports,function(u){var p=e[a][1][u];return r(p||u)},c,c.exports,n,e,t,i)}return t[a].exports}for(var s=typeof Jy=="function"&&Jy,o=0;o<i.length;o++)r(i[o]);return r})({1:[function(n,e,t){(function(i,r,s,o,a,c,l,u,p){"use strict";var f=n("crypto");function y(T,I){I=v(T,I);var E;return(E=I.algorithm!=="passthrough"?f.createHash(I.algorithm):new k).write===void 0&&(E.write=E.update,E.end=E.update),w(I,E).dispatch(T),E.update||E.end(""),E.digest?E.digest(I.encoding==="buffer"?void 0:I.encoding):(T=E.read(),I.encoding!=="buffer"?T.toString(I.encoding):T)}(t=e.exports=y).sha1=function(T){return y(T)},t.keys=function(T){return y(T,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},t.MD5=function(T){return y(T,{algorithm:"md5",encoding:"hex"})},t.keysMD5=function(T){return y(T,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var g=f.getHashes?f.getHashes().slice():["sha1","md5"],x=(g.push("passthrough"),["buffer","hex","binary","base64"]);function v(T,I){var E={};if(E.algorithm=(I=I||{}).algorithm||"sha1",E.encoding=I.encoding||"hex",E.excludeValues=!!I.excludeValues,E.algorithm=E.algorithm.toLowerCase(),E.encoding=E.encoding.toLowerCase(),E.ignoreUnknown=I.ignoreUnknown===!0,E.respectType=I.respectType!==!1,E.respectFunctionNames=I.respectFunctionNames!==!1,E.respectFunctionProperties=I.respectFunctionProperties!==!1,E.unorderedArrays=I.unorderedArrays===!0,E.unorderedSets=I.unorderedSets!==!1,E.unorderedObjects=I.unorderedObjects!==!1,E.replacer=I.replacer||void 0,E.excludeKeys=I.excludeKeys||void 0,T===void 0)throw new Error("Object argument required.");for(var N=0;N<g.length;++N)g[N].toLowerCase()===E.algorithm.toLowerCase()&&(E.algorithm=g[N]);if(g.indexOf(E.algorithm)===-1)throw new Error('Algorithm "'+E.algorithm+'"  not supported. supported values: '+g.join(", "));if(x.indexOf(E.encoding)===-1&&E.algorithm!=="passthrough")throw new Error('Encoding "'+E.encoding+'"  not supported. supported values: '+x.join(", "));return E}function P(T){if(typeof T=="function")return/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(T))!=null}function w(T,I,E){E=E||[];function N(M){return I.update?I.update(M,"utf8"):I.write(M,"utf8")}return{dispatch:function(M){return this["_"+((M=T.replacer?T.replacer(M):M)===null?"null":typeof M)](M)},_object:function(M){var A,R=Object.prototype.toString.call(M),j=/\[object (.*)\]/i.exec(R);if(j=(j=j?j[1]:"unknown:["+R+"]").toLowerCase(),0<=(R=E.indexOf(M)))return this.dispatch("[CIRCULAR:"+R+"]");if(E.push(M),s!==void 0&&s.isBuffer&&s.isBuffer(M))return N("buffer:"),N(M);if(j==="object"||j==="function"||j==="asyncfunction")return R=Object.keys(M),T.unorderedObjects&&(R=R.sort()),T.respectType===!1||P(M)||R.splice(0,0,"prototype","__proto__","constructor"),T.excludeKeys&&(R=R.filter(function(B){return!T.excludeKeys(B)})),N("object:"+R.length+":"),A=this,R.forEach(function(B){A.dispatch(B),N(":"),T.excludeValues||A.dispatch(M[B]),N(",")});if(!this["_"+j]){if(T.ignoreUnknown)return N("["+j+"]");throw new Error('Unknown object type "'+j+'"')}this["_"+j](M)},_array:function(M,B){B=B!==void 0?B:T.unorderedArrays!==!1;var R=this;if(N("array:"+M.length+":"),!B||M.length<=1)return M.forEach(function(G){return R.dispatch(G)});var j=[],B=M.map(function(G){var U=new k,H=E.slice();return w(T,U,H).dispatch(G),j=j.concat(H.slice(E.length)),U.read().toString()});return E=E.concat(j),B.sort(),this._array(B,!1)},_date:function(M){return N("date:"+M.toJSON())},_symbol:function(M){return N("symbol:"+M.toString())},_error:function(M){return N("error:"+M.toString())},_boolean:function(M){return N("bool:"+M.toString())},_string:function(M){N("string:"+M.length+":"),N(M.toString())},_function:function(M){N("fn:"),P(M)?this.dispatch("[native]"):this.dispatch(M.toString()),T.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(M.name)),T.respectFunctionProperties&&this._object(M)},_number:function(M){return N("number:"+M.toString())},_xml:function(M){return N("xml:"+M.toString())},_null:function(){return N("Null")},_undefined:function(){return N("Undefined")},_regexp:function(M){return N("regex:"+M.toString())},_uint8array:function(M){return N("uint8array:"),this.dispatch(Array.prototype.slice.call(M))},_uint8clampedarray:function(M){return N("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(M))},_int8array:function(M){return N("int8array:"),this.dispatch(Array.prototype.slice.call(M))},_uint16array:function(M){return N("uint16array:"),this.dispatch(Array.prototype.slice.call(M))},_int16array:function(M){return N("int16array:"),this.dispatch(Array.prototype.slice.call(M))},_uint32array:function(M){return N("uint32array:"),this.dispatch(Array.prototype.slice.call(M))},_int32array:function(M){return N("int32array:"),this.dispatch(Array.prototype.slice.call(M))},_float32array:function(M){return N("float32array:"),this.dispatch(Array.prototype.slice.call(M))},_float64array:function(M){return N("float64array:"),this.dispatch(Array.prototype.slice.call(M))},_arraybuffer:function(M){return N("arraybuffer:"),this.dispatch(new Uint8Array(M))},_url:function(M){return N("url:"+M.toString())},_map:function(M){return N("map:"),M=Array.from(M),this._array(M,T.unorderedSets!==!1)},_set:function(M){return N("set:"),M=Array.from(M),this._array(M,T.unorderedSets!==!1)},_file:function(M){return N("file:"),this.dispatch([M.name,M.size,M.type,M.lastModfied])},_blob:function(){if(T.ignoreUnknown)return N("[blob]");throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){return N("domwindow")},_bigint:function(M){return N("bigint:"+M.toString())},_process:function(){return N("process")},_timer:function(){return N("timer")},_pipe:function(){return N("pipe")},_tcp:function(){return N("tcp")},_udp:function(){return N("udp")},_tty:function(){return N("tty")},_statwatcher:function(){return N("statwatcher")},_securecontext:function(){return N("securecontext")},_connection:function(){return N("connection")},_zlib:function(){return N("zlib")},_context:function(){return N("context")},_nodescript:function(){return N("nodescript")},_httpparser:function(){return N("httpparser")},_dataview:function(){return N("dataview")},_signal:function(){return N("signal")},_fsevent:function(){return N("fsevent")},_tlswrap:function(){return N("tlswrap")}}}function k(){return{buf:"",write:function(T){this.buf+=T},end:function(T){this.buf+=T},read:function(){return this.buf}}}t.writeToStream=function(T,I,E){return E===void 0&&(E=I,I={}),w(I=v(T,I),E).dispatch(T)}}).call(this,n("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_9a5aa49d.js","/")},{buffer:3,crypto:5,lYpoI2:11}],2:[function(n,e,t){(function(i,r,s,o,a,c,l,u,p){(function(f){"use strict";var y=typeof Uint8Array<"u"?Uint8Array:Array,g=43,x=47,v=48,P=97,w=65,k=45,T=95;function I(E){return E=E.charCodeAt(0),E===g||E===k?62:E===x||E===T?63:E<v?-1:E<v+10?E-v+26+26:E<w+26?E-w:E<P+26?E-P+26:void 0}f.toByteArray=function(E){var N,M;if(0<E.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var A=E.length,A=E.charAt(A-2)==="="?2:E.charAt(A-1)==="="?1:0,R=new y(3*E.length/4-A),j=0<A?E.length-4:E.length,B=0;function G(U){R[B++]=U}for(N=0;N<j;N+=4,0)G((16711680&(M=I(E.charAt(N))<<18|I(E.charAt(N+1))<<12|I(E.charAt(N+2))<<6|I(E.charAt(N+3))))>>16),G((65280&M)>>8),G(255&M);return A==2?G(255&(M=I(E.charAt(N))<<2|I(E.charAt(N+1))>>4)):A==1&&(G((M=I(E.charAt(N))<<10|I(E.charAt(N+1))<<4|I(E.charAt(N+2))>>2)>>8&255),G(255&M)),R},f.fromByteArray=function(E){var N,M,A,R,j=E.length%3,B="";function G(U){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(U)}for(N=0,A=E.length-j;N<A;N+=3)M=(E[N]<<16)+(E[N+1]<<8)+E[N+2],B+=G((R=M)>>18&63)+G(R>>12&63)+G(R>>6&63)+G(63&R);switch(j){case 1:B=(B+=G((M=E[E.length-1])>>2))+G(M<<4&63)+"==";break;case 2:B=(B=(B+=G((M=(E[E.length-2]<<8)+E[E.length-1])>>10))+G(M>>4&63))+G(M<<2&63)+"="}return B}})(t===void 0?this.base64js={}:t)}).call(this,n("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:11}],3:[function(n,e,t){(function(i,r,g,o,a,c,l,u,p){var f=n("base64-js"),y=n("ieee754");function g(X,W,rt){if(!(this instanceof g))return new g(X,W,rt);var pt,yt,Z,at,Et=typeof X;if(W==="base64"&&Et=="string")for(X=(at=X).trim?at.trim():at.replace(/^\s+|\s+$/g,"");X.length%4!=0;)X+="=";if(Et=="number")pt=tt(X);else if(Et=="string")pt=g.byteLength(X,W);else{if(Et!="object")throw new Error("First argument needs to be a number, array or string.");pt=tt(X.length)}if(g._useTypedArrays?yt=g._augment(new Uint8Array(pt)):((yt=this).length=pt,yt._isBuffer=!0),g._useTypedArrays&&typeof X.byteLength=="number")yt._set(X);else if(et(at=X)||g.isBuffer(at)||at&&typeof at=="object"&&typeof at.length=="number")for(Z=0;Z<pt;Z++)g.isBuffer(X)?yt[Z]=X.readUInt8(Z):yt[Z]=X[Z];else if(Et=="string")yt.write(X,0,W);else if(Et=="number"&&!g._useTypedArrays&&!rt)for(Z=0;Z<pt;Z++)yt[Z]=0;return yt}function x(X,W,rt,pt){return g._charsWritten=nt((function(yt){for(var Z=[],at=0;at<yt.length;at++)Z.push(255&yt.charCodeAt(at));return Z})(W),X,rt,pt)}function v(X,W,rt,pt){return g._charsWritten=nt((function(yt){for(var Z,at,Et=[],Ft=0;Ft<yt.length;Ft++)at=yt.charCodeAt(Ft),Z=at>>8,at=at%256,Et.push(at),Et.push(Z);return Et})(W),X,rt,pt)}function P(X,W,rt){var pt="";rt=Math.min(X.length,rt);for(var yt=W;yt<rt;yt++)pt+=String.fromCharCode(X[yt]);return pt}function w(X,W,rt,Z){Z||(ot(typeof rt=="boolean","missing or invalid endian"),ot(W!=null,"missing offset"),ot(W+1<X.length,"Trying to read beyond buffer length"));var yt,Z=X.length;if(!(Z<=W))return rt?(yt=X[W],W+1<Z&&(yt|=X[W+1]<<8)):(yt=X[W]<<8,W+1<Z&&(yt|=X[W+1])),yt}function k(X,W,rt,Z){Z||(ot(typeof rt=="boolean","missing or invalid endian"),ot(W!=null,"missing offset"),ot(W+3<X.length,"Trying to read beyond buffer length"));var yt,Z=X.length;if(!(Z<=W))return rt?(W+2<Z&&(yt=X[W+2]<<16),W+1<Z&&(yt|=X[W+1]<<8),yt|=X[W],W+3<Z&&(yt+=X[W+3]<<24>>>0)):(W+1<Z&&(yt=X[W+1]<<16),W+2<Z&&(yt|=X[W+2]<<8),W+3<Z&&(yt|=X[W+3]),yt+=X[W]<<24>>>0),yt}function T(X,W,rt,pt){if(pt||(ot(typeof rt=="boolean","missing or invalid endian"),ot(W!=null,"missing offset"),ot(W+1<X.length,"Trying to read beyond buffer length")),!(X.length<=W))return pt=w(X,W,rt,!0),32768&pt?-1*(65535-pt+1):pt}function I(X,W,rt,pt){if(pt||(ot(typeof rt=="boolean","missing or invalid endian"),ot(W!=null,"missing offset"),ot(W+3<X.length,"Trying to read beyond buffer length")),!(X.length<=W))return pt=k(X,W,rt,!0),2147483648&pt?-1*(4294967295-pt+1):pt}function E(X,W,rt,pt){return pt||(ot(typeof rt=="boolean","missing or invalid endian"),ot(W+3<X.length,"Trying to read beyond buffer length")),y.read(X,W,rt,23,4)}function N(X,W,rt,pt){return pt||(ot(typeof rt=="boolean","missing or invalid endian"),ot(W+7<X.length,"Trying to read beyond buffer length")),y.read(X,W,rt,52,8)}function M(X,W,rt,pt,yt){if(yt||(ot(W!=null,"missing value"),ot(typeof pt=="boolean","missing or invalid endian"),ot(rt!=null,"missing offset"),ot(rt+1<X.length,"trying to write beyond buffer length"),ht(W,65535)),yt=X.length,!(yt<=rt))for(var Z=0,at=Math.min(yt-rt,2);Z<at;Z++)X[rt+Z]=(W&255<<8*(pt?Z:1-Z))>>>8*(pt?Z:1-Z)}function A(X,W,rt,pt,yt){if(yt||(ot(W!=null,"missing value"),ot(typeof pt=="boolean","missing or invalid endian"),ot(rt!=null,"missing offset"),ot(rt+3<X.length,"trying to write beyond buffer length"),ht(W,4294967295)),yt=X.length,!(yt<=rt))for(var Z=0,at=Math.min(yt-rt,4);Z<at;Z++)X[rt+Z]=W>>>8*(pt?Z:3-Z)&255}function R(X,W,rt,pt,yt){yt||(ot(W!=null,"missing value"),ot(typeof pt=="boolean","missing or invalid endian"),ot(rt!=null,"missing offset"),ot(rt+1<X.length,"Trying to write beyond buffer length"),kt(W,32767,-32768)),X.length<=rt||M(X,0<=W?W:65535+W+1,rt,pt,yt)}function j(X,W,rt,pt,yt){yt||(ot(W!=null,"missing value"),ot(typeof pt=="boolean","missing or invalid endian"),ot(rt!=null,"missing offset"),ot(rt+3<X.length,"Trying to write beyond buffer length"),kt(W,2147483647,-2147483648)),X.length<=rt||A(X,0<=W?W:4294967295+W+1,rt,pt,yt)}function B(X,W,rt,pt,yt){yt||(ot(W!=null,"missing value"),ot(typeof pt=="boolean","missing or invalid endian"),ot(rt!=null,"missing offset"),ot(rt+3<X.length,"Trying to write beyond buffer length"),Mt(W,34028234663852886e22,-34028234663852886e22)),X.length<=rt||y.write(X,W,rt,pt,23,4)}function G(X,W,rt,pt,yt){yt||(ot(W!=null,"missing value"),ot(typeof pt=="boolean","missing or invalid endian"),ot(rt!=null,"missing offset"),ot(rt+7<X.length,"Trying to write beyond buffer length"),Mt(W,17976931348623157e292,-17976931348623157e292)),X.length<=rt||y.write(X,W,rt,pt,52,8)}t.Buffer=g,t.SlowBuffer=g,t.INSPECT_MAX_BYTES=50,g.poolSize=8192,g._useTypedArrays=(function(){try{var X=new ArrayBuffer(0),W=new Uint8Array(X);return W.foo=function(){return 42},W.foo()===42&&typeof W.subarray=="function"}catch{return!1}})(),g.isEncoding=function(X){switch(String(X).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},g.isBuffer=function(X){return!(X==null||!X._isBuffer)},g.byteLength=function(X,W){var rt;switch(X+="",W||"utf8"){case"hex":rt=X.length/2;break;case"utf8":case"utf-8":rt=V(X).length;break;case"ascii":case"binary":case"raw":rt=X.length;break;case"base64":rt=J(X).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":rt=2*X.length;break;default:throw new Error("Unknown encoding")}return rt},g.concat=function(X,W){if(ot(et(X),`Usage: Buffer.concat(list, [totalLength])
list should be an Array.`),X.length===0)return new g(0);if(X.length===1)return X[0];if(typeof W!="number")for(yt=W=0;yt<X.length;yt++)W+=X[yt].length;for(var rt=new g(W),pt=0,yt=0;yt<X.length;yt++){var Z=X[yt];Z.copy(rt,pt),pt+=Z.length}return rt},g.prototype.write=function(X,W,rt,pt){isFinite(W)?isFinite(rt)||(pt=rt,rt=void 0):(Ft=pt,pt=W,W=rt,rt=Ft),W=Number(W)||0;var yt,Z,at,Et,Ft=this.length-W;switch((!rt||Ft<(rt=Number(rt)))&&(rt=Ft),pt=String(pt||"utf8").toLowerCase()){case"hex":yt=(function(Ot,Ce,Se,Kt){Se=Number(Se)||0;var le=Ot.length-Se;(!Kt||le<(Kt=Number(Kt)))&&(Kt=le),ot((le=Ce.length)%2==0,"Invalid hex string"),le/2<Kt&&(Kt=le/2);for(var Jt=0;Jt<Kt;Jt++){var qn=parseInt(Ce.substr(2*Jt,2),16);ot(!isNaN(qn),"Invalid hex string"),Ot[Se+Jt]=qn}return g._charsWritten=2*Jt,Jt})(this,X,W,rt);break;case"utf8":case"utf-8":Z=this,at=W,Et=rt,yt=g._charsWritten=nt(V(X),Z,at,Et);break;case"ascii":case"binary":yt=x(this,X,W,rt);break;case"base64":Z=this,at=W,Et=rt,yt=g._charsWritten=nt(J(X),Z,at,Et);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":yt=v(this,X,W,rt);break;default:throw new Error("Unknown encoding")}return yt},g.prototype.toString=function(X,W,rt){var pt,yt,Z,at,Et=this;if(X=String(X||"utf8").toLowerCase(),W=Number(W)||0,(rt=rt!==void 0?Number(rt):Et.length)===W)return"";switch(X){case"hex":pt=(function(Ft,Ot,Ce){var Se=Ft.length;(!Ot||Ot<0)&&(Ot=0),(!Ce||Ce<0||Se<Ce)&&(Ce=Se);for(var Kt="",le=Ot;le<Ce;le++)Kt+=mt(Ft[le]);return Kt})(Et,W,rt);break;case"utf8":case"utf-8":pt=(function(Ft,Ot,Ce){var Se="",Kt="";Ce=Math.min(Ft.length,Ce);for(var le=Ot;le<Ce;le++)Ft[le]<=127?(Se+=ut(Kt)+String.fromCharCode(Ft[le]),Kt=""):Kt+="%"+Ft[le].toString(16);return Se+ut(Kt)})(Et,W,rt);break;case"ascii":case"binary":pt=P(Et,W,rt);break;case"base64":yt=Et,at=rt,pt=(Z=W)===0&&at===yt.length?f.fromByteArray(yt):f.fromByteArray(yt.slice(Z,at));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":pt=(function(Ft,Ot,Ce){for(var Se=Ft.slice(Ot,Ce),Kt="",le=0;le<Se.length;le+=2)Kt+=String.fromCharCode(Se[le]+256*Se[le+1]);return Kt})(Et,W,rt);break;default:throw new Error("Unknown encoding")}return pt},g.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},g.prototype.copy=function(X,W,rt,pt){if(W=W||0,(pt=pt||pt===0?pt:this.length)!==(rt=rt||0)&&X.length!==0&&this.length!==0){ot(rt<=pt,"sourceEnd < sourceStart"),ot(0<=W&&W<X.length,"targetStart out of bounds"),ot(0<=rt&&rt<this.length,"sourceStart out of bounds"),ot(0<=pt&&pt<=this.length,"sourceEnd out of bounds"),pt>this.length&&(pt=this.length);var yt=(pt=X.length-W<pt-rt?X.length-W+rt:pt)-rt;if(yt<100||!g._useTypedArrays)for(var Z=0;Z<yt;Z++)X[Z+W]=this[Z+rt];else X._set(this.subarray(rt,rt+yt),W)}},g.prototype.slice=function(X,W){var rt=this.length;if(X=H(X,rt,0),W=H(W,rt,rt),g._useTypedArrays)return g._augment(this.subarray(X,W));for(var pt=W-X,yt=new g(pt,void 0,!0),Z=0;Z<pt;Z++)yt[Z]=this[Z+X];return yt},g.prototype.get=function(X){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(X)},g.prototype.set=function(X,W){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(X,W)},g.prototype.readUInt8=function(X,W){if(W||(ot(X!=null,"missing offset"),ot(X<this.length,"Trying to read beyond buffer length")),!(X>=this.length))return this[X]},g.prototype.readUInt16LE=function(X,W){return w(this,X,!0,W)},g.prototype.readUInt16BE=function(X,W){return w(this,X,!1,W)},g.prototype.readUInt32LE=function(X,W){return k(this,X,!0,W)},g.prototype.readUInt32BE=function(X,W){return k(this,X,!1,W)},g.prototype.readInt8=function(X,W){if(W||(ot(X!=null,"missing offset"),ot(X<this.length,"Trying to read beyond buffer length")),!(X>=this.length))return 128&this[X]?-1*(255-this[X]+1):this[X]},g.prototype.readInt16LE=function(X,W){return T(this,X,!0,W)},g.prototype.readInt16BE=function(X,W){return T(this,X,!1,W)},g.prototype.readInt32LE=function(X,W){return I(this,X,!0,W)},g.prototype.readInt32BE=function(X,W){return I(this,X,!1,W)},g.prototype.readFloatLE=function(X,W){return E(this,X,!0,W)},g.prototype.readFloatBE=function(X,W){return E(this,X,!1,W)},g.prototype.readDoubleLE=function(X,W){return N(this,X,!0,W)},g.prototype.readDoubleBE=function(X,W){return N(this,X,!1,W)},g.prototype.writeUInt8=function(X,W,rt){rt||(ot(X!=null,"missing value"),ot(W!=null,"missing offset"),ot(W<this.length,"trying to write beyond buffer length"),ht(X,255)),W>=this.length||(this[W]=X)},g.prototype.writeUInt16LE=function(X,W,rt){M(this,X,W,!0,rt)},g.prototype.writeUInt16BE=function(X,W,rt){M(this,X,W,!1,rt)},g.prototype.writeUInt32LE=function(X,W,rt){A(this,X,W,!0,rt)},g.prototype.writeUInt32BE=function(X,W,rt){A(this,X,W,!1,rt)},g.prototype.writeInt8=function(X,W,rt){rt||(ot(X!=null,"missing value"),ot(W!=null,"missing offset"),ot(W<this.length,"Trying to write beyond buffer length"),kt(X,127,-128)),W>=this.length||(0<=X?this.writeUInt8(X,W,rt):this.writeUInt8(255+X+1,W,rt))},g.prototype.writeInt16LE=function(X,W,rt){R(this,X,W,!0,rt)},g.prototype.writeInt16BE=function(X,W,rt){R(this,X,W,!1,rt)},g.prototype.writeInt32LE=function(X,W,rt){j(this,X,W,!0,rt)},g.prototype.writeInt32BE=function(X,W,rt){j(this,X,W,!1,rt)},g.prototype.writeFloatLE=function(X,W,rt){B(this,X,W,!0,rt)},g.prototype.writeFloatBE=function(X,W,rt){B(this,X,W,!1,rt)},g.prototype.writeDoubleLE=function(X,W,rt){G(this,X,W,!0,rt)},g.prototype.writeDoubleBE=function(X,W,rt){G(this,X,W,!1,rt)},g.prototype.fill=function(X,W,rt){if(W=W||0,rt=rt||this.length,ot(typeof(X=typeof(X=X||0)=="string"?X.charCodeAt(0):X)=="number"&&!isNaN(X),"value is not a number"),ot(W<=rt,"end < start"),rt!==W&&this.length!==0){ot(0<=W&&W<this.length,"start out of bounds"),ot(0<=rt&&rt<=this.length,"end out of bounds");for(var pt=W;pt<rt;pt++)this[pt]=X}},g.prototype.inspect=function(){for(var X=[],W=this.length,rt=0;rt<W;rt++)if(X[rt]=mt(this[rt]),rt===t.INSPECT_MAX_BYTES){X[rt+1]="...";break}return"<Buffer "+X.join(" ")+">"},g.prototype.toArrayBuffer=function(){if(typeof Uint8Array>"u")throw new Error("Buffer.toArrayBuffer not supported in this browser");if(g._useTypedArrays)return new g(this).buffer;for(var X=new Uint8Array(this.length),W=0,rt=X.length;W<rt;W+=1)X[W]=this[W];return X.buffer};var U=g.prototype;function H(X,W,rt){return typeof X!="number"?rt:W<=(X=~~X)?W:0<=X||0<=(X+=W)?X:0}function tt(X){return(X=~~Math.ceil(+X))<0?0:X}function et(X){return(Array.isArray||function(W){return Object.prototype.toString.call(W)==="[object Array]"})(X)}function mt(X){return X<16?"0"+X.toString(16):X.toString(16)}function V(X){for(var W=[],rt=0;rt<X.length;rt++){var pt=X.charCodeAt(rt);if(pt<=127)W.push(X.charCodeAt(rt));else for(var yt=rt,Z=(55296<=pt&&pt<=57343&&rt++,encodeURIComponent(X.slice(yt,rt+1)).substr(1).split("%")),at=0;at<Z.length;at++)W.push(parseInt(Z[at],16))}return W}function J(X){return f.toByteArray(X)}function nt(X,W,rt,pt){for(var yt=0;yt<pt&&!(yt+rt>=W.length||yt>=X.length);yt++)W[yt+rt]=X[yt];return yt}function ut(X){try{return decodeURIComponent(X)}catch{return"\uFFFD"}}function ht(X,W){ot(typeof X=="number","cannot write a non-number as a number"),ot(0<=X,"specified a negative value for writing an unsigned value"),ot(X<=W,"value is larger than maximum value for type"),ot(Math.floor(X)===X,"value has a fractional component")}function kt(X,W,rt){ot(typeof X=="number","cannot write a non-number as a number"),ot(X<=W,"value larger than maximum allowed value"),ot(rt<=X,"value smaller than minimum allowed value"),ot(Math.floor(X)===X,"value has a fractional component")}function Mt(X,W,rt){ot(typeof X=="number","cannot write a non-number as a number"),ot(X<=W,"value larger than maximum allowed value"),ot(rt<=X,"value smaller than minimum allowed value")}function ot(X,W){if(!X)throw new Error(W||"Failed assertion")}g._augment=function(X){return X._isBuffer=!0,X._get=X.get,X._set=X.set,X.get=U.get,X.set=U.set,X.write=U.write,X.toString=U.toString,X.toLocaleString=U.toString,X.toJSON=U.toJSON,X.copy=U.copy,X.slice=U.slice,X.readUInt8=U.readUInt8,X.readUInt16LE=U.readUInt16LE,X.readUInt16BE=U.readUInt16BE,X.readUInt32LE=U.readUInt32LE,X.readUInt32BE=U.readUInt32BE,X.readInt8=U.readInt8,X.readInt16LE=U.readInt16LE,X.readInt16BE=U.readInt16BE,X.readInt32LE=U.readInt32LE,X.readInt32BE=U.readInt32BE,X.readFloatLE=U.readFloatLE,X.readFloatBE=U.readFloatBE,X.readDoubleLE=U.readDoubleLE,X.readDoubleBE=U.readDoubleBE,X.writeUInt8=U.writeUInt8,X.writeUInt16LE=U.writeUInt16LE,X.writeUInt16BE=U.writeUInt16BE,X.writeUInt32LE=U.writeUInt32LE,X.writeUInt32BE=U.writeUInt32BE,X.writeInt8=U.writeInt8,X.writeInt16LE=U.writeInt16LE,X.writeInt16BE=U.writeInt16BE,X.writeInt32LE=U.writeInt32LE,X.writeInt32BE=U.writeInt32BE,X.writeFloatLE=U.writeFloatLE,X.writeFloatBE=U.writeFloatBE,X.writeDoubleLE=U.writeDoubleLE,X.writeDoubleBE=U.writeDoubleBE,X.fill=U.fill,X.inspect=U.inspect,X.toArrayBuffer=U.toArrayBuffer,X}}).call(this,n("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:10,lYpoI2:11}],4:[function(n,e,t){(function(i,r,f,o,a,c,l,u,p){var f=n("buffer").Buffer,y=4,g=new f(y);g.fill(0),e.exports={hash:function(x,v,P,w){for(var k=v((function(M,A){M.length%y!=0&&(R=M.length+(y-M.length%y),M=f.concat([M,g],R));for(var R,j=[],B=A?M.readInt32BE:M.readInt32LE,G=0;G<M.length;G+=y)j.push(B.call(M,G));return j})(x=f.isBuffer(x)?x:new f(x),w),8*x.length),v=w,T=new f(P),I=v?T.writeInt32BE:T.writeInt32LE,E=0;E<k.length;E++)I.call(T,k[E],4*E,!0);return T}}}).call(this,n("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],5:[function(n,e,t){(function(i,r,f,o,a,c,l,u,p){var f=n("buffer").Buffer,y=n("./sha"),g=n("./sha256"),x=n("./rng"),v={sha1:y,sha256:g,md5:n("./md5")},P=64,w=new f(P);function k(M,A){var R=v[M=M||"sha1"],j=[];return R||T("algorithm:",M,"is not yet supported"),{update:function(B){return f.isBuffer(B)||(B=new f(B)),j.push(B),B.length,this},digest:function(B){var G=f.concat(j),G=A?(function(U,H,tt){f.isBuffer(H)||(H=new f(H)),f.isBuffer(tt)||(tt=new f(tt)),H.length>P?H=U(H):H.length<P&&(H=f.concat([H,w],P));for(var et=new f(P),mt=new f(P),V=0;V<P;V++)et[V]=54^H[V],mt[V]=92^H[V];return tt=U(f.concat([et,tt])),U(f.concat([mt,tt]))})(R,A,G):R(G);return j=null,B?G.toString(B):G}}}function T(){var M=[].slice.call(arguments).join(" ");throw new Error([M,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join(`
`))}w.fill(0),t.createHash=function(M){return k(M)},t.createHmac=k,t.randomBytes=function(M,A){if(!A||!A.call)return new f(x(M));try{A.call(this,void 0,new f(x(M)))}catch(R){A(R)}};var I,E=["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],N=function(M){t[M]=function(){T("sorry,",M,"is not implemented yet")}};for(I in E)N(E[I],I)}).call(this,n("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:11}],6:[function(n,e,t){(function(i,r,s,o,a,c,l,u,p){var f=n("./helpers");function y(T,I){T[I>>5]|=128<<I%32,T[14+(I+64>>>9<<4)]=I;for(var E=1732584193,N=-271733879,M=-1732584194,A=271733878,R=0;R<T.length;R+=16){var j=E,B=N,G=M,U=A,E=x(E,N,M,A,T[R+0],7,-680876936),A=x(A,E,N,M,T[R+1],12,-389564586),M=x(M,A,E,N,T[R+2],17,606105819),N=x(N,M,A,E,T[R+3],22,-1044525330);E=x(E,N,M,A,T[R+4],7,-176418897),A=x(A,E,N,M,T[R+5],12,1200080426),M=x(M,A,E,N,T[R+6],17,-1473231341),N=x(N,M,A,E,T[R+7],22,-45705983),E=x(E,N,M,A,T[R+8],7,1770035416),A=x(A,E,N,M,T[R+9],12,-1958414417),M=x(M,A,E,N,T[R+10],17,-42063),N=x(N,M,A,E,T[R+11],22,-1990404162),E=x(E,N,M,A,T[R+12],7,1804603682),A=x(A,E,N,M,T[R+13],12,-40341101),M=x(M,A,E,N,T[R+14],17,-1502002290),E=v(E,N=x(N,M,A,E,T[R+15],22,1236535329),M,A,T[R+1],5,-165796510),A=v(A,E,N,M,T[R+6],9,-1069501632),M=v(M,A,E,N,T[R+11],14,643717713),N=v(N,M,A,E,T[R+0],20,-373897302),E=v(E,N,M,A,T[R+5],5,-701558691),A=v(A,E,N,M,T[R+10],9,38016083),M=v(M,A,E,N,T[R+15],14,-660478335),N=v(N,M,A,E,T[R+4],20,-405537848),E=v(E,N,M,A,T[R+9],5,568446438),A=v(A,E,N,M,T[R+14],9,-1019803690),M=v(M,A,E,N,T[R+3],14,-187363961),N=v(N,M,A,E,T[R+8],20,1163531501),E=v(E,N,M,A,T[R+13],5,-1444681467),A=v(A,E,N,M,T[R+2],9,-51403784),M=v(M,A,E,N,T[R+7],14,1735328473),E=P(E,N=v(N,M,A,E,T[R+12],20,-1926607734),M,A,T[R+5],4,-378558),A=P(A,E,N,M,T[R+8],11,-2022574463),M=P(M,A,E,N,T[R+11],16,1839030562),N=P(N,M,A,E,T[R+14],23,-35309556),E=P(E,N,M,A,T[R+1],4,-1530992060),A=P(A,E,N,M,T[R+4],11,1272893353),M=P(M,A,E,N,T[R+7],16,-155497632),N=P(N,M,A,E,T[R+10],23,-1094730640),E=P(E,N,M,A,T[R+13],4,681279174),A=P(A,E,N,M,T[R+0],11,-358537222),M=P(M,A,E,N,T[R+3],16,-722521979),N=P(N,M,A,E,T[R+6],23,76029189),E=P(E,N,M,A,T[R+9],4,-640364487),A=P(A,E,N,M,T[R+12],11,-421815835),M=P(M,A,E,N,T[R+15],16,530742520),E=w(E,N=P(N,M,A,E,T[R+2],23,-995338651),M,A,T[R+0],6,-198630844),A=w(A,E,N,M,T[R+7],10,1126891415),M=w(M,A,E,N,T[R+14],15,-1416354905),N=w(N,M,A,E,T[R+5],21,-57434055),E=w(E,N,M,A,T[R+12],6,1700485571),A=w(A,E,N,M,T[R+3],10,-1894986606),M=w(M,A,E,N,T[R+10],15,-1051523),N=w(N,M,A,E,T[R+1],21,-2054922799),E=w(E,N,M,A,T[R+8],6,1873313359),A=w(A,E,N,M,T[R+15],10,-30611744),M=w(M,A,E,N,T[R+6],15,-1560198380),N=w(N,M,A,E,T[R+13],21,1309151649),E=w(E,N,M,A,T[R+4],6,-145523070),A=w(A,E,N,M,T[R+11],10,-1120210379),M=w(M,A,E,N,T[R+2],15,718787259),N=w(N,M,A,E,T[R+9],21,-343485551),E=k(E,j),N=k(N,B),M=k(M,G),A=k(A,U)}return Array(E,N,M,A)}function g(T,I,E,N,M,A){return k((I=k(k(I,T),k(N,A)))<<M|I>>>32-M,E)}function x(T,I,E,N,M,A,R){return g(I&E|~I&N,T,I,M,A,R)}function v(T,I,E,N,M,A,R){return g(I&N|E&~N,T,I,M,A,R)}function P(T,I,E,N,M,A,R){return g(I^E^N,T,I,M,A,R)}function w(T,I,E,N,M,A,R){return g(E^(I|~N),T,I,M,A,R)}function k(T,I){var E=(65535&T)+(65535&I);return(T>>16)+(I>>16)+(E>>16)<<16|65535&E}e.exports=function(T){return f.hash(T,y,16)}}).call(this,n("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],7:[function(n,e,t){(function(i,r,s,o,a,c,l,u,p){var f;e.exports=f||function(y){for(var g,x=new Array(y),v=0;v<y;v++)(3&v)==0&&(g=4294967296*Math.random()),x[v]=g>>>((3&v)<<3)&255;return x}}).call(this,n("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],8:[function(n,e,t){(function(i,r,s,o,a,c,l,u,p){var f=n("./helpers");function y(v,P){v[P>>5]|=128<<24-P%32,v[15+(P+64>>9<<4)]=P;for(var w,k,T,I=Array(80),E=1732584193,N=-271733879,M=-1732584194,A=271733878,R=-1009589776,j=0;j<v.length;j+=16){for(var B=E,G=N,U=M,H=A,tt=R,et=0;et<80;et++){I[et]=et<16?v[j+et]:x(I[et-3]^I[et-8]^I[et-14]^I[et-16],1);var mt=g(g(x(E,5),(mt=N,k=M,T=A,(w=et)<20?mt&k|~mt&T:!(w<40)&&w<60?mt&k|mt&T|k&T:mt^k^T)),g(g(R,I[et]),(w=et)<20?1518500249:w<40?1859775393:w<60?-1894007588:-899497514)),R=A,A=M,M=x(N,30),N=E,E=mt}E=g(E,B),N=g(N,G),M=g(M,U),A=g(A,H),R=g(R,tt)}return Array(E,N,M,A,R)}function g(v,P){var w=(65535&v)+(65535&P);return(v>>16)+(P>>16)+(w>>16)<<16|65535&w}function x(v,P){return v<<P|v>>>32-P}e.exports=function(v){return f.hash(v,y,20,!0)}}).call(this,n("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],9:[function(n,e,t){(function(i,r,s,o,a,c,l,u,p){function f(P,w){var k=(65535&P)+(65535&w);return(P>>16)+(w>>16)+(k>>16)<<16|65535&k}function y(P,w){var k,T=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),I=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),E=new Array(64);P[w>>5]|=128<<24-w%32,P[15+(w+64>>9<<4)]=w;for(var N,M,A=0;A<P.length;A+=16){for(var R=I[0],j=I[1],B=I[2],G=I[3],U=I[4],H=I[5],tt=I[6],et=I[7],mt=0;mt<64;mt++)E[mt]=mt<16?P[mt+A]:f(f(f((M=E[mt-2],x(M,17)^x(M,19)^v(M,10)),E[mt-7]),(M=E[mt-15],x(M,7)^x(M,18)^v(M,3))),E[mt-16]),k=f(f(f(f(et,x(M=U,6)^x(M,11)^x(M,25)),U&H^~U&tt),T[mt]),E[mt]),N=f(x(N=R,2)^x(N,13)^x(N,22),R&j^R&B^j&B),et=tt,tt=H,H=U,U=f(G,k),G=B,B=j,j=R,R=f(k,N);I[0]=f(R,I[0]),I[1]=f(j,I[1]),I[2]=f(B,I[2]),I[3]=f(G,I[3]),I[4]=f(U,I[4]),I[5]=f(H,I[5]),I[6]=f(tt,I[6]),I[7]=f(et,I[7])}return I}var g=n("./helpers"),x=function(P,w){return P>>>w|P<<32-w},v=function(P,w){return P>>>w};e.exports=function(P){return g.hash(P,y,32,!0)}}).call(this,n("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],10:[function(n,e,t){(function(i,r,s,o,a,c,l,u,p){t.read=function(f,y,g,x,A){var P,w,k=8*A-x-1,T=(1<<k)-1,I=T>>1,E=-7,N=g?A-1:0,M=g?-1:1,A=f[y+N];for(N+=M,P=A&(1<<-E)-1,A>>=-E,E+=k;0<E;P=256*P+f[y+N],N+=M,E-=8);for(w=P&(1<<-E)-1,P>>=-E,E+=x;0<E;w=256*w+f[y+N],N+=M,E-=8);if(P===0)P=1-I;else{if(P===T)return w?NaN:1/0*(A?-1:1);w+=Math.pow(2,x),P-=I}return(A?-1:1)*w*Math.pow(2,P-x)},t.write=function(f,y,g,x,v,R){var w,k,T=8*R-v-1,I=(1<<T)-1,E=I>>1,N=v===23?Math.pow(2,-24)-Math.pow(2,-77):0,M=x?0:R-1,A=x?1:-1,R=y<0||y===0&&1/y<0?1:0;for(y=Math.abs(y),isNaN(y)||y===1/0?(k=isNaN(y)?1:0,w=I):(w=Math.floor(Math.log(y)/Math.LN2),y*(x=Math.pow(2,-w))<1&&(w--,x*=2),2<=(y+=1<=w+E?N/x:N*Math.pow(2,1-E))*x&&(w++,x/=2),I<=w+E?(k=0,w=I):1<=w+E?(k=(y*x-1)*Math.pow(2,v),w+=E):(k=y*Math.pow(2,E-1)*Math.pow(2,v),w=0));8<=v;f[g+M]=255&k,M+=A,k/=256,v-=8);for(w=w<<v|k,T+=v;0<T;f[g+M]=255&w,M+=A,w/=256,T-=8);f[g+M-A]|=128*R}}).call(this,n("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/ieee754/index.js","/node_modules/gulp-browserify/node_modules/ieee754")},{buffer:3,lYpoI2:11}],11:[function(n,e,t){(function(i,r,s,o,a,c,l,u,p){var f,y,g;function x(){}(i=e.exports={}).nextTick=(y=typeof window<"u"&&window.setImmediate,g=typeof window<"u"&&window.postMessage&&window.addEventListener,y?function(v){return window.setImmediate(v)}:g?(f=[],window.addEventListener("message",function(v){var P=v.source;P!==window&&P!==null||v.data!=="process-tick"||(v.stopPropagation(),0<f.length&&f.shift()())},!0),function(v){f.push(v),window.postMessage("process-tick","*")}):function(v){setTimeout(v,0)}),i.title="browser",i.browser=!0,i.env={},i.argv=[],i.on=x,i.addListener=x,i.once=x,i.off=x,i.removeListener=x,i.removeAllListeners=x,i.emit=x,i.binding=function(v){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(v){throw new Error("process.chdir is not supported")}}).call(this,n("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:11}]},{},[1])(1)})});var as=ue((q4,Z4)=>{"use strict";(function(n,e){typeof q4=="object"&&typeof Z4<"u"?Z4.exports=e():typeof define=="function"&&define.amd?define(e):(n=typeof globalThis<"u"?globalThis:n||self,n.svgson=e())})(q4,(function(){"use strict";var n=function(V){return V!=null&&(e(V)||t(V)||!!V._isBuffer)};function e(V){return!!V.constructor&&typeof V.constructor.isBuffer=="function"&&V.constructor.isBuffer(V)}function t(V){return typeof V.readFloatLE=="function"&&typeof V.slice=="function"&&e(V.slice(0,0))}var i=Object.prototype.toString,r=function(J){if(typeof J>"u")return"undefined";if(J===null)return"null";if(J===!0||J===!1||J instanceof Boolean)return"boolean";if(typeof J=="string"||J instanceof String)return"string";if(typeof J=="number"||J instanceof Number)return"number";if(typeof J=="function"||J instanceof Function)return"function";if(typeof Array.isArray<"u"&&Array.isArray(J))return"array";if(J instanceof RegExp)return"regexp";if(J instanceof Date)return"date";var nt=i.call(J);return nt==="[object RegExp]"?"regexp":nt==="[object Date]"?"date":nt==="[object Arguments]"?"arguments":nt==="[object Error]"?"error":n(J)?"buffer":nt==="[object Set]"?"set":nt==="[object WeakSet]"?"weakset":nt==="[object Map]"?"map":nt==="[object WeakMap]"?"weakmap":nt==="[object Symbol]"?"symbol":nt==="[object Int8Array]"?"int8array":nt==="[object Uint8Array]"?"uint8array":nt==="[object Uint8ClampedArray]"?"uint8clampedarray":nt==="[object Int16Array]"?"int16array":nt==="[object Uint16Array]"?"uint16array":nt==="[object Int32Array]"?"int32array":nt==="[object Uint32Array]"?"uint32array":nt==="[object Float32Array]"?"float32array":nt==="[object Float64Array]"?"float64array":"object"};function s(V,J){return J={exports:{}},V(J,J.exports),J.exports}var o=s(function(V){(function(){function J(nt,ut){if(typeof ut!="function")return nt;var ht={};for(var kt in nt)Object.prototype.hasOwnProperty.call(nt,kt)&&(ht[ut(kt,nt[kt])||kt]=nt[kt]);return ht}V.exports?V.exports=J:window.rename=J})()}),a=function V(J,nt){var ut=r(J);if(ut!=="object"&&ut!=="array")throw new Error("expected an object");var ht=[];ut==="object"&&(J=o(J,nt),ht={});for(var kt in J)if(J.hasOwnProperty(kt)){var Mt=J[kt];r(Mt)==="object"||r(Mt)==="array"?ht[kt]=V(Mt,nt):ht[kt]=Mt}return ht},c=s(function(V){var J=Object.prototype.hasOwnProperty,nt="~";function ut(){}Object.create&&(ut.prototype=Object.create(null),new ut().__proto__||(nt=!1));function ht(Mt,ot,X){this.fn=Mt,this.context=ot,this.once=X||!1}function kt(){this._events=new ut,this._eventsCount=0}kt.prototype.eventNames=function(){var ot=[],X,W;if(this._eventsCount===0)return ot;for(W in X=this._events)J.call(X,W)&&ot.push(nt?W.slice(1):W);return Object.getOwnPropertySymbols?ot.concat(Object.getOwnPropertySymbols(X)):ot},kt.prototype.listeners=function(ot,X){var W=nt?nt+ot:ot,rt=this._events[W];if(X)return!!rt;if(!rt)return[];if(rt.fn)return[rt.fn];for(var pt=0,yt=rt.length,Z=new Array(yt);pt<yt;pt++)Z[pt]=rt[pt].fn;return Z},kt.prototype.emit=function(ot,X,W,rt,pt,yt){var Z=nt?nt+ot:ot;if(!this._events[Z])return!1;var at=this._events[Z],Et=arguments.length,Ft,Ot;if(at.fn){switch(at.once&&this.removeListener(ot,at.fn,void 0,!0),Et){case 1:return at.fn.call(at.context),!0;case 2:return at.fn.call(at.context,X),!0;case 3:return at.fn.call(at.context,X,W),!0;case 4:return at.fn.call(at.context,X,W,rt),!0;case 5:return at.fn.call(at.context,X,W,rt,pt),!0;case 6:return at.fn.call(at.context,X,W,rt,pt,yt),!0}for(Ot=1,Ft=new Array(Et-1);Ot<Et;Ot++)Ft[Ot-1]=arguments[Ot];at.fn.apply(at.context,Ft)}else{var Ce=at.length,Se;for(Ot=0;Ot<Ce;Ot++)switch(at[Ot].once&&this.removeListener(ot,at[Ot].fn,void 0,!0),Et){case 1:at[Ot].fn.call(at[Ot].context);break;case 2:at[Ot].fn.call(at[Ot].context,X);break;case 3:at[Ot].fn.call(at[Ot].context,X,W);break;case 4:at[Ot].fn.call(at[Ot].context,X,W,rt);break;default:if(!Ft)for(Se=1,Ft=new Array(Et-1);Se<Et;Se++)Ft[Se-1]=arguments[Se];at[Ot].fn.apply(at[Ot].context,Ft)}}return!0},kt.prototype.on=function(ot,X,W){var rt=new ht(X,W||this),pt=nt?nt+ot:ot;return this._events[pt]?this._events[pt].fn?this._events[pt]=[this._events[pt],rt]:this._events[pt].push(rt):(this._events[pt]=rt,this._eventsCount++),this},kt.prototype.once=function(ot,X,W){var rt=new ht(X,W||this,!0),pt=nt?nt+ot:ot;return this._events[pt]?this._events[pt].fn?this._events[pt]=[this._events[pt],rt]:this._events[pt].push(rt):(this._events[pt]=rt,this._eventsCount++),this},kt.prototype.removeListener=function(ot,X,W,rt){var pt=nt?nt+ot:ot;if(!this._events[pt])return this;if(!X)return--this._eventsCount===0?this._events=new ut:delete this._events[pt],this;var yt=this._events[pt];if(yt.fn)yt.fn===X&&(!rt||yt.once)&&(!W||yt.context===W)&&(--this._eventsCount===0?this._events=new ut:delete this._events[pt]);else{for(var Z=0,at=[],Et=yt.length;Z<Et;Z++)(yt[Z].fn!==X||rt&&!yt[Z].once||W&&yt[Z].context!==W)&&at.push(yt[Z]);at.length?this._events[pt]=at.length===1?at[0]:at:--this._eventsCount===0?this._events=new ut:delete this._events[pt]}return this},kt.prototype.removeAllListeners=function(ot){var X;return ot?(X=nt?nt+ot:ot,this._events[X]&&(--this._eventsCount===0?this._events=new ut:delete this._events[X])):(this._events=new ut,this._eventsCount=0),this},kt.prototype.off=kt.prototype.removeListener,kt.prototype.addListener=kt.prototype.on,kt.prototype.setMaxListeners=function(){return this},kt.prefixed=nt,kt.EventEmitter=kt,V.exports=kt});function l(V,J,nt){return J in V?Object.defineProperty(V,J,{value:nt,enumerable:!0,configurable:!0,writable:!0}):V[J]=nt,V}var u=function(){},p={data:"state-data",cdata:"state-cdata",tagBegin:"state-tag-begin",tagName:"state-tag-name",tagEnd:"state-tag-end",attributeNameStart:"state-attribute-name-start",attributeName:"state-attribute-name",attributeNameEnd:"state-attribute-name-end",attributeValueBegin:"state-attribute-value-begin",attributeValue:"state-attribute-value"},f={lt:"action-lt",gt:"action-gt",space:"action-space",equal:"action-equal",quote:"action-quote",slash:"action-slash",char:"action-char",error:"action-error"},y={text:"text",openTag:"open-tag",closeTag:"close-tag",attributeName:"attribute-name",attributeValue:"attribute-value"},g={" ":f.space,"	":f.space,"\n":f.space,"\r":f.space,"<":f.lt,">":f.gt,'"':f.quote,"'":f.quote,"=":f.equal,"/":f.slash},x=function(J){return g[J]||f.char},v=function(J){var nt,ut,ht,kt,Mt,ot,X,W,rt,pt;J=Object.assign({debug:!1},J);var yt=new c,Z=p.data,at="",Et="",Ft="",Ot="",Ce="",Se="",Kt=function(qn,Ii){if(!(Et[0]==="?"||Et[0]==="!")){var Nr={type:qn,value:Ii};J.debug&&console.log("emit:",Nr),yt.emit("data",Nr)}};yt.stateMachine=(pt={},l(pt,p.data,(nt={},l(nt,f.lt,function(){at.trim()&&Kt(y.text,at),Et="",Ce=!1,Z=p.tagBegin}),l(nt,f.char,function(Jt){at+=Jt}),nt)),l(pt,p.cdata,l({},f.char,function(Jt){at+=Jt,at.substr(-3)==="]]>"&&(Kt(y.text,at.slice(0,-3)),at="",Z=p.data)})),l(pt,p.tagBegin,(ut={},l(ut,f.space,u),l(ut,f.char,function(Jt){Et=Jt,Z=p.tagName}),l(ut,f.slash,function(){Et="",Ce=!0}),ut)),l(pt,p.tagName,(ht={},l(ht,f.space,function(){Ce?Z=p.tagEnd:(Z=p.attributeNameStart,Kt(y.openTag,Et))}),l(ht,f.gt,function(){Kt(Ce?y.closeTag:y.openTag,Et),at="",Z=p.data}),l(ht,f.slash,function(){Z=p.tagEnd,Kt(y.openTag,Et)}),l(ht,f.char,function(Jt){Et+=Jt,Et==="![CDATA["&&(Z=p.cdata,at="",Et="")}),ht)),l(pt,p.tagEnd,(kt={},l(kt,f.gt,function(){Kt(y.closeTag,Et),at="",Z=p.data}),l(kt,f.char,u),kt)),l(pt,p.attributeNameStart,(Mt={},l(Mt,f.char,function(Jt){Ft=Jt,Z=p.attributeName}),l(Mt,f.gt,function(){at="",Z=p.data}),l(Mt,f.space,u),l(Mt,f.slash,function(){Ce=!0,Z=p.tagEnd}),Mt)),l(pt,p.attributeName,(ot={},l(ot,f.space,function(){Z=p.attributeNameEnd}),l(ot,f.equal,function(){Kt(y.attributeName,Ft),Z=p.attributeValueBegin}),l(ot,f.gt,function(){Ot="",Kt(y.attributeName,Ft),Kt(y.attributeValue,Ot),at="",Z=p.data}),l(ot,f.slash,function(){Ce=!0,Ot="",Kt(y.attributeName,Ft),Kt(y.attributeValue,Ot),Z=p.tagEnd}),l(ot,f.char,function(Jt){Ft+=Jt}),ot)),l(pt,p.attributeNameEnd,(X={},l(X,f.space,u),l(X,f.equal,function(){Kt(y.attributeName,Ft),Z=p.attributeValueBegin}),l(X,f.gt,function(){Ot="",Kt(y.attributeName,Ft),Kt(y.attributeValue,Ot),at="",Z=p.data}),l(X,f.char,function(Jt){Ot="",Kt(y.attributeName,Ft),Kt(y.attributeValue,Ot),Ft=Jt,Z=p.attributeName}),X)),l(pt,p.attributeValueBegin,(W={},l(W,f.space,u),l(W,f.quote,function(Jt){Se=Jt,Ot="",Z=p.attributeValue}),l(W,f.gt,function(){Ot="",Kt(y.attributeValue,Ot),at="",Z=p.data}),l(W,f.char,function(Jt){Se="",Ot=Jt,Z=p.attributeValue}),W)),l(pt,p.attributeValue,(rt={},l(rt,f.space,function(Jt){Se?Ot+=Jt:(Kt(y.attributeValue,Ot),Z=p.attributeNameStart)}),l(rt,f.quote,function(Jt){Se===Jt?(Kt(y.attributeValue,Ot),Z=p.attributeNameStart):Ot+=Jt}),l(rt,f.gt,function(Jt){Se?Ot+=Jt:(Kt(y.attributeValue,Ot),at="",Z=p.data)}),l(rt,f.slash,function(Jt){Se?Ot+=Jt:(Kt(y.attributeValue,Ot),Ce=!0,Z=p.tagEnd)}),l(rt,f.char,function(Jt){Ot+=Jt}),rt)),pt);var le=function(qn){J.debug&&console.log(Z,qn);var Ii=yt.stateMachine[Z],Nr=Ii[x(qn)]||Ii[f.error]||Ii[f.char];Nr(qn)};return yt.write=function(Jt){for(var qn=Jt.length,Ii=0;Ii<qn;Ii++)le(Jt[Ii])},yt},P={State:p,Action:f,Type:y,create:v},w=P.Type,k={element:"element",text:"text"},T=function(J){return Object.assign({name:"",type:k.element,value:"",parent:null,attributes:{},children:[]},J)},I=function(J){J=Object.assign({stream:!1,parentNodes:!0,doneEvent:"done",tagPrefix:"tag:",emitTopLevelOnly:!1,debug:!1},J);var nt=void 0,ut=void 0,ht=void 0,kt=void 0,Mt=new c,ot=function(W){switch(W.type){case w.openTag:if(ht===null)ht=ut,ht.name=W.value;else{var rt=T({name:W.value,parent:ht});ht.children.push(rt),ht=rt}break;case w.closeTag:var pt=ht.parent;if(J.parentNodes||(ht.parent=null),ht.name!==W.value)break;J.stream&&pt===ut&&(ut.children=[],ht.parent=null),(!J.emitTopLevelOnly||pt===ut)&&(Mt.emit(J.tagPrefix+ht.name,ht),Mt.emit("tag",ht.name,ht)),ht===ut&&(nt.removeAllListeners("data"),Mt.emit(J.doneEvent,ht),ut=null),ht=pt;break;case w.text:ht&&ht.children.push(T({type:k.text,value:W.value,parent:J.parentNodes?ht:null}));break;case w.attributeName:kt=W.value,ht.attributes[kt]="";break;case w.attributeValue:ht.attributes[kt]=W.value;break}};return Mt.reset=function(){nt=P.create({debug:J.debug}),nt.on("data",ot),ut=T(),ht=null,kt="",Mt.parse=nt.write},Mt.reset(),Mt},E=function(J,nt){nt=Object.assign({},nt,{stream:!1,tagPrefix:":"});var ut=I(nt),ht=void 0;return ut.on("done",function(kt){ht=kt}),ut.parse(J),ht},N={parseSync:E,create:I,NodeType:k},M=N.parseSync,A=function(J){var nt=M("<root>".concat(J,"</root>"),{parentNodes:!1}),ut=nt.children&&nt.children.length>0&&nt.children.every(function(ht){return ht.name==="svg"});if(ut)return nt.children.length===1?nt.children[0]:nt.children;throw Error("nothing to parse")},R=function(J){return a(J,function(nt){return B(nt)?nt:j(nt)})},j=function(J){return J.replace(/[-|:]([a-z])/gi,function(nt,ut){return ut.toUpperCase()})},B=function(J){return/^(data|aria)(-\w+)/.test(J)},G=function(J){if(J){var nt=String(J);return/[&<>]/.test(nt)?"<![CDATA[".concat(nt.replace(/]]>/,"]]]]><![CDATA[>"),"]]>"):nt}return""},U=function(J){return String(J).replace(/&/g,"&amp;").replace(/'/g,"&apos;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},H=function(J){var nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ut=nt.transformNode,ht=ut===void 0?function(X){return X}:ut,kt=nt.camelcase,Mt=kt===void 0?!1:kt,ot=function(W){var rt;return rt=ht(W),Mt&&(rt=R(rt)),rt};return ot(A(J))};function tt(){for(var V=arguments.length,J=new Array(V),nt=0;nt<V;nt++)J[nt]=arguments[nt];return new Promise(function(ut,ht){try{var kt=H.apply(void 0,J);ut(kt)}catch(Mt){ht(Mt)}})}var et=function V(J){var nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ut=nt.transformAttr,ht=ut===void 0?function(Z,at,Et){return"".concat(Z,'="').concat(Et(at),'"')}:ut,kt=nt.transformNode,Mt=kt===void 0?function(Z){return Z}:kt,ot=nt.selfClose,X=ot===void 0?!0:ot;if(Array.isArray(J))return J.map(function(Z){return V(Z,{transformAttr:ht,selfClose:X,transformNode:Mt})}).join("");var W=Mt(J);if(W.type==="text")return G(W.value);var rt="";for(var pt in W.attributes){var yt=ht(pt,W.attributes[pt],U,W.name);rt+=yt?" ".concat(yt):""}return W.children&&W.children.length>0||!X?"<".concat(W.name).concat(rt,">").concat(V(W.children,{transformAttr:ht,transformNode:Mt,selfClose:X}),"</").concat(W.name,">"):"<".concat(W.name).concat(rt,"/>")},mt=Object.assign({},{parse:tt,parseSync:H,stringify:et});return mt}))});var iw=ue((Ice,MZ)=>{"use strict";function Di(n){this.__parent=n,this.__character_count=0,this.__indent_count=-1,this.__alignment_count=0,this.__wrap_point_index=0,this.__wrap_point_character_count=0,this.__wrap_point_indent_count=-1,this.__wrap_point_alignment_count=0,this.__items=[]}Di.prototype.clone_empty=function(){var n=new Di(this.__parent);return n.set_indent(this.__indent_count,this.__alignment_count),n};Di.prototype.item=function(n){return n<0?this.__items[this.__items.length+n]:this.__items[n]};Di.prototype.has_match=function(n){for(var e=this.__items.length-1;e>=0;e--)if(this.__items[e].match(n))return!0;return!1};Di.prototype.set_indent=function(n,e){this.is_empty()&&(this.__indent_count=n||0,this.__alignment_count=e||0,this.__character_count=this.__parent.get_indent_size(this.__indent_count,this.__alignment_count))};Di.prototype._set_wrap_point=function(){this.__parent.wrap_line_length&&(this.__wrap_point_index=this.__items.length,this.__wrap_point_character_count=this.__character_count,this.__wrap_point_indent_count=this.__parent.next_line.__indent_count,this.__wrap_point_alignment_count=this.__parent.next_line.__alignment_count)};Di.prototype._should_wrap=function(){return this.__wrap_point_index&&this.__character_count>this.__parent.wrap_line_length&&this.__wrap_point_character_count>this.__parent.next_line.__character_count};Di.prototype._allow_wrap=function(){if(this._should_wrap()){this.__parent.add_new_line();var n=this.__parent.current_line;return n.set_indent(this.__wrap_point_indent_count,this.__wrap_point_alignment_count),n.__items=this.__items.slice(this.__wrap_point_index),this.__items=this.__items.slice(0,this.__wrap_point_index),n.__character_count+=this.__character_count-this.__wrap_point_character_count,this.__character_count=this.__wrap_point_character_count,n.__items[0]===" "&&(n.__items.splice(0,1),n.__character_count-=1),!0}return!1};Di.prototype.is_empty=function(){return this.__items.length===0};Di.prototype.last=function(){return this.is_empty()?null:this.__items[this.__items.length-1]};Di.prototype.push=function(n){this.__items.push(n);var e=n.lastIndexOf(`
`);e!==-1?this.__character_count=n.length-e:this.__character_count+=n.length};Di.prototype.pop=function(){var n=null;return this.is_empty()||(n=this.__items.pop(),this.__character_count-=n.length),n};Di.prototype._remove_indent=function(){this.__indent_count>0&&(this.__indent_count-=1,this.__character_count-=this.__parent.indent_size)};Di.prototype._remove_wrap_indent=function(){this.__wrap_point_indent_count>0&&(this.__wrap_point_indent_count-=1)};Di.prototype.trim=function(){for(;this.last()===" ";)this.__items.pop(),this.__character_count-=1};Di.prototype.toString=function(){var n="";return this.is_empty()?this.__parent.indent_empty_lines&&(n=this.__parent.get_indent_string(this.__indent_count)):(n=this.__parent.get_indent_string(this.__indent_count,this.__alignment_count),n+=this.__items.join("")),n};function Gg(n,e){this.__cache=[""],this.__indent_size=n.indent_size,this.__indent_string=n.indent_char,n.indent_with_tabs||(this.__indent_string=new Array(n.indent_size+1).join(n.indent_char)),e=e||"",n.indent_level>0&&(e=new Array(n.indent_level+1).join(this.__indent_string)),this.__base_string=e,this.__base_string_length=e.length}Gg.prototype.get_indent_size=function(n,e){var t=this.__base_string_length;return e=e||0,n<0&&(t=0),t+=n*this.__indent_size,t+=e,t};Gg.prototype.get_indent_string=function(n,e){var t=this.__base_string;return e=e||0,n<0&&(n=0,t=""),e+=n*this.__indent_size,this.__ensure_cache(e),t+=this.__cache[e],t};Gg.prototype.__ensure_cache=function(n){for(;n>=this.__cache.length;)this.__add_column()};Gg.prototype.__add_column=function(){var n=this.__cache.length,e=0,t="";this.__indent_size&&n>=this.__indent_size&&(e=Math.floor(n/this.__indent_size),n-=e*this.__indent_size,t=new Array(e+1).join(this.__indent_string)),n&&(t+=new Array(n+1).join(" ")),this.__cache.push(t)};function ji(n,e){this.__indent_cache=new Gg(n,e),this.raw=!1,this._end_with_newline=n.end_with_newline,this.indent_size=n.indent_size,this.wrap_line_length=n.wrap_line_length,this.indent_empty_lines=n.indent_empty_lines,this.__lines=[],this.previous_line=null,this.current_line=null,this.next_line=new Di(this),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=!1,this.__add_outputline()}ji.prototype.__add_outputline=function(){this.previous_line=this.current_line,this.current_line=this.next_line.clone_empty(),this.__lines.push(this.current_line)};ji.prototype.get_line_number=function(){return this.__lines.length};ji.prototype.get_indent_string=function(n,e){return this.__indent_cache.get_indent_string(n,e)};ji.prototype.get_indent_size=function(n,e){return this.__indent_cache.get_indent_size(n,e)};ji.prototype.is_empty=function(){return!this.previous_line&&this.current_line.is_empty()};ji.prototype.add_new_line=function(n){return this.is_empty()||!n&&this.just_added_newline()?!1:(this.raw||this.__add_outputline(),!0)};ji.prototype.get_code=function(n){this.trim(!0);var e=this.current_line.pop();e&&(e[e.length-1]===`
`&&(e=e.replace(/\n+$/g,"")),this.current_line.push(e)),this._end_with_newline&&this.__add_outputline();var t=this.__lines.join(`
`);return n!==`
`&&(t=t.replace(/[\n]/g,n)),t};ji.prototype.set_wrap_point=function(){this.current_line._set_wrap_point()};ji.prototype.set_indent=function(n,e){return n=n||0,e=e||0,this.next_line.set_indent(n,e),this.__lines.length>1?(this.current_line.set_indent(n,e),!0):(this.current_line.set_indent(),!1)};ji.prototype.add_raw_token=function(n){for(var e=0;e<n.newlines;e++)this.__add_outputline();this.current_line.set_indent(-1),this.current_line.push(n.whitespace_before),this.current_line.push(n.text),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=!1};ji.prototype.add_token=function(n){this.__add_space_before_token(),this.current_line.push(n),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=this.current_line._allow_wrap()};ji.prototype.__add_space_before_token=function(){this.space_before_token&&!this.just_added_newline()&&(this.non_breaking_space||this.set_wrap_point(),this.current_line.push(" "))};ji.prototype.remove_indent=function(n){for(var e=this.__lines.length;n<e;)this.__lines[n]._remove_indent(),n++;this.current_line._remove_wrap_indent()};ji.prototype.trim=function(n){for(n=n===void 0?!1:n,this.current_line.trim();n&&this.__lines.length>1&&this.current_line.is_empty();)this.__lines.pop(),this.current_line=this.__lines[this.__lines.length-1],this.current_line.trim();this.previous_line=this.__lines.length>1?this.__lines[this.__lines.length-2]:null};ji.prototype.just_added_newline=function(){return this.current_line.is_empty()};ji.prototype.just_added_blankline=function(){return this.is_empty()||this.current_line.is_empty()&&this.previous_line.is_empty()};ji.prototype.ensure_empty_line_above=function(n,e){for(var t=this.__lines.length-2;t>=0;){var i=this.__lines[t];if(i.is_empty())break;if(i.item(0).indexOf(n)!==0&&i.item(-1)!==e){this.__lines.splice(t+1,0,new Di(this)),this.previous_line=this.__lines[this.__lines.length-2];break}t--}};MZ.exports.Output=ji});var K4=ue((Nce,CZ)=>{"use strict";function rIt(n,e,t,i){this.type=n,this.text=e,this.comments_before=null,this.newlines=t||0,this.whitespace_before=i||"",this.parent=null,this.next=null,this.previous=null,this.opened=null,this.closed=null,this.directives=null}CZ.exports.Token=rIt});var tN=ue(Aa=>{"use strict";var sIt="\\x23\\x24\\x40\\x41-\\x5a\\x5f\\x61-\\x7a",IZ="\\x24\\x30-\\x39\\x41-\\x5a\\x5f\\x61-\\x7a",J4="\\xaa\\xb5\\xba\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\u02c1\\u02c6-\\u02d1\\u02e0-\\u02e4\\u02ec\\u02ee\\u0370-\\u0374\\u0376\\u0377\\u037a-\\u037d\\u0386\\u0388-\\u038a\\u038c\\u038e-\\u03a1\\u03a3-\\u03f5\\u03f7-\\u0481\\u048a-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05d0-\\u05ea\\u05f0-\\u05f2\\u0620-\\u064a\\u066e\\u066f\\u0671-\\u06d3\\u06d5\\u06e5\\u06e6\\u06ee\\u06ef\\u06fa-\\u06fc\\u06ff\\u0710\\u0712-\\u072f\\u074d-\\u07a5\\u07b1\\u07ca-\\u07ea\\u07f4\\u07f5\\u07fa\\u0800-\\u0815\\u081a\\u0824\\u0828\\u0840-\\u0858\\u08a0\\u08a2-\\u08ac\\u0904-\\u0939\\u093d\\u0950\\u0958-\\u0961\\u0971-\\u0977\\u0979-\\u097f\\u0985-\\u098c\\u098f\\u0990\\u0993-\\u09a8\\u09aa-\\u09b0\\u09b2\\u09b6-\\u09b9\\u09bd\\u09ce\\u09dc\\u09dd\\u09df-\\u09e1\\u09f0\\u09f1\\u0a05-\\u0a0a\\u0a0f\\u0a10\\u0a13-\\u0a28\\u0a2a-\\u0a30\\u0a32\\u0a33\\u0a35\\u0a36\\u0a38\\u0a39\\u0a59-\\u0a5c\\u0a5e\\u0a72-\\u0a74\\u0a85-\\u0a8d\\u0a8f-\\u0a91\\u0a93-\\u0aa8\\u0aaa-\\u0ab0\\u0ab2\\u0ab3\\u0ab5-\\u0ab9\\u0abd\\u0ad0\\u0ae0\\u0ae1\\u0b05-\\u0b0c\\u0b0f\\u0b10\\u0b13-\\u0b28\\u0b2a-\\u0b30\\u0b32\\u0b33\\u0b35-\\u0b39\\u0b3d\\u0b5c\\u0b5d\\u0b5f-\\u0b61\\u0b71\\u0b83\\u0b85-\\u0b8a\\u0b8e-\\u0b90\\u0b92-\\u0b95\\u0b99\\u0b9a\\u0b9c\\u0b9e\\u0b9f\\u0ba3\\u0ba4\\u0ba8-\\u0baa\\u0bae-\\u0bb9\\u0bd0\\u0c05-\\u0c0c\\u0c0e-\\u0c10\\u0c12-\\u0c28\\u0c2a-\\u0c33\\u0c35-\\u0c39\\u0c3d\\u0c58\\u0c59\\u0c60\\u0c61\\u0c85-\\u0c8c\\u0c8e-\\u0c90\\u0c92-\\u0ca8\\u0caa-\\u0cb3\\u0cb5-\\u0cb9\\u0cbd\\u0cde\\u0ce0\\u0ce1\\u0cf1\\u0cf2\\u0d05-\\u0d0c\\u0d0e-\\u0d10\\u0d12-\\u0d3a\\u0d3d\\u0d4e\\u0d60\\u0d61\\u0d7a-\\u0d7f\\u0d85-\\u0d96\\u0d9a-\\u0db1\\u0db3-\\u0dbb\\u0dbd\\u0dc0-\\u0dc6\\u0e01-\\u0e30\\u0e32\\u0e33\\u0e40-\\u0e46\\u0e81\\u0e82\\u0e84\\u0e87\\u0e88\\u0e8a\\u0e8d\\u0e94-\\u0e97\\u0e99-\\u0e9f\\u0ea1-\\u0ea3\\u0ea5\\u0ea7\\u0eaa\\u0eab\\u0ead-\\u0eb0\\u0eb2\\u0eb3\\u0ebd\\u0ec0-\\u0ec4\\u0ec6\\u0edc-\\u0edf\\u0f00\\u0f40-\\u0f47\\u0f49-\\u0f6c\\u0f88-\\u0f8c\\u1000-\\u102a\\u103f\\u1050-\\u1055\\u105a-\\u105d\\u1061\\u1065\\u1066\\u106e-\\u1070\\u1075-\\u1081\\u108e\\u10a0-\\u10c5\\u10c7\\u10cd\\u10d0-\\u10fa\\u10fc-\\u1248\\u124a-\\u124d\\u1250-\\u1256\\u1258\\u125a-\\u125d\\u1260-\\u1288\\u128a-\\u128d\\u1290-\\u12b0\\u12b2-\\u12b5\\u12b8-\\u12be\\u12c0\\u12c2-\\u12c5\\u12c8-\\u12d6\\u12d8-\\u1310\\u1312-\\u1315\\u1318-\\u135a\\u1380-\\u138f\\u13a0-\\u13f4\\u1401-\\u166c\\u166f-\\u167f\\u1681-\\u169a\\u16a0-\\u16ea\\u16ee-\\u16f0\\u1700-\\u170c\\u170e-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176c\\u176e-\\u1770\\u1780-\\u17b3\\u17d7\\u17dc\\u1820-\\u1877\\u1880-\\u18a8\\u18aa\\u18b0-\\u18f5\\u1900-\\u191c\\u1950-\\u196d\\u1970-\\u1974\\u1980-\\u19ab\\u19c1-\\u19c7\\u1a00-\\u1a16\\u1a20-\\u1a54\\u1aa7\\u1b05-\\u1b33\\u1b45-\\u1b4b\\u1b83-\\u1ba0\\u1bae\\u1baf\\u1bba-\\u1be5\\u1c00-\\u1c23\\u1c4d-\\u1c4f\\u1c5a-\\u1c7d\\u1ce9-\\u1cec\\u1cee-\\u1cf1\\u1cf5\\u1cf6\\u1d00-\\u1dbf\\u1e00-\\u1f15\\u1f18-\\u1f1d\\u1f20-\\u1f45\\u1f48-\\u1f4d\\u1f50-\\u1f57\\u1f59\\u1f5b\\u1f5d\\u1f5f-\\u1f7d\\u1f80-\\u1fb4\\u1fb6-\\u1fbc\\u1fbe\\u1fc2-\\u1fc4\\u1fc6-\\u1fcc\\u1fd0-\\u1fd3\\u1fd6-\\u1fdb\\u1fe0-\\u1fec\\u1ff2-\\u1ff4\\u1ff6-\\u1ffc\\u2071\\u207f\\u2090-\\u209c\\u2102\\u2107\\u210a-\\u2113\\u2115\\u2119-\\u211d\\u2124\\u2126\\u2128\\u212a-\\u212d\\u212f-\\u2139\\u213c-\\u213f\\u2145-\\u2149\\u214e\\u2160-\\u2188\\u2c00-\\u2c2e\\u2c30-\\u2c5e\\u2c60-\\u2ce4\\u2ceb-\\u2cee\\u2cf2\\u2cf3\\u2d00-\\u2d25\\u2d27\\u2d2d\\u2d30-\\u2d67\\u2d6f\\u2d80-\\u2d96\\u2da0-\\u2da6\\u2da8-\\u2dae\\u2db0-\\u2db6\\u2db8-\\u2dbe\\u2dc0-\\u2dc6\\u2dc8-\\u2dce\\u2dd0-\\u2dd6\\u2dd8-\\u2dde\\u2e2f\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303c\\u3041-\\u3096\\u309d-\\u309f\\u30a1-\\u30fa\\u30fc-\\u30ff\\u3105-\\u312d\\u3131-\\u318e\\u31a0-\\u31ba\\u31f0-\\u31ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\ua000-\\ua48c\\ua4d0-\\ua4fd\\ua500-\\ua60c\\ua610-\\ua61f\\ua62a\\ua62b\\ua640-\\ua66e\\ua67f-\\ua697\\ua6a0-\\ua6ef\\ua717-\\ua71f\\ua722-\\ua788\\ua78b-\\ua78e\\ua790-\\ua793\\ua7a0-\\ua7aa\\ua7f8-\\ua801\\ua803-\\ua805\\ua807-\\ua80a\\ua80c-\\ua822\\ua840-\\ua873\\ua882-\\ua8b3\\ua8f2-\\ua8f7\\ua8fb\\ua90a-\\ua925\\ua930-\\ua946\\ua960-\\ua97c\\ua984-\\ua9b2\\ua9cf\\uaa00-\\uaa28\\uaa40-\\uaa42\\uaa44-\\uaa4b\\uaa60-\\uaa76\\uaa7a\\uaa80-\\uaaaf\\uaab1\\uaab5\\uaab6\\uaab9-\\uaabd\\uaac0\\uaac2\\uaadb-\\uaadd\\uaae0-\\uaaea\\uaaf2-\\uaaf4\\uab01-\\uab06\\uab09-\\uab0e\\uab11-\\uab16\\uab20-\\uab26\\uab28-\\uab2e\\uabc0-\\uabe2\\uac00-\\ud7a3\\ud7b0-\\ud7c6\\ud7cb-\\ud7fb\\uf900-\\ufa6d\\ufa70-\\ufad9\\ufb00-\\ufb06\\ufb13-\\ufb17\\ufb1d\\ufb1f-\\ufb28\\ufb2a-\\ufb36\\ufb38-\\ufb3c\\ufb3e\\ufb40\\ufb41\\ufb43\\ufb44\\ufb46-\\ufbb1\\ufbd3-\\ufd3d\\ufd50-\\ufd8f\\ufd92-\\ufdc7\\ufdf0-\\ufdfb\\ufe70-\\ufe74\\ufe76-\\ufefc\\uff21-\\uff3a\\uff41-\\uff5a\\uff66-\\uffbe\\uffc2-\\uffc7\\uffca-\\uffcf\\uffd2-\\uffd7\\uffda-\\uffdc",NZ="\\u0300-\\u036f\\u0483-\\u0487\\u0591-\\u05bd\\u05bf\\u05c1\\u05c2\\u05c4\\u05c5\\u05c7\\u0610-\\u061a\\u0620-\\u0649\\u0672-\\u06d3\\u06e7-\\u06e8\\u06fb-\\u06fc\\u0730-\\u074a\\u0800-\\u0814\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0840-\\u0857\\u08e4-\\u08fe\\u0900-\\u0903\\u093a-\\u093c\\u093e-\\u094f\\u0951-\\u0957\\u0962-\\u0963\\u0966-\\u096f\\u0981-\\u0983\\u09bc\\u09be-\\u09c4\\u09c7\\u09c8\\u09d7\\u09df-\\u09e0\\u0a01-\\u0a03\\u0a3c\\u0a3e-\\u0a42\\u0a47\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a66-\\u0a71\\u0a75\\u0a81-\\u0a83\\u0abc\\u0abe-\\u0ac5\\u0ac7-\\u0ac9\\u0acb-\\u0acd\\u0ae2-\\u0ae3\\u0ae6-\\u0aef\\u0b01-\\u0b03\\u0b3c\\u0b3e-\\u0b44\\u0b47\\u0b48\\u0b4b-\\u0b4d\\u0b56\\u0b57\\u0b5f-\\u0b60\\u0b66-\\u0b6f\\u0b82\\u0bbe-\\u0bc2\\u0bc6-\\u0bc8\\u0bca-\\u0bcd\\u0bd7\\u0be6-\\u0bef\\u0c01-\\u0c03\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55\\u0c56\\u0c62-\\u0c63\\u0c66-\\u0c6f\\u0c82\\u0c83\\u0cbc\\u0cbe-\\u0cc4\\u0cc6-\\u0cc8\\u0cca-\\u0ccd\\u0cd5\\u0cd6\\u0ce2-\\u0ce3\\u0ce6-\\u0cef\\u0d02\\u0d03\\u0d46-\\u0d48\\u0d57\\u0d62-\\u0d63\\u0d66-\\u0d6f\\u0d82\\u0d83\\u0dca\\u0dcf-\\u0dd4\\u0dd6\\u0dd8-\\u0ddf\\u0df2\\u0df3\\u0e34-\\u0e3a\\u0e40-\\u0e45\\u0e50-\\u0e59\\u0eb4-\\u0eb9\\u0ec8-\\u0ecd\\u0ed0-\\u0ed9\\u0f18\\u0f19\\u0f20-\\u0f29\\u0f35\\u0f37\\u0f39\\u0f41-\\u0f47\\u0f71-\\u0f84\\u0f86-\\u0f87\\u0f8d-\\u0f97\\u0f99-\\u0fbc\\u0fc6\\u1000-\\u1029\\u1040-\\u1049\\u1067-\\u106d\\u1071-\\u1074\\u1082-\\u108d\\u108f-\\u109d\\u135d-\\u135f\\u170e-\\u1710\\u1720-\\u1730\\u1740-\\u1750\\u1772\\u1773\\u1780-\\u17b2\\u17dd\\u17e0-\\u17e9\\u180b-\\u180d\\u1810-\\u1819\\u1920-\\u192b\\u1930-\\u193b\\u1951-\\u196d\\u19b0-\\u19c0\\u19c8-\\u19c9\\u19d0-\\u19d9\\u1a00-\\u1a15\\u1a20-\\u1a53\\u1a60-\\u1a7c\\u1a7f-\\u1a89\\u1a90-\\u1a99\\u1b46-\\u1b4b\\u1b50-\\u1b59\\u1b6b-\\u1b73\\u1bb0-\\u1bb9\\u1be6-\\u1bf3\\u1c00-\\u1c22\\u1c40-\\u1c49\\u1c5b-\\u1c7d\\u1cd0-\\u1cd2\\u1d00-\\u1dbe\\u1e01-\\u1f15\\u200c\\u200d\\u203f\\u2040\\u2054\\u20d0-\\u20dc\\u20e1\\u20e5-\\u20f0\\u2d81-\\u2d96\\u2de0-\\u2dff\\u3021-\\u3028\\u3099\\u309a\\ua640-\\ua66d\\ua674-\\ua67d\\ua69f\\ua6f0-\\ua6f1\\ua7f8-\\ua800\\ua806\\ua80b\\ua823-\\ua827\\ua880-\\ua881\\ua8b4-\\ua8c4\\ua8d0-\\ua8d9\\ua8f3-\\ua8f7\\ua900-\\ua909\\ua926-\\ua92d\\ua930-\\ua945\\ua980-\\ua983\\ua9b3-\\ua9c0\\uaa00-\\uaa27\\uaa40-\\uaa41\\uaa4c-\\uaa4d\\uaa50-\\uaa59\\uaa7b\\uaae0-\\uaae9\\uaaf2-\\uaaf3\\uabc0-\\uabe1\\uabec\\uabed\\uabf0-\\uabf9\\ufb20-\\ufb28\\ufe00-\\ufe0f\\ufe20-\\ufe26\\ufe33\\ufe34\\ufe4d-\\ufe4f\\uff10-\\uff19\\uff3f",Q4="\\\\u[0-9a-fA-F]{4}|\\\\u\\{[0-9a-fA-F]+\\}",AZ="(?:"+Q4+"|["+sIt+J4+"])",oIt="(?:"+Q4+"|["+IZ+J4+NZ+"])*";Aa.identifier=new RegExp(AZ+oIt,"g");Aa.identifierStart=new RegExp(AZ);Aa.identifierMatch=new RegExp("(?:"+Q4+"|["+IZ+J4+NZ+"])+");Aa.newline=/[\n\r\u2028\u2029]/;Aa.lineBreak=new RegExp(`\r
|`+Aa.newline.source);Aa.allLineBreaks=new RegExp(Aa.lineBreak.source,"g")});var sw=ue((Rce,rw)=>{"use strict";function Qc(n,e){this.raw_options=RZ(n,e),this.disabled=this._get_boolean("disabled"),this.eol=this._get_characters("eol","auto"),this.end_with_newline=this._get_boolean("end_with_newline"),this.indent_size=this._get_number("indent_size",4),this.indent_char=this._get_characters("indent_char"," "),this.indent_level=this._get_number("indent_level"),this.preserve_newlines=this._get_boolean("preserve_newlines",!0),this.max_preserve_newlines=this._get_number("max_preserve_newlines",32786),this.preserve_newlines||(this.max_preserve_newlines=0),this.indent_with_tabs=this._get_boolean("indent_with_tabs",this.indent_char==="	"),this.indent_with_tabs&&(this.indent_char="	",this.indent_size===1&&(this.indent_size=4)),this.wrap_line_length=this._get_number("wrap_line_length",this._get_number("max_char")),this.indent_empty_lines=this._get_boolean("indent_empty_lines"),this.templating=this._get_selection_list("templating",["auto","none","angular","django","erb","handlebars","php","smarty"],["auto"])}Qc.prototype._get_array=function(n,e){var t=this.raw_options[n],i=e||[];return typeof t=="object"?t!==null&&typeof t.concat=="function"&&(i=t.concat()):typeof t=="string"&&(i=t.split(/[^a-zA-Z0-9_\/\-]+/)),i};Qc.prototype._get_boolean=function(n,e){var t=this.raw_options[n],i=t===void 0?!!e:!!t;return i};Qc.prototype._get_characters=function(n,e){var t=this.raw_options[n],i=e||"";return typeof t=="string"&&(i=t.replace(/\\r/,"\r").replace(/\\n/,`
`).replace(/\\t/,"	")),i};Qc.prototype._get_number=function(n,e){var t=this.raw_options[n];e=parseInt(e,10),isNaN(e)&&(e=0);var i=parseInt(t,10);return isNaN(i)&&(i=e),i};Qc.prototype._get_selection=function(n,e,t){var i=this._get_selection_list(n,e,t);if(i.length!==1)throw new Error("Invalid Option Value: The option '"+n+`' can only be one of the following values:
`+e+`
You passed in: '`+this.raw_options[n]+"'");return i[0]};Qc.prototype._get_selection_list=function(n,e,t){if(!e||e.length===0)throw new Error("Selection list cannot be empty.");if(t=t||[e[0]],!this._is_valid_selection(t,e))throw new Error("Invalid Default Value!");var i=this._get_array(n,t);if(!this._is_valid_selection(i,e))throw new Error("Invalid Option Value: The option '"+n+`' can contain only the following values:
`+e+`
You passed in: '`+this.raw_options[n]+"'");return i};Qc.prototype._is_valid_selection=function(n,e){return n.length&&e.length&&!n.some(function(t){return e.indexOf(t)===-1})};function RZ(n,e){var t={};n=OZ(n);var i;for(i in n)i!==e&&(t[i]=n[i]);if(e&&n[e])for(i in n[e])t[i]=n[e][i];return t}function OZ(n){var e={},t;for(t in n){var i=t.replace(/-/g,"_");e[i]=n[t]}return e}rw.exports.Options=Qc;rw.exports.normalizeOpts=OZ;rw.exports.mergeOpts=RZ});var eN=ue((Oce,zZ)=>{"use strict";var LZ=sw().Options,aIt=["before-newline","after-newline","preserve-newline"];function FZ(n){LZ.call(this,n,"js");var e=this.raw_options.brace_style||null;e==="expand-strict"?this.raw_options.brace_style="expand":e==="collapse-preserve-inline"?this.raw_options.brace_style="collapse,preserve-inline":this.raw_options.braces_on_own_line!==void 0&&(this.raw_options.brace_style=this.raw_options.braces_on_own_line?"expand":"collapse");var t=this._get_selection_list("brace_style",["collapse","expand","end-expand","none","preserve-inline"]);this.brace_preserve_inline=!1,this.brace_style="collapse";for(var i=0;i<t.length;i++)t[i]==="preserve-inline"?this.brace_preserve_inline=!0:this.brace_style=t[i];this.unindent_chained_methods=this._get_boolean("unindent_chained_methods"),this.break_chained_methods=this._get_boolean("break_chained_methods"),this.space_in_paren=this._get_boolean("space_in_paren"),this.space_in_empty_paren=this._get_boolean("space_in_empty_paren"),this.jslint_happy=this._get_boolean("jslint_happy"),this.space_after_anon_function=this._get_boolean("space_after_anon_function"),this.space_after_named_function=this._get_boolean("space_after_named_function"),this.keep_array_indentation=this._get_boolean("keep_array_indentation"),this.space_before_conditional=this._get_boolean("space_before_conditional",!0),this.unescape_strings=this._get_boolean("unescape_strings"),this.e4x=this._get_boolean("e4x"),this.comma_first=this._get_boolean("comma_first"),this.operator_position=this._get_selection("operator_position",aIt),this.test_output_raw=this._get_boolean("test_output_raw"),this.jslint_happy&&(this.space_after_anon_function=!0)}FZ.prototype=new LZ;zZ.exports.Options=FZ});var ow=ue((Lce,DZ)=>{"use strict";var $Z=RegExp.prototype.hasOwnProperty("sticky");function sr(n){this.__input=n||"",this.__input_length=this.__input.length,this.__position=0}sr.prototype.restart=function(){this.__position=0};sr.prototype.back=function(){this.__position>0&&(this.__position-=1)};sr.prototype.hasNext=function(){return this.__position<this.__input_length};sr.prototype.next=function(){var n=null;return this.hasNext()&&(n=this.__input.charAt(this.__position),this.__position+=1),n};sr.prototype.peek=function(n){var e=null;return n=n||0,n+=this.__position,n>=0&&n<this.__input_length&&(e=this.__input.charAt(n)),e};sr.prototype.__match=function(n,e){n.lastIndex=e;var t=n.exec(this.__input);return t&&!($Z&&n.sticky)&&t.index!==e&&(t=null),t};sr.prototype.test=function(n,e){return e=e||0,e+=this.__position,e>=0&&e<this.__input_length?!!this.__match(n,e):!1};sr.prototype.testChar=function(n,e){var t=this.peek(e);return n.lastIndex=0,t!==null&&n.test(t)};sr.prototype.match=function(n){var e=this.__match(n,this.__position);return e?this.__position+=e[0].length:e=null,e};sr.prototype.read=function(n,e,t){var i="",r;return n&&(r=this.match(n),r&&(i+=r[0])),e&&(r||!n)&&(i+=this.readUntil(e,t)),i};sr.prototype.readUntil=function(n,e){var t="",i=this.__position;n.lastIndex=this.__position;var r=n.exec(this.__input);return r?(i=r.index,e&&(i+=r[0].length)):i=this.__input_length,t=this.__input.substring(this.__position,i),this.__position=i,t};sr.prototype.readUntilAfter=function(n){return this.readUntil(n,!0)};sr.prototype.get_regexp=function(n,e){var t=null,i="g";return e&&$Z&&(i="y"),typeof n=="string"&&n!==""?t=new RegExp(n,i):n&&(t=new RegExp(n.source,i)),t};sr.prototype.get_literal_regexp=function(n){return RegExp(n.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"))};sr.prototype.peekUntilAfter=function(n){var e=this.__position,t=this.readUntilAfter(n);return this.__position=e,t};sr.prototype.lookBack=function(n){var e=this.__position-1;return e>=n.length&&this.__input.substring(e-n.length,e).toLowerCase()===n};DZ.exports.InputScanner=sr});var BZ=ue((Fce,jZ)=>{"use strict";function hd(n){this.__tokens=[],this.__tokens_length=this.__tokens.length,this.__position=0,this.__parent_token=n}hd.prototype.restart=function(){this.__position=0};hd.prototype.isEmpty=function(){return this.__tokens_length===0};hd.prototype.hasNext=function(){return this.__position<this.__tokens_length};hd.prototype.next=function(){var n=null;return this.hasNext()&&(n=this.__tokens[this.__position],this.__position+=1),n};hd.prototype.peek=function(n){var e=null;return n=n||0,n+=this.__position,n>=0&&n<this.__tokens_length&&(e=this.__tokens[n]),e};hd.prototype.add=function(n){this.__parent_token&&(n.parent=this.__parent_token),this.__tokens.push(n),this.__tokens_length+=1};jZ.exports.TokenStream=hd});var Hg=ue((zce,YZ)=>{"use strict";function Fo(n,e){this._input=n,this._starting_pattern=null,this._match_pattern=null,this._until_pattern=null,this._until_after=!1,e&&(this._starting_pattern=this._input.get_regexp(e._starting_pattern,!0),this._match_pattern=this._input.get_regexp(e._match_pattern,!0),this._until_pattern=this._input.get_regexp(e._until_pattern),this._until_after=e._until_after)}Fo.prototype.read=function(){var n=this._input.read(this._starting_pattern);return(!this._starting_pattern||n)&&(n+=this._input.read(this._match_pattern,this._until_pattern,this._until_after)),n};Fo.prototype.read_match=function(){return this._input.match(this._match_pattern)};Fo.prototype.until_after=function(n){var e=this._create();return e._until_after=!0,e._until_pattern=this._input.get_regexp(n),e._update(),e};Fo.prototype.until=function(n){var e=this._create();return e._until_after=!1,e._until_pattern=this._input.get_regexp(n),e._update(),e};Fo.prototype.starting_with=function(n){var e=this._create();return e._starting_pattern=this._input.get_regexp(n,!0),e._update(),e};Fo.prototype.matching=function(n){var e=this._create();return e._match_pattern=this._input.get_regexp(n,!0),e._update(),e};Fo.prototype._create=function(){return new Fo(this._input,this)};Fo.prototype._update=function(){};YZ.exports.Pattern=Fo});var VZ=ue(($ce,UZ)=>{"use strict";var XZ=Hg().Pattern;function tl(n,e){XZ.call(this,n,e),e?this._line_regexp=this._input.get_regexp(e._line_regexp):this.__set_whitespace_patterns("",""),this.newline_count=0,this.whitespace_before_token=""}tl.prototype=new XZ;tl.prototype.__set_whitespace_patterns=function(n,e){n+="\\t ",e+="\\n\\r",this._match_pattern=this._input.get_regexp("["+n+e+"]+",!0),this._newline_regexp=this._input.get_regexp("\\r\\n|["+e+"]")};tl.prototype.read=function(){this.newline_count=0,this.whitespace_before_token="";var n=this._input.read(this._match_pattern);if(n===" ")this.whitespace_before_token=" ";else if(n){var e=this.__split(this._newline_regexp,n);this.newline_count=e.length-1,this.whitespace_before_token=e[this.newline_count]}return n};tl.prototype.matching=function(n,e){var t=this._create();return t.__set_whitespace_patterns(n,e),t._update(),t};tl.prototype._create=function(){return new tl(this._input,this)};tl.prototype.__split=function(n,e){n.lastIndex=0;for(var t=0,i=[],r=n.exec(e);r;)i.push(e.substring(t,r.index)),t=r.index+r[0].length,r=n.exec(e);return t<e.length?i.push(e.substring(t,e.length)):i.push(""),i};UZ.exports.WhitespacePattern=tl});var qg=ue((Dce,iN)=>{"use strict";var cIt=ow().InputScanner,GZ=K4().Token,nN=BZ().TokenStream,lIt=VZ().WhitespacePattern,Wg={START:"TK_START",RAW:"TK_RAW",EOF:"TK_EOF"},zo=function(n,e){this._input=new cIt(n),this._options=e||{},this.__tokens=null,this._patterns={},this._patterns.whitespace=new lIt(this._input)};zo.prototype.tokenize=function(){this._input.restart(),this.__tokens=new nN,this._reset();for(var n,e=new GZ(Wg.START,""),t=null,i=[],r=new nN;e.type!==Wg.EOF;){for(n=this._get_next_token(e,t);this._is_comment(n);)r.add(n),n=this._get_next_token(e,t);r.isEmpty()||(n.comments_before=r,r=new nN),n.parent=t,this._is_opening(n)?(i.push(t),t=n):t&&this._is_closing(n,t)&&(n.opened=t,t.closed=n,t=i.pop(),n.parent=t),n.previous=e,e.next=n,this.__tokens.add(n),e=n}return this.__tokens};zo.prototype._is_first_token=function(){return this.__tokens.isEmpty()};zo.prototype._reset=function(){};zo.prototype._get_next_token=function(n,e){this._readWhitespace();var t=this._input.read(/.+/g);return t?this._create_token(Wg.RAW,t):this._create_token(Wg.EOF,"")};zo.prototype._is_comment=function(n){return!1};zo.prototype._is_opening=function(n){return!1};zo.prototype._is_closing=function(n,e){return!1};zo.prototype._create_token=function(n,e){var t=new GZ(n,e,this._patterns.whitespace.newline_count,this._patterns.whitespace.whitespace_before_token);return t};zo.prototype._readWhitespace=function(){return this._patterns.whitespace.read()};iN.exports.Tokenizer=zo;iN.exports.TOKEN=Wg});var aw=ue((jce,HZ)=>{"use strict";function rN(n,e){n=typeof n=="string"?n:n.source,e=typeof e=="string"?e:e.source,this.__directives_block_pattern=new RegExp(n+/ beautify( \w+[:]\w+)+ /.source+e,"g"),this.__directive_pattern=/ (\w+)[:](\w+)/g,this.__directives_end_ignore_pattern=new RegExp(n+/\sbeautify\signore:end\s/.source+e,"g")}rN.prototype.get_directives=function(n){if(!n.match(this.__directives_block_pattern))return null;var e={};this.__directive_pattern.lastIndex=0;for(var t=this.__directive_pattern.exec(n);t;)e[t[1]]=t[2],t=this.__directive_pattern.exec(n);return e};rN.prototype.readIgnored=function(n){return n.readUntilAfter(this.__directives_end_ignore_pattern)};HZ.exports.Directives=rN});var aN=ue((Bce,WZ)=>{"use strict";var sN=Hg().Pattern,oN={django:!1,erb:!1,handlebars:!1,php:!1,smarty:!1,angular:!1};function ao(n,e){sN.call(this,n,e),this.__template_pattern=null,this._disabled=Object.assign({},oN),this._excluded=Object.assign({},oN),e&&(this.__template_pattern=this._input.get_regexp(e.__template_pattern),this._excluded=Object.assign(this._excluded,e._excluded),this._disabled=Object.assign(this._disabled,e._disabled));var t=new sN(n);this.__patterns={handlebars_comment:t.starting_with(/{{!--/).until_after(/--}}/),handlebars_unescaped:t.starting_with(/{{{/).until_after(/}}}/),handlebars:t.starting_with(/{{/).until_after(/}}/),php:t.starting_with(/<\?(?:[= ]|php)/).until_after(/\?>/),erb:t.starting_with(/<%[^%]/).until_after(/[^%]%>/),django:t.starting_with(/{%/).until_after(/%}/),django_value:t.starting_with(/{{/).until_after(/}}/),django_comment:t.starting_with(/{#/).until_after(/#}/),smarty:t.starting_with(/{(?=[^}{\s\n])/).until_after(/[^\s\n]}/),smarty_comment:t.starting_with(/{\*/).until_after(/\*}/),smarty_literal:t.starting_with(/{literal}/).until_after(/{\/literal}/)}}ao.prototype=new sN;ao.prototype._create=function(){return new ao(this._input,this)};ao.prototype._update=function(){this.__set_templated_pattern()};ao.prototype.disable=function(n){var e=this._create();return e._disabled[n]=!0,e._update(),e};ao.prototype.read_options=function(n){var e=this._create();for(var t in oN)e._disabled[t]=n.templating.indexOf(t)===-1;return e._update(),e};ao.prototype.exclude=function(n){var e=this._create();return e._excluded[n]=!0,e._update(),e};ao.prototype.read=function(){var n="";this._match_pattern?n=this._input.read(this._starting_pattern):n=this._input.read(this._starting_pattern,this.__template_pattern);for(var e=this._read_template();e;)this._match_pattern?e+=this._input.read(this._match_pattern):e+=this._input.readUntil(this.__template_pattern),n+=e,e=this._read_template();return this._until_after&&(n+=this._input.readUntilAfter(this._until_pattern)),n};ao.prototype.__set_templated_pattern=function(){var n=[];this._disabled.php||n.push(this.__patterns.php._starting_pattern.source),this._disabled.handlebars||n.push(this.__patterns.handlebars._starting_pattern.source),this._disabled.angular||n.push(this.__patterns.handlebars._starting_pattern.source),this._disabled.erb||n.push(this.__patterns.erb._starting_pattern.source),this._disabled.django||(n.push(this.__patterns.django._starting_pattern.source),n.push(this.__patterns.django_value._starting_pattern.source),n.push(this.__patterns.django_comment._starting_pattern.source)),this._disabled.smarty||n.push(this.__patterns.smarty._starting_pattern.source),this._until_pattern&&n.push(this._until_pattern.source),this.__template_pattern=this._input.get_regexp("(?:"+n.join("|")+")")};ao.prototype._read_template=function(){var n="",e=this._input.peek();if(e==="<"){var t=this._input.peek(1);!this._disabled.php&&!this._excluded.php&&t==="?"&&(n=n||this.__patterns.php.read()),!this._disabled.erb&&!this._excluded.erb&&t==="%"&&(n=n||this.__patterns.erb.read())}else e==="{"&&(!this._disabled.handlebars&&!this._excluded.handlebars&&(n=n||this.__patterns.handlebars_comment.read(),n=n||this.__patterns.handlebars_unescaped.read(),n=n||this.__patterns.handlebars.read()),this._disabled.django||(!this._excluded.django&&!this._excluded.handlebars&&(n=n||this.__patterns.django_value.read()),this._excluded.django||(n=n||this.__patterns.django_comment.read(),n=n||this.__patterns.django.read())),this._disabled.smarty||this._disabled.django&&this._disabled.handlebars&&(n=n||this.__patterns.smarty_comment.read(),n=n||this.__patterns.smarty_literal.read(),n=n||this.__patterns.smarty.read()));return n};WZ.exports.TemplatablePattern=ao});var Kg=ue((Yce,Zg)=>{"use strict";var uIt=ow().InputScanner,ZZ=qg().Tokenizer,cN=qg().TOKEN,pIt=aw().Directives,As=tN(),hIt=Hg().Pattern,dIt=aN().TemplatablePattern;function lN(n,e){return e.indexOf(n)!==-1}var fe={START_EXPR:"TK_START_EXPR",END_EXPR:"TK_END_EXPR",START_BLOCK:"TK_START_BLOCK",END_BLOCK:"TK_END_BLOCK",WORD:"TK_WORD",RESERVED:"TK_RESERVED",SEMICOLON:"TK_SEMICOLON",STRING:"TK_STRING",EQUALS:"TK_EQUALS",OPERATOR:"TK_OPERATOR",COMMA:"TK_COMMA",BLOCK_COMMENT:"TK_BLOCK_COMMENT",COMMENT:"TK_COMMENT",DOT:"TK_DOT",UNKNOWN:"TK_UNKNOWN",START:cN.START,RAW:cN.RAW,EOF:cN.EOF},qZ=new pIt(/\/\*/,/\*\//),fIt=/0[xX][0123456789abcdefABCDEF_]*n?|0[oO][01234567_]*n?|0[bB][01_]*n?|\d[\d_]*n|(?:\.\d[\d_]*|\d[\d_]*\.?[\d_]*)(?:[eE][+-]?[\d_]+)?/,mIt=/[0-9]/,_It=/[^\d\.]/,yIt=">>> === !== &&= ??= ||= << && >= ** != == <= >> || ?? |> < / - + > : & % ? ^ | *".split(" "),dd=">>>= ... >>= <<= === >>> !== **= &&= ??= ||= => ^= :: /= << <= == && -= >= >> != -- += ** || ?? ++ %= &= *= |= |> = ! ? > < : / ^ - + * & % ~ |";dd=dd.replace(/[-[\]{}()*+?.,\\^$|#]/g,"\\$&");dd="\\?\\.(?!\\d) "+dd;dd=dd.replace(/ /g,"|");var gIt=new RegExp(dd),KZ="continue,try,throw,return,var,let,const,if,switch,case,default,for,while,break,function,import,export".split(","),xIt=KZ.concat(["do","in","of","else","get","set","new","catch","finally","typeof","yield","async","await","from","as","class","extends"]),bIt=new RegExp("^(?:"+xIt.join("|")+")$"),cw,Bi=function(n,e){ZZ.call(this,n,e),this._patterns.whitespace=this._patterns.whitespace.matching(/\u00A0\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff/.source,/\u2028\u2029/.source);var t=new hIt(this._input),i=new dIt(this._input).read_options(this._options);this.__patterns={template:i,identifier:i.starting_with(As.identifier).matching(As.identifierMatch),number:t.matching(fIt),punct:t.matching(gIt),comment:t.starting_with(/\/\//).until(/[\n\r\u2028\u2029]/),block_comment:t.starting_with(/\/\*/).until_after(/\*\//),html_comment_start:t.matching(/<!--/),html_comment_end:t.matching(/-->/),include:t.starting_with(/#include/).until_after(As.lineBreak),shebang:t.starting_with(/#!/).until_after(As.lineBreak),xml:t.matching(/[\s\S]*?<(\/?)([-a-zA-Z:0-9_.]+|{[^}]+?}|!\[CDATA\[[^\]]*?\]\]|)(\s*{[^}]+?}|\s+[-a-zA-Z:0-9_.]+|\s+[-a-zA-Z:0-9_.]+\s*=\s*('[^']*'|"[^"]*"|{([^{}]|{[^}]+?})+?}))*\s*(\/?)\s*>/),single_quote:i.until(/['\\\n\r\u2028\u2029]/),double_quote:i.until(/["\\\n\r\u2028\u2029]/),template_text:i.until(/[`\\$]/),template_expression:i.until(/[`}\\]/)}};Bi.prototype=new ZZ;Bi.prototype._is_comment=function(n){return n.type===fe.COMMENT||n.type===fe.BLOCK_COMMENT||n.type===fe.UNKNOWN};Bi.prototype._is_opening=function(n){return n.type===fe.START_BLOCK||n.type===fe.START_EXPR};Bi.prototype._is_closing=function(n,e){return(n.type===fe.END_BLOCK||n.type===fe.END_EXPR)&&e&&(n.text==="]"&&e.text==="["||n.text===")"&&e.text==="("||n.text==="}"&&e.text==="{")};Bi.prototype._reset=function(){cw=!1};Bi.prototype._get_next_token=function(n,e){var t=null;this._readWhitespace();var i=this._input.peek();return i===null?this._create_token(fe.EOF,""):(t=t||this._read_non_javascript(i),t=t||this._read_string(i),t=t||this._read_pair(i,this._input.peek(1)),t=t||this._read_word(n),t=t||this._read_singles(i),t=t||this._read_comment(i),t=t||this._read_regexp(i,n),t=t||this._read_xml(i,n),t=t||this._read_punctuation(),t=t||this._create_token(fe.UNKNOWN,this._input.next()),t)};Bi.prototype._read_word=function(n){var e;if(e=this.__patterns.identifier.read(),e!=="")return e=e.replace(As.allLineBreaks,`
`),!(n.type===fe.DOT||n.type===fe.RESERVED&&(n.text==="set"||n.text==="get"))&&bIt.test(e)?(e==="in"||e==="of")&&(n.type===fe.WORD||n.type===fe.STRING)?this._create_token(fe.OPERATOR,e):this._create_token(fe.RESERVED,e):this._create_token(fe.WORD,e);if(e=this.__patterns.number.read(),e!=="")return this._create_token(fe.WORD,e)};Bi.prototype._read_singles=function(n){var e=null;return n==="("||n==="["?e=this._create_token(fe.START_EXPR,n):n===")"||n==="]"?e=this._create_token(fe.END_EXPR,n):n==="{"?e=this._create_token(fe.START_BLOCK,n):n==="}"?e=this._create_token(fe.END_BLOCK,n):n===";"?e=this._create_token(fe.SEMICOLON,n):n==="."&&_It.test(this._input.peek(1))?e=this._create_token(fe.DOT,n):n===","&&(e=this._create_token(fe.COMMA,n)),e&&this._input.next(),e};Bi.prototype._read_pair=function(n,e){var t=null;return n==="#"&&e==="{"&&(t=this._create_token(fe.START_BLOCK,n+e)),t&&(this._input.next(),this._input.next()),t};Bi.prototype._read_punctuation=function(){var n=this.__patterns.punct.read();if(n!=="")return n==="="?this._create_token(fe.EQUALS,n):n==="?."?this._create_token(fe.DOT,n):this._create_token(fe.OPERATOR,n)};Bi.prototype._read_non_javascript=function(n){var e="";if(n==="#"){if(this._is_first_token()&&(e=this.__patterns.shebang.read(),e))return this._create_token(fe.UNKNOWN,e.trim()+`
`);if(e=this.__patterns.include.read(),e)return this._create_token(fe.UNKNOWN,e.trim()+`
`);n=this._input.next();var t="#";if(this._input.hasNext()&&this._input.testChar(mIt)){do n=this._input.next(),t+=n;while(this._input.hasNext()&&n!=="#"&&n!=="=");return n==="#"||(this._input.peek()==="["&&this._input.peek(1)==="]"?(t+="[]",this._input.next(),this._input.next()):this._input.peek()==="{"&&this._input.peek(1)==="}"&&(t+="{}",this._input.next(),this._input.next())),this._create_token(fe.WORD,t)}this._input.back()}else if(n==="<"&&this._is_first_token()){if(e=this.__patterns.html_comment_start.read(),e){for(;this._input.hasNext()&&!this._input.testChar(As.newline);)e+=this._input.next();return cw=!0,this._create_token(fe.COMMENT,e)}}else if(cw&&n==="-"&&(e=this.__patterns.html_comment_end.read(),e))return cw=!1,this._create_token(fe.COMMENT,e);return null};Bi.prototype._read_comment=function(n){var e=null;if(n==="/"){var t="";if(this._input.peek(1)==="*"){t=this.__patterns.block_comment.read();var i=qZ.get_directives(t);i&&i.ignore==="start"&&(t+=qZ.readIgnored(this._input)),t=t.replace(As.allLineBreaks,`
`),e=this._create_token(fe.BLOCK_COMMENT,t),e.directives=i}else this._input.peek(1)==="/"&&(t=this.__patterns.comment.read(),e=this._create_token(fe.COMMENT,t))}return e};Bi.prototype._read_string=function(n){if(n==="`"||n==="'"||n==='"'){var e=this._input.next();return this.has_char_escapes=!1,n==="`"?e+=this._read_string_recursive("`",!0,"${"):e+=this._read_string_recursive(n),this.has_char_escapes&&this._options.unescape_strings&&(e=vIt(e)),this._input.peek()===n&&(e+=this._input.next()),e=e.replace(As.allLineBreaks,`
`),this._create_token(fe.STRING,e)}return null};Bi.prototype._allow_regexp_or_xml=function(n){return n.type===fe.RESERVED&&lN(n.text,["return","case","throw","else","do","typeof","yield"])||n.type===fe.END_EXPR&&n.text===")"&&n.opened.previous.type===fe.RESERVED&&lN(n.opened.previous.text,["if","while","for"])||lN(n.type,[fe.COMMENT,fe.START_EXPR,fe.START_BLOCK,fe.START,fe.END_BLOCK,fe.OPERATOR,fe.EQUALS,fe.EOF,fe.SEMICOLON,fe.COMMA])};Bi.prototype._read_regexp=function(n,e){if(n==="/"&&this._allow_regexp_or_xml(e)){for(var t=this._input.next(),i=!1,r=!1;this._input.hasNext()&&(i||r||this._input.peek()!==n)&&!this._input.testChar(As.newline);)t+=this._input.peek(),i?i=!1:(i=this._input.peek()==="\\",this._input.peek()==="["?r=!0:this._input.peek()==="]"&&(r=!1)),this._input.next();return this._input.peek()===n&&(t+=this._input.next(),t+=this._input.read(As.identifier)),this._create_token(fe.STRING,t)}return null};Bi.prototype._read_xml=function(n,e){if(this._options.e4x&&n==="<"&&this._allow_regexp_or_xml(e)){var t="",i=this.__patterns.xml.read_match();if(i){for(var r=i[2].replace(/^{\s+/,"{").replace(/\s+}$/,"}"),s=r.indexOf("{")===0,o=0;i;){var a=!!i[1],c=i[2],l=!!i[i.length-1]||c.slice(0,8)==="![CDATA[";if(!l&&(c===r||s&&c.replace(/^{\s+/,"{").replace(/\s+}$/,"}"))&&(a?--o:++o),t+=i[0],o<=0)break;i=this.__patterns.xml.read_match()}return i||(t+=this._input.match(/[\s\S]*/g)[0]),t=t.replace(As.allLineBreaks,`
`),this._create_token(fe.STRING,t)}}return null};function vIt(n){for(var e="",t=0,i=new uIt(n),r=null;i.hasNext();)if(r=i.match(/([\s]|[^\\]|\\\\)+/g),r&&(e+=r[0]),i.peek()==="\\"){if(i.next(),i.peek()==="x")r=i.match(/x([0-9A-Fa-f]{2})/g);else if(i.peek()==="u")r=i.match(/u([0-9A-Fa-f]{4})/g),r||(r=i.match(/u\{([0-9A-Fa-f]+)\}/g));else{e+="\\",i.hasNext()&&(e+=i.next());continue}if(!r||(t=parseInt(r[1],16),t>126&&t<=255&&r[0].indexOf("x")===0))return n;t>=0&&t<32||t>1114111?e+="\\"+r[0]:t===34||t===39||t===92?e+="\\"+String.fromCharCode(t):e+=String.fromCharCode(t)}return e}Bi.prototype._read_string_recursive=function(n,e,t){var i,r;n==="'"?r=this.__patterns.single_quote:n==='"'?r=this.__patterns.double_quote:n==="`"?r=this.__patterns.template_text:n==="}"&&(r=this.__patterns.template_expression);for(var s=r.read(),o="";this._input.hasNext();){if(o=this._input.next(),o===n||!e&&As.newline.test(o)){this._input.back();break}else o==="\\"&&this._input.hasNext()?(i=this._input.peek(),i==="x"||i==="u"?this.has_char_escapes=!0:i==="\r"&&this._input.peek(1)===`
`&&this._input.next(),o+=this._input.next()):t&&(t==="${"&&o==="$"&&this._input.peek()==="{"&&(o+=this._input.next()),t===o&&(n==="`"?o+=this._read_string_recursive("}",e,"`"):o+=this._read_string_recursive("`",e,"${"),this._input.hasNext()&&(o+=this._input.next())));o+=r.read(),s+=o}return s};Zg.exports.Tokenizer=Bi;Zg.exports.TOKEN=fe;Zg.exports.positionable_operators=yIt.slice();Zg.exports.line_starters=KZ.slice()});var eK=ue((Xce,tK)=>{"use strict";var SIt=iw().Output,wIt=K4().Token,lw=tN(),PIt=eN().Options,kIt=Kg().Tokenizer,e1=Kg().line_starters,Jg=Kg().positionable_operators,Tt=Kg().TOKEN;function Re(n,e){return e.indexOf(n)!==-1}function TIt(n){return n.replace(/^\s+/g,"")}function EIt(n){for(var e={},t=0;t<n.length;t++)e[n[t].replace(/-/g,"_")]=n[t];return e}function Rs(n,e){return n&&n.type===Tt.RESERVED&&n.text===e}function Cn(n,e){return n&&n.type===Tt.RESERVED&&Re(n.text,e)}var uw=["case","return","do","if","throw","else","await","break","continue","async"],MIt=["before-newline","after-newline","preserve-newline"],Qg=EIt(MIt),JZ=[Qg.before_newline,Qg.preserve_newline],ge={BlockStatement:"BlockStatement",Statement:"Statement",ObjectLiteral:"ObjectLiteral",ArrayLiteral:"ArrayLiteral",ForInitializer:"ForInitializer",Conditional:"Conditional",Expression:"Expression"};function QZ(n,e){e.multiline_frame||e.mode===ge.ForInitializer||e.mode===ge.Conditional||n.remove_indent(e.start_line_index)}function CIt(n){n=n.replace(lw.allLineBreaks,`
`);for(var e=[],t=n.indexOf(`
`);t!==-1;)e.push(n.substring(0,t)),n=n.substring(t+1),t=n.indexOf(`
`);return n.length&&e.push(n),e}function el(n){return n===ge.ArrayLiteral}function t1(n){return Re(n,[ge.Expression,ge.ForInitializer,ge.Conditional])}function IIt(n,e){for(var t=0;t<n.length;t++){var i=n[t].trim();if(i.charAt(0)!==e)return!1}return!0}function NIt(n,e){for(var t=0,i=n.length,r;t<i;t++)if(r=n[t],r&&r.indexOf(e)!==0)return!1;return!0}function cn(n,e){e=e||{},this._source_text=n||"",this._output=null,this._tokens=null,this._last_last_text=null,this._flags=null,this._previous_flags=null,this._flag_store=null,this._options=new PIt(e)}cn.prototype.create_flags=function(n,e){var t=0;n&&(t=n.indentation_level,!this._output.just_added_newline()&&n.line_indent_level>t&&(t=n.line_indent_level));var i={mode:e,parent:n,last_token:n?n.last_token:new wIt(Tt.START_BLOCK,""),last_word:n?n.last_word:"",declaration_statement:!1,declaration_assignment:!1,multiline_frame:!1,inline_frame:!1,if_block:!1,else_block:!1,class_start_block:!1,do_block:!1,do_while:!1,import_block:!1,in_case_statement:!1,in_case:!1,case_body:!1,case_block:!1,indentation_level:t,alignment:0,line_indent_level:n?n.line_indent_level:t,start_line_index:this._output.get_line_number(),ternary_depth:0};return i};cn.prototype._reset=function(n){var e=n.match(/^[\t ]*/)[0];this._last_last_text="",this._output=new SIt(this._options,e),this._output.raw=this._options.test_output_raw,this._flag_store=[],this.set_mode(ge.BlockStatement);var t=new kIt(n,this._options);return this._tokens=t.tokenize(),n};cn.prototype.beautify=function(){if(this._options.disabled)return this._source_text;var n,e=this._reset(this._source_text),t=this._options.eol;this._options.eol==="auto"&&(t=`
`,e&&lw.lineBreak.test(e||"")&&(t=e.match(lw.lineBreak)[0]));for(var i=this._tokens.next();i;)this.handle_token(i),this._last_last_text=this._flags.last_token.text,this._flags.last_token=i,i=this._tokens.next();return n=this._output.get_code(t),n};cn.prototype.handle_token=function(n,e){n.type===Tt.START_EXPR?this.handle_start_expr(n):n.type===Tt.END_EXPR?this.handle_end_expr(n):n.type===Tt.START_BLOCK?this.handle_start_block(n):n.type===Tt.END_BLOCK?this.handle_end_block(n):n.type===Tt.WORD?this.handle_word(n):n.type===Tt.RESERVED?this.handle_word(n):n.type===Tt.SEMICOLON?this.handle_semicolon(n):n.type===Tt.STRING?this.handle_string(n):n.type===Tt.EQUALS?this.handle_equals(n):n.type===Tt.OPERATOR?this.handle_operator(n):n.type===Tt.COMMA?this.handle_comma(n):n.type===Tt.BLOCK_COMMENT?this.handle_block_comment(n,e):n.type===Tt.COMMENT?this.handle_comment(n,e):n.type===Tt.DOT?this.handle_dot(n):n.type===Tt.EOF?this.handle_eof(n):n.type===Tt.UNKNOWN?this.handle_unknown(n,e):this.handle_unknown(n,e)};cn.prototype.handle_whitespace_and_comments=function(n,e){var t=n.newlines,i=this._options.keep_array_indentation&&el(this._flags.mode);if(n.comments_before)for(var r=n.comments_before.next();r;)this.handle_whitespace_and_comments(r,e),this.handle_token(r,e),r=n.comments_before.next();if(i)for(var s=0;s<t;s+=1)this.print_newline(s>0,e);else if(this._options.max_preserve_newlines&&t>this._options.max_preserve_newlines&&(t=this._options.max_preserve_newlines),this._options.preserve_newlines&&t>1){this.print_newline(!1,e);for(var o=1;o<t;o+=1)this.print_newline(!0,e)}};var uN=["async","break","continue","return","throw","yield"];cn.prototype.allow_wrap_or_preserved_newline=function(n,e){if(e=e===void 0?!1:e,!this._output.just_added_newline()){var t=this._options.preserve_newlines&&n.newlines||e,i=Re(this._flags.last_token.text,Jg)||Re(n.text,Jg);if(i){var r=Re(this._flags.last_token.text,Jg)&&Re(this._options.operator_position,JZ)||Re(n.text,Jg);t=t&&r}if(t)this.print_newline(!1,!0);else if(this._options.wrap_line_length){if(Cn(this._flags.last_token,uN))return;this._output.set_wrap_point()}}};cn.prototype.print_newline=function(n,e){if(!e&&this._flags.last_token.text!==";"&&this._flags.last_token.text!==","&&this._flags.last_token.text!=="="&&(this._flags.last_token.type!==Tt.OPERATOR||this._flags.last_token.text==="--"||this._flags.last_token.text==="++"))for(var t=this._tokens.peek();this._flags.mode===ge.Statement&&!(this._flags.if_block&&Rs(t,"else"))&&!this._flags.do_block;)this.restore_mode();this._output.add_new_line(n)&&(this._flags.multiline_frame=!0)};cn.prototype.print_token_line_indentation=function(n){this._output.just_added_newline()&&(this._options.keep_array_indentation&&n.newlines&&(n.text==="["||el(this._flags.mode))?(this._output.current_line.set_indent(-1),this._output.current_line.push(n.whitespace_before),this._output.space_before_token=!1):this._output.set_indent(this._flags.indentation_level,this._flags.alignment)&&(this._flags.line_indent_level=this._flags.indentation_level))};cn.prototype.print_token=function(n){if(this._output.raw){this._output.add_raw_token(n);return}if(this._options.comma_first&&n.previous&&n.previous.type===Tt.COMMA&&this._output.just_added_newline()&&this._output.previous_line.last()===","){var e=this._output.previous_line.pop();this._output.previous_line.is_empty()&&(this._output.previous_line.push(e),this._output.trim(!0),this._output.current_line.pop(),this._output.trim()),this.print_token_line_indentation(n),this._output.add_token(","),this._output.space_before_token=!0}this.print_token_line_indentation(n),this._output.non_breaking_space=!0,this._output.add_token(n.text),this._output.previous_token_wrapped&&(this._flags.multiline_frame=!0)};cn.prototype.indent=function(){this._flags.indentation_level+=1,this._output.set_indent(this._flags.indentation_level,this._flags.alignment)};cn.prototype.deindent=function(){this._flags.indentation_level>0&&(!this._flags.parent||this._flags.indentation_level>this._flags.parent.indentation_level)&&(this._flags.indentation_level-=1,this._output.set_indent(this._flags.indentation_level,this._flags.alignment))};cn.prototype.set_mode=function(n){this._flags?(this._flag_store.push(this._flags),this._previous_flags=this._flags):this._previous_flags=this.create_flags(null,n),this._flags=this.create_flags(this._previous_flags,n),this._output.set_indent(this._flags.indentation_level,this._flags.alignment)};cn.prototype.restore_mode=function(){this._flag_store.length>0&&(this._previous_flags=this._flags,this._flags=this._flag_store.pop(),this._previous_flags.mode===ge.Statement&&QZ(this._output,this._previous_flags),this._output.set_indent(this._flags.indentation_level,this._flags.alignment))};cn.prototype.start_of_object_property=function(){return this._flags.parent.mode===ge.ObjectLiteral&&this._flags.mode===ge.Statement&&(this._flags.last_token.text===":"&&this._flags.ternary_depth===0||Cn(this._flags.last_token,["get","set"]))};cn.prototype.start_of_statement=function(n){var e=!1;return e=e||Cn(this._flags.last_token,["var","let","const"])&&n.type===Tt.WORD,e=e||Rs(this._flags.last_token,"do"),e=e||!(this._flags.parent.mode===ge.ObjectLiteral&&this._flags.mode===ge.Statement)&&Cn(this._flags.last_token,uN)&&!n.newlines,e=e||Rs(this._flags.last_token,"else")&&!(Rs(n,"if")&&!n.comments_before),e=e||this._flags.last_token.type===Tt.END_EXPR&&(this._previous_flags.mode===ge.ForInitializer||this._previous_flags.mode===ge.Conditional),e=e||this._flags.last_token.type===Tt.WORD&&this._flags.mode===ge.BlockStatement&&!this._flags.in_case&&!(n.text==="--"||n.text==="++")&&this._last_last_text!=="function"&&n.type!==Tt.WORD&&n.type!==Tt.RESERVED,e=e||this._flags.mode===ge.ObjectLiteral&&(this._flags.last_token.text===":"&&this._flags.ternary_depth===0||Cn(this._flags.last_token,["get","set"])),e?(this.set_mode(ge.Statement),this.indent(),this.handle_whitespace_and_comments(n,!0),this.start_of_object_property()||this.allow_wrap_or_preserved_newline(n,Cn(n,["do","for","if","while"])),!0):!1};cn.prototype.handle_start_expr=function(n){this.start_of_statement(n)||this.handle_whitespace_and_comments(n);var e=ge.Expression;if(n.text==="["){if(this._flags.last_token.type===Tt.WORD||this._flags.last_token.text===")"){Cn(this._flags.last_token,e1)&&(this._output.space_before_token=!0),this.print_token(n),this.set_mode(e),this.indent(),this._options.space_in_paren&&(this._output.space_before_token=!0);return}e=ge.ArrayLiteral,el(this._flags.mode)&&(this._flags.last_token.text==="["||this._flags.last_token.text===","&&(this._last_last_text==="]"||this._last_last_text==="}"))&&(this._options.keep_array_indentation||this.print_newline()),Re(this._flags.last_token.type,[Tt.START_EXPR,Tt.END_EXPR,Tt.WORD,Tt.OPERATOR,Tt.DOT])||(this._output.space_before_token=!0)}else{if(this._flags.last_token.type===Tt.RESERVED)this._flags.last_token.text==="for"?(this._output.space_before_token=this._options.space_before_conditional,e=ge.ForInitializer):Re(this._flags.last_token.text,["if","while","switch"])?(this._output.space_before_token=this._options.space_before_conditional,e=ge.Conditional):Re(this._flags.last_word,["await","async"])?this._output.space_before_token=!0:this._flags.last_token.text==="import"&&n.whitespace_before===""?this._output.space_before_token=!1:(Re(this._flags.last_token.text,e1)||this._flags.last_token.text==="catch")&&(this._output.space_before_token=!0);else if(this._flags.last_token.type===Tt.EQUALS||this._flags.last_token.type===Tt.OPERATOR)this.start_of_object_property()||this.allow_wrap_or_preserved_newline(n);else if(this._flags.last_token.type===Tt.WORD){this._output.space_before_token=!1;var t=this._tokens.peek(-3);if(this._options.space_after_named_function&&t){var i=this._tokens.peek(-4);Cn(t,["async","function"])||t.text==="*"&&Cn(i,["async","function"])?this._output.space_before_token=!0:this._flags.mode===ge.ObjectLiteral?(t.text==="{"||t.text===","||t.text==="*"&&(i.text==="{"||i.text===","))&&(this._output.space_before_token=!0):this._flags.parent&&this._flags.parent.class_start_block&&(this._output.space_before_token=!0)}}else this.allow_wrap_or_preserved_newline(n);(this._flags.last_token.type===Tt.RESERVED&&(this._flags.last_word==="function"||this._flags.last_word==="typeof")||this._flags.last_token.text==="*"&&(Re(this._last_last_text,["function","yield"])||this._flags.mode===ge.ObjectLiteral&&Re(this._last_last_text,["{",","])))&&(this._output.space_before_token=this._options.space_after_anon_function)}this._flags.last_token.text===";"||this._flags.last_token.type===Tt.START_BLOCK?this.print_newline():(this._flags.last_token.type===Tt.END_EXPR||this._flags.last_token.type===Tt.START_EXPR||this._flags.last_token.type===Tt.END_BLOCK||this._flags.last_token.text==="."||this._flags.last_token.type===Tt.COMMA)&&this.allow_wrap_or_preserved_newline(n,n.newlines),this.print_token(n),this.set_mode(e),this._options.space_in_paren&&(this._output.space_before_token=!0),this.indent()};cn.prototype.handle_end_expr=function(n){for(;this._flags.mode===ge.Statement;)this.restore_mode();this.handle_whitespace_and_comments(n),this._flags.multiline_frame&&this.allow_wrap_or_preserved_newline(n,n.text==="]"&&el(this._flags.mode)&&!this._options.keep_array_indentation),this._options.space_in_paren&&(this._flags.last_token.type===Tt.START_EXPR&&!this._options.space_in_empty_paren?(this._output.trim(),this._output.space_before_token=!1):this._output.space_before_token=!0),this.deindent(),this.print_token(n),this.restore_mode(),QZ(this._output,this._previous_flags),this._flags.do_while&&this._previous_flags.mode===ge.Conditional&&(this._previous_flags.mode=ge.Expression,this._flags.do_block=!1,this._flags.do_while=!1)};cn.prototype.handle_start_block=function(n){this.handle_whitespace_and_comments(n);var e=this._tokens.peek(),t=this._tokens.peek(1);this._flags.last_word==="switch"&&this._flags.last_token.type===Tt.END_EXPR?(this.set_mode(ge.BlockStatement),this._flags.in_case_statement=!0):this._flags.case_body?this.set_mode(ge.BlockStatement):t&&(Re(t.text,[":",","])&&Re(e.type,[Tt.STRING,Tt.WORD,Tt.RESERVED])||Re(e.text,["get","set","..."])&&Re(t.type,[Tt.WORD,Tt.RESERVED]))?Re(this._last_last_text,["class","interface"])&&!Re(t.text,[":",","])?this.set_mode(ge.BlockStatement):this.set_mode(ge.ObjectLiteral):this._flags.last_token.type===Tt.OPERATOR&&this._flags.last_token.text==="=>"?this.set_mode(ge.BlockStatement):Re(this._flags.last_token.type,[Tt.EQUALS,Tt.START_EXPR,Tt.COMMA,Tt.OPERATOR])||Cn(this._flags.last_token,["return","throw","import","default"])?this.set_mode(ge.ObjectLiteral):this.set_mode(ge.BlockStatement),this._flags.last_token&&Cn(this._flags.last_token.previous,["class","extends"])&&(this._flags.class_start_block=!0);var i=!e.comments_before&&e.text==="}",r=i&&this._flags.last_word==="function"&&this._flags.last_token.type===Tt.END_EXPR;if(this._options.brace_preserve_inline){var s=0,o=null;this._flags.inline_frame=!0;do if(s+=1,o=this._tokens.peek(s-1),o.newlines){this._flags.inline_frame=!1;break}while(o.type!==Tt.EOF&&!(o.type===Tt.END_BLOCK&&o.opened===n))}(this._options.brace_style==="expand"||this._options.brace_style==="none"&&n.newlines)&&!this._flags.inline_frame?this._flags.last_token.type!==Tt.OPERATOR&&(r||this._flags.last_token.type===Tt.EQUALS||Cn(this._flags.last_token,uw)&&this._flags.last_token.text!=="else")?this._output.space_before_token=!0:this.print_newline(!1,!0):(el(this._previous_flags.mode)&&(this._flags.last_token.type===Tt.START_EXPR||this._flags.last_token.type===Tt.COMMA)&&((this._flags.last_token.type===Tt.COMMA||this._options.space_in_paren)&&(this._output.space_before_token=!0),(this._flags.last_token.type===Tt.COMMA||this._flags.last_token.type===Tt.START_EXPR&&this._flags.inline_frame)&&(this.allow_wrap_or_preserved_newline(n),this._previous_flags.multiline_frame=this._previous_flags.multiline_frame||this._flags.multiline_frame,this._flags.multiline_frame=!1)),this._flags.last_token.type!==Tt.OPERATOR&&this._flags.last_token.type!==Tt.START_EXPR&&(Re(this._flags.last_token.type,[Tt.START_BLOCK,Tt.SEMICOLON])&&!this._flags.inline_frame?this.print_newline():this._output.space_before_token=!0)),this.print_token(n),this.indent(),!i&&!(this._options.brace_preserve_inline&&this._flags.inline_frame)&&this.print_newline()};cn.prototype.handle_end_block=function(n){for(this.handle_whitespace_and_comments(n);this._flags.mode===ge.Statement;)this.restore_mode();var e=this._flags.last_token.type===Tt.START_BLOCK;this._flags.inline_frame&&!e?this._output.space_before_token=!0:this._options.brace_style==="expand"?e||this.print_newline():e||(el(this._flags.mode)&&this._options.keep_array_indentation?(this._options.keep_array_indentation=!1,this.print_newline(),this._options.keep_array_indentation=!0):this.print_newline()),this.restore_mode(),this.print_token(n)};cn.prototype.handle_word=function(n){if(n.type===Tt.RESERVED){if(Re(n.text,["set","get"])&&this._flags.mode!==ge.ObjectLiteral)n.type=Tt.WORD;else if(n.text==="import"&&Re(this._tokens.peek().text,["(","."]))n.type=Tt.WORD;else if(Re(n.text,["as","from"])&&!this._flags.import_block)n.type=Tt.WORD;else if(this._flags.mode===ge.ObjectLiteral){var e=this._tokens.peek();e.text===":"&&(n.type=Tt.WORD)}}if(this.start_of_statement(n)?Cn(this._flags.last_token,["var","let","const"])&&n.type===Tt.WORD&&(this._flags.declaration_statement=!0):n.newlines&&!t1(this._flags.mode)&&(this._flags.last_token.type!==Tt.OPERATOR||this._flags.last_token.text==="--"||this._flags.last_token.text==="++")&&this._flags.last_token.type!==Tt.EQUALS&&(this._options.preserve_newlines||!Cn(this._flags.last_token,["var","let","const","set","get"]))?(this.handle_whitespace_and_comments(n),this.print_newline()):this.handle_whitespace_and_comments(n),this._flags.do_block&&!this._flags.do_while)if(Rs(n,"while")){this._output.space_before_token=!0,this.print_token(n),this._output.space_before_token=!0,this._flags.do_while=!0;return}else this.print_newline(),this._flags.do_block=!1;if(this._flags.if_block)if(!this._flags.else_block&&Rs(n,"else"))this._flags.else_block=!0;else{for(;this._flags.mode===ge.Statement;)this.restore_mode();this._flags.if_block=!1,this._flags.else_block=!1}if(this._flags.in_case_statement&&Cn(n,["case","default"])){this.print_newline(),!this._flags.case_block&&(this._flags.case_body||this._options.jslint_happy)&&this.deindent(),this._flags.case_body=!1,this.print_token(n),this._flags.in_case=!0;return}if((this._flags.last_token.type===Tt.COMMA||this._flags.last_token.type===Tt.START_EXPR||this._flags.last_token.type===Tt.EQUALS||this._flags.last_token.type===Tt.OPERATOR)&&!this.start_of_object_property()&&!(Re(this._flags.last_token.text,["+","-"])&&this._last_last_text===":"&&this._flags.parent.mode===ge.ObjectLiteral)&&this.allow_wrap_or_preserved_newline(n),Rs(n,"function")){(Re(this._flags.last_token.text,["}",";"])||this._output.just_added_newline()&&!(Re(this._flags.last_token.text,["(","[","{",":","=",","])||this._flags.last_token.type===Tt.OPERATOR))&&!this._output.just_added_blankline()&&!n.comments_before&&(this.print_newline(),this.print_newline(!0)),this._flags.last_token.type===Tt.RESERVED||this._flags.last_token.type===Tt.WORD?Cn(this._flags.last_token,["get","set","new","export"])||Cn(this._flags.last_token,uN)?this._output.space_before_token=!0:Rs(this._flags.last_token,"default")&&this._last_last_text==="export"?this._output.space_before_token=!0:this._flags.last_token.text==="declare"?this._output.space_before_token=!0:this.print_newline():this._flags.last_token.type===Tt.OPERATOR||this._flags.last_token.text==="="?this._output.space_before_token=!0:!this._flags.multiline_frame&&(t1(this._flags.mode)||el(this._flags.mode))||this.print_newline(),this.print_token(n),this._flags.last_word=n.text;return}var t="NONE";if(this._flags.last_token.type===Tt.END_BLOCK?this._previous_flags.inline_frame?t="SPACE":Cn(n,["else","catch","finally","from"])?this._options.brace_style==="expand"||this._options.brace_style==="end-expand"||this._options.brace_style==="none"&&n.newlines?t="NEWLINE":(t="SPACE",this._output.space_before_token=!0):t="NEWLINE":this._flags.last_token.type===Tt.SEMICOLON&&this._flags.mode===ge.BlockStatement?t="NEWLINE":this._flags.last_token.type===Tt.SEMICOLON&&t1(this._flags.mode)?t="SPACE":this._flags.last_token.type===Tt.STRING?t="NEWLINE":this._flags.last_token.type===Tt.RESERVED||this._flags.last_token.type===Tt.WORD||this._flags.last_token.text==="*"&&(Re(this._last_last_text,["function","yield"])||this._flags.mode===ge.ObjectLiteral&&Re(this._last_last_text,["{",","]))?t="SPACE":this._flags.last_token.type===Tt.START_BLOCK?this._flags.inline_frame?t="SPACE":t="NEWLINE":this._flags.last_token.type===Tt.END_EXPR&&(this._output.space_before_token=!0,t="NEWLINE"),Cn(n,e1)&&this._flags.last_token.text!==")"&&(this._flags.inline_frame||this._flags.last_token.text==="else"||this._flags.last_token.text==="export"?t="SPACE":t="NEWLINE"),Cn(n,["else","catch","finally"]))if((!(this._flags.last_token.type===Tt.END_BLOCK&&this._previous_flags.mode===ge.BlockStatement)||this._options.brace_style==="expand"||this._options.brace_style==="end-expand"||this._options.brace_style==="none"&&n.newlines)&&!this._flags.inline_frame)this.print_newline();else{this._output.trim(!0);var i=this._output.current_line;i.last()!=="}"&&this.print_newline(),this._output.space_before_token=!0}else t==="NEWLINE"?Cn(this._flags.last_token,uw)?this._output.space_before_token=!0:this._flags.last_token.text==="declare"&&Cn(n,["var","let","const"])?this._output.space_before_token=!0:this._flags.last_token.type!==Tt.END_EXPR?(this._flags.last_token.type!==Tt.START_EXPR||!Cn(n,["var","let","const"]))&&this._flags.last_token.text!==":"&&(Rs(n,"if")&&Rs(n.previous,"else")?this._output.space_before_token=!0:this.print_newline()):Cn(n,e1)&&this._flags.last_token.text!==")"&&this.print_newline():this._flags.multiline_frame&&el(this._flags.mode)&&this._flags.last_token.text===","&&this._last_last_text==="}"?this.print_newline():t==="SPACE"&&(this._output.space_before_token=!0);n.previous&&(n.previous.type===Tt.WORD||n.previous.type===Tt.RESERVED)&&(this._output.space_before_token=!0),this.print_token(n),this._flags.last_word=n.text,n.type===Tt.RESERVED&&(n.text==="do"?this._flags.do_block=!0:n.text==="if"?this._flags.if_block=!0:n.text==="import"?this._flags.import_block=!0:this._flags.import_block&&Rs(n,"from")&&(this._flags.import_block=!1))};cn.prototype.handle_semicolon=function(n){this.start_of_statement(n)?this._output.space_before_token=!1:this.handle_whitespace_and_comments(n);for(var e=this._tokens.peek();this._flags.mode===ge.Statement&&!(this._flags.if_block&&Rs(e,"else"))&&!this._flags.do_block;)this.restore_mode();this._flags.import_block&&(this._flags.import_block=!1),this.print_token(n)};cn.prototype.handle_string=function(n){n.text.startsWith("`")&&n.newlines===0&&n.whitespace_before===""&&(n.previous.text===")"||this._flags.last_token.type===Tt.WORD)||(this.start_of_statement(n)?this._output.space_before_token=!0:(this.handle_whitespace_and_comments(n),this._flags.last_token.type===Tt.RESERVED||this._flags.last_token.type===Tt.WORD||this._flags.inline_frame?this._output.space_before_token=!0:this._flags.last_token.type===Tt.COMMA||this._flags.last_token.type===Tt.START_EXPR||this._flags.last_token.type===Tt.EQUALS||this._flags.last_token.type===Tt.OPERATOR?this.start_of_object_property()||this.allow_wrap_or_preserved_newline(n):n.text.startsWith("`")&&this._flags.last_token.type===Tt.END_EXPR&&(n.previous.text==="]"||n.previous.text===")")&&n.newlines===0?this._output.space_before_token=!0:this.print_newline())),this.print_token(n)};cn.prototype.handle_equals=function(n){this.start_of_statement(n)||this.handle_whitespace_and_comments(n),this._flags.declaration_statement&&(this._flags.declaration_assignment=!0),this._output.space_before_token=!0,this.print_token(n),this._output.space_before_token=!0};cn.prototype.handle_comma=function(n){this.handle_whitespace_and_comments(n,!0),this.print_token(n),this._output.space_before_token=!0,this._flags.declaration_statement?(t1(this._flags.parent.mode)&&(this._flags.declaration_assignment=!1),this._flags.declaration_assignment?(this._flags.declaration_assignment=!1,this.print_newline(!1,!0)):this._options.comma_first&&this.allow_wrap_or_preserved_newline(n)):this._flags.mode===ge.ObjectLiteral||this._flags.mode===ge.Statement&&this._flags.parent.mode===ge.ObjectLiteral?(this._flags.mode===ge.Statement&&this.restore_mode(),this._flags.inline_frame||this.print_newline()):this._options.comma_first&&this.allow_wrap_or_preserved_newline(n)};cn.prototype.handle_operator=function(n){var e=n.text==="*"&&(Cn(this._flags.last_token,["function","yield"])||Re(this._flags.last_token.type,[Tt.START_BLOCK,Tt.COMMA,Tt.END_BLOCK,Tt.SEMICOLON])),t=Re(n.text,["-","+"])&&(Re(this._flags.last_token.type,[Tt.START_BLOCK,Tt.START_EXPR,Tt.EQUALS,Tt.OPERATOR])||Re(this._flags.last_token.text,e1)||this._flags.last_token.text===",");if(!this.start_of_statement(n)){var i=!e;this.handle_whitespace_and_comments(n,i)}if(n.text==="*"&&this._flags.last_token.type===Tt.DOT){this.print_token(n);return}if(n.text==="::"){this.print_token(n);return}if(Re(n.text,["-","+"])&&this.start_of_object_property()){this.print_token(n);return}if(this._flags.last_token.type===Tt.OPERATOR&&Re(this._options.operator_position,JZ)&&this.allow_wrap_or_preserved_newline(n),n.text===":"&&this._flags.in_case){this.print_token(n),this._flags.in_case=!1,this._flags.case_body=!0,this._tokens.peek().type!==Tt.START_BLOCK?(this.indent(),this.print_newline(),this._flags.case_block=!1):(this._flags.case_block=!0,this._output.space_before_token=!0);return}var r=!0,s=!0,o=!1;if(n.text===":"?this._flags.ternary_depth===0?r=!1:(this._flags.ternary_depth-=1,o=!0):n.text==="?"&&(this._flags.ternary_depth+=1),!t&&!e&&this._options.preserve_newlines&&Re(n.text,Jg)){var a=n.text===":",c=a&&o,l=a&&!o;switch(this._options.operator_position){case Qg.before_newline:this._output.space_before_token=!l,this.print_token(n),(!a||c)&&this.allow_wrap_or_preserved_newline(n),this._output.space_before_token=!0;return;case Qg.after_newline:this._output.space_before_token=!0,!a||c?this._tokens.peek().newlines?this.print_newline(!1,!0):this.allow_wrap_or_preserved_newline(n):this._output.space_before_token=!1,this.print_token(n),this._output.space_before_token=!0;return;case Qg.preserve_newline:l||this.allow_wrap_or_preserved_newline(n),r=!(this._output.just_added_newline()||l),this._output.space_before_token=r,this.print_token(n),this._output.space_before_token=!0;return}}if(e){this.allow_wrap_or_preserved_newline(n),r=!1;var u=this._tokens.peek();s=u&&Re(u.type,[Tt.WORD,Tt.RESERVED])}else if(n.text==="...")this.allow_wrap_or_preserved_newline(n),r=this._flags.last_token.type===Tt.START_BLOCK,s=!1;else if(Re(n.text,["--","++","!","~"])||t){if((this._flags.last_token.type===Tt.COMMA||this._flags.last_token.type===Tt.START_EXPR)&&this.allow_wrap_or_preserved_newline(n),r=!1,s=!1,n.newlines&&(n.text==="--"||n.text==="++"||n.text==="~")){var p=Cn(this._flags.last_token,uw)&&n.newlines;p&&(this._previous_flags.if_block||this._previous_flags.else_block)&&this.restore_mode(),this.print_newline(p,!0)}this._flags.last_token.text===";"&&t1(this._flags.mode)&&(r=!0),this._flags.last_token.type===Tt.RESERVED?r=!0:this._flags.last_token.type===Tt.END_EXPR?r=!(this._flags.last_token.text==="]"&&(n.text==="--"||n.text==="++")):this._flags.last_token.type===Tt.OPERATOR&&(r=Re(n.text,["--","-","++","+"])&&Re(this._flags.last_token.text,["--","-","++","+"]),Re(n.text,["+","-"])&&Re(this._flags.last_token.text,["--","++"])&&(s=!0)),(this._flags.mode===ge.BlockStatement&&!this._flags.inline_frame||this._flags.mode===ge.Statement)&&(this._flags.last_token.text==="{"||this._flags.last_token.text===";")&&this.print_newline()}this._output.space_before_token=this._output.space_before_token||r,this.print_token(n),this._output.space_before_token=s};cn.prototype.handle_block_comment=function(n,e){if(this._output.raw){this._output.add_raw_token(n),n.directives&&n.directives.preserve==="end"&&(this._output.raw=this._options.test_output_raw);return}if(n.directives){this.print_newline(!1,e),this.print_token(n),n.directives.preserve==="start"&&(this._output.raw=!0),this.print_newline(!1,!0);return}if(!lw.newline.test(n.text)&&!n.newlines){this._output.space_before_token=!0,this.print_token(n),this._output.space_before_token=!0;return}else this.print_block_commment(n,e)};cn.prototype.print_block_commment=function(n,e){var t=CIt(n.text),i,r=!1,s=!1,o=n.whitespace_before,a=o.length;if(this.print_newline(!1,e),this.print_token_line_indentation(n),this._output.add_token(t[0]),this.print_newline(!1,e),t.length>1){for(t=t.slice(1),r=IIt(t,"*"),s=NIt(t,o),r&&(this._flags.alignment=1),i=0;i<t.length;i++)r?(this.print_token_line_indentation(n),this._output.add_token(TIt(t[i]))):s&&t[i]?(this.print_token_line_indentation(n),this._output.add_token(t[i].substring(a))):(this._output.current_line.set_indent(-1),this._output.add_token(t[i])),this.print_newline(!1,e);this._flags.alignment=0}};cn.prototype.handle_comment=function(n,e){n.newlines?this.print_newline(!1,e):this._output.trim(!0),this._output.space_before_token=!0,this.print_token(n),this.print_newline(!1,e)};cn.prototype.handle_dot=function(n){this.start_of_statement(n)||this.handle_whitespace_and_comments(n,!0),this._flags.last_token.text.match("^[0-9]+$")&&(this._output.space_before_token=!0),Cn(this._flags.last_token,uw)?this._output.space_before_token=!1:this.allow_wrap_or_preserved_newline(n,this._flags.last_token.text===")"&&this._options.break_chained_methods),this._options.unindent_chained_methods&&this._output.just_added_newline()&&this.deindent(),this.print_token(n)};cn.prototype.handle_unknown=function(n,e){this.print_token(n),n.text[n.text.length-1]===`
`&&this.print_newline(!1,e)};cn.prototype.handle_eof=function(n){for(;this._flags.mode===ge.Statement;)this.restore_mode();this.handle_whitespace_and_comments(n)};tK.exports.Beautifier=cn});var nK=ue((Uce,pN)=>{"use strict";var AIt=eK().Beautifier,RIt=eN().Options;function OIt(n,e){var t=new AIt(n,e);return t.beautify()}pN.exports=OIt;pN.exports.defaultOptions=function(){return new RIt}});var hN=ue((Vce,sK)=>{"use strict";var iK=sw().Options;function rK(n){iK.call(this,n,"css"),this.selector_separator_newline=this._get_boolean("selector_separator_newline",!0),this.newline_between_rules=this._get_boolean("newline_between_rules",!0);var e=this._get_boolean("space_around_selector_separator");this.space_around_combinator=this._get_boolean("space_around_combinator")||e;var t=this._get_selection_list("brace_style",["collapse","expand","end-expand","none","preserve-inline"]);this.brace_style="collapse";for(var i=0;i<t.length;i++)t[i]!=="expand"?this.brace_style="collapse":this.brace_style=t[i]}rK.prototype=new iK;sK.exports.Options=rK});var lK=ue((Gce,cK)=>{"use strict";var LIt=hN().Options,FIt=iw().Output,zIt=ow().InputScanner,$It=aw().Directives,oK=new $It(/\/\*/,/\*\//),aK=/\r\n|[\r\n]/,DIt=/\r\n|[\r\n]/g,pw=/\s/,jIt=/(?:\s|\n)+/g,BIt=/\/\*(?:[\s\S]*?)((?:\*\/)|$)/g,YIt=/\/\/(?:[^\n\r\u2028\u2029]*)/g;function Ra(n,e){this._source_text=n||"",this._options=new LIt(e),this._ch=null,this._input=null,this.NESTED_AT_RULE={page:!0,"font-face":!0,keyframes:!0,media:!0,supports:!0,document:!0},this.CONDITIONAL_GROUP_RULE={media:!0,supports:!0,document:!0},this.NON_SEMICOLON_NEWLINE_PROPERTY=["grid-template-areas","grid-template"]}Ra.prototype.eatString=function(n){var e="";for(this._ch=this._input.next();this._ch;){if(e+=this._ch,this._ch==="\\")e+=this._input.next();else if(n.indexOf(this._ch)!==-1||this._ch===`
`)break;this._ch=this._input.next()}return e};Ra.prototype.eatWhitespace=function(n){for(var e=pw.test(this._input.peek()),t=0;pw.test(this._input.peek());)this._ch=this._input.next(),n&&this._ch===`
`&&(t===0||t<this._options.max_preserve_newlines)&&(t++,this._output.add_new_line(!0));return e};Ra.prototype.foundNestedPseudoClass=function(){for(var n=0,e=1,t=this._input.peek(e);t;){if(t==="{")return!0;if(t==="(")n+=1;else if(t===")"){if(n===0)return!1;n-=1}else if(t===";"||t==="}")return!1;e++,t=this._input.peek(e)}return!1};Ra.prototype.print_string=function(n){this._output.set_indent(this._indentLevel),this._output.non_breaking_space=!0,this._output.add_token(n)};Ra.prototype.preserveSingleSpace=function(n){n&&(this._output.space_before_token=!0)};Ra.prototype.indent=function(){this._indentLevel++};Ra.prototype.outdent=function(){this._indentLevel>0&&this._indentLevel--};Ra.prototype.beautify=function(){if(this._options.disabled)return this._source_text;var n=this._source_text,e=this._options.eol;e==="auto"&&(e=`
`,n&&aK.test(n||"")&&(e=n.match(aK)[0])),n=n.replace(DIt,`
`);var t=n.match(/^[\t ]*/)[0];this._output=new FIt(this._options,t),this._input=new zIt(n),this._indentLevel=0,this._nestedLevel=0,this._ch=null;for(var i=0,r=!1,s=!1,o=!1,a=!1,c=!1,l=this._ch,u=!1,p,f,y;p=this._input.read(jIt),f=p!=="",y=l,this._ch=this._input.next(),this._ch==="\\"&&this._input.hasNext()&&(this._ch+=this._input.next()),l=this._ch,this._ch;)if(this._ch==="/"&&this._input.peek()==="*"){this._output.add_new_line(),this._input.back();var g=this._input.read(BIt),x=oK.get_directives(g);x&&x.ignore==="start"&&(g+=oK.readIgnored(this._input)),this.print_string(g),this.eatWhitespace(!0),this._output.add_new_line()}else if(this._ch==="/"&&this._input.peek()==="/")this._output.space_before_token=!0,this._input.back(),this.print_string(this._input.read(YIt)),this.eatWhitespace(!0);else if(this._ch==="$"){this.preserveSingleSpace(f),this.print_string(this._ch);var v=this._input.peekUntilAfter(/[: ,;{}()[\]\/='"]/g);v.match(/[ :]$/)&&(v=this.eatString(": ").replace(/\s+$/,""),this.print_string(v),this._output.space_before_token=!0),i===0&&v.indexOf(":")!==-1&&(s=!0,this.indent())}else if(this._ch==="@")if(this.preserveSingleSpace(f),this._input.peek()==="{")this.print_string(this._ch+this.eatString("}"));else{this.print_string(this._ch);var P=this._input.peekUntilAfter(/[: ,;{}()[\]\/='"]/g);P.match(/[ :]$/)&&(P=this.eatString(": ").replace(/\s+$/,""),this.print_string(P),this._output.space_before_token=!0),i===0&&P.indexOf(":")!==-1?(s=!0,this.indent()):P in this.NESTED_AT_RULE?(this._nestedLevel+=1,P in this.CONDITIONAL_GROUP_RULE&&(o=!0)):i===0&&!s&&(a=!0)}else if(this._ch==="#"&&this._input.peek()==="{")this.preserveSingleSpace(f),this.print_string(this._ch+this.eatString("}"));else if(this._ch==="{")s&&(s=!1,this.outdent()),a=!1,o?(o=!1,r=this._indentLevel>=this._nestedLevel):r=this._indentLevel>=this._nestedLevel-1,this._options.newline_between_rules&&r&&this._output.previous_line&&this._output.previous_line.item(-1)!=="{"&&this._output.ensure_empty_line_above("/",","),this._output.space_before_token=!0,this._options.brace_style==="expand"?(this._output.add_new_line(),this.print_string(this._ch),this.indent(),this._output.set_indent(this._indentLevel)):(y==="("?this._output.space_before_token=!1:y!==","&&this.indent(),this.print_string(this._ch)),this.eatWhitespace(!0),this._output.add_new_line();else if(this._ch==="}")this.outdent(),this._output.add_new_line(),y==="{"&&this._output.trim(!0),s&&(this.outdent(),s=!1),this.print_string(this._ch),r=!1,this._nestedLevel&&this._nestedLevel--,this.eatWhitespace(!0),this._output.add_new_line(),this._options.newline_between_rules&&!this._output.just_added_blankline()&&this._input.peek()!=="}"&&this._output.add_new_line(!0),this._input.peek()===")"&&(this._output.trim(!0),this._options.brace_style==="expand"&&this._output.add_new_line(!0));else if(this._ch===":"){for(var w=0;w<this.NON_SEMICOLON_NEWLINE_PROPERTY.length;w++)if(this._input.lookBack(this.NON_SEMICOLON_NEWLINE_PROPERTY[w])){u=!0;break}(r||o)&&!(this._input.lookBack("&")||this.foundNestedPseudoClass())&&!this._input.lookBack("(")&&!a&&i===0?(this.print_string(":"),s||(s=!0,this._output.space_before_token=!0,this.eatWhitespace(!0),this.indent())):(this._input.lookBack(" ")&&(this._output.space_before_token=!0),this._input.peek()===":"?(this._ch=this._input.next(),this.print_string("::")):this.print_string(":"))}else if(this._ch==='"'||this._ch==="'"){var k=y==='"'||y==="'";this.preserveSingleSpace(k||f),this.print_string(this._ch+this.eatString(this._ch)),this.eatWhitespace(!0)}else if(this._ch===";")u=!1,i===0?(s&&(this.outdent(),s=!1),a=!1,this.print_string(this._ch),this.eatWhitespace(!0),this._input.peek()!=="/"&&this._output.add_new_line()):(this.print_string(this._ch),this.eatWhitespace(!0),this._output.space_before_token=!0);else if(this._ch==="(")if(this._input.lookBack("url"))this.print_string(this._ch),this.eatWhitespace(),i++,this.indent(),this._ch=this._input.next(),this._ch===")"||this._ch==='"'||this._ch==="'"?this._input.back():this._ch&&(this.print_string(this._ch+this.eatString(")")),i&&(i--,this.outdent()));else{var T=!1;this._input.lookBack("with")&&(T=!0),this.preserveSingleSpace(f||T),this.print_string(this._ch),s&&y==="$"&&this._options.selector_separator_newline?(this._output.add_new_line(),c=!0):(this.eatWhitespace(),i++,this.indent())}else if(this._ch===")")i&&(i--,this.outdent()),c&&this._input.peek()===";"&&this._options.selector_separator_newline&&(c=!1,this.outdent(),this._output.add_new_line()),this.print_string(this._ch);else if(this._ch===",")this.print_string(this._ch),this.eatWhitespace(!0),this._options.selector_separator_newline&&(!s||c)&&i===0&&!a?this._output.add_new_line():this._output.space_before_token=!0;else if((this._ch===">"||this._ch==="+"||this._ch==="~")&&!s&&i===0)this._options.space_around_combinator?(this._output.space_before_token=!0,this.print_string(this._ch),this._output.space_before_token=!0):(this.print_string(this._ch),this.eatWhitespace(),this._ch&&pw.test(this._ch)&&(this._ch=""));else if(this._ch==="]")this.print_string(this._ch);else if(this._ch==="[")this.preserveSingleSpace(f),this.print_string(this._ch);else if(this._ch==="=")this.eatWhitespace(),this.print_string("="),pw.test(this._ch)&&(this._ch="");else if(this._ch==="!"&&!this._input.lookBack("\\"))this._output.space_before_token=!0,this.print_string(this._ch);else{var I=y==='"'||y==="'";this.preserveSingleSpace(I||f),this.print_string(this._ch),!this._output.just_added_newline()&&this._input.peek()===`
`&&u&&this._output.add_new_line()}var E=this._output.get_code(e);return E};cK.exports.Beautifier=Ra});var uK=ue((Hce,dN)=>{"use strict";var XIt=lK().Beautifier,UIt=hN().Options;function VIt(n,e){var t=new XIt(n,e);return t.beautify()}dN.exports=VIt;dN.exports.defaultOptions=function(){return new UIt}});var fN=ue((Wce,dK)=>{"use strict";var pK=sw().Options;function hK(n){pK.call(this,n,"html"),this.templating.length===1&&this.templating[0]==="auto"&&(this.templating=["django","erb","handlebars","php"]),this.indent_inner_html=this._get_boolean("indent_inner_html"),this.indent_body_inner_html=this._get_boolean("indent_body_inner_html",!0),this.indent_head_inner_html=this._get_boolean("indent_head_inner_html",!0),this.indent_handlebars=this._get_boolean("indent_handlebars",!0),this.wrap_attributes=this._get_selection("wrap_attributes",["auto","force","force-aligned","force-expand-multiline","aligned-multiple","preserve","preserve-aligned"]),this.wrap_attributes_min_attrs=this._get_number("wrap_attributes_min_attrs",2),this.wrap_attributes_indent_size=this._get_number("wrap_attributes_indent_size",this.indent_size),this.extra_liners=this._get_array("extra_liners",["head","body","/html"]),this.inline=this._get_array("inline",["a","abbr","area","audio","b","bdi","bdo","br","button","canvas","cite","code","data","datalist","del","dfn","em","embed","i","iframe","img","input","ins","kbd","keygen","label","map","mark","math","meter","noscript","object","output","progress","q","ruby","s","samp","select","small","span","strong","sub","sup","svg","template","textarea","time","u","var","video","wbr","text","acronym","big","strike","tt"]),this.inline_custom_elements=this._get_boolean("inline_custom_elements",!0),this.void_elements=this._get_array("void_elements",["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr","!doctype","?xml","basefont","isindex"]),this.unformatted=this._get_array("unformatted",[]),this.content_unformatted=this._get_array("content_unformatted",["pre","textarea"]),this.unformatted_content_delimiter=this._get_characters("unformatted_content_delimiter"),this.indent_scripts=this._get_selection("indent_scripts",["normal","keep","separate"])}hK.prototype=new pK;dK.exports.Options=hK});var yN=ue((qce,_N)=>{"use strict";var mK=qg().Tokenizer,mN=qg().TOKEN,GIt=aw().Directives,HIt=aN().TemplatablePattern,WIt=Hg().Pattern,ln={TAG_OPEN:"TK_TAG_OPEN",TAG_CLOSE:"TK_TAG_CLOSE",CONTROL_FLOW_OPEN:"TK_CONTROL_FLOW_OPEN",CONTROL_FLOW_CLOSE:"TK_CONTROL_FLOW_CLOSE",ATTRIBUTE:"TK_ATTRIBUTE",EQUALS:"TK_EQUALS",VALUE:"TK_VALUE",COMMENT:"TK_COMMENT",TEXT:"TK_TEXT",UNKNOWN:"TK_UNKNOWN",START:mN.START,RAW:mN.RAW,EOF:mN.EOF},fK=new GIt(/<\!--/,/-->/),Yi=function(n,e){mK.call(this,n,e),this._current_tag_name="";var t=new HIt(this._input).read_options(this._options),i=new WIt(this._input);if(this.__patterns={word:t.until(/[\n\r\t <]/),word_control_flow_close_excluded:t.until(/[\n\r\t <}]/),single_quote:t.until_after(/'/),double_quote:t.until_after(/"/),attribute:t.until(/[\n\r\t =>]|\/>/),element_name:t.until(/[\n\r\t >\/]/),angular_control_flow_start:i.matching(/\@[a-zA-Z]+[^({]*[({]/),handlebars_comment:i.starting_with(/{{!--/).until_after(/--}}/),handlebars:i.starting_with(/{{/).until_after(/}}/),handlebars_open:i.until(/[\n\r\t }]/),handlebars_raw_close:i.until(/}}/),comment:i.starting_with(/<!--/).until_after(/-->/),cdata:i.starting_with(/<!\[CDATA\[/).until_after(/]]>/),conditional_comment:i.starting_with(/<!\[/).until_after(/]>/),processing:i.starting_with(/<\?/).until_after(/\?>/)},this._options.indent_handlebars&&(this.__patterns.word=this.__patterns.word.exclude("handlebars"),this.__patterns.word_control_flow_close_excluded=this.__patterns.word_control_flow_close_excluded.exclude("handlebars")),this._unformatted_content_delimiter=null,this._options.unformatted_content_delimiter){var r=this._input.get_literal_regexp(this._options.unformatted_content_delimiter);this.__patterns.unformatted_content_delimiter=i.matching(r).until_after(r)}};Yi.prototype=new mK;Yi.prototype._is_comment=function(n){return!1};Yi.prototype._is_opening=function(n){return n.type===ln.TAG_OPEN||n.type===ln.CONTROL_FLOW_OPEN};Yi.prototype._is_closing=function(n,e){return n.type===ln.TAG_CLOSE&&e&&((n.text===">"||n.text==="/>")&&e.text[0]==="<"||n.text==="}}"&&e.text[0]==="{"&&e.text[1]==="{")||n.type===ln.CONTROL_FLOW_CLOSE&&n.text==="}"&&e.text.endsWith("{")};Yi.prototype._reset=function(){this._current_tag_name=""};Yi.prototype._get_next_token=function(n,e){var t=null;this._readWhitespace();var i=this._input.peek();return i===null?this._create_token(ln.EOF,""):(t=t||this._read_open_handlebars(i,e),t=t||this._read_attribute(i,n,e),t=t||this._read_close(i,e),t=t||this._read_script_and_style(i,n),t=t||this._read_control_flows(i,e),t=t||this._read_raw_content(i,n,e),t=t||this._read_content_word(i,e),t=t||this._read_comment_or_cdata(i),t=t||this._read_processing(i),t=t||this._read_open(i,e),t=t||this._create_token(ln.UNKNOWN,this._input.next()),t)};Yi.prototype._read_comment_or_cdata=function(n){var e=null,t=null,i=null;if(n==="<"){var r=this._input.peek(1);r==="!"&&(t=this.__patterns.comment.read(),t?(i=fK.get_directives(t),i&&i.ignore==="start"&&(t+=fK.readIgnored(this._input))):t=this.__patterns.cdata.read()),t&&(e=this._create_token(ln.COMMENT,t),e.directives=i)}return e};Yi.prototype._read_processing=function(n){var e=null,t=null,i=null;if(n==="<"){var r=this._input.peek(1);(r==="!"||r==="?")&&(t=this.__patterns.conditional_comment.read(),t=t||this.__patterns.processing.read()),t&&(e=this._create_token(ln.COMMENT,t),e.directives=i)}return e};Yi.prototype._read_open=function(n,e){var t=null,i=null;return(!e||e.type===ln.CONTROL_FLOW_OPEN)&&n==="<"&&(t=this._input.next(),this._input.peek()==="/"&&(t+=this._input.next()),t+=this.__patterns.element_name.read(),i=this._create_token(ln.TAG_OPEN,t)),i};Yi.prototype._read_open_handlebars=function(n,e){var t=null,i=null;return(!e||e.type===ln.CONTROL_FLOW_OPEN)&&(this._options.templating.includes("angular")||this._options.indent_handlebars)&&n==="{"&&this._input.peek(1)==="{"&&(this._options.indent_handlebars&&this._input.peek(2)==="!"?(t=this.__patterns.handlebars_comment.read(),t=t||this.__patterns.handlebars.read(),i=this._create_token(ln.COMMENT,t)):(t=this.__patterns.handlebars_open.read(),i=this._create_token(ln.TAG_OPEN,t))),i};Yi.prototype._read_control_flows=function(n,e){var t="",i=null;if(!this._options.templating.includes("angular"))return i;if(n==="@"){if(t=this.__patterns.angular_control_flow_start.read(),t==="")return i;for(var r=t.endsWith("(")?1:0,s=0;!(t.endsWith("{")&&r===s);){var o=this._input.next();if(o===null)break;o==="("?r++:o===")"&&s++,t+=o}i=this._create_token(ln.CONTROL_FLOW_OPEN,t)}else n==="}"&&e&&e.type===ln.CONTROL_FLOW_OPEN&&(t=this._input.next(),i=this._create_token(ln.CONTROL_FLOW_CLOSE,t));return i};Yi.prototype._read_close=function(n,e){var t=null,i=null;return e&&e.type===ln.TAG_OPEN&&(e.text[0]==="<"&&(n===">"||n==="/"&&this._input.peek(1)===">")?(t=this._input.next(),n==="/"&&(t+=this._input.next()),i=this._create_token(ln.TAG_CLOSE,t)):e.text[0]==="{"&&n==="}"&&this._input.peek(1)==="}"&&(this._input.next(),this._input.next(),i=this._create_token(ln.TAG_CLOSE,"}}"))),i};Yi.prototype._read_attribute=function(n,e,t){var i=null,r="";if(t&&t.text[0]==="<")if(n==="=")i=this._create_token(ln.EQUALS,this._input.next());else if(n==='"'||n==="'"){var s=this._input.next();n==='"'?s+=this.__patterns.double_quote.read():s+=this.__patterns.single_quote.read(),i=this._create_token(ln.VALUE,s)}else r=this.__patterns.attribute.read(),r&&(e.type===ln.EQUALS?i=this._create_token(ln.VALUE,r):i=this._create_token(ln.ATTRIBUTE,r));return i};Yi.prototype._is_content_unformatted=function(n){return this._options.void_elements.indexOf(n)===-1&&(this._options.content_unformatted.indexOf(n)!==-1||this._options.unformatted.indexOf(n)!==-1)};Yi.prototype._read_raw_content=function(n,e,t){var i="";if(t&&t.text[0]==="{")i=this.__patterns.handlebars_raw_close.read();else if(e.type===ln.TAG_CLOSE&&e.opened.text[0]==="<"&&e.text[0]!=="/"){var r=e.opened.text.substr(1).toLowerCase();this._is_content_unformatted(r)&&(i=this._input.readUntil(new RegExp("</"+r+"[\\n\\r\\t ]*?>","ig")))}return i?this._create_token(ln.TEXT,i):null};Yi.prototype._read_script_and_style=function(n,e){if(e.type===ln.TAG_CLOSE&&e.opened.text[0]==="<"&&e.text[0]!=="/"){var t=e.opened.text.substr(1).toLowerCase();if(t==="script"||t==="style"){var i=this._read_comment_or_cdata(n);if(i)return i.type=ln.TEXT,i;var r=this._input.readUntil(new RegExp("</"+t+"[\\n\\r\\t ]*?>","ig"));if(r)return this._create_token(ln.TEXT,r)}}return null};Yi.prototype._read_content_word=function(n,e){var t="";return this._options.unformatted_content_delimiter&&n===this._options.unformatted_content_delimiter[0]&&(t=this.__patterns.unformatted_content_delimiter.read()),t||(t=e&&e.type===ln.CONTROL_FLOW_OPEN?this.__patterns.word_control_flow_close_excluded.read():this.__patterns.word.read()),t?this._create_token(ln.TEXT,t):null};_N.exports.Tokenizer=Yi;_N.exports.TOKEN=ln});var xK=ue((Zce,gK)=>{"use strict";var qIt=fN().Options,ZIt=iw().Output,KIt=yN().Tokenizer,_n=yN().TOKEN,_K=/\r\n|[\r\n]/,JIt=/\r\n|[\r\n]/g,cs=function(n,e){this.indent_level=0,this.alignment_size=0,this.max_preserve_newlines=n.max_preserve_newlines,this.preserve_newlines=n.preserve_newlines,this._output=new ZIt(n,e)};cs.prototype.current_line_has_match=function(n){return this._output.current_line.has_match(n)};cs.prototype.set_space_before_token=function(n,e){this._output.space_before_token=n,this._output.non_breaking_space=e};cs.prototype.set_wrap_point=function(){this._output.set_indent(this.indent_level,this.alignment_size),this._output.set_wrap_point()};cs.prototype.add_raw_token=function(n){this._output.add_raw_token(n)};cs.prototype.print_preserved_newlines=function(n){var e=0;n.type!==_n.TEXT&&n.previous.type!==_n.TEXT&&(e=n.newlines?1:0),this.preserve_newlines&&(e=n.newlines<this.max_preserve_newlines+1?n.newlines:this.max_preserve_newlines+1);for(var t=0;t<e;t++)this.print_newline(t>0);return e!==0};cs.prototype.traverse_whitespace=function(n){return n.whitespace_before||n.newlines?(this.print_preserved_newlines(n)||(this._output.space_before_token=!0),!0):!1};cs.prototype.previous_token_wrapped=function(){return this._output.previous_token_wrapped};cs.prototype.print_newline=function(n){this._output.add_new_line(n)};cs.prototype.print_token=function(n){n.text&&(this._output.set_indent(this.indent_level,this.alignment_size),this._output.add_token(n.text))};cs.prototype.indent=function(){this.indent_level++};cs.prototype.deindent=function(){this.indent_level>0&&(this.indent_level--,this._output.set_indent(this.indent_level,this.alignment_size))};cs.prototype.get_full_indent=function(n){return n=this.indent_level+(n||0),n<1?"":this._output.get_indent_string(n)};var QIt=function(n){for(var e=null,t=n.next;t.type!==_n.EOF&&n.closed!==t;){if(t.type===_n.ATTRIBUTE&&t.text==="type"){t.next&&t.next.type===_n.EQUALS&&t.next.next&&t.next.next.type===_n.VALUE&&(e=t.next.next.text);break}t=t.next}return e},t5t=function(n,e){var t=null,i=null;return e.closed?(n==="script"?t="text/javascript":n==="style"&&(t="text/css"),t=QIt(e)||t,t.search("text/css")>-1?i="css":t.search(/module|((text|application|dojo)\/(x-)?(javascript|ecmascript|jscript|livescript|(ld\+)?json|method|aspect))/)>-1?i="javascript":t.search(/(text|application|dojo)\/(x-)?(html)/)>-1?i="html":t.search(/test\/null/)>-1&&(i="null"),i):null};function n1(n,e){return e.indexOf(n)!==-1}function e5t(n,e,t){this.parent=n||null,this.tag=e?e.tag_name:"",this.indent_level=t||0,this.parser_token=e||null}function fd(n){this._printer=n,this._current_frame=null}fd.prototype.get_parser_token=function(){return this._current_frame?this._current_frame.parser_token:null};fd.prototype.record_tag=function(n){var e=new e5t(this._current_frame,n,this._printer.indent_level);this._current_frame=e};fd.prototype._try_pop_frame=function(n){var e=null;return n&&(e=n.parser_token,this._printer.indent_level=n.indent_level,this._current_frame=n.parent),e};fd.prototype._get_frame=function(n,e){for(var t=this._current_frame;t&&n.indexOf(t.tag)===-1;){if(e&&e.indexOf(t.tag)!==-1){t=null;break}t=t.parent}return t};fd.prototype.try_pop=function(n,e){var t=this._get_frame([n],e);return this._try_pop_frame(t)};fd.prototype.indent_to_tag=function(n){var e=this._get_frame(n);e&&(this._printer.indent_level=e.indent_level)};function Xr(n,e,t,i){this._source_text=n||"",e=e||{},this._js_beautify=t,this._css_beautify=i,this._tag_stack=null;var r=new qIt(e,"html");this._options=r,this._is_wrap_attributes_force=this._options.wrap_attributes.substr(0,5)==="force",this._is_wrap_attributes_force_expand_multiline=this._options.wrap_attributes==="force-expand-multiline",this._is_wrap_attributes_force_aligned=this._options.wrap_attributes==="force-aligned",this._is_wrap_attributes_aligned_multiple=this._options.wrap_attributes==="aligned-multiple",this._is_wrap_attributes_preserve=this._options.wrap_attributes.substr(0,8)==="preserve",this._is_wrap_attributes_preserve_aligned=this._options.wrap_attributes==="preserve-aligned"}Xr.prototype.beautify=function(){if(this._options.disabled)return this._source_text;var n=this._source_text,e=this._options.eol;this._options.eol==="auto"&&(e=`
`,n&&_K.test(n)&&(e=n.match(_K)[0])),n=n.replace(JIt,`
`);var t=n.match(/^[\t ]*/)[0],i={text:"",type:""},r=new yK(this._options),s=new cs(this._options,t),o=new KIt(n,this._options).tokenize();this._tag_stack=new fd(s);for(var a=null,c=o.next();c.type!==_n.EOF;)c.type===_n.TAG_OPEN||c.type===_n.COMMENT?(a=this._handle_tag_open(s,c,r,i,o),r=a):c.type===_n.ATTRIBUTE||c.type===_n.EQUALS||c.type===_n.VALUE||c.type===_n.TEXT&&!r.tag_complete?a=this._handle_inside_tag(s,c,r,i):c.type===_n.TAG_CLOSE?a=this._handle_tag_close(s,c,r):c.type===_n.TEXT?a=this._handle_text(s,c,r):c.type===_n.CONTROL_FLOW_OPEN?a=this._handle_control_flow_open(s,c):c.type===_n.CONTROL_FLOW_CLOSE?a=this._handle_control_flow_close(s,c):s.add_raw_token(c),i=a,c=o.next();var l=s._output.get_code(e);return l};Xr.prototype._handle_control_flow_open=function(n,e){var t={text:e.text,type:e.type};return n.set_space_before_token(e.newlines||e.whitespace_before!=="",!0),e.newlines?n.print_preserved_newlines(e):n.set_space_before_token(e.newlines||e.whitespace_before!=="",!0),n.print_token(e),n.indent(),t};Xr.prototype._handle_control_flow_close=function(n,e){var t={text:e.text,type:e.type};return n.deindent(),e.newlines?n.print_preserved_newlines(e):n.set_space_before_token(e.newlines||e.whitespace_before!=="",!0),n.print_token(e),t};Xr.prototype._handle_tag_close=function(n,e,t){var i={text:e.text,type:e.type};return n.alignment_size=0,t.tag_complete=!0,n.set_space_before_token(e.newlines||e.whitespace_before!=="",!0),t.is_unformatted?n.add_raw_token(e):(t.tag_start_char==="<"&&(n.set_space_before_token(e.text[0]==="/",!0),this._is_wrap_attributes_force_expand_multiline&&t.has_wrapped_attrs&&n.print_newline(!1)),n.print_token(e)),t.indent_content&&!(t.is_unformatted||t.is_content_unformatted)&&(n.indent(),t.indent_content=!1),!t.is_inline_element&&!(t.is_unformatted||t.is_content_unformatted)&&n.set_wrap_point(),i};Xr.prototype._handle_inside_tag=function(n,e,t,i){var r=t.has_wrapped_attrs,s={text:e.text,type:e.type};return n.set_space_before_token(e.newlines||e.whitespace_before!=="",!0),t.is_unformatted?n.add_raw_token(e):t.tag_start_char==="{"&&e.type===_n.TEXT?n.print_preserved_newlines(e)?(e.newlines=0,n.add_raw_token(e)):n.print_token(e):(e.type===_n.ATTRIBUTE?n.set_space_before_token(!0):(e.type===_n.EQUALS||e.type===_n.VALUE&&e.previous.type===_n.EQUALS)&&n.set_space_before_token(!1),e.type===_n.ATTRIBUTE&&t.tag_start_char==="<"&&((this._is_wrap_attributes_preserve||this._is_wrap_attributes_preserve_aligned)&&(n.traverse_whitespace(e),r=r||e.newlines!==0),this._is_wrap_attributes_force&&t.attr_count>=this._options.wrap_attributes_min_attrs&&(i.type!==_n.TAG_OPEN||this._is_wrap_attributes_force_expand_multiline)&&(n.print_newline(!1),r=!0)),n.print_token(e),r=r||n.previous_token_wrapped(),t.has_wrapped_attrs=r),s};Xr.prototype._handle_text=function(n,e,t){var i={text:e.text,type:"TK_CONTENT"};return t.custom_beautifier_name?this._print_custom_beatifier_text(n,e,t):t.is_unformatted||t.is_content_unformatted?n.add_raw_token(e):(n.traverse_whitespace(e),n.print_token(e)),i};Xr.prototype._print_custom_beatifier_text=function(n,e,t){var i=this;if(e.text!==""){var r=e.text,s,o=1,a="",c="";t.custom_beautifier_name==="javascript"&&typeof this._js_beautify=="function"?s=this._js_beautify:t.custom_beautifier_name==="css"&&typeof this._css_beautify=="function"?s=this._css_beautify:t.custom_beautifier_name==="html"&&(s=function(g,x){var v=new Xr(g,x,i._js_beautify,i._css_beautify);return v.beautify()}),this._options.indent_scripts==="keep"?o=0:this._options.indent_scripts==="separate"&&(o=-n.indent_level);var l=n.get_full_indent(o);if(r=r.replace(/\n[ \t]*$/,""),t.custom_beautifier_name!=="html"&&r[0]==="<"&&r.match(/^(<!--|<!\[CDATA\[)/)){var u=/^(<!--[^\n]*|<!\[CDATA\[)(\n?)([ \t\n]*)([\s\S]*)(-->|]]>)$/.exec(r);if(!u){n.add_raw_token(e);return}a=l+u[1]+`
`,r=u[4],u[5]&&(c=l+u[5]),r=r.replace(/\n[ \t]*$/,""),(u[2]||u[3].indexOf(`
`)!==-1)&&(u=u[3].match(/[ \t]+$/),u&&(e.whitespace_before=u[0]))}if(r)if(s){var p=function(){this.eol=`
`};p.prototype=this._options.raw_options;var f=new p;r=s(l+r,f)}else{var y=e.whitespace_before;y&&(r=r.replace(new RegExp(`
(`+y+")?","g"),`
`)),r=l+r.replace(/\n/g,`
`+l)}a&&(r?r=a+r+`
`+c:r=a+c),n.print_newline(!1),r&&(e.text=r,e.whitespace_before="",e.newlines=0,n.add_raw_token(e),n.print_newline(!0))}};Xr.prototype._handle_tag_open=function(n,e,t,i,r){var s=this._get_tag_open_token(e);if((t.is_unformatted||t.is_content_unformatted)&&!t.is_empty_element&&e.type===_n.TAG_OPEN&&!s.is_start_tag?(n.add_raw_token(e),s.start_tag_token=this._tag_stack.try_pop(s.tag_name)):(n.traverse_whitespace(e),this._set_tag_position(n,e,s,t,i),s.is_inline_element||n.set_wrap_point(),n.print_token(e)),s.is_start_tag&&this._is_wrap_attributes_force){var o=0,a;do a=r.peek(o),a.type===_n.ATTRIBUTE&&(s.attr_count+=1),o+=1;while(a.type!==_n.EOF&&a.type!==_n.TAG_CLOSE)}return(this._is_wrap_attributes_force_aligned||this._is_wrap_attributes_aligned_multiple||this._is_wrap_attributes_preserve_aligned)&&(s.alignment_size=e.text.length+1),!s.tag_complete&&!s.is_unformatted&&(n.alignment_size=s.alignment_size),s};var yK=function(n,e,t){if(this.parent=e||null,this.text="",this.type="TK_TAG_OPEN",this.tag_name="",this.is_inline_element=!1,this.is_unformatted=!1,this.is_content_unformatted=!1,this.is_empty_element=!1,this.is_start_tag=!1,this.is_end_tag=!1,this.indent_content=!1,this.multiline_content=!1,this.custom_beautifier_name=null,this.start_tag_token=null,this.attr_count=0,this.has_wrapped_attrs=!1,this.alignment_size=0,this.tag_complete=!1,this.tag_start_char="",this.tag_check="",!t)this.tag_complete=!0;else{var i;this.tag_start_char=t.text[0],this.text=t.text,this.tag_start_char==="<"?(i=t.text.match(/^<([^\s>]*)/),this.tag_check=i?i[1]:""):(i=t.text.match(/^{{~?(?:[\^]|#\*?)?([^\s}]+)/),this.tag_check=i?i[1]:"",(t.text.startsWith("{{#>")||t.text.startsWith("{{~#>"))&&this.tag_check[0]===">"&&(this.tag_check===">"&&t.next!==null?this.tag_check=t.next.text.split(" ")[0]:this.tag_check=t.text.split(">")[1])),this.tag_check=this.tag_check.toLowerCase(),t.type===_n.COMMENT&&(this.tag_complete=!0),this.is_start_tag=this.tag_check.charAt(0)!=="/",this.tag_name=this.is_start_tag?this.tag_check:this.tag_check.substr(1),this.is_end_tag=!this.is_start_tag||t.closed&&t.closed.text==="/>";var r=2;this.tag_start_char==="{"&&this.text.length>=3&&this.text.charAt(2)==="~"&&(r=3),this.is_end_tag=this.is_end_tag||this.tag_start_char==="{"&&(!n.indent_handlebars||this.text.length<3||/[^#\^]/.test(this.text.charAt(r)))}};Xr.prototype._get_tag_open_token=function(n){var e=new yK(this._options,this._tag_stack.get_parser_token(),n);return e.alignment_size=this._options.wrap_attributes_indent_size,e.is_end_tag=e.is_end_tag||n1(e.tag_check,this._options.void_elements),e.is_empty_element=e.tag_complete||e.is_start_tag&&e.is_end_tag,e.is_unformatted=!e.tag_complete&&n1(e.tag_check,this._options.unformatted),e.is_content_unformatted=!e.is_empty_element&&n1(e.tag_check,this._options.content_unformatted),e.is_inline_element=n1(e.tag_name,this._options.inline)||this._options.inline_custom_elements&&e.tag_name.includes("-")||e.tag_start_char==="{",e};Xr.prototype._set_tag_position=function(n,e,t,i,r){if(t.is_empty_element||(t.is_end_tag?t.start_tag_token=this._tag_stack.try_pop(t.tag_name):(this._do_optional_end_element(t)&&(t.is_inline_element||n.print_newline(!1)),this._tag_stack.record_tag(t),(t.tag_name==="script"||t.tag_name==="style")&&!(t.is_unformatted||t.is_content_unformatted)&&(t.custom_beautifier_name=t5t(t.tag_check,e)))),n1(t.tag_check,this._options.extra_liners)&&(n.print_newline(!1),n._output.just_added_blankline()||n.print_newline(!0)),t.is_empty_element){if(t.tag_start_char==="{"&&t.tag_check==="else"){this._tag_stack.indent_to_tag(["if","unless","each"]),t.indent_content=!0;var s=n.current_line_has_match(/{{#if/);s||n.print_newline(!1)}t.tag_name==="!--"&&r.type===_n.TAG_CLOSE&&i.is_end_tag&&t.text.indexOf(`
`)===-1||(t.is_inline_element||t.is_unformatted||n.print_newline(!1),this._calcluate_parent_multiline(n,t))}else if(t.is_end_tag){var o=!1;o=t.start_tag_token&&t.start_tag_token.multiline_content,o=o||!t.is_inline_element&&!(i.is_inline_element||i.is_unformatted)&&!(r.type===_n.TAG_CLOSE&&t.start_tag_token===i)&&r.type!=="TK_CONTENT",(t.is_content_unformatted||t.is_unformatted)&&(o=!1),o&&n.print_newline(!1)}else t.indent_content=!t.custom_beautifier_name,t.tag_start_char==="<"&&(t.tag_name==="html"?t.indent_content=this._options.indent_inner_html:t.tag_name==="head"?t.indent_content=this._options.indent_head_inner_html:t.tag_name==="body"&&(t.indent_content=this._options.indent_body_inner_html)),!(t.is_inline_element||t.is_unformatted)&&(r.type!=="TK_CONTENT"||t.is_content_unformatted)&&n.print_newline(!1),this._calcluate_parent_multiline(n,t)};Xr.prototype._calcluate_parent_multiline=function(n,e){e.parent&&n._output.just_added_newline()&&!((e.is_inline_element||e.is_unformatted)&&e.parent.is_inline_element)&&(e.parent.multiline_content=!0)};var n5t=["address","article","aside","blockquote","details","div","dl","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hr","main","menu","nav","ol","p","pre","section","table","ul"],i5t=["a","audio","del","ins","map","noscript","video"];Xr.prototype._do_optional_end_element=function(n){var e=null;if(!(n.is_empty_element||!n.is_start_tag||!n.parent)){if(n.tag_name==="body")e=e||this._tag_stack.try_pop("head");else if(n.tag_name==="li")e=e||this._tag_stack.try_pop("li",["ol","ul","menu"]);else if(n.tag_name==="dd"||n.tag_name==="dt")e=e||this._tag_stack.try_pop("dt",["dl"]),e=e||this._tag_stack.try_pop("dd",["dl"]);else if(n.parent.tag_name==="p"&&n5t.indexOf(n.tag_name)!==-1){var t=n.parent.parent;(!t||i5t.indexOf(t.tag_name)===-1)&&(e=e||this._tag_stack.try_pop("p"))}else n.tag_name==="rp"||n.tag_name==="rt"?(e=e||this._tag_stack.try_pop("rt",["ruby","rtc"]),e=e||this._tag_stack.try_pop("rp",["ruby","rtc"])):n.tag_name==="optgroup"?e=e||this._tag_stack.try_pop("optgroup",["select"]):n.tag_name==="option"?e=e||this._tag_stack.try_pop("option",["select","datalist","optgroup"]):n.tag_name==="colgroup"?e=e||this._tag_stack.try_pop("caption",["table"]):n.tag_name==="thead"?(e=e||this._tag_stack.try_pop("caption",["table"]),e=e||this._tag_stack.try_pop("colgroup",["table"])):n.tag_name==="tbody"||n.tag_name==="tfoot"?(e=e||this._tag_stack.try_pop("caption",["table"]),e=e||this._tag_stack.try_pop("colgroup",["table"]),e=e||this._tag_stack.try_pop("thead",["table"]),e=e||this._tag_stack.try_pop("tbody",["table"])):n.tag_name==="tr"?(e=e||this._tag_stack.try_pop("caption",["table"]),e=e||this._tag_stack.try_pop("colgroup",["table"]),e=e||this._tag_stack.try_pop("tr",["table","thead","tbody","tfoot"])):(n.tag_name==="th"||n.tag_name==="td")&&(e=e||this._tag_stack.try_pop("td",["table","thead","tbody","tfoot","tr"]),e=e||this._tag_stack.try_pop("th",["table","thead","tbody","tfoot","tr"]));return n.parent=this._tag_stack.get_parser_token(),e}};gK.exports.Beautifier=Xr});var bK=ue((Kce,gN)=>{"use strict";var r5t=xK().Beautifier,s5t=fN().Options;function o5t(n,e,t,i){var r=new r5t(n,e,t,i);return r.beautify()}gN.exports=o5t;gN.exports.defaultOptions=function(){return new s5t}});var kK=ue((Jce,hw)=>{"use strict";var vK=nK(),SK=uK(),wK=bK();function PK(n,e,t,i){return t=t||vK,i=i||SK,wK(n,e,t,i)}PK.defaultOptions=wK.defaultOptions;hw.exports.js=vK;hw.exports.css=SK;hw.exports.html=PK});var MK=ue((Qce,EK)=>{"use strict";function TK(n,e,t){var i=function(r,s){return n.js_beautify(r,s)};return i.js=n.js_beautify,i.css=e.css_beautify,i.html=t.html_beautify,i.js_beautify=n.js_beautify,i.css_beautify=e.css_beautify,i.html_beautify=t.html_beautify,i}typeof define=="function"&&define.amd?define(["./lib/beautify","./lib/beautify-css","./lib/beautify-html"],function(n,e,t){return TK(n,e,t)}):(function(n){var e=kK();e.js_beautify=e.js,e.css_beautify=e.css,e.html_beautify=e.html,n.exports=TK(e,e,e)})(EK)});var NK=ue((tle,IK)=>{"use strict";var CK;IK.exports=function(e){return typeof e=="string"&&a5t().test(e)};function a5t(){return CK||(CK=new RegExp(`^[\\s	
\v\f\r \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF"]+$`))}});var RK=ue((ele,AK)=>{"use strict";AK.exports=function(e){return typeof e<"u"&&e!==null&&(typeof e=="object"||typeof e=="function")}});var xN=ue((nle,LK)=>{"use strict";var OK=RK();LK.exports=function(e){OK(e)||(e={});for(var t=arguments.length,i=1;i<t;i++){var r=arguments[i];OK(r)&&c5t(e,r)}return e};function c5t(n,e){for(var t in e)l5t(e,t)&&(n[t]=e[t])}function l5t(n,e){return Object.prototype.hasOwnProperty.call(n,e)}});var $K=ue((ile,zK)=>{"use strict";zK.exports=function(n){return n!=null&&(FK(n)||u5t(n)||!!n._isBuffer)};function FK(n){return!!n.constructor&&typeof n.constructor.isBuffer=="function"&&n.constructor.isBuffer(n)}function u5t(n){return typeof n.readFloatLE=="function"&&typeof n.slice=="function"&&FK(n.slice(0,0))}});var jK=ue((rle,DK)=>{"use strict";var p5t=$K(),h5t=Object.prototype.toString;DK.exports=function(e){if(typeof e>"u")return"undefined";if(e===null)return"null";if(e===!0||e===!1||e instanceof Boolean)return"boolean";if(typeof e=="string"||e instanceof String)return"string";if(typeof e=="number"||e instanceof Number)return"number";if(typeof e=="function"||e instanceof Function)return"function";if(typeof Array.isArray<"u"&&Array.isArray(e))return"array";if(e instanceof RegExp)return"regexp";if(e instanceof Date)return"date";var t=h5t.call(e);return t==="[object RegExp]"?"regexp":t==="[object Date]"?"date":t==="[object Arguments]"?"arguments":t==="[object Error]"?"error":p5t(e)?"buffer":t==="[object Set]"?"set":t==="[object WeakSet]"?"weakset":t==="[object Map]"?"map":t==="[object WeakMap]"?"weakmap":t==="[object Symbol]"?"symbol":t==="[object Int8Array]"?"int8array":t==="[object Uint8Array]"?"uint8array":t==="[object Uint8ClampedArray]"?"uint8clampedarray":t==="[object Int16Array]"?"int16array":t==="[object Uint16Array]"?"uint16array":t==="[object Int32Array]"?"int32array":t==="[object Uint32Array]"?"uint32array":t==="[object Float32Array]"?"float32array":t==="[object Float64Array]"?"float64array":"object"}});var YK=ue((sle,BK)=>{"use strict";var d5t=NK(),f5t=xN(),m5t=jK();BK.exports=function(n,e){var t=f5t({},e),i=t.sep||`

`,r=t.min,s;return typeof r=="number"&&r!==2&&(s=new RegExp("(\\r\\n|\\n|\\u2424) {"+r+",}")),typeof s>"u"&&(s=t.regex||/(\r\n|\n|\u2424){2,}/g),t.keepWhitespace!==!0&&(n=n.split(`
`).map(function(o){return d5t(o)?o.trim():o}).join(`
`)),n=_5t(n,t),n.replace(s,i)};function _5t(n,e){var t=e.trailingNewline;if(t===!1)return n;switch(m5t(t)){case"string":n=n.replace(/\s+$/,e.trailingNewline);break;case"function":n=e.trailingNewline(n);break;case"undefined":case"boolean":default:{n=n.replace(/\s+$/,`
`);break}}return n}});var UK=ue((ole,XK)=>{"use strict";var y5t=MK(),g5t=YK(),x5t=xN(),b5t={unformatted:["code","pre","em","strong","span"],indent_inner_html:!0,indent_char:" ",indent_size:2,sep:`
`};XK.exports=function(e,t){var i=x5t({},b5t,t);return e=y5t.html(e,i),i.ocd===!0?(i.newlines&&(i.sep=i.newlines),v5t(e,i)):e};function v5t(n,e){return g5t(n,e).replace(/^\s+/g,"").replace(/\s+$/g,`
`).replace(/(\s*<!--)/g,`
$1`).replace(/>(\s*)(?=<!--\s*\/)/g,"> ")}});var JQ=ue(Lw=>{"use strict";var H9t=Symbol.for("react.transitional.element"),W9t=Symbol.for("react.fragment");function KQ(n,e,t){var i=null;if(t!==void 0&&(i=""+t),e.key!==void 0&&(i=""+e.key),"key"in e){t={};for(var r in e)r!=="key"&&(t[r]=e[r])}else t=e;return e=t.ref,{$$typeof:H9t,type:n,key:i,ref:e!==void 0?e:null,props:t}}Lw.Fragment=W9t;Lw.jsx=KQ;Lw.jsxs=KQ});var kd=ue((fhe,QQ)=>{"use strict";QQ.exports=JQ()});function st(n,e){return Array.isArray(e)?[n.a*e[0]+n.c*e[1]+n.e,n.b*e[0]+n.d*e[1]+n.f]:{x:n.a*e.x+n.c*e.y+n.e,y:n.b*e.x+n.d*e.y+n.f}}var CA=qt(()=>{"use strict"});var IA=qt(()=>{"use strict"});var ttt=qt(()=>{"use strict"});var ett=qt(()=>{"use strict"});function ntt(n){let{a:e,b:t,c:i,d:r,e:s,f:o}=n,a=e*r-t*i;return{a:r/a,b:t/-a,c:i/-a,d:e/a,e:(r*s-i*o)/-a,f:(t*s-e*o)/a}}var NA=qt(()=>{"use strict"});function Td(n){return typeof n>"u"}var Fw=qt(()=>{"use strict"});var itt=qt(()=>{"use strict";Fw()});function yn(n,e=0){return{a:1,c:0,e:n,b:0,d:1,f:e}}var O_=qt(()=>{"use strict"});function ul(...n){n=Array.isArray(n[0])?n[0]:n;let e=(t,i)=>({a:t.a*i.a+t.c*i.b,c:t.a*i.c+t.c*i.d,e:t.a*i.e+t.c*i.f+t.e,b:t.b*i.a+t.d*i.b,d:t.b*i.c+t.d*i.d,f:t.b*i.e+t.d*i.f+t.f});switch(n.length){case 0:throw new Error("no matrices provided");case 1:return n[0];case 2:return e(n[0],n[1]);default:{let[t,i,...r]=n,s=e(t,i);return ul(s,...r)}}}function Fe(...n){return ul(...n)}var Ed=qt(()=>{"use strict"});function us(n,e,t){let i=q9t(n),r=Z9t(n),s={a:i,c:-r,e:0,b:r,d:i,f:0};return Td(e)||Td(t)?s:ul([yn(e,t),s,yn(-e,-t)])}var q9t,Z9t,Ihe,zw=qt(()=>{"use strict";Fw();O_();Ed();({cos:q9t,sin:Z9t,PI:Ihe}=Math)});function Ei(n,e=void 0,t=void 0,i=void 0){Td(e)&&(e=n);let r={a:n,c:0,e:0,b:0,d:e,f:0};return Td(t)||Td(i)?r:ul([yn(t,i),r,yn(-t,-i)])}var E1=qt(()=>{"use strict";Fw();O_();Ed()});var AA=qt(()=>{"use strict"});var zhe,RA=qt(()=>{"use strict";({tan:zhe}=Math)});function rtt(n){return ja(n)}function ja(n){return`matrix(${n.a},${n.b},${n.c},${n.d},${n.e},${n.f})`}var stt=qt(()=>{"use strict"});function ott(n,e=1e10){return{a:Math.round(n.a*e)/e,b:Math.round(n.b*e)/e,c:Math.round(n.c*e)/e,d:Math.round(n.d*e)/e,e:Math.round(n.e*e)/e,f:Math.round(n.f*e)/e}}var OA=qt(()=>{"use strict"});function att(n,e){let t=n[0].x!=null?n[0].x:n[0][0],i=n[0].y!=null?n[0].y:n[0][1],r=e[0].x!=null?e[0].x:e[0][0],s=e[0].y!=null?e[0].y:e[0][1],o=n[1].x!=null?n[1].x:n[1][0],a=n[1].y!=null?n[1].y:n[1][1],c=e[1].x!=null?e[1].x:e[1][0],l=e[1].y!=null?e[1].y:e[1][1],u=n[2].x!=null?n[2].x:n[2][0],p=n[2].y!=null?n[2].y:n[2][1],f=e[2].x!=null?e[2].x:e[2][0],y=e[2].y!=null?e[2].y:e[2][1],g={a:t-u,b:i-p,c:o-u,d:a-p,e:u,f:p},x={a:r-f,b:s-y,c:c-f,d:l-y,e:f,f:y},v=ntt(g),P=ul([x,v]);return ott(P)}var ctt=qt(()=>{"use strict";NA();Ed();OA()});var ltt=qt(()=>{"use strict";IA();O_();E1();zw();RA();AA()});function K9t(n,e){function t(){this.constructor=n}t.prototype=e.prototype,n.prototype=new t}function $w(n,e,t,i){var r=Error.call(this,n);return Object.setPrototypeOf&&Object.setPrototypeOf(r,$w.prototype),r.expected=e,r.found=t,r.location=i,r.name="SyntaxError",r}function LA(n,e,t){return t=t||" ",n.length>e?n:(e-=n.length,t+=t.repeat(e),n+t.slice(0,e))}var utt=qt(()=>{"use strict";K9t($w,Error);$w.prototype.format=function(n){var e="Error: "+this.message;if(this.location){var t=null,i;for(i=0;i<n.length;i++)if(n[i].source===this.location.source){t=n[i].text.split(/\r\n|\n|\r/g);break}var r=this.location.start,s=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(r):r,o=this.location.source+":"+s.line+":"+s.column;if(t){var a=this.location.end,c=LA("",s.line.toString().length," "),l=t[r.line-1],u=r.line===a.line?a.column:l.length+1,p=u-r.column||1;e+=`
 --> `+o+`
`+c+` |
`+s.line+" | "+l+`
`+c+" | "+LA("",r.column-1," ")+LA("",p,"^")}else e+=`
 at `+o}return e};$w.buildMessage=function(n,e){var t={literal:function(l){return'"'+r(l.text)+'"'},class:function(l){var u=l.parts.map(function(p){return Array.isArray(p)?s(p[0])+"-"+s(p[1]):s(p)});return"["+(l.inverted?"^":"")+u.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(l){return l.description}};function i(l){return l.charCodeAt(0).toString(16).toUpperCase()}function r(l){return l.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(u){return"\\x0"+i(u)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(u){return"\\x"+i(u)})}function s(l){return l.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(u){return"\\x0"+i(u)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(u){return"\\x"+i(u)})}function o(l){return t[l.type](l)}function a(l){var u=l.map(o),p,f;if(u.sort(),u.length>0){for(p=1,f=1;p<u.length;p++)u[p-1]!==u[p]&&(u[f]=u[p],f++);u.length=f}switch(u.length){case 1:return u[0];case 2:return u[0]+" or "+u[1];default:return u.slice(0,-1).join(", ")+", or "+u[u.length-1]}}function c(l){return l?'"'+r(l)+'"':"end of input"}return"Expected "+a(n)+" but "+c(e)+" found."}});var ptt=qt(()=>{"use strict";utt()});var htt=qt(()=>{"use strict";E1();Ed()});var dtt=qt(()=>{"use strict"});var ftt=qt(()=>{"use strict";O_();CA();zw();E1();Ed()});var Yt=qt(()=>{"use strict";CA();IA();ttt();ett();NA();itt();zw();E1();AA();RA();stt();Ed();O_();ctt();OA();ltt();ptt();htt();dtt();ftt()});var aet={};xh(aet,{CIRCUIT_TO_SVG_VERSION:()=>fl,circuitJsonToPcbSvg:()=>rRt,circuitJsonToSchematicSvg:()=>y8t,convertCircuitJsonToAssemblySvg:()=>mRt,convertCircuitJsonToPcbSvg:()=>Ytt,convertCircuitJsonToPinoutSvg:()=>zRt,convertCircuitJsonToSchematicSimulationSvg:()=>B8t,convertCircuitJsonToSchematicSvg:()=>UA,convertCircuitJsonToSimulationGraphSvg:()=>net,convertCircuitJsonToSolderPasteMask:()=>U8t,createErrorTextOverlay:()=>D_,createSvgObjectsForSchComponentPortHovers:()=>Qtt,getSoftwareUsedString:()=>dl,isSimulationExperiment:()=>GA,isSimulationTransientVoltageGraph:()=>VA,isSimulationVoltageProbe:()=>eet});function J9t(n,e,t){let{transform:i,shouldDrawErrors:r}=t;if(!r)return[];let{pcb_port_ids:s}=n,o=e.find(f=>f.type==="pcb_port"&&f.pcb_port_id===s?.[0]),a=e.find(f=>f.type==="pcb_port"&&f.pcb_port_id===s?.[1]);if(!o||!a){let y=n.message?.match(/pcb_via\[#?(pcb_via_\d+)\]/)?.[1],g=e.find(x=>x.type==="pcb_via"&&x.pcb_via_id===y);if(g&&g.type==="pcb_via")return Q9t(n,g,t);if(n.center){let x=st(i,{x:n.center.x,y:n.center.y});return BA([{name:"rect",type:"element",attributes:{x:(x.x-5).toString(),y:(x.y-5).toString(),width:"10",height:"10",fill:"red",transform:`rotate(45 ${x.x} ${x.y})`},children:[],value:""},{name:"text",type:"element",attributes:{x:x.x.toString(),y:(x.y-15).toString(),fill:"red","font-family":"sans-serif","font-size":"12","text-anchor":"middle"},children:[{type:"text",value:n.message||"Pcb Trace Error",name:"",attributes:{},children:[]}],value:""}])}else return[]}let c=st(i,{x:o.x,y:o.y}),l=st(i,{x:a.x,y:a.y}),u={x:(c.x+l.x)/2,y:(c.y+l.y)/2};if(isNaN(c.x)||isNaN(c.y)||isNaN(l.x)||isNaN(l.y)||isNaN(u.x)||isNaN(u.y))return[];let p=[{name:"line",type:"element",attributes:{x1:c.x.toString(),y1:c.y.toString(),x2:u.x.toString(),y2:u.y.toString(),stroke:"red","stroke-width":"1.5","stroke-dasharray":"2,2"},children:[],value:""},{name:"line",type:"element",attributes:{x1:u.x.toString(),y1:u.y.toString(),x2:l.x.toString(),y2:l.y.toString(),stroke:"red","stroke-width":"1.5","stroke-dasharray":"2,2"},children:[],value:""},{name:"rect",type:"element",attributes:{x:(u.x-5).toString(),y:(u.y-5).toString(),width:"10",height:"10",fill:"red",transform:`rotate(45 ${u.x} ${u.y})`},children:[],value:""},{name:"text",type:"element",attributes:{x:u.x.toString(),y:(u.y-15).toString(),fill:"red","font-family":"sans-serif","font-size":"12","text-anchor":"middle"},children:[{type:"text",value:n.message||"Pcb Trace Error",name:"",attributes:{},children:[]}],value:""}];return BA(p)}function Q9t(n,e,t){let{transform:i}=t;if(n.center&&e){let r=st(i,{x:n.center.x,y:n.center.y}),s=st(i,{x:e.x,y:e.y}),o=s.x-r.x,a=s.y-r.y,c=Math.sqrt(o*o+a*a),l=Math.atan2(a,o)*180/Math.PI,p=c+10*2,f=20,y=(r.x+s.x)/2,g=(r.y+s.y)/2;return BA([{name:"rect",type:"element",attributes:{x:(y-p/2).toString(),y:(g-f/2).toString(),width:p.toString(),height:f.toString(),fill:"none",stroke:"red","stroke-width":"1","stroke-dasharray":"3,2",transform:`rotate(${l} ${y} ${g})`},children:[],value:""},{name:"rect",type:"element",attributes:{x:(y-5).toString(),y:(g-5).toString(),width:"10",height:"10",fill:"red",transform:`rotate(45 ${y} ${g})`},children:[],value:""},{name:"text",type:"element",attributes:{x:y.toString(),y:(g-f/2-5).toString(),fill:"red","font-family":"sans-serif","font-size":"12","text-anchor":"middle"},children:[{type:"text",value:n.message||"Pcb Trace Error",name:"",attributes:{},children:[]}],value:""}])}return[]}function BA(n){return n.map(e=>({...e,attributes:{...e.attributes??{},"data-type":e.attributes?.["data-type"]??"pcb_trace_error","data-pcb-layer":e.attributes?.["data-pcb-layer"]??"overlay"},children:(e.children??[]).map(t=>t?.type==="element"?{...t,attributes:{...t.attributes??{},"data-type":t.attributes?.["data-type"]??"pcb_trace_error","data-pcb-layer":t.attributes?.["data-pcb-layer"]??"overlay"}}:t)}))}function t6t(n){return n.map(e=>({...e,attributes:{...e.attributes??{},"data-type":e.attributes?.["data-type"]??"pcb_footprint_overlap_error","data-pcb-layer":e.attributes?.["data-pcb-layer"]??"overlay"},children:(e.children??[]).map(t=>t?.type==="element"?{...t,attributes:{...t.attributes??{},"data-type":t.attributes?.["data-type"]??"pcb_footprint_overlap_error","data-pcb-layer":t.attributes?.["data-pcb-layer"]??"overlay"}}:t)}))}function e6t(n,e,t){let{transform:i,shouldDrawErrors:r}=t;if(!r)return[];let s=[],o=[],a=[];if(n.pcb_smtpad_ids)for(let u of n.pcb_smtpad_ids){let p=e.find(f=>f.type==="pcb_smtpad"&&f.pcb_smtpad_id===u);p&&(o.push({x:p.x,y:p.y,type:"pcb_smtpad",id:u,pcb_port_id:p.pcb_port_id}),p.pcb_port_id&&a.push(p.pcb_port_id))}let c=a.length>1&&a.every(u=>u===a[0]),l=o;if(c&&(l=o.filter(u=>u.type!=="pcb_smtpad")),n.pcb_plated_hole_ids)for(let u of n.pcb_plated_hole_ids){let p=e.find(f=>f.type==="pcb_plated_hole"&&f.pcb_plated_hole_id===u);p&&l.push({x:p.x,y:p.y,type:"pcb_plated_hole",id:u})}if(n.pcb_hole_ids)for(let u of n.pcb_hole_ids){let p=e.find(f=>f.type==="pcb_hole"&&f.pcb_hole_id===u);p&&l.push({x:p.x,y:p.y,type:"pcb_hole",id:u})}if(l.length>0){let u=l.reduce((y,g)=>y+g.x,0)/l.length,p=l.reduce((y,g)=>y+g.y,0)/l.length,f=st(i,{x:u,y:p});s.push({name:"rect",type:"element",attributes:{x:(f.x-5).toString(),y:(f.y-5).toString(),width:"10",height:"10",fill:"red",transform:`rotate(45 ${f.x} ${f.y})`},children:[],value:""}),s.push({name:"text",type:"element",attributes:{x:f.x.toString(),y:(f.y-15).toString(),fill:"red","font-family":"sans-serif","font-size":"12","text-anchor":"middle"},children:[{type:"text",value:n.message||"PCB Footprint Overlap Error",name:"",attributes:{},children:[]}],value:""});for(let y of l){let g=st(i,{x:y.x,y:y.y});s.push({name:"rect",type:"element",attributes:{x:(g.x-5).toString(),y:(g.y-5).toString(),width:"10",height:"10",fill:"red",transform:`rotate(45 ${g.x} ${g.y})`},children:[],value:""}),l.length>1&&s.push({name:"line",type:"element",attributes:{x1:f.x.toString(),y1:f.y.toString(),x2:g.x.toString(),y2:g.y.toString(),stroke:"red","stroke-width":"1.5","stroke-dasharray":"2,2"},children:[],value:""})}}return t6t(s)}function n6t(n,e){let{transform:t,layer:i}=e;if(!n.route||!Array.isArray(n.route))return[];let r=n.route[0],s=n.route[n.route.length-1],o=r.x===s.x&&r.y===s.y,a=n.route.slice(0,o?-1:void 0).map((c,l)=>{let[u,p]=st(t,[c.x,c.y]);return l===0?`M ${u} ${p}`:`L ${u} ${p}`}).join(" ")+(o?" Z":"");return[{name:"path",type:"element",attributes:{class:"pcb-fabrication-note-path",stroke:n.color||"rgba(255,255,255,0.5)",fill:"none",d:a,"stroke-width":(n.stroke_width*Math.abs(t.a)).toString(),"data-pcb-component-id":n.pcb_component_id,"data-pcb-fabrication-note-path-id":n.pcb_fabrication_note_path_id,"data-type":"pcb_fabrication_note_path","data-pcb-layer":"overlay"},value:"",children:[]}]}function i6t(n,e){let{transform:t,layer:i}=e,{anchor_position:r,anchor_alignment:s,text:o,font_size:a=1,layer:c="top",color:l}=n;if(i&&c!==i)return[];if(!r||typeof r.x!="number"||typeof r.y!="number")return console.error("Invalid anchor_position:",r),[];let[u,p]=st(t,[r.x,r.y]),f=a*Math.abs(t.a),y=Fe(yn(u,p),us(Math.PI/180));return[{name:"text",type:"element",attributes:{x:"0",y:"0","font-family":"Arial, sans-serif","font-size":f.toString(),"text-anchor":"middle","dominant-baseline":"central",transform:ja(y),class:"pcb-fabrication-note-text",fill:l||"rgba(255,255,255,0.5)","data-type":"pcb_fabrication_note_text","data-pcb-layer":"overlay"},children:[{type:"text",value:o,name:"",attributes:{},children:[]}],value:""}]}function o6t(n,e){let{transform:t,layer:i}=e,{center:r,width:s,height:o,stroke_width:a,is_filled:c,has_stroke:l,is_stroke_dashed:u,color:p,layer:f="top",pcb_component_id:y,pcb_fabrication_note_rect_id:g,corner_radius:x}=n;if(i&&f!==i)return[];if(!r||typeof r.x!="number"||typeof r.y!="number"||typeof s!="number"||typeof o!="number")return console.error("Invalid pcb_fabrication_note_rect data",{center:r,width:s,height:o}),[];let v=s/2,P=o/2,[w,k]=st(t,[r.x-v,r.y+P]),[T,I]=st(t,[r.x+v,r.y-P]),E=Math.min(w,T),N=Math.min(k,I),M=Math.abs(T-w),A=Math.abs(I-k),j=(typeof a=="number"?a:0)*Math.abs(t.a),B=p??r6t,G=typeof x=="number"&&x>0?x:0,U=G*Math.abs(t.a),H=G*Math.abs(t.d),tt={x:E.toString(),y:N.toString(),width:M.toString(),height:A.toString(),class:"pcb-fabrication-note-rect","data-type":"pcb_fabrication_note_rect","data-pcb-fabrication-note-rect-id":g,"data-pcb-layer":"overlay"};if(y!==void 0&&(tt["data-pcb-component-id"]=y),U>0&&(tt.rx=U.toString()),H>0&&(tt.ry=H.toString()),c?tt.fill=p??s6t:tt.fill="none",l??j>0){if(tt.stroke=B,tt["stroke-width"]=j.toString(),u){let V=.2*Math.abs(t.a),J=.1*Math.abs(t.a);tt["stroke-dasharray"]=`${V} ${J}`}}else tt.stroke="none";return[{name:"rect",type:"element",value:"",attributes:tt,children:[]}]}function FA(n){let e=Math.hypot(n.x,n.y)||1;return{x:n.x/e,y:n.y/e}}function mtt(n){return n.map((e,t)=>t===0?`M ${e.x} ${e.y}`:`L ${e.x} ${e.y}`).join(" ")}function a6t(n,e){let{transform:t,layer:i}=e,{from:r,to:s,text:o,font_size:a=1,color:c,arrow_size:l,layer:u,pcb_component_id:p,pcb_fabrication_note_dimension_id:f,offset_distance:y,offset_direction:g}=n;if(i&&u&&u!==i)return[];if(!r||!s||typeof r!="object"||typeof s!="object")return console.error("Invalid pcb_fabrication_note_dimension endpoints",{from:r,to:s}),[];if(typeof r.x!="number"||typeof r.y!="number"||typeof s.x!="number"||typeof s.y!="number")return console.error("Invalid pcb_fabrication_note_dimension point values",{from:r,to:s}),[];let x=typeof l=="number"?l:void 0;if(x===void 0||!Number.isFinite(x)||x<=0)return console.error("Invalid pcb_fabrication_note_dimension arrow_size",l),[];let v=x,P=FA({x:s.x-r.x,y:s.y-r.y});if(Number.isNaN(P.x)||Number.isNaN(P.y))return[];let w={x:-P.y,y:P.x},k=g&&typeof g.x=="number"&&typeof g.y=="number",T=k?FA({x:g.x,y:g.y}):{x:0,y:0},I=typeof y=="number"?y:0,E={x:T.x*I,y:T.y*I},N=le=>({x:le.x+E.x,y:le.y+E.y}),M=N(r),A=N(s),R=v/2,j={x:M.x+P.x*v,y:M.y+P.y*v},B={x:A.x-P.x*v,y:A.y-P.y*v},G=[Kt(M),Kt({x:j.x+w.x*R,y:j.y+w.y*R}),Kt({x:j.x-w.x*R,y:j.y-w.y*R})],U=[Kt(A),Kt({x:B.x+w.x*R,y:B.y+w.y*R}),Kt({x:B.x-w.x*R,y:B.y-w.y*R})],[H,tt]=st(t,[j.x,j.y]),[et,mt]=st(t,[B.x,B.y]),V=v/5*Math.abs(t.a),J=c||"rgba(255,255,255,0.5)",nt=k&&(Math.abs(T.x)>Number.EPSILON||Math.abs(T.y)>Number.EPSILON)?T:w,ut=I+v,ht=le=>{let Jt={x:le.x+nt.x*ut,y:le.y+nt.y*ut},[qn,Ii]=st(t,[le.x,le.y]),[Nr,Xs]=st(t,[Jt.x,Jt.y]);return{name:"path",type:"element",value:"",attributes:{d:`M ${qn} ${Ii} L ${Nr} ${Xs}`,stroke:J,fill:"none","stroke-width":V.toString(),"stroke-linecap":"round",class:"pcb-fabrication-note-dimension-extension"},children:[]}},kt=[ht(r),ht(s)],Mt={x:(r.x+s.x)/2+E.x,y:(r.y+s.y)/2+E.y},ot=v*1.5,X={x:Mt.x+w.x*ot,y:Mt.y+w.y*ot},[W,rt]=st(t,[X.x,X.y]),[pt,yt]=st(t,[M.x,M.y]),[Z,at]=st(t,[A.x,A.y]),Et=FA({x:Z-pt,y:at-yt}),Ft=Math.atan2(Et.y,Et.x)*180/Math.PI;(Ft>90||Ft<-90)&&(Ft+=180);let Ot=a*Math.abs(t.a),Ce=[...kt,{name:"path",type:"element",value:"",attributes:{d:`M ${H} ${tt} L ${et} ${mt}`,stroke:J,fill:"none","stroke-width":V.toString(),"stroke-linecap":"round",class:"pcb-fabrication-note-dimension-line"},children:[]},{name:"path",type:"element",value:"",attributes:{d:`${mtt(G)} Z`,fill:J,class:"pcb-fabrication-note-dimension-arrow"},children:[]},{name:"path",type:"element",value:"",attributes:{d:`${mtt(U)} Z`,fill:J,class:"pcb-fabrication-note-dimension-arrow"},children:[]}];o&&Ce.push({name:"text",type:"element",value:"",attributes:{x:W.toString(),y:rt.toString(),fill:J,"font-size":Ot.toString(),"font-family":"Arial, sans-serif","text-anchor":"middle","dominant-baseline":"central",class:"pcb-fabrication-note-dimension-text",transform:`rotate(${Ft} ${W} ${rt})`},children:[{type:"text",name:"",value:o,attributes:{},children:[]}]});let Se={class:"pcb-fabrication-note-dimension","data-type":"pcb_fabrication_note_dimension","data-pcb-fabrication-note-dimension-id":f,"data-pcb-layer":u??"overlay"};return p!==void 0&&(Se["data-pcb-component-id"]=p),[{name:"g",type:"element",value:"",attributes:Se,children:Ce}];function Kt(le){let[Jt,qn]=st(t,[le.x,le.y]);return{x:Jt,y:qn}}}function zA(n){let e=Math.hypot(n.x,n.y)||1;return{x:n.x/e,y:n.y/e}}function _tt(n){return n.map((e,t)=>t===0?`M ${e.x} ${e.y}`:`L ${e.x} ${e.y}`).join(" ")}function c6t(n,e){let{transform:t}=e,{from:i,to:r,text:s,font_size:o=1,color:a,arrow_size:c,offset_distance:l,offset_direction:u}=n;if(!i||!r)return console.error("Invalid pcb_note_dimension endpoints",{from:i,to:r}),[];if(!Number.isFinite(c)||c<=0)return console.error("Invalid pcb_note_dimension arrow_size",c),[];let p=zA({x:r.x-i.x,y:r.y-i.y});if(Number.isNaN(p.x)||Number.isNaN(p.y))return[];let f={x:-p.y,y:p.x},y=u&&typeof u.x=="number"&&typeof u.y=="number",g=y?zA({x:u.x,y:u.y}):{x:0,y:0},x=typeof l=="number"?l:0,v={x:g.x*x,y:g.y*x},P=at=>({x:at.x+v.x,y:at.y+v.y}),w=P(i),k=P(r),T=c/2,I={x:w.x+p.x*c,y:w.y+p.y*c},E={x:k.x-p.x*c,y:k.y-p.y*c},N=[Z(w),Z({x:I.x+f.x*T,y:I.y+f.y*T}),Z({x:I.x-f.x*T,y:I.y-f.y*T})],M=[Z(k),Z({x:E.x+f.x*T,y:E.y+f.y*T}),Z({x:E.x-f.x*T,y:E.y-f.y*T})],[A,R]=st(t,[I.x,I.y]),[j,B]=st(t,[E.x,E.y]),G=c/5*Math.abs(t.a),U=a||Mi.board.user_2,H=y&&(Math.abs(g.x)>Number.EPSILON||Math.abs(g.y)>Number.EPSILON)?g:f,tt=x+c,et=at=>{let Et={x:at.x+H.x*tt,y:at.y+H.y*tt},[Ft,Ot]=st(t,[at.x,at.y]),[Ce,Se]=st(t,[Et.x,Et.y]);return{name:"path",type:"element",value:"",attributes:{d:`M ${Ft} ${Ot} L ${Ce} ${Se}`,stroke:U,fill:"none","stroke-width":G.toString(),"stroke-linecap":"round",class:"pcb-note-dimension-extension"},children:[]}},mt=[et(i),et(r)],V={x:(i.x+r.x)/2+v.x,y:(i.y+r.y)/2+v.y},J=c*1.5,nt={x:V.x+f.x*J,y:V.y+f.y*J},[ut,ht]=st(t,[nt.x,nt.y]),[kt,Mt]=st(t,[w.x,w.y]),[ot,X]=st(t,[k.x,k.y]),W=zA({x:ot-kt,y:X-Mt}),rt=Math.atan2(W.y,W.x)*180/Math.PI;(rt>90||rt<-90)&&(rt+=180);let pt=o*Math.abs(t.a),yt=[...mt,{name:"path",type:"element",value:"",attributes:{d:`M ${A} ${R} L ${j} ${B}`,stroke:U,fill:"none","stroke-width":G.toString(),"stroke-linecap":"round",class:"pcb-note-dimension-line"},children:[]},{name:"path",type:"element",value:"",attributes:{d:`${_tt(N)} Z`,fill:U,class:"pcb-note-dimension-arrow"},children:[]},{name:"path",type:"element",value:"",attributes:{d:`${_tt(M)} Z`,fill:U,class:"pcb-note-dimension-arrow"},children:[]}];return s&&yt.push({name:"text",type:"element",value:"",attributes:{x:ut.toString(),y:ht.toString(),fill:U,"font-size":pt.toString(),"font-family":"Arial, sans-serif","text-anchor":"middle","dominant-baseline":"central",class:"pcb-note-dimension-text",transform:`rotate(${rt} ${ut} ${ht})`},children:[{type:"text",name:"",value:s,attributes:{},children:[]}]}),[{name:"g",type:"element",value:"",attributes:{class:"pcb-note-dimension","data-type":"pcb_note_dimension","data-pcb-note-dimension-id":n.pcb_note_dimension_id,"data-pcb-layer":"overlay"},children:yt}];function Z(at){let[Et,Ft]=st(t,[at.x,at.y]);return{x:Et,y:Ft}}}function u6t(n,e){let{transform:t}=e,{anchor_position:i,text:r,font_size:s=1,anchor_alignment:o="center",color:a}=n;if(!i||typeof i.x!="number"||typeof i.y!="number")return console.error("Invalid pcb_note_text anchor_position",i),[];if(typeof r!="string"||r.length===0)return console.error("Invalid pcb_note_text text",r),[];let[c,l]=st(t,[i.x,i.y]),u=s*Math.abs(t.a),p="middle",f="central";switch(o){case"top_left":p="start",f="text-before-edge";break;case"top_right":p="end",f="text-before-edge";break;case"bottom_left":p="start",f="text-after-edge";break;case"bottom_right":p="end",f="text-after-edge";break;case"center":default:p="middle",f="central";break}return[{name:"text",type:"element",value:"",attributes:{x:c.toString(),y:l.toString(),fill:a??l6t,"font-family":"Arial, sans-serif","font-size":u.toString(),"text-anchor":p,"dominant-baseline":f,class:"pcb-note-text","data-type":"pcb_note_text","data-pcb-note-text-id":n.pcb_note_text_id,"data-pcb-layer":"overlay"},children:[{type:"text",name:"",value:r,attributes:{},children:[]}]}]}function d6t(n,e){let{transform:t}=e,{center:i,width:r,height:s,stroke_width:o,is_filled:a,has_stroke:c,is_stroke_dashed:l,color:u,corner_radius:p}=n;if(!i||typeof i.x!="number"||typeof i.y!="number"||typeof r!="number"||typeof s!="number")return console.error("Invalid pcb_note_rect data",{center:i,width:r,height:s}),[];let f=r/2,y=s/2,[g,x]=st(t,[i.x-f,i.y+y]),[v,P]=st(t,[i.x+f,i.y-y]),w=Math.min(g,v),k=Math.min(x,P),T=Math.abs(v-g),I=Math.abs(P-x),N=(typeof o=="number"?o:0)*Math.abs(t.a),M=typeof p=="number"&&p>0?p:0,A=M*Math.abs(t.a),R=M*Math.abs(t.d),j=u??p6t,B={x:w.toString(),y:k.toString(),width:T.toString(),height:I.toString(),class:"pcb-note-rect","data-type":"pcb_note_rect","data-pcb-note-rect-id":n.pcb_note_rect_id,"data-pcb-layer":"overlay"};if(A>0&&(B.rx=A.toString()),R>0&&(B.ry=R.toString()),a?B.fill=u??h6t:B.fill="none",c??N>0){if(B.stroke=j,B["stroke-width"]=N.toString(),l){let H=.2*Math.abs(t.a),tt=.1*Math.abs(t.a);B["stroke-dasharray"]=`${H} ${tt}`}}else B.stroke="none";return[{name:"rect",type:"element",value:"",attributes:B,children:[]}]}function m6t(n,e){let{transform:t}=e;if(!Array.isArray(n.route)||n.route.length===0)return console.error("Invalid pcb_note_path route",n.route),[];for(let o of n.route)if(typeof o.x!="number"||typeof o.y!="number")return console.error("Invalid point in pcb_note_path",o),[];let i=n.route.map((o,a)=>{let[c,l]=st(t,[o.x,o.y]);return a===0?`M ${c} ${l}`:`L ${c} ${l}`}).join(" "),r=n.stroke_width*Math.abs(t.a);return[{name:"path",type:"element",value:"",attributes:{d:i,stroke:n.color??f6t,fill:"none","stroke-width":r.toString(),class:"pcb-note-path","data-type":"pcb_note_path","data-pcb-note-path-id":n.pcb_note_path_id,"data-pcb-layer":"overlay"},children:[]}]}function y6t(n,e){let{transform:t}=e,{x1:i,y1:r,x2:s,y2:o,stroke_width:a,color:c,is_dashed:l}=n;if(typeof i!="number"||typeof r!="number"||typeof s!="number"||typeof o!="number")return console.error("Invalid pcb_note_line coordinates",{x1:i,y1:r,x2:s,y2:o}),[];let[u,p]=st(t,[i,r]),[f,y]=st(t,[s,o]),x=(typeof a=="number"?a:0)*Math.abs(t.a),v={x1:u.toString(),y1:p.toString(),x2:f.toString(),y2:y.toString(),stroke:c??_6t,"stroke-width":x.toString(),"stroke-linecap":"round",class:"pcb-note-line","data-type":"pcb_note_line","data-pcb-note-line-id":n.pcb_note_line_id,"data-pcb-layer":"overlay"};if(l){let w=.2*Math.abs(t.a),k=.1*Math.abs(t.a);v["stroke-dasharray"]=`${w} ${k}`}return[{name:"line",type:"element",value:"",attributes:v,children:[]}]}function g6t(n,e){let{transform:t,colorMap:i,showSolderMask:r}=e,[s,o]=st(t,[n.x,n.y]),a=Array.isArray(n.layers)&&n.layers[0]||n.layer||"top",c=(n.soldermask_margin??0)*Math.abs(t.a),l=r&&c!==0,u=i.soldermask.top;if(n.shape==="pill"){let p=n.outer_width*Math.abs(t.a),f=n.outer_height*Math.abs(t.a),y=n.hole_width*Math.abs(t.a),g=n.hole_height*Math.abs(t.a),x=n.ccw_rotation||0,v=x?`translate(${s} ${o}) rotate(${-x})`:`translate(${s} ${o})`,P=x?`translate(${s} ${o}) rotate(${-x})`:`translate(${s} ${o})`,w=(T,I)=>{if(T>I){let E=I/2,N=T-2*E;return`M${-T/2+E},${-E} h${N} a${E},${E} 0 0 1 0,${I} h${-N} a${E},${E} 0 0 1 0,${-I} z`}else if(I>T){let E=T/2,N=I-2*E;return`M${E},${-I/2+E} v${N} a${E},${E} 0 0 1 ${-T},0 v${-N} a${E},${E} 0 0 1 ${T},0 z`}else{let E=T/2;return`M${-E},0 a${E},${E} 0 0 1 ${T},0 a${E},${E} 0 0 1 ${-T},0 z`}},k=[{name:"path",type:"element",attributes:{class:"pcb-hole-outer",fill:i.copper.top,d:w(p,f),transform:v,"data-type":"pcb_plated_hole","data-pcb-layer":a},value:"",children:[]},{name:"path",type:"element",attributes:{class:"pcb-hole-inner",fill:i.drill,d:w(y,g),transform:P,"data-type":"pcb_plated_hole_drill","data-pcb-layer":"drill"},value:"",children:[]}];if(l){let T=p+2*c,I=f+2*c;k.push({name:"path",type:"element",attributes:{class:"pcb-solder-mask",fill:u,d:w(T,I),transform:v,"data-type":"pcb_soldermask"},value:"",children:[]})}return[{name:"g",type:"element",attributes:{"data-type":"pcb_plated_hole","data-pcb-layer":"through"},children:k,value:""}]}if(n.shape==="circle"){let p=n.outer_diameter*Math.abs(t.a),f=n.outer_diameter*Math.abs(t.a),y=n.hole_diameter*Math.abs(t.a),g=n.hole_diameter*Math.abs(t.a),x=Math.min(p,f)/2,v=Math.min(y,g)/2,P=[{name:"circle",type:"element",attributes:{class:"pcb-hole-outer",fill:i.copper.top,cx:s.toString(),cy:o.toString(),r:x.toString(),"data-type":"pcb_plated_hole","data-pcb-layer":a},value:"",children:[]},{name:"circle",type:"element",attributes:{class:"pcb-hole-inner",fill:i.drill,cx:s.toString(),cy:o.toString(),r:v.toString(),"data-type":"pcb_plated_hole_drill","data-pcb-layer":"drill"},value:"",children:[]}];if(l){let w=x+c;P.push({name:"circle",type:"element",attributes:{class:"pcb-solder-mask",fill:u,cx:s.toString(),cy:o.toString(),r:w.toString(),"data-type":"pcb_soldermask"},value:"",children:[]})}return[{name:"g",type:"element",attributes:{"data-type":"pcb_plated_hole","data-pcb-layer":"through"},children:P,value:""}]}if(n.shape==="circular_hole_with_rect_pad"){let p=n,f=n.hole_diameter*Math.abs(t.a),y=n.rect_pad_width*Math.abs(t.a),g=n.rect_pad_height*Math.abs(t.a),x=(n.rect_border_radius??0)*Math.abs(t.a),v=f/2,[P,w]=st(t,[p.x+(p.hole_offset_x??0),p.y+(p.hole_offset_y??0)]),k=[{name:"rect",type:"element",attributes:{class:"pcb-hole-outer-pad",fill:i.copper.top,x:(s-y/2).toString(),y:(o-g/2).toString(),width:y.toString(),height:g.toString(),...x?{rx:x.toString(),ry:x.toString()}:{},"data-type":"pcb_plated_hole","data-pcb-layer":a},value:"",children:[]},{name:"circle",type:"element",attributes:{class:"pcb-hole-inner",fill:i.drill,cx:P.toString(),cy:w.toString(),r:v.toString(),"data-type":"pcb_plated_hole_drill","data-pcb-layer":"drill"},value:"",children:[]}];if(l){let T=y+2*c,I=g+2*c,E=x+c;k.push({name:"rect",type:"element",attributes:{class:"pcb-solder-mask",fill:u,x:(s-T/2).toString(),y:(o-I/2).toString(),width:T.toString(),height:I.toString(),...x?{rx:E.toString(),ry:E.toString()}:{},"data-type":"pcb_soldermask"},value:"",children:[]})}return[{name:"g",type:"element",attributes:{"data-type":"pcb_plated_hole","data-pcb-layer":"through"},children:k,value:""}]}if(n.shape==="pill_hole_with_rect_pad"){let p=n,f=p.rect_pad_width*Math.abs(t.a),y=p.rect_pad_height*Math.abs(t.a),g=(p.rect_border_radius??0)*Math.abs(t.a),x=p.hole_height*Math.abs(t.a),v=p.hole_width*Math.abs(t.a),P=p,w=P.hole_offset_x??0,k=P.hole_offset_y??0,[T,I]=st(t,[p.x+w,p.y+k]),E=Math.min(x,v)/2,N=[{name:"rect",type:"element",attributes:{class:"pcb-hole-outer-pad",fill:i.copper.top,x:(s-f/2).toString(),y:(o-y/2).toString(),width:f.toString(),height:y.toString(),...g?{rx:g.toString(),ry:g.toString()}:{},"data-type":"pcb_plated_hole","data-pcb-layer":a},value:"",children:[]},{name:"rect",type:"element",attributes:{class:"pcb-hole-inner",fill:i.drill,x:(T-v/2).toString(),y:(I-x/2).toString(),width:v.toString(),height:x.toString(),rx:E.toString(),ry:E.toString(),"data-type":"pcb_plated_hole_drill","data-pcb-layer":"drill"},value:"",children:[]}];if(l){let M=f+2*c,A=y+2*c,R=g+c;N.push({name:"rect",type:"element",attributes:{class:"pcb-solder-mask",fill:u,x:(s-M/2).toString(),y:(o-A/2).toString(),width:M.toString(),height:A.toString(),...g?{rx:R.toString(),ry:R.toString()}:{},"data-type":"pcb_soldermask"},value:"",children:[]})}return[{name:"g",type:"element",attributes:{"data-type":"pcb_plated_hole","data-pcb-layer":"through"},children:N,value:""}]}if(n.shape==="rotated_pill_hole_with_rect_pad"){let p=n,f=p.rect_pad_width*Math.abs(t.a),y=p.rect_pad_height*Math.abs(t.a),g=(p.rect_border_radius??0)*Math.abs(t.a),x=p.hole_height*Math.abs(t.a),v=p.hole_width*Math.abs(t.a),P=p,w=P.hole_offset_x??0,k=P.hole_offset_y??0,[T,I]=st(t,[p.x+w,p.y+k]),E=Math.min(x,v)/2,N=[{name:"rect",type:"element",attributes:{class:"pcb-hole-outer-pad",fill:i.copper.top,x:(-f/2).toString(),y:(-y/2).toString(),width:f.toString(),height:y.toString(),transform:`translate(${s} ${o}) rotate(${-p.rect_ccw_rotation})`,...g?{rx:g.toString(),ry:g.toString()}:{},"data-type":"pcb_plated_hole","data-pcb-layer":a},value:"",children:[]},{name:"rect",type:"element",attributes:{class:"pcb-hole-inner",fill:i.drill,x:(-v/2).toString(),y:(-x/2).toString(),width:v.toString(),height:x.toString(),rx:E.toString(),ry:E.toString(),transform:`translate(${T} ${I}) rotate(${-p.hole_ccw_rotation})`,"data-type":"pcb_plated_hole_drill","data-pcb-layer":"drill"},value:"",children:[]}];if(l){let M=f+2*c,A=y+2*c,R=g+c;N.push({name:"rect",type:"element",attributes:{class:"pcb-solder-mask",fill:u,x:(-M/2).toString(),y:(-A/2).toString(),width:M.toString(),height:A.toString(),transform:`translate(${s} ${o}) rotate(${-p.rect_ccw_rotation})`,...g?{rx:R.toString(),ry:R.toString()}:{},"data-type":"pcb_soldermask"},value:"",children:[]})}return[{name:"g",type:"element",attributes:{"data-type":"pcb_plated_hole","data-pcb-layer":"through"},children:N,value:""}]}if(n.shape==="hole_with_polygon_pad"){let p=n,f=p.pad_outline||[],y=p.x??0,g=p.y??0,v=f.map(T=>st(t,[y+T.x,g+T.y])).map(T=>T.join(",")).join(" "),[P,w]=st(t,[y+p.hole_offset_x,g+p.hole_offset_y]),k=()=>{if(p.hole_shape==="circle"){let I=(p.hole_diameter??0)*Math.abs(t.a)/2;return{name:"circle",type:"element",attributes:{class:"pcb-hole-inner",fill:i.drill,cx:P.toString(),cy:w.toString(),r:I.toString(),"data-type":"pcb_plated_hole_drill","data-pcb-layer":"drill"},value:"",children:[]}}if(p.hole_shape==="oval"){let T=(p.hole_width??0)*Math.abs(t.a),I=(p.hole_height??0)*Math.abs(t.a),E=T/2,N=I/2;return{name:"ellipse",type:"element",attributes:{class:"pcb-hole-inner",fill:i.drill,cx:P.toString(),cy:w.toString(),rx:E.toString(),ry:N.toString(),"data-type":"pcb_plated_hole_drill","data-pcb-layer":"drill"},value:"",children:[]}}if(p.hole_shape==="pill"||p.hole_shape==="rotated_pill"){let T=(p.hole_width??0)*Math.abs(t.a),I=(p.hole_height??0)*Math.abs(t.a),E=T>I,N=Math.min(T,I)/2,M=Math.abs(E?T-I:I-T),A=E?`M${-M/2},${-N} h${M} a${N},${N} 0 0 1 0,${I} h-${M} a${N},${N} 0 0 1 0,-${I} z`:`M${-N},${-M/2} v${M} a${N},${N} 0 0 0 ${T},0 v-${M} a${N},${N} 0 0 0 -${T},0 z`;return{name:"path",type:"element",attributes:{class:"pcb-hole-inner",fill:i.drill,d:A,transform:`translate(${P} ${w})`,"data-type":"pcb_plated_hole_drill","data-pcb-layer":"drill"},value:"",children:[]}}return{name:"g",type:"element",attributes:{},value:"",children:[]}};return[{name:"g",type:"element",attributes:{"data-type":"pcb_plated_hole","data-pcb-layer":"through"},children:[{name:"polygon",type:"element",attributes:{class:"pcb-hole-outer-pad",fill:i.copper.top,points:v,"data-type":"pcb_plated_hole","data-pcb-layer":a},value:"",children:[]},k()],value:""}]}return[]}function x6t(n,e){let{transform:t,layer:i,colorMap:r}=e;if(!n.route||!Array.isArray(n.route))return[];let s=n.route.map((u,p)=>{let[f,y]=st(t,[u.x,u.y]);return p===0?`M ${f} ${y}`:`L ${f} ${y}`}).join(" "),o=n.route[0],a=n.route[n.route.length-1];o&&a&&o.x===a.x&&o.y===a.y&&(s+=" Z");let c=n.layer||"top";if(i&&c!==i)return[];let l=c==="bottom"?r.silkscreen.bottom:r.silkscreen.top;return[{name:"path",type:"element",attributes:{class:`pcb-silkscreen pcb-silkscreen-${c}`,d:s,fill:"none",stroke:l,"stroke-width":(n.stroke_width*Math.abs(t.a)).toString(),"stroke-linecap":"round","stroke-linejoin":"round","data-pcb-component-id":n.pcb_component_id,"data-pcb-silkscreen-path-id":n.pcb_silkscreen_path_id,"data-type":"pcb_silkscreen_path","data-pcb-layer":c},value:"",children:[]}]}function b6t(n,e){let{transform:t,layer:i,colorMap:r,circuitJson:s}=e,{anchor_position:o,text:a,font_size:c=1,layer:l="top",ccw_rotation:u=0,anchor_alignment:p="center"}=n;if(i&&l!==i)return[];if(!o||typeof o.x!="number"||typeof o.y!="number")return console.error("Invalid anchor_position:",o),[];let[f,y]=st(t,[o.x,o.y]),g=c*Math.abs(t.a),x="middle",v="central",P=0,w=0;switch(p){case"top_left":x="start",v="text-before-edge";break;case"top_center":x="middle",v="text-before-edge";break;case"top_right":x="end",v="text-before-edge";break;case"center_left":x="start",v="central";break;case"center_right":x="end",v="central";break;case"bottom_left":x="start",v="text-after-edge";break;case"bottom_center":x="middle",v="text-after-edge";break;case"bottom_right":x="end",v="text-after-edge";break;case"center":default:x="middle",v="central";break}let k=Fe(yn(f,y),us(-u*Math.PI/180),...l==="bottom"?[Ei(-1,1)]:[]),T=l==="bottom"?r.silkscreen.bottom:r.silkscreen.top,I=a.split(`
`),E=I.length===1?[{type:"text",value:a,name:"",attributes:{},children:[]}]:I.map((M,A)=>({type:"element",name:"tspan",value:"",attributes:{x:"0",...A>0?{dy:g.toString()}:{}},children:[{type:"text",value:M,name:"",attributes:{},children:[]}]}));return[{name:"text",type:"element",attributes:{x:"0",y:"0",dx:P.toString(),dy:w.toString(),fill:T,"font-family":"Arial, sans-serif","font-size":g.toString(),"text-anchor":x,"dominant-baseline":v,transform:ja(k),class:`pcb-silkscreen-text pcb-silkscreen-${l}`,"data-pcb-silkscreen-text-id":n.pcb_component_id,stroke:"none","data-type":"pcb_silkscreen_text","data-pcb-layer":l},children:E,value:""}]}function v6t(n,e){let{transform:t,layer:i,colorMap:r}=e,{center:s,width:o,height:a,layer:c="top",pcb_silkscreen_rect_id:l,stroke_width:u,is_filled:p,has_stroke:f,is_stroke_dashed:y,corner_radius:g}=n;if(i&&c!==i)return[];if(!s||typeof s.x!="number"||typeof s.y!="number"||typeof o!="number"||typeof a!="number")return console.error("Invalid rectangle data:",{center:s,width:o,height:a}),[];let[x,v]=st(t,[s.x,s.y]),P=typeof g=="number"&&g>0?g:0,w=P*Math.abs(t.a),k=P*Math.abs(t.d),T=o*Math.abs(t.a),I=a*Math.abs(t.d),E=u*Math.abs(t.a),N=c==="bottom"?r.silkscreen.bottom:r.silkscreen.top,M={x:(x-T/2).toString(),y:(v-I/2).toString(),width:T.toString(),height:I.toString(),class:`pcb-silkscreen-rect pcb-silkscreen-${c}`,"data-pcb-silkscreen-rect-id":l,"data-type":"pcb_silkscreen_rect","data-pcb-layer":c};w>0&&(M.rx=w.toString()),k>0&&(M.ry=k.toString()),M.fill=p?N:"none";let A;if(f===void 0?A=E>0:A=f,A){if(M.stroke=N,M["stroke-width"]=E.toString(),y){let j=.1*Math.abs(t.a),B=.05*Math.abs(t.a);M["stroke-dasharray"]=`${j} ${B}`}}else M.stroke="none";return[{name:"rect",type:"element",attributes:M,value:"",children:[]}]}function S6t(n,e){let{transform:t,layer:i,colorMap:r}=e,{center:s,radius:o,layer:a="top",pcb_silkscreen_circle_id:c,stroke_width:l=1}=n;if(i&&a!==i)return[];if(!s||typeof s.x!="number"||typeof s.y!="number"||typeof o!="number")return console.error("Invalid PCB Silkscreen Circle data:",{center:s,radius:o}),[];let[u,p]=st(t,[s.x,s.y]),f=o*Math.abs(t.a),y=l*Math.abs(t.a),g=a==="bottom"?r.silkscreen.bottom:r.silkscreen.top;return[{name:"circle",type:"element",attributes:{cx:u.toString(),cy:p.toString(),r:f.toString(),class:`pcb-silkscreen-circle pcb-silkscreen-${a}`,stroke:g,"stroke-width":y.toString(),"data-pcb-silkscreen-circle-id":c,"data-type":"pcb_silkscreen_circle","data-pcb-layer":a},value:"",children:[]}]}function w6t(n,e){let{transform:t,layer:i,colorMap:r}=e,{x1:s,y1:o,x2:a,y2:c,stroke_width:l,layer:u="top",pcb_silkscreen_line_id:p}=n;if(i&&u!==i)return[];if(typeof s!="number"||typeof o!="number"||typeof a!="number"||typeof c!="number")return console.error("Invalid coordinates:",{x1:s,y1:o,x2:a,y2:c}),[];let[f,y]=st(t,[s,o]),[g,x]=st(t,[a,c]),v=l*Math.abs(t.a),P=u==="bottom"?r.silkscreen.bottom:r.silkscreen.top;return[{name:"line",type:"element",attributes:{x1:f.toString(),y1:y.toString(),x2:g.toString(),y2:x.toString(),stroke:P,"stroke-width":v.toString(),class:`pcb-silkscreen-line pcb-silkscreen-${u}`,"data-pcb-silkscreen-line-id":p,"data-type":"pcb_silkscreen_line","data-pcb-layer":u},value:"",children:[]}]}function P6t(n,e){let{transform:t,layer:i,colorMap:r}=e,{center:s,width:o,height:a,layer:c="top",pcb_courtyard_rect_id:l}=n;if(i&&c!==i)return[];if(!s||typeof s.x!="number"||typeof s.y!="number"||typeof o!="number"||typeof a!="number")return console.error("Invalid courtyard rectangle data:",{center:s,width:o,height:a}),[];let[u,p]=st(t,[s.x,s.y]),f=o*Math.abs(t.a),y=a*Math.abs(t.d),g=.05*Math.abs(t.a),x=r.courtyard,v={x:(u-f/2).toString(),y:(p-y/2).toString(),width:f.toString(),height:y.toString(),class:`pcb-courtyard-rect pcb-courtyard-${c}`,"data-pcb-courtyard-rect-id":l,"data-type":"pcb_courtyard_rect","data-pcb-layer":c};return v.fill="none",v.stroke=x,v["stroke-width"]=g.toString(),[{name:"rect",type:"element",attributes:v,value:"",children:[]}]}function k6t(n){let e=[];for(let t=0;t<n.length-1;t++)e.push([n[t],n[t+1]]);return e}function Md(n,e=gr){return e.copper[n]??"white"}function Dw(n){return T6t[n]??"rgb(105, 105, 105)"}function E6t(n,e){let{transform:t,layer:i,colorMap:r,showSolderMask:s}=e;if(!n.route||!Array.isArray(n.route)||n.route.length<2)return[];let o=k6t(n.route),a=[];for(let[c,l]of o){let u=st(t,[c.x,c.y]),p=st(t,[l.x,l.y]),f="layer"in c?c.layer:"layer"in l?l.layer:null;if(!f||i&&f!==i)continue;let y=Md(f,r),g=r.soldermask[f]??y,x="width"in c?c.width:"width"in l?l.width:null,v=x?(x*Math.abs(t.a)).toString():"0.3";if(s){let P={name:"path",type:"element",value:"",children:[],attributes:{class:"pcb-trace",stroke:y,fill:"none",d:`M ${u[0]} ${u[1]} L ${p[0]} ${p[1]}`,"stroke-width":v,"stroke-linecap":"round","stroke-linejoin":"round","shape-rendering":"crispEdges","data-type":"pcb_trace","data-pcb-layer":f}},w={name:"path",type:"element",value:"",children:[],attributes:{class:"pcb-soldermask",stroke:g,fill:"none",d:`M ${u[0]} ${u[1]} L ${p[0]} ${p[1]}`,"stroke-width":v,"stroke-linecap":"round","stroke-linejoin":"round","shape-rendering":"crispEdges","data-type":"pcb_soldermask","data-pcb-layer":f}};a.push(w,P)}else{let P={name:"path",type:"element",value:"",children:[],attributes:{class:"pcb-trace",stroke:y,fill:"none",d:`M ${u[0]} ${u[1]} L ${p[0]} ${p[1]}`,"stroke-width":v,"stroke-linecap":"round","stroke-linejoin":"round","shape-rendering":"crispEdges","data-type":s?"pcb_soldermask":"pcb_trace","data-pcb-layer":f}};a.push(P)}}return a}function M6t(n,e){let{transform:t,layer:i,colorMap:r,showSolderMask:s}=e;if(i&&n.layer!==i)return[];let o=!!n?.is_covered_with_solder_mask,a=s&&o,c=r.soldermask[n.layer]??r.soldermask.top,l=(n.soldermask_margin??0)*Math.abs(t.a);if(n.shape==="rect"||n.shape==="rotated_rect"){let u=n.width*Math.abs(t.a),p=n.height*Math.abs(t.d),[f,y]=st(t,[n.x,n.y]),x=(n.corner_radius??n.rect_border_radius??0)*Math.abs(t.a);if(n.shape==="rotated_rect"&&n.ccw_rotation){let I={name:"rect",type:"element",value:"",children:[],attributes:{class:"pcb-pad",fill:Md(n.layer,r),x:(-u/2).toString(),y:(-p/2).toString(),width:u.toString(),height:p.toString(),transform:`translate(${f} ${y}) rotate(${-n.ccw_rotation})`,"data-type":"pcb_smtpad","data-pcb-layer":n.layer,...x?{rx:x.toString(),ry:x.toString()}:{}}};if(!a)return[I];let E=u+2*l,N=p+2*l,M=x?x+l:0,A={name:I.name,type:I.type,value:"",children:[],attributes:{...I.attributes,class:"pcb-solder-mask",fill:c,"data-type":"pcb_soldermask",x:(-E/2).toString(),y:(-N/2).toString(),width:E.toString(),height:N.toString(),...M>0?{rx:M.toString(),ry:M.toString()}:{}}};return[I,A]}let v={name:"rect",type:"element",value:"",children:[],attributes:{class:"pcb-pad",fill:Md(n.layer,r),x:(f-u/2).toString(),y:(y-p/2).toString(),width:u.toString(),height:p.toString(),"data-type":"pcb_smtpad","data-pcb-layer":n.layer,...x?{rx:x.toString(),ry:x.toString()}:{}}};if(!a)return[v];let P=u+2*l,w=p+2*l,k=x?x+l:0,T={name:v.name,type:v.type,value:"",children:[],attributes:{...v.attributes,class:"pcb-solder-mask",fill:c,"data-type":"pcb_soldermask",x:(f-P/2).toString(),y:(y-w/2).toString(),width:P.toString(),height:w.toString(),...k>0?{rx:k.toString(),ry:k.toString()}:{}}};return[v,T]}if(n.shape==="pill"){let u=n.width*Math.abs(t.a),p=n.height*Math.abs(t.d),f=n.radius*Math.abs(t.a),[y,g]=st(t,[n.x,n.y]),x={name:"rect",type:"element",value:"",children:[],attributes:{class:"pcb-pad",fill:Md(n.layer,r),x:(y-u/2).toString(),y:(g-p/2).toString(),width:u.toString(),height:p.toString(),rx:f.toString(),ry:f.toString(),"data-type":"pcb_smtpad","data-pcb-layer":n.layer}};if(!a)return[x];let v=u+2*l,P=p+2*l,w=f+l,k={name:x.name,type:x.type,value:"",children:[],attributes:{...x.attributes,class:"pcb-solder-mask",fill:c,"data-type":"pcb_soldermask",x:(y-v/2).toString(),y:(g-P/2).toString(),width:v.toString(),height:P.toString(),rx:w.toString(),ry:w.toString()}};return[x,k]}if(n.shape==="circle"){let u=n.radius*Math.abs(t.a),[p,f]=st(t,[n.x,n.y]),y={name:"circle",type:"element",value:"",children:[],attributes:{class:"pcb-pad",fill:Md(n.layer,r),cx:p.toString(),cy:f.toString(),r:u.toString(),"data-type":"pcb_smtpad","data-pcb-layer":n.layer}};if(!a)return[y];let g=u+l,x={name:y.name,type:y.type,value:"",children:[],attributes:{...y.attributes,class:"pcb-solder-mask",fill:c,"data-type":"pcb_soldermask",r:g.toString()}};return[y,x]}if(n.shape==="polygon"){let u=(n.points??[]).map(g=>st(t,[g.x,g.y])),p={name:"polygon",type:"element",value:"",children:[],attributes:{class:"pcb-pad",fill:Md(n.layer,r),points:u.map(g=>g.join(",")).join(" "),"data-type":"pcb_smtpad","data-pcb-layer":n.layer}};if(!a)return[p];let f=u;if(l!==0){let g=u.reduce((v,P)=>v+P[0],0)/u.length,x=u.reduce((v,P)=>v+P[1],0)/u.length;f=u.map(([v,P])=>{let w=v-g,k=P-x,T=Math.sqrt(w*w+k*k);if(T===0)return[v,P];let I=w/T,E=k/T;return[v+I*l,P+E*l]})}let y={name:p.name,type:p.type,value:"",children:[],attributes:{...p.attributes,class:"pcb-solder-mask",fill:c,"data-type":"pcb_soldermask",points:f.map(g=>g.join(",")).join(" ")}};return[p,y]}return[]}function jtt(n,e){let{transform:t,colorMap:i}=e,{width:r,height:s,center:o,outline:a}=n,c;if(a&&Array.isArray(a)&&a.length>=3)c=a.map((l,u)=>{let[p,f]=st(t,[l.x,l.y]);return u===0?`M ${p} ${f}`:`L ${p} ${f}`}).join(" ");else{let l=r/2,u=s/2,p=st(t,[o.x-l,o.y-u]),f=st(t,[o.x+l,o.y-u]),y=st(t,[o.x+l,o.y+u]),g=st(t,[o.x-l,o.y+u]);c=`M ${p[0]} ${p[1]} L ${f[0]} ${f[1]} L ${y[0]} ${y[1]} L ${g[0]} ${g[1]}`}return c+=" Z",[{name:"path",type:"element",value:"",children:[],attributes:{class:"pcb-board",d:c,fill:"none",stroke:i.boardOutline,"stroke-width":(.1*Math.abs(t.a)).toString(),"data-type":"pcb_board","data-pcb-layer":"board"}}]}function C6t(n,e){let{transform:t,colorMap:i,showSolderMask:r}=e,s=Number(n.width),o=Number(n.height),a=n.center??{x:s/2,y:o/2},c=s/2,l=o/2,u=st(t,[a.x-c,a.y-l]),p=st(t,[a.x+c,a.y-l]),f=st(t,[a.x+c,a.y+l]),y=st(t,[a.x-c,a.y+l]),g=`M ${u[0]} ${u[1]} L ${p[0]} ${p[1]} L ${f[0]} ${f[1]} L ${y[0]} ${y[1]} Z`,x=n.covered_with_solder_mask!==!1,v=!!(r&&x);return[{name:"path",type:"element",value:"",children:[],attributes:{class:"pcb-panel",d:g,fill:"none",stroke:i.boardOutline,"stroke-width":(.1*Math.abs(t.a)).toString(),"data-type":"pcb_panel","data-pcb-layer":"board"}}]}function I6t(n,e){let{transform:t,colorMap:i}=e,[r,s]=st(t,[n.x,n.y]),o=n.outer_diameter*Math.abs(t.a),a=n.outer_diameter*Math.abs(t.a),c=n.hole_diameter*Math.abs(t.a),l=n.hole_diameter*Math.abs(t.a),u=Math.min(o,a)/2,p=Math.min(c,l)/2;return{name:"g",type:"element",attributes:{"data-type":"pcb_via","data-pcb-layer":"through"},children:[{name:"circle",type:"element",attributes:{class:"pcb-hole-outer",fill:i.copper.top,cx:r.toString(),cy:s.toString(),r:u.toString(),"data-type":"pcb_via","data-pcb-layer":"top"}},{name:"circle",type:"element",attributes:{class:"pcb-hole-inner",fill:i.drill,cx:r.toString(),cy:s.toString(),r:p.toString(),"data-type":"pcb_via","data-pcb-layer":"drill"}}]}}function N6t(n,e){let{transform:t,colorMap:i,showSolderMask:r}=e,[s,o]=st(t,[n.x,n.y]),a=(n.soldermask_margin??0)*Math.abs(t.a),c=r&&a!==0,l=i.soldermask.top;if(n.hole_shape==="circle"||n.hole_shape==="square"){let u=n.hole_diameter*Math.abs(t.a),p=u/2;if(n.hole_shape==="circle"){let x={name:"circle",type:"element",attributes:{class:"pcb-hole",cx:s.toString(),cy:o.toString(),r:p.toString(),fill:i.drill,"data-type":"pcb_hole","data-pcb-layer":"drill"},children:[],value:""};if(!c)return[x];let v=p+a,P={name:x.name,type:x.type,value:"",children:[],attributes:{...x.attributes,class:"pcb-solder-mask",fill:l,"data-type":"pcb_soldermask",r:v.toString()}};return[x,P]}let f={name:"rect",type:"element",attributes:{class:"pcb-hole",x:(s-p).toString(),y:(o-p).toString(),width:u.toString(),height:u.toString(),fill:i.drill,"data-type":"pcb_hole","data-pcb-layer":"drill"},children:[],value:""};if(!c)return[f];let y=u+2*a,g={name:f.name,type:f.type,value:"",children:[],attributes:{...f.attributes,class:"pcb-solder-mask",fill:l,"data-type":"pcb_soldermask",x:(s-y/2).toString(),y:(o-y/2).toString(),width:y.toString(),height:y.toString()}};return[f,g]}if(n.hole_shape==="oval"){let u=n.hole_width*Math.abs(t.a),p=n.hole_height*Math.abs(t.a),f=u/2,y=p/2,g={name:"ellipse",type:"element",attributes:{class:"pcb-hole",cx:s.toString(),cy:o.toString(),rx:f.toString(),ry:y.toString(),fill:i.drill,"data-type":"pcb_hole","data-pcb-layer":"drill"},children:[],value:""};if(!c)return[g];let x=f+a,v=y+a,P={name:g.name,type:g.type,value:"",children:[],attributes:{...g.attributes,class:"pcb-solder-mask",fill:l,"data-type":"pcb_soldermask",rx:x.toString(),ry:v.toString()}};return[g,P]}if(n.hole_shape==="rect"){let u=n.hole_width*Math.abs(t.a),p=n.hole_height*Math.abs(t.a),f={name:"rect",type:"element",attributes:{class:"pcb-hole",x:(s-u/2).toString(),y:(o-p/2).toString(),width:u.toString(),height:p.toString(),fill:i.drill,"data-type":"pcb_hole","data-pcb-layer":"drill"},children:[],value:""};if(!c)return[f];let y=u+2*a,g=p+2*a,x={name:f.name,type:f.type,value:"",children:[],attributes:{...f.attributes,class:"pcb-solder-mask",fill:l,"data-type":"pcb_soldermask",x:(s-y/2).toString(),y:(o-g/2).toString(),width:y.toString(),height:g.toString()}};return[f,x]}if(n.hole_shape==="pill"){let u=n.hole_width*Math.abs(t.a),p=n.hole_height*Math.abs(t.a),f=u>p,y=Math.min(u,p)/2,g=Math.abs(f?u-p:p-u),x=f?`M${s-g/2},${o-y} h${g} a${y},${y} 0 0 1 0,${p} h-${g} a${y},${y} 0 0 1 0,-${p} z`:`M${s-y},${o-g/2} v${g} a${y},${y} 0 0 0 ${u},0 v-${g} a${y},${y} 0 0 0 -${u},0 z`,v={name:"path",type:"element",attributes:{class:"pcb-hole",fill:i.drill,d:x,"data-type":"pcb_hole","data-pcb-layer":"drill"},children:[],value:""};if(!c)return[v];let P=u+2*a,w=p+2*a,k=P>w,T=Math.min(P,w)/2,I=Math.abs(k?P-w:w-P),E=k?`M${s-I/2},${o-T} h${I} a${T},${T} 0 0 1 0,${w} h-${I} a${T},${T} 0 0 1 0,-${w} z`:`M${s-T},${o-I/2} v${I} a${T},${T} 0 0 0 ${P},0 v-${I} a${T},${T} 0 0 0 -${P},0 z`,N={name:v.name,type:v.type,value:"",children:[],attributes:{...v.attributes,class:"pcb-solder-mask",fill:l,"data-type":"pcb_soldermask",d:E}};return[v,N]}if(n.hole_shape==="rotated_pill"){let u=n.hole_width*Math.abs(t.a),p=n.hole_height*Math.abs(t.a),f="ccw_rotation"in n?n.ccw_rotation??0:0,y=u>p,g=Math.min(u,p)/2,x=Math.abs(y?u-p:p-u),v=y?`M${-x/2},${-g} h${x} a${g},${g} 0 0 1 0,${p} h-${x} a${g},${g} 0 0 1 0,-${p} z`:`M${-g},${-x/2} v${x} a${g},${g} 0 0 0 ${u},0 v-${x} a${g},${g} 0 0 0 -${u},0 z`,P={name:"path",type:"element",attributes:{class:"pcb-hole",fill:i.drill,d:v,transform:`translate(${s} ${o}) rotate(${-f})`,"data-type":"pcb_hole","data-pcb-layer":"drill"},children:[],value:""};if(!c)return[P];let w=u+2*a,k=p+2*a,T=w>k,I=Math.min(w,k)/2,E=Math.abs(T?w-k:k-w),N=T?`M${-E/2},${-I} h${E} a${I},${I} 0 0 1 0,${k} h-${E} a${I},${I} 0 0 1 0,-${k} z`:`M${-I},${-E/2} v${E} a${I},${I} 0 0 0 ${w},0 v-${E} a${I},${I} 0 0 0 -${w},0 z`,M={name:P.name,type:P.type,value:"",children:[],attributes:{...P.attributes,class:"pcb-solder-mask",fill:l,"data-type":"pcb_soldermask",d:N}};return[P,M]}return[]}function O6t(n,e){let{transform:t}=e,i=nr(n),r=n.filter(c=>c.type==="pcb_port"),s=n.filter(c=>c.type==="source_trace"),o=[];r.forEach((c,l)=>{let u=c.pcb_port_id;if(!u)return;let p=i.getNetConnectedToId(u);if(!p)return;let f=!1,y=Me(n).source_port.getWhere({pcb_port_id:u});if(y&&y.source_port_id){let v=y.source_port_id;for(let P of s)if(Array.isArray(P.connected_source_port_ids)&&P.connected_source_port_ids.includes(v)&&Array.isArray(P.connected_source_net_ids)&&P.connected_source_net_ids.length>0){f=!0;break}}let g={x:c.x,y:c.y},x=R6t(g,p,i,n);x&&o.push({key:`${u}-${l}`,startPoint:g,endPoint:x,isInNet:f})});let a=[];for(let c of o){let l=st(t,[c.startPoint.x,c.startPoint.y]),u=st(t,[c.endPoint.x,c.endPoint.y]),p={x1:l[0].toString(),y1:l[1].toString(),x2:u[0].toString(),y2:u[1].toString(),stroke:"white","stroke-width":"1","stroke-dasharray":"6,6","data-type":"pcb_rats_nest","data-pcb-layer":"overlay"};a.push({name:"line",type:"element",attributes:p,value:"",children:[]})}return a}function L6t(n,e){let{transform:t,colorMap:i}=e;if(n.shape==="rect"){let r=n,[s,o]=st(t,[r.center.x,r.center.y]),a=r.width*Math.abs(t.a),c=r.height*Math.abs(t.d),l=-(r.rotation??0),{corner_radius:u}=r,p=typeof u=="number"&&u>0?u:0,f=p*Math.abs(t.a),y=p*Math.abs(t.d),g={class:"pcb-cutout pcb-cutout-rect",x:(-a/2).toString(),y:(-c/2).toString(),width:a.toString(),height:c.toString(),fill:i.drill,transform:ja(Fe(yn(s,o),us(l*Math.PI/180))),"data-type":"pcb_cutout","data-pcb-layer":"drill"};return f>0&&(g.rx=f.toString()),y>0&&(g.ry=y.toString()),[{name:"rect",type:"element",attributes:g,children:[],value:""}]}if(n.shape==="circle"){let r=n,[s,o]=st(t,[r.center.x,r.center.y]),a=r.radius*Math.abs(t.a);return[{name:"circle",type:"element",attributes:{class:"pcb-cutout pcb-cutout-circle",cx:s.toString(),cy:o.toString(),r:a.toString(),fill:i.drill,"data-type":"pcb_cutout","data-pcb-layer":"drill"},children:[],value:""}]}if(n.shape==="polygon"){let r=n;return!r.points||r.points.length===0?[]:[{name:"polygon",type:"element",attributes:{class:"pcb-cutout pcb-cutout-polygon",points:r.points.map(a=>st(t,[a.x,a.y])).map(a=>`${a[0]},${a[1]}`).join(" "),fill:i.drill,"data-type":"pcb_cutout","data-pcb-layer":"drill"},children:[],value:""}]}return[]}function ytt(n,e){if(n.length===0)return"";let t=n.map(r=>{let[s,o]=st(e,[r.x,r.y]);return{...r,x:s,y:o}}),i=`M ${t[0].x} ${t[0].y}`;for(let r=0;r<t.length;r++){let s=t[r],o=t[(r+1)%t.length];if(s.bulge){if(Math.hypot(o.x-s.x,o.y-s.y)<1e-9)continue;let a=s.bulge,c=o.x-s.x,l=o.y-s.y,u=Math.hypot(c,l),p=Math.abs(u/4/a*(a*a+1)),f=a<0?1:0,y=Math.abs(a)>1?1:0;i+=` A ${p} ${p} 0 ${y} ${f} ${o.x} ${o.y}`}else i+=` L ${o.x} ${o.y}`}return i+=" Z",i}function F6t(n,e){let{transform:t,layer:i,colorMap:r}=e,{layer:s}=n;if(i&&s!==i)return[];let o=Md(s,r),a="0.5";if(n.shape==="rect"){let[c,l]=st(t,[n.center.x,n.center.y]),u=n.width*Math.abs(t.a),p=n.height*Math.abs(t.d),f=-(n.rotation??0);return[{name:"rect",type:"element",attributes:{class:"pcb-copper-pour pcb-copper-pour-rect",x:(-u/2).toString(),y:(-p/2).toString(),width:u.toString(),height:p.toString(),fill:o,"fill-opacity":a,transform:ja(Fe(yn(c,l),us(f*Math.PI/180))),"data-type":"pcb_copper_pour","data-pcb-layer":s},children:[],value:""}]}if(n.shape==="polygon")return!n.points||n.points.length===0?[]:[{name:"polygon",type:"element",attributes:{class:"pcb-copper-pour pcb-copper-pour-polygon",points:n.points.map(u=>st(t,[u.x,u.y])).map(u=>`${u[0]},${u[1]}`).join(" "),fill:o,"fill-opacity":a,"data-type":"pcb_copper_pour","data-pcb-layer":s},children:[],value:""}];if(n.shape==="brep"){let{brep_shape:c}=n,l=ytt(c.outer_ring.vertices,t);for(let u of c.inner_rings??[])l+=` ${ytt(u.vertices,t)}`;return[{name:"path",type:"element",attributes:{class:"pcb-copper-pour pcb-copper-pour-brep",d:l,fill:o,"fill-rule":"evenodd","fill-opacity":a,"data-type":"pcb_copper_pour","data-pcb-layer":s},children:[],value:""}]}return[]}function $6t({grid:n,svgWidth:e,svgHeight:t}){if(!n)return{};let i=n.lineColor??z6t,r=n.cellSize,s=n.majorCellSize,o=n.majorLineColor??i;if(s!==void 0){if(!r||r<=0)throw new Error("grid.majorCellSize requires a positive grid.cellSize");if(s<=0)throw new Error("grid.majorCellSize must be a positive multiple of grid.cellSize");let p=s/r,f=Math.round(p);if(!Number.isFinite(p)||Math.abs(p-f)>1e-6)throw new Error("grid.majorCellSize must be a positive multiple of grid.cellSize")}if(!r||r<=0)return{};let a=s!==void 0,c=a?D6t(r,s,i,o):[{name:"path",type:"element",value:"",attributes:{d:`M ${r} 0 L 0 0 0 ${r}`,fill:"none",stroke:i,"stroke-width":"1","shape-rendering":"crispEdges"},children:[]}],l={name:"defs",type:"element",value:"",attributes:{},children:[{name:"pattern",type:"element",value:"",attributes:{id:gtt,width:a?s.toString():r.toString(),height:a?s.toString():r.toString(),patternUnits:"userSpaceOnUse"},children:c}]},u={name:"rect",type:"element",value:"",attributes:{x:"0",y:"0",width:e.toString(),height:t.toString(),fill:`url(#${gtt})`,"pointer-events":"none","data-type":"pcb_grid","data-pcb-layer":"global"},children:[]};return{defs:l,rect:u}}function D6t(n,e,t,i){let r=[],s=Math.round(e/n);for(let o=0;o<s;o+=1){let c=Number((o*n).toFixed(6)).toString(),l=o===0?i:t,u=e.toString();r.push({name:"line",type:"element",value:"",attributes:{x1:c,y1:"0",x2:c,y2:u,stroke:l,"stroke-width":"1","shape-rendering":"crispEdges"},children:[]}),r.push({name:"line",type:"element",value:"",attributes:{x1:"0",y1:c,x2:u,y2:c,stroke:l,"stroke-width":"1","shape-rendering":"crispEdges"},children:[]})}return r}function U6t(n){let{groupAnchorPosition:e,componentPosition:t,transform:i,componentWidth:r=0,componentHeight:s=0}=n,o=[],[a,c]=st(i,[e.x,e.y]),[l,u]=st(i,[t.x,t.y]),p=t.x-e.x,f=t.y-e.y,y=Math.abs(i.a),g=r*y,x=s*y;o.push(V6t(a,c)),o.push({name:"line",type:"element",attributes:{x1:a.toString(),y1:c.toString(),x2:l.toString(),y2:u.toString(),stroke:"#ffffff","stroke-width":"0.5","stroke-dasharray":"3,3",opacity:"0.5",class:"anchor-offset-connector"},children:[],value:""}),o.push({name:"circle",type:"element",attributes:{cx:l.toString(),cy:u.toString(),r:"2",fill:"#ffffff",opacity:"0.7",class:"anchor-offset-component-marker"},children:[],value:""});let v=Math.abs(u-c),P=Math.abs(l-a),w=Math.sqrt(P*P+v*v),k=x/2+j6t,T=Math.max(k,Math.min(X6t,w*Y6t)),I=f>0?u-T:u+T,E=g/2+B6t,N=p>0?l+E:l-E;return Math.abs(p)>xtt&&o.push(...G6t({startX:a,endX:l,y:I,offsetMm:p,offsetY:f})),Math.abs(f)>xtt&&o.push(...H6t({x:N,startY:c,endY:u,offsetMm:-f,offsetX:p})),o}function V6t(n,e){return{name:"g",type:"element",attributes:{class:"anchor-offset-marker","data-type":"anchor_offset_marker"},children:[{name:"line",type:"element",attributes:{x1:n.toString(),y1:(e-jw).toString(),x2:n.toString(),y2:(e+jw).toString(),stroke:"#ffffff","stroke-width":vtt.toString(),"stroke-linecap":"round"},children:[],value:""},{name:"line",type:"element",attributes:{x1:(n-jw).toString(),y1:e.toString(),x2:(n+jw).toString(),y2:e.toString(),stroke:"#ffffff","stroke-width":vtt.toString(),"stroke-linecap":"round"},children:[],value:""}],value:""}}function G6t({startX:n,endX:e,y:t,offsetMm:i,offsetY:r}){let s=[];s.push({name:"line",type:"element",attributes:{x1:n.toString(),y1:t.toString(),x2:e.toString(),y2:t.toString(),stroke:"#ffffff","stroke-width":L_.toString(),class:"anchor-offset-dimension-x"},children:[],value:""}),s.push({name:"line",type:"element",attributes:{x1:n.toString(),y1:(t-Ls).toString(),x2:n.toString(),y2:(t+Ls).toString(),stroke:"#ffffff","stroke-width":L_.toString()},children:[],value:""}),s.push({name:"line",type:"element",attributes:{x1:e.toString(),y1:(t-Ls).toString(),x2:e.toString(),y2:(t+Ls).toString(),stroke:"#ffffff","stroke-width":L_.toString()},children:[],value:""});let o=(n+e)/2,a=r>0?t-Ls-btt:t+Ls+btt;return s.push({name:"text",type:"element",attributes:{x:o.toString(),y:a.toString(),fill:"#ffffff","font-size":Btt.toString(),"font-family":"Arial, sans-serif","text-anchor":"middle","dominant-baseline":r>0?"baseline":"hanging",class:"anchor-offset-label"},children:[{type:"text",value:`X: ${i.toFixed(2)}mm`,name:"",attributes:{},children:[]}],value:""}),s}function H6t({x:n,startY:e,endY:t,offsetMm:i,offsetX:r}){let s=[];s.push({name:"line",type:"element",attributes:{x1:n.toString(),y1:e.toString(),x2:n.toString(),y2:t.toString(),stroke:"#ffffff","stroke-width":L_.toString(),class:"anchor-offset-dimension-y"},children:[],value:""}),s.push({name:"line",type:"element",attributes:{x1:(n-Ls).toString(),y1:e.toString(),x2:(n+Ls).toString(),y2:e.toString(),stroke:"#ffffff","stroke-width":L_.toString()},children:[],value:""}),s.push({name:"line",type:"element",attributes:{x1:(n-Ls).toString(),y1:t.toString(),x2:(n+Ls).toString(),y2:t.toString(),stroke:"#ffffff","stroke-width":L_.toString()},children:[],value:""});let o=(e+t)/2,a=r<0?n-Ls-4:n+Ls+4;return s.push({name:"text",type:"element",attributes:{x:a.toString(),y:o.toString(),fill:"#ffffff","font-size":Btt.toString(),"font-family":"Arial, sans-serif","text-anchor":r<0?"end":"start","dominant-baseline":"middle",class:"anchor-offset-label"},children:[{type:"text",value:`Y: ${i.toFixed(2)}mm`,name:"",attributes:{},children:[]}],value:""}),s}function W6t(n,e){let{transform:t,circuitJson:i}=e,{center:r,width:s,height:o,rotation:a=0}=n,[c,l]=st(t,[r.x,r.y]),u=s*Math.abs(t.a),p=o*Math.abs(t.d),f=`translate(${c}, ${l}) rotate(${-a}) scale(1, -1)`,y=[];if(e.showAnchorOffsets&&n.positioned_relative_to_pcb_group_id&&n.position_mode==="relative"&&i){let g=i.find(x=>x.type==="pcb_group"&&x.pcb_group_id===n.positioned_relative_to_pcb_group_id);g?.center&&y.push(...U6t({groupAnchorPosition:g.center,componentPosition:r,transform:t,componentWidth:s,componentHeight:o}))}return!e.colorMap.debugComponent?.fill&&!e.colorMap.debugComponent?.stroke||y.push({name:"g",type:"element",attributes:{transform:f,"data-type":"pcb_component","data-pcb-layer":n.layer??"top"},children:[{name:"rect",type:"element",attributes:{class:"pcb-component",x:(-u/2).toString(),y:(-p/2).toString(),width:u.toString(),height:p.toString(),fill:e.colorMap.debugComponent.fill??"transparent",stroke:e.colorMap.debugComponent.stroke??"transparent","data-type":"pcb_component","data-pcb-layer":n.layer??"top"}}],value:""}),y}function K6t(n,e){let{transform:t}=e,{center:i,width:r,height:s}=n,o=Array.isArray(n.outline)?n.outline:void 0,a=Z6t*Math.abs(t.a),c=.3*Math.abs(t.a),l=.15*Math.abs(t.a),u={class:"pcb-group",fill:"none",stroke:q6t,"stroke-width":a.toString(),"stroke-dasharray":`${c} ${l}`,"data-type":"pcb_group","data-pcb-group-id":n.pcb_group_id,"data-pcb-layer":"overlay"};if(n.name&&(u["data-group-name"]=n.name),o&&o.length>=3&&o.every(E=>E&&typeof E.x=="number"&&typeof E.y=="number")){let E=o.map((N,M)=>{let[A,R]=st(t,[N.x,N.y]);return M===0?`M ${A} ${R}`:`L ${A} ${R}`}).join(" ");return[{name:"path",type:"element",value:"",children:[],attributes:{...u,d:`${E} Z`}}]}if(!i||typeof i.x!="number"||typeof i.y!="number"||typeof r!="number"||typeof s!="number")return console.error("Invalid pcb_group data",{center:i,width:r,height:s}),[];let p=r/2,f=s/2,[y,g]=st(t,[i.x-p,i.y+f]),[x,v]=st(t,[i.x+p,i.y-f]),P=Math.min(y,x),w=Math.min(g,v),k=Math.abs(x-y),T=Math.abs(v-g);return[{name:"rect",type:"element",value:"",attributes:{...u,x:P.toString(),y:w.toString(),width:k.toString(),height:T.toString()},children:[]}]}function dl(n){return n.find(t=>t.type==="project_software_metadata"||t.type==="source_project_metadata")?.software_used_string}function wtt(n){return n.map((e,t)=>({object:e,index:t,layerPriority:tRt(e.attributes?.["data-pcb-layer"]??void 0),typePriority:eRt(e.attributes?.["data-type"]??void 0)})).sort((e,t)=>e.layerPriority!==t.layerPriority?e.layerPriority-t.layerPriority:e.typePriority!==t.typePriority?e.typePriority-t.typePriority:e.index-t.index).map(({object:e})=>e)}function tRt(n){if(!n)return 500;let e=n.toLowerCase();if(e==="global")return-100;if(e==="bottom")return 0;if(e==="board")return 2;if(e.startsWith("inner")){let t=e.match(/\d+/);return 5+(t?parseInt(t[0],10):0)}return e==="through"?18:e==="top"?17:e==="drill"?30:e==="overlay"?40:10}function eRt(n){return n?Q6t[n]??Stt:Stt}function D_(n,e="error_text_overlay"){let t=n.filter(s=>s.type.endsWith("_error"));if(t.length===0)return null;let i=t.map(s=>s.message).filter(s=>!!s);return i.length===0?null:{name:"text",type:"element",value:"",attributes:{x:"10",y:"20",fill:"red","font-family":"monospace","font-size":"12px","data-type":e,"data-layer":"global"},children:i.map((s,o)=>({name:"tspan",type:"element",value:"",attributes:{x:"10",dy:o===0?"0":"1.2em"},children:[{type:"text",value:s,name:"",attributes:{},children:[]}]}))}}function Ytt(n,e){let t=e?.drawPaddingOutsideBoard??!0,i=e?.layer,r=e?.colorOverrides,s={...gr.copper};if(r?.copper)for(let[Z,at]of Object.entries(r.copper))at!==void 0&&(s[Z]=at);let o={copper:s,drill:r?.drill??gr.drill,silkscreen:{top:r?.silkscreen?.top??gr.silkscreen.top,bottom:r?.silkscreen?.bottom??gr.silkscreen.bottom},boardOutline:r?.boardOutline??gr.boardOutline,soldermask:{top:r?.soldermask?.top??gr.soldermask.top,bottom:r?.soldermask?.bottom??gr.soldermask.bottom},courtyard:r?.courtyard??gr.courtyard,debugComponent:{fill:r?.debugComponent?.fill??gr.debugComponent.fill,stroke:r?.debugComponent?.stroke??gr.debugComponent.stroke}},a=Number.POSITIVE_INFINITY,c=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,u=Number.NEGATIVE_INFINITY,p=!1,f=Number.POSITIVE_INFINITY,y=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,x=Number.NEGATIVE_INFINITY,v=!1;for(let Z of n)if(Z.type==="pcb_panel"){let at=Z,Et=Y.parse(at.width),Ft=Y.parse(at.height);if(Et===void 0||Ft===void 0)continue;let Ot=at.center??{x:Et/2,y:Ft/2};ot(Ot,Et,Ft)}else if(Z.type==="pcb_board")Z.outline&&Array.isArray(Z.outline)&&Z.outline.length>=3?(W(Z.outline),rt(Z.outline)):"center"in Z&&"width"in Z&&"height"in Z&&(ot(Z.center,Z.width,Z.height),X(Z.center,Z.width,Z.height));else if(Z.type==="pcb_smtpad"){let at=Z;if(at.shape==="rect"||at.shape==="rotated_rect"||at.shape==="pill")ot({x:at.x,y:at.y},at.width,at.height);else if(at.shape==="circle"){let Et=Y.parse(at.radius);Et!==void 0&&ot({x:at.x,y:at.y},Et*2,Et*2)}else at.shape==="polygon"&&pt(at.points)}else if("x"in Z&&"y"in Z)ot({x:Z.x,y:Z.y},0,0);else if("route"in Z)pt(Z.route);else if(Z.type==="pcb_note_rect"||Z.type==="pcb_fabrication_note_rect")ot(Z.center,Z.width,Z.height);else if(Z.type==="pcb_cutout"){let at=Z;if(at.shape==="rect")ot(at.center,at.width,at.height);else if(at.shape==="circle"){let Et=Y.parse(at.radius);Et!==void 0&&ot(at.center,Et*2,Et*2)}else at.shape==="polygon"&&pt(at.points)}else Z.type==="pcb_silkscreen_text"||Z.type==="pcb_silkscreen_rect"||Z.type==="pcb_silkscreen_circle"||Z.type==="pcb_silkscreen_line"?yt(Z):Z.type==="pcb_copper_pour"&&(Z.shape==="rect"?ot(Z.center,Z.width,Z.height):Z.shape==="polygon"&&pt(Z.points));let P=t?1:0,w=t||!Number.isFinite(f)?a:f,k=t||!Number.isFinite(y)?c:y,T=t||!Number.isFinite(g)?l:g,I=t||!Number.isFinite(x)?u:x,E=T-w+2*P,N=I-k+2*P,M=e?.width??800,A=e?.height??600;if(e?.matchBoardAspectRatio){let Z=g-f,at=x-y;if(Z>0&&at>0){let Et=Z/at;e?.width&&!e?.height?A=e.width/Et:e?.height&&!e?.width?M=e.height*Et:A=M/Et}}let R=[];for(let Z of n)"route"in Z&&Z.route!==void 0&&R.push(Z.route);let j=M/E,B=A/N,G=Math.min(j,B),U=(M-E*G)/2,H=(A-N*G)/2,tt=Fe(yn(U-w*G+P*G,A-H+k*G-P*G),Ei(G,-G)),et={transform:tt,layer:i,shouldDrawErrors:e?.shouldDrawErrors,showCourtyards:e?.showCourtyards,showPcbGroups:e?.showPcbGroups,drawPaddingOutsideBoard:t,colorMap:o,showSolderMask:e?.showSolderMask,showAnchorOffsets:e?.showAnchorOffsets,circuitJson:n},mt=n.flatMap(Z=>nRt({elm:Z,circuitJson:n,ctx:et})),V=wtt(mt),J=String(.05*G);for(let Z of n)if("stroke_width"in Z){J=String(G*Z.stroke_width);break}if(e?.shouldDrawRatsNest){let Z=O6t(n,et);V=wtt([...V,...Z])}let nt=[{name:"style",type:"element",value:"",attributes:{},children:[{type:"text",value:"",name:"",attributes:{},children:[]}]}],ut=$6t({grid:e?.grid,svgWidth:M,svgHeight:A});if(ut.defs&&nt.push(ut.defs),nt.push({name:"rect",type:"element",value:"",attributes:{class:"boundary",x:"0",y:"0",fill:e?.backgroundColor??"#000",width:M.toString(),height:A.toString(),"data-type":"pcb_background","data-pcb-layer":"global"},children:[]}),t&&nt.push(iRt(tt,a,c,l,u)),nt.push(...V),ut.rect&&nt.push(ut.rect),e?.showErrorsInTextOverlay){let Z=D_(n,"pcb_error_text_overlay");Z&&nt.push(Z)}let ht=dl(n),kt=fl,Mt={name:"svg",type:"element",attributes:{xmlns:"http://www.w3.org/2000/svg",width:M.toString(),height:A.toString(),...ht&&{"data-software-used-string":ht},...e?.includeVersion&&{"data-circuit-to-svg-version":kt}},value:"",children:nt.filter(Z=>Z!==null)};try{return(0,Dtt.stringify)(Mt)}catch(Z){throw console.error("Error stringifying SVG object:",Z),Z}function ot(Z,at,Et){if(!Z)return;let Ft=Y.parse(Z.x),Ot=Y.parse(Z.y);if(Ft===void 0||Ot===void 0)return;let Ce=Y.parse(at)??0,Se=Y.parse(Et)??0,Kt=Ce/2,le=Se/2;a=Math.min(a,Ft-Kt),c=Math.min(c,Ot-le),l=Math.max(l,Ft+Kt),u=Math.max(u,Ot+le),p=!0}function X(Z,at,Et){if(!Z)return;let Ft=Y.parse(Z.x),Ot=Y.parse(Z.y);if(Ft===void 0||Ot===void 0)return;let Ce=Y.parse(at)??0,Se=Y.parse(Et)??0,Kt=Ce/2,le=Se/2;f=Math.min(f,Ft-Kt),y=Math.min(y,Ot-le),g=Math.max(g,Ft+Kt),x=Math.max(x,Ot+le),p=!0,v=!0}function W(Z){let at=!1;for(let Et of Z){let Ft=Y.parse(Et.x),Ot=Y.parse(Et.y);Ft===void 0||Ot===void 0||(a=Math.min(a,Ft),c=Math.min(c,Ot),l=Math.max(l,Ft),u=Math.max(u,Ot),at=!0)}at&&(p=!0)}function rt(Z){let at=!1;for(let Et of Z){let Ft=Y.parse(Et.x),Ot=Y.parse(Et.y);Ft===void 0||Ot===void 0||(f=Math.min(f,Ft),y=Math.min(y,Ot),g=Math.max(g,Ft),x=Math.max(x,Ot),at=!0)}at&&(p=!0,v=!0)}function pt(Z){let at=!1;for(let Et of Z){let Ft=Y.parse(Et?.x),Ot=Y.parse(Et?.y);Ft===void 0||Ot===void 0||(a=Math.min(a,Ft),c=Math.min(c,Ot),l=Math.max(l,Ft),u=Math.max(u,Ot),at=!0)}at&&(p=!0)}function yt(Z){if(Z.type==="pcb_silkscreen_text")ot(Z.anchor_position,0,0);else if(Z.type==="pcb_silkscreen_path")pt(Z.route);else if(Z.type==="pcb_silkscreen_rect")ot(Z.center,Z.width,Z.height);else if(Z.type==="pcb_silkscreen_circle"){let at=Y.parse(Z.radius);at!==void 0&&ot(Z.center,at*2,at*2)}else if(Z.type==="pcb_silkscreen_line")ot({x:Z.x1,y:Z.y1},0,0),ot({x:Z.x2,y:Z.y2},0,0);else if(Z.type==="pcb_cutout"){let at=Z;if(at.shape==="rect")ot(at.center,at.width,at.height);else if(at.shape==="circle"){let Et=Y.parse(at.radius);Et!==void 0&&ot(at.center,Et*2,Et*2)}else at.shape==="polygon"&&pt(at.points)}}}function nRt({elm:n,circuitJson:e,ctx:t}){switch(n.type){case"pcb_trace_error":return J9t(n,e,t).filter(Boolean);case"pcb_footprint_overlap_error":return e6t(n,e,t).filter(Boolean);case"pcb_component":return W6t(n,t).filter(Boolean);case"pcb_trace":return E6t(n,t);case"pcb_copper_pour":return F6t(n,t);case"pcb_plated_hole":return g6t(n,t).filter(Boolean);case"pcb_hole":return N6t(n,t);case"pcb_smtpad":return M6t(n,t);case"pcb_silkscreen_text":return b6t(n,t);case"pcb_silkscreen_rect":return v6t(n,t);case"pcb_silkscreen_circle":return S6t(n,t);case"pcb_silkscreen_line":return w6t(n,t);case"pcb_courtyard_rect":return t.showCourtyards?P6t(n,t):[];case"pcb_fabrication_note_path":return n6t(n,t);case"pcb_fabrication_note_text":return i6t(n,t);case"pcb_fabrication_note_rect":return o6t(n,t);case"pcb_fabrication_note_dimension":return a6t(n,t);case"pcb_note_dimension":return c6t(n,t);case"pcb_note_text":return u6t(n,t);case"pcb_note_rect":return d6t(n,t);case"pcb_note_path":return m6t(n,t);case"pcb_note_line":return y6t(n,t);case"pcb_silkscreen_path":return x6t(n,t);case"pcb_panel":return t.drawPaddingOutsideBoard?C6t(n,t):[];case"pcb_board":return t.drawPaddingOutsideBoard?jtt(n,t):[];case"pcb_via":return I6t(n,t);case"pcb_cutout":return L6t(n,t);case"pcb_group":return t.showPcbGroups?K6t(n,t):[];default:return[]}}function iRt(n,e,t,i,r){let[s,o]=st(n,[e,t]),[a,c]=st(n,[i,r]),l=Math.abs(a-s),u=Math.abs(c-o),p=Math.min(s,a),f=Math.min(o,c);return{name:"rect",type:"element",value:"",children:[],attributes:{class:"pcb-boundary",fill:"none",stroke:"#fff","stroke-width":"0.3",x:p.toString(),y:f.toString(),width:l.toString(),height:u.toString(),"data-type":"pcb_boundary","data-pcb-layer":"global"}}}function sRt(n,e,t={}){let{width:i,height:r,center:s,outline:o}=n,a;if(o&&Array.isArray(o)&&o.length>=3)a=o.map((c,l)=>{let[u,p]=st(e,[c.x,c.y]);return l===0?`M ${u} ${p}`:`L ${u} ${p}`}).join(" ");else{let c=i/2,l=r/2,u=st(e,[s.x-c,s.y-l]),p=st(e,[s.x+c,s.y-l]),f=st(e,[s.x+c,s.y+l]),y=st(e,[s.x-c,s.y+l]);a=`M ${u[0]} ${u[1]} L ${p[0]} ${p[1]} L ${f[0]} ${f[1]} L ${y[0]} ${y[1]}`}return a+=" Z",[{name:"path",type:"element",value:"",children:[],attributes:{class:"pcb-board",d:a,fill:t.fill??Bw.fill,stroke:t.stroke??Bw.stroke,"stroke-opacity":t.strokeOpacity??Bw.strokeOpacity,"stroke-width":((t.strokeWidthFactor??Bw.strokeWidthFactor)*Math.abs(e.a)).toString()}}]}function aRt(n,e){let{elm:t,portPosition:i,name:r,arePinsInterchangeable:s}=n,{transform:o}=e,{center:a,width:c,height:l,rotation:u=0,layer:p="top"}=t;if(!a||typeof c!="number"||typeof l!="number")return null;let[f,y]=st(o,[a.x,a.y]),[g,x]=st(o,[i.x,i.y]),v=c*Math.abs(o.a),P=l*Math.abs(o.d),w=p==="top",k=x>y,T=g<f,I=[cRt(v,P,u,p),lRt(v,P,r??"",o)];return s||I.push(uRt(v,P,u,p,k,T)),{name:"g",type:"element",value:"",attributes:{transform:`translate(${f}, ${y}) scale(1, -1)`},children:I}}function cRt(n,e,t,i){let r=n/2,s=e/2;return{name:"path",type:"element",attributes:{class:"assembly-component",d:pRt(r,s,t),"stroke-width":.8.toFixed(2),transform:`rotate(${-t})`,"stroke-dasharray":i==="bottom"?"2,2":""},value:"",children:[]}}function lRt(n,e,t,i){let r=Math.min(n,e),c=Math.min(58,Math.max(3,r*.8)),l=e>n;return{name:"text",type:"element",attributes:{x:"0",y:"0",class:"assembly-component-label","text-anchor":"middle",dy:".10em",style:"pointer-events: none","font-size":`${c.toFixed(1)}px`,transform:l?"rotate(90) scale(1, -1)":"scale(1, -1)"},children:[{type:"text",value:t||"",name:"",attributes:{},children:[]}],value:""}}function uRt(n,e,t,i,r,s){let o=n/2,a=e/2,c=Math.min(o,a)*.5,l;return r&&s?l=[[-o,-a],[-o+c,-a],[-o,-a+c]]:r&&!s?l=[[o,-a],[o-c,-a],[o,-a+c]]:!r&&s?l=[[-o,a],[-o+c,a],[-o,a-c]]:l=[[o,a],[o-c,a],[o,a-c]],{name:"polygon",type:"element",attributes:{class:"assembly-pin1-indicator",points:l.map(p=>p.join(",")).join(" "),fill:"#333",stroke:"none",transform:`rotate(${-t})`},value:"",children:[]}}function pRt(n,e,t){let i=(a,c,l)=>{let u=Math.PI/180*l,p=Math.cos(u),f=Math.sin(u);return[a*p-c*f,a*f+c*p]};return`${[[-n,-e],[n,-e],[n,e],[-n,e]].map(([a,c])=>i(a,c,t)).map(([a,c],l)=>l===0?`M${a},${c}`:`L${a},${c}`).join(" ")} Z`}function hRt(n,e){let{transform:t}=e,[i,r]=st(t,[n.x,n.y]);if(n.hole_shape==="circle"||n.hole_shape==="square"){let s=n.hole_diameter*Math.abs(t.a),o=s/2;return n.hole_shape==="circle"?[{name:"circle",type:"element",attributes:{class:"assembly-hole",cx:i.toString(),cy:r.toString(),r:o.toString(),fill:$A},children:[],value:""}]:[{name:"rect",type:"element",attributes:{class:"assembly-hole",x:(i-o).toString(),y:(r-o).toString(),width:s.toString(),height:s.toString(),fill:$A},children:[],value:""}]}if(n.hole_shape==="oval"){let s=n.hole_width*Math.abs(t.a),o=n.hole_height*Math.abs(t.a),a=s/2,c=o/2;return[{name:"ellipse",type:"element",attributes:{class:"assembly-hole",cx:i.toString(),cy:r.toString(),rx:a.toString(),ry:c.toString(),fill:$A},children:[],value:""}]}return[]}function dRt(n,e){let{transform:t}=e,[i,r]=st(t,[n.x,n.y]);if(n.shape==="pill"){let s=n.outer_width*Math.abs(t.a),o=n.outer_height*Math.abs(t.a),a=n.hole_width*Math.abs(t.a),c=n.hole_height*Math.abs(t.a),l=s/2,u=o-s,p=a/2;return[{name:"g",type:"element",children:[{name:"path",type:"element",attributes:{class:"assembly-hole-outer",fill:M1,d:`M${i-l},${r-u/2} v${u} a${l},${l} 0 0 0 ${s},0 v-${u} a${l},${l} 0 0 0 -${s},0 z`},value:"",children:[]},{name:"path",type:"element",attributes:{class:"assembly-hole-inner",fill:C1,d:`M${i-p},${r-(c-a)/2} v${c-a} a${p},${p} 0 0 0 ${a},0 v-${c-a} a${p},${p} 0 0 0 -${a},0 z`},value:"",children:[]}],value:"",attributes:{}}]}if(n.shape==="circle"){let s=n.outer_diameter*Math.abs(t.a),o=n.outer_diameter*Math.abs(t.a),a=n.hole_diameter*Math.abs(t.a),c=n.hole_diameter*Math.abs(t.a),l=Math.min(s,o)/2,u=Math.min(a,c)/2;return[{name:"g",type:"element",children:[{name:"circle",type:"element",attributes:{class:"assembly-hole-outer",fill:M1,cx:i.toString(),cy:r.toString(),r:l.toString()},value:"",children:[]},{name:"circle",type:"element",attributes:{class:"assembly-hole-inner",fill:C1,cx:i.toString(),cy:r.toString(),r:u.toString()},value:"",children:[]}],value:"",attributes:{}}]}if(n.shape==="circular_hole_with_rect_pad"){let s=n,o=s.hole_diameter*Math.abs(t.a),a=s.rect_pad_width*Math.abs(t.a),c=s.rect_pad_height*Math.abs(t.a),l=(s.rect_border_radius??0)*Math.abs(t.a),u=o/2,[p,f]=st(t,[s.x+s.hole_offset_x,s.y+s.hole_offset_y]);return[{name:"g",type:"element",children:[{name:"rect",type:"element",attributes:{class:"assembly-hole-outer-pad",fill:M1,x:(i-a/2).toString(),y:(r-c/2).toString(),width:a.toString(),height:c.toString(),...l?{rx:l.toString(),ry:l.toString()}:{}},value:"",children:[]},{name:"circle",type:"element",attributes:{class:"assembly-hole-inner",fill:C1,cx:p.toString(),cy:f.toString(),r:u.toString()},value:"",children:[]}],value:"",attributes:{}}]}if(n.shape==="pill_hole_with_rect_pad"){let s=n,o=s.rect_pad_width*Math.abs(t.a),a=s.rect_pad_height*Math.abs(t.a),c=(s.rect_border_radius??0)*Math.abs(t.a),l=s.hole_height*Math.abs(t.a),u=s.hole_width*Math.abs(t.a),p=s,f=p.hole_offset_x??0,y=p.hole_offset_y??0,[g,x]=st(t,[s.x+f,s.y+y]),v=Math.min(l,u)/2;return[{name:"g",type:"element",children:[{name:"rect",type:"element",attributes:{class:"assembly-hole-outer-pad",fill:M1,x:(i-o/2).toString(),y:(r-a/2).toString(),width:o.toString(),height:a.toString(),...c?{rx:c.toString(),ry:c.toString()}:{}},value:"",children:[]},{name:"rect",type:"element",attributes:{class:"assembly-hole-inner",fill:C1,x:(g-u/2).toString(),y:(x-l/2).toString(),width:u.toString(),height:l.toString(),rx:v.toString(),ry:v.toString()},value:"",children:[]}],value:"",attributes:{}}]}if(n.shape==="rotated_pill_hole_with_rect_pad"){let s=n,o=s.rect_pad_width*Math.abs(t.a),a=s.rect_pad_height*Math.abs(t.a),c=(s.rect_border_radius??0)*Math.abs(t.a),l=s.hole_height*Math.abs(t.a),u=s.hole_width*Math.abs(t.a),p=s,f=p.hole_offset_x??0,y=p.hole_offset_y??0,[g,x]=st(t,[s.x+f,s.y+y]),v=Math.min(l,u)/2;return[{name:"g",type:"element",children:[{name:"rect",type:"element",attributes:{class:"assembly-hole-outer-pad",fill:M1,x:(-o/2).toString(),y:(-a/2).toString(),width:o.toString(),height:a.toString(),transform:`translate(${i} ${r}) rotate(${-s.rect_ccw_rotation})`,...c?{rx:c.toString(),ry:c.toString()}:{}},value:"",children:[]},{name:"rect",type:"element",attributes:{class:"assembly-hole-inner",fill:C1,x:(-u/2).toString(),y:(-l/2).toString(),width:u.toString(),height:l.toString(),rx:v.toString(),ry:v.toString(),transform:`translate(${g} ${x}) rotate(${-s.hole_ccw_rotation})`},value:"",children:[]}],value:"",attributes:{}}]}return[]}function fRt(n,e){let{transform:t}=e;if(n.shape==="rect"||n.shape==="rotated_rect"){let i=n.width*Math.abs(t.a),r=n.height*Math.abs(t.d),[s,o]=st(t,[n.x,n.y]),a=(n.rect_border_radius??0)*Math.abs(t.a);return n.shape==="rotated_rect"&&n.ccw_rotation?[{name:"rect",type:"element",attributes:{class:"assembly-pad",fill:I1,x:(-i/2).toString(),y:(-r/2).toString(),width:i.toString(),height:r.toString(),transform:`translate(${s} ${o}) rotate(${-n.ccw_rotation})`,"data-layer":n.layer,...a?{rx:a.toString(),ry:a.toString()}:{}},value:"",children:[]}]:[{name:"rect",type:"element",attributes:{class:"assembly-pad",fill:I1,x:(s-i/2).toString(),y:(o-r/2).toString(),width:i.toString(),height:r.toString(),"data-layer":n.layer,...a?{rx:a.toString(),ry:a.toString()}:{}},value:"",children:[]}]}if(n.shape==="pill"){let i=n.width*Math.abs(t.a),r=n.height*Math.abs(t.d),s=n.radius*Math.abs(t.a),[o,a]=st(t,[n.x,n.y]);return[{name:"rect",type:"element",attributes:{class:"assembly-pad",fill:I1,x:(o-i/2).toString(),y:(a-r/2).toString(),width:i.toString(),height:r.toString(),rx:s.toString(),ry:s.toString(),"data-layer":n.layer},value:"",children:[]}]}if(n.shape==="circle"){let i=n.radius*Math.abs(t.a),[r,s]=st(t,[n.x,n.y]);return[{name:"circle",type:"element",attributes:{class:"assembly-pad",fill:I1,cx:r.toString(),cy:s.toString(),r:i.toString(),"data-layer":n.layer},value:"",children:[]}]}if(n.shape==="polygon"){let i=(n.points??[]).map(r=>st(t,[r.x,r.y]));return[{name:"polygon",type:"element",attributes:{class:"assembly-pad",fill:I1,points:i.map(r=>r.join(",")).join(" "),"data-layer":n.layer},value:"",children:[]}]}return[]}function mRt(n,e){let t=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,s=Number.NEGATIVE_INFINITY;for(let N of n)if(N.type==="pcb_board"){let M=N.center,A=N.width||0,R=N.height||0;t=Math.min(t,M.x-A/2),i=Math.min(i,M.y-R/2),r=Math.max(r,M.x+A/2),s=Math.max(s,M.y+R/2)}let o=1,a=r-t+2*o,c=s-i+2*o,l=e?.width??800,u=e?.height??600,p=l/a,f=u/c,y=Math.min(p,f),g=(l-a*y)/2,x=(u-c*y)/2,v=Fe(yn(g-t*y+o*y,u-x+i*y-o*y),Ei(y,-y)),P={transform:v},w=n.sort((N,M)=>(Ptt.indexOf(M.type)??9999)-(Ptt.indexOf(N.type)??9999)).flatMap(N=>_Rt(N,P,n)),k=dl(n),T=fl,I=[{name:"style",type:"element",children:[{type:"text",value:`
              .assembly-component { 
                fill: none; 
                stroke: #000; 
              }
              .assembly-board { 
                fill: #f2f2f2; 
                stroke: rgb(0,0,0); 
                stroke-opacity: 0.8;
              }
              .assembly-component-label { 
                fill: #000; 
                font-family: Arial, serif;
                font-weight: bold;
                dominant-baseline: middle;
                text-anchor: middle;
              }
              .assembly-boundary { 
                fill: none; 
                stroke: #fff;
                stroke-width: 0.2; 
              }
            `,name:"",attributes:{},children:[]}],value:"",attributes:{}},{name:"rect",type:"element",attributes:{fill:"#fff",x:"0",y:"0",width:l.toString(),height:u.toString()},value:"",children:[]},yRt(v,t,i,r,s),...w].filter(N=>N!==null);if(e?.showErrorsInTextOverlay){let N=D_(n);N&&I.push(N)}let E={name:"svg",type:"element",attributes:{xmlns:"http://www.w3.org/2000/svg",width:l.toString(),height:u.toString(),...k&&{"data-software-used-string":k},...e?.includeVersion&&{"data-circuit-to-svg-version":T}},value:"",children:I};return(0,Xtt.stringify)(E)}function _Rt(n,e,t){let i=Me(t).source_component.list();switch(n.type){case"pcb_board":return sRt(n,e.transform);case"pcb_component":{let r=i.find(a=>a.source_component_id===n.source_component_id),o=Me(t).pcb_port.list().filter(a=>a.pcb_component_id===n.pcb_component_id)[0];if(r&&o){let a=r.are_pins_interchangeable,c=aRt({elm:n,portPosition:{x:o.x,y:o.y},name:r.name,arePinsInterchangeable:a},e);return c?[c]:[]}return[]}case"pcb_smtpad":return fRt(n,e);case"pcb_hole":return hRt(n,e);case"pcb_plated_hole":return dRt(n,e);default:return[]}}function yRt(n,e,t,i,r){let[s,o]=st(n,[e,t]),[a,c]=st(n,[i,r]),l=Math.abs(a-s),u=Math.abs(c-o),p=Math.min(s,a),f=Math.min(o,c);return{name:"rect",type:"element",value:"",children:[],attributes:{class:"assembly-boundary",x:p.toString(),y:f.toString(),width:l.toString(),height:u.toString()}}}function bRt(n,e){let{transform:t,soup:i}=e,{width:r,height:s,center:o,outline:a}=n,l=i.find(y=>y.type==="source_board"&&y.title)?.title,u;if(a&&Array.isArray(a)&&a.length>=3)u=a.map((y,g)=>{let[x,v]=st(t,[y.x,y.y]);return g===0?`M ${x} ${v}`:`L ${x} ${v}`}).join(" ");else{let y=r/2,g=s/2,x=st(t,[o.x-y,o.y-g]),v=st(t,[o.x+y,o.y-g]),P=st(t,[o.x+y,o.y+g]),w=st(t,[o.x-y,o.y+g]);u=`M ${x[0]} ${x[1]} L ${v[0]} ${v[1]} L ${P[0]} ${P[1]} L ${w[0]} ${w[1]}`}u+=" Z";let p=Me(i).pcb_cutout.list();for(let y of p)if(y.shape==="rect"){let{x:g,y:x,width:v,height:P}=y.center?(()=>{let{x:M,y:A}=y.center,{width:R,height:j}=y;return{x:M,y:A,width:R,height:j}})():{x:0,y:0,width:0,height:0},w=v/2,k=P/2,[T,I,E,N]=[st(t,[g-w,x-k]),st(t,[g+w,x-k]),st(t,[g+w,x+k]),st(t,[g-w,x+k])];u+=` M ${T[0]} ${T[1]} L ${I[0]} ${I[1]} L ${E[0]} ${E[1]} L ${N[0]} ${N[1]} Z`}else y.shape;let f=[{name:"path",type:"element",value:"",children:[],attributes:{class:"pinout-board",d:u,fill:gRt,stroke:xRt,"fill-rule":"evenodd","stroke-opacity":"0.8","stroke-width":(.2*Math.abs(t.a)).toString()}}];if(l){let y=e.svgWidth/2;f.push({name:"text",type:"element",value:"",children:[{name:"",type:"text",value:l,attributes:{},children:[]}],attributes:{x:y.toString(),y:30 .toString(),"text-anchor":"middle","font-size":"18px","font-weight":"bold","font-family":"Arial, sans-serif",fill:"black",class:"pinout-board-title"}})}return f}function wRt(n,e){let{transform:t,soup:i}=e,{center:r,width:s,height:o,rotation:a=0,source_component_id:c}=n,l=Me(i).source_component.get(c);if(!r||typeof s!="number"||typeof o!="number"||s===0||o===0)return[];let[u,p]=st(t,[r.x,r.y]),f=s*Math.abs(t.a),y=o*Math.abs(t.d),g=`translate(${u}, ${p})`,x=[{name:"rect",type:"element",attributes:{class:"pinout-component-box",x:(-f/2).toString(),y:(-y/2).toString(),width:f.toString(),height:y.toString(),fill:vRt,transform:`rotate(${a}deg)`},value:"",children:[]}];if(l?.name){let v=Math.min(f,y)*.4;x.push({name:"text",type:"element",attributes:{x:"0",y:"0",fill:SRt,"font-size":`${v}px`,"font-family":"sans-serif","text-anchor":"middle","dominant-baseline":"middle"},children:[{type:"text",value:l.name,name:"",attributes:{},children:[]}],value:""})}return[{name:"g",type:"element",attributes:{transform:g},children:x,value:""}]}function PRt(n,e){let{transform:t}=e,[i,r]=st(t,[n.x,n.y]);if(n.hole_shape==="circle"||n.hole_shape==="square"){let s=n.hole_diameter*Math.abs(t.a),o=s/2;return n.hole_shape==="circle"?[{name:"circle",type:"element",attributes:{class:"pinout-hole",cx:i.toString(),cy:r.toString(),r:o.toString(),fill:DA},children:[],value:""}]:[{name:"rect",type:"element",attributes:{class:"pinout-hole",x:(i-o).toString(),y:(r-o).toString(),width:s.toString(),height:s.toString(),fill:DA},children:[],value:""}]}if(n.hole_shape==="oval"){let s=n.hole_width*Math.abs(t.a),o=n.hole_height*Math.abs(t.a),a=s/2,c=o/2;return[{name:"ellipse",type:"element",attributes:{class:"pinout-hole",cx:i.toString(),cy:r.toString(),rx:a.toString(),ry:c.toString(),fill:DA},children:[],value:""}]}return[]}function kRt(n,e){let{transform:t}=e,[i,r]=st(t,[n.x,n.y]);if(n.shape==="pill"){let s=n.outer_width*Math.abs(t.a),o=n.outer_height*Math.abs(t.a),a=n.hole_width*Math.abs(t.a),c=n.hole_height*Math.abs(t.a),l=s/2,u=o-s,p=a/2;return[{name:"g",type:"element",children:[{name:"path",type:"element",attributes:{class:"pinout-hole-outer",fill:N1,d:`M${i-l},${r-u/2} v${u} a${l},${l} 0 0 0 ${s},0 v-${u} a${l},${l} 0 0 0 -${s},0 z`},value:"",children:[]},{name:"path",type:"element",attributes:{class:"pinout-hole-inner",fill:A1,d:`M${i-p},${r-(c-a)/2} v${c-a} a${p},${p} 0 0 0 ${a},0 v-${c-a} a${p},${p} 0 0 0 -${a},0 z`},value:"",children:[]}],value:"",attributes:{}}]}if(n.shape==="circle"){let s=n.outer_diameter*Math.abs(t.a),o=n.outer_diameter*Math.abs(t.a),a=n.hole_diameter*Math.abs(t.a),c=n.hole_diameter*Math.abs(t.a),l=Math.min(s,o)/2,u=Math.min(a,c)/2;return[{name:"g",type:"element",children:[{name:"circle",type:"element",attributes:{class:"pinout-hole-outer",fill:N1,cx:i.toString(),cy:r.toString(),r:l.toString()},value:"",children:[]},{name:"circle",type:"element",attributes:{class:"pinout-hole-inner",fill:A1,cx:i.toString(),cy:r.toString(),r:u.toString()},value:"",children:[]}],value:"",attributes:{}}]}if(n.shape==="circular_hole_with_rect_pad"){let s=n.hole_diameter*Math.abs(t.a),o=n.rect_pad_width*Math.abs(t.a),a=n.rect_pad_height*Math.abs(t.a),c=s/2;return[{name:"g",type:"element",children:[{name:"rect",type:"element",attributes:{class:"pinout-hole-outer-pad",fill:N1,x:(i-o/2).toString(),y:(r-a/2).toString(),width:o.toString(),height:a.toString()},value:"",children:[]},{name:"circle",type:"element",attributes:{class:"pinout-hole-inner",fill:A1,cx:i.toString(),cy:r.toString(),r:c.toString()},value:"",children:[]}],value:"",attributes:{}}]}if(n.shape==="pill_hole_with_rect_pad"){let s=n.rect_pad_width*Math.abs(t.a),o=n.rect_pad_height*Math.abs(t.a),a=n.hole_height*Math.abs(t.a),c=n.hole_width*Math.abs(t.a),l=Math.min(a,c)/2;return[{name:"g",type:"element",children:[{name:"rect",type:"element",attributes:{class:"pinout-hole-outer-pad",fill:N1,x:(i-s/2).toString(),y:(r-o/2).toString(),width:s.toString(),height:o.toString()},value:"",children:[]},{name:"rect",type:"element",attributes:{class:"pinout-hole-inner",fill:A1,x:(i-c/2).toString(),y:(r-a/2).toString(),width:c.toString(),height:a.toString(),rx:l.toString(),ry:l.toString()},value:"",children:[]}],value:"",attributes:{}}]}if(n.shape==="rotated_pill_hole_with_rect_pad"){let s=n.rect_pad_width*Math.abs(t.a),o=n.rect_pad_height*Math.abs(t.a),a=n.hole_height*Math.abs(t.a),c=n.hole_width*Math.abs(t.a),l=Math.min(a,c)/2;return[{name:"g",type:"element",children:[{name:"rect",type:"element",attributes:{class:"pinout-hole-outer-pad",fill:N1,x:(-s/2).toString(),y:(-o/2).toString(),width:s.toString(),height:o.toString(),transform:`translate(${i} ${r}) rotate(${-n.rect_ccw_rotation})`},value:"",children:[]},{name:"rect",type:"element",attributes:{class:"pinout-hole-inner",fill:A1,x:(-c/2).toString(),y:(-a/2).toString(),width:c.toString(),height:a.toString(),rx:l.toString(),ry:l.toString(),transform:`translate(${i} ${r}) rotate(${-n.hole_ccw_rotation})`},value:"",children:[]}],value:"",attributes:{}}]}return[]}function TRt(n,e){let{transform:t}=e;if(n.shape==="rect"||n.shape==="rotated_rect"){let i=n.width*Math.abs(t.a),r=n.height*Math.abs(t.d),[s,o]=st(t,[n.x,n.y]);return n.shape==="rotated_rect"&&n.ccw_rotation?[{name:"rect",type:"element",attributes:{class:"pinout-pad",fill:R1,x:(-i/2).toString(),y:(-r/2).toString(),width:i.toString(),height:r.toString(),transform:`translate(${s} ${o}) rotate(${-n.ccw_rotation})`,"data-layer":n.layer},value:"",children:[]}]:[{name:"rect",type:"element",attributes:{class:"pinout-pad",fill:R1,x:(s-i/2).toString(),y:(o-r/2).toString(),width:i.toString(),height:r.toString(),"data-layer":n.layer},value:"",children:[]}]}if(n.shape==="pill"){let i=n.width*Math.abs(t.a),r=n.height*Math.abs(t.d),s=n.radius*Math.abs(t.a),[o,a]=st(t,[n.x,n.y]);return[{name:"rect",type:"element",attributes:{class:"pinout-pad",fill:R1,x:(o-i/2).toString(),y:(a-r/2).toString(),width:i.toString(),height:r.toString(),rx:s.toString(),ry:s.toString(),"data-layer":n.layer},value:"",children:[]}]}if(n.shape==="circle"){let i=n.radius*Math.abs(t.a),[r,s]=st(t,[n.x,n.y]);return[{name:"circle",type:"element",attributes:{class:"pinout-pad",fill:R1,cx:r.toString(),cy:s.toString(),r:i.toString(),"data-layer":n.layer},value:"",children:[]}]}if(n.shape==="polygon"){let i=(n.points??[]).map(r=>st(t,[r.x,r.y]));return[{name:"polygon",type:"element",attributes:{class:"pinout-pad",fill:R1,points:i.map(r=>r.join(",")).join(" "),"data-layer":n.layer},value:"",children:[]}]}return[]}function jA(n){let{rectX:e,rectY:t,rectWidth:i,rectHeight:r,textX:s,textY:o,text:a,fontSize:c,labelBackground:l,labelColor:u,rx:p=4,ry:f=4,fontFamily:y="Arial, sans-serif",fontWeight:g="bold",textAnchor:x="middle",dominantBaseline:v="middle"}=n;return[{name:"rect",type:"element",attributes:{x:e.toString(),y:t.toString(),width:i.toString(),height:r.toString(),fill:l,rx:typeof p=="number"?p.toString():p,ry:typeof f=="number"?f.toString():f,stroke:"none"},children:[],value:""},{name:"text",type:"element",attributes:{x:s.toString(),y:o.toString(),fill:u,"font-size":`${c}px`,"font-family":y,"font-weight":g,"text-anchor":x,"dominant-baseline":v},children:[{type:"text",value:a,name:"",attributes:{},children:[]}],value:""}]}function IRt(n,e){let t=e.label_positions.get(n.pcb_port_id);if(!t)return[];let{text:i,aliases:r,elbow_end:s,label_pos:o,edge:a}=t,[c,l]=st(e.transform,[n.x,n.y]),u=a==="left"?"x-":a==="right"?"x+":a==="top"?"y-":"y+",p=a==="left"?"x+":a==="right"?"x-":a==="top"?"y+":"y-",f=Wc({x:c,y:l,facingDirection:u},{x:s.x,y:s.y,facingDirection:p},{}),y=/^pin(\d+)$/i.exec(i),g=[{text:y?y[1]:i,bg:y?MRt:Ttt,color:y?CRt:ktt},...r.map(H=>({text:H,bg:Ttt,color:ktt}))],x=Math.abs(e.transform.a),v=e.styleScale??1,w=1.6*v*x,k=Math.max(.08,.25*v),I=.3*v*x,E=k*x,N={x:o.x+(a==="left"?-E/2:E/2),y:o.y},M=[...f,N].map(H=>`${H.x},${H.y}`).join(" "),A=w*(11/21),R=(w-A)/2,j=R,B=g.map(({text:H,bg:tt,color:et})=>{let mt=H??"",J=mt.length*A*.6+2*R;return{text:mt,rectWidth:J,bg:tt,color:et}}),G=o.y,U=[{name:"polyline",type:"element",attributes:{points:M,stroke:ERt,"stroke-width":(k*x).toString(),fill:"none"},children:[],value:""}];if(a==="left"){let H=o.x;for(let{text:tt,rectWidth:et,bg:mt,color:V}of B){let J=H-et,nt=J+et/2;U.push(...jA({rectX:J,rectY:G-w/2,rectWidth:et,rectHeight:w,textX:nt,textY:G,text:tt,fontSize:A,labelBackground:mt,labelColor:V,rx:I,ry:I})),H=J-j}}else if(a==="right"){let H=o.x;for(let{text:tt,rectWidth:et,bg:mt,color:V}of B){let J=H,nt=J+et/2;U.push(...jA({rectX:J,rectY:G-w/2,rectWidth:et,rectHeight:w,textX:nt,textY:G,text:tt,fontSize:A,labelBackground:mt,labelColor:V,rx:I,ry:I})),H=J+et+j}}else{let H=B.reduce((et,mt)=>et+mt.rectWidth,0)+j*Math.max(0,B.length-1),tt=o.x-H/2;for(let{text:et,rectWidth:mt,bg:V,color:J}of B){let nt=tt,ut=nt+mt/2;U.push(...jA({rectX:nt,rectY:G-w/2,rectWidth:mt,rectHeight:w,textX:ut,textY:G,text:et,fontSize:A,labelBackground:V,labelColor:J,rx:I,ry:I})),tt=nt+mt+j}}return U}function Ett(n,e,{transform:t,soup:i,board_bounds:r,svgHeight:s,styleScale:o},a){let c=e.map(U=>U.pcb_port.x),l={};for(let U of c){let H=U.toFixed(1);l[H]=(l[H]||0)+1}let u;if(Object.keys(l).length>1&&e.length>2){let U=Object.entries(l).sort((ut,ht)=>ht[1]-ut[1]),H=parseFloat(U[0][0]),tt=e.filter(ut=>Math.abs(ut.pcb_port.x-H)<.2),et=e.filter(ut=>Math.abs(ut.pcb_port.x-H)>=.2),mt=ut=>({pcb_port:ut.pcb_port,y:st(t,[ut.pcb_port.x,ut.pcb_port.y])[1],aliases:ut.aliases});tt.sort((ut,ht)=>ht.pcb_port.y-ut.pcb_port.y),et.sort((ut,ht)=>ht.pcb_port.y-ut.pcb_port.y);let V=tt.length>0?Math.max(...tt.map(ut=>ut.pcb_port.y)):-1/0;u=((et.length>0?Math.max(...et.map(ut=>ut.pcb_port.y)):-1/0)>V?[...et,...tt]:[...tt,...et]).map(mt)}else u=e.map(U=>({pcb_port:U.pcb_port,y:st(t,[U.pcb_port.x,U.pcb_port.y])[1],aliases:U.aliases})).sort((U,H)=>U.y-H.y);if(u.length===0)return;let p=st(t,[n==="left"?r.minX:r.maxX,0])[0],f=u.length,y={};for(let U of e){let H=U.pcb_port.x.toFixed(1);y[H]=(y[H]||0)+1}let g=new Set;if(Object.keys(y).length>1&&e.length>2){let U=Object.entries(y).sort((et,mt)=>mt[1]-et[1]),H=parseFloat(U[0][0]),tt=e.filter(et=>Math.abs(et.pcb_port.x-H)<.2);g=new Set(tt.map(et=>et.pcb_port.pcb_port_id))}let x=u.map((U,H)=>g.has(U.pcb_port.pcb_port_id)?H:-1).filter(U=>U!==-1),v=(f-1)/2,P=Math.abs(t.a),w=Vtt*o*P,T=Math.max(.2*P,.3*o*P),I=RRt*o*P,E=(Gtt+f*Htt)*o*P,M=E+v*(YA*o*P)+Wtt*o*P,A=f-x.length,R=x.length===0?f:A,j=R*w+Math.max(0,R-1)*T,B;if(x.length>0&&A>0){let U=x.map(nt=>u[nt].y),H=Math.min(...U),tt=Math.max(...U),et=H-w/2,mt=tt+w/2;u.map((nt,ut)=>ut).filter(nt=>!x.includes(nt))[0]<x[0]?B=et-(T*2+I)-j+w/2:B=mt+(T*2+I)+w/2}else B=(s-j)/2+w/2;let G=x.length===f;u.forEach(({pcb_port:U,aliases:H},tt)=>{let et;if(x.length>0)if(x.includes(tt))et=v;else{let kt=Math.min(...x),Mt=Math.max(...x),ot;tt<kt?ot=kt-tt:ot=tt-Mt,et=v-ot}else{let kt=Math.abs(tt-v);et=v-kt}let mt=E+et*(YA*o*P),V=n==="left"?-1:1,J=x.includes(tt),nt=G||x.length>0&&J?u[tt].y:B,ut={x:p+V*mt,y:nt},ht={x:p+V*M,y:nt};a.set(U.pcb_port_id,{text:H[0],aliases:H.slice(1),elbow_end:ut,label_pos:ht,edge:n}),x.length>0&&J||(B+=w+T)})}function LRt(n,e){let t=Me(e).source_port.get(n.source_port_id);if(!t)return null;let i=t.port_hints?.filter(o=>!/^\d+$/.test(o)&&!["left","right","top","bottom"].includes(o))??[],r=i[0];if(r||(r=t.name),!r)return null;let s=i.filter(o=>o!==r);return{text:r,aliases:s}}function FRt(n,e){let t={left:n.x-e.minX,right:e.maxX-n.x,top:e.maxY-n.y,bottom:n.y-e.minY},i="left",r=t.left;return t.right<r&&(r=t.right,i="right"),t.top<r&&(r=t.top,i="top"),t.bottom<r&&(r=t.bottom,i="bottom"),i}function zRt(n,e){let t=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,s=Number.NEGATIVE_INFINITY;for(let Z of n)if(Z.type==="pcb_board")if("outline"in Z&&Z.outline&&Array.isArray(Z.outline)&&Z.outline.length>0)for(let at of Z.outline)t=Math.min(t,at.x),i=Math.min(i,at.y),r=Math.max(r,at.x),s=Math.max(s,at.y);else{let at=Z.center,Et=Z.width||0,Ft=Z.height||0;t=Math.min(t,at.x-Et/2),i=Math.min(i,at.y-Ft/2),r=Math.max(r,at.x+Et/2),s=Math.max(s,at.y+Ft/2)}let o=2,a=e?.width??1200,c=e?.height??768,l=n.find(Z=>Z.type==="source_board"&&!!Z.title)?.title,u={minX:t,minY:i,maxX:r,maxY:s},p=n.filter(Z=>Z.type==="pcb_port"&&Z.is_board_pinout),f=[];for(let Z of p){let at=LRt(Z,n);if(!at)continue;let Et=FRt({x:Z.x,y:Z.y},u);f.push({pcb_port:Z,aliases:[at.text,...at.aliases],edge:Et})}let y=f.filter(Z=>Z.edge==="left"),g=f.filter(Z=>Z.edge==="right"),x=f.filter(Z=>Z.edge==="top"),v=f.filter(Z=>Z.edge==="bottom"),P=(t+r)/2;x.length>0&&(x.filter(at=>at.pcb_port.x<P).length>x.length/2?y.push(...x):g.push(...x)),v.length>0&&(v.filter(at=>at.pcb_port.x<P).length>v.length/2?y.push(...v):g.push(...v));let k=n.filter(Z=>Z.type==="pcb_smtpad").map(Z=>{if(typeof Z.height=="number")return Z.height;if(typeof Z.radius=="number")return Z.radius*2}).filter(Z=>Number.isFinite(Z)),T=k.length?k.reduce((Z,at)=>Z+at,0)/k.length:void 0,E=T?Math.max(.5,Math.min(1,T/1)):1,N=Vtt*E;function M(Z){let at=[...Z.aliases??[]];if(at.length===0)return at;let Et=/^pin(\d+)$/i.exec(at[0]);return Et&&(at[0]=Et[1]),at}function A(Z){if(Z.length===0)return 0;let at=N,Et=at*NRt,Ft=(at-Et)/2,Ot=Ft;return Z.map(Kt=>(Kt??"").length*Et*ARt+2*Ft).reduce((Kt,le)=>Kt+le,0)+Ot*Math.max(0,Z.length-1)}function R(Z){if(Z<=0)return 0;let at=(Z-1)/2;return(Gtt+Z*Htt)*E+at*(YA*E)+Wtt*E}let j=Math.max(0,...y.map(Z=>A(M(Z)))),B=Math.max(0,...g.map(Z=>A(M(Z)))),G=R(y.length)+j,U=R(g.length)+B,H=t-G,et=r+U-H+2*o,mt=s-i+2*o,V=a/et,J=c/mt,nt=Math.min(V,J),ut=(a-et*nt)/2,ht=(c-mt*nt)/2,kt=Fe(yn(ut-H*nt+o*nt,c-ht+i*nt-o*nt),Ei(nt,-nt)),Mt=ORt({left_labels:y,right_labels:g,transform:kt,soup:n,board_bounds:u,svgWidth:a,svgHeight:c,styleScale:E}),ot={transform:kt,soup:n,board_bounds:u,styleScale:E,label_positions:Mt,svgWidth:a,svgHeight:c},X=n.sort((Z,at)=>(Mtt.indexOf(Z.type)??9999)-(Mtt.indexOf(at.type)??9999)).flatMap(Z=>$Rt(Z,ot,n)),W=dl(n),rt=fl,pt=[{name:"rect",type:"element",attributes:{fill:"rgb(255, 255, 255)",x:"0",y:"0",width:a.toString(),height:c.toString()},value:"",children:[]},...X].filter(Z=>Z!==null);if(e?.showErrorsInTextOverlay){let Z=D_(n);Z&&pt.push(Z)}let yt={name:"svg",type:"element",attributes:{xmlns:"http://www.w3.org/2000/svg",width:a.toString(),height:c.toString(),...W&&{"data-software-used-string":W},...e?.includeVersion&&{"data-circuit-to-svg-version":rt}},value:"",children:pt};return(0,Utt.stringify)(yt)}function $Rt(n,e,t){switch(n.type){case"pcb_board":return bRt(n,e);case"pcb_component":return wRt(n,e);case"pcb_smtpad":return TRt(n,e);case"pcb_hole":return PRt(n,e);case"pcb_plated_hole":return kRt(n,e);case"pcb_port":return n.is_board_pinout?IRt(n,e):[];default:return[]}}function DRt(n){let{minX:e,minY:t,maxX:i,maxY:r}=n.bounds,s=n.cellSize??1,o=n.labelCells??!1,a=[],c=(l,u)=>{let[p,f]=st(n.transform,[l,u]);return{x:p,y:f}};for(let l=Math.floor(e);l<=Math.ceil(i);l+=s){let u=c(l,t),p=c(l,r);a.push({name:"line",type:"element",attributes:{x1:u.x.toString(),y1:u.y.toString(),x2:p.x.toString(),y2:p.y.toString(),stroke:Mi.schematic.grid,"stroke-width":(.01*Math.abs(n.transform.a)).toString(),"stroke-opacity":"0.5"}})}for(let l=Math.floor(t);l<=Math.ceil(r);l+=s){let u=c(e,l),p=c(i,l);a.push({name:"line",type:"element",attributes:{x1:u.x.toString(),y1:u.y.toString(),x2:p.x.toString(),y2:p.y.toString(),stroke:Mi.schematic.grid,"stroke-width":(.01*Math.abs(n.transform.a)).toString(),"stroke-opacity":"0.5"}})}if(o){let l=(u,p)=>s<=.1?`${u.toFixed(1)},${p.toFixed(1)}`:`${u},${p}`;for(let u=Math.floor(e);u<=Math.ceil(i);u+=s)for(let p=Math.floor(t);p<=Math.ceil(r);p+=s){let f=c(u,p);a.push({name:"text",type:"element",attributes:{x:(f.x-2.5).toString(),y:(f.y-5).toString(),fill:Mi.schematic.grid,"font-size":(s/5*Math.abs(n.transform.a)).toString(),"fill-opacity":"0.5","text-anchor":"middle","dominant-baseline":"middle","font-family":"sans-serif"},children:[{type:"text",value:l(u,p),name:"",attributes:{},children:[]}]})}}return{name:"g",value:"",type:"element",attributes:{class:"grid"},children:a}}function jRt(n){let{points:e,transform:t}=n,i=[];for(let r of e){let[s,o]=st(t,[r.x-.1,r.y-.1]),[a,c]=st(t,[r.x+.1,r.y+.1]),[l,u]=st(t,[r.x-.1,r.y+.1]),[p,f]=st(t,[r.x+.1,r.y-.1]);i.push({name:"path",type:"element",attributes:{d:`M${s},${o} L${a},${c} M${l},${u} L${p},${f}`,stroke:Mi.schematic.grid,"stroke-width":(.02*Math.abs(t.a)).toString(),"stroke-opacity":"0.7"}});let[y,g]=st(t,[r.x+.15,r.y-.15]);i.push({name:"text",type:"element",attributes:{x:y.toString(),y:g.toString(),fill:Mi.schematic.grid,"font-size":(.1*Math.abs(t.a)).toString(),"fill-opacity":"0.7","text-anchor":"start","font-family":"sans-serif","dominant-baseline":"middle"},children:[{type:"text",value:r.label||`(${r.x},${r.y})`,name:"",attributes:{},children:[]}]})}return{name:"g",value:"",type:"element",attributes:{class:"labeled-points"},children:i}}function XRt(n){return{left:180,top:90,bottom:-90,right:0}[n]??0}function URt(n,e,t){let i=t+pl*2+z_*n.text.length+F_,r=j_(n.anchor_side);return n.anchor_position??{x:n.center.x-r.x*i*e/2,y:n.center.y-r.y*i*e/2}}function VRt(n,e=.5){let t=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,s=Number.NEGATIVE_INFINITY,o=.2;for(let c of n)if(c.type==="schematic_component")a(c.center,c.size,0);else if(c.type==="schematic_port")a(c.center,{width:o,height:o},0);else if(c.type==="schematic_debug_object")c.shape==="rect"?a(c.center,c.size,0):c.shape==="line"&&(a(c.start,{width:.1,height:.1},0),a(c.end,{width:.1,height:.1},0));else if(c.type==="schematic_net_label"){let l=$_("net_label"),u=Yw(c.text||""),f=(u+pl*2+z_*(c.text?.length||0)+F_)*l,y=1.2*l,g=XRt(c.anchor_side)/180*Math.PI,x=URt(c,l,u),v=j_(c.anchor_side),P={x:x.x+v.x*f/2,y:x.y+v.y*f/2};a(P,{width:f,height:y},g)}else if(c.type==="schematic_trace")for(let l of c.edges)a(l.from,{width:.1,height:.1},0),a(l.to,{width:.1,height:.1},0);else if(c.type==="schematic_text"){let u=$_("reference_designator",c.font_size)??.18,f=(c.text??"").length*u,y=u;a(c.position,{width:f,height:y},c.rotation??0)}else if(c.type==="schematic_voltage_probe")a(c.position,{width:.2,height:.4},0);else if(c.type==="schematic_box")a({x:c.x+c.width/2,y:c.y+c.height/2},{width:c.width,height:c.height},0);else if(c.type==="schematic_table"){let{column_widths:l,row_heights:u}=Ztt(c,n),p=l.reduce((w,k)=>w+k,0),f=u.reduce((w,k)=>w+k,0),y=c.anchor??"center",g=c.anchor_position.x,x=c.anchor_position.y;y.includes("center")?g-=p/2:y.includes("right")&&(g-=p),y.includes("center")?x+=f/2:y.includes("bottom")&&(x+=f);let v=g+p/2,P=x-f/2;a({x:v,y:P},{width:p,height:f},0)}else c.type==="schematic_line"?(a({x:c.x1,y:c.y1},{width:.02,height:.02},0),a({x:c.x2,y:c.y2},{width:.02,height:.02},0)):c.type==="schematic_circle"?a(c.center,{width:c.radius*2,height:c.radius*2},0):c.type==="schematic_rect"?a(c.center,{width:c.width,height:c.height},c.rotation):c.type==="schematic_arc"&&a(c.center,{width:c.radius*2,height:c.radius*2},0);return t-=e,i-=e,r+=e,s+=e,{minX:t,minY:i,maxX:r,maxY:s};function a(c,l,u){let p=[{x:-l.width/2,y:-l.height/2},{x:l.width/2,y:-l.height/2},{x:l.width/2,y:l.height/2},{x:-l.width/2,y:l.height/2}];for(let f of p){let y=f.x*Math.cos(u)-f.y*Math.sin(u)+c.x,g=f.x*Math.sin(u)+f.y*Math.cos(u)+c.y;t=Math.min(t,y),i=Math.min(i,g),r=Math.max(r,y),s=Math.max(s,g)}}}function WRt(n,e,t,i){let r=e.x-n.x,s=e.y-n.y,o=Math.sqrt((t.x-n.x)**2+(t.y-n.y)**2),c=Math.sqrt((i.x-e.x)**2+(i.y-e.y)**2)/o,l=yn(r,s),u=Ei(c,c);return Fe(l,u)}function n8t(n){let{component:e}=n;if(e.is_box_with_pins===!1)return[];let t=e.symbol_name?ZRt(n):e8t(n);return[{type:"element",name:"g",attributes:{"data-circuit-json-type":"schematic_component","data-schematic-component-id":e.schematic_component_id},children:t,value:""}]}function i8t({probe:n,transform:e,colorMap:t}){let[i,r]=st(e,[n.position.x,n.position.y]),s=n.color??t.schematic.reference,o=Math.abs(e.a)*.6,a=Math.abs(e.a)*.28,c=i+o*Math.cos(-50*Math.PI/180),l=r+o*Math.sin(-50*Math.PI/180),u=i,p=r,f=[`M ${c},${l}`,`L ${u},${p}`,`M ${u},${p}`,`L ${u-a*Math.cos(100*Math.PI/180)},${p-a*Math.sin(100*Math.PI/180)}`,`L ${u-a*Math.cos(160*Math.PI/180)},${p-a*Math.sin(160*Math.PI/180)}`,"Z"].join(" "),y=(c+8-(c-c)).toString(),g=[];if(n.name&&n.voltage!==void 0)g.push({type:"element",name:"tspan",value:"",attributes:{x:y},children:[{type:"text",value:n.name,name:"",attributes:{},children:[]}]}),g.push({type:"element",name:"tspan",value:"",attributes:{x:y,dy:"1.2em"},children:[{type:"text",value:`${n.voltage}V`,name:"",attributes:{},children:[]}]});else{let x=[];n.name&&x.push(n.name),n.voltage!==void 0&&x.push(`${n.voltage}V`),g.push({type:"text",value:x.join(" "),name:"",attributes:{},children:[]})}return[{name:"path",type:"element",attributes:{d:f,stroke:s,fill:s,"stroke-width":`${Vi(e)}px`},value:"",children:[]},{type:"element",name:"text",value:"",attributes:{x:y,y:l.toString(),fill:s,"text-anchor":"start","dominant-baseline":"middle","font-family":"sans-serif","font-size":`${Ba(e,"reference_designator")}px`,"font-weight":"bold","data-schematic-voltage-probe-id":n.schematic_voltage_probe_id},children:g}]}function r8t({debugObject:n,transform:e}){if(n.shape==="rect"){let[t,i]=st(e,[n.center.x-n.size.width/2,n.center.y-n.size.height/2]),[r,s]=st(e,[n.center.x+n.size.width/2,n.center.y+n.size.height/2]);[i,s]=[Math.min(i,s),Math.max(i,s)];let o=Math.abs(r-t),a=Math.abs(s-i),[c,l]=st(e,[n.center.x,n.center.y]);return[{name:"rect",type:"element",value:"",attributes:{x:t.toString(),y:i.toString(),width:o.toString(),height:a.toString(),fill:"none",stroke:"red","stroke-width":(.02*Math.abs(e.a)).toString(),"stroke-dasharray":"5,5"},children:n.label?[{name:"text",type:"element",value:"",attributes:{x:c.toString(),y:(l-10).toString(),"text-anchor":"middle","font-size":(.2*Math.abs(e.a)).toString(),fill:"red"},children:[{type:"text",value:n.label,name:"",attributes:{},children:[]}]}]:[]}]}if(n.shape==="line"){let[t,i]=st(e,[n.start.x,n.start.y]),[r,s]=st(e,[n.end.x,n.end.y]),o=(t+r)/2,a=(i+s)/2;return[{name:"line",type:"element",value:"",attributes:{x1:t.toString(),y1:i.toString(),x2:r.toString(),y2:s.toString(),stroke:"red","stroke-width":(.02*Math.abs(e.a)).toString(),"stroke-dasharray":"5,5"},children:n.label?[{name:"text",type:"element",value:"",attributes:{x:o.toString(),y:(a-10).toString(),"text-anchor":"middle","font-size":(.2*Math.abs(e.a)).toString(),fill:"red"},children:[{type:"text",value:n.label,name:"",attributes:{},children:[]}]}]:[]}]}return[]}function s8t({trace:n,transform:e,colorMap:t}){let i=n.edges;if(i.length===0)return[];let r=[],s=[],o="";for(let a=0;a<i.length;a++){let c=i[a];if(c.is_crossing)continue;let[l,u]=st(e,[c.from.x,c.from.y]),[p,f]=st(e,[c.to.x,c.to.y]);a===0||i[a-1]?.is_crossing?o+=`M ${l} ${u} L ${p} ${f}`:o+=` L ${p} ${f}`}o&&(r.push({name:"path",type:"element",attributes:{d:o,class:"trace-invisible-hover-outline",stroke:t.schematic.wire,fill:"none","stroke-width":`${Vi(e)*8}px`,"stroke-linecap":"round",opacity:"0","stroke-linejoin":"round"},value:"",children:[]}),r.push({name:"path",type:"element",attributes:{d:o,stroke:t.schematic.wire,fill:"none","stroke-width":`${Vi(e)}px`,"stroke-linecap":"round","stroke-linejoin":"round"},value:"",children:[]}));for(let a of i){if(!a.is_crossing)continue;let[c,l]=st(e,[a.from.x,a.from.y]),[u,p]=st(e,[a.to.x,a.to.y]),f=(c+u)/2,y=(l+p)/2,g=u-c,x=p-l,v=Math.sqrt(g*g+x*x),P=v*.7,w=-x/v*P,k=g/v*P,T=f+w,I=y-Math.abs(k);s.push({name:"path",type:"element",attributes:{class:"trace-crossing-outline",d:`M ${c} ${l} Q ${T} ${I} ${u} ${p}`,stroke:t.schematic.background,fill:"none","stroke-width":`${Vi(e)*1.5}px`,"stroke-linecap":"butt"},value:"",children:[]}),s.push({name:"path",type:"element",attributes:{d:`M ${c} ${l} Q ${T} ${I} ${u} ${p}`,stroke:t.schematic.wire,fill:"none","stroke-width":`${Vi(e)}px`,"stroke-linecap":"round"},value:"",children:[]})}if(n.junctions)for(let a of n.junctions){let[c,l]=st(e,[a.x,a.y]);s.push({name:"circle",type:"element",attributes:{cx:c.toString(),cy:l.toString(),r:(Math.abs(e.a)*.03).toString(),class:"trace-junction",fill:t.schematic.junction},value:"",children:[]})}return[{name:"g",type:"element",value:"",attributes:{class:"trace","data-layer":"base","data-circuit-json-type":"schematic_trace","data-schematic-trace-id":n.schematic_trace_id,...n.subcircuit_connectivity_map_key&&{"data-subcircuit-connectivity-map-key":n.subcircuit_connectivity_map_key}},children:r},{name:"g",type:"element",value:"",attributes:{class:"trace-overlays","data-layer":"overlay","data-circuit-json-type":"schematic_trace","data-schematic-trace-id":n.schematic_trace_id,...n.subcircuit_connectivity_map_key&&{"data-subcircuit-connectivity-map-key":n.subcircuit_connectivity_map_key}},children:s}]}function h8t({schLine:n,transform:e,colorMap:t}){let i=st(e,{x:n.x1,y:n.y1}),r=st(e,{x:n.x2,y:n.y2}),s=n.stroke_width??.02,o=Math.abs(e.a)*s;return[{name:"line",type:"element",attributes:{x1:i.x.toString(),y1:i.y.toString(),x2:r.x.toString(),y2:r.y.toString(),stroke:n.color,"stroke-width":o.toString(),...n.is_dashed&&{"stroke-dasharray":(o*3).toString()},"data-schematic-line-id":n.schematic_line_id,...n.schematic_component_id&&{"data-schematic-component-id":n.schematic_component_id}},children:[],value:""}]}function d8t({schCircle:n,transform:e,colorMap:t}){let i=st(e,n.center),r=Math.abs(e.a)*n.radius,s=n.stroke_width??.02,o=Math.abs(e.a)*s;return[{name:"circle",type:"element",attributes:{cx:i.x.toString(),cy:i.y.toString(),r:r.toString(),fill:n.is_filled?n.fill_color??n.color:"none",stroke:n.color,"stroke-width":o.toString(),...n.is_dashed&&{"stroke-dasharray":(o*3).toString()},"data-schematic-circle-id":n.schematic_circle_id,...n.schematic_component_id&&{"data-schematic-component-id":n.schematic_component_id}},children:[],value:""}]}function f8t({schRect:n,transform:e,colorMap:t}){let i=st(e,n.center),r=Math.abs(e.a)*n.width,s=Math.abs(e.d)*n.height,o=n.stroke_width??.02,a=Math.abs(e.a)*o,c=i.x-r/2,l=i.y-s/2;return[{name:"rect",type:"element",attributes:{x:c.toString(),y:l.toString(),width:r.toString(),height:s.toString(),fill:n.is_filled?n.fill_color??n.color:"none",stroke:n.color,"stroke-width":a.toString(),...n.is_dashed&&{"stroke-dasharray":(a*3).toString()},...n.rotation!==0&&{transform:`rotate(${n.rotation} ${i.x} ${i.y})`},"data-schematic-rect-id":n.schematic_rect_id,...n.schematic_component_id&&{"data-schematic-component-id":n.schematic_component_id}},children:[],value:""}]}function m8t({schArc:n,transform:e,colorMap:t}){let i=st(e,n.center),r=Math.abs(e.a)*n.radius,s=n.stroke_width??.02,o=Math.abs(e.a)*s,a=n.start_angle_degrees*Math.PI/180,c=n.end_angle_degrees*Math.PI/180,l=i.x+r*Math.cos(a),u=i.y+r*Math.sin(a),p=i.x+r*Math.cos(c),f=i.y+r*Math.sin(c),y=n.end_angle_degrees-n.start_angle_degrees;n.direction==="clockwise"&&(y=-y),y<0&&(y+=360);let g=y>180?1:0,x=n.direction==="clockwise"?1:0;return[{name:"path",type:"element",attributes:{d:`M ${l} ${u} A ${r} ${r} 0 ${g} ${x} ${p} ${f}`,fill:"none",stroke:n.color,"stroke-width":o.toString(),...n.is_dashed&&{"stroke-dasharray":(o*3).toString()},"data-schematic-arc-id":n.schematic_arc_id,...n.schematic_component_id&&{"data-schematic-component-id":n.schematic_component_id}},children:[],value:""}]}function _8t(n){let e=[],t=i=>String(i).replace(/"/g,'\\"');for(let i of n){let s=`[data-subcircuit-connectivity-map-key="${t(i)}"]`,o=`g.trace${s}`,a=`g.trace-overlays${s}`,c=`:is(${o}, ${a}):hover`,l=`:is(${o}, ${a})`;e.push(`svg:has(${c}) ${l} { filter: invert(1); }`),e.push(`svg:has(${c}) ${a} .trace-crossing-outline { opacity: 0; }`)}return e.join(`
`)}function UA(n,e){let t=VRt(n),i=t.maxX-t.minX,r=t.maxY-t.minY,s=e?.width??1200,o=e?.height??600,a=e?.colorOverrides,c={...Mi,schematic:{...Mi.schematic,...a?.schematic??{}}},l=i/r,u=s/o,p;if(l>u){let et=s/l;p={x:0,y:(o-et)/2}}else{let et=o*l;p={x:(s-et)/2,y:0}}let f=att([{x:t.minX,y:t.maxY},{x:t.maxX,y:t.maxY},{x:t.maxX,y:t.minY}],[{x:p.x,y:p.y},{x:s-p.x,y:p.y},{x:s-p.x,y:o-p.y}]),y=[];if(y.push({name:"rect",type:"element",attributes:{class:"boundary",x:"0",y:"0",width:s.toString(),height:o.toString()},children:[],value:""}),e?.grid){let et=typeof e.grid=="object"?e.grid:{};y.push(DRt({bounds:t,transform:f,...et}))}let g=[],x=[],v=[],P=new Set,w=[],k=[],T=[],I=[],E=[],N=[],M=[],A=[],R=[],j=[];for(let et of n)et.type==="schematic_debug_object"?g.push(...r8t({debugObject:et,transform:f})):et.type==="schematic_component"?(x.push(...n8t({component:et,transform:f,circuitJson:n,colorMap:c})),N.push(...Qtt({component:et,transform:f,circuitJson:n}))):et.type==="schematic_box"?I.push(...c8t({schematicBox:et,transform:f,colorMap:c})):et.type==="schematic_trace"?(v.push(...s8t({trace:et,transform:f,colorMap:c})),P.add(et.subcircuit_connectivity_map_key)):et.type==="schematic_net_label"?w.push(...a8t({schNetLabel:et,realToScreenTransform:f,colorMap:c})):et.type==="schematic_text"&&!et.schematic_component_id?k.push(Jtt({elm:et,transform:f,colorMap:c})):et.type==="schematic_voltage_probe"?T.push(...i8t({probe:et,transform:f,colorMap:c})):et.type==="schematic_table"?E.push(...l8t({schematicTable:et,transform:f,colorMap:c,circuitJson:n})):et.type==="schematic_line"?M.push(...h8t({schLine:et,transform:f,colorMap:c})):et.type==="schematic_circle"?A.push(...d8t({schCircle:et,transform:f,colorMap:c})):et.type==="schematic_rect"?R.push(...f8t({schRect:et,transform:f,colorMap:c})):et.type==="schematic_arc"&&j.push(...m8t({schArc:et,transform:f,colorMap:c}));let B=v.filter(et=>et.attributes?.["data-layer"]!=="overlay"),G=v.filter(et=>et.attributes?.["data-layer"]==="overlay");y.push(...g,...B,...G,...M,...A,...R,...j,...x,...N,...w,...k,...I,...T,...E),e?.labeledPoints&&y.push(jRt({points:e.labeledPoints,transform:f}));let U=dl(n),H=fl;if(e?.showErrorsInTextOverlay){let et=D_(n);et&&y.push(et)}let tt={name:"svg",type:"element",attributes:{xmlns:"http://www.w3.org/2000/svg",width:s.toString(),height:o.toString(),style:`background-color: ${c.schematic.background}`,"data-real-to-screen-transform":rtt(f),...U&&{"data-software-used-string":U},...e?.includeVersion&&{"data-circuit-to-svg-version":H}},children:[{name:"style",type:"element",children:[{type:"text",value:`
              .boundary { fill: ${c.schematic.background}; }
              .schematic-boundary { fill: none; stroke: #fff; }
              .component { fill: none; stroke: ${c.schematic.component_outline}; }
              .chip { fill: ${c.schematic.component_body}; stroke: ${c.schematic.component_outline}; }
              .component-pin { fill: none; stroke: ${c.schematic.component_outline}; }
              /* Basic per-trace hover fallback */
              .trace:hover {
                filter: invert(1);
              }
              .trace:hover .trace-crossing-outline {
                opacity: 0;
              }
              .trace:hover .trace-junction {
                filter: invert(1);
              }
              /* Net-hover highlighting: when a trace or its overlays are hovered,
                 invert color for all traces (base + overlays) sharing the same
                 subcircuit connectivity key. Also hide crossing outline during hover. */
              ${_8t(P)}
              .text { font-family: sans-serif; fill: ${c.schematic.wire}; }
              .pin-number { fill: ${c.schematic.pin_number}; }
              .port-label { fill: ${c.schematic.reference}; }
              .component-name { fill: ${c.schematic.reference}; }
            `,name:"",attributes:{},children:[]}],value:"",attributes:{}},...y],value:""};return(0,qtt.stringify)(tt)}function VA(n){return n?.type==="simulation_transient_voltage_graph"}function GA(n){return n?.type==="simulation_experiment"}function eet(n){return n?.type==="simulation_voltage_probe"}function net({circuitJson:n,simulation_experiment_id:e,simulation_transient_voltage_graph_ids:t,width:i=g8t,height:r=x8t,includeVersion:s}){let o=t?new Set(t):null,a=n.find(N=>GA(N)&&N.simulation_experiment_id===e),c=n.filter(N=>VA(N)&&N.simulation_experiment_id===e&&(!o||o.has(N.simulation_transient_voltage_graph_id)));if(c.length===0)throw new Error(`No simulation_transient_voltage_graph elements found for simulation_experiment_id "${e}"`);let l=b8t(c,n),u=l.flatMap(N=>N.points);if(u.length===0)throw new Error(`simulation_transient_voltage_graph elements for simulation_experiment_id "${e}" do not contain any datapoints`);let p=Rtt(u.map(N=>N.timeMs)),f=Rtt(u.map(N=>N.voltage)),y=Math.max(1,i-jn.left-jn.right),g=Math.max(1,r-jn.top-jn.bottom),x=Ott(p.domainMin,p.domainMax,jn.left,jn.left+y),v=Ott(f.domainMin,f.domainMax,jn.top+g,jn.top),P=$8t(e),w=dl(n),k=fl,T=z8t(a,i),I=[k8t(),T8t(i,r),E8t(P,y,g),M8t(y,g),C8t({timeAxis:p,voltageAxis:f,scaleX:x,scaleY:v,plotWidth:y,plotHeight:g}),F8t(l,P,x,v),I8t({timeAxis:p,voltageAxis:f,scaleX:x,scaleY:v,plotWidth:y,plotHeight:g}),R8t(l,i),...T?[T]:[]],E=kn("svg",{xmlns:"http://www.w3.org/2000/svg",width:i.toString(),height:r.toString(),viewBox:`0 0 ${me(i)} ${me(r)}`,"data-simulation-experiment-id":e,...a?.name&&{"data-simulation-experiment-name":a.name},...w&&{"data-software-used-string":w},...s&&{"data-circuit-to-svg-version":k}},I);return(0,tet.stringify)(E)}function b8t(n,e){let t=Array.isArray(Mi.palette)?Mi.palette:[],i=e.filter(eet),r=new Map,s=new Map;for(let o of i)o.name&&o.source_component_id&&r.set(o.source_component_id,o.name),o.color&&o.source_component_id&&s.set(o.source_component_id,o.color);return n.map((o,a)=>{let c=v8t(o),l=t.length>0?t[a%t.length]:Att,u=o.source_component_id?s.get(o.source_component_id):void 0,p=o.color??u??l??Att,f=o.source_component_id?r.get(o.source_component_id):void 0,y=f?`V(${f})`:o.name||(o.source_component_id?`Probe ${o.source_component_id}`:o.simulation_transient_voltage_graph_id);return{graph:o,points:c,color:p,label:y}}).filter(o=>o.points.length>0)}function v8t(n){let e=S8t(n),t=Math.min(e.length,n.voltage_levels.length),i=[];for(let r=0;r<t;r++){let s=Number(e[r]??Number.NaN),o=Number(n.voltage_levels[r]??Number.NaN);!Number.isFinite(s)||!Number.isFinite(o)||i.push({timeMs:s,voltage:o})}return i}function S8t(n){if(Array.isArray(n.timestamps_ms)&&n.timestamps_ms.length===n.voltage_levels.length)return n.timestamps_ms.map(r=>Number(r));let e=n.voltage_levels.length;if(e===0)return[];let t=[];for(let r=0;r<e;r++)t.push(n.start_time_ms+n.time_per_step*r);let i=t.length>0?t[t.length-1]:void 0;return i!==void 0&&Number.isFinite(n.end_time_ms)&&Number.isFinite(i)&&Math.abs(i-n.end_time_ms)>n.time_per_step/2&&t.push(n.end_time_ms),t}function Rtt(n){if(n.length===0)return{domainMin:0,domainMax:1,ticks:[0,1]};let e=Math.min(...n),t=Math.max(...n);if(e===t){let a=e===0?1:Math.abs(e)*.1||1;return{domainMin:e-a,domainMax:e+a,ticks:[e-a,e,e+a]}}let i=w8t(e,t),r=i.length>0?i:[e,t],s=r[0],o=r[r.length-1];return{domainMin:s,domainMax:o,ticks:r}}function w8t(n,e,t=6){let i=e-n;if(!Number.isFinite(i)||i<=Number.EPSILON)return[n,e];let r=P8t(i/Math.max(1,t-1)),s=Math.floor(n/r)*r,o=Math.ceil(e/r)*r,a=[];for(let c=s;c<=o+r/2;c+=r)a.push(Number.parseFloat(c.toPrecision(12)));return a}function P8t(n){if(!Number.isFinite(n)||n<=0)return 1;let e=Math.floor(Math.log10(n)),t=n/Math.pow(10,e),i;return t<=1?i=1:t<=2?i=2:t<=5?i=5:i=10,i*Math.pow(10,e)}function Ott(n,e,t,i){if(!Number.isFinite(n)||!Number.isFinite(e)){let s=(t+i)/2;return()=>s}let r=e-n;if(Math.abs(r)<Number.EPSILON){let s=(t+i)/2;return()=>s}return s=>t+(s-n)/r*(i-t)}function k8t(){let n=`
:root { color-scheme: light; }
svg { font-family: 'Inter', 'Helvetica Neue', Arial, sans-serif; }
.background { fill: ${Mi.schematic.background}; }
.plot-background { fill: #ffffff; }
.grid-line { stroke: rgba(0, 0, 0, 0.08); stroke-width: 1; }
.axis { stroke: rgba(0, 0, 0, 0.6); stroke-width: 1.5; }
.axis-tick { stroke: rgba(0, 0, 0, 0.6); stroke-width: 1; }
.axis-label { fill: rgba(0, 0, 0, 0.75); font-size: 12px; }
.axis-title { fill: rgba(0, 0, 0, 0.9); font-size: 14px; font-weight: 600; }
.legend-label { fill: rgba(0, 0, 0, 0.75); font-size: 11px; }
.legend-line { stroke-width: 3; }
.simulation-line { fill: none; stroke-width: 2.5; }
.simulation-point { stroke-width: 0; }
.chart-title { fill: rgba(0, 0, 0, 0.85); font-size: 18px; font-weight: 600; }
`;return kn("style",{},[Cd(n)])}function T8t(n,e){return kn("rect",{class:"background",x:"0",y:"0",width:me(n),height:me(e)})}function E8t(n,e,t){return kn("defs",{},[kn("clipPath",{id:n},[kn("rect",{x:me(jn.left),y:me(jn.top),width:me(e),height:me(t)})])])}function M8t(n,e){return kn("rect",{class:"plot-background",x:me(jn.left),y:me(jn.top),width:me(n),height:me(e)})}function C8t({timeAxis:n,voltageAxis:e,scaleX:t,scaleY:i,plotWidth:r,plotHeight:s}){let o=jn.top,a=jn.top+s,c=jn.left,l=jn.left+r,u=[];for(let p of n.ticks){let f=me(t(p));u.push(kn("line",{class:"grid-line grid-line-x",x1:f,y1:me(o),x2:f,y2:me(a)}))}for(let p of e.ticks){let f=me(i(p));u.push(kn("line",{class:"grid-line grid-line-y",x1:me(c),y1:f,x2:me(l),y2:f}))}return kn("g",{class:"grid"},u)}function I8t({timeAxis:n,voltageAxis:e,scaleX:t,scaleY:i,plotWidth:r,plotHeight:s}){let o=jn.top+s,a=jn.left,c=jn.left+r,l=[kn("line",{class:"axis axis-x",x1:me(a),y1:me(o),x2:me(c),y2:me(o)}),kn("line",{class:"axis axis-y",x1:me(a),y1:me(jn.top),x2:me(a),y2:me(o)})];for(let u of n.ticks){let p=me(t(u));l.push(kn("line",{class:"axis-tick axis-tick-x",x1:p,y1:me(o),x2:p,y2:me(o+6)})),l.push(kn("text",{class:"axis-label axis-label-x",x:p,y:me(o+22),"text-anchor":"middle"},[Cd(Ltt(u,n.ticks))]))}for(let u of e.ticks){let p=me(i(u));l.push(kn("line",{class:"axis-tick axis-tick-y",x1:me(a-6),y1:p,x2:me(a),y2:p})),l.push(kn("text",{class:"axis-label axis-label-y",x:me(a-10),y:p,"text-anchor":"end","dominant-baseline":"middle"},[Cd(Ltt(u,e.ticks))]))}return l.push(kn("text",{class:"axis-title axis-title-x",x:me(a+r/2),y:me(o+48),"text-anchor":"middle"},[Cd("Time (ms)")]),kn("text",{class:"axis-title axis-title-y",x:me(a-64),y:me(jn.top+s/2),transform:`rotate(-90 ${me(a-64)} ${me(jn.top+s/2)})`,"text-anchor":"middle"},[Cd("Voltage (V)")])),kn("g",{class:"axes"},l)}function R8t(n,e){let t=jn.top,i=n.map(r=>{let s=e-jn.right+10,o=O8t(r.label),a=L8t(r,s,t,o),c=o.length*iet;return t+=Math.max(c,A8t),a});return kn("g",{class:"legend"},i)}function O8t(n){let e=n.split("_");if(e.length<=1)return[n];let t=[],i=e[0]??"";for(let r=1;r<e.length;r++){let s=e[r]??"",o=i+"_"+s;o.length>N8t?(t.push(i),i=s):i=o}return i&&t.push(i),t}function L8t(n,e,t,i){let r=i.map((s,o)=>kn("tspan",{x:"20",dy:o===0?"0":String(iet)},[Cd(s)]));return kn("g",{class:"legend-item",transform:`translate(${me(e)} ${me(t)})`},[kn("line",{class:"legend-line",x1:"0",y1:"0",x2:"16",y2:"0",stroke:n.color}),kn("text",{class:"legend-label",x:"20",y:"0","dominant-baseline":"middle"},r)])}function F8t(n,e,t,i){let s=[4,8],o=s.map(f=>me(f)).join(" "),c=s.reduce((f,y)=>f+y,0)/3,l=[];n.forEach((f,y)=>{if(f.points.length===0)return;let g=[];f.points.forEach((P,w)=>{let k=me(t(P.timeMs)),T=me(i(P.voltage));g.push(`${w===0?"M":"L"} ${k} ${T}`)});let x={class:"simulation-line",d:g.join(" "),stroke:f.color,"clip-path":`url(#${e})`,"data-simulation-transient-voltage-graph-id":f.graph.simulation_transient_voltage_graph_id};f.graph.source_component_id&&(x["data-source-component-id"]=f.graph.source_component_id),f.graph.subcircuit_connectivity_map_key&&(x["data-subcircuit-connectivity-map-key"]=f.graph.subcircuit_connectivity_map_key);let v=f.points.map(P=>{let w=me(t(P.timeMs)),k=me(i(P.voltage));return kn("circle",{class:"simulation-point",cx:w,cy:k,r:"2.5",fill:f.color,"clip-path":`url(#${e})`})});l.push({entry:f,graphIndex:y,pathAttributes:x,pointElements:v})});let u=[];for(let f=0;f<3;f++)l.forEach(y=>{let g=(y.graphIndex+f)%3,x=me(g*c);u.push(kn("path",{...y.pathAttributes,"stroke-dasharray":o,"stroke-dashoffset":x}))});let p=l.flatMap(f=>f.pointElements);return kn("g",{class:"data-series"},[...u,...p])}function z8t(n,e){return n?.name?kn("text",{class:"chart-title",x:me(e/2),y:me(jn.top-40),"text-anchor":"middle"},[Cd(n.name)]):null}function $8t(n){return`simulation-graph-${n.replace(/[^a-zA-Z0-9_-]+/g,"-")}`}function me(n){if(!Number.isFinite(n))return"0";let e=Number.parseFloat(n.toFixed(6));return Number.isInteger(e),e.toString()}function Ltt(n,e){if(e.length<=1)return me(n);let t=e[e.length-1]-e[0];if(!Number.isFinite(t)||t===0)return me(n);let i=t>=100?0:t>=10?1:t>=1?2:3,r=Math.pow(10,i);return(Math.round(n*r)/r).toFixed(i).replace(/\.0+$/,"").replace(/(\.\d*?)0+$/,"$1").replace(/\.$/,"")}function kn(n,e,t=[]){return{name:n,type:"element",value:"",attributes:e,children:t}}function Cd(n){return{name:"",type:"text",value:n,attributes:{},children:[]}}function B8t({circuitJson:n,simulation_experiment_id:e,simulation_transient_voltage_graph_ids:t,width:i=D8t,height:r=j8t,schematicHeightRatio:s=ret,schematicOptions:o,includeVersion:a,showErrorsInTextOverlay:c}){let l=n.filter(M=>!GA(M)&&!VA(M)),u=Y8t(s),p=Math.max(1,r*u),f=Math.max(1,r-p),y=p+f,g=y===0?1:r/y,x=p*g,v=f*g,P=UA(l,{...o,width:i,height:x,includeVersion:!1,showErrorsInTextOverlay:c}),w=net({circuitJson:n,simulation_experiment_id:e,simulation_transient_voltage_graph_ids:t,width:i,height:v,includeVersion:!1}),k=ztt((0,L1.parseSync)(P)),T=ztt((0,L1.parseSync)(w)),I=[];I.push(Ftt(k,0,0,i,x)),I.push(Ftt(T,0,x,i,v));let E=dl(l),N={name:"svg",type:"element",value:"",attributes:{xmlns:"http://www.w3.org/2000/svg",width:hl(i),height:hl(r),viewBox:`0 0 ${hl(i)} ${hl(r)}`,"data-simulation-experiment-id":e,...E&&{"data-software-used-string":E},...a&&{"data-circuit-to-svg-version":fl}},children:I};return(0,L1.stringify)(N)}function Ftt(n,e,t,i,r){let s=set(n);return s.attributes={...s.attributes,x:hl(e),y:hl(t),width:hl(i),height:hl(r)},delete s.attributes.xmlns,s}function ztt(n){if(n.type!=="element")throw new Error("Expected SVG root element to be of type 'element'");return n}function set(n){return{...n,attributes:{...n.attributes??{}},children:n.children?.map(set)??[]}}function Y8t(n){return Number.isFinite(n)?n<=0?0:n>=1?1:n:ret}function hl(n){if(!Number.isFinite(n))return"0";let e=Number.parseFloat(n.toFixed(6));return Number.isInteger(e),e.toString()}function X8t(n,e){let{transform:t,layer:i}=e;if(i&&n.layer!==i)return[];let[r,s]=st(t,[n.x,n.y]);if(n.shape==="rect"||n.shape==="rotated_rect"){let o=n.width*Math.abs(t.a),a=n.height*Math.abs(t.d);return n.shape==="rotated_rect"&&n.ccw_rotation?[{name:"rect",type:"element",attributes:{class:"pcb-solder-paste",fill:Dw(n.layer),x:(-o/2).toString(),y:(-a/2).toString(),width:o.toString(),height:a.toString(),transform:`translate(${r} ${s}) rotate(${-n.ccw_rotation})`,"data-type":"pcb_solder_paste","data-pcb-layer":n.layer}}]:[{name:"rect",type:"element",attributes:{class:"pcb-solder-paste",fill:Dw(n.layer),x:(r-o/2).toString(),y:(s-a/2).toString(),width:o.toString(),height:a.toString(),"data-type":"pcb_solder_paste","data-pcb-layer":n.layer}}]}if(n.shape==="pill"){let o=n.width*Math.abs(t.a),a=n.height*Math.abs(t.d),c=n.radius*Math.abs(t.a);return[{name:"rect",type:"element",attributes:{class:"pcb-solder-paste",fill:Dw(n.layer),x:(r-o/2).toString(),y:(s-a/2).toString(),width:o.toString(),height:a.toString(),rx:c.toString(),"data-type":"pcb_solder_paste","data-pcb-layer":n.layer}}]}if(n.shape==="circle"){let o=n.radius*Math.abs(t.a);return[{name:"circle",type:"element",attributes:{class:"pcb-solder-paste",fill:Dw(n.layer),cx:r.toString(),cy:s.toString(),r:o.toString(),"data-type":"pcb_solder_paste","data-pcb-layer":n.layer}}]}}function U8t(n,e){let t=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,s=Number.NEGATIVE_INFINITY,o=n.filter(R=>R.type==="pcb_board"||R.type==="pcb_panel"||R.type==="pcb_solder_paste"&&R.layer===e.layer);for(let R of o)if(R.type==="pcb_board")R.outline&&Array.isArray(R.outline)&&R.outline.length>=3?A(R.outline):"center"in R&&"width"in R&&"height"in R&&M(R.center,R.width,R.height);else if(R.type==="pcb_panel"){let j=R,B=Y.parse(j.width),G=Y.parse(j.height);if(B!==void 0&&G!==void 0){let U=j.center??{x:B/2,y:G/2};M(U,B,G)}}else R.type==="pcb_solder_paste"&&"x"in R&&"y"in R&&M({x:R.x,y:R.y},0,0);let a=1,c=r-t+2*a,l=s-i+2*a,u=e.width??800,p=e.height??600,f=u/c,y=p/l,g=Math.min(f,y),x=(u-c*g)/2,v=(p-l*g)/2,P=Fe(yn(x-t*g+a*g,p-v+i*g-a*g),Ei(g,-g)),w={transform:P,layer:e.layer,colorMap:gr},k=o.sort((R,j)=>($tt.indexOf(j.type)??9999)-($tt.indexOf(R.type)??9999)).flatMap(R=>V8t({elm:R,ctx:w})),T=dl(n),I=fl,E=[{name:"style",type:"element",children:[{type:"text",value:""}]},{name:"rect",type:"element",attributes:{class:"boundary",x:"0",y:"0",fill:"#000",width:u.toString(),height:p.toString()}},G8t(P,t,i,r,s),...k].filter(R=>R!==null);if(e?.showErrorsInTextOverlay){let R=D_(n);R&&E.push(R)}let N={name:"svg",type:"element",attributes:{xmlns:"http://www.w3.org/2000/svg",width:u.toString(),height:p.toString(),...T&&{"data-software-used-string":T},...e.includeVersion&&{"data-circuit-to-svg-version":I}},value:"",children:E};try{return(0,oet.stringify)(N)}catch(R){throw console.error("Error stringifying SVG object:",R),R}function M(R,j,B){let G=j/2,U=B/2;t=Math.min(t,R.x-G),i=Math.min(i,R.y-U),r=Math.max(r,R.x+G),s=Math.max(s,R.y+U)}function A(R){for(let j of R)t=Math.min(t,j.x),i=Math.min(i,j.y),r=Math.max(r,j.x),s=Math.max(s,j.y)}}function V8t({elm:n,ctx:e}){let{transform:t}=e;switch(n.type){case"pcb_board":return jtt(n,e);case"pcb_solder_paste":return X8t(n,e);default:return[]}}function G8t(n,e,t,i,r){let[s,o]=st(n,[e,t]),[a,c]=st(n,[i,r]),l=Math.abs(a-s),u=Math.abs(c-o),p=Math.min(s,a),f=Math.min(o,c);return{name:"rect",type:"element",value:"",children:[],attributes:{class:"pcb-boundary",fill:"none",stroke:"#fff","stroke-width":"0.3",x:p.toString(),y:f.toString(),width:l.toString(),height:u.toString()}}}var Dtt,mfe,wfe,Xtt,Utt,qtt,tme,ome,L1,tet,oet,r6t,s6t,Mi,l6t,p6t,h6t,f6t,_6t,gr,sfe,ofe,afe,cfe,T6t,A6t,R6t,z6t,gtt,xtt,Ls,btt,Btt,L_,jw,vtt,j6t,B6t,Y6t,X6t,q6t,Z6t,J6t,fl,Q6t,Stt,rRt,Bw,oRt,$_,Ba,$A,M1,C1,I1,Ptt,gRt,xRt,vRt,SRt,DA,N1,A1,R1,ktt,Ttt,ERt,MRt,CRt,Vtt,NRt,ARt,Gtt,Htt,YA,Wtt,RRt,ORt,Mtt,Ctt,Yw,Ztt,j_,pl,F_,z_,BRt,YRt,Vi,GRt,HRt,XA,Ktt,qRt,ZRt,O1,Itt,KRt,JRt,Ntt,QRt,t8t,Jtt,e8t,o8t,a8t,c8t,l8t,u8t,p8t,Qtt,y8t,g8t,x8t,jn,Att,N8t,iet,A8t,D8t,j8t,ret,$tt,cet=qt(()=>{"use strict";St();Dtt=Gt(as(),1);Yt();Yt();Yt();Yt();Yt();Yt();Yt();Yt();Yt();Yt();Yt();Yt();Yt();Yt();Yt();Yt();Yt();Yt();Yt();Yt();Yt();Yt();Yt();Yt();Yt();Yt();ir();mfe=Gt(as(),1);Yt();Ae();ir();Ae();Yt();Yt();Yt();wfe=Gt(as(),1);Yt();Yt();Yt();Xtt=Gt(as(),1);Ae();Yt();Yt();Yt();Yt();Yt();Yt();Yt();Utt=Gt(as(),1);Yt();Yt();Ae();Ae();Yt();Yt();Yt();Yt();Yt();Ag();Yt();Ae();qtt=Gt(as(),1);Yt();Yt();Yt();Yt();Ta();Ae();Ta();tme=Gt(as(),1);Yt();Yt();Yt();Ae();Ta();ome=Gt(as(),1);Yt();Yt();Ae();Yt();Ae();Yt();Yt();Yt();Yt();Yt();Yt();Yt();Yt();Ta();Yt();Yt();Ae();Yt();Yt();Yt();Yt();Yt();L1=Gt(as(),1),tet=Gt(as(),1);St();oet=Gt(as(),1);Yt();Yt();r6t="rgba(255,255,255,0.5)",s6t="rgba(255,255,255,0.2)";Mi={"3d_viewer":{background_bottom:"rgb(102, 102, 128)",background_top:"rgb(204, 204, 230)",board:"rgb(51, 43, 23)",copper:"rgb(179, 156, 0)",silkscreen_bottom:"rgb(230, 230, 230)",silkscreen_top:"rgb(230, 230, 230)",soldermask:"rgb(20, 51, 36)",solderpaste:"rgb(128, 128, 128)"},board:{anchor:"rgb(255, 38, 226)",aux_items:"rgb(255, 255, 255)",b_adhes:"rgb(0, 0, 132)",b_crtyd:"rgb(255, 38, 226)",b_fab:"rgb(88, 93, 132)",b_mask:"rgba(2, 255, 238, 0.400)",b_paste:"rgb(0, 194, 194)",b_silks:"rgb(232, 178, 167)",background:"rgb(0, 16, 35)",cmts_user:"rgb(89, 148, 220)",copper:{b:"rgb(77, 127, 196)",f:"rgb(200, 52, 52)",in1:"rgb(127, 200, 127)",in10:"rgb(237, 124, 51)",in11:"rgb(91, 195, 235)",in12:"rgb(247, 111, 142)",in13:"rgb(167, 165, 198)",in14:"rgb(40, 204, 217)",in15:"rgb(232, 178, 167)",in16:"rgb(242, 237, 161)",in17:"rgb(237, 124, 51)",in18:"rgb(91, 195, 235)",in19:"rgb(247, 111, 142)",in2:"rgb(206, 125, 44)",in20:"rgb(167, 165, 198)",in21:"rgb(40, 204, 217)",in22:"rgb(232, 178, 167)",in23:"rgb(242, 237, 161)",in24:"rgb(237, 124, 51)",in25:"rgb(91, 195, 235)",in26:"rgb(247, 111, 142)",in27:"rgb(167, 165, 198)",in28:"rgb(40, 204, 217)",in29:"rgb(232, 178, 167)",in3:"rgb(79, 203, 203)",in30:"rgb(242, 237, 161)",in4:"rgb(219, 98, 139)",in5:"rgb(167, 165, 198)",in6:"rgb(40, 204, 217)",in7:"rgb(232, 178, 167)",in8:"rgb(242, 237, 161)",in9:"rgb(141, 203, 129)"},cursor:"rgb(255, 255, 255)",drc:"rgb(194, 194, 194)",drc_error:"rgba(215, 91, 107, 0.800)",drc_exclusion:"rgb(255, 255, 255)",drc_warning:"rgba(255, 208, 66, 0.902)",dwgs_user:"rgb(194, 194, 194)",eco1_user:"rgb(180, 219, 210)",eco2_user:"rgb(216, 200, 82)",edge_cuts:"rgb(208, 210, 205)",f_adhes:"rgb(132, 0, 132)",f_crtyd:"rgb(255, 0, 245)",f_fab:"rgb(175, 175, 175)",f_mask:"rgba(216, 100, 255, 0.400)",f_paste:"rgba(180, 160, 154, 0.902)",f_silks:"rgb(242, 237, 161)",footprint_text_back:"rgb(0, 0, 132)",footprint_text_front:"rgb(194, 194, 194)",footprint_text_invisible:"rgb(132, 132, 132)",grid:"rgb(132, 132, 132)",grid_axes:"rgb(194, 194, 194)",margin:"rgb(255, 38, 226)",microvia:"rgb(0, 132, 132)",no_connect:"rgb(0, 0, 132)",pad_back:"rgb(77, 127, 196)",pad_front:"rgb(200, 52, 52)",pad_plated_hole:"rgb(194, 194, 0)",pad_through_hole:"rgb(227, 183, 46)",plated_hole:"rgb(26, 196, 210)",ratsnest:"rgba(245, 255, 213, 0.702)",select_overlay:"rgb(4, 255, 67)",through_via:"rgb(236, 236, 236)",user_1:"rgb(194, 194, 194)",user_2:"rgb(89, 148, 220)",user_3:"rgb(180, 219, 210)",user_4:"rgb(216, 200, 82)",user_5:"rgb(194, 194, 194)",user_6:"rgb(89, 148, 220)",user_7:"rgb(180, 219, 210)",user_8:"rgb(216, 200, 82)",user_9:"rgb(232, 178, 167)",via_blind_buried:"rgb(187, 151, 38)",via_hole:"rgb(227, 183, 46)",via_micro:"rgb(0, 132, 132)",via_through:"rgb(236, 236, 236)",worksheet:"rgb(200, 114, 171)"},gerbview:{axes:"rgb(0, 0, 132)",background:"rgb(0, 0, 0)",dcodes:"rgb(255, 255, 255)",grid:"rgb(132, 132, 132)",layers:["rgb(132, 0, 0)","rgb(194, 194, 0)","rgb(194, 0, 194)","rgb(194, 0, 0)","rgb(0, 132, 132)","rgb(0, 132, 0)","rgb(0, 0, 132)","rgb(132, 132, 132)","rgb(132, 0, 132)","rgb(194, 194, 194)","rgb(132, 0, 132)","rgb(132, 0, 0)","rgb(132, 132, 0)","rgb(194, 194, 194)","rgb(0, 0, 132)","rgb(0, 132, 0)","rgb(132, 0, 0)","rgb(194, 194, 0)","rgb(194, 0, 194)","rgb(194, 0, 0)","rgb(0, 132, 132)","rgb(0, 132, 0)","rgb(0, 0, 132)","rgb(132, 132, 132)","rgb(132, 0, 132)","rgb(194, 194, 194)","rgb(132, 0, 132)","rgb(132, 0, 0)","rgb(132, 132, 0)","rgb(194, 194, 194)","rgb(0, 0, 132)","rgb(0, 132, 0)","rgb(132, 0, 0)","rgb(194, 194, 0)","rgb(194, 0, 194)","rgb(194, 0, 0)","rgb(0, 132, 132)","rgb(0, 132, 0)","rgb(0, 0, 132)","rgb(132, 132, 132)","rgb(132, 0, 132)","rgb(194, 194, 194)","rgb(132, 0, 132)","rgb(132, 0, 0)","rgb(132, 132, 0)","rgb(194, 194, 194)","rgb(0, 0, 132)","rgb(0, 132, 0)","rgb(132, 0, 0)","rgb(194, 194, 0)","rgb(194, 0, 194)","rgb(194, 0, 0)","rgb(0, 132, 132)","rgb(0, 132, 0)","rgb(0, 0, 132)","rgb(132, 132, 132)","rgb(132, 0, 132)","rgb(194, 194, 194)","rgb(132, 0, 132)","rgb(132, 0, 0)"],negative_objects:"rgb(132, 132, 132)",worksheet:"rgb(0, 0, 132)"},meta:{filename:"kicad_2020",name:"KiCad 2020",version:2},palette:["rgb(132, 0, 0)","rgb(194, 194, 0)","rgb(194, 0, 194)","rgb(194, 0, 0)","rgb(0, 132, 132)","rgb(0, 132, 0)","rgb(0, 0, 132)","rgb(132, 132, 132)","rgb(132, 0, 132)","rgb(194, 194, 194)","rgb(132, 0, 132)","rgb(132, 0, 0)","rgb(132, 132, 0)","rgb(194, 194, 194)","rgb(0, 0, 132)","rgb(0, 132, 0)"],schematic:{aux_items:"rgb(46, 46, 46)",background:"rgb(245, 241, 237)",brightened:"rgb(255, 0, 255)",bus:"rgb(0, 0, 132)",bus_junction:"rgb(0, 0, 132)",component_body:"rgb(255, 255, 194)",component_outline:"rgb(132, 0, 0)",cursor:"rgb(15, 15, 15)",erc_error:"rgba(230, 9, 13, 0.800)",erc_warning:"rgba(209, 146, 0, 0.800)",fields:"rgb(132, 0, 132)",grid:"rgb(181, 181, 181)",grid_axes:"rgb(0, 0, 132)",hidden:"rgb(194, 194, 194)",junction:"rgb(0, 150, 0)",label_global:"rgb(132, 0, 0)",label_background:"rgba(255, 255, 255, 0.6)",label_hier:"rgb(114, 86, 0)",label_local:"rgb(15, 15, 15)",net_name:"rgb(132, 132, 132)",no_connect:"rgb(0, 0, 132)",note:"rgb(0, 0, 194)",override_item_colors:!1,pin:"rgb(132, 0, 0)",pin_name:"rgb(0, 100, 100)",pin_number:"rgb(169, 0, 0)",reference:"rgb(0, 100, 100)",shadow:"rgba(102, 179, 255, 0.800)",sheet:"rgb(132, 0, 0)",sheet_background:"rgba(253, 255, 231, 0.000)",sheet_fields:"rgb(132, 0, 132)",sheet_filename:"rgb(114, 86, 0)",sheet_label:"rgb(0, 100, 100)",sheet_name:"rgb(0, 100, 100)",table:"rgb(102, 102, 102)",value:"rgb(0, 100, 100)",wire:"rgb(0, 150, 0)",wire_crossing:"rgb(30, 180, 30)",worksheet:"rgb(132, 0, 0)"}};l6t=Mi.board.user_2;p6t=Mi.board.user_2,h6t=Mi.board.user_2;f6t=Mi.board.user_2;_6t=Mi.board.user_2;gr={copper:{top:"rgb(200, 52, 52)",inner1:"rgb(255, 140, 0)",inner2:"rgb(255, 215, 0)",inner3:"rgb(50, 205, 50)",inner4:"rgb(64, 224, 208)",inner5:"rgb(138, 43, 226)",inner6:"rgb(255, 105, 180)",bottom:"rgb(77, 127, 196)"},soldermask:{top:"rgb(18, 82, 50)",bottom:"rgb(77, 127, 196)"},drill:"#FF26E2",silkscreen:{top:"#f2eda1",bottom:"#5da9e9"},boardOutline:"rgba(255, 255, 255, 0.5)",courtyard:"#FF00FF",debugComponent:{fill:null,stroke:null}},sfe=gr.drill,ofe=gr.silkscreen.top,afe=gr.silkscreen.bottom,cfe={...gr.copper};T6t={bottom:"rgb(105, 105, 105)",top:"rgb(105, 105, 105)"};A6t=(n,e)=>{let t=Me(e).pcb_smtpad.get(n);if(t&&"x"in t&&"y"in t)return{x:t.x,y:t.y};let i=Me(e).pcb_plated_hole.get(n);return i&&"x"in i&&"y"in i?{x:i.x,y:i.y}:null},R6t=(n,e,t,i)=>{let r=t.getIdsConnectedToNet(e),s=null,o=1/0;for(let a of r){let c=A6t(a,i);if(c){let l=n.x-c.x,u=n.y-c.y,p=Math.sqrt(l*l+u*u);p>0&&p<o&&(o=p,s=c)}}return s};z6t="rgba(255, 255, 255, 0.5)",gtt="pcb-grid-pattern";xtt=.01,Ls=4,btt=8,Btt=11,L_=1,jw=5,vtt=1.5,j6t=15,B6t=10,Y6t=.2,X6t=50;q6t="rgba(100, 200, 255, 0.6)",Z6t=.1;J6t={name:"circuit-to-svg",type:"module",version:"0.0.273",description:"Convert Circuit JSON to SVG",main:"dist/index.js",files:["dist"],scripts:{start:"cosmos",prepublish:"npm run build",build:"tsup-node ./lib/index.ts --format esm --dts --sourcemap --external tscircuit",format:"biome format . --write","format:check":"biome format .",cosmos:"cosmos","cosmos-export":"cosmos-export"},license:"ISC",devDependencies:{"@biomejs/biome":"^1.9.4","@types/bun":"^1.2.8","@vitejs/plugin-react":"5.0.0",biome:"^0.3.3","bun-match-svg":"^0.0.12",esbuild:"^0.20.2","performance-now":"^2.1.0","circuit-json":"^0.0.317",react:"19.1.0","react-cosmos":"7.0.0","react-cosmos-plugin-vite":"7.0.0","react-dom":"19.1.0",tscircuit:"^0.0.827",tsup:"^8.0.2",typescript:"^5.4.5","vite-tsconfig-paths":"^5.0.1"},dependencies:{"@types/node":"^22.5.5","bun-types":"^1.1.40","calculate-elbow":"0.0.12",svgson:"^5.3.1","transformation-matrix":"^2.16.1"}},fl=J6t.version,Q6t={pcb_background:0,pcb_boundary:1,pcb_panel:5,pcb_board:10,pcb_cutout:15,pcb_hole:18,pcb_plated_hole_drill:19,pcb_plated_hole:20,pcb_trace:30,pcb_smtpad:30,pcb_copper_pour:35,pcb_via:36,pcb_soldermask:40,pcb_solder_paste:45,pcb_silkscreen_text:50,pcb_silkscreen_path:50,pcb_silkscreen_rect:50,pcb_silkscreen_circle:50,pcb_silkscreen_line:50,pcb_component:60,pcb_fabrication_note_text:70,pcb_fabrication_note_path:70,pcb_fabrication_note_rect:70,pcb_fabrication_note_dimension:70,pcb_note_dimension:70,pcb_note_text:70,pcb_note_rect:70,pcb_note_path:70,pcb_note_line:70,pcb_trace_error:80,pcb_rats_nest:85},Stt=100;rRt=Ytt,Bw={fill:"none",stroke:"rgb(0,0,0)",strokeOpacity:"0.8",strokeWidthFactor:.2};oRt={pin_number:.15,negated_pin_number:.15*.8,reference_designator:.18,manufacturer_number:.18,net_label:.18,error:.05},$_=(n,e)=>e??oRt[n],Ba=(n,e,t)=>Math.abs(n.a)*$_(e,t);$A="rgb(190, 190, 190)";M1="rgb(210, 210, 210)",C1="rgb(190, 190, 190)";I1="rgb(210, 210, 210)";Ptt=["pcb_component","pcb_smtpad","pcb_hole","pcb_plated_hole","pcb_board"];gRt="rgb(26, 115, 143)",xRt="rgba(0,0,0,0.9)";vRt="rgba(120, 120, 120, 0.6)",SRt="rgba(255, 255, 255, 0.9)";DA="rgb(50, 50, 50)";N1="rgb(218, 165, 32)",A1="rgb(40, 40, 40)";R1="rgb(218, 165, 32)";ktt="rgb(255, 255, 255)",Ttt="rgb(0, 0, 0)",ERt="rgba(0, 0, 0, 0.6)",MRt="rgb(200, 200, 200)",CRt="rgb(0, 0, 0)";Vtt=1.6,NRt=11/21,ARt=.6,Gtt=.1,Htt=.1,YA=3,Wtt=.1,RRt=.8;ORt=({left_labels:n,right_labels:e,transform:t,soup:i,board_bounds:r,svgWidth:s,svgHeight:o,styleScale:a})=>{let c=new Map,l={transform:t,soup:i,board_bounds:r};return Ett("left",n,{...l,svgHeight:o,styleScale:a},c),Ett("right",e,{...l,svgHeight:o,styleScale:a},c),c};Mtt=["pcb_board","pcb_smtpad","pcb_hole","pcb_plated_hole","pcb_component","pcb_port"];Ctt={0:{width:13,height:27,ascent:22,descent:5,left:-1,right:12},1:{width:13,height:27,ascent:22,descent:5,left:-3,right:9},2:{width:13,height:27,ascent:22,descent:5,left:-1,right:12},3:{width:13,height:27,ascent:22,descent:5,left:-1,right:12},4:{width:13,height:27,ascent:22,descent:5,left:0,right:12},5:{width:13,height:27,ascent:22,descent:5,left:-1,right:12},6:{width:13,height:27,ascent:22,descent:5,left:-1,right:12},7:{width:13,height:27,ascent:22,descent:5,left:-1,right:12},8:{width:13,height:27,ascent:22,descent:5,left:-1,right:12},9:{width:13,height:27,ascent:22,descent:5,left:-1,right:12}," ":{width:7,height:27,ascent:22,descent:5,left:0,right:0},"!":{width:7,height:27,ascent:22,descent:5,left:-2,right:5},'"':{width:9,height:27,ascent:22,descent:5,left:-1,right:7},"#":{width:13,height:27,ascent:22,descent:5,left:0,right:13},$:{width:13,height:27,ascent:22,descent:5,left:-1,right:12},"%":{width:21,height:27,ascent:22,descent:5,left:-1,right:20},"&":{width:16,height:27,ascent:22,descent:5,left:-1,right:15},"'":{width:5,height:27,ascent:22,descent:5,left:-1,right:3},"(":{width:8,height:27,ascent:22,descent:5,left:-1,right:7},")":{width:8,height:27,ascent:22,descent:5,left:-1,right:7},"*":{width:9,height:27,ascent:22,descent:5,left:-1,right:8},"+":{width:14,height:27,ascent:22,descent:5,left:-1,right:13},",":{width:7,height:27,ascent:22,descent:5,left:-2,right:5},"-":{width:8,height:27,ascent:22,descent:5,left:-1,right:7},".":{width:7,height:27,ascent:22,descent:5,left:-2,right:5},"/":{width:7,height:27,ascent:22,descent:5,left:0,right:7},":":{width:7,height:27,ascent:22,descent:5,left:-2,right:5},";":{width:7,height:27,ascent:22,descent:5,left:-2,right:5},"<":{width:14,height:27,ascent:22,descent:5,left:-1,right:13},"=":{width:14,height:27,ascent:22,descent:5,left:-1,right:13},">":{width:14,height:27,ascent:22,descent:5,left:-1,right:13},"?":{width:13,height:27,ascent:22,descent:5,left:-1,right:12},"@":{width:24,height:27,ascent:22,descent:5,left:-1,right:23},A:{width:16,height:27,ascent:22,descent:5,left:0,right:16},B:{width:16,height:27,ascent:22,descent:5,left:-2,right:15},C:{width:17,height:27,ascent:22,descent:5,left:-1,right:16},D:{width:17,height:27,ascent:22,descent:5,left:-2,right:16},E:{width:16,height:27,ascent:22,descent:5,left:-2,right:15},F:{width:15,height:27,ascent:22,descent:5,left:-2,right:14},G:{width:19,height:27,ascent:22,descent:5,left:-1,right:17},H:{width:17,height:27,ascent:22,descent:5,left:-2,right:15},I:{width:7,height:27,ascent:22,descent:5,left:-2,right:5},J:{width:12,height:27,ascent:22,descent:5,left:-1,right:10},K:{width:16,height:27,ascent:22,descent:5,left:-2,right:16},L:{width:13,height:27,ascent:22,descent:5,left:-2,right:12},M:{width:20,height:27,ascent:22,descent:5,left:-2,right:18},N:{width:17,height:27,ascent:22,descent:5,left:-2,right:15},O:{width:19,height:27,ascent:22,descent:5,left:-1,right:18},P:{width:16,height:27,ascent:22,descent:5,left:-2,right:15},Q:{width:19,height:27,ascent:22,descent:5,left:-1,right:18},R:{width:17,height:27,ascent:22,descent:5,left:-2,right:17},S:{width:16,height:27,ascent:22,descent:5,left:-1,right:15},T:{width:15,height:27,ascent:22,descent:5,left:-1,right:14},U:{width:17,height:27,ascent:22,descent:5,left:-2,right:15},V:{width:16,height:27,ascent:22,descent:5,left:0,right:16},W:{width:23,height:27,ascent:22,descent:5,left:0,right:22},X:{width:16,height:27,ascent:22,descent:5,left:0,right:16},Y:{width:16,height:27,ascent:22,descent:5,left:0,right:16},Z:{width:15,height:27,ascent:22,descent:5,left:0,right:14},"[":{width:7,height:27,ascent:22,descent:5,left:-2,right:6},"\\":{width:7,height:27,ascent:22,descent:5,left:0,right:7},"]":{width:7,height:27,ascent:22,descent:5,left:0,right:5},"^":{width:11,height:27,ascent:22,descent:5,left:-1,right:11},_:{width:13,height:27,ascent:22,descent:5,left:0,right:14},"`":{width:8,height:27,ascent:22,descent:5,left:-1,right:5},a:{width:13,height:27,ascent:22,descent:5,left:-1,right:12},b:{width:13,height:27,ascent:22,descent:5,left:-2,right:12},c:{width:12,height:27,ascent:22,descent:5,left:-1,right:12},d:{width:13,height:27,ascent:22,descent:5,left:-1,right:12},e:{width:13,height:27,ascent:22,descent:5,left:-1,right:12},f:{width:7,height:27,ascent:22,descent:5,left:0,right:8},g:{width:13,height:27,ascent:22,descent:5,left:-1,right:12},h:{width:13,height:27,ascent:22,descent:5,left:-2,right:12},i:{width:5,height:27,ascent:22,descent:5,left:-2,right:4},j:{width:5,height:27,ascent:22,descent:5,left:1,right:4},k:{width:12,height:27,ascent:22,descent:5,left:-2,right:12},l:{width:5,height:27,ascent:22,descent:5,left:-2,right:4},m:{width:20,height:27,ascent:22,descent:5,left:-2,right:18},n:{width:13,height:27,ascent:22,descent:5,left:-2,right:12},o:{width:13,height:27,ascent:22,descent:5,left:-1,right:12},p:{width:13,height:27,ascent:22,descent:5,left:-2,right:12},q:{width:13,height:27,ascent:22,descent:5,left:-1,right:12},r:{width:8,height:27,ascent:22,descent:5,left:-2,right:8},s:{width:12,height:27,ascent:22,descent:5,left:-1,right:11},t:{width:7,height:27,ascent:22,descent:5,left:0,right:6},u:{width:13,height:27,ascent:22,descent:5,left:-2,right:12},v:{width:12,height:27,ascent:22,descent:5,left:0,right:12},w:{width:17,height:27,ascent:22,descent:5,left:0,right:17},x:{width:12,height:27,ascent:22,descent:5,left:0,right:12},y:{width:12,height:27,ascent:22,descent:5,left:0,right:12},z:{width:12,height:27,ascent:22,descent:5,left:0,right:11},"{":{width:8,height:27,ascent:22,descent:5,left:-1,right:7},"|":{width:6,height:27,ascent:22,descent:5,left:-2,right:4},"}":{width:8,height:27,ascent:22,descent:5,left:-1,right:7},"~":{width:14,height:27,ascent:22,descent:5,left:-1,right:13}},Yw=n=>{if(!n)return 0;let e=0;for(let t of n){let i=Ctt[t];i?e+=i.width:e+=Ctt["?"].width}return e/27},Ztt=(n,e)=>{if(n.column_widths&&n.column_widths.length>0&&n.row_heights&&n.row_heights.length>0){let u=p=>typeof p=="number"?p:p.endsWith("mm")?parseFloat(p):p.endsWith("in")?parseFloat(p)*25.4:parseFloat(p);return{column_widths:n.column_widths.map(u),row_heights:n.row_heights.map(u)}}let t=e.filter(u=>u.type==="schematic_table_cell"&&u.schematic_table_id===n.schematic_table_id);if(t.length===0)return{column_widths:[],row_heights:[]};let i=t.reduce((u,p)=>Math.max(u,p.end_column_index),-1)+1,r=t.reduce((u,p)=>Math.max(u,p.end_row_index),-1)+1,{cell_padding:s=.2}=n,o=new Array(i).fill(0),a=new Array(r).fill(0),c={},l={};for(let u of t){let p=$_("reference_designator",u.font_size),y=Yw(u.text??"")*p+2*s,g=p*1.2+2*s,x=`${u.start_row_index}-${u.start_column_index}`;c[x]=y,l[x]=g}for(let u=0;u<r;u++)for(let p=0;p<i;p++){let f=`${u}-${p}`;c[f]&&c[f]>o[p]&&(o[p]=c[f]),l[f]&&l[f]>a[u]&&(a[u]=l[f])}for(let u of t){if(u.start_column_index===u.end_column_index&&u.start_row_index===u.end_row_index)continue;let p=`${u.start_row_index}-${u.start_column_index}`,f=c[p],y=l[p];if(f===void 0||y===void 0)continue;let g=0;for(let v=u.start_column_index;v<=u.end_column_index;v++)g+=o[v];if(f>g){let P=(f-g)/(u.end_column_index-u.start_column_index+1);for(let w=u.start_column_index;w<=u.end_column_index;w++)o[w]+=P}let x=0;for(let v=u.start_row_index;v<=u.end_row_index;v++)x+=a[v];if(y>x){let P=(y-x)/(u.end_row_index-u.start_row_index+1);for(let w=u.start_row_index;w<=u.end_row_index;w++)a[w]+=P}}return{column_widths:o,row_heights:a}},j_=n=>{switch(n){case"top":return{x:0,y:-1};case"bottom":return{x:0,y:1};case"left":return{x:1,y:0};case"right":return{x:-1,y:0}}throw new Error(`Invalid side: ${n}`)},pl=.3,F_=.3,z_=.06,BRt={top_left:"start",top_right:"end",middle_left:"start",middle_right:"end",bottom_left:"start",bottom_right:"end",center:"middle",middle_top:"middle",middle_bottom:"middle"},YRt={top_left:"hanging",top_right:"hanging",bottom_left:"ideographic",bottom_right:"ideographic",center:"middle",middle_left:"middle",middle_right:"middle",middle_top:"hanging",middle_bottom:"ideographic"};Vi=n=>Math.abs(n.a)*.02,GRt=(n,e)=>{let t=n<0?n+2*Math.PI:n,i=e<0?e+2*Math.PI:e,r=Math.abs(t-i);return r>Math.PI&&(r=2*Math.PI-r),r},HRt=({schPorts:n,symbol:e,schComponent:t})=>{let i=n.map(a=>{let c=a.center.x-t.center.x,l=a.center.y-t.center.y;return{port:a,angle:Math.atan2(l,c)}}),r=e.ports.map(a=>{let c=a.x-e.center.x,l=a.y-e.center.y;return{port:a,angle:Math.atan2(l,c)}});i.sort((a,c)=>a.angle-c.angle),r.sort((a,c)=>a.angle-c.angle);let s=[],o=new Set;for(let a of i){let c=null;for(let l of r){if(o.has(l.port))continue;let u=GRt(a.angle,l.angle);(c===null||u<c.angleDiff)&&(c={symbolPort:l.port,angleDiff:u})}c&&c.angleDiff<Math.PI/4&&(s.push({schPort:a.port,symbolPort:c.symbolPort}),o.add(c.symbolPort))}return s};XA=({text:n,realCenter:e,realToScreenTransform:t})=>{let i=st(t,e);return{type:"element",name:"text",value:"",attributes:{x:i.x.toString(),y:i.y.toString(),fill:"red","text-anchor":"middle","dominant-baseline":"middle","font-family":"sans-serif","font-size":`${Ba(t,"error")}px`},children:[{type:"text",value:n,name:"",attributes:{},children:[]}]}},Ktt=(n,e)=>{for(let t of n){if(t.type!=="source_trace")continue;let i=t;if(Array.isArray(i.connected_source_port_ids)&&i.connected_source_port_ids.includes(e))return!0}return!1},qRt={top_left:"start",top_right:"end",middle_left:"start",middle_right:"end",bottom_left:"start",bottom_right:"end",center:"middle",middle_top:"middle",middle_bottom:"middle"},ZRt=({component:n,transform:e,circuitJson:t,colorMap:i})=>{let r=[],s=yi[n.symbol_name];if(!s)return[XA({text:`Symbol not found: ${n.symbol_name}`,realCenter:n.center,realToScreenTransform:e})];let o=Me(t).schematic_port.list({schematic_component_id:n.schematic_component_id}),a=Me(t).source_component.get(n.source_component_id),c=HRt({schPorts:o,symbol:s,schComponent:n});if(!c[0])return[XA({text:`Could not match ports for symbol ${n.symbol_name}`,realCenter:n.center,realToScreenTransform:e})];let l=WRt(c[1]?.symbolPort??s.center,c[1]?.schPort.center??n.center,c[0].symbolPort,c[0].schPort.center),u=s.primitives.filter(M=>M.type==="path"),p=s.primitives.filter(M=>M.type==="text"),f=s.primitives.filter(M=>M.type==="circle"),y=s.primitives.filter(M=>M.type==="box"),g=new Set;for(let M of c)Ktt(t,M.schPort.source_port_id)&&g.add(M.symbolPort);let x={minX:Math.min(...u.flatMap(M=>M.points.map(A=>A.x))),maxX:Math.max(...u.flatMap(M=>M.points.map(A=>A.x))),minY:Math.min(...u.flatMap(M=>M.points.map(A=>A.y))),maxY:Math.max(...u.flatMap(M=>M.points.map(A=>A.y)))},[v,P]=st(Fe(e,l),[x.minX,x.minY]),[w,k]=st(Fe(e,l),[x.maxX,x.maxY]),T=Math.abs(k-P),I=Math.min(P,k),E=Math.abs(w-v),N=Math.min(v,w);r.push({name:"rect",type:"element",value:"",attributes:{class:"component-overlay",x:N.toString(),y:I.toString(),width:E.toString(),height:T.toString(),fill:"transparent"},children:[]});for(let M of u){let{points:A,color:R,closed:j,fill:B}=M;r.push({type:"element",name:"path",attributes:{d:A.map((G,U)=>{let[H,tt]=st(Fe(e,l),[G.x,G.y]);return`${U===0?"M":"L"} ${H} ${tt}`}).join(" ")+(j?" Z":""),stroke:i.schematic.component_outline,fill:"none","stroke-width":`${Vi(e)}px`,"stroke-linecap":"round"},value:"",children:[]})}for(let M of p){let A=st(Fe(e,l),M),R="";M.text==="{REF}"?R=a?.name??"":M.text==="{VAL}"&&(R=n.symbol_display_value??"");let G=Math.abs(x.maxY-x.minY)*.1,U=Math.abs(l.a),H=0;M.anchor.includes("bottom")?H=G*U:M.anchor.includes("top")&&(H=-G*U);let tt=M.anchor.includes("bottom")?"auto":M.anchor.includes("top")?"hanging":"middle",et=M.text==="{REF}";r.push({name:"text",type:"element",attributes:{x:A.x.toString(),y:(A.y+H).toString(),...et?{stroke:i.schematic.background,"stroke-width":`${Vi(e)}px`,"paint-order":"stroke"}:{},fill:i.schematic.label_local,"font-family":"sans-serif","text-anchor":qRt[M.anchor],"dominant-baseline":tt,"font-size":`${Ba(e,"reference_designator")}px`},value:"",children:[{type:"text",value:R,name:"",attributes:{},children:[]}]})}for(let M of y){let A=st(Fe(e,l),M),R=Fe(e,l).a;r.push({name:"rect",type:"element",attributes:{x:A.x.toString(),y:A.y.toString(),width:(M.width*R).toString(),height:(M.height*R).toString(),fill:"red"},value:"",children:[]})}for(let M of s.ports){if(g.has(M))continue;let A=st(Fe(e,l),M);r.push({type:"element",name:"circle",attributes:{cx:A.x.toString(),cy:A.y.toString(),r:`${Math.abs(e.a)*.02}px`,"stroke-width":`${Vi(e)}px`,fill:"none",stroke:i.schematic.component_outline},value:"",children:[]})}for(let M of f){let A=st(Fe(e,l),M),R=Math.abs(M.radius*e.a);r.push({type:"element",name:"circle",attributes:{cx:A.x.toString(),cy:A.y.toString(),r:`${R}px`,"stroke-width":`${Vi(e)}px`,fill:"none",stroke:i.schematic.component_outline},value:"",children:[]})}return r},O1=.02,Itt=(n,e,t,i,r)=>{let s=Math.PI/6,o={x:n.x-t*Math.cos(e-s),y:n.y-t*Math.sin(e-s)},a={x:n.x-t*Math.cos(e+s),y:n.y-t*Math.sin(e+s)};return{name:"polygon",type:"element",attributes:{points:`${n.x},${n.y} ${o.x},${o.y} ${a.x},${a.y}`,fill:"white",stroke:i,"stroke-width":`${r}px`},value:"",children:[]}},KRt=({schPort:n,schComponent:e,transform:t,circuitJson:i})=>{let r=[],s=Me(i).source_port.get(n.source_port_id),o={x:n.center.x,y:n.center.y},a=n.distance_from_component_edge??.4;switch(n.side_of_component){case"left":o.x+=a;break;case"right":o.x-=a;break;case"top":o.y-=a;break;case"bottom":o.y+=a;break}let c=st(t,n.center),l=st(t,o),u=Ktt(i,n.source_port_id),p={...n.center};if(!u)switch(n.side_of_component){case"left":p.x+=O1;break;case"right":p.x-=O1;break;case"top":p.y-=O1;break;case"bottom":p.y+=O1;break}let f=st(t,p);r.push({name:"line",type:"element",attributes:{class:"component-pin",x1:l.x.toString(),y1:l.y.toString(),x2:f.x.toString(),y2:f.y.toString(),"stroke-width":`${Vi(t)}px`},value:"",children:[]});let y=Math.abs(t.a)*O1,g=[];u||g.push({name:"circle",type:"element",attributes:{class:"component-pin",cx:c.x.toString(),cy:c.y.toString(),r:y.toString(),"stroke-width":`${Vi(t)}px`},value:"",children:[]}),g.push({name:"rect",type:"element",attributes:{x:(c.x-y).toString(),y:(c.y-y).toString(),width:(y*2).toString(),height:(y*2).toString(),opacity:"0"},value:"",children:[]}),r.push({name:"g",type:"element",value:"",attributes:{"data-schematic-port-id":n.source_port_id},children:g});let{has_input_arrow:x,has_output_arrow:v}=n;if((x||v)&&n.side_of_component){let P=Math.abs(t.a)*.1,w=Mi.schematic.component_outline,k=P*Math.cos(Math.PI/6),T=Vi(t)/3,I=0,E=0;n.side_of_component==="left"?(I=0,E=Math.PI):n.side_of_component==="right"?(I=Math.PI,E=0):n.side_of_component==="top"?(I=Math.PI/2,E=-Math.PI/2):n.side_of_component==="bottom"&&(I=-Math.PI/2,E=Math.PI/2);let N=x&&v,M={...l},A={...l};if(N){let R=k;n.side_of_component==="left"?A.x-=R:n.side_of_component==="right"?A.x+=R:n.side_of_component==="top"?A.y-=R:n.side_of_component==="bottom"&&(A.y+=R)}if(x&&r.push(Itt(M,I,P,w,T)),v){let R={x:A.x+P*Math.cos(E),y:A.y+P*Math.sin(E)};r.push(Itt(R,E,P,w,T))}}return r},JRt=n=>{let e=[],{schPort:t,schComponent:i,transform:r,circuitJson:s}=n,o={x:t.center.x,y:t.center.y};if(!t.side_of_component)return[];let a=j_(t.side_of_component),c=t.distance_from_component_edge??.4;o.x+=a.x*c/2,o.y+=a.y*c/2,t.side_of_component==="top"||t.side_of_component==="bottom"?o.x-=.02:o.y+=.02;let l=st(r,o);return e.push({name:"text",type:"element",attributes:{class:"pin-number",x:l.x.toString(),y:l.y.toString(),style:"font-family: sans-serif;",fill:Mi.schematic.pin_number,"text-anchor":"middle","dominant-baseline":"auto","font-size":`${Ba(r,"pin_number")}px`,transform:t.side_of_component==="top"||t.side_of_component==="bottom"?`rotate(-90 ${l.x} ${l.y})`:""},children:[{type:"text",value:t.pin_number?.toString()||"",name:"",attributes:{},children:[]}],value:""}),e},Ntt=.1,QRt=n=>{let e=[],{schPort:t,schComponent:i,transform:r,circuitJson:s}=n,o={x:t.center.x,y:t.center.y};if(!t.side_of_component)return[];let a=j_(t.side_of_component),c=t.distance_from_component_edge??.4;o.x+=a.x*(c+Ntt),o.y+=a.y*(c+Ntt);let l=st(r,o),u=t.display_pin_label??i.port_labels?.[`${t.pin_number}`];if(!u)return[];let p=u.startsWith("N_"),f=p?u.slice(2):u,y=Ba(r,p?"negated_pin_number":"pin_number");return e.push({name:"text",type:"element",attributes:{class:"pin-number",x:l.x.toString(),y:l.y.toString(),style:`font-family: sans-serif;${p?" text-decoration: overline;":""}`,fill:Mi.schematic.pin_number,"text-anchor":t.side_of_component==="left"||t.side_of_component==="bottom"?"start":"end","dominant-baseline":"middle","font-size":`${y}px`,transform:t.side_of_component==="top"||t.side_of_component==="bottom"?`rotate(-90 ${l.x} ${l.y})`:""},children:[{type:"text",value:f||"",name:"",attributes:{},children:[]}],value:""}),e},t8t=n=>{let e=[],{schPort:t,schComponent:i,transform:r,circuitJson:s}=n;return e.push(...KRt(n)),e.push(...JRt(n)),e.push(...QRt(n)),e},Jtt=({elm:n,transform:e,colorMap:t})=>{let i=st(e,n.position),r={center:"middle",center_right:"end",bottom_left:"start",bottom_center:"middle",bottom_right:"end",left:"start",right:"end",top:"middle",bottom:"middle",top_left:"start",top_center:"middle",top_right:"end",center_left:"start"},s={center:"middle",center_right:"middle",bottom_left:"ideographic",bottom_center:"ideographic",bottom_right:"ideographic",left:"middle",right:"middle",top:"hanging",bottom:"ideographic",top_left:"hanging",top_center:"hanging",top_right:"hanging",center_left:"middle"},o=n.text.split(`
`),a=o.length===1?[{type:"text",value:n.text,name:n.schematic_text_id,attributes:{},children:[]}]:o.map((c,l)=>({type:"element",name:"tspan",value:"",attributes:{x:i.x.toString(),...l>0?{dy:"1em"}:{}},children:[{type:"text",value:c,name:l===0?n.schematic_text_id:"",attributes:{},children:[]}]}));return{type:"element",name:"text",value:"",attributes:{x:i.x.toString(),y:i.y.toString(),fill:n.color??t.schematic.sheet_label,"text-anchor":r[n.anchor],"dominant-baseline":s[n.anchor],"font-family":"sans-serif","font-size":`${Ba(e,"reference_designator",n.font_size)}px`,transform:`rotate(${n.rotation}, ${i.x}, ${i.y})`},children:a}},e8t=({component:n,transform:e,circuitJson:t,colorMap:i})=>{let r=[],s=st(e,{x:n.center.x-n.size.width/2,y:n.center.y+n.size.height/2}),o=st(e,{x:n.center.x+n.size.width/2,y:n.center.y-n.size.height/2}),a=o.x-s.x,c=o.y-s.y;r.push({name:"rect",type:"element",value:"",attributes:{class:"component chip",x:s.x.toString(),y:s.y.toString(),width:a.toString(),height:c.toString(),"stroke-width":`${Vi(e)}px`,fill:i.schematic.component_body,stroke:i.schematic.component_outline},children:[]}),r.push({name:"rect",type:"element",value:"",attributes:{class:"component-overlay",x:s.x.toString(),y:s.y.toString(),width:a.toString(),height:c.toString(),fill:"transparent"},children:[]});let l=Me(t).schematic_text.list();for(let p of l)p.schematic_component_id===n.schematic_component_id&&r.push(Jtt({elm:p,transform:e,colorMap:i}));let u=Me(t).schematic_port.list({schematic_component_id:n.schematic_component_id});for(let p of u)r.push(...t8t({schPort:p,schComponent:n,transform:e,circuitJson:t}));return r};o8t=({schNetLabel:n,realToScreenTransform:e,colorMap:t})=>{if(!n.text)return[];let i=n.text.startsWith("N_"),r=i?n.text.slice(2):n.text,s=[],o=yi[n.symbol_name];if(!o)return s.push(XA({text:`Symbol not found: ${n.symbol_name}`,realCenter:n.center,realToScreenTransform:e})),s;let a=o.primitives.filter(H=>H.type==="path"),c=o.primitives.filter(H=>H.type==="text"),l=o.primitives.filter(H=>H.type==="circle"),u=o.primitives.filter(H=>H.type==="box"),p={minX:Math.min(...a.flatMap(H=>H.points.map(tt=>tt.x))),maxX:Math.max(...a.flatMap(H=>H.points.map(tt=>tt.x))),minY:Math.min(...a.flatMap(H=>H.points.map(tt=>tt.y))),maxY:Math.max(...a.flatMap(H=>H.points.map(tt=>tt.y)))},f=$_("net_label"),g=Yw(r||"")+pl*2+z_*r.length+F_,x=j_(n.anchor_side),v=n.anchor_position??{x:n.center.x-x.x*g*f/2,y:n.center.y-x.y*g*f/2},w=us(0/180*Math.PI),k={minX:Math.min(...o.primitives.flatMap(H=>H.type==="path"?H.points.map(tt=>tt.x):[])),maxX:Math.max(...o.primitives.flatMap(H=>H.type==="path"?H.points.map(tt=>tt.x):[])),minY:Math.min(...o.primitives.flatMap(H=>H.type==="path"?H.points.map(tt=>tt.y):[])),maxY:Math.max(...o.primitives.flatMap(H=>H.type==="path"?H.points.map(tt=>tt.y):[]))},T=o.ports?.[0]?{x:o.ports[0].x,y:o.ports[0].y}:{x:k.minX,y:(k.minY+k.maxY)/2},I=st(w,T),E=Fe(yn(v.x-I.x,v.y-I.y),w,Ei(1)),[N,M]=st(Fe(e,E),[p.minX,p.minY]),[A,R]=st(Fe(e,E),[p.maxX,p.maxY]),j=Math.abs(R-M),B=Math.min(M,R),G=Math.abs(A-N),U=Math.min(N,A);s.push({name:"rect",type:"element",value:"",attributes:{class:"component-overlay",x:U.toString(),y:B.toString(),width:G.toString(),height:j.toString(),fill:"transparent"},children:[]});for(let H of a){let tt=H.points.map((et,mt)=>{let[V,J]=st(Fe(e,E),[et.x,et.y]);return`${mt===0?"M":"L"} ${V} ${J}`}).join(" ");s.push({name:"path",type:"element",attributes:{d:tt+(H.closed?" Z":""),stroke:t.schematic.component_outline,fill:"none","stroke-width":`${Vi(e)}px`,"stroke-linecap":"round"},value:"",children:[]})}for(let H of c){let tt=st(Fe(e,E),H),et=H.text;et==="{REF}"?et=r||"":et==="{VAL}"&&(et="");let V=Math.abs(e.a)*.1,J={x:tt.x,y:tt.y};s.push({name:"text",type:"element",attributes:{x:J.x.toString(),y:J.y.toString(),fill:t.schematic.label_local,"font-family":"sans-serif","text-anchor":BRt[H.anchor],"dominant-baseline":YRt[H.anchor],"font-size":`${Ba(e,"reference_designator")}px`,...i&&et===r?{style:"text-decoration: overline;"}:{}},children:[{type:"text",value:et,name:"",attributes:{},children:[]}],value:""})}for(let H of u){let tt=st(Fe(e,E),H),et=Fe(e,E).a;s.push({name:"rect",type:"element",attributes:{x:tt.x.toString(),y:tt.y.toString(),width:(H.width*et).toString(),height:(H.height*et).toString(),fill:"red"},value:"",children:[]})}for(let H of l){let tt=st(Fe(e,E),H),et=Fe(e,E).a;s.push({name:"circle",type:"element",attributes:{cx:tt.x.toString(),cy:tt.y.toString(),r:(H.radius*et).toString(),fill:"none",stroke:t.schematic.component_outline,"stroke-width":`${Vi(e)}px`},value:"",children:[]})}return s},a8t=({schNetLabel:n,realToScreenTransform:e,colorMap:t})=>{if(!n.text)return[];let i=n.text;if(n.symbol_name)return o8t({schNetLabel:n,realToScreenTransform:e,colorMap:t});let r=[],s=Ba(e,"net_label"),o=$_("net_label"),a=Yw(i||""),c=st(e,n.center),l=j_(n.anchor_side),u={...l};u.y*=-1;let p=a+pl*2+z_*i.length+F_,f=n.anchor_position?st(e,n.anchor_position):{x:c.x-u.x*p*s/2,y:c.y-u.y*p*s/2},y=n.anchor_position??{x:n.center.x-l.x*p*o/2,y:n.center.y-l.y*p*o/2},g={left:0,top:-90,bottom:90,right:180}[n.anchor_side],x=[{x:0,y:0},{x:pl,y:.6},{x:pl*2+F_+z_*i.length+a,y:.6},{x:pl*2+F_+z_*i.length+a,y:-.6},{x:pl,y:-.6}].map(T=>st(Fe(e,yn(y.x,y.y),Ei(o),us(g/180*Math.PI)),T)),v=`
    M ${x[0].x},${x[0].y}
    L ${x[1].x},${x[1].y}
    L ${x[2].x},${x[2].y}
    L ${x[3].x},${x[3].y}
    L ${x[4].x},${x[4].y}
    Z
  `;r.push({name:"path",type:"element",attributes:{class:"net-label",d:v,fill:t.schematic.label_background,stroke:t.schematic.label_global,"stroke-width":`${Vi(e)}px`},value:"",children:[]});let P={x:f.x+u.x*s*.5,y:f.y+u.y*s*.5},w={left:"start",top:"start",bottom:"start",right:"end"}[n.anchor_side],k={left:"",right:"",top:`rotate(90 ${P.x} ${P.y})`,bottom:`rotate(-90 ${P.x} ${P.y})`}[n.anchor_side];return r.push({name:"text",type:"element",attributes:{class:"net-label-text",x:P.x.toString(),y:P.y.toString(),fill:t.schematic.label_global,"text-anchor":w,"dominant-baseline":"central","font-family":"sans-serif","font-variant-numeric":"tabular-nums","font-size":`${s}px`,transform:k},children:[{type:"text",value:i||"",name:"",attributes:{},children:[]}],value:""}),r},c8t=({schematicBox:n,transform:e,colorMap:t})=>{let i=st(e,{x:n.x,y:n.y}),r=st(e,{x:n.x+n.width,y:n.y+n.height}),s=Math.min(i.y,r.y),o=Math.max(i.y,r.y),a=Math.min(i.x,r.x),c=Math.max(i.x,r.x),l=Vi(e),u={class:"schematic-box",x:a.toString(),y:s.toString(),width:(c-a).toString(),height:(o-s).toString(),"stroke-width":`${l}px`,stroke:t.schematic.component_outline||"black",fill:"transparent"};if(n.is_dashed){let p=8*l,f=4*l;u["stroke-dasharray"]=`${p} ${f}`}return[{name:"rect",type:"element",value:"",attributes:u,children:[]}]},l8t=({schematicTable:n,transform:e,colorMap:t,circuitJson:i})=>{let{anchor_position:r,border_width:s=.05,anchor:o="center"}=n,{column_widths:a,row_heights:c}=Ztt(n,i),l=a.reduce((N,M)=>N+M,0),u=c.reduce((N,M)=>N+M,0),p=r.x,f=r.y;o.includes("center")?p-=l/2:o.includes("right")&&(p-=l),o.includes("center")?f+=u/2:o.includes("bottom")&&(f+=u);let y=[],g=s*Math.abs(e.a),x=Vi(e),[v,P]=st(e,[p,f]),[w,k]=st(e,[p+l,f-u]);y.push({name:"rect",type:"element",attributes:{x:v.toString(),y:P.toString(),width:(w-v).toString(),height:(k-P).toString(),fill:"none",stroke:t.schematic.table,"stroke-width":g.toString()},children:[],value:""});let T=i.filter(N=>N.type==="schematic_table_cell"&&N.schematic_table_id===n.schematic_table_id),I=p;for(let N=0;N<a.length-1;N++){I+=a[N];let M=f;for(let A=0;A<c.length;A++){let R=M-c[A];if(!T.some(B=>B.start_column_index<=N&&B.end_column_index>N&&B.start_row_index<=A&&B.end_row_index>=A)){let B=st(e,{x:I,y:M}),G=st(e,{x:I,y:R});y.push({name:"line",type:"element",attributes:{x1:B.x.toString(),y1:B.y.toString(),x2:G.x.toString(),y2:G.y.toString(),stroke:t.schematic.table,"stroke-width":x.toString()},children:[],value:""})}M=R}}let E=f;for(let N=0;N<c.length-1;N++){E-=c[N];let M=p;for(let A=0;A<a.length;A++){let R=M+a[A];if(!T.some(B=>B.start_row_index<=N&&B.end_row_index>N&&B.start_column_index<=A&&B.end_column_index>=A)){let B=st(e,{x:M,y:E}),G=st(e,{x:R,y:E});y.push({name:"line",type:"element",attributes:{x1:B.x.toString(),y1:B.y.toString(),x2:G.x.toString(),y2:G.y.toString(),stroke:t.schematic.table,"stroke-width":x.toString()},children:[],value:""})}M=R}}for(let N of T)if(N.text){let M=a.slice(N.start_column_index,N.end_column_index+1).reduce((J,nt)=>J+nt,0),A=c.slice(N.start_row_index,N.end_row_index+1).reduce((J,nt)=>J+nt,0),R=p+a.slice(0,N.start_column_index).reduce((J,nt)=>J+nt,0),j=f-c.slice(0,N.start_row_index).reduce((J,nt)=>J+nt,0),{cell_padding:B=.2}=n,G=N.horizontal_align??"center",U=N.vertical_align??"middle",H={x:R+M/2,y:j-A/2};G==="left"?H.x=R+B:G==="right"&&(H.x=R+M-B),U==="top"?H.y=j-B:U==="bottom"&&(H.y=j-A+B);let tt=st(e,H),et=Ba(e,"reference_designator",N.font_size),mt={left:"start",center:"middle",right:"end"},V={top:"hanging",middle:"middle",bottom:"ideographic"};y.push({name:"text",type:"element",attributes:{x:tt.x.toString(),y:tt.y.toString(),"font-size":`${et}px`,"text-anchor":mt[G],"dominant-baseline":V[U],fill:t.schematic.table,"font-family":"sans-serif"},children:[{type:"text",value:N.text,name:"",attributes:{},children:[]}],value:""})}return[{name:"g",type:"element",attributes:{"data-schematic-table-id":n.schematic_table_id},children:y,value:""}]},u8t=.02,p8t=({schPort:n,transform:e})=>{let t=st(e,n.center),i=Math.abs(e.a)*u8t*2;return[{name:"g",type:"element",value:"",attributes:{class:"schematic-port-hover","data-schematic-port-id":n.source_port_id},children:[{name:"circle",type:"element",value:"",attributes:{cx:t.x.toString(),cy:t.y.toString(),r:i.toString(),fill:"red",opacity:"0"},children:[]}]}]},Qtt=({component:n,transform:e,circuitJson:t})=>{let i=Me(t).schematic_port.list({schematic_component_id:n.schematic_component_id}),r=[];for(let s of i)r.push(...p8t({schPort:s,transform:e}));return r};y8t=UA;g8t=1200,x8t=600,jn={top:64,right:100,bottom:80,left:100},Att="#1f77b4";N8t=15,iet=16,A8t=24;D8t=1200,j8t=1200,ret=.55;$tt=["pcb_board","pcb_solder_paste"]});var git=ue((Z0e,cP)=>{"use strict";function br(n){this._line=this._col=this._pos=0,this._stream=n}br.not_whitespace_or_end=/^(\S|$)/;br.space_quote_paren_escaped_or_end=/^(\s|\\|"|'|`|,|\(|\)|$)/;br.string_or_escaped_or_end=/^(\\|"|$)/;br.string_delimiters=/["]/;br.quotes=/['`,]/;br.quotes_map={"'":"quote","`":"quasiquote",",":"unquote"};br.prototype={peek:D7t,consume:j7t,until:B7t,error:$7t,string:Y7t,atom:X7t,quoted:U7t,expr:V7t,list:G7t};cP.exports=function n(e){var t=new n.Parser(e),i=t.expr();return i instanceof Error?i:t.peek()!=""?t.error("Superfluous characters after expression: `"+t.peek()+"`"):i};cP.exports.Parser=br;cP.exports.SyntaxError=Error;function $7t(n){var e=new Error("Syntax error: "+n);return e.line=this._line+1,e.col=this._col+1,e}function D7t(){return this._stream.length==this._pos?"":this._stream[this._pos]}function j7t(){if(this._stream.length==this._pos)return"";var n=this._stream[this._pos];return this._pos+=1,n=="\r"?(this.peek()==`
`&&(this._pos+=1,n+=`
`),this._line++,this._col=0):n==`
`?(this._line++,this._col=0):this._col++,n}function B7t(n){for(var e="";!n.test(this.peek());)e+=this.consume();return e}function Y7t(){for(var n=this.consume(),e="";;){e+=this.until(br.string_or_escaped_or_end);var t=this.peek();if(t=="")return this.error("Unterminated string literal");if(t==n){this.consume();break}if(t=="\\"){this.consume(),t=this.peek(),t=="r"?(this.consume(),e+="\r"):t=="t"?(this.consume(),e+="	"):t=="n"?(this.consume(),e+=`
`):t=="f"?(this.consume(),e+="\f"):t=="b"?(this.consume(),e+="\b"):e+=this.consume();continue}e+=this.consume()}return new String(e)}function X7t(){if(br.string_delimiters.test(this.peek()))return this.string();for(var n="";;){n+=this.until(br.space_quote_paren_escaped_or_end);var e=this.peek();if(e=="\\"){this.consume(),n+=this.consume();continue}break}return n}function U7t(){var n=this.consume(),e=br.quotes_map[n];e=="unquote"&&this.peek()=="@"&&(this.consume(),e="unquote-splicing",n=",@"),this.until(br.not_whitespace_or_end);var t=this.expr();return t instanceof Error?t:t===""?this.error("Unexpected `"+this.peek()+"` after `"+n+"`"):[e,t]}function V7t(){if(this.until(br.not_whitespace_or_end),br.quotes.test(this.peek()))return this.quoted();var n=this.peek()=="("?this.list():this.atom();return this.until(br.not_whitespace_or_end),n}function G7t(){if(this.peek()!="(")return this.error("Expected `(` - saw `"+this.peek()+"` instead.");this.consume();var n=[],e=this.expr();if(e instanceof Error)return e;if(e!=="")for(n.push(e);(e=this.expr())!=="";){if(e instanceof Error)return e;n.push(e)}return this.peek()!=")"?this.error("Expected `)` - saw: `"+this.peek()+"`"):(this.consume(),n)}});var irt=ue((K9,J9)=>{"use strict";(function(n,e){typeof K9=="object"&&typeof J9<"u"?J9.exports=e():typeof define=="function"&&define.amd?define(e):(n=typeof globalThis<"u"?globalThis:n||self,n.resolveURI=e())})(K9,(function(){"use strict";let n=/^[\w+.-]+:\/\//,e=/^([\w+.-]+:)\/\/([^@/#?]*@)?([^:/#?]*)(:\d+)?(\/[^#?]*)?(\?[^#]*)?(#.*)?/,t=/^file:(?:\/\/((?![a-z]:)[^/#?]*)?)?(\/?[^#?]*)(\?[^#]*)?(#.*)?/i;function i(v){return n.test(v)}function r(v){return v.startsWith("//")}function s(v){return v.startsWith("/")}function o(v){return v.startsWith("file:")}function a(v){return/^[.?#]/.test(v)}function c(v){let P=e.exec(v);return u(P[1],P[2]||"",P[3],P[4]||"",P[5]||"/",P[6]||"",P[7]||"")}function l(v){let P=t.exec(v),w=P[2];return u("file:","",P[1]||"","",s(w)?w:"/"+w,P[3]||"",P[4]||"")}function u(v,P,w,k,T,I,E){return{scheme:v,user:P,host:w,port:k,path:T,query:I,hash:E,type:7}}function p(v){if(r(v)){let w=c("http:"+v);return w.scheme="",w.type=6,w}if(s(v)){let w=c("http://foo.com"+v);return w.scheme="",w.host="",w.type=5,w}if(o(v))return l(v);if(i(v))return c(v);let P=c("http://foo.com/"+v);return P.scheme="",P.host="",P.type=v?v.startsWith("?")?3:v.startsWith("#")?2:4:1,P}function f(v){if(v.endsWith("/.."))return v;let P=v.lastIndexOf("/");return v.slice(0,P+1)}function y(v,P){g(P,P.type),v.path==="/"?v.path=P.path:v.path=f(P.path)+v.path}function g(v,P){let w=P<=4,k=v.path.split("/"),T=1,I=0,E=!1;for(let M=1;M<k.length;M++){let A=k[M];if(!A){E=!0;continue}if(E=!1,A!=="."){if(A===".."){I?(E=!0,I--,T--):w&&(k[T++]=A);continue}k[T++]=A,I++}}let N="";for(let M=1;M<T;M++)N+="/"+k[M];(!N||E&&!N.endsWith("/.."))&&(N+="/"),v.path=N}function x(v,P){if(!v&&!P)return"";let w=p(v),k=w.type;if(P&&k!==7){let I=p(P),E=I.type;switch(k){case 1:w.hash=I.hash;case 2:w.query=I.query;case 3:case 4:y(w,I);case 5:w.user=I.user,w.host=I.host,w.port=I.port;case 6:w.scheme=I.scheme}E>k&&(k=E)}g(w,k);let T=w.query+w.hash;switch(k){case 2:case 3:return T;case 4:{let I=w.path.slice(1);return I?a(P||v)&&!a(I)?"./"+I+T:I+T:T||"."}case 5:return w.path+T;default:return w.scheme+"//"+w.user+w.host+w.port+w.path+T}}return x}))});var MP=ue(Zo=>{"use strict";var nzt=Zo&&Zo.__extends||(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var s in r)r.hasOwnProperty(s)&&(i[s]=r[s])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})();Object.defineProperty(Zo,"__esModule",{value:!0});Zo.DetailContext=Zo.NoopContext=Zo.VError=void 0;var urt=(function(n){nzt(e,n);function e(t,i){var r=n.call(this,i)||this;return r.path=t,Object.setPrototypeOf(r,e.prototype),r}return e})(Error);Zo.VError=urt;var izt=(function(){function n(){}return n.prototype.fail=function(e,t,i){return!1},n.prototype.unionResolver=function(){return this},n.prototype.createContext=function(){return this},n.prototype.resolveUnion=function(e){},n})();Zo.NoopContext=izt;var prt=(function(){function n(){this._propNames=[""],this._messages=[null],this._score=0}return n.prototype.fail=function(e,t,i){return this._propNames.push(e),this._messages.push(t),this._score+=i,!1},n.prototype.unionResolver=function(){return new rzt},n.prototype.resolveUnion=function(e){for(var t,i,r=e,s=null,o=0,a=r.contexts;o<a.length;o++){var c=a[o];(!s||c._score>=s._score)&&(s=c)}s&&s._score>0&&((t=this._propNames).push.apply(t,s._propNames),(i=this._messages).push.apply(i,s._messages))},n.prototype.getError=function(e){for(var t=[],i=this._propNames.length-1;i>=0;i--){var r=this._propNames[i];e+=typeof r=="number"?"["+r+"]":r?"."+r:"";var s=this._messages[i];s&&t.push(e+" "+s)}return new urt(e,t.join("; "))},n.prototype.getErrorDetail=function(e){for(var t=[],i=this._propNames.length-1;i>=0;i--){var r=this._propNames[i];e+=typeof r=="number"?"["+r+"]":r?"."+r:"";var s=this._messages[i];s&&t.push({path:e,message:s})}for(var o=null,i=t.length-1;i>=0;i--)o&&(t[i].nested=[o]),o=t[i];return o},n})();Zo.DetailContext=prt;var rzt=(function(){function n(){this.contexts=[]}return n.prototype.createContext=function(){var e=new prt;return this.contexts.push(e),e},n})()});var l6=ue(ne=>{"use strict";var hs=ne&&ne.__extends||(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var s in r)r.hasOwnProperty(s)&&(i[s]=r[s])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})();Object.defineProperty(ne,"__esModule",{value:!0});ne.basicTypes=ne.BasicType=ne.TParamList=ne.TParam=ne.param=ne.TFunc=ne.func=ne.TProp=ne.TOptional=ne.opt=ne.TIface=ne.iface=ne.TEnumLiteral=ne.enumlit=ne.TEnumType=ne.enumtype=ne.TIntersection=ne.intersection=ne.TUnion=ne.union=ne.TTuple=ne.tuple=ne.TArray=ne.array=ne.TLiteral=ne.lit=ne.TName=ne.name=ne.TType=void 0;var frt=MP(),Hr=(function(){function n(){}return n})();ne.TType=Hr;function xl(n){return typeof n=="string"?mrt(n):n}function r6(n,e){var t=n[e];if(!t)throw new Error("Unknown type "+e);return t}function mrt(n){return new s6(n)}ne.name=mrt;var s6=(function(n){hs(e,n);function e(t){var i=n.call(this)||this;return i.name=t,i._failMsg="is not a "+t,i}return e.prototype.getChecker=function(t,i,r){var s=this,o=r6(t,this.name),a=o.getChecker(t,i,r);return o instanceof vr||o instanceof e?a:function(c,l){return a(c,l)?!0:l.fail(null,s._failMsg,0)}},e})(Hr);ne.TName=s6;function szt(n){return new o6(n)}ne.lit=szt;var o6=(function(n){hs(e,n);function e(t){var i=n.call(this)||this;return i.value=t,i.name=JSON.stringify(t),i._failMsg="is not "+i.name,i}return e.prototype.getChecker=function(t,i){var r=this;return function(s,o){return s===r.value?!0:o.fail(null,r._failMsg,-1)}},e})(Hr);ne.TLiteral=o6;function ozt(n){return new _rt(xl(n))}ne.array=ozt;var _rt=(function(n){hs(e,n);function e(t){var i=n.call(this)||this;return i.ttype=t,i}return e.prototype.getChecker=function(t,i){var r=this.ttype.getChecker(t,i);return function(s,o){if(!Array.isArray(s))return o.fail(null,"is not an array",0);for(var a=0;a<s.length;a++){var c=r(s[a],o);if(!c)return o.fail(a,null,1)}return!0}},e})(Hr);ne.TArray=_rt;function azt(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return new yrt(n.map(function(t){return xl(t)}))}ne.tuple=azt;var yrt=(function(n){hs(e,n);function e(t){var i=n.call(this)||this;return i.ttypes=t,i}return e.prototype.getChecker=function(t,i){var r=this.ttypes.map(function(o){return o.getChecker(t,i)}),s=function(o,a){if(!Array.isArray(o))return a.fail(null,"is not an array",0);for(var c=0;c<r.length;c++){var l=r[c](o[c],a);if(!l)return a.fail(c,null,1)}return!0};return i?function(o,a){return s(o,a)?o.length<=r.length?!0:a.fail(r.length,"is extraneous",2):!1}:s},e})(Hr);ne.TTuple=yrt;function czt(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return new grt(n.map(function(t){return xl(t)}))}ne.union=czt;var grt=(function(n){hs(e,n);function e(t){var i=n.call(this)||this;i.ttypes=t;var r=t.map(function(o){return o instanceof s6||o instanceof o6?o.name:null}).filter(function(o){return o}),s=t.length-r.length;return r.length?(s>0&&r.push(s+" more"),i._failMsg="is none of "+r.join(", ")):i._failMsg="is none of "+s+" types",i}return e.prototype.getChecker=function(t,i){var r=this,s=this.ttypes.map(function(o){return o.getChecker(t,i)});return function(o,a){for(var c=a.unionResolver(),l=0;l<s.length;l++){var u=s[l](o,c.createContext());if(u)return!0}return a.resolveUnion(c),a.fail(null,r._failMsg,0)}},e})(Hr);ne.TUnion=grt;function lzt(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return new xrt(n.map(function(t){return xl(t)}))}ne.intersection=lzt;var xrt=(function(n){hs(e,n);function e(t){var i=n.call(this)||this;return i.ttypes=t,i}return e.prototype.getChecker=function(t,i){var r=new Set,s=this.ttypes.map(function(o){return o.getChecker(t,i,r)});return function(o,a){var c=s.every(function(l){return l(o,a)});return c?!0:a.fail(null,null,0)}},e})(Hr);ne.TIntersection=xrt;function uzt(n){return new a6(n)}ne.enumtype=uzt;var a6=(function(n){hs(e,n);function e(t){var i=n.call(this)||this;return i.members=t,i.validValues=new Set,i._failMsg="is not a valid enum value",i.validValues=new Set(Object.keys(t).map(function(r){return t[r]})),i}return e.prototype.getChecker=function(t,i){var r=this;return function(s,o){return r.validValues.has(s)?!0:o.fail(null,r._failMsg,0)}},e})(Hr);ne.TEnumType=a6;function pzt(n,e){return new brt(n,e)}ne.enumlit=pzt;var brt=(function(n){hs(e,n);function e(t,i){var r=n.call(this)||this;return r.enumName=t,r.prop=i,r._failMsg="is not "+t+"."+i,r}return e.prototype.getChecker=function(t,i){var r=this,s=r6(t,this.enumName);if(!(s instanceof a6))throw new Error("Type "+this.enumName+" used in enumlit is not an enum type");var o=s.members[this.prop];if(!s.members.hasOwnProperty(this.prop))throw new Error("Unknown value "+this.enumName+"."+this.prop+" used in enumlit");return function(a,c){return a===o?!0:c.fail(null,r._failMsg,-1)}},e})(Hr);ne.TEnumLiteral=brt;function hzt(n){return Object.keys(n).map(function(e){return dzt(e,n[e])})}function dzt(n,e){return e instanceof c6?new i6(n,e.ttype,!0):new i6(n,xl(e),!1)}function fzt(n,e){return new vrt(n,hzt(e))}ne.iface=fzt;var vrt=(function(n){hs(e,n);function e(t,i){var r=n.call(this)||this;return r.bases=t,r.props=i,r.propSet=new Set(i.map(function(s){return s.name})),r}return e.prototype.getChecker=function(t,i,r){var s=this,o=this.bases.map(function(f){return r6(t,f).getChecker(t,i)}),a=this.props.map(function(f){return f.ttype.getChecker(t,i)}),c=new frt.NoopContext,l=this.props.map(function(f,y){return!f.isOpt&&!a[y](void 0,c)}),u=function(f,y){if(typeof f!="object"||f===null)return y.fail(null,"is not an object",0);for(var g=0;g<o.length;g++)if(!o[g](f,y))return!1;for(var g=0;g<a.length;g++){var x=s.props[g].name,v=f[x];if(v===void 0){if(l[g])return y.fail(x,"is missing",1)}else{var P=a[g](v,y);if(!P)return y.fail(x,null,1)}}return!0};if(!i)return u;var p=this.propSet;return r&&(this.propSet.forEach(function(f){return r.add(f)}),p=r),function(f,y){if(!u(f,y))return!1;for(var g in f)if(!p.has(g))return y.fail(g,"is extraneous",2);return!0}},e})(Hr);ne.TIface=vrt;function mzt(n){return new c6(xl(n))}ne.opt=mzt;var c6=(function(n){hs(e,n);function e(t){var i=n.call(this)||this;return i.ttype=t,i}return e.prototype.getChecker=function(t,i){var r=this.ttype.getChecker(t,i);return function(s,o){return s===void 0||r(s,o)}},e})(Hr);ne.TOptional=c6;var i6=(function(){function n(e,t,i){this.name=e,this.ttype=t,this.isOpt=i}return n})();ne.TProp=i6;function _zt(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return new Srt(new Prt(e),xl(n))}ne.func=_zt;var Srt=(function(n){hs(e,n);function e(t,i){var r=n.call(this)||this;return r.paramList=t,r.result=i,r}return e.prototype.getChecker=function(t,i){return function(r,s){return typeof r=="function"?!0:s.fail(null,"is not a function",0)}},e})(Hr);ne.TFunc=Srt;function yzt(n,e,t){return new wrt(n,xl(e),!!t)}ne.param=yzt;var wrt=(function(){function n(e,t,i){this.name=e,this.ttype=t,this.isOpt=i}return n})();ne.TParam=wrt;var Prt=(function(n){hs(e,n);function e(t){var i=n.call(this)||this;return i.params=t,i}return e.prototype.getChecker=function(t,i){var r=this,s=this.params.map(function(l){return l.ttype.getChecker(t,i)}),o=new frt.NoopContext,a=this.params.map(function(l,u){return!l.isOpt&&!s[u](void 0,o)}),c=function(l,u){if(!Array.isArray(l))return u.fail(null,"is not an array",0);for(var p=0;p<s.length;p++){var f=r.params[p];if(l[p]===void 0){if(a[p])return u.fail(f.name,"is missing",1)}else{var y=s[p](l[p],u);if(!y)return u.fail(f.name,null,1)}}return!0};return i?function(l,u){return c(l,u)?l.length<=s.length?!0:u.fail(s.length,"is extraneous",2):!1}:c},e})(Hr);ne.TParamList=Prt;var vr=(function(n){hs(e,n);function e(t,i){var r=n.call(this)||this;return r.validator=t,r.message=i,r}return e.prototype.getChecker=function(t,i){var r=this;return function(s,o){return r.validator(s)?!0:o.fail(null,r.message,0)}},e})(Hr);ne.BasicType=vr;ne.basicTypes={any:new vr(function(n){return!0},"is invalid"),number:new vr(function(n){return typeof n=="number"},"is not a number"),object:new vr(function(n){return typeof n=="object"&&n},"is not an object"),boolean:new vr(function(n){return typeof n=="boolean"},"is not a boolean"),string:new vr(function(n){return typeof n=="string"},"is not a string"),symbol:new vr(function(n){return typeof n=="symbol"},"is not a symbol"),void:new vr(function(n){return n==null},"is not void"),undefined:new vr(function(n){return n===void 0},"is not undefined"),null:new vr(function(n){return n===null},"is not null"),never:new vr(function(n){return!1},"is unexpected"),Date:new vr(hrt("[object Date]"),"is not a Date"),RegExp:new vr(hrt("[object RegExp]"),"is not a RegExp")};var gzt=Object.prototype.toString;function hrt(n){return function(e){return typeof e=="object"&&e&&gzt.call(e)===n}}typeof Buffer<"u"&&(ne.basicTypes.Buffer=new vr(function(n){return Buffer.isBuffer(n)},"is not a Buffer"));var xzt=function(n){ne.basicTypes[n.name]=new vr(function(e){return e instanceof n},"is not a "+n.name)};for(CP=0,n6=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,ArrayBuffer];CP<n6.length;CP++)drt=n6[CP],xzt(drt);var drt,CP,n6});var u6=ue(We=>{"use strict";var bzt=We&&We.__spreadArrays||function(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var i=Array(n),r=0,e=0;e<t;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,r++)i[r]=s[o];return i};Object.defineProperty(We,"__esModule",{value:!0});We.Checker=We.createCheckers=void 0;var e0=l6(),iy=MP(),Tn=l6();Object.defineProperty(We,"TArray",{enumerable:!0,get:function(){return Tn.TArray}});Object.defineProperty(We,"TEnumType",{enumerable:!0,get:function(){return Tn.TEnumType}});Object.defineProperty(We,"TEnumLiteral",{enumerable:!0,get:function(){return Tn.TEnumLiteral}});Object.defineProperty(We,"TFunc",{enumerable:!0,get:function(){return Tn.TFunc}});Object.defineProperty(We,"TIface",{enumerable:!0,get:function(){return Tn.TIface}});Object.defineProperty(We,"TLiteral",{enumerable:!0,get:function(){return Tn.TLiteral}});Object.defineProperty(We,"TName",{enumerable:!0,get:function(){return Tn.TName}});Object.defineProperty(We,"TOptional",{enumerable:!0,get:function(){return Tn.TOptional}});Object.defineProperty(We,"TParam",{enumerable:!0,get:function(){return Tn.TParam}});Object.defineProperty(We,"TParamList",{enumerable:!0,get:function(){return Tn.TParamList}});Object.defineProperty(We,"TProp",{enumerable:!0,get:function(){return Tn.TProp}});Object.defineProperty(We,"TTuple",{enumerable:!0,get:function(){return Tn.TTuple}});Object.defineProperty(We,"TType",{enumerable:!0,get:function(){return Tn.TType}});Object.defineProperty(We,"TUnion",{enumerable:!0,get:function(){return Tn.TUnion}});Object.defineProperty(We,"TIntersection",{enumerable:!0,get:function(){return Tn.TIntersection}});Object.defineProperty(We,"array",{enumerable:!0,get:function(){return Tn.array}});Object.defineProperty(We,"enumlit",{enumerable:!0,get:function(){return Tn.enumlit}});Object.defineProperty(We,"enumtype",{enumerable:!0,get:function(){return Tn.enumtype}});Object.defineProperty(We,"func",{enumerable:!0,get:function(){return Tn.func}});Object.defineProperty(We,"iface",{enumerable:!0,get:function(){return Tn.iface}});Object.defineProperty(We,"lit",{enumerable:!0,get:function(){return Tn.lit}});Object.defineProperty(We,"name",{enumerable:!0,get:function(){return Tn.name}});Object.defineProperty(We,"opt",{enumerable:!0,get:function(){return Tn.opt}});Object.defineProperty(We,"param",{enumerable:!0,get:function(){return Tn.param}});Object.defineProperty(We,"tuple",{enumerable:!0,get:function(){return Tn.tuple}});Object.defineProperty(We,"union",{enumerable:!0,get:function(){return Tn.union}});Object.defineProperty(We,"intersection",{enumerable:!0,get:function(){return Tn.intersection}});Object.defineProperty(We,"BasicType",{enumerable:!0,get:function(){return Tn.BasicType}});var vzt=MP();Object.defineProperty(We,"VError",{enumerable:!0,get:function(){return vzt.VError}});function Szt(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];for(var t=Object.assign.apply(Object,bzt([{},e0.basicTypes],n)),i={},r=0,s=n;r<s.length;r++)for(var o=s[r],a=0,c=Object.keys(o);a<c.length;a++){var l=c[a];i[l]=new krt(t,o[l])}return i}We.createCheckers=Szt;var krt=(function(){function n(e,t,i){if(i===void 0&&(i="value"),this.suite=e,this.ttype=t,this._path=i,this.props=new Map,t instanceof e0.TIface)for(var r=0,s=t.props;r<s.length;r++){var o=s[r];this.props.set(o.name,o.ttype)}this.checkerPlain=this.ttype.getChecker(e,!1),this.checkerStrict=this.ttype.getChecker(e,!0)}return n.prototype.setReportedPath=function(e){this._path=e},n.prototype.check=function(e){return this._doCheck(this.checkerPlain,e)},n.prototype.test=function(e){return this.checkerPlain(e,new iy.NoopContext)},n.prototype.validate=function(e){return this._doValidate(this.checkerPlain,e)},n.prototype.strictCheck=function(e){return this._doCheck(this.checkerStrict,e)},n.prototype.strictTest=function(e){return this.checkerStrict(e,new iy.NoopContext)},n.prototype.strictValidate=function(e){return this._doValidate(this.checkerStrict,e)},n.prototype.getProp=function(e){var t=this.props.get(e);if(!t)throw new Error("Type has no property "+e);return new n(this.suite,t,this._path+"."+e)},n.prototype.methodArgs=function(e){var t=this._getMethod(e);return new n(this.suite,t.paramList)},n.prototype.methodResult=function(e){var t=this._getMethod(e);return new n(this.suite,t.result)},n.prototype.getArgs=function(){if(!(this.ttype instanceof e0.TFunc))throw new Error("getArgs() applied to non-function");return new n(this.suite,this.ttype.paramList)},n.prototype.getResult=function(){if(!(this.ttype instanceof e0.TFunc))throw new Error("getResult() applied to non-function");return new n(this.suite,this.ttype.result)},n.prototype.getType=function(){return this.ttype},n.prototype._doCheck=function(e,t){var i=new iy.NoopContext;if(!e(t,i)){var r=new iy.DetailContext;throw e(t,r),r.getError(this._path)}},n.prototype._doValidate=function(e,t){var i=new iy.NoopContext;if(e(t,i))return null;var r=new iy.DetailContext;return e(t,r),r.getErrorDetail(this._path)},n.prototype._getMethod=function(e){var t=this.props.get(e);if(!t)throw new Error("Type has no property "+e);if(!(t instanceof e0.TFunc))throw new Error("Property "+e+" is not a method");return t},n})();We.Checker=krt});var lot=ue(I0=>{"use strict";I0.__esModule=!0;I0.LinesAndColumns=void 0;var tk=`
`,aot="\r",cot=(function(){function n(e){this.string=e;for(var t=[0],i=0;i<e.length;)switch(e[i]){case tk:i+=tk.length,t.push(i);break;case aot:i+=aot.length,e[i]===tk&&(i+=tk.length),t.push(i);break;default:i++;break}this.offsets=t}return n.prototype.locationForIndex=function(e){if(e<0||e>this.string.length)return null;for(var t=0,i=this.offsets;i[t+1]<=e;)t++;var r=e-i[t];return{line:t,column:r}},n.prototype.indexForLocation=function(e){var t=e.line,i=e.column;return t<0||t>=this.offsets.length||i<0||i>this.lengthOfLine(t)?null:this.offsets[t]+i},n.prototype.lengthOfLine=function(e){var t=this.offsets[e],i=e===this.offsets.length-1?this.string.length:this.offsets[e+1];return i-t},n})();I0.LinesAndColumns=cot;I0.default=cot});var l$=Symbol("Comlink.proxy"),Wpt=Symbol("Comlink.endpoint"),qpt=Symbol("Comlink.releaseProxy"),N3=Symbol("Comlink.finalizer"),Mx=Symbol("Comlink.thrown"),u$=n=>typeof n=="object"&&n!==null||typeof n=="function",Zpt={canHandle:n=>u$(n)&&n[l$],serialize(n){let{port1:e,port2:t}=new MessageChannel;return Ax(n,e),[t,[t]]},deserialize(n){return n.start(),tht(n)}},Kpt={canHandle:n=>u$(n)&&Mx in n,serialize({value:n}){let e;return n instanceof Error?e={isError:!0,value:{message:n.message,name:n.name,stack:n.stack}}:e={isError:!1,value:n},[e,[]]},deserialize(n){throw n.isError?Object.assign(new Error(n.value.message),n.value):n.value}},p$=new Map([["proxy",Zpt],["throw",Kpt]]);function Jpt(n,e){for(let t of n)if(e===t||t==="*"||t instanceof RegExp&&t.test(e))return!0;return!1}function Ax(n,e=globalThis,t=["*"]){e.addEventListener("message",function i(r){if(!r||!r.data)return;if(!Jpt(t,r.origin)){console.warn(`Invalid origin '${r.origin}' for comlink proxy`);return}let{id:s,type:o,path:a}=Object.assign({path:[]},r.data),c=(r.data.argumentList||[]).map(bh),l;try{let u=a.slice(0,-1).reduce((f,y)=>f[y],n),p=a.reduce((f,y)=>f[y],n);switch(o){case"GET":l=p;break;case"SET":u[a.slice(-1)[0]]=bh(r.data.value),l=!0;break;case"APPLY":l=p.apply(u,c);break;case"CONSTRUCT":{let f=new p(...c);l=sht(f)}break;case"ENDPOINT":{let{port1:f,port2:y}=new MessageChannel;Ax(n,y),l=rht(f,[f])}break;case"RELEASE":l=void 0;break;default:return}}catch(u){l={value:u,[Mx]:0}}Promise.resolve(l).catch(u=>({value:u,[Mx]:0})).then(u=>{let[p,f]=Nx(u);e.postMessage(Object.assign(Object.assign({},p),{id:s}),f),o==="RELEASE"&&(e.removeEventListener("message",i),h$(e),N3 in n&&typeof n[N3]=="function"&&n[N3]())}).catch(u=>{let[p,f]=Nx({value:new TypeError("Unserializable return value"),[Mx]:0});e.postMessage(Object.assign(Object.assign({},p),{id:s}),f)})}),e.start&&e.start()}function Qpt(n){return n.constructor.name==="MessagePort"}function h$(n){Qpt(n)&&n.close()}function tht(n,e){let t=new Map;return n.addEventListener("message",function(r){let{data:s}=r;if(!s||!s.id)return;let o=t.get(s.id);if(o)try{o(s)}finally{t.delete(s.id)}}),A3(n,t,[],e)}function Ex(n){if(n)throw new Error("Proxy has been released and is not useable")}function d$(n){return xm(n,new Map,{type:"RELEASE"}).then(()=>{h$(n)})}var Cx=new WeakMap,Ix="FinalizationRegistry"in globalThis&&new FinalizationRegistry(n=>{let e=(Cx.get(n)||0)-1;Cx.set(n,e),e===0&&d$(n)});function eht(n,e){let t=(Cx.get(e)||0)+1;Cx.set(e,t),Ix&&Ix.register(n,e,n)}function nht(n){Ix&&Ix.unregister(n)}function A3(n,e,t=[],i=function(){}){let r=!1,s=new Proxy(i,{get(o,a){if(Ex(r),a===qpt)return()=>{nht(s),d$(n),e.clear(),r=!0};if(a==="then"){if(t.length===0)return{then:()=>s};let c=xm(n,e,{type:"GET",path:t.map(l=>l.toString())}).then(bh);return c.then.bind(c)}return A3(n,e,[...t,a])},set(o,a,c){Ex(r);let[l,u]=Nx(c);return xm(n,e,{type:"SET",path:[...t,a].map(p=>p.toString()),value:l},u).then(bh)},apply(o,a,c){Ex(r);let l=t[t.length-1];if(l===Wpt)return xm(n,e,{type:"ENDPOINT"}).then(bh);if(l==="bind")return A3(n,e,t.slice(0,-1));let[u,p]=c$(c);return xm(n,e,{type:"APPLY",path:t.map(f=>f.toString()),argumentList:u},p).then(bh)},construct(o,a){Ex(r);let[c,l]=c$(a);return xm(n,e,{type:"CONSTRUCT",path:t.map(u=>u.toString()),argumentList:c},l).then(bh)}});return eht(s,n),s}function iht(n){return Array.prototype.concat.apply([],n)}function c$(n){let e=n.map(Nx);return[e.map(t=>t[0]),iht(e.map(t=>t[1]))]}var f$=new WeakMap;function rht(n,e){return f$.set(n,e),n}function sht(n){return Object.assign(n,{[l$]:!0})}function Nx(n){for(let[e,t]of p$)if(t.canHandle(n)){let[i,r]=t.serialize(n);return[{type:"HANDLER",name:e,value:i},r]}return[{type:"RAW",value:n},f$.get(n)||[]]}function bh(n){switch(n.type){case"HANDLER":return p$.get(n.name).deserialize(n.value);case"RAW":return n.value}}function xm(n,e,t,i){return new Promise(r=>{let s=oht();e.set(s,r),n.start&&n.start(),n.postMessage(Object.assign({id:s},t),i)})}function oht(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}var A7=Gt(qs(),1);var aP={};xh(aP,{AnalogSimulation:()=>oit,Battery:()=>Bnt,Board:()=>y9,Breakout:()=>Rnt,BreakoutPoint:()=>Ont,CadAssembly:()=>Qet,CadModel:()=>Jet,Capacitor:()=>g9,Chip:()=>U1,Circuit:()=>I7t,Constraint:()=>Snt,CopperPour:()=>jnt,Crystal:()=>Gnt,Cutout:()=>B1,Diode:()=>x9,FabricationNoteDimension:()=>Tnt,FabricationNotePath:()=>Pnt,FabricationNoteRect:()=>wnt,FabricationNoteText:()=>knt,Footprint:()=>qet,Fuse:()=>_nt,Group:()=>_l,Hole:()=>G_,Inductor:()=>v9,Jumper:()=>ynt,Keepout:()=>Jw,Led:()=>xnt,Mosfet:()=>Hnt,Net:()=>p9,NetLabel:()=>Lnt,NormalComponent:()=>Hn,Panel:()=>fnt,PcbNoteDimension:()=>Nnt,PcbNoteLine:()=>Ent,PcbNotePath:()=>Int,PcbNoteRect:()=>Mnt,PcbNoteText:()=>Cnt,PcbTrace:()=>d9,PinHeader:()=>Ynt,Pinout:()=>mnt,PlatedHole:()=>Id,Port:()=>Gi,Potentiometer:()=>Unt,PowerSource:()=>bnt,PrimitiveComponent:()=>Ee,Project:()=>C7t,PushButton:()=>Vnt,Renderable:()=>l9,Resistor:()=>b9,Resonator:()=>Xnt,RootCircuit:()=>K_,SchematicArc:()=>Qnt,SchematicBox:()=>eit,SchematicCell:()=>rit,SchematicCircle:()=>tit,SchematicLine:()=>Knt,SchematicRect:()=>Jnt,SchematicRow:()=>iit,SchematicTable:()=>nit,SchematicText:()=>Znt,SilkscreenCircle:()=>Fnt,SilkscreenLine:()=>$nt,SilkscreenPath:()=>h9,SilkscreenRect:()=>znt,SilkscreenText:()=>iP,SmtPad:()=>j1,SolderJumper:()=>gnt,Subcircuit:()=>Ant,Switch:()=>Wnt,Symbol:()=>sit,TestPoint:()=>qnt,Trace:()=>Fs,TraceHint:()=>m9,Transistor:()=>S9,Via:()=>Dnt,VoltageProbe:()=>ait,VoltageSource:()=>vnt,applyEditEvents:()=>uLt,applyEditEventsToManualEditsFile:()=>cLt,applyPcbEditEventsToManualEditsFile:()=>rnt,applySchematicEditEventsToManualEditsFile:()=>snt,createElement:()=>fit.createElement,createUseComponent:()=>J_,getPhaseTimingsFromRenderEvents:()=>pLt,getSimpleRouteJsonFromCircuitJson:()=>a9,normalizePinLabels:()=>hLt,orderedRenderPhases:()=>Xa,resolveStaticFileImport:()=>int,sel:()=>z7t,useCapacitor:()=>A7t,useChip:()=>R7t,useDiode:()=>O7t,useLed:()=>L7t,useRenderedCircuit:()=>N7t,useResistor:()=>F7t});Q();var B$={in:25.4,inch:25.4,mil:.0254,mm:1,m:1e3,cm:10,ft:304.8,feet:304.8},Ge=n=>{let e=typeof n=="number"?"mm":n.replace(/^[^a-zA-Z]+/g,"").toLowerCase();e||(e="mm");let t=typeof n=="number"?n:Number.parseFloat(n.split(e)[0]);if(e in B$)return t*B$[e];throw new Error(`Unsupported unit: ${e}`)};var Im=Ge;Q();St();Q();St();Q();Q();St();Q();St();Q();St();Q();Q();Q();St();St();Q();Q();St();St();Q();St();Q();St();Q();St();Q();St();Q();St();Q();Q();St();Q();Q();St();Q();St();Q();St();Q();St();Q();St();Q();St();Q();St();Q();St();Q();St();Q();St();Q();St();Q();St();Q();Q();St();Q();St();Q();St();Q();St();Q();St();Q();St();Q();St();Q();St();Q();Q();Q();St();Q();Q();St();Q();St();Q();St();Q();St();Q();St();Q();St();St();Q();Q();St();Q();Q();St();Q();Q();St();Q();St();Q();Q();var hft=Object.defineProperty,dft=(n,e)=>{for(var t in e)hft(n,t,{get:e[t],enumerable:!0})},wa={};dft(wa,{axial:()=>dmt,bga:()=>kft,breakoutheaders:()=>wmt,cap:()=>bft,dfn:()=>Wft,diode:()=>xft,dip:()=>_ft,electrolytic:()=>sgt,hc49:()=>kmt,jst:()=>Cyt,led:()=>vft,lqfp:()=>vmt,m2host:()=>Sgt,melf:()=>$_t,micromelf:()=>Y_t,minimelf:()=>I_t,mlp:()=>Rft,ms012:()=>emt,ms013:()=>imt,msop:()=>Dyt,pad:()=>Tmt,pinrow:()=>Kft,platedhole:()=>ygt,potentiometer:()=>ngt,pushbutton:()=>mmt,qfn:()=>Nft,qfp:()=>Aft,quad:()=>sg,res:()=>Sft,sma:()=>G_t,smb:()=>tyt,smbf:()=>agt,smc:()=>ryt,smf:()=>Z_t,smtpad:()=>mgt,sod110:()=>Nyt,sod123:()=>lmt,sod123f:()=>c_t,sod123fl:()=>h_t,sod123w:()=>Ymt,sod128:()=>b_t,sod323:()=>Gmt,sod323f:()=>r_t,sod323fl:()=>Vyt,sod323w:()=>Byt,sod523:()=>Amt,sod723:()=>__t,sod80:()=>$mt,sod882:()=>t_t,sod882d:()=>O_t,sod923:()=>Zmt,soic:()=>Eft,solderjumper:()=>Zyt,son:()=>qyt,sop8:()=>Fmt,sot:()=>xgt,sot223:()=>cyt,sot23:()=>Bft,sot23w:()=>yyt,sot25:()=>Vft,sot323:()=>pgt,sot363:()=>Dft,sot457:()=>Qyt,sot563:()=>Qft,sot723:()=>smt,sot89:()=>T_t,ssop:()=>Lft,stampboard:()=>ymt,stampreceiver:()=>bmt,to220:()=>M_t,to92:()=>Imt,to92s:()=>wyt,tssop:()=>zft,vssop:()=>Fyt});var ie=(n,e,t)=>({type:"pcb_silkscreen_text",pcb_silkscreen_text_id:"silkscreen_text_1",font:"tscircuit2024",font_size:t,pcb_component_id:"pcb_component_1",text:"{REF}",layer:"top",anchor_position:{x:n,y:e},anchor_alignment:"center"}),Te=(n,e,t,i,r)=>({pcb_plated_hole_id:"",type:"pcb_plated_hole",shape:"circle",x:e,y:t,hole_diameter:Ge(i),outer_diameter:Ge(r),pcb_port_id:"",layers:["top","bottom"],port_hints:[n.toString()]}),mB=Array.from({length:9},(n,e)=>Math.cos(e/8*Math.PI-Math.PI)).map(n=>({x:n,y:-Math.sqrt(1-n**2)}));function zc(n){return typeof n=="string"?n.trim().toLowerCase().endsWith("mil")?parseFloat(n)*.0254:parseFloat(n):Number(n)}var Zx=h.union([h.string(),h.number()]).transform(n=>zc(n)),fft=n=>h.object({fn:h.string(),num_pins:h.number().optional().default(6),wide:h.boolean().optional(),narrow:h.boolean().optional(),w:Zx.optional(),p:Zx.default(n.p??"2.54mm"),id:Zx.optional(),od:Zx.optional()}).transform(e=>(!e.id&&!e.od?Math.abs(e.p-1.27)<.01?(e.id=zc("0.55mm"),e.od=zc("0.95mm")):(e.id=zc("1.0mm"),e.od=zc("1.5mm")):e.id?e.od||(e.od=e.id*(1.5/1)):e.id=e.od*(1/1.5),e.w||(e.wide?e.w=zc("600mil"):e.narrow?e.w=zc("300mil"):e.w=zc(n.w??"300mil")),e)),mft=fft({}),sB=(n,e,t,i)=>{let r=n/2,s=e<=r,o=r-1,a=i,c=a*o;return s?{x:-t/2,y:c/2-(e-1)*a}:{x:t/2,y:-c/2+(e-r-1)*a}},_ft=n=>{let e=mft.parse(n),t=[];for(let u=0;u<e.num_pins;u++){let{x:p,y:f}=sB(e.num_pins,u+1,e.w,e.p??2.54);t.push(Te(u+1,p,f,e.id??"0.8mm",e.od??"1mm"))}let i=(e.num_pins/2-1)*e.p+e.od,s=e.w-e.od-1,o=(e.num_pins/2-1)*e.p+e.od+.4,a={layer:"top",pcb_component_id:"",pcb_silkscreen_path_id:"silkscreen_path_1",route:[{x:-s/2,y:-o/2},{x:-s/2,y:o/2},...mB.map(({x:u,y:p})=>({x:u*s/6,y:p*s/6+o/2})),{x:s/2,y:o/2},{x:s/2,y:-o/2},{x:-s/2,y:-o/2}],type:"pcb_silkscreen_path",stroke_width:.1},c=[];for(let u=0;u<e.num_pins;u++){let p=u<e.num_pins/2,f=.6,{y}=sB(e.num_pins,u+1,e.w,e.p??2.54),g=p?-e.w/2-e.od/2-f:e.w/2+e.od/2+f,x=y;c.push({type:"pcb_fabrication_note_text",pcb_fabrication_note_text_id:`pin_${u+1}`,layer:"top",pcb_component_id:`pin_${u+1}`,text:`{pin${u+1}}`,anchor_position:{x:g,y:x},font_size:.3,font:"tscircuit2024",anchor_alignment:"top_left"})}let l=ie(0,o/2+.5,.4);return{circuitJson:[...t,a,l,...c],parameters:e}},Ut=(n,e,t,i,r)=>({type:"pcb_smtpad",x:e,y:t,width:i,height:r,layer:"top",shape:"rect",pcb_smtpad_id:"",port_hints:Array.isArray(n)?n.map(s=>s.toString()):[n.toString()]}),_B=[{imperial:"01005",metric:"0402",p_mm_min:.5,pw_mm_min:.4,ph_mm_min:.3,w_mm_min:.58,h_mm_min:.21},{imperial:"0504",metric:"1310",p_mm_min:1.1,pw_mm_min:.65,ph_mm_min:1.3,w_mm_min:.58,h_mm_min:.21},{imperial:"1812",metric:"4532",p_mm_min:4.275,pw_mm_min:1.125,ph_mm_min:3.4,w_mm_min:5.4,h_mm_min:3.4},{imperial:"0201",metric:"0603",p_mm_min:.66,pw_mm_min:.46,ph_mm_min:.4,w_mm_min:.9,h_mm_min:.3},{imperial:"0402",metric:"1005",p_mm_min:1.02,pw_mm_min:.54,ph_mm_min:.64,w_mm_min:1.56,h_mm_min:.64},{imperial:"0603",metric:"1608",p_mm_min:1.65,pw_mm_min:.8,ph_mm_min:.95,w_mm_min:2.45,h_mm_min:.95},{imperial:"0805",metric:"2012",p_mm_min:1.825,pw_mm_min:1.025,ph_mm_min:1.4,w_mm_min:2.8499999999999996,h_mm_min:1.4},{imperial:"1206",metric:"3216",p_mm_min:2.925,pw_mm_min:1.125,ph_mm_min:1.75,w_mm_min:4.05,h_mm_min:1.75},{imperial:"1210",metric:"3225",p_mm_min:2.925,pw_mm_min:1.125,ph_mm_min:2.65,w_mm_min:4.05,h_mm_min:2.65},{imperial:"2010",metric:"5025",p_mm_min:4.625,pw_mm_min:1.225,ph_mm_min:2.65,w_mm_min:5.85,h_mm_min:2.65},{imperial:"2512",metric:"6332",p_mm_min:5.925,pw_mm_min:1.225,ph_mm_min:3.35,w_mm_min:7.15,h_mm_min:3.35}],yft=Object.fromEntries(_B.map(n=>[n.metric,n])),gft=Object.fromEntries(_B.map(n=>[n.imperial,n])),sGt=h.object({tht:h.boolean(),p:D.optional(),pw:D.optional(),ph:D.optional(),metric:Y.optional(),imperial:Y.optional(),w:D.optional(),h:D.optional(),textbottom:h.boolean().optional()}),nb=n=>{let{tht:e,p:t,pw:i,ph:r,metric:s,imperial:o,w:a,h:c,textbottom:l}=n;if(typeof a=="string"&&(a=Im(a)),typeof c=="string"&&(c=Im(c)),typeof t=="string"&&(t=Im(t)),typeof i=="string"&&(i=Im(i)),typeof r=="string"&&(r=Im(r)),c!==void 0&&a!==void 0&&c>a)throw new Error("height cannot be greater than width (rotated footprint not yet implemented)");let u;if(s&&(u=yft[s]),o&&(u=gft[o]),u&&(a=u.w_mm_min,c=u.h_mm_min,t=u.p_mm_min,i=u.pw_mm_min,r=u.ph_mm_min),t===void 0||i===void 0||r===void 0)throw new Error("Could not determine required pad dimensions (p, pw, ph)");let p={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:t/2,y:r/2+.4},{x:-t/2-i/2-.2,y:r/2+.4},{x:-t/2-i/2-.2,y:-r/2-.4},{x:t/2,y:-r/2-.4}],stroke_width:.1,pcb_silkscreen_path_id:""},f=l?-r/2-.9:r/2+.9,y=ie(0,f,.2);return e?[Te(1,-t/2,0,i,i*1/.8),Te(2,t/2,0,i,i*1/.8),p,y]:[Ut(["1","left"],-t/2,0,i,r),Ut(["2","right"],t/2,0,i,r),p,y]},xft=n=>({circuitJson:nb(n),parameters:n}),bft=n=>({circuitJson:nb(n),parameters:n}),vft=n=>({circuitJson:nb(n),parameters:n}),Sft=n=>({circuitJson:nb(n),parameters:n}),yB=(n,{x:e,y:t,radius:i})=>({type:"pcb_smtpad",x:e,y:t,radius:i,layer:"top",shape:"circle",pcb_smtpad_id:"",port_hints:Array.isArray(n)?n.map(r=>r.toString()):[n.toString()]}),gB="ABCDEFGHIJKLMNOPQRSTUVWXYZ",xB=h.string().transform(n=>{let[e,t]=n.split(/[x ]/);return{x:parseFloat(e),y:parseFloat(t)}}).pipe(h.object({x:h.number(),y:h.number()})),wft=h.string().or(h.array(h.any())).transform(n=>Array.isArray(n)?n:(n.startsWith("(")&&n.endsWith(")")&&(n=n.slice(1,-1)),n.split(",").map(e=>{let t=Number(e);return isNaN(t)?e:t}))).pipe(h.array(h.string().or(h.number()))),Pft=h.object({fn:h.string(),num_pins:h.number().optional().default(64),grid:xB.optional(),p:Y.default("0.8mm"),w:D.optional(),h:D.optional(),ball:D.optional().describe("ball diameter"),pad:D.optional().describe("pad width/height"),circularpads:h.boolean().optional().describe("use circular pads"),tlorigin:h.boolean().optional(),blorigin:h.boolean().optional(),trorigin:h.boolean().optional(),brorigin:h.boolean().optional(),missing:wft.default([])}).transform(n=>{let e="tl";if(n.blorigin&&(e="bl"),n.trorigin&&(e="tr"),n.brorigin&&(e="br"),!n.grid){let i=Math.ceil(Math.sqrt(n.num_pins));n.grid={x:i,y:i}}return n.missing&&(n.missing=n.missing.map(i=>{if(typeof i=="number")return i;if(i==="center")return"center";if(i==="topleft")return"topleft";let r=i.match(/([A-Z]+)(\d+)/);if(!r)return i;let s=gB.indexOf(r[1]),o=Number.parseInt(r[2])-1;return s*n.grid.x+o+1})),{...n,origin:e}}),kft=n=>{let e=Pft.parse(n),{num_pins:t,grid:i,p:r,w:s,h:o,ball:a,pad:c,missing:l}=e;a??(a=.75/1.27*r),c??(c=a*.8);let u=[],p=(l??[]).filter(I=>typeof I=="number"),f=i.x*i.y-t;if(l.length===0&&f>0&&(Math.sqrt(f)%1===0?l.push("center"):f===1&&l.push("topleft")),l?.includes("center")){let I=Math.floor(Math.sqrt(f)),E=Math.floor((i.x-I)/2),N=Math.floor((i.y-I)/2);for(let M=N;M<N+I;M++)for(let A=E;A<E+I;A++)p.push(M*i.x+A+1)}l?.includes("topleft")&&p.push(1);let y=new Set(p),g=0;for(let I=0;I<i.y;I++)for(let E=0;E<i.x;E++){let N=(E-(i.x-1)/2)*r,M=(I-(i.y-1)/2)*r,A=E,R=I;switch(e.origin){case"bl":A=E,R=i.y-1-I;break;case"br":A=i.x-1-E,R=i.y-1-I;break;case"tr":A=i.x-1-E,R=I;break;case"tl":default:break}let j=R*i.x+A+1;if(y.has(j)){g++;continue}j-=g;let B=[j,`${gB[R]}${A+1}`];u.push(e.circularpads?yB(B,{x:N,y:M,radius:c/2}):Ut(B,N,M,c,c))}let x=ie(0,i.y*r/2,.2),v=r/6,P,w=i.x*r/2,k=i.y*r/2;switch(e.origin){case"bl":P=[{x:-w,y:-k},{x:-w,y:-k-v},{x:-w-v,y:-k},{x:-w,y:-k}];break;case"br":P=[{x:w,y:-k},{x:w,y:-k-v},{x:w+v,y:-k},{x:w,y:-k}];break;case"tr":P=[{x:w,y:k},{x:w,y:k+v},{x:w+v,y:k},{x:w,y:k}];break;case"tl":default:P=[{x:-w,y:k},{x:-w,y:k+v},{x:-w-v,y:k},{x:-w,y:k}];break}let T={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",pcb_silkscreen_path_id:"pin1_marker",route:P,stroke_width:.05};return{circuitJson:[...u,x,T],parameters:e}},tb=(n,e,t,i,r)=>({type:"pcb_smtpad",x:e,y:t,width:i,height:r,radius:r/2,layer:"top",shape:"pill",pcb_smtpad_id:"",port_hints:Array.isArray(n)?n.map(s=>s.toString()):[n.toString()]}),Qs=n=>h.object({fn:h.string(),num_pins:h.number().optional().default(8),w:D.default(D.parse(n.w??"5.3mm")),p:D.default(D.parse(n.p??"1.27mm")),pw:D.default(D.parse(n.pw??"0.6mm")),pl:D.default(D.parse(n.pl??"1.0mm")),legsoutside:h.boolean().optional().default(n.legsoutside??!1),pillpads:h.boolean().optional().default(n.pillpads??!1)}).transform(e=>(!e.pw&&!e.pl?(e.pw=D.parse("0.6mm"),e.pl=D.parse("1.0mm")):e.pw?e.pl||(e.pl=e.pw*(1/.6)):e.pw=e.pl*(.6/1),e)),Tft=Qs({}),yE=n=>{n.widthincludeslegs!==void 0&&(n.legsoutside=!n.widthincludeslegs);let{num_pins:e,pn:t,w:i,p:r,pl:s,legsoutside:o}=n,a=e/2,c=t<=a,l=a-1,u=r,p=u*l,f=o?s/2:-s/2;return c?{x:-i/2-f,y:p/2-(t-1)*u}:{x:i/2+f,y:-p/2+(t-a-1)*u}},Eft=n=>{let e=Tft.parse(n);return{circuitJson:Pa(e),parameters:e}},Pa=n=>{let e=[];for(let a=0;a<n.num_pins;a++){let{x:c,y:l}=yE({num_pins:n.num_pins,pn:a+1,w:n.w,p:n.p,pl:n.pl,legsoutside:n.legsoutside});n.pillpads?e.push(tb(a+1,c,l,n.pl,n.pw)):e.push(Ut(a+1,c,l,n.pl,n.pw))}let t=Math.min(1,n.p/2),i=n.w-(n.legsoutside?0:n.pl*2)-.2,r=(n.num_pins/2-1)*n.p+n.pw+t,s=ie(0,r/2+.4,r/12),o={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",pcb_silkscreen_path_id:"silkscreen_path_1",stroke_width:.1,route:[{x:-i/2,y:-r/2},{x:-i/2,y:r/2},...mB.map(({x:a,y:c})=>({x:a*i/6,y:c*i/6+r/2})),{x:i/2,y:r/2},{x:i/2,y:-r/2},{x:-i/2,y:-r/2}]};return[...e,o,s]},oB=h.enum(["leftside","topside","rightside","bottomside","toppin","bottompin","leftpin","rightpin"]),Mft=({num_pins:n,cw:e,ccw:t,startingpin:i})=>{let r=[],s=n/4,o=1,a={};for(let c of i??[])a[c]=!0;!a.leftside&&!a.topside&&!a.rightside&&!a.bottomside&&(a.leftside=!0),!a.bottompin&&!a.leftpin&&!a.rightpin&&!a.toppin&&(a.leftside?a.toppin=!0:a.topside?a.rightpin=!0:a.rightside?a.bottompin=!0:a.bottomside&&(a.leftpin=!0)),a.leftside&&a.toppin?o=1:a.leftside&&a.bottompin?o=s:a.bottomside&&a.leftpin?o=s+1:a.bottomside&&a.rightpin?o=s*2:a.rightside&&a.bottompin?o=s*2+1:a.rightside&&a.toppin?o=s*3:a.topside&&a.rightpin?o=s*3+1:a.topside&&a.leftpin&&(o=s*4),r.push(-1);for(let c=0;c<n;c++)r[o]=c+1,t||!e?(o++,o>n&&(o=1)):(o--,o<1&&(o=n));return r},gE=h.object({fn:h.string(),cc:h.boolean().default(!0).optional(),ccw:h.boolean().default(!0).optional(),startingpin:h.string().or(h.array(oB)).transform(n=>typeof n=="string"?n.slice(1,-1).split(","):n).pipe(h.array(oB)).optional(),num_pins:h.number().optional().default(64),w:D.optional(),h:D.optional(),p:D.default(D.parse("0.5mm")),pw:D.optional(),pl:D.optional(),thermalpad:h.union([h.literal(!0),xB]).optional(),legsoutside:h.boolean().default(!1)}),xE=n=>{n.w&&!n.h?n.h=n.w:!n.w&&n.h&&(n.w=n.h);let e=n.num_pins/4;if(!n.p&&!n.pw&&!n.pl&&n.w){let t=e+4;n.p=n.w/t}return!n.p&&n.w&&n.h&&n.pw&&n.pl&&(n.p=(n.w-n.pl*2)/(e-1)),!n.w&&!n.h&&n.p&&(n.w=n.p*(e+4),n.h=n.w),n.p&&!n.pw&&!n.pl?(n.pw=n.p/2,n.pl=n.p/2):n.pw?n.pl||(n.pl=n.pw*(1/.6)):n.pw=n.pl*(.6/1),n},bB=gE.transform(xE),Cft=["left","bottom","right","top"],Ift=n=>{let{pin_count:e,pn:t,w:i,h:r,p:s,pl:o,legsoutside:a}=n,c=e/4,l=Cft[Math.floor((t-1)/c)],u=(t-1)%c,p=s*(c-1),f=s*(c-1),y=a?o/2:-o/2;switch(l){case"left":return{x:-i/2-y,y:f/2-u*s,o:"vert"};case"bottom":return{x:-p/2+u*s,y:-r/2-y,o:"horz"};case"right":return{x:i/2+y,y:-f/2+u*s,o:"vert"};case"top":return{x:p/2-u*s,y:r/2+y,o:"horz"};default:throw new Error("Invalid pin number")}},sg=n=>{let e=bB.parse(n),t=[],i=Mft(e),r=e.num_pins/4;for(let a=0;a<e.num_pins;a++){let{x:c,y:l,o:u}=Ift({pin_count:e.num_pins,pn:a+1,w:e.w,h:e.h,p:e.p??.5,pl:e.pl,legsoutside:e.legsoutside}),p=e.pw,f=e.pl;u==="vert"&&([p,f]=[f,p]);let y=i[a+1];t.push(Ut(y,c,l,p,f))}if(e.thermalpad)if(typeof e.thermalpad=="boolean"){let a=e.p*(r-1)+e.pw,c=e.p*(r-1)+e.pw;t.push(Ut(["thermalpad"],0,0,a,c))}else t.push(Ut(["thermalpad"],0,0,e.thermalpad.x,e.thermalpad.y));let s=[];for(let[a,c,l]of[["top-left",-1,1],["bottom-left",-1,-1],["bottom-right",1,-1],["top-right",1,1]]){let u=e.w/2*c,p=e.h/2*l,f="none",y=u,g=p,x=e.pw*2;i[1]===1&&a==="top-left"?f="in1":i[r*4]===1&&a==="top-left"||i[r*3+1]===1&&a==="top-right"?f="in2":i[r*3]===1&&a==="top-right"||i[r]===1&&a==="bottom-left"?f="in1":i[r+1]===1&&a==="bottom-left"?f="in2":i[r*2]===1&&a==="bottom-right"?f="in1":i[r*2+1]===1&&a==="bottom-right"&&(f="in2");let v=f==="in1"?1:-1;if(e.legsoutside){let P=f==="in1"?e.pl/2:e.pw/2,w=f==="in1"?e.pw/2:e.pl/2;y+=P*c*v,g-=w*l*v}(f==="none"||e.legsoutside)&&s.push({layer:"top",pcb_component_id:"",pcb_silkscreen_path_id:`pcb_silkscreen_path_${a}`,route:[{x:u-x*c,y:p},{x:u,y:p},{x:u,y:p-x*l}],type:"pcb_silkscreen_path",stroke_width:.1}),(f==="in1"||f==="in2")&&!e.legsoutside&&s.push({layer:"top",pcb_component_id:"",pcb_silkscreen_path_id:`pcb_silkscreen_path_${a}_1`,route:[{x:u-x*c,y:p},{x:u-x*c/2,y:p}],type:"pcb_silkscreen_path",stroke_width:0},{layer:"top",pcb_component_id:"",pcb_silkscreen_path_id:`pcb_silkscreen_path_${a}_2`,route:[{x:u,y:p-x*l/2},{x:u,y:p-x*l}],type:"pcb_silkscreen_path",stroke_width:.1}),(f==="in1"||f==="in2")&&s.push({layer:"top",pcb_component_id:"",pcb_silkscreen_path_id:`pcb_silkscreen_path_${a}_3`,route:[{x:y-.2*-c,y:g+.2*v},{x:y,y:g},{x:y+.2*v*-c,y:g+.2},{x:y-.2*-c,y:g+.2*v}],type:"pcb_silkscreen_path",stroke_width:.1})}let o=ie(0,e.h/2+(e.legsoutside?e.pl*1.2:.5),.3);return{circuitJson:[...t,...s,o],parameters:e}},_Gt=gE.extend({}).transform(xE),Nft=n=>(n.legsoutside=!1,sg(n)),Aft=n=>{n.legsoutside=!0;let e=bB.parse(n);if(!n.p)switch(n.num_pins){case 44:case 64:n.p=.8;break;case 52:n.w===14?n.p=1:n.p=.65;break;case 208:n.p=.5;break}if(!n.pl)switch(n.num_pins){case 44:case 52:case 64:n.pl=2.25;break;case 208:n.pl=1.65;break;default:n.pl=e.pl*4;break}if(!n.pw)switch(n.num_pins){case 44:case 64:n.pw=.5;break;case 52:n.w===14?n.pw=.45:n.pw=.55;break;case 208:n.pw=.3;break;default:n.pw=e.pw;break}return sg(n)},yGt=gE.extend({}).transform(xE),Rft=n=>(n.legsoutside=!1,n.thermalpad===void 0&&(n.thermalpad=!0),sg(n)),Oft=Qs({w:"3.9mm",p:"1.27mm"}),Lft=n=>{let e=Oft.parse(n);return{circuitJson:Pa(e),parameters:e}},Fft=Qs({w:"7.1mm",p:"0.65mm",pl:"1.35mm",pw:"0.40mm",legsoutside:!0}),zft=n=>{let e=Fft.parse(n);return{circuitJson:Pa(e),parameters:e}},$ft=Qs({}),Dft=n=>{let e=$ft.parse({fn:"sot363",num_pins:6,w:1.94,p:.65,pw:.3,pl:.7,legoutside:!0});return{circuitJson:Pa(e),parameters:e}},vB=h.object({fn:h.string(),num_pins:h.number().default(3),w:h.string().default("1.92mm"),h:h.string().default("2.74mm"),pl:h.string().default("0.8mm"),pw:h.string().default("0.764mm"),p:h.string().default("0.95mm"),string:h.string().optional()}),jft=Qs({p:"0.95mm",w:"1.6mm",legsoutside:!0}),Bft=n=>{let e=n.string?.match(/^sot23_(\d+)/),t=e?Number.parseInt(e[1],10):3;if(t===6||t===8){let r=jft.parse({...n,num_pins:t});return{circuitJson:Pa(r),parameters:r}}let i=vB.parse({...n,num_pins:t});if(i.num_pins===3)return{circuitJson:Xft(i),parameters:i};if(i.num_pins===5)return{circuitJson:SB(i),parameters:i};throw new Error("Invalid number of pins")},Yft=n=>{let{pn:e,w:t,h:i,pl:r}=n;return e===1?{x:-1.7,y:0}:e===2?{x:1.7,y:-.95}:{x:1.7,y:.95}},Xft=n=>{let e=[];for(let i=0;i<n.num_pins;i++){let{x:r,y:s}=Yft({num_pins:n.num_pins,pn:i+1,w:Number.parseFloat(n.w),h:Number.parseFloat(n.h),pl:Number.parseFloat(n.pl)});e.push(Ut(i+1,r,s,Number.parseFloat(n.pl),Number.parseFloat(n.pw)))}let t=ie(0,Number.parseInt(n.h),.3);return[...e,t]},aB=n=>{let{p:e,h:t,pn:i}=n;if(i===1)return{x:-t/2-.5,y:e};if(i===2)return{x:-t/2-.5,y:0};if(i===3)return{x:-t/2-.5,y:-e};if(i===4)return{x:t/2+.5,y:-e};if(i===5)return{x:t/2+.5,y:e};throw new Error("Invalid pin number")},SB=n=>{let e=[];for(let p=1;p<=n.num_pins;p++){let{x:f,y}=aB({h:Number.parseFloat(n.h),p:Number.parseFloat(n.p),pn:p});e.push(Ut(p,f,y,Number.parseFloat(n.pl),Number.parseFloat(n.pw)))}let t=(n.num_pins+1)/2*Number.parseFloat(n.p),i=Number.parseFloat(n.h),r={layer:"top",pcb_component_id:"",pcb_silkscreen_path_id:"silkscreen_path_1",route:[{x:-t/3,y:i/2+Number.parseFloat(n.p)/1.3},{x:t/3,y:i/2+Number.parseFloat(n.p)/1.3}],type:"pcb_silkscreen_path",stroke_width:.05},s={layer:"top",pcb_component_id:"",pcb_silkscreen_path_id:"silkscreen_path_2",route:[{x:-t/3,y:-i/2-Number.parseFloat(n.p)/1.3},{x:t/3,y:-i/2-Number.parseFloat(n.p)/1.3}],type:"pcb_silkscreen_path",stroke_width:.05},o=ie(0,i+.3,.3),a=aB({h:Number.parseFloat(n.h),p:Number.parseFloat(n.p),pn:1});a.x=a.x-Number.parseFloat(n.pw)*1.5;let c=.7,l=.3,u={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",pcb_silkscreen_path_id:"pin1_indicator",route:[{x:a.x+c/2,y:a.y},{x:a.x-c/2,y:a.y+l/2},{x:a.x-c/2,y:a.y-l/2},{x:a.x+c/2,y:a.y}],stroke_width:.05};return[...e,o,r,s,u]},Uft=vB.extend({}),Vft=n=>{let e=Uft.parse({...n,num_pins:5});return{circuitJson:SB(e),parameters:e}},Gft=[{name:"top-left",dx:-1,dy:1},{name:"top-right",dx:1,dy:1},{name:"bottom-left",dx:-1,dy:-1},{name:"bottom-right",dx:1,dy:-1}],Hft=Qs({}),Wft=n=>{let e=Hft.parse(n),t=[];for(let p=0;p<e.num_pins;p++){let{x:f,y}=yE({num_pins:e.num_pins,pn:p+1,w:e.w,p:e.p??1.27,pl:e.pl,widthincludeslegs:!0});t.push(Ut(p+1,f,y,e.pl??"1mm",e.pw??"0.6mm"))}let i=Math.min(1,e.p/2),r=e.w+i,s=(e.num_pins/2-1)*e.p+e.pw+i,o=[];for(let p of Gft){let{dx:f,dy:y}=p;o.push({layer:"top",pcb_component_id:"",pcb_silkscreen_path_id:"",route:[{x:f*r/2-f*e.p,y:y*s/2},{x:f*r/2,y:y*s/2},{x:f*r/2,y:y*s/2-y*e.p}],type:"pcb_silkscreen_path",stroke_width:.1})}let a=e.p/4,c=-r/2-a/2,l=s/2-e.p/2;o.push({layer:"top",pcb_component_id:"",pcb_silkscreen_path_id:"",type:"pcb_silkscreen_path",route:[{x:c,y:l},{x:c-a,y:l+a},{x:c-a,y:l-a},{x:c,y:l}],stroke_width:.1});let u=ie(0,s/2+.4,s/12);return{circuitJson:[...t,u,...o],parameters:e}},eb=(n,e,t,i,r,s)=>({pcb_plated_hole_id:"",type:"pcb_plated_hole",shape:"circular_hole_with_rect_pad",x:e,y:t,hole_diameter:Ge(i),hole_shape:"circle",pad_shape:"rect",rect_pad_width:Ge(r),rect_pad_height:Ge(s),pcb_port_id:"",layers:["top","bottom"],port_hints:[n.toString()]}),_E=({fs:n,pn:e,anchor_x:t,anchor_y:i,textalign:r="center",orthogonal:s=!1,verticallyinverted:o=!1,layer:a="top"})=>{let c=0;s&&o?c=270:o?c=180:s?c=90:c=0;let l="center";return r==="left"&&(o?l="center_right":l="center_left"),r==="right"&&(o?l="center_left":l="center_right"),a==="bottom"&&(l==="center_left"?l="center_right":l==="center_right"&&(l="center_left")),{type:"pcb_silkscreen_text",pcb_silkscreen_text_id:"silkscreen_text_1",font:"tscircuit2024",font_size:n,pcb_component_id:"pcb_component_1",text:`{PIN${e}}`,layer:a,anchor_position:{x:t,y:i},anchor_alignment:l,ccw_rotation:c}};function qft({pinlabeltextalignleft:n,pinlabeltextalignright:e,pinlabelorthogonal:t}){let i="top";return t?i="left":i="top",n&&(t?i="bottom":i="right"),e&&(t?i="top":i="left"),i}var Zft=h.object({fn:h.string(),num_pins:h.number().optional().default(6),rows:h.union([h.string(),h.number()]).transform(n=>Number(n)).optional().default(1).describe("number of rows"),p:D.default("0.1in").describe("pitch"),id:D.default("1.0mm").describe("inner diameter"),od:D.default("1.5mm").describe("outer diameter"),male:h.boolean().optional().describe("for male pin headers"),female:h.boolean().optional().describe("for female pin headers"),pinlabeltextalignleft:h.boolean().optional().default(!1),pinlabeltextaligncenter:h.boolean().optional().default(!1),pinlabeltextalignright:h.boolean().optional().default(!1),pinlabelverticallyinverted:h.boolean().optional().default(!1),pinlabelorthogonal:h.boolean().optional().default(!1),nosquareplating:h.boolean().optional().default(!1).describe("do not use rectangular pad for pin 1"),nopinlabels:h.boolean().optional().default(!1).describe("omit silkscreen pin labels"),doublesidedpinlabel:h.boolean().optional().default(!1).describe("add silkscreen pins in top and bottom layers"),bottomsidepinlabel:h.boolean().optional().default(!1).describe("place the silkscreen reference text on the bottom layer instead of top")}).transform(n=>{let e=qft(n);return{...n,pinlabelAnchorSide:e,male:n.male??!n.female,female:n.female??!1}}).superRefine((n,e)=>{n.male&&n.female&&e.addIssue({code:h.ZodIssueCode.custom,message:"'male' and 'female' cannot both be true; it should be male or female.",path:["male","female"]})}),Kft=n=>{let e=Zft.parse(n),{p:t,id:i,od:r,rows:s,num_pins:o,pinlabelAnchorSide:a,pinlabelverticallyinverted:c,pinlabelorthogonal:l,pinlabeltextalignleft:u,pinlabeltextalignright:p,nopinlabels:f,doublesidedpinlabel:y,bottomsidepinlabel:g}=e,x="center";u?x="left":p&&(x="right");let v=[],P=Math.ceil(o/s),w=-t,k=({xoff:M,yoff:A,od:R,anchorSide:j})=>{let B=0,G=0,U=R*.75;switch(j){case"right":B=U;break;case"top":G=U;break;case"bottom":G=-U;break;case"left":B=-U;break}return{anchor_x:M+B,anchor_y:A+G}},T=(M,A,R)=>{M===1&&!e.nosquareplating?v.push(eb(M,A,R,i,r,r)):v.push(Te(M,A,R,i,r));let{anchor_x:j,anchor_y:B}=k({xoff:A,yoff:R,od:r,anchorSide:a});f||(g?v.push(_E({fs:r/5,pn:M,anchor_x:j,anchor_y:B,anchorplacement:a,textalign:x,orthogonal:l,verticallyinverted:c,layer:"bottom"})):v.push(_E({fs:r/5,pn:M,anchor_x:j,anchor_y:B,anchorplacement:a,textalign:x,orthogonal:l,verticallyinverted:c,layer:"top"})),y&&v.push(_E({fs:r/5,pn:M,anchor_x:j,anchor_y:B,anchorplacement:a,textalign:x,orthogonal:l,verticallyinverted:c,layer:"bottom"})))},I=new Set,E=s>2&&P>2;if(s===1){let M=-((o-1)/2)*t;for(let A=0;A<o;A++){let R=A+1,j=M+A*t,B=`${j},0`;if(I.has(B))throw new Error(`Overlap at ${B}`);I.add(B),T(R,j,0)}}else if(E){let M=-((P-1)/2)*t,A=1;for(let R=0;R<s&&A<=o;R++)for(let j=0;j<P&&A<=o;j++){let B=M+j*t,G=R*w,U=`${B},${G}`;if(I.has(U))throw new Error(`Overlap at ${U}`);I.add(U),T(A++,B,G)}}else{let M=-((P-1)/2)*t,A=1,R=0,j=s-1,B=0,G=P-1;for(;A<=o&&R<=j&&B<=G;){for(let U=R;U<=j&&A<=o;U++){let H=M+B*t,tt=U*w,et=`${H},${tt}`;if(I.has(et))throw new Error(`Overlap at ${et}`);I.add(et),T(A++,H,tt)}B++;for(let U=B;U<=G&&A<=o;U++){let H=M+U*t,tt=j*w,et=`${H},${tt}`;if(I.has(et))throw new Error(`Overlap at ${et}`);I.add(et),T(A++,H,tt)}if(j--,B<=G){for(let U=j;U>=R&&A<=o;U--){let H=M+G*t,tt=U*w,et=`${H},${tt}`;if(I.has(et))throw new Error(`Overlap at ${et}`);I.add(et),T(A++,H,tt)}G--}if(R<=j){for(let U=G;U>=B&&A<=o;U--){let H=M+U*t,tt=R*w,et=`${H},${tt}`;if(I.has(et))throw new Error(`Overlap at ${et}`);I.add(et),T(A++,H,tt)}R++}}if(A-1<o)throw new Error(`Missing pins: assigned ${A-1}, expected ${o}`)}let N=ie(0,t,.5);return{circuitJson:[...v,N],parameters:e}},Jft=Qs({}),Qft=n=>{let e=Jft.parse({fn:"sot563",num_pins:6,w:1.94,p:.5,pw:.3,pl:.67,legoutside:!0});return{circuitJson:Pa(e),parameters:e}},tmt=Qs({p:"1.27mm",w:"3.9mm",legsoutside:!0}),emt=n=>{let e=tmt.parse({...n,num_pins:8});return{circuitJson:Pa(e),parameters:e}},nmt=Qs({p:"1.27mm",w:"7.5mm",legsoutside:!0}),imt=n=>{let e=nmt.parse({...n,num_pins:16});return{circuitJson:Pa(e),parameters:e}},rmt=h.object({fn:h.string(),num_pins:h.literal(3).default(3),w:h.string().default("1.2mm"),h:h.string().default("1.2mm"),pl:h.string().default("0.3mm"),pw:h.string().default("0.32mm")}),smt=n=>{let e=rmt.parse(n),t=amt(e),i=ie(.4,D.parse(e.h),.2);return{circuitJson:[...t,i],parameters:e}},omt=n=>{let{pn:e,w:t,h:i,pl:r}=n;return e===1?{x:0,y:0}:e===2?{x:1,y:-.4}:{x:1,y:.4}},amt=n=>{let e=[];for(let t=0;t<3;t++){let{x:i,y:r}=omt({num_pins:n.num_pins,pn:t+1,w:Number.parseFloat(n.w),h:Number.parseFloat(n.h),pl:Number.parseFloat(n.pl)});e.push(Ut(t+1,i,r,Number.parseFloat(n.pl),t!==0?Number.parseFloat(n.pw):.42))}return e},cmt=h.object({fn:h.string(),num_pins:h.literal(2).default(2),w:h.string().default("2.36mm"),h:h.string().default("1.22mm"),pl:h.string().default("0.9mm"),pw:h.string().default("0.9mm"),p:h.string().default("4.19mm")}),lmt=n=>{let e=cmt.parse(n),t=ie(0,D.parse(e.h)/4+.4,.3);return{circuitJson:pmt(e).concat(t),parameters:e}},umt=n=>{let{pn:e,p:t}=n;return e===1?{x:-t/2,y:0}:{x:t/2,y:0}},pmt=n=>{let e=[];for(let t=1;t<=n.num_pins;t++){let{x:i,y:r}=umt({pn:t,p:Number.parseFloat(n.p)});e.push(Ut(t,i,r,Number.parseFloat(n.pl),Number.parseFloat(n.pw)))}return e},hmt=h.object({fn:h.string(),p:D.optional().default("2.54mm"),id:D.optional().default("0.7mm"),od:D.optional().default("1mm")}),dmt=n=>{let e=hmt.parse(n),{p:t,id:i,od:r}=e,s=[Te(1,-t/2,0,i,r),Te(2,t/2,0,i,r)],o={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:-t/2+r+i/2,y:0},{x:t/2-r-i/2,y:0}],stroke_width:.1,pcb_silkscreen_path_id:""},a=ie(0,t/4,.5);return{circuitJson:[...s,o,a],parameters:e}},Kx=(n,e={})=>({type:"pcb_silkscreen_path",layer:e.layer||"top",pcb_component_id:e.pcb_component_id||"",pcb_silkscreen_path_id:e.pcb_silkscreen_path_id||"",route:n,stroke_width:e.stroke_width||.1}),fmt=h.object({fn:h.literal("pushbutton"),w:D.default(4.5),h:D.default(6.5),id:D.default(1),od:D.default(1.2)}),mmt=n=>{let e=fmt.parse(n),t=e.w,i=e.h,r=e.id,s=[Te(1,-t/2,i/2,r,r*1.5),Te(2,-t/2,-i/2,r,r*1.5),Te(3,t/2,-i/2,r,r*1.5),Te(4,t/2,i/2,r,r*1.5)],o=[Kx([{x:-t/2,y:-i/2},{x:-t/2,y:i/2}]),Kx([{x:t/2,y:-i/2},{x:t/2,y:i/2}]),Kx([{x:-t/2,y:0},{x:-t/5,y:0},{x:t/5*1/Math.sqrt(2),y:i/8}]),Kx([{x:t/2,y:0},{x:t/5,y:0}])],a=ie(0,i/2+.4,.5);return{circuitJson:[...s,...o,a],parameters:e}},wB=h.object({fn:h.string(),w:D.default("22.58mm"),h:D.optional(),left:D.optional().default(20),right:D.optional().default(20),top:D.optional().default(2),bottom:D.optional().default(2),p:D.default(D.parse("2.54mm")),pw:D.default(D.parse("1.6mm")),pl:D.default(D.parse("2.4mm")),innerhole:h.boolean().default(!1),innerholeedgedistance:D.default(D.parse("1.61mm")),silkscreenlabels:h.boolean().default(!1),silkscreenlabelmargin:D.default(D.parse("0.1mm"))}),_mt=n=>{let e=wB.parse(n);return e.left&&e.right?Math.max(e.left,e.right)*e.p:e.left?e.left*e.p:e.right?e.right*e.p:51},Jx=(n,e,t)=>{let i=[];return t==="right"&&(i=[{x:n+1/2,y:e},{x:n-1/2,y:e+.6/2},{x:n-1/2,y:e-.6/2},{x:n+1/2,y:e}]),t==="left"&&(i=[{x:n-1/2,y:e},{x:n+1/2,y:e+.6/2},{x:n+1/2,y:e-.6/2},{x:n-1/2,y:e}]),t==="top"&&(i=[{x:n,y:e+1/2},{x:n-.6/2,y:e-1/2},{x:n+.6/2,y:e-1/2},{x:n,y:e+1/2}]),t==="bottom"&&(i=[{x:n,y:e-1/2},{x:n-.6/2,y:e+1/2},{x:n+.6/2,y:e+1/2},{x:n,y:e-1/2}]),i},ymt=n=>{let e=wB.parse(n),t=e.h??_mt(e),i=[],r=[],s=[],o=[],a=1,c=a,l=e.left+e.right+(e.bottom??0)+(e.top??0),p=`pin${l}`.length*.7/2;if(e.right){let x=-((e.right-1)/2)*e.p;for(let v=0;v<e.right;v++){if(v===0&&!e.left&&!e.bottom&&!e.silkscreenlabels&&(o=Jx(e.w/2-e.pl*1.4,x+v*e.p,"right")),i.push(Ut(v+1+e.left+(e.bottom??0),e.w/2-e.pl/2,x+v*e.p,e.pl,e.pw)),e.silkscreenlabels){let P=v+1+e.left+(e.bottom??0),w=`pin${P}`;s.push({type:"pcb_silkscreen_text",pcb_silkscreen_text_id:`pin_${P}`,pcb_component_id:"1",layer:"top",anchor_position:{x:e.w/2-e.pl-(p+e.silkscreenlabelmargin),y:x+v*e.p},text:w,font_size:.7,font:"tscircuit2024",anchor_alignment:"center"})}e.innerhole&&(r.push(Te(v+1+e.left+(e.bottom??0)+l,e.w/2,x+v*e.p,a,c)),r.push(Te(v+1+e.left+(e.bottom??0)+l*2,e.w/2-e.innerholeedgedistance,x+v*e.p,a,c)))}}if(e.left){let x=(e.left-1)/2*e.p;for(let v=0;v<e.left;v++){if(v===0&&!e.silkscreenlabels&&(o=Jx(-e.w/2+e.pl*1.4,x-v*e.p,"left")),i.push(Ut(v+1,-e.w/2+e.pl/2,x-v*e.p,e.pl,e.pw)),e.silkscreenlabels){let P=v+1,w=`pin${P}`;s.push({type:"pcb_silkscreen_text",pcb_silkscreen_text_id:`pin_${P}`,pcb_component_id:"1",layer:"top",anchor_position:{x:-e.w/2+e.pl+(p+e.silkscreenlabelmargin),y:x-v*e.p},text:w,font_size:.7,font:"tscircuit2024",anchor_alignment:"center"})}e.innerhole&&(r.push(Te(v+1+l,-e.w/2,x-v*e.p,a,c)),r.push(Te(v+1+l*2,-e.w/2+e.innerholeedgedistance,x-v*e.p,a,c)))}}if(e.top){let x=(e.top-1)/2*e.p;for(let v=0;v<e.top;v++){if(v===0&&!e.left&&!e.bottom&&!e.right&&!e.silkscreenlabels&&(o=Jx(x-v*e.p,t/2-e.pl*1.4,"top")),i.push(Ut(v+1+e.left+e.right+(e.bottom??0),x-v*e.p,t/2-e.pl/2,e.pw,e.pl)),e.silkscreenlabels){let P=v+1+e.left+e.right+(e.bottom??0),w=`pin${P}`;s.push({type:"pcb_silkscreen_text",pcb_silkscreen_text_id:`pin_${P}`,pcb_component_id:"1",layer:"top",anchor_position:{x:x-v*e.p,y:t/2-e.pl-(p+e.silkscreenlabelmargin)},text:w,font_size:.7,font:"tscircuit2024",anchor_alignment:"center",ccw_rotation:270})}e.innerhole&&(r.push(Te(v+1+e.left+e.right+(e.bottom??0)+l,x-v*e.p,t/2,a,c)),r.push(Te(v+1+e.left+e.right+(e.bottom??0)+l*2,x-v*e.p,t/2-e.innerholeedgedistance,a,c)))}}if(e.bottom){let x=-((e.bottom-1)/2)*e.p;for(let v=0;v<e.bottom;v++){if(v===0&&!e.left&&!e.silkscreenlabels&&(o=Jx(x+v*e.p,-t/2+e.pl*1.4,"bottom")),i.push(Ut(v+1+e.left,x+v*e.p,-t/2+e.pl/2,e.pw,e.pl)),e.silkscreenlabels){let P=v+1+e.left,w=`pin${P}`;s.push({type:"pcb_silkscreen_text",pcb_silkscreen_text_id:`pin_${P}`,pcb_component_id:"1",layer:"top",anchor_position:{x:x+v*e.p,y:-t/2+e.pl+(p+e.silkscreenlabelmargin)},text:w,font_size:.7,font:"tscircuit2024",anchor_alignment:"center",ccw_rotation:90})}e.innerhole&&(r.push(Te(v+1+e.left+l,x+v*e.p,-t/2,a,c)),r.push(Te(v+1+e.left+l*2,x+v*e.p,-t/2+e.innerholeedgedistance,a,c)))}}let f={type:"pcb_silkscreen_path",pcb_silkscreen_path_id:"pcb_silkscreen_triangle_1",pcb_component_id:"2",route:o,stroke_width:.1,layer:"top"},y={type:"pcb_silkscreen_path",pcb_silkscreen_path_id:"pcb_silkscreen_path_1",pcb_component_id:"1",route:[{x:-e.w/2,y:t/2},{x:e.w/2,y:t/2},{x:e.w/2,y:-t/2},{x:-e.w/2,y:-t/2},{x:-e.w/2,y:t/2}],stroke_width:.1,layer:"top"},g=ie(0,t/1.8,t/25);return{circuitJson:[...i,...r,...s,y,...e.silkscreenlabels?[]:[f],g],parameters:e}},PB=h.object({fn:h.string(),w:D.default("22.58mm"),h:D.optional(),left:D.optional().default(20),right:D.optional().default(20),top:D.optional().default(2),bottom:D.optional().default(2),p:D.default(D.parse("2.54mm")),pw:D.default(D.parse("1.6mm")),pl:D.default(D.parse("3.2mm")),innerhole:h.boolean().default(!1),innerholeedgedistance:D.default(D.parse("1.61mm"))}),gmt=n=>{let e=PB.parse(n);return e.left&&e.right?Math.max(e.left,e.right)*e.p:e.left?e.left*e.p:e.right?e.right*e.p:51},xmt=(n,e,t,i=1,r=.6)=>{let s=i/2,o=r/2;return{left:[{x:n+s,y:e},{x:n-s,y:e+o},{x:n-s,y:e-o},{x:n+s,y:e}],right:[{x:n-s,y:e},{x:n+s,y:e+o},{x:n+s,y:e-o},{x:n-s,y:e}],top:[{x:n,y:e-s},{x:n-o,y:e+s},{x:n+o,y:e+s},{x:n,y:e-s}],bottom:[{x:n,y:e+s},{x:n-o,y:e-s},{x:n+o,y:e-s},{x:n,y:e+s}]}[t]},bmt=n=>{let e=PB.parse(n),t=e.h??gmt(e),i=[],r=[],s=[],o=1,a=1.2,c=e.left+e.right+(e.bottom??0)+(e.top??0),l=[],u=1;if(e.left){let g=(e.left-1)/2*e.p;for(let x=0;x<e.left;x++)x===0&&(l=xmt(-e.w/2-e.pl/2,g-x*e.p,"left")),i.push(Ut(u,-e.w/2+e.pl/2,g-x*e.p,e.pl,e.pw)),r.push({type:"pcb_silkscreen_text",pcb_silkscreen_text_id:`pin_${u}`,pcb_component_id:"1",layer:"top",anchor_position:{x:-e.w/2+e.pl/2-4.5,y:g-x*e.p},text:`pin${u}`,font_size:.7,font:"tscircuit2024",anchor_alignment:"center"}),u++,e.innerhole&&s.push(Te(u+c,-e.w/2+e.innerholeedgedistance,g-x*e.p,o,a))}if(e.bottom){let g=(e.bottom-1)/2*e.p;for(let x=e.bottom-1;x>=0;x--)i.push(Ut(u,g-x*e.p,-t/2+e.pl/2,e.pw,e.pl)),r.push({type:"pcb_silkscreen_text",pcb_silkscreen_text_id:`pin_${u}`,pcb_component_id:"1",layer:"top",anchor_position:{x:g-x*e.p,y:-t/2+e.pl/2-3.2},text:`pin${u}`,font_size:.7,font:"tscircuit2024",anchor_alignment:"center"}),u++,e.innerhole&&s.push(Te(u+c,g-x*e.p,-t/2+e.innerholeedgedistance,o,a))}if(e.right){let g=-((e.right-1)/2)*e.p;for(let x=0;x<e.right;x++)i.push(Ut(u,e.w/2-e.pl/2,g+x*e.p,e.pl,e.pw)),r.push({type:"pcb_silkscreen_text",pcb_silkscreen_text_id:`pin_${u}`,pcb_component_id:"1",layer:"top",anchor_position:{x:e.w/2-e.pl/2+3.7,y:g+x*e.p},text:`pin${u}`,font_size:.7,font:"tscircuit2024",anchor_alignment:"center"}),u++,e.innerhole&&s.push(Te(u+c,e.w/2-e.innerholeedgedistance,g+x*e.p,o,a))}if(e.top){let g=-((e.top-1)/2)*e.p;for(let x=e.top-1;x>=0;x--)i.push(Ut(u,g+x*e.p,t/2-e.pl/2,e.pw,e.pl)),r.push({type:"pcb_silkscreen_text",pcb_silkscreen_text_id:`pin_${u}`,pcb_component_id:"1",layer:"top",anchor_position:{x:g+x*e.p,y:t/2-e.pl/2+3.2},text:`pin${u}`,font_size:.7,font:"tscircuit2024",anchor_alignment:"center"}),u++,e.innerhole&&s.push(Te(u+c,g+x*e.p,t/2-e.innerholeedgedistance,o,a))}let p={type:"pcb_silkscreen_path",pcb_silkscreen_path_id:"1",pcb_component_id:"1",layer:"top",route:l,stroke_width:.1},f={type:"pcb_silkscreen_path",pcb_silkscreen_path_id:"pcb_silkscreen_path_1",pcb_component_id:"1",route:[{x:-e.w/2-e.pl/3,y:t/2+e.pl/3},{x:e.w/2+e.pl/3,y:t/2+e.pl/3},{x:e.w/2+e.pl/3,y:-t/2-e.pl/3},{x:-e.w/2-e.pl/3,y:-t/2-e.pl/3},{x:-e.w/2-e.pl/3,y:t/2+e.pl/3}],stroke_width:.1,layer:"top"},y=ie(0,t/1.8,t/25);return{circuitJson:[...s,...i,...r,f,p,y],parameters:e}},vmt=n=>(n.legsoutside=!0,sg(n)),kB=h.object({fn:h.string(),w:D.default("10mm"),h:D.optional(),left:D.optional().default(20),right:D.optional().default(20),top:D.optional().default(0),bottom:D.optional().default(0),p:D.default(D.parse("2.54mm")),id:D.optional().default(D.parse("1mm")),od:D.optional().default(D.parse("1.5mm"))}),Smt=n=>{let e=kB.parse(n);return e.left&&e.right?Math.max(e.left,e.right)*e.p:e.left?e.left*e.p:e.right?e.right*e.p:51},Qx=(n,e,t,i=1,r=.6)=>{let s=i/2,o=r/2;return{left:[{x:n+s,y:e},{x:n-s,y:e+o},{x:n-s,y:e-o},{x:n+s,y:e}],right:[{x:n-s,y:e},{x:n+s,y:e+o},{x:n+s,y:e-o},{x:n-s,y:e}],top:[{x:n,y:e-s},{x:n-o,y:e+s},{x:n+o,y:e+s},{x:n,y:e-s}],bottom:[{x:n,y:e+s},{x:n-o,y:e-s},{x:n+o,y:e-s},{x:n,y:e+s}]}[t]},wmt=n=>{let e=kB.parse(n),t=e.h??Smt(e),i=[],r=e.id,s=e.od,o=[];if(e.right){let u=-((e.right-1)/2)*e.p;for(let p=0;p<e.right;p++)p===0&&!e.left&&!e.bottom&&(o=Qx(e.w/2+s*1.4,u+p*e.p,"right")),i.push(Te(p+1+e.left+(e.bottom??0),e.w/2,u+p*e.p,r,s))}if(e.left){let u=-((e.left-1)/2)*e.p;for(let p=0;p<e.left;p++)p===e.left-1&&(o=Qx(-e.w/2-s*1.4,u+p*e.p,"left")),i.push(Te(p+1,-e.w/2,u+p*e.p,r,s))}if(e.top){let u=-((e.top-1)/2)*e.p;for(let p=0;p<e.top;p++)p===e.top-1&&!e.left&&!e.bottom&&!e.right&&(o=Qx(u+p*e.p,t/2+s*1.4,"top")),i.push(Te(p+1+e.right+(e.bottom??0)+e.left,u+p*e.p,t/2,r,s))}if(e.bottom){let u=-((e.bottom-1)/2)*e.p;for(let p=0;p<e.bottom;p++)p===0&&!e.left&&(o=Qx(u+p*e.p,-t/2-s*1.4,"bottom")),i.push(Te(p+1+e.left,u+p*e.p,-t/2,r,s))}let a={type:"pcb_silkscreen_path",pcb_silkscreen_path_id:"1",pcb_component_id:"1",layer:"top",route:o,stroke_width:.1},c={type:"pcb_silkscreen_path",pcb_silkscreen_path_id:"pcb_silkscreen_path_1",pcb_component_id:"1",route:[{x:-e.w/2-s,y:t/2+s},{x:e.w/2+s,y:t/2+s},{x:e.w/2+s,y:-t/2-s},{x:-e.w/2-s,y:-t/2-s},{x:-e.w/2-s,y:t/2+s}],stroke_width:.1,layer:"top"},l=ie(0,t/1.7,t/25);return{circuitJson:[...i,c,l,a],parameters:e}},cB=(n,e,t,i)=>Array.from({length:25},(r,s)=>{let o=s/24*Math.PI-Math.PI/2;return{x:n+(i==="right"?1:-1)*Math.cos(o)*t,y:e+Math.sin(o)*t}}),Pmt=h.object({fn:h.string(),p:D.optional().default("4.88mm"),id:D.optional().default("0.6mm"),od:D.optional().default("1.2mm"),w:D.optional().default("5.6mm"),h:D.optional().default("3.5mm")}),kmt=n=>{let e=Pmt.parse(n),{p:t,id:i,od:r,w:s,h:o}=e,a=o/2,c=[Te(1,-t/2,0,i,r),Te(2,t/2,0,i,r)],l=cB(-s/2,0,a,"left"),u=cB(s/2,0,a,"right"),p={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[...l,...l.slice(1).reverse(),{x:-s/2,y:-o/2},{x:s/2,y:-o/2},...u,{x:s/2,y:o/2},{x:-s/2,y:o/2}],stroke_width:.1,pcb_silkscreen_path_id:""},f=ie(0,t/4,.5);return{circuitJson:[...c,p,f],parameters:e}},YGt=h.object({w:D,h:D}),Tmt=n=>{let{w:e,h:t}=n,i=Ge(e),r=Ge(t);return{circuitJson:[Ut(1,0,0,i,r),ie(0,r/2+.5,.2)],parameters:n}},Emt=h.object({fn:h.string(),num_pins:h.union([h.literal(3),h.literal(2)]).default(3),p:h.string().default("1.27mm"),id:h.string().default("0.72mm"),od:h.string().default("0.95mm"),w:h.string().default("4.5mm"),h:h.string().default("4.5mm"),inline:h.boolean().default(!1),string:h.string().optional()}),Mmt=(n,e,t)=>Array.from({length:25},(i,r)=>{let s=r/24*Math.PI;return{x:n+Math.cos(s)*t,y:e+Math.sin(s)*t}}),Cmt=n=>{let{p:e,id:t,od:i,h:r}=n,s=Number.parseFloat(r)/2,o=Number.parseFloat(e);return[Te(1,-o,s-o,t,i),Te(2,o,s-o,t,i)]},Imt=n=>{let e=n.string?.match(/^to92_(\d+)/),t=e?Number.parseInt(e[1],10):3,i=Emt.parse({...n,num_pins:t}),{p:r,id:s,od:o,w:a,h:c,inline:l}=i,u=Number.parseFloat(c)/2,p=Number.parseFloat(r),f=[];if(i.num_pins===3)f=l?[Te(1,-p,u-p,s,o),Te(2,0,u-p,s,o),Te(3,p,u-p,s,o)]:[Te(1,0,u,s,o),Te(2,-p,u-p,s,o),Te(3,p,u-p,s,o)];else if(i.num_pins===2)f=Cmt(i);else throw new Error("Invalid number of pins for TO-92");let y=Number.parseFloat(a)/2,g=Mmt(0,u,y),x={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[...g,{x:-y,y:0},{x:y,y:0},g[0]],stroke_width:.1,pcb_silkscreen_path_id:""},v=ie(0,u+1,.5);return{circuitJson:[...f,x,v],parameters:i}},Nmt=h.object({fn:h.string(),num_pins:h.literal(2).default(2),w:h.string().default("2.15mm"),h:h.string().default("1.20mm"),pl:h.string().default("0.5mm"),pw:h.string().default("0.6mm"),p:h.string().default("1.4mm")}),Amt=n=>{let e=Nmt.parse(n),t=ie(0,D.parse(e.h),.3),i={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:D.parse(e.p)/2,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2-.2,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2-.2,y:-D.parse(e.h)/2},{x:D.parse(e.p)/2,y:-D.parse(e.h)/2}],stroke_width:.1,pcb_silkscreen_path_id:""};return{circuitJson:Omt(e).concat(i,t),parameters:e}},Rmt=n=>{let{pn:e,p:t}=n;return e===1?{x:-t/2,y:0}:{x:t/2,y:0}},Omt=n=>{let e=[];for(let t=1;t<=n.num_pins;t++){let{x:i,y:r}=Rmt({pn:t,p:Number.parseFloat(n.p)});e.push(Ut(t,i,r,Number.parseFloat(n.pl),Number.parseFloat(n.pw)))}return e},Lmt=Qs({}),Fmt=n=>{let e=Lmt.parse(n),t=[];for(let o=0;o<e.num_pins;o++){let{x:a,y:c}=yE({num_pins:e.num_pins,pn:o+1,w:e.w,p:e.p??1.27,pl:e.pl,widthincludeslegs:!0});t.push(Ut(o+1,a,c,e.pl??"1.5mm",e.pw??"0.6mm"))}let i=(e.num_pins/2-1)*e.p+e.pw,r=ie(0,i/2-.5,i/12),s={layer:"top",pcb_component_id:"",pcb_silkscreen_path_id:"",type:"pcb_silkscreen_path",route:[{x:-e.w/3,y:i/2+.2},{x:e.w/3,y:i/2+.2}],stroke_width:.1};return{circuitJson:[...t,r,s],parameters:e}},zmt=h.object({fn:h.string(),num_pins:h.literal(2).default(2),w:h.string().default("5.0mm"),h:h.string().default("2.30mm"),pl:h.string().default("1.25mm"),pw:h.string().default("2mm"),p:h.string().default("3.75mm")}),$mt=n=>{let e=zmt.parse(n),t=ie(0,D.parse(e.h)/2+1,.3),i={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:D.parse(e.p)/2+.5,y:D.parse(e.h)/2+.5},{x:-D.parse(e.w)/2-.5,y:D.parse(e.h)/2+.5},{x:-D.parse(e.w)/2-.5,y:-D.parse(e.h)/2-.5},{x:D.parse(e.p)/2+.5,y:-D.parse(e.h)/2-.5}],stroke_width:.1,pcb_silkscreen_path_id:""};return{circuitJson:jmt(e).concat(i,t),parameters:e}},Dmt=n=>{let{pn:e,p:t}=n;return e===1?{x:-t/2,y:0}:{x:t/2,y:0}},jmt=n=>{let e=[];for(let t=1;t<=n.num_pins;t++){let{x:i,y:r}=Dmt({pn:t,p:Number.parseFloat(n.p)});e.push(Ut(t,i,r,Number.parseFloat(n.pl),Number.parseFloat(n.pw)))}return e},Bmt=h.object({fn:h.string(),num_pins:h.literal(2).default(2),w:h.string().default("4.4mm"),h:h.string().default("2.1mm"),pl:h.string().default("1.2mm"),pw:h.string().default("1.2mm"),p:h.string().default("2.9mm")}),Ymt=n=>{let e=Bmt.parse(n),t=ie(0,D.parse(e.h)-.5,.3),i={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:D.parse(e.p)/2,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2-.2,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2-.2,y:-D.parse(e.h)/2},{x:D.parse(e.p)/2,y:-D.parse(e.h)/2}],stroke_width:.1,pcb_silkscreen_path_id:""};return{circuitJson:Umt(e).concat(i,t),parameters:e}},Xmt=n=>{let{pn:e,p:t}=n;return e===1?{x:-t/2,y:0}:{x:t/2,y:0}},Umt=n=>{let e=[];for(let t=1;t<=n.num_pins;t++){let{x:i,y:r}=Xmt({pn:t,p:Number.parseFloat(n.p)});e.push(Ut(t,i,r,Number.parseFloat(n.pl),Number.parseFloat(n.pw)))}return e},Vmt=h.object({fn:h.string(),num_pins:h.literal(2).default(2),w:h.string().default("3.30mm"),h:h.string().default("1.80mm"),pl:h.string().default("0.60mm"),pw:h.string().default("0.45mm"),p:h.string().default("2.1mm")}),Gmt=n=>{let e=Vmt.parse(n),t=ie(0,D.parse(e.h)-.5,.3),i={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:D.parse(e.p)/2,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2,y:-D.parse(e.h)/2},{x:D.parse(e.p)/2,y:-D.parse(e.h)/2}],stroke_width:.1,pcb_silkscreen_path_id:""};return{circuitJson:Wmt(e).concat(i,t),parameters:e}},Hmt=n=>{let{pn:e,p:t}=n;return e===1?{x:-t/2,y:0}:{x:t/2,y:0}},Wmt=n=>{let e=[];for(let t=1;t<=n.num_pins;t++){let{x:i,y:r}=Hmt({pn:t,p:Number.parseFloat(n.p)});e.push(Ut(t,i,r,Number.parseFloat(n.pl),Number.parseFloat(n.pw)))}return e},qmt=h.object({fn:h.string(),num_pins:h.literal(2).default(2),w:h.string().default("1.4mm"),h:h.string().default("0.9mm"),pl:h.string().default("0.35mm"),pw:h.string().default("0.25mm"),p:h.string().default("1.2mm")}),Zmt=n=>{let e=qmt.parse(n),t=ie(0,D.parse(e.h),.3),i={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:D.parse(e.p)/2+.15,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2-.4,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2-.4,y:-D.parse(e.h)/2},{x:D.parse(e.p)/2+.15,y:-D.parse(e.h)/2}],stroke_width:.1,pcb_silkscreen_path_id:""};return{circuitJson:Jmt(e).concat(i,t),parameters:e}},Kmt=n=>{let{pn:e,p:t}=n;return e===1?{x:-t/2,y:0}:{x:t/2,y:0}},Jmt=n=>{let e=[];for(let t=1;t<=n.num_pins;t++){let{x:i,y:r}=Kmt({pn:t,p:Number.parseFloat(n.p)});e.push(Ut(t,i,r,Number.parseFloat(n.pl),Number.parseFloat(n.pw)))}return e},Qmt=h.object({fn:h.string(),num_pins:h.literal(2).default(2),w:h.string().default("1.3mm"),h:h.string().default("0.9mm"),pl:h.string().default("0.4mm"),pw:h.string().default("0.7mm"),p:h.string().default("0.7mm")}),t_t=n=>{let e=Qmt.parse(n),t=ie(0,D.parse(e.h)+.1,.3),i={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:D.parse(e.p)/2+.2,y:D.parse(e.h)/2+.2},{x:-D.parse(e.w)/2-.2,y:D.parse(e.h)/2+.2},{x:-D.parse(e.w)/2-.2,y:-D.parse(e.h)/2-.2},{x:D.parse(e.p)/2+.2,y:-D.parse(e.h)/2-.2}],stroke_width:.1,pcb_silkscreen_path_id:""};return{circuitJson:n_t(e).concat(i,t),parameters:e}},e_t=n=>{let{pn:e,p:t}=n;return e===1?{x:-t/2,y:0}:{x:t/2,y:0}},n_t=n=>{let e=[];for(let t=1;t<=n.num_pins;t++){let{x:i,y:r}=e_t({pn:t,p:Number.parseFloat(n.p)});e.push(Ut(t,i,r,Number.parseFloat(n.pl),Number.parseFloat(n.pw)))}return e},i_t=h.object({fn:h.string(),num_pins:h.literal(2).default(2),w:h.string().default("3,05mm"),h:h.string().default("1.65mm"),pl:h.string().default("0.6mm"),pw:h.string().default("0.6mm"),pad_spacing:h.string().default("2.2mm")}),r_t=n=>{let e=i_t.parse(n),t=ie(0,D.parse(e.h),.3),i={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:D.parse(e.pad_spacing)/2,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2-.2,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2-.2,y:-D.parse(e.h)/2},{x:D.parse(e.pad_spacing)/2,y:-D.parse(e.h)/2}],stroke_width:.1,pcb_silkscreen_path_id:""};return{circuitJson:o_t(e).concat(i,t),parameters:e}},s_t=n=>{let{pn:e,pad_spacing:t}=n;return e===1?{x:-t/2,y:0}:{x:t/2,y:0}},o_t=n=>{let e=[];for(let t=1;t<=n.num_pins;t++){let{x:i,y:r}=s_t({pn:t,pad_spacing:Number.parseFloat(n.pad_spacing)});e.push(Ut(t,i,r,Number.parseFloat(n.pl),Number.parseFloat(n.pw)))}return e},a_t=h.object({fn:h.string(),num_pins:h.literal(2).default(2),w:h.string().default("4.4mm"),h:h.string().default("2.1mm"),pl:h.string().default("1.2mm"),pw:h.string().default("1.2mm"),p:h.string().default("2.9mm")}),c_t=n=>{let e=a_t.parse(n),t=ie(0,D.parse(e.h),.3),i={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:D.parse(e.p)/2,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2-.2,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2-.2,y:-D.parse(e.h)/2},{x:D.parse(e.p)/2,y:-D.parse(e.h)/2}],stroke_width:.1,pcb_silkscreen_path_id:""};return{circuitJson:u_t(e).concat(i,t),parameters:e}},l_t=n=>{let{pn:e,p:t}=n;return e===1?{x:-t/2,y:0}:{x:t/2,y:0}},u_t=n=>{let e=[];for(let t=1;t<=n.num_pins;t++){let{x:i,y:r}=l_t({pn:t,p:Number.parseFloat(n.p)});e.push(Ut(t,i,r,Number.parseFloat(n.pl),Number.parseFloat(n.pw)))}return e},p_t=h.object({fn:h.string(),num_pins:h.literal(2).default(2),w:h.string().default("4.4mm"),h:h.string().default("2.1mm"),pl:h.string().default("0.91mm"),pw:h.string().default("1.22mm"),p:h.string().default("3.146mm")}),h_t=n=>{let e=p_t.parse(n),t=ie(0,D.parse(e.h),.3),i={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:D.parse(e.p)/2,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2-.2,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2-.2,y:-D.parse(e.h)/2},{x:D.parse(e.p)/2,y:-D.parse(e.h)/2}],stroke_width:.1,pcb_silkscreen_path_id:""};return{circuitJson:f_t(e).concat(i,t),parameters:e}},d_t=n=>{let{pn:e,p:t}=n;return e===1?{x:-t/2,y:0}:{x:t/2,y:0}},f_t=n=>{let e=[];for(let t=1;t<=n.num_pins;t++){let{x:i,y:r}=d_t({pn:t,p:Number.parseFloat(n.p)});e.push(Ut(t,i,r,Number.parseFloat(n.pl),Number.parseFloat(n.pw)))}return e},m_t=h.object({fn:h.string(),num_pins:h.literal(2).default(2),w:h.string().default("1.80mm"),h:h.string().default("1.00mm"),pl:h.string().default("0.66mm"),pw:h.string().default("0.5mm"),p:h.string().default("0.8mm")}),__t=n=>{let e=m_t.parse(n),t=ie(0,D.parse(e.h),.3),i={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:D.parse(e.p)/2,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2-.1,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2-.1,y:-D.parse(e.h)/2},{x:D.parse(e.p)/2,y:-D.parse(e.h)/2}],stroke_width:.1,pcb_silkscreen_path_id:""};return{circuitJson:g_t(e).concat(i,t),parameters:e}},y_t=n=>{let{pn:e,p:t}=n;return e===1?{x:-t/2,y:0}:{x:t/2,y:0}},g_t=n=>{let e=[];for(let t=1;t<=n.num_pins;t++){let{x:i,y:r}=y_t({pn:t,p:Number.parseFloat(n.p)});e.push(Ut(t,i,r,Number.parseFloat(n.pl),Number.parseFloat(n.pw)))}return e},x_t=h.object({fn:h.string(),num_pins:h.literal(2).default(2),w:h.string().default("6.2mm"),h:h.string().default("3.4mm"),pl:h.string().default("1.4mm"),pw:h.string().default("2.1mm"),p:h.string().default("4.4mm")}),b_t=n=>{let e=x_t.parse(n),t=ie(0,D.parse(e.h)/2+.4,.3),i={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:D.parse(e.p)/2,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2-.2,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2-.2,y:-D.parse(e.h)/2},{x:D.parse(e.p)/2,y:-D.parse(e.h)/2}],stroke_width:.1,pcb_silkscreen_path_id:""};return{circuitJson:S_t(e).concat(i,t),parameters:e}},v_t=n=>{let{pn:e,p:t}=n;return e===1?{x:-t/2,y:0}:{x:t/2,y:0}},S_t=n=>{let e=[];for(let t=1;t<=n.num_pins;t++){let{x:i,y:r}=v_t({pn:t,p:Number.parseFloat(n.p)});e.push(Ut(t,i,r,Number.parseFloat(n.pl),Number.parseFloat(n.pw)))}return e},w_t=h.object({fn:h.string(),num_pins:h.union([h.literal(3),h.literal(5)]).default(3),w:h.string().default("4.80mm"),h:h.string().default("4.80mm"),pl:h.string().default("1.3mm"),pw:h.string().default("0.9mm"),p:h.string().default("1.5mm"),string:h.string().optional()}),P_t=n=>{let e=[],t=Number.parseFloat(n.p),i=Number.parseFloat(n.pw),r=Number.parseFloat(n.w),s=Number.parseFloat(n.pl);e.push(Ut(1,-r/2,t,s,i),Ut(2,-r/2+(1.5-1.3)/2,0,1.5,i),Ut(3,-r/2,-t,s,i));let o=ie(0,0,.3),a=Number.parseFloat(n.w)/2-1,c=Number.parseFloat(n.h)/2,l={layer:"top",pcb_component_id:"",pcb_silkscreen_path_id:"silkscreen_path_1",route:[{x:-a,y:c},{x:a,y:c},{x:a,y:c/2+.5}],type:"pcb_silkscreen_path",stroke_width:.1},u={layer:"top",pcb_component_id:"",pcb_silkscreen_path_id:"silkscreen_path_2",route:[{x:-a,y:-c},{x:a,y:-c},{x:a,y:-c/2-.5}],type:"pcb_silkscreen_path",stroke_width:.1};return[...e,l,u,o]},k_t=n=>{let e=[],t=Number.parseFloat(n.p),i=Number.parseFloat(n.pw),r=Number.parseFloat(n.w);e.push(Ut(1,-1.85,-1.5,1.5,.7),Ut(2,-1.85,1.5,1.5,.7),Ut(3,0,0,.8,2),Ut(4,1.85,-1.5,1.5,.7),Ut(5,1.85,1.5,1.5,.7));let s=ie(0,Number.parseFloat(n.h)/2+.5,.3),o=Number.parseFloat(n.w)/2-1,a=Number.parseFloat(n.h)/2,c={layer:"top",pcb_component_id:"",pcb_silkscreen_path_id:"silkscreen_path_1",route:[{x:-o,y:a},{x:o,y:a}],type:"pcb_silkscreen_path",stroke_width:.1},l={layer:"top",pcb_component_id:"",pcb_silkscreen_path_id:"silkscreen_path_2",route:[{x:-o,y:-a},{x:o,y:-a}],type:"pcb_silkscreen_path",stroke_width:.1};return[...e,c,l,s]},T_t=n=>{let e=n.string?.match(/^sot89_(\d+)/),t=e?Number.parseInt(e[1],10):3,i=w_t.parse({...n,num_pins:t});if(i.num_pins===3)return{circuitJson:P_t(i),parameters:i};if(i.num_pins===5)return{circuitJson:k_t(i),parameters:i};throw new Error("Invalid number of pins for SOT89")},E_t=h.object({fn:h.string(),p:D.optional().default("5.0mm"),id:D.optional().default("1.0mm"),od:D.optional().default("1.9mm"),w:D.optional().default("13mm"),h:D.optional().default("7mm"),num_pins:h.number().optional(),string:h.string().optional()}),M_t=n=>{let e=E_t.parse(n),{fn:t,id:i,od:r,w:s,h:o,string:a}=e,c=Number.parseInt(a?.split("_")[1]??"3"),l=-1,u=s/2,p=o/2,f=2.5,y=s*.4,g=Math.max(f,y/(c-1)),x=Array.from({length:c},(I,E)=>{let N=c%2===0?(E-c/2+.5)*g:(E-Math.floor(c/2))*g;return Te(E+1,N,l,i,r)}),v={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:-u,y:-p},{x:u,y:-p},{x:u,y:p},{x:-u,y:p},{x:-u,y:-p}],stroke_width:.1,pcb_silkscreen_path_id:""},P=-p+2*o/3,w={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:-u,y:P},{x:u,y:P}],stroke_width:.1,pcb_silkscreen_path_id:""},k=[{type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:-s/6,y:P},{x:-s/6,y:p}],stroke_width:.1,pcb_silkscreen_path_id:""},{type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:s/6,y:P},{x:s/6,y:p}],stroke_width:.1,pcb_silkscreen_path_id:""}],T=ie(0,o/2+.6,.5);return{circuitJson:[...x,v,w,...k,T],parameters:{...e,p:g}}},C_t=h.object({fn:h.string(),num_pins:h.literal(2).default(2),w:h.string().default("5.40mm"),h:h.string().default("2.30mm"),pl:h.string().default("1.30mm"),pw:h.string().default("1.70mm"),p:h.string().default("3.5mm")}),I_t=n=>{let e=C_t.parse(n),t=ie(0,D.parse(e.h)/2+.4,.3),i={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:D.parse(e.p)/2,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2,y:-D.parse(e.h)/2},{x:D.parse(e.p)/2,y:-D.parse(e.h)/2}],stroke_width:.1,pcb_silkscreen_path_id:""};return{circuitJson:A_t(e).concat(i,t),parameters:e}},N_t=n=>{let{pn:e,p:t}=n;return e===1?{x:-t/2,y:0}:{x:t/2,y:0}},A_t=n=>{let e=[];for(let t=1;t<=n.num_pins;t++){let{x:i,y:r}=N_t({pn:t,p:Number.parseFloat(n.p)});e.push(Ut(t,i,r,Number.parseFloat(n.pl),Number.parseFloat(n.pw)))}return e},R_t=h.object({fn:h.string(),num_pins:h.literal(2).default(2),w:h.string().default("1.90mm"),h:h.string().default("1.33mm"),pl:h.string().default("0.5mm"),pw:h.string().default("0.7mm"),p:h.string().default("0.8mm")}),O_t=n=>{let e=R_t.parse(n),t=ie(0,D.parse(e.h)+.1,.3),i={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:D.parse(e.p)/2+.1,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2,y:-D.parse(e.h)/2},{x:D.parse(e.p)/2+.1,y:-D.parse(e.h)/2}],stroke_width:.1,pcb_silkscreen_path_id:""};return{circuitJson:F_t(e).concat(i,t),parameters:e}},L_t=n=>{let{pn:e,p:t}=n;return e===1?{x:-t/2,y:0}:{x:t/2,y:0}},F_t=n=>{let e=[];for(let t=1;t<=n.num_pins;t++){let{x:i,y:r}=L_t({pn:t,p:Number.parseFloat(n.p)});e.push(Ut(t,i,r,Number.parseFloat(n.pl),Number.parseFloat(n.pw)))}return e},z_t=h.object({fn:h.string(),num_pins:h.literal(2).default(2),w:h.string().default("7.0mm"),h:h.string().default("3.35mm"),pl:h.string().default("1.50mm"),pw:h.string().default("2.70mm"),p:h.string().default("4.8mm")}),$_t=n=>{let e=z_t.parse(n),t=ie(0,D.parse(e.h),.3),i={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:D.parse(e.p)/2,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2,y:-D.parse(e.h)/2},{x:D.parse(e.p)/2,y:-D.parse(e.h)/2}],stroke_width:.1,pcb_silkscreen_path_id:""};return{circuitJson:j_t(e).concat(i,t),parameters:e}},D_t=n=>{let{pn:e,p:t}=n;return e===1?{x:-t/2,y:0}:{x:t/2,y:0}},j_t=n=>{let e=[];for(let t=1;t<=n.num_pins;t++){let{x:i,y:r}=D_t({pn:t,p:Number.parseFloat(n.p)});e.push(Ut(t,i,r,Number.parseFloat(n.pl),Number.parseFloat(n.pw)))}return e},B_t=h.object({fn:h.string(),num_pins:h.literal(2).default(2),w:h.string().default("3.0mm"),h:h.string().default("1.80mm"),pl:h.string().default("0.80mm"),pw:h.string().default("1.20mm"),p:h.string().default("1.6mm")}),Y_t=n=>{let e=B_t.parse(n),t=ie(0,D.parse(e.h),.3),i={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:D.parse(e.p)/2,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2-.1,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2-.1,y:-D.parse(e.h)/2},{x:D.parse(e.p)/2,y:-D.parse(e.h)/2}],stroke_width:.1,pcb_silkscreen_path_id:""};return{circuitJson:U_t(e).concat(i,t),parameters:e}},X_t=n=>{let{pn:e,p:t}=n;return e===1?{x:-t/2,y:0}:{x:t/2,y:0}},U_t=n=>{let e=[];for(let t=1;t<=n.num_pins;t++){let{x:i,y:r}=X_t({pn:t,p:Number.parseFloat(n.p)});e.push(Ut(t,i,r,Number.parseFloat(n.pl),Number.parseFloat(n.pw)))}return e},V_t=h.object({fn:h.string(),num_pins:h.literal(2).default(2),w:h.string().default("7.10mm"),h:h.string().default("3.40mm"),pl:h.string().default("2.45mm"),pw:h.string().default("1.80mm"),p:h.string().default("4.05mm")}),G_t=n=>{let e=V_t.parse(n),t=ie(0,D.parse(e.h)/2+.5,.3),i={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:D.parse(e.p)/2,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2-.5,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2-.5,y:-D.parse(e.h)/2},{x:D.parse(e.p)/2,y:-D.parse(e.h)/2}],stroke_width:.1,pcb_silkscreen_path_id:""};return{circuitJson:W_t(e).concat(i,t),parameters:e}},H_t=n=>{let{pn:e,p:t}=n;return e===1?{x:-t/2,y:0}:{x:t/2,y:0}},W_t=n=>{let e=[];for(let t=1;t<=n.num_pins;t++){let{x:i,y:r}=H_t({pn:t,p:Number.parseFloat(n.p)});e.push(Ut(t,i,r,Number.parseFloat(n.pl),Number.parseFloat(n.pw)))}return e},q_t=h.object({fn:h.string(),num_pins:h.literal(2).default(2),w:h.string().default("4.80mm"),h:h.string().default("2.10mm"),pl:h.string().default("1.30mm"),pw:h.string().default("1.40mm"),p:h.string().default("2.9mm")}),Z_t=n=>{let e=q_t.parse(n),t=ie(0,D.parse(e.h)-.5,.3),i={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:D.parse(e.p)/2,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2,y:-D.parse(e.h)/2},{x:D.parse(e.p)/2,y:-D.parse(e.h)/2}],stroke_width:.1,pcb_silkscreen_path_id:""};return{circuitJson:J_t(e).concat(i,t),parameters:e}},K_t=n=>{let{pn:e,p:t}=n;return e===1?{x:-t/2,y:0}:{x:t/2,y:0}},J_t=n=>{let e=[];for(let t=1;t<=n.num_pins;t++){let{x:i,y:r}=K_t({pn:t,p:Number.parseFloat(n.p)});e.push(Ut(t,i,r,Number.parseFloat(n.pl),Number.parseFloat(n.pw)))}return e},Q_t=h.object({fn:h.string(),num_pins:h.literal(2).default(2),w:h.string().default("7.30mm"),h:h.string().default("4.40mm"),pl:h.string().default("2.50mm"),pw:h.string().default("2.30mm"),p:h.string().default("4.30mm")}),tyt=n=>{let e=Q_t.parse(n),t=ie(0,D.parse(e.h)/2+.5,.3),i={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:D.parse(e.p)/2,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2-.1,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2-.1,y:-D.parse(e.h)/2},{x:D.parse(e.p)/2,y:-D.parse(e.h)/2}],stroke_width:.1,pcb_silkscreen_path_id:""};return{circuitJson:nyt(e).concat(i,t),parameters:e}},eyt=n=>{let{pn:e,p:t}=n;return e===1?{x:-t/2,y:0}:{x:t/2,y:0}},nyt=n=>{let e=[];for(let t=1;t<=n.num_pins;t++){let{x:i,y:r}=eyt({pn:t,p:Number.parseFloat(n.p)});e.push(Ut(t,i,r,Number.parseFloat(n.pl),Number.parseFloat(n.pw)))}return e},iyt=h.object({fn:h.string(),num_pins:h.literal(2).default(2),w:h.string().default("10.70mm"),h:h.string().default("6.60mm"),pl:h.string().default("3.30mm"),pw:h.string().default("2.50mm"),p:h.string().default("6.80mm")}),ryt=n=>{let e=iyt.parse(n),t=ie(0,3,.3),i={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:D.parse(e.p)/2,y:D.parse(e.h)/2-.8},{x:-D.parse(e.w)/2-.8,y:D.parse(e.h)/2-.8},{x:-D.parse(e.w)/2-.8,y:-D.parse(e.h)/2+.8},{x:D.parse(e.p)/2,y:-D.parse(e.h)/2+.8}],stroke_width:.1,pcb_silkscreen_path_id:""};return{circuitJson:oyt(e).concat(i,t),parameters:e}},syt=n=>{let{pn:e,p:t}=n;return e===1?{x:-t/2,y:0}:{x:t/2,y:0}},oyt=n=>{let e=[];for(let t=1;t<=n.num_pins;t++){let{x:i,y:r}=syt({pn:t,p:Number.parseFloat(n.p)});e.push(Ut(t,i,r,Number.parseFloat(n.pl),Number.parseFloat(n.pw)))}return e},ayt=h.object({fn:h.string(),num_pins:h.number().default(4),w:h.string().default("8.50mm"),h:h.string().default("6.90mm"),pl:h.string().default("2mm"),pw:h.string().default("1.5mm"),p:h.string().default("2.30mm"),string:h.string().optional()}),cyt=n=>{let e=n.string?.match(/^sot223_(\d+)/),t=e?Number.parseInt(e[1],10):4;if(t===8){let r=pyt.parse({...n,num_pins:t});return{circuitJson:Pa(r),parameters:r}}let i=ayt.parse({...n,num_pins:t});if(i.num_pins===4)return{circuitJson:uyt(i),parameters:i};if(i.num_pins===5)return{circuitJson:dyt(i),parameters:i};if(i.num_pins===6)return{circuitJson:myt(i),parameters:i};throw new Error("Invalid number of pins")},lyt=n=>{let{pn:e,w:t,h:i,pl:r,p:s}=n;return e===1?{x:-t/2+1.1,y:s}:e===2?{x:-t/2+1.1,y:0}:e===3?{x:-t/2+1.1,y:-s}:{x:t/2-1.1,y:0}},uyt=n=>{let e=[];for(let a=0;a<n.num_pins;a++){let{x:c,y:l}=lyt({num_pins:n.num_pins,pn:a+1,w:Number.parseFloat(n.w),h:Number.parseFloat(n.h),pl:Number.parseFloat(n.pl),p:Number.parseFloat(n.p)}),u=a===3?3.8:Number.parseFloat(n.pw);e.push(Ut(a+1,c,l,Number.parseFloat(n.pl),u))}let t=ie(0,0,.3),i=Number.parseFloat(n.w)/2-2.4,r=Number.parseFloat(n.h)/2,s={layer:"top",pcb_component_id:"",pcb_silkscreen_path_id:"silkscreen_path_1",route:[{x:-i,y:r},{x:i,y:r},{x:i,y:r/2+.5}],type:"pcb_silkscreen_path",stroke_width:.1},o={layer:"top",pcb_component_id:"",pcb_silkscreen_path_id:"silkscreen_path_2",route:[{x:-i,y:-r},{x:i,y:-r},{x:i,y:-r/2-.5}],type:"pcb_silkscreen_path",stroke_width:.1};return[...e,s,o,t]},pyt=Qs({p:"0.90mm",w:"2.8mm",legsoutside:!0}),hyt=n=>{let{p:e,h:t,pn:i,w:r}=n;if(i===1)return{x:-r/2+1.2,y:e/2+e};if(i===2)return{x:-r/2+1.2,y:e/2};if(i===3)return{x:-r/2+1.2,y:-e/2};if(i===4)return{x:-r/2+1.2,y:-e/2-e};if(i===5)return{x:r/2-1,y:0};throw new Error("Invalid pin number")},dyt=n=>{let e=[];for(let a=1;a<=n.num_pins;a++){let{x:c,y:l}=hyt({h:Number.parseFloat(n.h),p:1.5,pn:a,w:Number.parseFloat(n.w)}),u=Number.parseFloat(n.pw),p=Number.parseFloat(n.pl);a===5?(u=3.4,p=1.8):(u=1,p=2.2),e.push(Ut(a,c,l,p,u))}let t=Number.parseFloat(n.w)/2-2.4,i=Number.parseFloat(n.h)/2,r={layer:"top",pcb_component_id:"",pcb_silkscreen_path_id:"silkscreen_path_1",route:[{x:-t,y:i},{x:t,y:i},{x:t,y:i/2+.5}],type:"pcb_silkscreen_path",stroke_width:.1},s={layer:"top",pcb_component_id:"",pcb_silkscreen_path_id:"silkscreen_path_2",route:[{x:-t,y:-i},{x:t,y:-i},{x:t,y:-i/2-.5}],type:"pcb_silkscreen_path",stroke_width:.1},o=ie(0,0,.3);return[...e,r,s,o]},fyt=n=>{let{p:e,h:t,pn:i,w:r}=n;if(i===1)return{x:-r/2+1.2,y:2*e};if(i===2)return{x:-r/2+1.2,y:e};if(i===3)return{x:-r/2+1.2,y:0};if(i===4)return{x:-r/2+1.2,y:-e};if(i===5)return{x:-r/2+1.2,y:-2*e};if(i===6)return{x:r/2-1.175,y:0};throw new Error("Invalid pin number")},myt=n=>{let e=[];for(let a=1;a<=n.num_pins;a++){let{x:c,y:l}=fyt({h:Number.parseFloat(n.h),p:1.3,pn:a,w:8.7}),u=Number.parseFloat(n.pw),p=Number.parseFloat(n.pl);a===6?(u=3.4,p=2.15):(u=.6,p=2.2),e.push(Ut(a,c,l,p,u))}let t=Number.parseFloat(n.w)/2-2.4,i=Number.parseFloat(n.h)/2,r={layer:"top",pcb_component_id:"",pcb_silkscreen_path_id:"silkscreen_path_1",route:[{x:-t,y:i},{x:t,y:i},{x:t,y:i/2+.5}],type:"pcb_silkscreen_path",stroke_width:.1},s={layer:"top",pcb_component_id:"",pcb_silkscreen_path_id:"silkscreen_path_2",route:[{x:-t,y:-i},{x:t,y:-i},{x:t,y:-i/2-.5}],type:"pcb_silkscreen_path",stroke_width:.1},o=ie(0,0,.3);return[...e,r,s,o]},_yt=h.object({fn:h.string(),num_pins:h.number().default(3),w:h.string().default("3.40mm"),h:h.string().default("3.30mm"),pl:h.string().default("1mm"),pw:h.string().default("0.7mm"),p:h.string().default("1.2mm"),string:h.string().optional()}),yyt=n=>{let e=n.string?.match(/^sot23w_(\d+)/),t=e?Number.parseInt(e[1],3):3,i=_yt.parse({...n,num_pins:t});if(i.num_pins===3)return{circuitJson:xyt(i),parameters:i};throw new Error("Invalid number of pins")},gyt=n=>{let{pn:e,w:t,h:i,pl:r,p:s}=n;return e===1?{x:-s,y:.95}:e===2?{x:-s,y:-.95}:{x:s,y:0}},xyt=n=>{let e=[];for(let a=0;a<n.num_pins;a++){let{x:c,y:l}=gyt({num_pins:n.num_pins,pn:a+1,w:Number.parseFloat(n.w),h:Number.parseFloat(n.h),pl:Number.parseFloat(n.pl),p:Number.parseFloat(n.p)});e.push(Ut(a+1,c,l,Number.parseFloat(n.pl),Number.parseFloat(n.pw)))}let t=ie(0,Number.parseInt(n.h)/2+1,.3),i=Number.parseFloat(n.w)/2-1,r=Number.parseFloat(n.h)/2,s={layer:"top",pcb_component_id:"",pcb_silkscreen_path_id:"silkscreen_path_1",route:[{x:-i,y:r},{x:i+.3,y:r},{x:i+.3,y:r/2}],type:"pcb_silkscreen_path",stroke_width:.1},o={layer:"top",pcb_component_id:"",pcb_silkscreen_path_id:"silkscreen_path_2",route:[{x:-i,y:-r},{x:i+.3,y:-r},{x:i+.3,y:-r/2}],type:"pcb_silkscreen_path",stroke_width:.1};return[...e,s,o,t]},byt=h.object({fn:h.string(),num_pins:h.union([h.literal(3),h.literal(2)]).default(3),p:h.string().default("1.27mm"),id:h.string().default("0.72mm"),od:h.string().default("0.95mm"),w:h.string().default("2.5mm"),h:h.string().default("4.2mm"),string:h.string().optional()}),vyt=n=>{let{p:e,id:t,od:i,w:r,h:s}=n,o=Number.parseFloat(s)/2,a=Number.parseFloat(e);return[Te(1,-a,o-a,t,i),Te(2,0,o-a,t,i),Te(3,a,o-a,t,i)]},Syt=n=>{let{p:e,id:t,od:i,h:r}=n,s=Number.parseFloat(r)/2,o=Number.parseFloat(e);return[Te(1,-o,s-o,t,i),Te(2,o,s-o,t,i)]},wyt=n=>{let e=n.string?.match(/^to92s_(\d+)/),t=e?Number.parseInt(e[1],10):3,i=byt.parse({...n,num_pins:t}),r=[];if(i.num_pins===3)r=vyt(i);else if(i.num_pins===2)r=Syt(i);else throw new Error("Invalid number of pins for TO-92");let s=Number.parseFloat(i.h)/2,o=Number.parseFloat(i.p),a={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:-s,y:s-o},{x:-1.9,y:0},{x:1.9,y:0},{x:s,y:s-o},{x:1.5,y:Number.parseFloat(i.h)/2+.5},{x:-1.5,y:Number.parseFloat(i.h)/2+.5},{x:-s,y:s-o}],stroke_width:.1,pcb_silkscreen_path_id:""},c=ie(0,s+1,.5);return{circuitJson:[...r,a,c],parameters:i}},Pyt=h.object({fn:h.string(),p:D.optional(),id:D.optional(),pw:D.optional(),pl:D.optional(),w:D.optional(),h:D.optional(),sh:h.union([h.boolean(),h.string(),h.number()]).optional().transform(n=>{if(typeof n=="string"){let e=Number(n);return Number.isNaN(e)?!0:e}return n}).describe('JST SH (Surface-mount) connector family. SH stands for "Super High-density".'),ph:h.boolean().optional().describe('JST PH (Through-hole) connector family. PH stands for "Pin Header".'),string:h.string().optional()}),kyt={ph:{p:D.parse("2.2mm"),id:D.parse("0.70mm"),pw:D.parse("1.20mm"),pl:D.parse("1.20mm"),w:D.parse("6mm"),h:D.parse("5mm")},sh:{p:D.parse("1mm"),pw:D.parse("0.6mm"),pl:D.parse("1.55mm"),w:D.parse("5.8mm"),h:D.parse("7.8mm")}};function Tyt(n){return n.sh?"sh":(n.ph,"ph")}function Eyt(n,e,t,i,r,s){let o=[];if(n==="ph"){let a=t/2;o.push(eb(1,-a,2,i,r,s)),o.push(eb(2,a,2,i,r,s))}else{let a=-((e-1)/2)*t;for(let l=0;l<e;l++){let u=a+l*t;console.log("x si",u),o.push(Ut(l+1,u,-1.325,r,s))}let c=(e-1)/2*t+1.3;console.log("offset",c),o.push(Ut(e+1,-c,1.22,1.2,1.8)),o.push(Ut(e+2,c,1.22,1.2,1.8))}return o}function Myt(n,e,t){return n==="ph"?{type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:-3,y:3},{x:3,y:3},{x:3,y:-2},{x:-3,y:-2},{x:-3,y:3}],stroke_width:.1,pcb_silkscreen_path_id:""}:{type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[],stroke_width:.1,pcb_silkscreen_path_id:""}}var Cyt=n=>{let e=Pyt.parse(n),t=Tyt(e),i=kyt[t],r=e.p??i.p,s=e.id??i.id,o=e.pw??i.pw,a=e.pl??i.pl,c=e.w??i.w,l=e.h??i.h,u=t==="sh"?4:2;if(t==="sh"){let x=(typeof n.string=="string"?n.string:"").match(/sh(\d+)/);if(x&&x[1]){let v=parseInt(x[1],10);Number.isNaN(v)||(u=v)}else typeof e.sh=="number"&&(u=e.sh)}let p=Eyt(t,u,r,s,o,a),f=Myt(t,c,l),y=ie(0,l/2+1,.5);return{circuitJson:[...p,f,y],parameters:{...e,p:r,id:s,pw:o,pl:a,w:c,h:l,num_pins:u,sh:t==="sh",ph:t==="ph"}}},Iyt=h.object({fn:h.string(),num_pins:h.literal(2).default(2),w:h.string().default("3.30mm"),h:h.string().default("1.70mm"),pl:h.string().default("0.80mm"),pw:h.string().default("1mm"),p:h.string().default("1.90mm")}),Nyt=n=>{let e=Iyt.parse(n),t=ie(0,D.parse(e.h)/2+.5,.3),i={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:D.parse(e.p)/2,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2,y:-D.parse(e.h)/2},{x:D.parse(e.p)/2,y:-D.parse(e.h)/2}],stroke_width:.1,pcb_silkscreen_path_id:""};return{circuitJson:Ryt(e).concat(i,t),parameters:e}},Ayt=n=>{let{pn:e,p:t}=n;return e===1?{x:-t/2,y:0}:{x:t/2,y:0}},Ryt=n=>{let e=[];for(let t=1;t<=n.num_pins;t++){let{x:i,y:r}=Ayt({pn:t,p:Number.parseFloat(n.p)});e.push(Ut(t,i,r,Number.parseFloat(n.pl),Number.parseFloat(n.pw)))}return e},Oyt=n=>{switch(n){case 8:return{w:"3.06mm",h:"3.14mm",p:"0.65mm",pl:"1.6mm",pw:"0.5mm"};case 10:return{w:"3.10mm",h:"3.33mm",p:"0.5mm",pl:"1.45mm",pw:"0.3mm"};default:return{w:"3.06mm",h:"3.14mm",p:"0.65mm",pl:"1.6mm",pw:"0.5mm"}}},Lyt=h.object({fn:h.string(),num_pins:h.union([h.literal(8),h.literal(10)]).default(8),w:h.string().optional(),h:h.string().optional(),p:h.string().optional(),pl:h.string().optional(),pw:h.string().optional(),string:h.string().optional()}),Fyt=n=>{let e=Lyt.parse(n),t=Oyt(e.num_pins),i=D.parse(e.w||t.w),r=D.parse(e.h||t.h),s=D.parse(e.p||t.p),o=D.parse(e.pl||t.pl),a=D.parse(e.pw||t.pw),c=[],l=e.num_pins/2;for(let w=0;w<e.num_pins;w++){let{x:k,y:T}=lB(e.num_pins,w+1,i,s),I=w<l?w+1:e.num_pins-(w-l);c.push(Ut(I,k,T,o,a))}let u=i,p=r,f={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:-u/2,y:p/2},{x:u/2,y:p/2}],stroke_width:.05,pcb_silkscreen_path_id:""},y={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:-u/2,y:-p/2},{x:u/2,y:-p/2}],stroke_width:.05,pcb_silkscreen_path_id:""},g=lB(e.num_pins,1,u,s),x={x:g.x-.8,y:g.y},v={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"pin_marker_1",route:[{x:x.x-.4,y:x.y},{x:x.x-.7,y:x.y+.3},{x:x.x-.7,y:x.y-.3},{x:x.x-.4,y:x.y}],stroke_width:.05,pcb_silkscreen_path_id:"pin_marker_1"},P=ie(0,p/2+.5,.3);return{circuitJson:[...c,f,y,P,v],parameters:e}},lB=(n,e,t,i)=>{let r=n/2,s=(e-1)%r,o=e<=r?-1:1,a=(r-1)/2-s;return{x:o*D.parse(n===8?"1.8mm":"2.2mm"),y:a*i}},zyt=n=>{switch(n){case 10:return{w:"3.10mm",h:"3.32mm",p:"0.5mm",pl:"1.63mm",pw:"0.33mm"};case 12:return{w:"3mm",h:"4mm",p:"0.65mm",pl:"0.88mm",pw:"0.4mm"};case 16:return{w:"3.10mm",h:"4mm",p:"0.5mm",pl:"0.88mm",pw:"0.3mm"};default:return{w:"3.10mm",h:"3.32mm",p:"0.65mm",pl:"1.63mm",pw:"0.4mm"}}},$yt=h.object({fn:h.string(),num_pins:h.union([h.literal(8),h.literal(10),h.literal(12),h.literal(16)]).default(8),w:h.string().optional(),h:h.string().optional(),p:h.string().optional(),pl:h.string().optional(),pw:h.string().optional(),string:h.string().optional()}),uB=(n,e,t,i)=>{let r=n/2,s=(e-1)%r,o=e<=r?-1:1,a=(r-1)/2-s;return{x:o*D.parse("2mm"),y:a*i}},Dyt=n=>{let e=$yt.parse(n),t=zyt(e.num_pins),i=D.parse(e.w||t.w),r=D.parse(e.h||t.h),s=D.parse(e.p||t.p),o=D.parse(e.pl||t.pl),a=D.parse(e.pw||t.pw),c=[];for(let P=0;P<e.num_pins;P++){let{x:w,y:k}=uB(e.num_pins,P+1,i,s);c.push(Ut(P+1,w,k,o,a))}let l=i,u=r,p={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:-l/2,y:u/2},{x:l/2,y:u/2}],stroke_width:.05,pcb_silkscreen_path_id:""},f={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:-l/2,y:-u/2},{x:l/2,y:-u/2}],stroke_width:.05,pcb_silkscreen_path_id:""},y=uB(e.num_pins,1,l,s),g={x:y.x-.8,y:y.y},x={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"pin_marker_1",route:[{x:g.x-.4,y:g.y},{x:g.x-.7,y:g.y+.3},{x:g.x-.7,y:g.y-.3},{x:g.x-.4,y:g.y}],stroke_width:.05,pcb_silkscreen_path_id:"pin_marker_1"},v=ie(0,u/2+.5,.3);return{circuitJson:[...c,p,f,v,x],parameters:e}},jyt=h.object({fn:h.string(),num_pins:h.literal(2).default(2),w:h.string().default("3.8mm"),h:h.string().default("1.65mm"),pl:h.string().default("1.2mm"),pw:h.string().default("1.2mm"),pad_spacing:h.string().default("2.6mm")}),Byt=n=>{let e=jyt.parse(n),t=ie(0,D.parse(e.h),.3),i={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:D.parse(e.pad_spacing)/2,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2-.2,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2-.2,y:-D.parse(e.h)/2},{x:D.parse(e.pad_spacing)/2,y:-D.parse(e.h)/2}],stroke_width:.1,pcb_silkscreen_path_id:""};return{circuitJson:Xyt(e).concat(i,t),parameters:e}},Yyt=n=>{let{pn:e,pad_spacing:t}=n;return e===1?{x:-t/2,y:0}:{x:t/2,y:0}},Xyt=n=>{let e=[];for(let t=1;t<=n.num_pins;t++){let{x:i,y:r}=Yyt({pn:t,pad_spacing:Number.parseFloat(n.pad_spacing)});e.push(Ut(t,i,r,Number.parseFloat(n.pl),Number.parseFloat(n.pw)))}return e},Uyt=h.object({fn:h.string(),num_pins:h.literal(2).default(2),w:h.string().default("3.20mm"),h:h.string().default("1.65mm"),pl:h.string().default("0.8mm"),pw:h.string().default("0.9mm"),pad_spacing:h.string().default("2.1mm")}),Vyt=n=>{let e=Uyt.parse(n),t=ie(0,D.parse(e.h),.3),i={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:D.parse(e.pad_spacing)/2,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2-.2,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2-.2,y:-D.parse(e.h)/2},{x:D.parse(e.pad_spacing)/2,y:-D.parse(e.h)/2}],stroke_width:.1,pcb_silkscreen_path_id:""};return{circuitJson:Hyt(e).concat(i,t),parameters:e}},Gyt=n=>{let{pn:e,pad_spacing:t}=n;return e===1?{x:-t/2,y:0}:{x:t/2,y:0}},Hyt=n=>{let e=[];for(let t=1;t<=n.num_pins;t++){let{x:i,y:r}=Gyt({pn:t,pad_spacing:Number.parseFloat(n.pad_spacing)});e.push(Ut(t,i,r,Number.parseFloat(n.pl),Number.parseFloat(n.pw)))}return e},Wyt=h.object({fn:h.string(),num_pins:h.union([h.literal(6),h.literal(8)]).default(8),w:h.string().default("3mm"),h:h.string().default("3mm"),p:h.string().default("0.5mm"),pl:h.string().default("0.52mm"),pw:h.string().default("0.35mm"),epw:h.string().default("1.40mm"),eph:h.string().default("1.60mm"),string:h.string().optional(),ep:h.boolean().default(!1)}),qyt=n=>{n.string&&n.string.includes("_ep")&&(n.ep=!0);let e=n.string?.match(/^son_(\d+)/),t=e?Number.parseInt(e[1],10):n.num_pins||8,i=Wyt.parse({...n,num_pins:t}),r=D.parse(i.w),s=D.parse(i.h),o=D.parse(i.p),a=D.parse(i.pl),c=D.parse(i.pw),l=D.parse(i.epw),u=D.parse(i.eph),p=[];for(let T=0;T<i.num_pins;T++){let{x:I,y:E}=pB(i.num_pins,T+1,r,o);p.push(Ut(T+1,I,E,a,c))}i.ep&&p.push(Ut(i.num_pins+1,0,0,l,u));let f=r,y=s,g={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:-f/2,y:y/2},{x:f/2,y:y/2}],stroke_width:.05,pcb_silkscreen_path_id:""},x={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:-f/2,y:-y/2},{x:f/2,y:-y/2}],stroke_width:.05,pcb_silkscreen_path_id:""},v=pB(i.num_pins,1,f,o),P={x:v.x-.4,y:v.y},w={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"pin_marker_1",route:[{x:P.x-.4,y:P.y},{x:P.x-.7,y:P.y+.3},{x:P.x-.7,y:P.y-.3},{x:P.x-.4,y:P.y}],stroke_width:.05,pcb_silkscreen_path_id:"pin_marker_1"},k=ie(0,y/2+.5,.3);return{circuitJson:[...p,g,x,k,w],parameters:i}},pB=(n,e,t,i)=>{let r=n/2,s=(e-1)%r,o=e<=r?-1:1,a=(r-1)/2-s;return{x:o*D.parse("1.4mm"),y:a*i}},Zyt=n=>{let{num_pins:e,bridged:t,p:i=2.54,pw:r=1.5,ph:s=1.5}=n,o=D.parse(i),a=D.parse(r),c=D.parse(s),l=Math.min(c/4,.5),u=[];for(let T=0;T<e;T++)u.push(Ut(T+1,T*o,0,a,c));let p=[];if(t){let T=t.split("").map(Number);if(T.length>1)for(let I=0;I<T.length-1;I++){let E=T[I],N=T[I+1];if(typeof E=="number"&&typeof N=="number"&&!isNaN(E)&&!isNaN(N)){let M=(E-1)*o,A=(N-1)*o,R=Math.sign(A-M),j=M+R*(a/2),B=A-R*(a/2);p.push({type:"pcb_trace",pcb_trace_id:"",route:[{start_pcb_port_id:`{PIN${E}}`,x:j,y:0,width:l,layer:"top",route_type:"wire"},{end_pcb_port_id:`{PIN${N}}`,x:B,y:0,width:l,layer:"top",route_type:"wire"}]})}}}let f=(e-1)*o+a+.7,y=c+1,g=(e-1)*o/2,x=0,v={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",pcb_silkscreen_path_id:"outline",route:[{x:g-f/2,y:x-y/2},{x:g+f/2,y:x-y/2},{x:g+f/2,y:x+y/2},{x:g-f/2,y:x+y/2},{x:g-f/2,y:x-y/2}],stroke_width:.15},w=x+y/2+.6,k=ie(g,w,.4);return{circuitJson:[...u,...p,v,k],parameters:n}},TB={fn:h.literal("sot457"),num_pins:h.literal(6).default(6),pillh:h.string().default("0.45mm"),pillw:h.string().default("1.45mm"),pl:h.string(),pw:h.string(),p:h.string(),wave:h.boolean().optional(),reflow:h.boolean().optional()},Kyt=h.object({...TB,h:h.string().default("2.5mm"),w:h.string().default("2.7mm"),pl:h.string().default("0.8mm"),pw:h.string().default("0.55mm"),p:h.string().default("0.95mm")}),Jyt=h.object({...TB,h:h.string().default("3mm"),w:h.string().default("4mm"),pillr:h.string().default("0.225mm"),pl:h.string().default("1.45mm"),pw:h.string().default("1.5mm"),p:h.string().default("1.475mm")}).transform(n=>({...n,wave:n.wave??(n.reflow===void 0?!0:!n.reflow),reflow:n.reflow??(n.wave===void 0?!1:!n.wave)})),Sa=n=>Number.parseFloat(n.replace("mm","")),hB=({pitch:n,width:e,pinNumber:t})=>{let s={1:{x:-e/2-.1,y:n},2:{x:-e/2-.1,y:0},3:{x:-e/2-.1,y:-n},4:{x:e/2+.1,y:-n},5:{x:e/2+.1,y:0},6:{x:e/2+.1,y:n}}[t];if(!s)throw new Error(`Invalid pin number: ${t}`);return s},dB=n=>{let e=[],t=Sa(n.p),i=Sa(n.pl),r=Sa(n.pw),s=Sa(n.w),o=Sa(n.h);if(n.wave){let g={1:({padWidth:x,padHeight:v})=>Ut(1,-t,t,v,x),2:({padWidth:x,padHeight:v})=>Ut(2,-t,-t,v,x),3:({padWidth:x,padHeight:v})=>tb(3,-t,0,Sa(n.pillw),Sa(n.pillh)),4:({padWidth:x,padHeight:v})=>tb(4,t,0,Sa(n.pillw),Sa(n.pillh)),5:({padWidth:x,padHeight:v})=>Ut(5,t,t,v,x),6:({padWidth:x,padHeight:v})=>Ut(6,t,-t,v,x)};for(let x=1;x<=n.num_pins;x++){let v=g[x];v&&e.push(v({padWidth:i,padHeight:r}))}}else for(let g=1;g<=n.num_pins;g++){let{x,y:v}=hB({pitch:t,width:s,pinNumber:g});e.push(Ut(g,x,v,i,r))}let a={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",pcb_silkscreen_path_id:"silkscreen_path_1",route:[{x:-s/3,y:o/2+t/1.3},{x:s/3,y:o/2+t/1.3}],stroke_width:.05},c={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",pcb_silkscreen_path_id:"silkscreen_path_2",route:[{x:-s/3,y:-o/2-t/1.3},{x:s/3,y:-o/2-t/1.3}],stroke_width:.05},l=ie(0,o+.5,.3),u=hB({pitch:t,width:s,pinNumber:1}),p=n.wave?1:.5,f=n.wave?.7:.3;u.x-=n.wave?r:r*1.7;let y={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",pcb_silkscreen_path_id:"pin1_indicator",route:[{x:u.x+p/2,y:u.y},{x:u.x-p/2,y:u.y+f/2},{x:u.x-p/2,y:u.y-f/2},{x:u.x+p/2,y:u.y}],stroke_width:.05};return[l,a,c,y,...e]},Qyt=n=>{if(n.wave){let t=Jyt.parse({...n,fn:"sot457"});return{circuitJson:dB(t),parameters:t}}let e=Kyt.parse(n);return{circuitJson:dB(e),parameters:e}},tgt=h.object({fn:h.string(),num_pins:h.union([h.literal(3),h.literal(2)]).default(3),p:h.string().default("3.8mm"),id:h.string().default("1.25mm"),od:h.string().default("2.35mm"),ca:h.string().default("14mm").describe("Caliper axis (width or diameter of the potentiometer body or adjustment knob)"),w:h.string().default("5.35mm"),h:h.string().default("4mm"),string:h.string().optional()}),egt=n=>{let{p:e,id:t,od:i,h:r,ca:s}=n,o=Number.parseFloat(r),a=Number.parseFloat(s);return[Te(1,0,a/4+.3,t,i),Te(2,o,0,t,i),Te(3,0,-a/4-.3,t,i)]},ngt=n=>{let e=n.string?.match(/^potentiometer_(\d+)/),t=e?Number.parseInt(e[1],10):3,i=tgt.parse({...n,num_pins:t}),r=[];i.num_pins===3&&(r=egt(i));let s=Number.parseFloat(i.ca)/2+.15,o=Number.parseFloat(i.w),a=Number.parseFloat(i.od)/2+.35,c={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:0,y:s-1.75},{x:0,y:s},{x:o,y:s},{x:o,y:a}],stroke_width:.1,pcb_silkscreen_path_id:""},l={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:o,y:-a},{x:o,y:-s},{x:0,y:-s},{x:0,y:-s+1.75}],stroke_width:.1,pcb_silkscreen_path_id:""},u=Number.parseFloat(i.w)/2,p=ie(u,s+1,.5);return{circuitJson:[...r,c,l,p],parameters:i}},igt=h.object({fn:h.string(),p:D.optional().default("7.5mm"),id:D.optional().default("1mm"),od:D.optional().default("2mm"),d:D.optional().default("10.5mm")}),rgt=(n,e,t,i,r)=>{let s=[],o=[];for(let a=0;a<=50;a++){let c=a/50*Math.PI,l=n+Math.cos(c)*t,u=e+Math.sin(c)*t;l<n-i&&u>=e-r/2&&u<=e+r/2||s.push({x:l,y:u})}for(let a=0;a<=50;a++){let c=Math.PI+a/50*Math.PI,l=n+Math.cos(c)*t,u=e+Math.sin(c)*t;l<n-i&&u>=e-r/2&&u<=e+r/2||o.push({x:l,y:u})}return{topArc:s,bottomArc:o}},sgt=n=>{let e=igt.parse(n),{p:t,id:i,od:r,d:s}=e,o=[Te(1,-t/2,0,i,r),Te(2,t/2,0,i,r)],{topArc:a,bottomArc:c}=rgt(0,0,s/2+.1,r/2,r),l={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:a,stroke_width:.1,pcb_silkscreen_path_id:""},u={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:c,stroke_width:.1,pcb_silkscreen_path_id:""},p={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:0,y:s/2+.1},{x:0,y:-(s/2+.1)}],stroke_width:.1,pcb_silkscreen_path_id:""},f=-(s/2+.5),y=r/2+1.5,g=.5,x={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:f-g,y},{x:f+g,y}],stroke_width:.1,pcb_silkscreen_path_id:""},v={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:f,y:y-g},{x:f,y:y+g}],stroke_width:.1,pcb_silkscreen_path_id:""},P=ie(0,s/2+1,.5);return{circuitJson:[...o,l,u,p,x,v,P],parameters:e}},ogt=h.object({fn:h.string(),num_pins:h.literal(2).default(2),w:h.string().default("6.5mm"),h:h.string().default("3mm"),pl:h.string().default("1.75mm"),pw:h.string().default("2.40mm"),p:h.string().default("4.75mm")}),agt=n=>{let e=ogt.parse(n),t=ie(0,D.parse(e.h)-.5,.3),i={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",route:[{x:D.parse(e.p)/2,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2-.3,y:D.parse(e.h)/2},{x:-D.parse(e.w)/2-.3,y:-D.parse(e.h)/2},{x:D.parse(e.p)/2,y:-D.parse(e.h)/2}],stroke_width:.1,pcb_silkscreen_path_id:""};return{circuitJson:lgt(e).concat(i,t),parameters:e}},cgt=n=>{let{pn:e,p:t}=n;return e===1?{x:-t/2,y:0}:{x:t/2,y:0}},lgt=n=>{let e=[];for(let t=1;t<=n.num_pins;t++){let{x:i,y:r}=cgt({pn:t,p:Number.parseFloat(n.p)});e.push(Ut(t,i,r,Number.parseFloat(n.pl),Number.parseFloat(n.pw)))}return e},ugt=h.object({fn:h.string(),num_pins:h.number().default(3),w:h.string().default("2.45mm"),h:h.string().default("2.40mm"),pl:h.string().default("0.45mm"),pw:h.string().default("0.70mm"),p:h.string().default("1mm"),string:h.string().optional()}),pgt=n=>{let e=n.string?.match(/^sot323_(\d+)/),t=e?Number.parseInt(e[1],3):3,i=ugt.parse({...n,num_pins:t});if(i.num_pins===3)return{circuitJson:dgt(i),parameters:i};throw new Error("Invalid number of pins")},hgt=n=>{let{pn:e,w:t,h:i,pl:r,p:s}=n;return e===1?{x:-s,y:.65}:e===2?{x:-s,y:-.65}:{x:s,y:0}},dgt=n=>{let e=[];for(let a=0;a<n.num_pins;a++){let{x:c,y:l}=hgt({num_pins:n.num_pins,pn:a+1,w:Number.parseFloat(n.w),h:Number.parseFloat(n.h),pl:Number.parseFloat(n.pl),p:Number.parseFloat(n.p)});e.push(Ut(a+1,c,l,Number.parseFloat(n.pl),Number.parseFloat(n.pw)))}let t=ie(0,Number.parseInt(n.h)/2+1,.3),i=Number.parseFloat(n.w)/2-Number.parseFloat(n.pl),r=Number.parseFloat(n.h)/2,s={layer:"top",pcb_component_id:"",pcb_silkscreen_path_id:"silkscreen_path_1",route:[{x:-i,y:r+.3},{x:i,y:r+.3},{x:i,y:r/2}],type:"pcb_silkscreen_path",stroke_width:.1},o={layer:"top",pcb_component_id:"",pcb_silkscreen_path_id:"silkscreen_path_2",route:[{x:-i,y:-r-.3},{x:i,y:-r-.3},{x:i,y:-r/2}],type:"pcb_silkscreen_path",stroke_width:.1};return[...e,s,o,t]},fgt=h.object({fn:h.string(),circle:h.boolean().optional(),rect:h.boolean().optional(),square:h.boolean().optional(),pill:h.boolean().optional(),d:D.optional(),pd:D.optional(),diameter:D.optional(),r:D.optional(),pr:D.optional(),radius:D.optional(),w:D.optional(),pw:D.optional(),width:D.optional(),h:D.optional(),ph:D.optional(),height:D.optional(),s:D.optional(),size:D.optional(),string:h.string().optional()}).transform(n=>{let e="rect";n.circle&&(e="circle"),n.square&&(e="square"),n.rect&&(e="rect"),n.pill&&(e="pill");let t,i,r;return e==="circle"?n.r!==void 0?t=Ge(n.r):n.pr!==void 0?t=Ge(n.pr):n.radius!==void 0?t=Ge(n.radius):n.d!==void 0?t=Ge(n.d)/2:n.pd!==void 0?t=Ge(n.pd)/2:n.diameter!==void 0?t=Ge(n.diameter)/2:t=Ge("1mm")/2:(n.w!==void 0?i=Ge(n.w):n.pw!==void 0?i=Ge(n.pw):n.width!==void 0?i=Ge(n.width):n.s!==void 0?i=Ge(n.s):n.size!==void 0?i=Ge(n.size):i=Ge("1mm"),n.h!==void 0?r=Ge(n.h):n.ph!==void 0?r=Ge(n.ph):n.height!==void 0?r=Ge(n.height):e==="square"||e==="rect"?r=i:r=Ge("1mm")),{fn:n.fn,shape:e,radius:t,width:i,height:r}}),mgt=n=>{let e=fgt.parse(n),{shape:t,radius:i,width:r,height:s}=e,o,a;return t==="circle"?(o=yB(1,{x:0,y:0,radius:i}),a=i+.5):t==="pill"?(o=tb(1,0,0,r,s),a=Math.max(r,s)/2+.5):(o=Ut(1,0,0,r,s),a=s/2+.5),{circuitJson:[o,ie(0,a,.2)],parameters:e}},_gt=h.object({fn:h.string(),d:D.optional(),hd:D.optional(),r:D.optional(),hr:D.optional(),pd:D.optional(),pr:D.optional(),squarepad:h.boolean().optional().default(!1)}).transform(n=>{let e;n.d!==void 0?e=Ge(n.d):n.hd!==void 0?e=Ge(n.hd):n.r!==void 0?e=Ge(n.r)*2:n.hr!==void 0?e=Ge(n.hr)*2:e=Ge("1mm");let t;return n.pd!==void 0?t=Ge(n.pd):n.pr!==void 0?t=Ge(n.pr)*2:t=e*(1.5/1),{fn:n.fn,d:e,pd:t,squarepad:n.squarepad??!1}}),ygt=n=>{let e=_gt.parse(n),{d:t,pd:i,squarepad:r}=e;return{circuitJson:[r?eb(1,0,0,t,i,i):Te(1,0,0,t,i),ie(0,i/2+.5,.2)],parameters:e}},ggt=h.object({fn:h.string(),num_pins:h.literal(6).default(6),h:h.string().default("1.6mm"),pl:h.string().default("1mm"),pw:h.string().default("0.7mm"),p:h.string().default("0.95mm")}),xgt=n=>{let e=ggt.parse(n);return{circuitJson:bgt(e),parameters:e}},fB=n=>{let{p:e,h:t,pn:i}=n;if(i===1)return{x:-t/2-.5,y:e};if(i===2)return{x:-t/2-.5,y:0};if(i===3)return{x:-t/2-.5,y:-e};if(i===4)return{x:t/2+.5,y:-e};if(i===5)return{x:t/2+.5,y:0};if(i===6)return{x:t/2+.5,y:e};throw new Error("Invalid pin number")},bgt=n=>{let e=[];for(let p=1;p<=n.num_pins;p++){let{x:f,y}=fB({h:Number.parseFloat(n.h),p:Number.parseFloat(n.p),pn:p});e.push(Ut(p,f,y,Number.parseFloat(n.pl),Number.parseFloat(n.pw)))}let t=n.num_pins/2*Number.parseFloat(n.p),i=Number.parseFloat(n.h),r={layer:"top",pcb_component_id:"",pcb_silkscreen_path_id:"silkscreen_path_1",route:[{x:-t/3,y:i/2+Number.parseFloat(n.p)/1.3},{x:t/3,y:i/2+Number.parseFloat(n.p)/1.3}],type:"pcb_silkscreen_path",stroke_width:.05},s={layer:"top",pcb_component_id:"",pcb_silkscreen_path_id:"silkscreen_path_2",route:[{x:-t/3,y:-i/2-Number.parseFloat(n.p)/1.3},{x:t/3,y:-i/2-Number.parseFloat(n.p)/1.3}],type:"pcb_silkscreen_path",stroke_width:.05},o=ie(0,i+.3,.3),a=fB({h:Number.parseFloat(n.h),p:Number.parseFloat(n.p),pn:1});a.x=a.x-Number.parseFloat(n.pw)*1.5;let c=.7,l=.3,u={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"",pcb_silkscreen_path_id:"pin1_indicator",route:[{x:a.x+c/2,y:a.y},{x:a.x-c/2,y:a.y+l/2},{x:a.x-c/2,y:a.y-l/2},{x:a.x+c/2,y:a.y}],stroke_width:.05};return[...e,o,r,s,u]},vgt=h.object({fn:h.string()}),Sgt=n=>{let e=vgt.parse(n),t=[],i=.5-.15,r=1.5,s=.5,o=s/2,a=.5,c=75,l=-((c-1)*s)/2;for(let M=0;M<c;M++){let A=M+1;if(A>=24&&A<=31)continue;let R=l-M*o,j=A%2===0,B=r+(j?.25:0),U=.5-B/2,H=Ut(A,U,R,B,i);H.layer=j?"bottom":"top",t.push(H)}let u=46*.0254,p=137*.0254,f=261*.0254,y={type:"pcb_cutout",pcb_cutout_id:"",shape:"rect",center:{x:-p/2+r/2,y:l-f},width:p,height:u},g={x:-.5,y:l},x={type:"pcb_silkscreen_path",layer:"top",pcb_component_id:"pin_marker_1",route:[{x:g.x-.4,y:g.y},{x:g.x-.7,y:g.y+.3},{x:g.x-.7,y:g.y-.3},{x:g.x-.4,y:g.y}],stroke_width:.05,pcb_silkscreen_path_id:"pin_marker_1"},v=1/0,P=-1/0,w=1/0,k=-1/0,T=(M,A,R=0,j=0)=>{v=Math.min(v,M-R/2),P=Math.max(P,M+R/2),w=Math.min(w,A-j/2),k=Math.max(k,A+j/2)};for(let M of t)T(M.x,M.y,M.width,M.height);T(y.center.x,y.center.y,y.width,y.height);for(let M of x.route)T(M.x,M.y);let I=(v+P)/2,E=(w+k)/2,N=M=>{typeof M.x=="number"&&(M.x-=I),typeof M.y=="number"&&(M.y-=E),M.center&&(M.center.x-=I,M.center.y-=E),Array.isArray(M.route)&&(M.route=M.route.map(A=>({x:A.x-I,y:A.y-E})))};for(let M of t)N(M);return N(y),N(x),{circuitJson:[...t,y,x],parameters:e}};function wgt(n){return n!=null}var Pgt=(n,e)=>{if(!e)return n;let t=n.filter(u=>u.type==="pcb_smtpad"||u.type==="pcb_plated_hole"||u.type==="pcb_thtpad");if(t.length===0)return n;let i=1/0,r=-1/0,s=1/0,o=-1/0,a=(u,p,f=0,y=0)=>{let g=u-f/2,x=u+f/2,v=p-y/2,P=p+y/2;i=Math.min(i,g),r=Math.max(r,x),s=Math.min(s,v),o=Math.max(o,P)};for(let u of t)if(u.type==="pcb_smtpad"){let p=u.shape==="circle"?u.radius*2:u.width,f=u.shape==="circle"?u.radius*2:u.height;a(u.x,u.y,p,f)}else if(u.type==="pcb_plated_hole"){let p=u.outer_diameter??u.hole_diameter;a(u.x,u.y,p,p)}else if(u.type==="pcb_thtpad"){let p=u.diameter;a(u.x,u.y,p,p)}let c=0,l=0;switch(e){case"center":c=(i+r)/2,l=(s+o)/2;break;case"bottomleft":c=i,l=s;break;case"bottomcenter":case"centerbottom":c=(i+r)/2,l=s;break;case"topcenter":case"centertop":c=(i+r)/2,l=o;break;case"leftcenter":case"centerleft":c=i,l=(s+o)/2;break;case"rightcenter":case"centerright":c=r,l=(s+o)/2;break;case"pin1":let u=t.find(p=>p.port_hints?.[0]==="1")||t[0];c=u.x,l=u.y;break}if(c===0&&l===0)return n;for(let u of n){if(typeof u.x=="number"&&(u.x-=c),typeof u.y=="number"&&(u.y-=l),u.center&&typeof u.center.x=="number"&&(u.center.x-=c,u.center.y-=l),u.type==="pcb_silkscreen_path")for(let p of u.route)p.x-=c,p.y-=l;u.type==="pcb_silkscreen_text"&&u.anchor_position&&(u.anchor_position.x-=c,u.anchor_position.y-=l)}return n},kgt=n=>{let e=ib(),i=n.replace(/^((?:\d{4}|\d{5}))(?=$|_)/,"res$1").split(/_(?!metric)/).map(r=>{let s=r.match(/([a-z]+)([\(\d\.\+\?].*)?/);if(!s)return null;let[,o,a]=s;return!o||a?.includes("?")?null:{fn:o,v:a}}).filter(wgt);for(let{fn:r,v:s}of i)e=e[r](s);return e.setString(n),e},Tgt=()=>Object.keys(wa);var ib=()=>{let n=new Proxy({},{get:(e,t)=>{if(t==="soup"||t==="circuitJson"){if("fn"in e&&wa[e.fn])return()=>{let{circuitJson:i}=wa[e.fn](e);return Pgt(i,e.origin)};if(!wa[e.fn])throw new Error(`Invalid footprint function, got "${e.fn}"${e.string?`, from string "${e.string}"`:""}`);return()=>{throw new Error(`No function found for footprinter, make sure to specify .dip, .lr, .p, etc. Got "${t}"`)}}if(t==="json"){if(!wa[e.fn])throw new Error(`Invalid footprint function, got "${e.fn}"${e.string?`, from string "${e.string}"`:""}`);return()=>wa[e.fn](e).parameters}return t==="getFootprintNames"?()=>Object.keys(wa):t==="params"?()=>e:t==="setString"?i=>(e.string=i,n):i=>(Object.keys(e).length===0?`${t}${i}`in wa?(e[`${t}${i}`]=!0,e.fn=`${t}${i}`):(e[t]=!0,e.fn=t,t==="res"||t==="cap"?i&&(typeof i=="string"&&i.includes("_metric")?e.metric=i.split("_metric")[0]:e.imperial=i):e.num_pins=Number.isNaN(Number.parseFloat(i))?void 0:Number.parseFloat(i)):!i&&["w","h","p"].includes(t)||(e[t]=i??!0),n)}});return n};ib.string=kgt;ib.getFootprintNames=Tgt;var bE=ib;St();function $e(n,e){return Array.isArray(e)?[n.a*e[0]+n.c*e[1]+n.e,n.b*e[0]+n.d*e[1]+n.f]:{x:n.a*e.x+n.c*e.y+n.e,y:n.b*e.x+n.d*e.y+n.f}}function tr(){return{a:1,c:0,e:0,b:0,d:1,f:0}}function Bh(n){return typeof n>"u"}function Rn(n,e=0){return{a:1,c:0,e:n,b:0,d:1,f:e}}function Yh(...n){n=Array.isArray(n[0])?n[0]:n;let e=(t,i)=>({a:t.a*i.a+t.c*i.b,c:t.a*i.c+t.c*i.d,e:t.a*i.e+t.c*i.f+t.e,b:t.b*i.a+t.d*i.b,d:t.b*i.c+t.d*i.d,f:t.b*i.e+t.d*i.f+t.f});switch(n.length){case 0:throw new Error("no matrices provided");case 1:return n[0];case 2:return e(n[0],n[1]);default:{let[t,i,...r]=n,s=e(t,i);return Yh(s,...r)}}}function _i(...n){return Yh(...n)}var{cos:Egt,sin:Mgt,PI:TWt}=Math;function $c(n,e,t){let i=Egt(n),r=Mgt(n),s={a:i,c:-r,e:0,b:r,d:i,f:0};return Bh(e)||Bh(t)?s:Yh([Rn(e,t),s,Rn(-e,-t)])}function Lm(n,e=void 0,t=void 0,i=void 0){Bh(e)&&(e=n);let r={a:n,c:0,e:0,b:0,d:e,f:0};return Bh(t)||Bh(i)?r:Yh([Rn(t,i),r,Rn(-t,-i)])}var{tan:RWt}=Math;function Cgt(n,e){function t(){this.constructor=n}t.prototype=e.prototype,n.prototype=new t}function rb(n,e,t,i){var r=Error.call(this,n);return Object.setPrototypeOf&&Object.setPrototypeOf(r,rb.prototype),r.expected=e,r.found=t,r.location=i,r.name="SyntaxError",r}Cgt(rb,Error);function vE(n,e,t){return t=t||" ",n.length>e?n:(e-=n.length,t+=t.repeat(e),n+t.slice(0,e))}rb.prototype.format=function(n){var e="Error: "+this.message;if(this.location){var t=null,i;for(i=0;i<n.length;i++)if(n[i].source===this.location.source){t=n[i].text.split(/\r\n|\n|\r/g);break}var r=this.location.start,s=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(r):r,o=this.location.source+":"+s.line+":"+s.column;if(t){var a=this.location.end,c=vE("",s.line.toString().length," "),l=t[r.line-1],u=r.line===a.line?a.column:l.length+1,p=u-r.column||1;e+=`
 --> `+o+`
`+c+` |
`+s.line+" | "+l+`
`+c+" | "+vE("",r.column-1," ")+vE("",p,"^")}else e+=`
 at `+o}return e};rb.buildMessage=function(n,e){var t={literal:function(l){return'"'+r(l.text)+'"'},class:function(l){var u=l.parts.map(function(p){return Array.isArray(p)?s(p[0])+"-"+s(p[1]):s(p)});return"["+(l.inverted?"^":"")+u.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(l){return l.description}};function i(l){return l.charCodeAt(0).toString(16).toUpperCase()}function r(l){return l.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(u){return"\\x0"+i(u)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(u){return"\\x"+i(u)})}function s(l){return l.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(u){return"\\x0"+i(u)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(u){return"\\x"+i(u)})}function o(l){return t[l.type](l)}function a(l){var u=l.map(o),p,f;if(u.sort(),u.length>0){for(p=1,f=1;p<u.length;p++)u[p-1]!==u[p]&&(u[f]=u[p],f++);u.length=f}switch(u.length){case 1:return u[0];case 2:return u[0]+" or "+u[1];default:return u.slice(0,-1).join(", ")+", or "+u[u.length-1]}}function c(l){return l?'"'+r(l)+'"':"end of input"}return"Expected "+a(n)+" but "+c(e)+" found."};function to(n,e=!1,t=!1){e?t?n=_i(n,Lm(-1,-1)):n=_i(n,Lm(1,-1)):t&&(n=_i(n,Lm(-1,1)));let i=n.a,r=n.b,s=n.c,o=n.d,a,c,l;if(i!==0||s!==0){let u=Math.hypot(i,s);a=u,c=(i*o-r*s)/u;let p=Math.acos(i/u);l=s>0?-p:p}else if(r!==0||o!==0){let u=Math.hypot(r,o);a=(i*o-r*s)/u,c=u;let p=Math.acos(r/u);l=Math.PI/2+(o>0?-p:p)}else a=0,c=0,l=0;return t&&(a=-a),e&&(c=-c),{translate:{tx:n.e,ty:n.f},scale:{sx:a,sy:c},rotation:{angle:l}}}function EB(){return{a:-1,c:0,e:0,b:0,d:1,f:0}}var $et=Gt(Mn(),1),Lme=Gt(qs(),1),Det=Gt(GB(),1),Hw=Gt(qB(),1),jet=Gt(Mn(),1);var zme=Gt(Mn(),1);Ta();Q();var K2={};xh(K2,{DocumentPosition:()=>Es,append:()=>NTt,appendChild:()=>ITt,compareDocumentPosition:()=>cG,existsOne:()=>oG,filter:()=>qm,find:()=>sG,findAll:()=>LTt,findOne:()=>W2,findOneChild:()=>OTt,getAttributeValue:()=>PTt,getChildren:()=>iG,getElementById:()=>DTt,getElements:()=>$Tt,getElementsByClassName:()=>jTt,getElementsByTagName:()=>Gh,getElementsByTagType:()=>BTt,getFeed:()=>UTt,getInnerHTML:()=>STt,getName:()=>TTt,getOuterHTML:()=>nG,getParent:()=>rG,getSiblings:()=>wTt,getText:()=>H2,hasAttrib:()=>kTt,hasChildren:()=>fr,innerText:()=>P5,isCDATA:()=>hg,isComment:()=>Y2,isDocument:()=>BV,isTag:()=>er,isText:()=>Ea,nextElementSibling:()=>ETt,prepend:()=>RTt,prependChild:()=>ATt,prevElementSibling:()=>MTt,removeElement:()=>mg,removeSubsets:()=>YTt,replaceElement:()=>CTt,testElement:()=>zTt,textContent:()=>fg,uniqueSort:()=>XTt});var ri;(function(n){n.Root="root",n.Text="text",n.Directive="directive",n.Comment="comment",n.Script="script",n.Style="style",n.Tag="tag",n.CDATA="cdata",n.Doctype="doctype"})(ri||(ri={}));function NV(n){return n.type===ri.Tag||n.type===ri.Script||n.type===ri.Style}var AV=ri.Root,RV=ri.Text,OV=ri.Directive,LV=ri.Comment,FV=ri.Script,zV=ri.Style,$V=ri.Tag,DV=ri.CDATA,jV=ri.Doctype;function er(n){return NV(n)}function hg(n){return n.type===ri.CDATA}function Ea(n){return n.type===ri.Text}function Y2(n){return n.type===ri.Comment}function BV(n){return n.type===ri.Root}function fr(n){return Object.prototype.hasOwnProperty.call(n,"children")}var YV=new Uint16Array('\u1D41<\xD5\u0131\u028A\u049D\u057B\u05D0\u0675\u06DE\u07A2\u07D6\u080F\u0A4A\u0A91\u0DA1\u0E6D\u0F09\u0F26\u10CA\u1228\u12E1\u1415\u149D\u14C3\u14DF\u1525\0\0\0\0\0\0\u156B\u16CD\u198D\u1C12\u1DDD\u1F7E\u2060\u21B0\u228D\u23C0\u23FB\u2442\u2824\u2912\u2D08\u2E48\u2FCE\u3016\u32BA\u3639\u37AC\u38FE\u3A28\u3A71\u3AE0\u3B2E\u0800EMabcfglmnoprstu\\bfms\x7F\x84\x8B\x90\x95\x98\xA6\xB3\xB9\xC8\xCFlig\u803B\xC6\u40C6P\u803B&\u4026cute\u803B\xC1\u40C1reve;\u4102\u0100iyx}rc\u803B\xC2\u40C2;\u4410r;\uC000\u{1D504}rave\u803B\xC0\u40C0pha;\u4391acr;\u4100d;\u6A53\u0100gp\x9D\xA1on;\u4104f;\uC000\u{1D538}plyFunction;\u6061ing\u803B\xC5\u40C5\u0100cs\xBE\xC3r;\uC000\u{1D49C}ign;\u6254ilde\u803B\xC3\u40C3ml\u803B\xC4\u40C4\u0400aceforsu\xE5\xFB\xFE\u0117\u011C\u0122\u0127\u012A\u0100cr\xEA\xF2kslash;\u6216\u0176\xF6\xF8;\u6AE7ed;\u6306y;\u4411\u0180crt\u0105\u010B\u0114ause;\u6235noullis;\u612Ca;\u4392r;\uC000\u{1D505}pf;\uC000\u{1D539}eve;\u42D8c\xF2\u0113mpeq;\u624E\u0700HOacdefhilorsu\u014D\u0151\u0156\u0180\u019E\u01A2\u01B5\u01B7\u01BA\u01DC\u0215\u0273\u0278\u027Ecy;\u4427PY\u803B\xA9\u40A9\u0180cpy\u015D\u0162\u017Aute;\u4106\u0100;i\u0167\u0168\u62D2talDifferentialD;\u6145leys;\u612D\u0200aeio\u0189\u018E\u0194\u0198ron;\u410Cdil\u803B\xC7\u40C7rc;\u4108nint;\u6230ot;\u410A\u0100dn\u01A7\u01ADilla;\u40B8terDot;\u40B7\xF2\u017Fi;\u43A7rcle\u0200DMPT\u01C7\u01CB\u01D1\u01D6ot;\u6299inus;\u6296lus;\u6295imes;\u6297o\u0100cs\u01E2\u01F8kwiseContourIntegral;\u6232eCurly\u0100DQ\u0203\u020FoubleQuote;\u601Duote;\u6019\u0200lnpu\u021E\u0228\u0247\u0255on\u0100;e\u0225\u0226\u6237;\u6A74\u0180git\u022F\u0236\u023Aruent;\u6261nt;\u622FourIntegral;\u622E\u0100fr\u024C\u024E;\u6102oduct;\u6210nterClockwiseContourIntegral;\u6233oss;\u6A2Fcr;\uC000\u{1D49E}p\u0100;C\u0284\u0285\u62D3ap;\u624D\u0580DJSZacefios\u02A0\u02AC\u02B0\u02B4\u02B8\u02CB\u02D7\u02E1\u02E6\u0333\u048D\u0100;o\u0179\u02A5trahd;\u6911cy;\u4402cy;\u4405cy;\u440F\u0180grs\u02BF\u02C4\u02C7ger;\u6021r;\u61A1hv;\u6AE4\u0100ay\u02D0\u02D5ron;\u410E;\u4414l\u0100;t\u02DD\u02DE\u6207a;\u4394r;\uC000\u{1D507}\u0100af\u02EB\u0327\u0100cm\u02F0\u0322ritical\u0200ADGT\u0300\u0306\u0316\u031Ccute;\u40B4o\u0174\u030B\u030D;\u42D9bleAcute;\u42DDrave;\u4060ilde;\u42DCond;\u62C4ferentialD;\u6146\u0470\u033D\0\0\0\u0342\u0354\0\u0405f;\uC000\u{1D53B}\u0180;DE\u0348\u0349\u034D\u40A8ot;\u60DCqual;\u6250ble\u0300CDLRUV\u0363\u0372\u0382\u03CF\u03E2\u03F8ontourIntegra\xEC\u0239o\u0274\u0379\0\0\u037B\xBB\u0349nArrow;\u61D3\u0100eo\u0387\u03A4ft\u0180ART\u0390\u0396\u03A1rrow;\u61D0ightArrow;\u61D4e\xE5\u02CAng\u0100LR\u03AB\u03C4eft\u0100AR\u03B3\u03B9rrow;\u67F8ightArrow;\u67FAightArrow;\u67F9ight\u0100AT\u03D8\u03DErrow;\u61D2ee;\u62A8p\u0241\u03E9\0\0\u03EFrrow;\u61D1ownArrow;\u61D5erticalBar;\u6225n\u0300ABLRTa\u0412\u042A\u0430\u045E\u047F\u037Crrow\u0180;BU\u041D\u041E\u0422\u6193ar;\u6913pArrow;\u61F5reve;\u4311eft\u02D2\u043A\0\u0446\0\u0450ightVector;\u6950eeVector;\u695Eector\u0100;B\u0459\u045A\u61BDar;\u6956ight\u01D4\u0467\0\u0471eeVector;\u695Fector\u0100;B\u047A\u047B\u61C1ar;\u6957ee\u0100;A\u0486\u0487\u62A4rrow;\u61A7\u0100ct\u0492\u0497r;\uC000\u{1D49F}rok;\u4110\u0800NTacdfglmopqstux\u04BD\u04C0\u04C4\u04CB\u04DE\u04E2\u04E7\u04EE\u04F5\u0521\u052F\u0536\u0552\u055D\u0560\u0565G;\u414AH\u803B\xD0\u40D0cute\u803B\xC9\u40C9\u0180aiy\u04D2\u04D7\u04DCron;\u411Arc\u803B\xCA\u40CA;\u442Dot;\u4116r;\uC000\u{1D508}rave\u803B\xC8\u40C8ement;\u6208\u0100ap\u04FA\u04FEcr;\u4112ty\u0253\u0506\0\0\u0512mallSquare;\u65FBerySmallSquare;\u65AB\u0100gp\u0526\u052Aon;\u4118f;\uC000\u{1D53C}silon;\u4395u\u0100ai\u053C\u0549l\u0100;T\u0542\u0543\u6A75ilde;\u6242librium;\u61CC\u0100ci\u0557\u055Ar;\u6130m;\u6A73a;\u4397ml\u803B\xCB\u40CB\u0100ip\u056A\u056Fsts;\u6203onentialE;\u6147\u0280cfios\u0585\u0588\u058D\u05B2\u05CCy;\u4424r;\uC000\u{1D509}lled\u0253\u0597\0\0\u05A3mallSquare;\u65FCerySmallSquare;\u65AA\u0370\u05BA\0\u05BF\0\0\u05C4f;\uC000\u{1D53D}All;\u6200riertrf;\u6131c\xF2\u05CB\u0600JTabcdfgorst\u05E8\u05EC\u05EF\u05FA\u0600\u0612\u0616\u061B\u061D\u0623\u066C\u0672cy;\u4403\u803B>\u403Emma\u0100;d\u05F7\u05F8\u4393;\u43DCreve;\u411E\u0180eiy\u0607\u060C\u0610dil;\u4122rc;\u411C;\u4413ot;\u4120r;\uC000\u{1D50A};\u62D9pf;\uC000\u{1D53E}eater\u0300EFGLST\u0635\u0644\u064E\u0656\u065B\u0666qual\u0100;L\u063E\u063F\u6265ess;\u62DBullEqual;\u6267reater;\u6AA2ess;\u6277lantEqual;\u6A7Eilde;\u6273cr;\uC000\u{1D4A2};\u626B\u0400Aacfiosu\u0685\u068B\u0696\u069B\u069E\u06AA\u06BE\u06CARDcy;\u442A\u0100ct\u0690\u0694ek;\u42C7;\u405Eirc;\u4124r;\u610ClbertSpace;\u610B\u01F0\u06AF\0\u06B2f;\u610DizontalLine;\u6500\u0100ct\u06C3\u06C5\xF2\u06A9rok;\u4126mp\u0144\u06D0\u06D8ownHum\xF0\u012Fqual;\u624F\u0700EJOacdfgmnostu\u06FA\u06FE\u0703\u0707\u070E\u071A\u071E\u0721\u0728\u0744\u0778\u078B\u078F\u0795cy;\u4415lig;\u4132cy;\u4401cute\u803B\xCD\u40CD\u0100iy\u0713\u0718rc\u803B\xCE\u40CE;\u4418ot;\u4130r;\u6111rave\u803B\xCC\u40CC\u0180;ap\u0720\u072F\u073F\u0100cg\u0734\u0737r;\u412AinaryI;\u6148lie\xF3\u03DD\u01F4\u0749\0\u0762\u0100;e\u074D\u074E\u622C\u0100gr\u0753\u0758ral;\u622Bsection;\u62C2isible\u0100CT\u076C\u0772omma;\u6063imes;\u6062\u0180gpt\u077F\u0783\u0788on;\u412Ef;\uC000\u{1D540}a;\u4399cr;\u6110ilde;\u4128\u01EB\u079A\0\u079Ecy;\u4406l\u803B\xCF\u40CF\u0280cfosu\u07AC\u07B7\u07BC\u07C2\u07D0\u0100iy\u07B1\u07B5rc;\u4134;\u4419r;\uC000\u{1D50D}pf;\uC000\u{1D541}\u01E3\u07C7\0\u07CCr;\uC000\u{1D4A5}rcy;\u4408kcy;\u4404\u0380HJacfos\u07E4\u07E8\u07EC\u07F1\u07FD\u0802\u0808cy;\u4425cy;\u440Cppa;\u439A\u0100ey\u07F6\u07FBdil;\u4136;\u441Ar;\uC000\u{1D50E}pf;\uC000\u{1D542}cr;\uC000\u{1D4A6}\u0580JTaceflmost\u0825\u0829\u082C\u0850\u0863\u09B3\u09B8\u09C7\u09CD\u0A37\u0A47cy;\u4409\u803B<\u403C\u0280cmnpr\u0837\u083C\u0841\u0844\u084Dute;\u4139bda;\u439Bg;\u67EAlacetrf;\u6112r;\u619E\u0180aey\u0857\u085C\u0861ron;\u413Ddil;\u413B;\u441B\u0100fs\u0868\u0970t\u0500ACDFRTUVar\u087E\u08A9\u08B1\u08E0\u08E6\u08FC\u092F\u095B\u0390\u096A\u0100nr\u0883\u088FgleBracket;\u67E8row\u0180;BR\u0899\u089A\u089E\u6190ar;\u61E4ightArrow;\u61C6eiling;\u6308o\u01F5\u08B7\0\u08C3bleBracket;\u67E6n\u01D4\u08C8\0\u08D2eeVector;\u6961ector\u0100;B\u08DB\u08DC\u61C3ar;\u6959loor;\u630Aight\u0100AV\u08EF\u08F5rrow;\u6194ector;\u694E\u0100er\u0901\u0917e\u0180;AV\u0909\u090A\u0910\u62A3rrow;\u61A4ector;\u695Aiangle\u0180;BE\u0924\u0925\u0929\u62B2ar;\u69CFqual;\u62B4p\u0180DTV\u0937\u0942\u094CownVector;\u6951eeVector;\u6960ector\u0100;B\u0956\u0957\u61BFar;\u6958ector\u0100;B\u0965\u0966\u61BCar;\u6952ight\xE1\u039Cs\u0300EFGLST\u097E\u098B\u0995\u099D\u09A2\u09ADqualGreater;\u62DAullEqual;\u6266reater;\u6276ess;\u6AA1lantEqual;\u6A7Dilde;\u6272r;\uC000\u{1D50F}\u0100;e\u09BD\u09BE\u62D8ftarrow;\u61DAidot;\u413F\u0180npw\u09D4\u0A16\u0A1Bg\u0200LRlr\u09DE\u09F7\u0A02\u0A10eft\u0100AR\u09E6\u09ECrrow;\u67F5ightArrow;\u67F7ightArrow;\u67F6eft\u0100ar\u03B3\u0A0Aight\xE1\u03BFight\xE1\u03CAf;\uC000\u{1D543}er\u0100LR\u0A22\u0A2CeftArrow;\u6199ightArrow;\u6198\u0180cht\u0A3E\u0A40\u0A42\xF2\u084C;\u61B0rok;\u4141;\u626A\u0400acefiosu\u0A5A\u0A5D\u0A60\u0A77\u0A7C\u0A85\u0A8B\u0A8Ep;\u6905y;\u441C\u0100dl\u0A65\u0A6FiumSpace;\u605Flintrf;\u6133r;\uC000\u{1D510}nusPlus;\u6213pf;\uC000\u{1D544}c\xF2\u0A76;\u439C\u0480Jacefostu\u0AA3\u0AA7\u0AAD\u0AC0\u0B14\u0B19\u0D91\u0D97\u0D9Ecy;\u440Acute;\u4143\u0180aey\u0AB4\u0AB9\u0ABEron;\u4147dil;\u4145;\u441D\u0180gsw\u0AC7\u0AF0\u0B0Eative\u0180MTV\u0AD3\u0ADF\u0AE8ediumSpace;\u600Bhi\u0100cn\u0AE6\u0AD8\xEB\u0AD9eryThi\xEE\u0AD9ted\u0100GL\u0AF8\u0B06reaterGreate\xF2\u0673essLes\xF3\u0A48Line;\u400Ar;\uC000\u{1D511}\u0200Bnpt\u0B22\u0B28\u0B37\u0B3Areak;\u6060BreakingSpace;\u40A0f;\u6115\u0680;CDEGHLNPRSTV\u0B55\u0B56\u0B6A\u0B7C\u0BA1\u0BEB\u0C04\u0C5E\u0C84\u0CA6\u0CD8\u0D61\u0D85\u6AEC\u0100ou\u0B5B\u0B64ngruent;\u6262pCap;\u626DoubleVerticalBar;\u6226\u0180lqx\u0B83\u0B8A\u0B9Bement;\u6209ual\u0100;T\u0B92\u0B93\u6260ilde;\uC000\u2242\u0338ists;\u6204reater\u0380;EFGLST\u0BB6\u0BB7\u0BBD\u0BC9\u0BD3\u0BD8\u0BE5\u626Fqual;\u6271ullEqual;\uC000\u2267\u0338reater;\uC000\u226B\u0338ess;\u6279lantEqual;\uC000\u2A7E\u0338ilde;\u6275ump\u0144\u0BF2\u0BFDownHump;\uC000\u224E\u0338qual;\uC000\u224F\u0338e\u0100fs\u0C0A\u0C27tTriangle\u0180;BE\u0C1A\u0C1B\u0C21\u62EAar;\uC000\u29CF\u0338qual;\u62ECs\u0300;EGLST\u0C35\u0C36\u0C3C\u0C44\u0C4B\u0C58\u626Equal;\u6270reater;\u6278ess;\uC000\u226A\u0338lantEqual;\uC000\u2A7D\u0338ilde;\u6274ested\u0100GL\u0C68\u0C79reaterGreater;\uC000\u2AA2\u0338essLess;\uC000\u2AA1\u0338recedes\u0180;ES\u0C92\u0C93\u0C9B\u6280qual;\uC000\u2AAF\u0338lantEqual;\u62E0\u0100ei\u0CAB\u0CB9verseElement;\u620CghtTriangle\u0180;BE\u0CCB\u0CCC\u0CD2\u62EBar;\uC000\u29D0\u0338qual;\u62ED\u0100qu\u0CDD\u0D0CuareSu\u0100bp\u0CE8\u0CF9set\u0100;E\u0CF0\u0CF3\uC000\u228F\u0338qual;\u62E2erset\u0100;E\u0D03\u0D06\uC000\u2290\u0338qual;\u62E3\u0180bcp\u0D13\u0D24\u0D4Eset\u0100;E\u0D1B\u0D1E\uC000\u2282\u20D2qual;\u6288ceeds\u0200;EST\u0D32\u0D33\u0D3B\u0D46\u6281qual;\uC000\u2AB0\u0338lantEqual;\u62E1ilde;\uC000\u227F\u0338erset\u0100;E\u0D58\u0D5B\uC000\u2283\u20D2qual;\u6289ilde\u0200;EFT\u0D6E\u0D6F\u0D75\u0D7F\u6241qual;\u6244ullEqual;\u6247ilde;\u6249erticalBar;\u6224cr;\uC000\u{1D4A9}ilde\u803B\xD1\u40D1;\u439D\u0700Eacdfgmoprstuv\u0DBD\u0DC2\u0DC9\u0DD5\u0DDB\u0DE0\u0DE7\u0DFC\u0E02\u0E20\u0E22\u0E32\u0E3F\u0E44lig;\u4152cute\u803B\xD3\u40D3\u0100iy\u0DCE\u0DD3rc\u803B\xD4\u40D4;\u441Eblac;\u4150r;\uC000\u{1D512}rave\u803B\xD2\u40D2\u0180aei\u0DEE\u0DF2\u0DF6cr;\u414Cga;\u43A9cron;\u439Fpf;\uC000\u{1D546}enCurly\u0100DQ\u0E0E\u0E1AoubleQuote;\u601Cuote;\u6018;\u6A54\u0100cl\u0E27\u0E2Cr;\uC000\u{1D4AA}ash\u803B\xD8\u40D8i\u016C\u0E37\u0E3Cde\u803B\xD5\u40D5es;\u6A37ml\u803B\xD6\u40D6er\u0100BP\u0E4B\u0E60\u0100ar\u0E50\u0E53r;\u603Eac\u0100ek\u0E5A\u0E5C;\u63DEet;\u63B4arenthesis;\u63DC\u0480acfhilors\u0E7F\u0E87\u0E8A\u0E8F\u0E92\u0E94\u0E9D\u0EB0\u0EFCrtialD;\u6202y;\u441Fr;\uC000\u{1D513}i;\u43A6;\u43A0usMinus;\u40B1\u0100ip\u0EA2\u0EADncareplan\xE5\u069Df;\u6119\u0200;eio\u0EB9\u0EBA\u0EE0\u0EE4\u6ABBcedes\u0200;EST\u0EC8\u0EC9\u0ECF\u0EDA\u627Aqual;\u6AAFlantEqual;\u627Cilde;\u627Eme;\u6033\u0100dp\u0EE9\u0EEEuct;\u620Fortion\u0100;a\u0225\u0EF9l;\u621D\u0100ci\u0F01\u0F06r;\uC000\u{1D4AB};\u43A8\u0200Ufos\u0F11\u0F16\u0F1B\u0F1FOT\u803B"\u4022r;\uC000\u{1D514}pf;\u611Acr;\uC000\u{1D4AC}\u0600BEacefhiorsu\u0F3E\u0F43\u0F47\u0F60\u0F73\u0FA7\u0FAA\u0FAD\u1096\u10A9\u10B4\u10BEarr;\u6910G\u803B\xAE\u40AE\u0180cnr\u0F4E\u0F53\u0F56ute;\u4154g;\u67EBr\u0100;t\u0F5C\u0F5D\u61A0l;\u6916\u0180aey\u0F67\u0F6C\u0F71ron;\u4158dil;\u4156;\u4420\u0100;v\u0F78\u0F79\u611Cerse\u0100EU\u0F82\u0F99\u0100lq\u0F87\u0F8Eement;\u620Builibrium;\u61CBpEquilibrium;\u696Fr\xBB\u0F79o;\u43A1ght\u0400ACDFTUVa\u0FC1\u0FEB\u0FF3\u1022\u1028\u105B\u1087\u03D8\u0100nr\u0FC6\u0FD2gleBracket;\u67E9row\u0180;BL\u0FDC\u0FDD\u0FE1\u6192ar;\u61E5eftArrow;\u61C4eiling;\u6309o\u01F5\u0FF9\0\u1005bleBracket;\u67E7n\u01D4\u100A\0\u1014eeVector;\u695Dector\u0100;B\u101D\u101E\u61C2ar;\u6955loor;\u630B\u0100er\u102D\u1043e\u0180;AV\u1035\u1036\u103C\u62A2rrow;\u61A6ector;\u695Biangle\u0180;BE\u1050\u1051\u1055\u62B3ar;\u69D0qual;\u62B5p\u0180DTV\u1063\u106E\u1078ownVector;\u694FeeVector;\u695Cector\u0100;B\u1082\u1083\u61BEar;\u6954ector\u0100;B\u1091\u1092\u61C0ar;\u6953\u0100pu\u109B\u109Ef;\u611DndImplies;\u6970ightarrow;\u61DB\u0100ch\u10B9\u10BCr;\u611B;\u61B1leDelayed;\u69F4\u0680HOacfhimoqstu\u10E4\u10F1\u10F7\u10FD\u1119\u111E\u1151\u1156\u1161\u1167\u11B5\u11BB\u11BF\u0100Cc\u10E9\u10EEHcy;\u4429y;\u4428FTcy;\u442Ccute;\u415A\u0280;aeiy\u1108\u1109\u110E\u1113\u1117\u6ABCron;\u4160dil;\u415Erc;\u415C;\u4421r;\uC000\u{1D516}ort\u0200DLRU\u112A\u1134\u113E\u1149ownArrow\xBB\u041EeftArrow\xBB\u089AightArrow\xBB\u0FDDpArrow;\u6191gma;\u43A3allCircle;\u6218pf;\uC000\u{1D54A}\u0272\u116D\0\0\u1170t;\u621Aare\u0200;ISU\u117B\u117C\u1189\u11AF\u65A1ntersection;\u6293u\u0100bp\u118F\u119Eset\u0100;E\u1197\u1198\u628Fqual;\u6291erset\u0100;E\u11A8\u11A9\u6290qual;\u6292nion;\u6294cr;\uC000\u{1D4AE}ar;\u62C6\u0200bcmp\u11C8\u11DB\u1209\u120B\u0100;s\u11CD\u11CE\u62D0et\u0100;E\u11CD\u11D5qual;\u6286\u0100ch\u11E0\u1205eeds\u0200;EST\u11ED\u11EE\u11F4\u11FF\u627Bqual;\u6AB0lantEqual;\u627Dilde;\u627FTh\xE1\u0F8C;\u6211\u0180;es\u1212\u1213\u1223\u62D1rset\u0100;E\u121C\u121D\u6283qual;\u6287et\xBB\u1213\u0580HRSacfhiors\u123E\u1244\u1249\u1255\u125E\u1271\u1276\u129F\u12C2\u12C8\u12D1ORN\u803B\xDE\u40DEADE;\u6122\u0100Hc\u124E\u1252cy;\u440By;\u4426\u0100bu\u125A\u125C;\u4009;\u43A4\u0180aey\u1265\u126A\u126Fron;\u4164dil;\u4162;\u4422r;\uC000\u{1D517}\u0100ei\u127B\u1289\u01F2\u1280\0\u1287efore;\u6234a;\u4398\u0100cn\u128E\u1298kSpace;\uC000\u205F\u200ASpace;\u6009lde\u0200;EFT\u12AB\u12AC\u12B2\u12BC\u623Cqual;\u6243ullEqual;\u6245ilde;\u6248pf;\uC000\u{1D54B}ipleDot;\u60DB\u0100ct\u12D6\u12DBr;\uC000\u{1D4AF}rok;\u4166\u0AE1\u12F7\u130E\u131A\u1326\0\u132C\u1331\0\0\0\0\0\u1338\u133D\u1377\u1385\0\u13FF\u1404\u140A\u1410\u0100cr\u12FB\u1301ute\u803B\xDA\u40DAr\u0100;o\u1307\u1308\u619Fcir;\u6949r\u01E3\u1313\0\u1316y;\u440Eve;\u416C\u0100iy\u131E\u1323rc\u803B\xDB\u40DB;\u4423blac;\u4170r;\uC000\u{1D518}rave\u803B\xD9\u40D9acr;\u416A\u0100di\u1341\u1369er\u0100BP\u1348\u135D\u0100ar\u134D\u1350r;\u405Fac\u0100ek\u1357\u1359;\u63DFet;\u63B5arenthesis;\u63DDon\u0100;P\u1370\u1371\u62C3lus;\u628E\u0100gp\u137B\u137Fon;\u4172f;\uC000\u{1D54C}\u0400ADETadps\u1395\u13AE\u13B8\u13C4\u03E8\u13D2\u13D7\u13F3rrow\u0180;BD\u1150\u13A0\u13A4ar;\u6912ownArrow;\u61C5ownArrow;\u6195quilibrium;\u696Eee\u0100;A\u13CB\u13CC\u62A5rrow;\u61A5own\xE1\u03F3er\u0100LR\u13DE\u13E8eftArrow;\u6196ightArrow;\u6197i\u0100;l\u13F9\u13FA\u43D2on;\u43A5ing;\u416Ecr;\uC000\u{1D4B0}ilde;\u4168ml\u803B\xDC\u40DC\u0480Dbcdefosv\u1427\u142C\u1430\u1433\u143E\u1485\u148A\u1490\u1496ash;\u62ABar;\u6AEBy;\u4412ash\u0100;l\u143B\u143C\u62A9;\u6AE6\u0100er\u1443\u1445;\u62C1\u0180bty\u144C\u1450\u147Aar;\u6016\u0100;i\u144F\u1455cal\u0200BLST\u1461\u1465\u146A\u1474ar;\u6223ine;\u407Ceparator;\u6758ilde;\u6240ThinSpace;\u600Ar;\uC000\u{1D519}pf;\uC000\u{1D54D}cr;\uC000\u{1D4B1}dash;\u62AA\u0280cefos\u14A7\u14AC\u14B1\u14B6\u14BCirc;\u4174dge;\u62C0r;\uC000\u{1D51A}pf;\uC000\u{1D54E}cr;\uC000\u{1D4B2}\u0200fios\u14CB\u14D0\u14D2\u14D8r;\uC000\u{1D51B};\u439Epf;\uC000\u{1D54F}cr;\uC000\u{1D4B3}\u0480AIUacfosu\u14F1\u14F5\u14F9\u14FD\u1504\u150F\u1514\u151A\u1520cy;\u442Fcy;\u4407cy;\u442Ecute\u803B\xDD\u40DD\u0100iy\u1509\u150Drc;\u4176;\u442Br;\uC000\u{1D51C}pf;\uC000\u{1D550}cr;\uC000\u{1D4B4}ml;\u4178\u0400Hacdefos\u1535\u1539\u153F\u154B\u154F\u155D\u1560\u1564cy;\u4416cute;\u4179\u0100ay\u1544\u1549ron;\u417D;\u4417ot;\u417B\u01F2\u1554\0\u155BoWidt\xE8\u0AD9a;\u4396r;\u6128pf;\u6124cr;\uC000\u{1D4B5}\u0BE1\u1583\u158A\u1590\0\u15B0\u15B6\u15BF\0\0\0\0\u15C6\u15DB\u15EB\u165F\u166D\0\u1695\u169B\u16B2\u16B9\0\u16BEcute\u803B\xE1\u40E1reve;\u4103\u0300;Ediuy\u159C\u159D\u15A1\u15A3\u15A8\u15AD\u623E;\uC000\u223E\u0333;\u623Frc\u803B\xE2\u40E2te\u80BB\xB4\u0306;\u4430lig\u803B\xE6\u40E6\u0100;r\xB2\u15BA;\uC000\u{1D51E}rave\u803B\xE0\u40E0\u0100ep\u15CA\u15D6\u0100fp\u15CF\u15D4sym;\u6135\xE8\u15D3ha;\u43B1\u0100ap\u15DFc\u0100cl\u15E4\u15E7r;\u4101g;\u6A3F\u0264\u15F0\0\0\u160A\u0280;adsv\u15FA\u15FB\u15FF\u1601\u1607\u6227nd;\u6A55;\u6A5Clope;\u6A58;\u6A5A\u0380;elmrsz\u1618\u1619\u161B\u161E\u163F\u164F\u1659\u6220;\u69A4e\xBB\u1619sd\u0100;a\u1625\u1626\u6221\u0461\u1630\u1632\u1634\u1636\u1638\u163A\u163C\u163E;\u69A8;\u69A9;\u69AA;\u69AB;\u69AC;\u69AD;\u69AE;\u69AFt\u0100;v\u1645\u1646\u621Fb\u0100;d\u164C\u164D\u62BE;\u699D\u0100pt\u1654\u1657h;\u6222\xBB\xB9arr;\u637C\u0100gp\u1663\u1667on;\u4105f;\uC000\u{1D552}\u0380;Eaeiop\u12C1\u167B\u167D\u1682\u1684\u1687\u168A;\u6A70cir;\u6A6F;\u624Ad;\u624Bs;\u4027rox\u0100;e\u12C1\u1692\xF1\u1683ing\u803B\xE5\u40E5\u0180cty\u16A1\u16A6\u16A8r;\uC000\u{1D4B6};\u402Amp\u0100;e\u12C1\u16AF\xF1\u0288ilde\u803B\xE3\u40E3ml\u803B\xE4\u40E4\u0100ci\u16C2\u16C8onin\xF4\u0272nt;\u6A11\u0800Nabcdefiklnoprsu\u16ED\u16F1\u1730\u173C\u1743\u1748\u1778\u177D\u17E0\u17E6\u1839\u1850\u170D\u193D\u1948\u1970ot;\u6AED\u0100cr\u16F6\u171Ek\u0200ceps\u1700\u1705\u170D\u1713ong;\u624Cpsilon;\u43F6rime;\u6035im\u0100;e\u171A\u171B\u623Dq;\u62CD\u0176\u1722\u1726ee;\u62BDed\u0100;g\u172C\u172D\u6305e\xBB\u172Drk\u0100;t\u135C\u1737brk;\u63B6\u0100oy\u1701\u1741;\u4431quo;\u601E\u0280cmprt\u1753\u175B\u1761\u1764\u1768aus\u0100;e\u010A\u0109ptyv;\u69B0s\xE9\u170Cno\xF5\u0113\u0180ahw\u176F\u1771\u1773;\u43B2;\u6136een;\u626Cr;\uC000\u{1D51F}g\u0380costuvw\u178D\u179D\u17B3\u17C1\u17D5\u17DB\u17DE\u0180aiu\u1794\u1796\u179A\xF0\u0760rc;\u65EFp\xBB\u1371\u0180dpt\u17A4\u17A8\u17ADot;\u6A00lus;\u6A01imes;\u6A02\u0271\u17B9\0\0\u17BEcup;\u6A06ar;\u6605riangle\u0100du\u17CD\u17D2own;\u65BDp;\u65B3plus;\u6A04e\xE5\u1444\xE5\u14ADarow;\u690D\u0180ako\u17ED\u1826\u1835\u0100cn\u17F2\u1823k\u0180lst\u17FA\u05AB\u1802ozenge;\u69EBriangle\u0200;dlr\u1812\u1813\u1818\u181D\u65B4own;\u65BEeft;\u65C2ight;\u65B8k;\u6423\u01B1\u182B\0\u1833\u01B2\u182F\0\u1831;\u6592;\u65914;\u6593ck;\u6588\u0100eo\u183E\u184D\u0100;q\u1843\u1846\uC000=\u20E5uiv;\uC000\u2261\u20E5t;\u6310\u0200ptwx\u1859\u185E\u1867\u186Cf;\uC000\u{1D553}\u0100;t\u13CB\u1863om\xBB\u13CCtie;\u62C8\u0600DHUVbdhmptuv\u1885\u1896\u18AA\u18BB\u18D7\u18DB\u18EC\u18FF\u1905\u190A\u1910\u1921\u0200LRlr\u188E\u1890\u1892\u1894;\u6557;\u6554;\u6556;\u6553\u0280;DUdu\u18A1\u18A2\u18A4\u18A6\u18A8\u6550;\u6566;\u6569;\u6564;\u6567\u0200LRlr\u18B3\u18B5\u18B7\u18B9;\u655D;\u655A;\u655C;\u6559\u0380;HLRhlr\u18CA\u18CB\u18CD\u18CF\u18D1\u18D3\u18D5\u6551;\u656C;\u6563;\u6560;\u656B;\u6562;\u655Fox;\u69C9\u0200LRlr\u18E4\u18E6\u18E8\u18EA;\u6555;\u6552;\u6510;\u650C\u0280;DUdu\u06BD\u18F7\u18F9\u18FB\u18FD;\u6565;\u6568;\u652C;\u6534inus;\u629Flus;\u629Eimes;\u62A0\u0200LRlr\u1919\u191B\u191D\u191F;\u655B;\u6558;\u6518;\u6514\u0380;HLRhlr\u1930\u1931\u1933\u1935\u1937\u1939\u193B\u6502;\u656A;\u6561;\u655E;\u653C;\u6524;\u651C\u0100ev\u0123\u1942bar\u803B\xA6\u40A6\u0200ceio\u1951\u1956\u195A\u1960r;\uC000\u{1D4B7}mi;\u604Fm\u0100;e\u171A\u171Cl\u0180;bh\u1968\u1969\u196B\u405C;\u69C5sub;\u67C8\u016C\u1974\u197El\u0100;e\u1979\u197A\u6022t\xBB\u197Ap\u0180;Ee\u012F\u1985\u1987;\u6AAE\u0100;q\u06DC\u06DB\u0CE1\u19A7\0\u19E8\u1A11\u1A15\u1A32\0\u1A37\u1A50\0\0\u1AB4\0\0\u1AC1\0\0\u1B21\u1B2E\u1B4D\u1B52\0\u1BFD\0\u1C0C\u0180cpr\u19AD\u19B2\u19DDute;\u4107\u0300;abcds\u19BF\u19C0\u19C4\u19CA\u19D5\u19D9\u6229nd;\u6A44rcup;\u6A49\u0100au\u19CF\u19D2p;\u6A4Bp;\u6A47ot;\u6A40;\uC000\u2229\uFE00\u0100eo\u19E2\u19E5t;\u6041\xEE\u0693\u0200aeiu\u19F0\u19FB\u1A01\u1A05\u01F0\u19F5\0\u19F8s;\u6A4Don;\u410Ddil\u803B\xE7\u40E7rc;\u4109ps\u0100;s\u1A0C\u1A0D\u6A4Cm;\u6A50ot;\u410B\u0180dmn\u1A1B\u1A20\u1A26il\u80BB\xB8\u01ADptyv;\u69B2t\u8100\xA2;e\u1A2D\u1A2E\u40A2r\xE4\u01B2r;\uC000\u{1D520}\u0180cei\u1A3D\u1A40\u1A4Dy;\u4447ck\u0100;m\u1A47\u1A48\u6713ark\xBB\u1A48;\u43C7r\u0380;Ecefms\u1A5F\u1A60\u1A62\u1A6B\u1AA4\u1AAA\u1AAE\u65CB;\u69C3\u0180;el\u1A69\u1A6A\u1A6D\u42C6q;\u6257e\u0261\u1A74\0\0\u1A88rrow\u0100lr\u1A7C\u1A81eft;\u61BAight;\u61BB\u0280RSacd\u1A92\u1A94\u1A96\u1A9A\u1A9F\xBB\u0F47;\u64C8st;\u629Birc;\u629Aash;\u629Dnint;\u6A10id;\u6AEFcir;\u69C2ubs\u0100;u\u1ABB\u1ABC\u6663it\xBB\u1ABC\u02EC\u1AC7\u1AD4\u1AFA\0\u1B0Aon\u0100;e\u1ACD\u1ACE\u403A\u0100;q\xC7\xC6\u026D\u1AD9\0\0\u1AE2a\u0100;t\u1ADE\u1ADF\u402C;\u4040\u0180;fl\u1AE8\u1AE9\u1AEB\u6201\xEE\u1160e\u0100mx\u1AF1\u1AF6ent\xBB\u1AE9e\xF3\u024D\u01E7\u1AFE\0\u1B07\u0100;d\u12BB\u1B02ot;\u6A6Dn\xF4\u0246\u0180fry\u1B10\u1B14\u1B17;\uC000\u{1D554}o\xE4\u0254\u8100\xA9;s\u0155\u1B1Dr;\u6117\u0100ao\u1B25\u1B29rr;\u61B5ss;\u6717\u0100cu\u1B32\u1B37r;\uC000\u{1D4B8}\u0100bp\u1B3C\u1B44\u0100;e\u1B41\u1B42\u6ACF;\u6AD1\u0100;e\u1B49\u1B4A\u6AD0;\u6AD2dot;\u62EF\u0380delprvw\u1B60\u1B6C\u1B77\u1B82\u1BAC\u1BD4\u1BF9arr\u0100lr\u1B68\u1B6A;\u6938;\u6935\u0270\u1B72\0\0\u1B75r;\u62DEc;\u62DFarr\u0100;p\u1B7F\u1B80\u61B6;\u693D\u0300;bcdos\u1B8F\u1B90\u1B96\u1BA1\u1BA5\u1BA8\u622Arcap;\u6A48\u0100au\u1B9B\u1B9Ep;\u6A46p;\u6A4Aot;\u628Dr;\u6A45;\uC000\u222A\uFE00\u0200alrv\u1BB5\u1BBF\u1BDE\u1BE3rr\u0100;m\u1BBC\u1BBD\u61B7;\u693Cy\u0180evw\u1BC7\u1BD4\u1BD8q\u0270\u1BCE\0\0\u1BD2re\xE3\u1B73u\xE3\u1B75ee;\u62CEedge;\u62CFen\u803B\xA4\u40A4earrow\u0100lr\u1BEE\u1BF3eft\xBB\u1B80ight\xBB\u1BBDe\xE4\u1BDD\u0100ci\u1C01\u1C07onin\xF4\u01F7nt;\u6231lcty;\u632D\u0980AHabcdefhijlorstuwz\u1C38\u1C3B\u1C3F\u1C5D\u1C69\u1C75\u1C8A\u1C9E\u1CAC\u1CB7\u1CFB\u1CFF\u1D0D\u1D7B\u1D91\u1DAB\u1DBB\u1DC6\u1DCDr\xF2\u0381ar;\u6965\u0200glrs\u1C48\u1C4D\u1C52\u1C54ger;\u6020eth;\u6138\xF2\u1133h\u0100;v\u1C5A\u1C5B\u6010\xBB\u090A\u016B\u1C61\u1C67arow;\u690Fa\xE3\u0315\u0100ay\u1C6E\u1C73ron;\u410F;\u4434\u0180;ao\u0332\u1C7C\u1C84\u0100gr\u02BF\u1C81r;\u61CAtseq;\u6A77\u0180glm\u1C91\u1C94\u1C98\u803B\xB0\u40B0ta;\u43B4ptyv;\u69B1\u0100ir\u1CA3\u1CA8sht;\u697F;\uC000\u{1D521}ar\u0100lr\u1CB3\u1CB5\xBB\u08DC\xBB\u101E\u0280aegsv\u1CC2\u0378\u1CD6\u1CDC\u1CE0m\u0180;os\u0326\u1CCA\u1CD4nd\u0100;s\u0326\u1CD1uit;\u6666amma;\u43DDin;\u62F2\u0180;io\u1CE7\u1CE8\u1CF8\u40F7de\u8100\xF7;o\u1CE7\u1CF0ntimes;\u62C7n\xF8\u1CF7cy;\u4452c\u026F\u1D06\0\0\u1D0Arn;\u631Eop;\u630D\u0280lptuw\u1D18\u1D1D\u1D22\u1D49\u1D55lar;\u4024f;\uC000\u{1D555}\u0280;emps\u030B\u1D2D\u1D37\u1D3D\u1D42q\u0100;d\u0352\u1D33ot;\u6251inus;\u6238lus;\u6214quare;\u62A1blebarwedg\xE5\xFAn\u0180adh\u112E\u1D5D\u1D67ownarrow\xF3\u1C83arpoon\u0100lr\u1D72\u1D76ef\xF4\u1CB4igh\xF4\u1CB6\u0162\u1D7F\u1D85karo\xF7\u0F42\u026F\u1D8A\0\0\u1D8Ern;\u631Fop;\u630C\u0180cot\u1D98\u1DA3\u1DA6\u0100ry\u1D9D\u1DA1;\uC000\u{1D4B9};\u4455l;\u69F6rok;\u4111\u0100dr\u1DB0\u1DB4ot;\u62F1i\u0100;f\u1DBA\u1816\u65BF\u0100ah\u1DC0\u1DC3r\xF2\u0429a\xF2\u0FA6angle;\u69A6\u0100ci\u1DD2\u1DD5y;\u445Fgrarr;\u67FF\u0900Dacdefglmnopqrstux\u1E01\u1E09\u1E19\u1E38\u0578\u1E3C\u1E49\u1E61\u1E7E\u1EA5\u1EAF\u1EBD\u1EE1\u1F2A\u1F37\u1F44\u1F4E\u1F5A\u0100Do\u1E06\u1D34o\xF4\u1C89\u0100cs\u1E0E\u1E14ute\u803B\xE9\u40E9ter;\u6A6E\u0200aioy\u1E22\u1E27\u1E31\u1E36ron;\u411Br\u0100;c\u1E2D\u1E2E\u6256\u803B\xEA\u40EAlon;\u6255;\u444Dot;\u4117\u0100Dr\u1E41\u1E45ot;\u6252;\uC000\u{1D522}\u0180;rs\u1E50\u1E51\u1E57\u6A9Aave\u803B\xE8\u40E8\u0100;d\u1E5C\u1E5D\u6A96ot;\u6A98\u0200;ils\u1E6A\u1E6B\u1E72\u1E74\u6A99nters;\u63E7;\u6113\u0100;d\u1E79\u1E7A\u6A95ot;\u6A97\u0180aps\u1E85\u1E89\u1E97cr;\u4113ty\u0180;sv\u1E92\u1E93\u1E95\u6205et\xBB\u1E93p\u01001;\u1E9D\u1EA4\u0133\u1EA1\u1EA3;\u6004;\u6005\u6003\u0100gs\u1EAA\u1EAC;\u414Bp;\u6002\u0100gp\u1EB4\u1EB8on;\u4119f;\uC000\u{1D556}\u0180als\u1EC4\u1ECE\u1ED2r\u0100;s\u1ECA\u1ECB\u62D5l;\u69E3us;\u6A71i\u0180;lv\u1EDA\u1EDB\u1EDF\u43B5on\xBB\u1EDB;\u43F5\u0200csuv\u1EEA\u1EF3\u1F0B\u1F23\u0100io\u1EEF\u1E31rc\xBB\u1E2E\u0269\u1EF9\0\0\u1EFB\xED\u0548ant\u0100gl\u1F02\u1F06tr\xBB\u1E5Dess\xBB\u1E7A\u0180aei\u1F12\u1F16\u1F1Als;\u403Dst;\u625Fv\u0100;D\u0235\u1F20D;\u6A78parsl;\u69E5\u0100Da\u1F2F\u1F33ot;\u6253rr;\u6971\u0180cdi\u1F3E\u1F41\u1EF8r;\u612Fo\xF4\u0352\u0100ah\u1F49\u1F4B;\u43B7\u803B\xF0\u40F0\u0100mr\u1F53\u1F57l\u803B\xEB\u40EBo;\u60AC\u0180cip\u1F61\u1F64\u1F67l;\u4021s\xF4\u056E\u0100eo\u1F6C\u1F74ctatio\xEE\u0559nential\xE5\u0579\u09E1\u1F92\0\u1F9E\0\u1FA1\u1FA7\0\0\u1FC6\u1FCC\0\u1FD3\0\u1FE6\u1FEA\u2000\0\u2008\u205Allingdotse\xF1\u1E44y;\u4444male;\u6640\u0180ilr\u1FAD\u1FB3\u1FC1lig;\u8000\uFB03\u0269\u1FB9\0\0\u1FBDg;\u8000\uFB00ig;\u8000\uFB04;\uC000\u{1D523}lig;\u8000\uFB01lig;\uC000fj\u0180alt\u1FD9\u1FDC\u1FE1t;\u666Dig;\u8000\uFB02ns;\u65B1of;\u4192\u01F0\u1FEE\0\u1FF3f;\uC000\u{1D557}\u0100ak\u05BF\u1FF7\u0100;v\u1FFC\u1FFD\u62D4;\u6AD9artint;\u6A0D\u0100ao\u200C\u2055\u0100cs\u2011\u2052\u03B1\u201A\u2030\u2038\u2045\u2048\0\u2050\u03B2\u2022\u2025\u2027\u202A\u202C\0\u202E\u803B\xBD\u40BD;\u6153\u803B\xBC\u40BC;\u6155;\u6159;\u615B\u01B3\u2034\0\u2036;\u6154;\u6156\u02B4\u203E\u2041\0\0\u2043\u803B\xBE\u40BE;\u6157;\u615C5;\u6158\u01B6\u204C\0\u204E;\u615A;\u615D8;\u615El;\u6044wn;\u6322cr;\uC000\u{1D4BB}\u0880Eabcdefgijlnorstv\u2082\u2089\u209F\u20A5\u20B0\u20B4\u20F0\u20F5\u20FA\u20FF\u2103\u2112\u2138\u0317\u213E\u2152\u219E\u0100;l\u064D\u2087;\u6A8C\u0180cmp\u2090\u2095\u209Dute;\u41F5ma\u0100;d\u209C\u1CDA\u43B3;\u6A86reve;\u411F\u0100iy\u20AA\u20AErc;\u411D;\u4433ot;\u4121\u0200;lqs\u063E\u0642\u20BD\u20C9\u0180;qs\u063E\u064C\u20C4lan\xF4\u0665\u0200;cdl\u0665\u20D2\u20D5\u20E5c;\u6AA9ot\u0100;o\u20DC\u20DD\u6A80\u0100;l\u20E2\u20E3\u6A82;\u6A84\u0100;e\u20EA\u20ED\uC000\u22DB\uFE00s;\u6A94r;\uC000\u{1D524}\u0100;g\u0673\u061Bmel;\u6137cy;\u4453\u0200;Eaj\u065A\u210C\u210E\u2110;\u6A92;\u6AA5;\u6AA4\u0200Eaes\u211B\u211D\u2129\u2134;\u6269p\u0100;p\u2123\u2124\u6A8Arox\xBB\u2124\u0100;q\u212E\u212F\u6A88\u0100;q\u212E\u211Bim;\u62E7pf;\uC000\u{1D558}\u0100ci\u2143\u2146r;\u610Am\u0180;el\u066B\u214E\u2150;\u6A8E;\u6A90\u8300>;cdlqr\u05EE\u2160\u216A\u216E\u2173\u2179\u0100ci\u2165\u2167;\u6AA7r;\u6A7Aot;\u62D7Par;\u6995uest;\u6A7C\u0280adels\u2184\u216A\u2190\u0656\u219B\u01F0\u2189\0\u218Epro\xF8\u209Er;\u6978q\u0100lq\u063F\u2196les\xF3\u2088i\xED\u066B\u0100en\u21A3\u21ADrtneqq;\uC000\u2269\uFE00\xC5\u21AA\u0500Aabcefkosy\u21C4\u21C7\u21F1\u21F5\u21FA\u2218\u221D\u222F\u2268\u227Dr\xF2\u03A0\u0200ilmr\u21D0\u21D4\u21D7\u21DBrs\xF0\u1484f\xBB\u2024il\xF4\u06A9\u0100dr\u21E0\u21E4cy;\u444A\u0180;cw\u08F4\u21EB\u21EFir;\u6948;\u61ADar;\u610Firc;\u4125\u0180alr\u2201\u220E\u2213rts\u0100;u\u2209\u220A\u6665it\xBB\u220Alip;\u6026con;\u62B9r;\uC000\u{1D525}s\u0100ew\u2223\u2229arow;\u6925arow;\u6926\u0280amopr\u223A\u223E\u2243\u225E\u2263rr;\u61FFtht;\u623Bk\u0100lr\u2249\u2253eftarrow;\u61A9ightarrow;\u61AAf;\uC000\u{1D559}bar;\u6015\u0180clt\u226F\u2274\u2278r;\uC000\u{1D4BD}as\xE8\u21F4rok;\u4127\u0100bp\u2282\u2287ull;\u6043hen\xBB\u1C5B\u0AE1\u22A3\0\u22AA\0\u22B8\u22C5\u22CE\0\u22D5\u22F3\0\0\u22F8\u2322\u2367\u2362\u237F\0\u2386\u23AA\u23B4cute\u803B\xED\u40ED\u0180;iy\u0771\u22B0\u22B5rc\u803B\xEE\u40EE;\u4438\u0100cx\u22BC\u22BFy;\u4435cl\u803B\xA1\u40A1\u0100fr\u039F\u22C9;\uC000\u{1D526}rave\u803B\xEC\u40EC\u0200;ino\u073E\u22DD\u22E9\u22EE\u0100in\u22E2\u22E6nt;\u6A0Ct;\u622Dfin;\u69DCta;\u6129lig;\u4133\u0180aop\u22FE\u231A\u231D\u0180cgt\u2305\u2308\u2317r;\u412B\u0180elp\u071F\u230F\u2313in\xE5\u078Ear\xF4\u0720h;\u4131f;\u62B7ed;\u41B5\u0280;cfot\u04F4\u232C\u2331\u233D\u2341are;\u6105in\u0100;t\u2338\u2339\u621Eie;\u69DDdo\xF4\u2319\u0280;celp\u0757\u234C\u2350\u235B\u2361al;\u62BA\u0100gr\u2355\u2359er\xF3\u1563\xE3\u234Darhk;\u6A17rod;\u6A3C\u0200cgpt\u236F\u2372\u2376\u237By;\u4451on;\u412Ff;\uC000\u{1D55A}a;\u43B9uest\u803B\xBF\u40BF\u0100ci\u238A\u238Fr;\uC000\u{1D4BE}n\u0280;Edsv\u04F4\u239B\u239D\u23A1\u04F3;\u62F9ot;\u62F5\u0100;v\u23A6\u23A7\u62F4;\u62F3\u0100;i\u0777\u23AElde;\u4129\u01EB\u23B8\0\u23BCcy;\u4456l\u803B\xEF\u40EF\u0300cfmosu\u23CC\u23D7\u23DC\u23E1\u23E7\u23F5\u0100iy\u23D1\u23D5rc;\u4135;\u4439r;\uC000\u{1D527}ath;\u4237pf;\uC000\u{1D55B}\u01E3\u23EC\0\u23F1r;\uC000\u{1D4BF}rcy;\u4458kcy;\u4454\u0400acfghjos\u240B\u2416\u2422\u2427\u242D\u2431\u2435\u243Bppa\u0100;v\u2413\u2414\u43BA;\u43F0\u0100ey\u241B\u2420dil;\u4137;\u443Ar;\uC000\u{1D528}reen;\u4138cy;\u4445cy;\u445Cpf;\uC000\u{1D55C}cr;\uC000\u{1D4C0}\u0B80ABEHabcdefghjlmnoprstuv\u2470\u2481\u2486\u248D\u2491\u250E\u253D\u255A\u2580\u264E\u265E\u2665\u2679\u267D\u269A\u26B2\u26D8\u275D\u2768\u278B\u27C0\u2801\u2812\u0180art\u2477\u247A\u247Cr\xF2\u09C6\xF2\u0395ail;\u691Barr;\u690E\u0100;g\u0994\u248B;\u6A8Bar;\u6962\u0963\u24A5\0\u24AA\0\u24B1\0\0\0\0\0\u24B5\u24BA\0\u24C6\u24C8\u24CD\0\u24F9ute;\u413Amptyv;\u69B4ra\xEE\u084Cbda;\u43BBg\u0180;dl\u088E\u24C1\u24C3;\u6991\xE5\u088E;\u6A85uo\u803B\xAB\u40ABr\u0400;bfhlpst\u0899\u24DE\u24E6\u24E9\u24EB\u24EE\u24F1\u24F5\u0100;f\u089D\u24E3s;\u691Fs;\u691D\xEB\u2252p;\u61ABl;\u6939im;\u6973l;\u61A2\u0180;ae\u24FF\u2500\u2504\u6AABil;\u6919\u0100;s\u2509\u250A\u6AAD;\uC000\u2AAD\uFE00\u0180abr\u2515\u2519\u251Drr;\u690Crk;\u6772\u0100ak\u2522\u252Cc\u0100ek\u2528\u252A;\u407B;\u405B\u0100es\u2531\u2533;\u698Bl\u0100du\u2539\u253B;\u698F;\u698D\u0200aeuy\u2546\u254B\u2556\u2558ron;\u413E\u0100di\u2550\u2554il;\u413C\xEC\u08B0\xE2\u2529;\u443B\u0200cqrs\u2563\u2566\u256D\u257Da;\u6936uo\u0100;r\u0E19\u1746\u0100du\u2572\u2577har;\u6967shar;\u694Bh;\u61B2\u0280;fgqs\u258B\u258C\u0989\u25F3\u25FF\u6264t\u0280ahlrt\u2598\u25A4\u25B7\u25C2\u25E8rrow\u0100;t\u0899\u25A1a\xE9\u24F6arpoon\u0100du\u25AF\u25B4own\xBB\u045Ap\xBB\u0966eftarrows;\u61C7ight\u0180ahs\u25CD\u25D6\u25DErrow\u0100;s\u08F4\u08A7arpoon\xF3\u0F98quigarro\xF7\u21F0hreetimes;\u62CB\u0180;qs\u258B\u0993\u25FAlan\xF4\u09AC\u0280;cdgs\u09AC\u260A\u260D\u261D\u2628c;\u6AA8ot\u0100;o\u2614\u2615\u6A7F\u0100;r\u261A\u261B\u6A81;\u6A83\u0100;e\u2622\u2625\uC000\u22DA\uFE00s;\u6A93\u0280adegs\u2633\u2639\u263D\u2649\u264Bppro\xF8\u24C6ot;\u62D6q\u0100gq\u2643\u2645\xF4\u0989gt\xF2\u248C\xF4\u099Bi\xED\u09B2\u0180ilr\u2655\u08E1\u265Asht;\u697C;\uC000\u{1D529}\u0100;E\u099C\u2663;\u6A91\u0161\u2669\u2676r\u0100du\u25B2\u266E\u0100;l\u0965\u2673;\u696Alk;\u6584cy;\u4459\u0280;acht\u0A48\u2688\u268B\u2691\u2696r\xF2\u25C1orne\xF2\u1D08ard;\u696Bri;\u65FA\u0100io\u269F\u26A4dot;\u4140ust\u0100;a\u26AC\u26AD\u63B0che\xBB\u26AD\u0200Eaes\u26BB\u26BD\u26C9\u26D4;\u6268p\u0100;p\u26C3\u26C4\u6A89rox\xBB\u26C4\u0100;q\u26CE\u26CF\u6A87\u0100;q\u26CE\u26BBim;\u62E6\u0400abnoptwz\u26E9\u26F4\u26F7\u271A\u272F\u2741\u2747\u2750\u0100nr\u26EE\u26F1g;\u67ECr;\u61FDr\xEB\u08C1g\u0180lmr\u26FF\u270D\u2714eft\u0100ar\u09E6\u2707ight\xE1\u09F2apsto;\u67FCight\xE1\u09FDparrow\u0100lr\u2725\u2729ef\xF4\u24EDight;\u61AC\u0180afl\u2736\u2739\u273Dr;\u6985;\uC000\u{1D55D}us;\u6A2Dimes;\u6A34\u0161\u274B\u274Fst;\u6217\xE1\u134E\u0180;ef\u2757\u2758\u1800\u65CAnge\xBB\u2758ar\u0100;l\u2764\u2765\u4028t;\u6993\u0280achmt\u2773\u2776\u277C\u2785\u2787r\xF2\u08A8orne\xF2\u1D8Car\u0100;d\u0F98\u2783;\u696D;\u600Eri;\u62BF\u0300achiqt\u2798\u279D\u0A40\u27A2\u27AE\u27BBquo;\u6039r;\uC000\u{1D4C1}m\u0180;eg\u09B2\u27AA\u27AC;\u6A8D;\u6A8F\u0100bu\u252A\u27B3o\u0100;r\u0E1F\u27B9;\u601Arok;\u4142\u8400<;cdhilqr\u082B\u27D2\u2639\u27DC\u27E0\u27E5\u27EA\u27F0\u0100ci\u27D7\u27D9;\u6AA6r;\u6A79re\xE5\u25F2mes;\u62C9arr;\u6976uest;\u6A7B\u0100Pi\u27F5\u27F9ar;\u6996\u0180;ef\u2800\u092D\u181B\u65C3r\u0100du\u2807\u280Dshar;\u694Ahar;\u6966\u0100en\u2817\u2821rtneqq;\uC000\u2268\uFE00\xC5\u281E\u0700Dacdefhilnopsu\u2840\u2845\u2882\u288E\u2893\u28A0\u28A5\u28A8\u28DA\u28E2\u28E4\u0A83\u28F3\u2902Dot;\u623A\u0200clpr\u284E\u2852\u2863\u287Dr\u803B\xAF\u40AF\u0100et\u2857\u2859;\u6642\u0100;e\u285E\u285F\u6720se\xBB\u285F\u0100;s\u103B\u2868to\u0200;dlu\u103B\u2873\u2877\u287Bow\xEE\u048Cef\xF4\u090F\xF0\u13D1ker;\u65AE\u0100oy\u2887\u288Cmma;\u6A29;\u443Cash;\u6014asuredangle\xBB\u1626r;\uC000\u{1D52A}o;\u6127\u0180cdn\u28AF\u28B4\u28C9ro\u803B\xB5\u40B5\u0200;acd\u1464\u28BD\u28C0\u28C4s\xF4\u16A7ir;\u6AF0ot\u80BB\xB7\u01B5us\u0180;bd\u28D2\u1903\u28D3\u6212\u0100;u\u1D3C\u28D8;\u6A2A\u0163\u28DE\u28E1p;\u6ADB\xF2\u2212\xF0\u0A81\u0100dp\u28E9\u28EEels;\u62A7f;\uC000\u{1D55E}\u0100ct\u28F8\u28FDr;\uC000\u{1D4C2}pos\xBB\u159D\u0180;lm\u2909\u290A\u290D\u43BCtimap;\u62B8\u0C00GLRVabcdefghijlmoprstuvw\u2942\u2953\u297E\u2989\u2998\u29DA\u29E9\u2A15\u2A1A\u2A58\u2A5D\u2A83\u2A95\u2AA4\u2AA8\u2B04\u2B07\u2B44\u2B7F\u2BAE\u2C34\u2C67\u2C7C\u2CE9\u0100gt\u2947\u294B;\uC000\u22D9\u0338\u0100;v\u2950\u0BCF\uC000\u226B\u20D2\u0180elt\u295A\u2972\u2976ft\u0100ar\u2961\u2967rrow;\u61CDightarrow;\u61CE;\uC000\u22D8\u0338\u0100;v\u297B\u0C47\uC000\u226A\u20D2ightarrow;\u61CF\u0100Dd\u298E\u2993ash;\u62AFash;\u62AE\u0280bcnpt\u29A3\u29A7\u29AC\u29B1\u29CCla\xBB\u02DEute;\u4144g;\uC000\u2220\u20D2\u0280;Eiop\u0D84\u29BC\u29C0\u29C5\u29C8;\uC000\u2A70\u0338d;\uC000\u224B\u0338s;\u4149ro\xF8\u0D84ur\u0100;a\u29D3\u29D4\u666El\u0100;s\u29D3\u0B38\u01F3\u29DF\0\u29E3p\u80BB\xA0\u0B37mp\u0100;e\u0BF9\u0C00\u0280aeouy\u29F4\u29FE\u2A03\u2A10\u2A13\u01F0\u29F9\0\u29FB;\u6A43on;\u4148dil;\u4146ng\u0100;d\u0D7E\u2A0Aot;\uC000\u2A6D\u0338p;\u6A42;\u443Dash;\u6013\u0380;Aadqsx\u0B92\u2A29\u2A2D\u2A3B\u2A41\u2A45\u2A50rr;\u61D7r\u0100hr\u2A33\u2A36k;\u6924\u0100;o\u13F2\u13F0ot;\uC000\u2250\u0338ui\xF6\u0B63\u0100ei\u2A4A\u2A4Ear;\u6928\xED\u0B98ist\u0100;s\u0BA0\u0B9Fr;\uC000\u{1D52B}\u0200Eest\u0BC5\u2A66\u2A79\u2A7C\u0180;qs\u0BBC\u2A6D\u0BE1\u0180;qs\u0BBC\u0BC5\u2A74lan\xF4\u0BE2i\xED\u0BEA\u0100;r\u0BB6\u2A81\xBB\u0BB7\u0180Aap\u2A8A\u2A8D\u2A91r\xF2\u2971rr;\u61AEar;\u6AF2\u0180;sv\u0F8D\u2A9C\u0F8C\u0100;d\u2AA1\u2AA2\u62FC;\u62FAcy;\u445A\u0380AEadest\u2AB7\u2ABA\u2ABE\u2AC2\u2AC5\u2AF6\u2AF9r\xF2\u2966;\uC000\u2266\u0338rr;\u619Ar;\u6025\u0200;fqs\u0C3B\u2ACE\u2AE3\u2AEFt\u0100ar\u2AD4\u2AD9rro\xF7\u2AC1ightarro\xF7\u2A90\u0180;qs\u0C3B\u2ABA\u2AEAlan\xF4\u0C55\u0100;s\u0C55\u2AF4\xBB\u0C36i\xED\u0C5D\u0100;r\u0C35\u2AFEi\u0100;e\u0C1A\u0C25i\xE4\u0D90\u0100pt\u2B0C\u2B11f;\uC000\u{1D55F}\u8180\xAC;in\u2B19\u2B1A\u2B36\u40ACn\u0200;Edv\u0B89\u2B24\u2B28\u2B2E;\uC000\u22F9\u0338ot;\uC000\u22F5\u0338\u01E1\u0B89\u2B33\u2B35;\u62F7;\u62F6i\u0100;v\u0CB8\u2B3C\u01E1\u0CB8\u2B41\u2B43;\u62FE;\u62FD\u0180aor\u2B4B\u2B63\u2B69r\u0200;ast\u0B7B\u2B55\u2B5A\u2B5Flle\xEC\u0B7Bl;\uC000\u2AFD\u20E5;\uC000\u2202\u0338lint;\u6A14\u0180;ce\u0C92\u2B70\u2B73u\xE5\u0CA5\u0100;c\u0C98\u2B78\u0100;e\u0C92\u2B7D\xF1\u0C98\u0200Aait\u2B88\u2B8B\u2B9D\u2BA7r\xF2\u2988rr\u0180;cw\u2B94\u2B95\u2B99\u619B;\uC000\u2933\u0338;\uC000\u219D\u0338ghtarrow\xBB\u2B95ri\u0100;e\u0CCB\u0CD6\u0380chimpqu\u2BBD\u2BCD\u2BD9\u2B04\u0B78\u2BE4\u2BEF\u0200;cer\u0D32\u2BC6\u0D37\u2BC9u\xE5\u0D45;\uC000\u{1D4C3}ort\u026D\u2B05\0\0\u2BD6ar\xE1\u2B56m\u0100;e\u0D6E\u2BDF\u0100;q\u0D74\u0D73su\u0100bp\u2BEB\u2BED\xE5\u0CF8\xE5\u0D0B\u0180bcp\u2BF6\u2C11\u2C19\u0200;Ees\u2BFF\u2C00\u0D22\u2C04\u6284;\uC000\u2AC5\u0338et\u0100;e\u0D1B\u2C0Bq\u0100;q\u0D23\u2C00c\u0100;e\u0D32\u2C17\xF1\u0D38\u0200;Ees\u2C22\u2C23\u0D5F\u2C27\u6285;\uC000\u2AC6\u0338et\u0100;e\u0D58\u2C2Eq\u0100;q\u0D60\u2C23\u0200gilr\u2C3D\u2C3F\u2C45\u2C47\xEC\u0BD7lde\u803B\xF1\u40F1\xE7\u0C43iangle\u0100lr\u2C52\u2C5Ceft\u0100;e\u0C1A\u2C5A\xF1\u0C26ight\u0100;e\u0CCB\u2C65\xF1\u0CD7\u0100;m\u2C6C\u2C6D\u43BD\u0180;es\u2C74\u2C75\u2C79\u4023ro;\u6116p;\u6007\u0480DHadgilrs\u2C8F\u2C94\u2C99\u2C9E\u2CA3\u2CB0\u2CB6\u2CD3\u2CE3ash;\u62ADarr;\u6904p;\uC000\u224D\u20D2ash;\u62AC\u0100et\u2CA8\u2CAC;\uC000\u2265\u20D2;\uC000>\u20D2nfin;\u69DE\u0180Aet\u2CBD\u2CC1\u2CC5rr;\u6902;\uC000\u2264\u20D2\u0100;r\u2CCA\u2CCD\uC000<\u20D2ie;\uC000\u22B4\u20D2\u0100At\u2CD8\u2CDCrr;\u6903rie;\uC000\u22B5\u20D2im;\uC000\u223C\u20D2\u0180Aan\u2CF0\u2CF4\u2D02rr;\u61D6r\u0100hr\u2CFA\u2CFDk;\u6923\u0100;o\u13E7\u13E5ear;\u6927\u1253\u1A95\0\0\0\0\0\0\0\0\0\0\0\0\0\u2D2D\0\u2D38\u2D48\u2D60\u2D65\u2D72\u2D84\u1B07\0\0\u2D8D\u2DAB\0\u2DC8\u2DCE\0\u2DDC\u2E19\u2E2B\u2E3E\u2E43\u0100cs\u2D31\u1A97ute\u803B\xF3\u40F3\u0100iy\u2D3C\u2D45r\u0100;c\u1A9E\u2D42\u803B\xF4\u40F4;\u443E\u0280abios\u1AA0\u2D52\u2D57\u01C8\u2D5Alac;\u4151v;\u6A38old;\u69BClig;\u4153\u0100cr\u2D69\u2D6Dir;\u69BF;\uC000\u{1D52C}\u036F\u2D79\0\0\u2D7C\0\u2D82n;\u42DBave\u803B\xF2\u40F2;\u69C1\u0100bm\u2D88\u0DF4ar;\u69B5\u0200acit\u2D95\u2D98\u2DA5\u2DA8r\xF2\u1A80\u0100ir\u2D9D\u2DA0r;\u69BEoss;\u69BBn\xE5\u0E52;\u69C0\u0180aei\u2DB1\u2DB5\u2DB9cr;\u414Dga;\u43C9\u0180cdn\u2DC0\u2DC5\u01CDron;\u43BF;\u69B6pf;\uC000\u{1D560}\u0180ael\u2DD4\u2DD7\u01D2r;\u69B7rp;\u69B9\u0380;adiosv\u2DEA\u2DEB\u2DEE\u2E08\u2E0D\u2E10\u2E16\u6228r\xF2\u1A86\u0200;efm\u2DF7\u2DF8\u2E02\u2E05\u6A5Dr\u0100;o\u2DFE\u2DFF\u6134f\xBB\u2DFF\u803B\xAA\u40AA\u803B\xBA\u40BAgof;\u62B6r;\u6A56lope;\u6A57;\u6A5B\u0180clo\u2E1F\u2E21\u2E27\xF2\u2E01ash\u803B\xF8\u40F8l;\u6298i\u016C\u2E2F\u2E34de\u803B\xF5\u40F5es\u0100;a\u01DB\u2E3As;\u6A36ml\u803B\xF6\u40F6bar;\u633D\u0AE1\u2E5E\0\u2E7D\0\u2E80\u2E9D\0\u2EA2\u2EB9\0\0\u2ECB\u0E9C\0\u2F13\0\0\u2F2B\u2FBC\0\u2FC8r\u0200;ast\u0403\u2E67\u2E72\u0E85\u8100\xB6;l\u2E6D\u2E6E\u40B6le\xEC\u0403\u0269\u2E78\0\0\u2E7Bm;\u6AF3;\u6AFDy;\u443Fr\u0280cimpt\u2E8B\u2E8F\u2E93\u1865\u2E97nt;\u4025od;\u402Eil;\u6030enk;\u6031r;\uC000\u{1D52D}\u0180imo\u2EA8\u2EB0\u2EB4\u0100;v\u2EAD\u2EAE\u43C6;\u43D5ma\xF4\u0A76ne;\u660E\u0180;tv\u2EBF\u2EC0\u2EC8\u43C0chfork\xBB\u1FFD;\u43D6\u0100au\u2ECF\u2EDFn\u0100ck\u2ED5\u2EDDk\u0100;h\u21F4\u2EDB;\u610E\xF6\u21F4s\u0480;abcdemst\u2EF3\u2EF4\u1908\u2EF9\u2EFD\u2F04\u2F06\u2F0A\u2F0E\u402Bcir;\u6A23ir;\u6A22\u0100ou\u1D40\u2F02;\u6A25;\u6A72n\u80BB\xB1\u0E9Dim;\u6A26wo;\u6A27\u0180ipu\u2F19\u2F20\u2F25ntint;\u6A15f;\uC000\u{1D561}nd\u803B\xA3\u40A3\u0500;Eaceinosu\u0EC8\u2F3F\u2F41\u2F44\u2F47\u2F81\u2F89\u2F92\u2F7E\u2FB6;\u6AB3p;\u6AB7u\xE5\u0ED9\u0100;c\u0ECE\u2F4C\u0300;acens\u0EC8\u2F59\u2F5F\u2F66\u2F68\u2F7Eppro\xF8\u2F43urlye\xF1\u0ED9\xF1\u0ECE\u0180aes\u2F6F\u2F76\u2F7Approx;\u6AB9qq;\u6AB5im;\u62E8i\xED\u0EDFme\u0100;s\u2F88\u0EAE\u6032\u0180Eas\u2F78\u2F90\u2F7A\xF0\u2F75\u0180dfp\u0EEC\u2F99\u2FAF\u0180als\u2FA0\u2FA5\u2FAAlar;\u632Eine;\u6312urf;\u6313\u0100;t\u0EFB\u2FB4\xEF\u0EFBrel;\u62B0\u0100ci\u2FC0\u2FC5r;\uC000\u{1D4C5};\u43C8ncsp;\u6008\u0300fiopsu\u2FDA\u22E2\u2FDF\u2FE5\u2FEB\u2FF1r;\uC000\u{1D52E}pf;\uC000\u{1D562}rime;\u6057cr;\uC000\u{1D4C6}\u0180aeo\u2FF8\u3009\u3013t\u0100ei\u2FFE\u3005rnion\xF3\u06B0nt;\u6A16st\u0100;e\u3010\u3011\u403F\xF1\u1F19\xF4\u0F14\u0A80ABHabcdefhilmnoprstux\u3040\u3051\u3055\u3059\u30E0\u310E\u312B\u3147\u3162\u3172\u318E\u3206\u3215\u3224\u3229\u3258\u326E\u3272\u3290\u32B0\u32B7\u0180art\u3047\u304A\u304Cr\xF2\u10B3\xF2\u03DDail;\u691Car\xF2\u1C65ar;\u6964\u0380cdenqrt\u3068\u3075\u3078\u307F\u308F\u3094\u30CC\u0100eu\u306D\u3071;\uC000\u223D\u0331te;\u4155i\xE3\u116Emptyv;\u69B3g\u0200;del\u0FD1\u3089\u308B\u308D;\u6992;\u69A5\xE5\u0FD1uo\u803B\xBB\u40BBr\u0580;abcfhlpstw\u0FDC\u30AC\u30AF\u30B7\u30B9\u30BC\u30BE\u30C0\u30C3\u30C7\u30CAp;\u6975\u0100;f\u0FE0\u30B4s;\u6920;\u6933s;\u691E\xEB\u225D\xF0\u272El;\u6945im;\u6974l;\u61A3;\u619D\u0100ai\u30D1\u30D5il;\u691Ao\u0100;n\u30DB\u30DC\u6236al\xF3\u0F1E\u0180abr\u30E7\u30EA\u30EEr\xF2\u17E5rk;\u6773\u0100ak\u30F3\u30FDc\u0100ek\u30F9\u30FB;\u407D;\u405D\u0100es\u3102\u3104;\u698Cl\u0100du\u310A\u310C;\u698E;\u6990\u0200aeuy\u3117\u311C\u3127\u3129ron;\u4159\u0100di\u3121\u3125il;\u4157\xEC\u0FF2\xE2\u30FA;\u4440\u0200clqs\u3134\u3137\u313D\u3144a;\u6937dhar;\u6969uo\u0100;r\u020E\u020Dh;\u61B3\u0180acg\u314E\u315F\u0F44l\u0200;ips\u0F78\u3158\u315B\u109Cn\xE5\u10BBar\xF4\u0FA9t;\u65AD\u0180ilr\u3169\u1023\u316Esht;\u697D;\uC000\u{1D52F}\u0100ao\u3177\u3186r\u0100du\u317D\u317F\xBB\u047B\u0100;l\u1091\u3184;\u696C\u0100;v\u318B\u318C\u43C1;\u43F1\u0180gns\u3195\u31F9\u31FCht\u0300ahlrst\u31A4\u31B0\u31C2\u31D8\u31E4\u31EErrow\u0100;t\u0FDC\u31ADa\xE9\u30C8arpoon\u0100du\u31BB\u31BFow\xEE\u317Ep\xBB\u1092eft\u0100ah\u31CA\u31D0rrow\xF3\u0FEAarpoon\xF3\u0551ightarrows;\u61C9quigarro\xF7\u30CBhreetimes;\u62CCg;\u42DAingdotse\xF1\u1F32\u0180ahm\u320D\u3210\u3213r\xF2\u0FEAa\xF2\u0551;\u600Foust\u0100;a\u321E\u321F\u63B1che\xBB\u321Fmid;\u6AEE\u0200abpt\u3232\u323D\u3240\u3252\u0100nr\u3237\u323Ag;\u67EDr;\u61FEr\xEB\u1003\u0180afl\u3247\u324A\u324Er;\u6986;\uC000\u{1D563}us;\u6A2Eimes;\u6A35\u0100ap\u325D\u3267r\u0100;g\u3263\u3264\u4029t;\u6994olint;\u6A12ar\xF2\u31E3\u0200achq\u327B\u3280\u10BC\u3285quo;\u603Ar;\uC000\u{1D4C7}\u0100bu\u30FB\u328Ao\u0100;r\u0214\u0213\u0180hir\u3297\u329B\u32A0re\xE5\u31F8mes;\u62CAi\u0200;efl\u32AA\u1059\u1821\u32AB\u65B9tri;\u69CEluhar;\u6968;\u611E\u0D61\u32D5\u32DB\u32DF\u332C\u3338\u3371\0\u337A\u33A4\0\0\u33EC\u33F0\0\u3428\u3448\u345A\u34AD\u34B1\u34CA\u34F1\0\u3616\0\0\u3633cute;\u415Bqu\xEF\u27BA\u0500;Eaceinpsy\u11ED\u32F3\u32F5\u32FF\u3302\u330B\u330F\u331F\u3326\u3329;\u6AB4\u01F0\u32FA\0\u32FC;\u6AB8on;\u4161u\xE5\u11FE\u0100;d\u11F3\u3307il;\u415Frc;\u415D\u0180Eas\u3316\u3318\u331B;\u6AB6p;\u6ABAim;\u62E9olint;\u6A13i\xED\u1204;\u4441ot\u0180;be\u3334\u1D47\u3335\u62C5;\u6A66\u0380Aacmstx\u3346\u334A\u3357\u335B\u335E\u3363\u336Drr;\u61D8r\u0100hr\u3350\u3352\xEB\u2228\u0100;o\u0A36\u0A34t\u803B\xA7\u40A7i;\u403Bwar;\u6929m\u0100in\u3369\xF0nu\xF3\xF1t;\u6736r\u0100;o\u3376\u2055\uC000\u{1D530}\u0200acoy\u3382\u3386\u3391\u33A0rp;\u666F\u0100hy\u338B\u338Fcy;\u4449;\u4448rt\u026D\u3399\0\0\u339Ci\xE4\u1464ara\xEC\u2E6F\u803B\xAD\u40AD\u0100gm\u33A8\u33B4ma\u0180;fv\u33B1\u33B2\u33B2\u43C3;\u43C2\u0400;deglnpr\u12AB\u33C5\u33C9\u33CE\u33D6\u33DE\u33E1\u33E6ot;\u6A6A\u0100;q\u12B1\u12B0\u0100;E\u33D3\u33D4\u6A9E;\u6AA0\u0100;E\u33DB\u33DC\u6A9D;\u6A9Fe;\u6246lus;\u6A24arr;\u6972ar\xF2\u113D\u0200aeit\u33F8\u3408\u340F\u3417\u0100ls\u33FD\u3404lsetm\xE9\u336Ahp;\u6A33parsl;\u69E4\u0100dl\u1463\u3414e;\u6323\u0100;e\u341C\u341D\u6AAA\u0100;s\u3422\u3423\u6AAC;\uC000\u2AAC\uFE00\u0180flp\u342E\u3433\u3442tcy;\u444C\u0100;b\u3438\u3439\u402F\u0100;a\u343E\u343F\u69C4r;\u633Ff;\uC000\u{1D564}a\u0100dr\u344D\u0402es\u0100;u\u3454\u3455\u6660it\xBB\u3455\u0180csu\u3460\u3479\u349F\u0100au\u3465\u346Fp\u0100;s\u1188\u346B;\uC000\u2293\uFE00p\u0100;s\u11B4\u3475;\uC000\u2294\uFE00u\u0100bp\u347F\u348F\u0180;es\u1197\u119C\u3486et\u0100;e\u1197\u348D\xF1\u119D\u0180;es\u11A8\u11AD\u3496et\u0100;e\u11A8\u349D\xF1\u11AE\u0180;af\u117B\u34A6\u05B0r\u0165\u34AB\u05B1\xBB\u117Car\xF2\u1148\u0200cemt\u34B9\u34BE\u34C2\u34C5r;\uC000\u{1D4C8}tm\xEE\xF1i\xEC\u3415ar\xE6\u11BE\u0100ar\u34CE\u34D5r\u0100;f\u34D4\u17BF\u6606\u0100an\u34DA\u34EDight\u0100ep\u34E3\u34EApsilo\xEE\u1EE0h\xE9\u2EAFs\xBB\u2852\u0280bcmnp\u34FB\u355E\u1209\u358B\u358E\u0480;Edemnprs\u350E\u350F\u3511\u3515\u351E\u3523\u352C\u3531\u3536\u6282;\u6AC5ot;\u6ABD\u0100;d\u11DA\u351Aot;\u6AC3ult;\u6AC1\u0100Ee\u3528\u352A;\u6ACB;\u628Alus;\u6ABFarr;\u6979\u0180eiu\u353D\u3552\u3555t\u0180;en\u350E\u3545\u354Bq\u0100;q\u11DA\u350Feq\u0100;q\u352B\u3528m;\u6AC7\u0100bp\u355A\u355C;\u6AD5;\u6AD3c\u0300;acens\u11ED\u356C\u3572\u3579\u357B\u3326ppro\xF8\u32FAurlye\xF1\u11FE\xF1\u11F3\u0180aes\u3582\u3588\u331Bppro\xF8\u331Aq\xF1\u3317g;\u666A\u0680123;Edehlmnps\u35A9\u35AC\u35AF\u121C\u35B2\u35B4\u35C0\u35C9\u35D5\u35DA\u35DF\u35E8\u35ED\u803B\xB9\u40B9\u803B\xB2\u40B2\u803B\xB3\u40B3;\u6AC6\u0100os\u35B9\u35BCt;\u6ABEub;\u6AD8\u0100;d\u1222\u35C5ot;\u6AC4s\u0100ou\u35CF\u35D2l;\u67C9b;\u6AD7arr;\u697Bult;\u6AC2\u0100Ee\u35E4\u35E6;\u6ACC;\u628Blus;\u6AC0\u0180eiu\u35F4\u3609\u360Ct\u0180;en\u121C\u35FC\u3602q\u0100;q\u1222\u35B2eq\u0100;q\u35E7\u35E4m;\u6AC8\u0100bp\u3611\u3613;\u6AD4;\u6AD6\u0180Aan\u361C\u3620\u362Drr;\u61D9r\u0100hr\u3626\u3628\xEB\u222E\u0100;o\u0A2B\u0A29war;\u692Alig\u803B\xDF\u40DF\u0BE1\u3651\u365D\u3660\u12CE\u3673\u3679\0\u367E\u36C2\0\0\0\0\0\u36DB\u3703\0\u3709\u376C\0\0\0\u3787\u0272\u3656\0\0\u365Bget;\u6316;\u43C4r\xEB\u0E5F\u0180aey\u3666\u366B\u3670ron;\u4165dil;\u4163;\u4442lrec;\u6315r;\uC000\u{1D531}\u0200eiko\u3686\u369D\u36B5\u36BC\u01F2\u368B\0\u3691e\u01004f\u1284\u1281a\u0180;sv\u3698\u3699\u369B\u43B8ym;\u43D1\u0100cn\u36A2\u36B2k\u0100as\u36A8\u36AEppro\xF8\u12C1im\xBB\u12ACs\xF0\u129E\u0100as\u36BA\u36AE\xF0\u12C1rn\u803B\xFE\u40FE\u01EC\u031F\u36C6\u22E7es\u8180\xD7;bd\u36CF\u36D0\u36D8\u40D7\u0100;a\u190F\u36D5r;\u6A31;\u6A30\u0180eps\u36E1\u36E3\u3700\xE1\u2A4D\u0200;bcf\u0486\u36EC\u36F0\u36F4ot;\u6336ir;\u6AF1\u0100;o\u36F9\u36FC\uC000\u{1D565}rk;\u6ADA\xE1\u3362rime;\u6034\u0180aip\u370F\u3712\u3764d\xE5\u1248\u0380adempst\u3721\u374D\u3740\u3751\u3757\u375C\u375Fngle\u0280;dlqr\u3730\u3731\u3736\u3740\u3742\u65B5own\xBB\u1DBBeft\u0100;e\u2800\u373E\xF1\u092E;\u625Cight\u0100;e\u32AA\u374B\xF1\u105Aot;\u65ECinus;\u6A3Alus;\u6A39b;\u69CDime;\u6A3Bezium;\u63E2\u0180cht\u3772\u377D\u3781\u0100ry\u3777\u377B;\uC000\u{1D4C9};\u4446cy;\u445Brok;\u4167\u0100io\u378B\u378Ex\xF4\u1777head\u0100lr\u3797\u37A0eftarro\xF7\u084Fightarrow\xBB\u0F5D\u0900AHabcdfghlmoprstuw\u37D0\u37D3\u37D7\u37E4\u37F0\u37FC\u380E\u381C\u3823\u3834\u3851\u385D\u386B\u38A9\u38CC\u38D2\u38EA\u38F6r\xF2\u03EDar;\u6963\u0100cr\u37DC\u37E2ute\u803B\xFA\u40FA\xF2\u1150r\u01E3\u37EA\0\u37EDy;\u445Eve;\u416D\u0100iy\u37F5\u37FArc\u803B\xFB\u40FB;\u4443\u0180abh\u3803\u3806\u380Br\xF2\u13ADlac;\u4171a\xF2\u13C3\u0100ir\u3813\u3818sht;\u697E;\uC000\u{1D532}rave\u803B\xF9\u40F9\u0161\u3827\u3831r\u0100lr\u382C\u382E\xBB\u0957\xBB\u1083lk;\u6580\u0100ct\u3839\u384D\u026F\u383F\0\0\u384Arn\u0100;e\u3845\u3846\u631Cr\xBB\u3846op;\u630Fri;\u65F8\u0100al\u3856\u385Acr;\u416B\u80BB\xA8\u0349\u0100gp\u3862\u3866on;\u4173f;\uC000\u{1D566}\u0300adhlsu\u114B\u3878\u387D\u1372\u3891\u38A0own\xE1\u13B3arpoon\u0100lr\u3888\u388Cef\xF4\u382Digh\xF4\u382Fi\u0180;hl\u3899\u389A\u389C\u43C5\xBB\u13FAon\xBB\u389Aparrows;\u61C8\u0180cit\u38B0\u38C4\u38C8\u026F\u38B6\0\0\u38C1rn\u0100;e\u38BC\u38BD\u631Dr\xBB\u38BDop;\u630Eng;\u416Fri;\u65F9cr;\uC000\u{1D4CA}\u0180dir\u38D9\u38DD\u38E2ot;\u62F0lde;\u4169i\u0100;f\u3730\u38E8\xBB\u1813\u0100am\u38EF\u38F2r\xF2\u38A8l\u803B\xFC\u40FCangle;\u69A7\u0780ABDacdeflnoprsz\u391C\u391F\u3929\u392D\u39B5\u39B8\u39BD\u39DF\u39E4\u39E8\u39F3\u39F9\u39FD\u3A01\u3A20r\xF2\u03F7ar\u0100;v\u3926\u3927\u6AE8;\u6AE9as\xE8\u03E1\u0100nr\u3932\u3937grt;\u699C\u0380eknprst\u34E3\u3946\u394B\u3952\u395D\u3964\u3996app\xE1\u2415othin\xE7\u1E96\u0180hir\u34EB\u2EC8\u3959op\xF4\u2FB5\u0100;h\u13B7\u3962\xEF\u318D\u0100iu\u3969\u396Dgm\xE1\u33B3\u0100bp\u3972\u3984setneq\u0100;q\u397D\u3980\uC000\u228A\uFE00;\uC000\u2ACB\uFE00setneq\u0100;q\u398F\u3992\uC000\u228B\uFE00;\uC000\u2ACC\uFE00\u0100hr\u399B\u399Fet\xE1\u369Ciangle\u0100lr\u39AA\u39AFeft\xBB\u0925ight\xBB\u1051y;\u4432ash\xBB\u1036\u0180elr\u39C4\u39D2\u39D7\u0180;be\u2DEA\u39CB\u39CFar;\u62BBq;\u625Alip;\u62EE\u0100bt\u39DC\u1468a\xF2\u1469r;\uC000\u{1D533}tr\xE9\u39AEsu\u0100bp\u39EF\u39F1\xBB\u0D1C\xBB\u0D59pf;\uC000\u{1D567}ro\xF0\u0EFBtr\xE9\u39B4\u0100cu\u3A06\u3A0Br;\uC000\u{1D4CB}\u0100bp\u3A10\u3A18n\u0100Ee\u3980\u3A16\xBB\u397En\u0100Ee\u3992\u3A1E\xBB\u3990igzag;\u699A\u0380cefoprs\u3A36\u3A3B\u3A56\u3A5B\u3A54\u3A61\u3A6Airc;\u4175\u0100di\u3A40\u3A51\u0100bg\u3A45\u3A49ar;\u6A5Fe\u0100;q\u15FA\u3A4F;\u6259erp;\u6118r;\uC000\u{1D534}pf;\uC000\u{1D568}\u0100;e\u1479\u3A66at\xE8\u1479cr;\uC000\u{1D4CC}\u0AE3\u178E\u3A87\0\u3A8B\0\u3A90\u3A9B\0\0\u3A9D\u3AA8\u3AAB\u3AAF\0\0\u3AC3\u3ACE\0\u3AD8\u17DC\u17DFtr\xE9\u17D1r;\uC000\u{1D535}\u0100Aa\u3A94\u3A97r\xF2\u03C3r\xF2\u09F6;\u43BE\u0100Aa\u3AA1\u3AA4r\xF2\u03B8r\xF2\u09EBa\xF0\u2713is;\u62FB\u0180dpt\u17A4\u3AB5\u3ABE\u0100fl\u3ABA\u17A9;\uC000\u{1D569}im\xE5\u17B2\u0100Aa\u3AC7\u3ACAr\xF2\u03CEr\xF2\u0A01\u0100cq\u3AD2\u17B8r;\uC000\u{1D4CD}\u0100pt\u17D6\u3ADCr\xE9\u17D4\u0400acefiosu\u3AF0\u3AFD\u3B08\u3B0C\u3B11\u3B15\u3B1B\u3B21c\u0100uy\u3AF6\u3AFBte\u803B\xFD\u40FD;\u444F\u0100iy\u3B02\u3B06rc;\u4177;\u444Bn\u803B\xA5\u40A5r;\uC000\u{1D536}cy;\u4457pf;\uC000\u{1D56A}cr;\uC000\u{1D4CE}\u0100cm\u3B26\u3B29y;\u444El\u803B\xFF\u40FF\u0500acdefhiosw\u3B42\u3B48\u3B54\u3B58\u3B64\u3B69\u3B6D\u3B74\u3B7A\u3B80cute;\u417A\u0100ay\u3B4D\u3B52ron;\u417E;\u4437ot;\u417C\u0100et\u3B5D\u3B61tr\xE6\u155Fa;\u43B6r;\uC000\u{1D537}cy;\u4436grarr;\u61DDpf;\uC000\u{1D56B}cr;\uC000\u{1D4CF}\u0100jn\u3B85\u3B87;\u600Dj;\u600C'.split("").map(n=>n.charCodeAt(0)));var XV=new Uint16Array("\u0200aglq	\x1B\u026D\0\0p;\u4026os;\u4027t;\u403Et;\u403Cuot;\u4022".split("").map(n=>n.charCodeAt(0)));var m5,iTt=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),_5=(m5=String.fromCodePoint)!==null&&m5!==void 0?m5:function(n){let e="";return n>65535&&(n-=65536,e+=String.fromCharCode(n>>>10&1023|55296),n=56320|n&1023),e+=String.fromCharCode(n),e};function y5(n){var e;return n>=55296&&n<=57343||n>1114111?65533:(e=iTt.get(n))!==null&&e!==void 0?e:n}var Fi;(function(n){n[n.NUM=35]="NUM",n[n.SEMI=59]="SEMI",n[n.EQUALS=61]="EQUALS",n[n.ZERO=48]="ZERO",n[n.NINE=57]="NINE",n[n.LOWER_A=97]="LOWER_A",n[n.LOWER_F=102]="LOWER_F",n[n.LOWER_X=120]="LOWER_X",n[n.LOWER_Z=122]="LOWER_Z",n[n.UPPER_A=65]="UPPER_A",n[n.UPPER_F=70]="UPPER_F",n[n.UPPER_Z=90]="UPPER_Z"})(Fi||(Fi={}));var rTt=32,Bc;(function(n){n[n.VALUE_LENGTH=49152]="VALUE_LENGTH",n[n.BRANCH_LENGTH=16256]="BRANCH_LENGTH",n[n.JUMP_TABLE=127]="JUMP_TABLE"})(Bc||(Bc={}));function g5(n){return n>=Fi.ZERO&&n<=Fi.NINE}function sTt(n){return n>=Fi.UPPER_A&&n<=Fi.UPPER_F||n>=Fi.LOWER_A&&n<=Fi.LOWER_F}function oTt(n){return n>=Fi.UPPER_A&&n<=Fi.UPPER_Z||n>=Fi.LOWER_A&&n<=Fi.LOWER_Z||g5(n)}function aTt(n){return n===Fi.EQUALS||oTt(n)}var Li;(function(n){n[n.EntityStart=0]="EntityStart",n[n.NumericStart=1]="NumericStart",n[n.NumericDecimal=2]="NumericDecimal",n[n.NumericHex=3]="NumericHex",n[n.NamedEntity=4]="NamedEntity"})(Li||(Li={}));var Ma;(function(n){n[n.Legacy=0]="Legacy",n[n.Strict=1]="Strict",n[n.Attribute=2]="Attribute"})(Ma||(Ma={}));var X2=class{constructor(e,t,i){this.decodeTree=e,this.emitCodePoint=t,this.errors=i,this.state=Li.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=Ma.Strict}startEntity(e){this.decodeMode=e,this.state=Li.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(e,t){switch(this.state){case Li.EntityStart:return e.charCodeAt(t)===Fi.NUM?(this.state=Li.NumericStart,this.consumed+=1,this.stateNumericStart(e,t+1)):(this.state=Li.NamedEntity,this.stateNamedEntity(e,t));case Li.NumericStart:return this.stateNumericStart(e,t);case Li.NumericDecimal:return this.stateNumericDecimal(e,t);case Li.NumericHex:return this.stateNumericHex(e,t);case Li.NamedEntity:return this.stateNamedEntity(e,t)}}stateNumericStart(e,t){return t>=e.length?-1:(e.charCodeAt(t)|rTt)===Fi.LOWER_X?(this.state=Li.NumericHex,this.consumed+=1,this.stateNumericHex(e,t+1)):(this.state=Li.NumericDecimal,this.stateNumericDecimal(e,t))}addToNumericResult(e,t,i,r){if(t!==i){let s=i-t;this.result=this.result*Math.pow(r,s)+parseInt(e.substr(t,s),r),this.consumed+=s}}stateNumericHex(e,t){let i=t;for(;t<e.length;){let r=e.charCodeAt(t);if(g5(r)||sTt(r))t+=1;else return this.addToNumericResult(e,i,t,16),this.emitNumericEntity(r,3)}return this.addToNumericResult(e,i,t,16),-1}stateNumericDecimal(e,t){let i=t;for(;t<e.length;){let r=e.charCodeAt(t);if(g5(r))t+=1;else return this.addToNumericResult(e,i,t,10),this.emitNumericEntity(r,2)}return this.addToNumericResult(e,i,t,10),-1}emitNumericEntity(e,t){var i;if(this.consumed<=t)return(i=this.errors)===null||i===void 0||i.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(e===Fi.SEMI)this.consumed+=1;else if(this.decodeMode===Ma.Strict)return 0;return this.emitCodePoint(y5(this.result),this.consumed),this.errors&&(e!==Fi.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(e,t){let{decodeTree:i}=this,r=i[this.treeIndex],s=(r&Bc.VALUE_LENGTH)>>14;for(;t<e.length;t++,this.excess++){let o=e.charCodeAt(t);if(this.treeIndex=cTt(i,r,this.treeIndex+Math.max(1,s),o),this.treeIndex<0)return this.result===0||this.decodeMode===Ma.Attribute&&(s===0||aTt(o))?0:this.emitNotTerminatedNamedEntity();if(r=i[this.treeIndex],s=(r&Bc.VALUE_LENGTH)>>14,s!==0){if(o===Fi.SEMI)return this.emitNamedEntityData(this.treeIndex,s,this.consumed+this.excess);this.decodeMode!==Ma.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var e;let{result:t,decodeTree:i}=this,r=(i[t]&Bc.VALUE_LENGTH)>>14;return this.emitNamedEntityData(t,r,this.consumed),(e=this.errors)===null||e===void 0||e.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(e,t,i){let{decodeTree:r}=this;return this.emitCodePoint(t===1?r[e]&~Bc.VALUE_LENGTH:r[e+1],i),t===3&&this.emitCodePoint(r[e+2],i),i}end(){var e;switch(this.state){case Li.NamedEntity:return this.result!==0&&(this.decodeMode!==Ma.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case Li.NumericDecimal:return this.emitNumericEntity(0,2);case Li.NumericHex:return this.emitNumericEntity(0,3);case Li.NumericStart:return(e=this.errors)===null||e===void 0||e.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case Li.EntityStart:return 0}}};function UV(n){let e="",t=new X2(n,i=>e+=_5(i));return function(r,s){let o=0,a=0;for(;(a=r.indexOf("&",a))>=0;){e+=r.slice(o,a),t.startEntity(s);let l=t.write(r,a+1);if(l<0){o=a+t.end();break}o=a+l,a=l===0?o+1:o}let c=e+r.slice(o);return e="",c}}function cTt(n,e,t,i){let r=(e&Bc.BRANCH_LENGTH)>>7,s=e&Bc.JUMP_TABLE;if(r===0)return s!==0&&i===s?t:-1;if(s){let c=i-s;return c<0||c>=r?-1:n[t+c]-1}let o=t,a=o+r-1;for(;o<=a;){let c=o+a>>>1,l=n[c];if(l<i)o=c+1;else if(l>i)a=c-1;else return n[c+r]}return-1}var xJt=UV(YV),bJt=UV(XV);function U2(n){for(let e=1;e<n.length;e++)n[e][0]+=n[e-1][0]+1;return n}var lTt=new Map(U2([[9,"&Tab;"],[0,"&NewLine;"],[22,"&excl;"],[0,"&quot;"],[0,"&num;"],[0,"&dollar;"],[0,"&percnt;"],[0,"&amp;"],[0,"&apos;"],[0,"&lpar;"],[0,"&rpar;"],[0,"&ast;"],[0,"&plus;"],[0,"&comma;"],[1,"&period;"],[0,"&sol;"],[10,"&colon;"],[0,"&semi;"],[0,{v:"&lt;",n:8402,o:"&nvlt;"}],[0,{v:"&equals;",n:8421,o:"&bne;"}],[0,{v:"&gt;",n:8402,o:"&nvgt;"}],[0,"&quest;"],[0,"&commat;"],[26,"&lbrack;"],[0,"&bsol;"],[0,"&rbrack;"],[0,"&Hat;"],[0,"&lowbar;"],[0,"&DiacriticalGrave;"],[5,{n:106,o:"&fjlig;"}],[20,"&lbrace;"],[0,"&verbar;"],[0,"&rbrace;"],[34,"&nbsp;"],[0,"&iexcl;"],[0,"&cent;"],[0,"&pound;"],[0,"&curren;"],[0,"&yen;"],[0,"&brvbar;"],[0,"&sect;"],[0,"&die;"],[0,"&copy;"],[0,"&ordf;"],[0,"&laquo;"],[0,"&not;"],[0,"&shy;"],[0,"&circledR;"],[0,"&macr;"],[0,"&deg;"],[0,"&PlusMinus;"],[0,"&sup2;"],[0,"&sup3;"],[0,"&acute;"],[0,"&micro;"],[0,"&para;"],[0,"&centerdot;"],[0,"&cedil;"],[0,"&sup1;"],[0,"&ordm;"],[0,"&raquo;"],[0,"&frac14;"],[0,"&frac12;"],[0,"&frac34;"],[0,"&iquest;"],[0,"&Agrave;"],[0,"&Aacute;"],[0,"&Acirc;"],[0,"&Atilde;"],[0,"&Auml;"],[0,"&angst;"],[0,"&AElig;"],[0,"&Ccedil;"],[0,"&Egrave;"],[0,"&Eacute;"],[0,"&Ecirc;"],[0,"&Euml;"],[0,"&Igrave;"],[0,"&Iacute;"],[0,"&Icirc;"],[0,"&Iuml;"],[0,"&ETH;"],[0,"&Ntilde;"],[0,"&Ograve;"],[0,"&Oacute;"],[0,"&Ocirc;"],[0,"&Otilde;"],[0,"&Ouml;"],[0,"&times;"],[0,"&Oslash;"],[0,"&Ugrave;"],[0,"&Uacute;"],[0,"&Ucirc;"],[0,"&Uuml;"],[0,"&Yacute;"],[0,"&THORN;"],[0,"&szlig;"],[0,"&agrave;"],[0,"&aacute;"],[0,"&acirc;"],[0,"&atilde;"],[0,"&auml;"],[0,"&aring;"],[0,"&aelig;"],[0,"&ccedil;"],[0,"&egrave;"],[0,"&eacute;"],[0,"&ecirc;"],[0,"&euml;"],[0,"&igrave;"],[0,"&iacute;"],[0,"&icirc;"],[0,"&iuml;"],[0,"&eth;"],[0,"&ntilde;"],[0,"&ograve;"],[0,"&oacute;"],[0,"&ocirc;"],[0,"&otilde;"],[0,"&ouml;"],[0,"&div;"],[0,"&oslash;"],[0,"&ugrave;"],[0,"&uacute;"],[0,"&ucirc;"],[0,"&uuml;"],[0,"&yacute;"],[0,"&thorn;"],[0,"&yuml;"],[0,"&Amacr;"],[0,"&amacr;"],[0,"&Abreve;"],[0,"&abreve;"],[0,"&Aogon;"],[0,"&aogon;"],[0,"&Cacute;"],[0,"&cacute;"],[0,"&Ccirc;"],[0,"&ccirc;"],[0,"&Cdot;"],[0,"&cdot;"],[0,"&Ccaron;"],[0,"&ccaron;"],[0,"&Dcaron;"],[0,"&dcaron;"],[0,"&Dstrok;"],[0,"&dstrok;"],[0,"&Emacr;"],[0,"&emacr;"],[2,"&Edot;"],[0,"&edot;"],[0,"&Eogon;"],[0,"&eogon;"],[0,"&Ecaron;"],[0,"&ecaron;"],[0,"&Gcirc;"],[0,"&gcirc;"],[0,"&Gbreve;"],[0,"&gbreve;"],[0,"&Gdot;"],[0,"&gdot;"],[0,"&Gcedil;"],[1,"&Hcirc;"],[0,"&hcirc;"],[0,"&Hstrok;"],[0,"&hstrok;"],[0,"&Itilde;"],[0,"&itilde;"],[0,"&Imacr;"],[0,"&imacr;"],[2,"&Iogon;"],[0,"&iogon;"],[0,"&Idot;"],[0,"&imath;"],[0,"&IJlig;"],[0,"&ijlig;"],[0,"&Jcirc;"],[0,"&jcirc;"],[0,"&Kcedil;"],[0,"&kcedil;"],[0,"&kgreen;"],[0,"&Lacute;"],[0,"&lacute;"],[0,"&Lcedil;"],[0,"&lcedil;"],[0,"&Lcaron;"],[0,"&lcaron;"],[0,"&Lmidot;"],[0,"&lmidot;"],[0,"&Lstrok;"],[0,"&lstrok;"],[0,"&Nacute;"],[0,"&nacute;"],[0,"&Ncedil;"],[0,"&ncedil;"],[0,"&Ncaron;"],[0,"&ncaron;"],[0,"&napos;"],[0,"&ENG;"],[0,"&eng;"],[0,"&Omacr;"],[0,"&omacr;"],[2,"&Odblac;"],[0,"&odblac;"],[0,"&OElig;"],[0,"&oelig;"],[0,"&Racute;"],[0,"&racute;"],[0,"&Rcedil;"],[0,"&rcedil;"],[0,"&Rcaron;"],[0,"&rcaron;"],[0,"&Sacute;"],[0,"&sacute;"],[0,"&Scirc;"],[0,"&scirc;"],[0,"&Scedil;"],[0,"&scedil;"],[0,"&Scaron;"],[0,"&scaron;"],[0,"&Tcedil;"],[0,"&tcedil;"],[0,"&Tcaron;"],[0,"&tcaron;"],[0,"&Tstrok;"],[0,"&tstrok;"],[0,"&Utilde;"],[0,"&utilde;"],[0,"&Umacr;"],[0,"&umacr;"],[0,"&Ubreve;"],[0,"&ubreve;"],[0,"&Uring;"],[0,"&uring;"],[0,"&Udblac;"],[0,"&udblac;"],[0,"&Uogon;"],[0,"&uogon;"],[0,"&Wcirc;"],[0,"&wcirc;"],[0,"&Ycirc;"],[0,"&ycirc;"],[0,"&Yuml;"],[0,"&Zacute;"],[0,"&zacute;"],[0,"&Zdot;"],[0,"&zdot;"],[0,"&Zcaron;"],[0,"&zcaron;"],[19,"&fnof;"],[34,"&imped;"],[63,"&gacute;"],[65,"&jmath;"],[142,"&circ;"],[0,"&caron;"],[16,"&breve;"],[0,"&DiacriticalDot;"],[0,"&ring;"],[0,"&ogon;"],[0,"&DiacriticalTilde;"],[0,"&dblac;"],[51,"&DownBreve;"],[127,"&Alpha;"],[0,"&Beta;"],[0,"&Gamma;"],[0,"&Delta;"],[0,"&Epsilon;"],[0,"&Zeta;"],[0,"&Eta;"],[0,"&Theta;"],[0,"&Iota;"],[0,"&Kappa;"],[0,"&Lambda;"],[0,"&Mu;"],[0,"&Nu;"],[0,"&Xi;"],[0,"&Omicron;"],[0,"&Pi;"],[0,"&Rho;"],[1,"&Sigma;"],[0,"&Tau;"],[0,"&Upsilon;"],[0,"&Phi;"],[0,"&Chi;"],[0,"&Psi;"],[0,"&ohm;"],[7,"&alpha;"],[0,"&beta;"],[0,"&gamma;"],[0,"&delta;"],[0,"&epsi;"],[0,"&zeta;"],[0,"&eta;"],[0,"&theta;"],[0,"&iota;"],[0,"&kappa;"],[0,"&lambda;"],[0,"&mu;"],[0,"&nu;"],[0,"&xi;"],[0,"&omicron;"],[0,"&pi;"],[0,"&rho;"],[0,"&sigmaf;"],[0,"&sigma;"],[0,"&tau;"],[0,"&upsi;"],[0,"&phi;"],[0,"&chi;"],[0,"&psi;"],[0,"&omega;"],[7,"&thetasym;"],[0,"&Upsi;"],[2,"&phiv;"],[0,"&piv;"],[5,"&Gammad;"],[0,"&digamma;"],[18,"&kappav;"],[0,"&rhov;"],[3,"&epsiv;"],[0,"&backepsilon;"],[10,"&IOcy;"],[0,"&DJcy;"],[0,"&GJcy;"],[0,"&Jukcy;"],[0,"&DScy;"],[0,"&Iukcy;"],[0,"&YIcy;"],[0,"&Jsercy;"],[0,"&LJcy;"],[0,"&NJcy;"],[0,"&TSHcy;"],[0,"&KJcy;"],[1,"&Ubrcy;"],[0,"&DZcy;"],[0,"&Acy;"],[0,"&Bcy;"],[0,"&Vcy;"],[0,"&Gcy;"],[0,"&Dcy;"],[0,"&IEcy;"],[0,"&ZHcy;"],[0,"&Zcy;"],[0,"&Icy;"],[0,"&Jcy;"],[0,"&Kcy;"],[0,"&Lcy;"],[0,"&Mcy;"],[0,"&Ncy;"],[0,"&Ocy;"],[0,"&Pcy;"],[0,"&Rcy;"],[0,"&Scy;"],[0,"&Tcy;"],[0,"&Ucy;"],[0,"&Fcy;"],[0,"&KHcy;"],[0,"&TScy;"],[0,"&CHcy;"],[0,"&SHcy;"],[0,"&SHCHcy;"],[0,"&HARDcy;"],[0,"&Ycy;"],[0,"&SOFTcy;"],[0,"&Ecy;"],[0,"&YUcy;"],[0,"&YAcy;"],[0,"&acy;"],[0,"&bcy;"],[0,"&vcy;"],[0,"&gcy;"],[0,"&dcy;"],[0,"&iecy;"],[0,"&zhcy;"],[0,"&zcy;"],[0,"&icy;"],[0,"&jcy;"],[0,"&kcy;"],[0,"&lcy;"],[0,"&mcy;"],[0,"&ncy;"],[0,"&ocy;"],[0,"&pcy;"],[0,"&rcy;"],[0,"&scy;"],[0,"&tcy;"],[0,"&ucy;"],[0,"&fcy;"],[0,"&khcy;"],[0,"&tscy;"],[0,"&chcy;"],[0,"&shcy;"],[0,"&shchcy;"],[0,"&hardcy;"],[0,"&ycy;"],[0,"&softcy;"],[0,"&ecy;"],[0,"&yucy;"],[0,"&yacy;"],[1,"&iocy;"],[0,"&djcy;"],[0,"&gjcy;"],[0,"&jukcy;"],[0,"&dscy;"],[0,"&iukcy;"],[0,"&yicy;"],[0,"&jsercy;"],[0,"&ljcy;"],[0,"&njcy;"],[0,"&tshcy;"],[0,"&kjcy;"],[1,"&ubrcy;"],[0,"&dzcy;"],[7074,"&ensp;"],[0,"&emsp;"],[0,"&emsp13;"],[0,"&emsp14;"],[1,"&numsp;"],[0,"&puncsp;"],[0,"&ThinSpace;"],[0,"&hairsp;"],[0,"&NegativeMediumSpace;"],[0,"&zwnj;"],[0,"&zwj;"],[0,"&lrm;"],[0,"&rlm;"],[0,"&dash;"],[2,"&ndash;"],[0,"&mdash;"],[0,"&horbar;"],[0,"&Verbar;"],[1,"&lsquo;"],[0,"&CloseCurlyQuote;"],[0,"&lsquor;"],[1,"&ldquo;"],[0,"&CloseCurlyDoubleQuote;"],[0,"&bdquo;"],[1,"&dagger;"],[0,"&Dagger;"],[0,"&bull;"],[2,"&nldr;"],[0,"&hellip;"],[9,"&permil;"],[0,"&pertenk;"],[0,"&prime;"],[0,"&Prime;"],[0,"&tprime;"],[0,"&backprime;"],[3,"&lsaquo;"],[0,"&rsaquo;"],[3,"&oline;"],[2,"&caret;"],[1,"&hybull;"],[0,"&frasl;"],[10,"&bsemi;"],[7,"&qprime;"],[7,{v:"&MediumSpace;",n:8202,o:"&ThickSpace;"}],[0,"&NoBreak;"],[0,"&af;"],[0,"&InvisibleTimes;"],[0,"&ic;"],[72,"&euro;"],[46,"&tdot;"],[0,"&DotDot;"],[37,"&complexes;"],[2,"&incare;"],[4,"&gscr;"],[0,"&hamilt;"],[0,"&Hfr;"],[0,"&Hopf;"],[0,"&planckh;"],[0,"&hbar;"],[0,"&imagline;"],[0,"&Ifr;"],[0,"&lagran;"],[0,"&ell;"],[1,"&naturals;"],[0,"&numero;"],[0,"&copysr;"],[0,"&weierp;"],[0,"&Popf;"],[0,"&Qopf;"],[0,"&realine;"],[0,"&real;"],[0,"&reals;"],[0,"&rx;"],[3,"&trade;"],[1,"&integers;"],[2,"&mho;"],[0,"&zeetrf;"],[0,"&iiota;"],[2,"&bernou;"],[0,"&Cayleys;"],[1,"&escr;"],[0,"&Escr;"],[0,"&Fouriertrf;"],[1,"&Mellintrf;"],[0,"&order;"],[0,"&alefsym;"],[0,"&beth;"],[0,"&gimel;"],[0,"&daleth;"],[12,"&CapitalDifferentialD;"],[0,"&dd;"],[0,"&ee;"],[0,"&ii;"],[10,"&frac13;"],[0,"&frac23;"],[0,"&frac15;"],[0,"&frac25;"],[0,"&frac35;"],[0,"&frac45;"],[0,"&frac16;"],[0,"&frac56;"],[0,"&frac18;"],[0,"&frac38;"],[0,"&frac58;"],[0,"&frac78;"],[49,"&larr;"],[0,"&ShortUpArrow;"],[0,"&rarr;"],[0,"&darr;"],[0,"&harr;"],[0,"&updownarrow;"],[0,"&nwarr;"],[0,"&nearr;"],[0,"&LowerRightArrow;"],[0,"&LowerLeftArrow;"],[0,"&nlarr;"],[0,"&nrarr;"],[1,{v:"&rarrw;",n:824,o:"&nrarrw;"}],[0,"&Larr;"],[0,"&Uarr;"],[0,"&Rarr;"],[0,"&Darr;"],[0,"&larrtl;"],[0,"&rarrtl;"],[0,"&LeftTeeArrow;"],[0,"&mapstoup;"],[0,"&map;"],[0,"&DownTeeArrow;"],[1,"&hookleftarrow;"],[0,"&hookrightarrow;"],[0,"&larrlp;"],[0,"&looparrowright;"],[0,"&harrw;"],[0,"&nharr;"],[1,"&lsh;"],[0,"&rsh;"],[0,"&ldsh;"],[0,"&rdsh;"],[1,"&crarr;"],[0,"&cularr;"],[0,"&curarr;"],[2,"&circlearrowleft;"],[0,"&circlearrowright;"],[0,"&leftharpoonup;"],[0,"&DownLeftVector;"],[0,"&RightUpVector;"],[0,"&LeftUpVector;"],[0,"&rharu;"],[0,"&DownRightVector;"],[0,"&dharr;"],[0,"&dharl;"],[0,"&RightArrowLeftArrow;"],[0,"&udarr;"],[0,"&LeftArrowRightArrow;"],[0,"&leftleftarrows;"],[0,"&upuparrows;"],[0,"&rightrightarrows;"],[0,"&ddarr;"],[0,"&leftrightharpoons;"],[0,"&Equilibrium;"],[0,"&nlArr;"],[0,"&nhArr;"],[0,"&nrArr;"],[0,"&DoubleLeftArrow;"],[0,"&DoubleUpArrow;"],[0,"&DoubleRightArrow;"],[0,"&dArr;"],[0,"&DoubleLeftRightArrow;"],[0,"&DoubleUpDownArrow;"],[0,"&nwArr;"],[0,"&neArr;"],[0,"&seArr;"],[0,"&swArr;"],[0,"&lAarr;"],[0,"&rAarr;"],[1,"&zigrarr;"],[6,"&larrb;"],[0,"&rarrb;"],[15,"&DownArrowUpArrow;"],[7,"&loarr;"],[0,"&roarr;"],[0,"&hoarr;"],[0,"&forall;"],[0,"&comp;"],[0,{v:"&part;",n:824,o:"&npart;"}],[0,"&exist;"],[0,"&nexist;"],[0,"&empty;"],[1,"&Del;"],[0,"&Element;"],[0,"&NotElement;"],[1,"&ni;"],[0,"&notni;"],[2,"&prod;"],[0,"&coprod;"],[0,"&sum;"],[0,"&minus;"],[0,"&MinusPlus;"],[0,"&dotplus;"],[1,"&Backslash;"],[0,"&lowast;"],[0,"&compfn;"],[1,"&radic;"],[2,"&prop;"],[0,"&infin;"],[0,"&angrt;"],[0,{v:"&ang;",n:8402,o:"&nang;"}],[0,"&angmsd;"],[0,"&angsph;"],[0,"&mid;"],[0,"&nmid;"],[0,"&DoubleVerticalBar;"],[0,"&NotDoubleVerticalBar;"],[0,"&and;"],[0,"&or;"],[0,{v:"&cap;",n:65024,o:"&caps;"}],[0,{v:"&cup;",n:65024,o:"&cups;"}],[0,"&int;"],[0,"&Int;"],[0,"&iiint;"],[0,"&conint;"],[0,"&Conint;"],[0,"&Cconint;"],[0,"&cwint;"],[0,"&ClockwiseContourIntegral;"],[0,"&awconint;"],[0,"&there4;"],[0,"&becaus;"],[0,"&ratio;"],[0,"&Colon;"],[0,"&dotminus;"],[1,"&mDDot;"],[0,"&homtht;"],[0,{v:"&sim;",n:8402,o:"&nvsim;"}],[0,{v:"&backsim;",n:817,o:"&race;"}],[0,{v:"&ac;",n:819,o:"&acE;"}],[0,"&acd;"],[0,"&VerticalTilde;"],[0,"&NotTilde;"],[0,{v:"&eqsim;",n:824,o:"&nesim;"}],[0,"&sime;"],[0,"&NotTildeEqual;"],[0,"&cong;"],[0,"&simne;"],[0,"&ncong;"],[0,"&ap;"],[0,"&nap;"],[0,"&ape;"],[0,{v:"&apid;",n:824,o:"&napid;"}],[0,"&backcong;"],[0,{v:"&asympeq;",n:8402,o:"&nvap;"}],[0,{v:"&bump;",n:824,o:"&nbump;"}],[0,{v:"&bumpe;",n:824,o:"&nbumpe;"}],[0,{v:"&doteq;",n:824,o:"&nedot;"}],[0,"&doteqdot;"],[0,"&efDot;"],[0,"&erDot;"],[0,"&Assign;"],[0,"&ecolon;"],[0,"&ecir;"],[0,"&circeq;"],[1,"&wedgeq;"],[0,"&veeeq;"],[1,"&triangleq;"],[2,"&equest;"],[0,"&ne;"],[0,{v:"&Congruent;",n:8421,o:"&bnequiv;"}],[0,"&nequiv;"],[1,{v:"&le;",n:8402,o:"&nvle;"}],[0,{v:"&ge;",n:8402,o:"&nvge;"}],[0,{v:"&lE;",n:824,o:"&nlE;"}],[0,{v:"&gE;",n:824,o:"&ngE;"}],[0,{v:"&lnE;",n:65024,o:"&lvertneqq;"}],[0,{v:"&gnE;",n:65024,o:"&gvertneqq;"}],[0,{v:"&ll;",n:new Map(U2([[824,"&nLtv;"],[7577,"&nLt;"]]))}],[0,{v:"&gg;",n:new Map(U2([[824,"&nGtv;"],[7577,"&nGt;"]]))}],[0,"&between;"],[0,"&NotCupCap;"],[0,"&nless;"],[0,"&ngt;"],[0,"&nle;"],[0,"&nge;"],[0,"&lesssim;"],[0,"&GreaterTilde;"],[0,"&nlsim;"],[0,"&ngsim;"],[0,"&LessGreater;"],[0,"&gl;"],[0,"&NotLessGreater;"],[0,"&NotGreaterLess;"],[0,"&pr;"],[0,"&sc;"],[0,"&prcue;"],[0,"&sccue;"],[0,"&PrecedesTilde;"],[0,{v:"&scsim;",n:824,o:"&NotSucceedsTilde;"}],[0,"&NotPrecedes;"],[0,"&NotSucceeds;"],[0,{v:"&sub;",n:8402,o:"&NotSubset;"}],[0,{v:"&sup;",n:8402,o:"&NotSuperset;"}],[0,"&nsub;"],[0,"&nsup;"],[0,"&sube;"],[0,"&supe;"],[0,"&NotSubsetEqual;"],[0,"&NotSupersetEqual;"],[0,{v:"&subne;",n:65024,o:"&varsubsetneq;"}],[0,{v:"&supne;",n:65024,o:"&varsupsetneq;"}],[1,"&cupdot;"],[0,"&UnionPlus;"],[0,{v:"&sqsub;",n:824,o:"&NotSquareSubset;"}],[0,{v:"&sqsup;",n:824,o:"&NotSquareSuperset;"}],[0,"&sqsube;"],[0,"&sqsupe;"],[0,{v:"&sqcap;",n:65024,o:"&sqcaps;"}],[0,{v:"&sqcup;",n:65024,o:"&sqcups;"}],[0,"&CirclePlus;"],[0,"&CircleMinus;"],[0,"&CircleTimes;"],[0,"&osol;"],[0,"&CircleDot;"],[0,"&circledcirc;"],[0,"&circledast;"],[1,"&circleddash;"],[0,"&boxplus;"],[0,"&boxminus;"],[0,"&boxtimes;"],[0,"&dotsquare;"],[0,"&RightTee;"],[0,"&dashv;"],[0,"&DownTee;"],[0,"&bot;"],[1,"&models;"],[0,"&DoubleRightTee;"],[0,"&Vdash;"],[0,"&Vvdash;"],[0,"&VDash;"],[0,"&nvdash;"],[0,"&nvDash;"],[0,"&nVdash;"],[0,"&nVDash;"],[0,"&prurel;"],[1,"&LeftTriangle;"],[0,"&RightTriangle;"],[0,{v:"&LeftTriangleEqual;",n:8402,o:"&nvltrie;"}],[0,{v:"&RightTriangleEqual;",n:8402,o:"&nvrtrie;"}],[0,"&origof;"],[0,"&imof;"],[0,"&multimap;"],[0,"&hercon;"],[0,"&intcal;"],[0,"&veebar;"],[1,"&barvee;"],[0,"&angrtvb;"],[0,"&lrtri;"],[0,"&bigwedge;"],[0,"&bigvee;"],[0,"&bigcap;"],[0,"&bigcup;"],[0,"&diam;"],[0,"&sdot;"],[0,"&sstarf;"],[0,"&divideontimes;"],[0,"&bowtie;"],[0,"&ltimes;"],[0,"&rtimes;"],[0,"&leftthreetimes;"],[0,"&rightthreetimes;"],[0,"&backsimeq;"],[0,"&curlyvee;"],[0,"&curlywedge;"],[0,"&Sub;"],[0,"&Sup;"],[0,"&Cap;"],[0,"&Cup;"],[0,"&fork;"],[0,"&epar;"],[0,"&lessdot;"],[0,"&gtdot;"],[0,{v:"&Ll;",n:824,o:"&nLl;"}],[0,{v:"&Gg;",n:824,o:"&nGg;"}],[0,{v:"&leg;",n:65024,o:"&lesg;"}],[0,{v:"&gel;",n:65024,o:"&gesl;"}],[2,"&cuepr;"],[0,"&cuesc;"],[0,"&NotPrecedesSlantEqual;"],[0,"&NotSucceedsSlantEqual;"],[0,"&NotSquareSubsetEqual;"],[0,"&NotSquareSupersetEqual;"],[2,"&lnsim;"],[0,"&gnsim;"],[0,"&precnsim;"],[0,"&scnsim;"],[0,"&nltri;"],[0,"&NotRightTriangle;"],[0,"&nltrie;"],[0,"&NotRightTriangleEqual;"],[0,"&vellip;"],[0,"&ctdot;"],[0,"&utdot;"],[0,"&dtdot;"],[0,"&disin;"],[0,"&isinsv;"],[0,"&isins;"],[0,{v:"&isindot;",n:824,o:"&notindot;"}],[0,"&notinvc;"],[0,"&notinvb;"],[1,{v:"&isinE;",n:824,o:"&notinE;"}],[0,"&nisd;"],[0,"&xnis;"],[0,"&nis;"],[0,"&notnivc;"],[0,"&notnivb;"],[6,"&barwed;"],[0,"&Barwed;"],[1,"&lceil;"],[0,"&rceil;"],[0,"&LeftFloor;"],[0,"&rfloor;"],[0,"&drcrop;"],[0,"&dlcrop;"],[0,"&urcrop;"],[0,"&ulcrop;"],[0,"&bnot;"],[1,"&profline;"],[0,"&profsurf;"],[1,"&telrec;"],[0,"&target;"],[5,"&ulcorn;"],[0,"&urcorn;"],[0,"&dlcorn;"],[0,"&drcorn;"],[2,"&frown;"],[0,"&smile;"],[9,"&cylcty;"],[0,"&profalar;"],[7,"&topbot;"],[6,"&ovbar;"],[1,"&solbar;"],[60,"&angzarr;"],[51,"&lmoustache;"],[0,"&rmoustache;"],[2,"&OverBracket;"],[0,"&bbrk;"],[0,"&bbrktbrk;"],[37,"&OverParenthesis;"],[0,"&UnderParenthesis;"],[0,"&OverBrace;"],[0,"&UnderBrace;"],[2,"&trpezium;"],[4,"&elinters;"],[59,"&blank;"],[164,"&circledS;"],[55,"&boxh;"],[1,"&boxv;"],[9,"&boxdr;"],[3,"&boxdl;"],[3,"&boxur;"],[3,"&boxul;"],[3,"&boxvr;"],[7,"&boxvl;"],[7,"&boxhd;"],[7,"&boxhu;"],[7,"&boxvh;"],[19,"&boxH;"],[0,"&boxV;"],[0,"&boxdR;"],[0,"&boxDr;"],[0,"&boxDR;"],[0,"&boxdL;"],[0,"&boxDl;"],[0,"&boxDL;"],[0,"&boxuR;"],[0,"&boxUr;"],[0,"&boxUR;"],[0,"&boxuL;"],[0,"&boxUl;"],[0,"&boxUL;"],[0,"&boxvR;"],[0,"&boxVr;"],[0,"&boxVR;"],[0,"&boxvL;"],[0,"&boxVl;"],[0,"&boxVL;"],[0,"&boxHd;"],[0,"&boxhD;"],[0,"&boxHD;"],[0,"&boxHu;"],[0,"&boxhU;"],[0,"&boxHU;"],[0,"&boxvH;"],[0,"&boxVh;"],[0,"&boxVH;"],[19,"&uhblk;"],[3,"&lhblk;"],[3,"&block;"],[8,"&blk14;"],[0,"&blk12;"],[0,"&blk34;"],[13,"&square;"],[8,"&blacksquare;"],[0,"&EmptyVerySmallSquare;"],[1,"&rect;"],[0,"&marker;"],[2,"&fltns;"],[1,"&bigtriangleup;"],[0,"&blacktriangle;"],[0,"&triangle;"],[2,"&blacktriangleright;"],[0,"&rtri;"],[3,"&bigtriangledown;"],[0,"&blacktriangledown;"],[0,"&dtri;"],[2,"&blacktriangleleft;"],[0,"&ltri;"],[6,"&loz;"],[0,"&cir;"],[32,"&tridot;"],[2,"&bigcirc;"],[8,"&ultri;"],[0,"&urtri;"],[0,"&lltri;"],[0,"&EmptySmallSquare;"],[0,"&FilledSmallSquare;"],[8,"&bigstar;"],[0,"&star;"],[7,"&phone;"],[49,"&female;"],[1,"&male;"],[29,"&spades;"],[2,"&clubs;"],[1,"&hearts;"],[0,"&diamondsuit;"],[3,"&sung;"],[2,"&flat;"],[0,"&natural;"],[0,"&sharp;"],[163,"&check;"],[3,"&cross;"],[8,"&malt;"],[21,"&sext;"],[33,"&VerticalSeparator;"],[25,"&lbbrk;"],[0,"&rbbrk;"],[84,"&bsolhsub;"],[0,"&suphsol;"],[28,"&LeftDoubleBracket;"],[0,"&RightDoubleBracket;"],[0,"&lang;"],[0,"&rang;"],[0,"&Lang;"],[0,"&Rang;"],[0,"&loang;"],[0,"&roang;"],[7,"&longleftarrow;"],[0,"&longrightarrow;"],[0,"&longleftrightarrow;"],[0,"&DoubleLongLeftArrow;"],[0,"&DoubleLongRightArrow;"],[0,"&DoubleLongLeftRightArrow;"],[1,"&longmapsto;"],[2,"&dzigrarr;"],[258,"&nvlArr;"],[0,"&nvrArr;"],[0,"&nvHarr;"],[0,"&Map;"],[6,"&lbarr;"],[0,"&bkarow;"],[0,"&lBarr;"],[0,"&dbkarow;"],[0,"&drbkarow;"],[0,"&DDotrahd;"],[0,"&UpArrowBar;"],[0,"&DownArrowBar;"],[2,"&Rarrtl;"],[2,"&latail;"],[0,"&ratail;"],[0,"&lAtail;"],[0,"&rAtail;"],[0,"&larrfs;"],[0,"&rarrfs;"],[0,"&larrbfs;"],[0,"&rarrbfs;"],[2,"&nwarhk;"],[0,"&nearhk;"],[0,"&hksearow;"],[0,"&hkswarow;"],[0,"&nwnear;"],[0,"&nesear;"],[0,"&seswar;"],[0,"&swnwar;"],[8,{v:"&rarrc;",n:824,o:"&nrarrc;"}],[1,"&cudarrr;"],[0,"&ldca;"],[0,"&rdca;"],[0,"&cudarrl;"],[0,"&larrpl;"],[2,"&curarrm;"],[0,"&cularrp;"],[7,"&rarrpl;"],[2,"&harrcir;"],[0,"&Uarrocir;"],[0,"&lurdshar;"],[0,"&ldrushar;"],[2,"&LeftRightVector;"],[0,"&RightUpDownVector;"],[0,"&DownLeftRightVector;"],[0,"&LeftUpDownVector;"],[0,"&LeftVectorBar;"],[0,"&RightVectorBar;"],[0,"&RightUpVectorBar;"],[0,"&RightDownVectorBar;"],[0,"&DownLeftVectorBar;"],[0,"&DownRightVectorBar;"],[0,"&LeftUpVectorBar;"],[0,"&LeftDownVectorBar;"],[0,"&LeftTeeVector;"],[0,"&RightTeeVector;"],[0,"&RightUpTeeVector;"],[0,"&RightDownTeeVector;"],[0,"&DownLeftTeeVector;"],[0,"&DownRightTeeVector;"],[0,"&LeftUpTeeVector;"],[0,"&LeftDownTeeVector;"],[0,"&lHar;"],[0,"&uHar;"],[0,"&rHar;"],[0,"&dHar;"],[0,"&luruhar;"],[0,"&ldrdhar;"],[0,"&ruluhar;"],[0,"&rdldhar;"],[0,"&lharul;"],[0,"&llhard;"],[0,"&rharul;"],[0,"&lrhard;"],[0,"&udhar;"],[0,"&duhar;"],[0,"&RoundImplies;"],[0,"&erarr;"],[0,"&simrarr;"],[0,"&larrsim;"],[0,"&rarrsim;"],[0,"&rarrap;"],[0,"&ltlarr;"],[1,"&gtrarr;"],[0,"&subrarr;"],[1,"&suplarr;"],[0,"&lfisht;"],[0,"&rfisht;"],[0,"&ufisht;"],[0,"&dfisht;"],[5,"&lopar;"],[0,"&ropar;"],[4,"&lbrke;"],[0,"&rbrke;"],[0,"&lbrkslu;"],[0,"&rbrksld;"],[0,"&lbrksld;"],[0,"&rbrkslu;"],[0,"&langd;"],[0,"&rangd;"],[0,"&lparlt;"],[0,"&rpargt;"],[0,"&gtlPar;"],[0,"&ltrPar;"],[3,"&vzigzag;"],[1,"&vangrt;"],[0,"&angrtvbd;"],[6,"&ange;"],[0,"&range;"],[0,"&dwangle;"],[0,"&uwangle;"],[0,"&angmsdaa;"],[0,"&angmsdab;"],[0,"&angmsdac;"],[0,"&angmsdad;"],[0,"&angmsdae;"],[0,"&angmsdaf;"],[0,"&angmsdag;"],[0,"&angmsdah;"],[0,"&bemptyv;"],[0,"&demptyv;"],[0,"&cemptyv;"],[0,"&raemptyv;"],[0,"&laemptyv;"],[0,"&ohbar;"],[0,"&omid;"],[0,"&opar;"],[1,"&operp;"],[1,"&olcross;"],[0,"&odsold;"],[1,"&olcir;"],[0,"&ofcir;"],[0,"&olt;"],[0,"&ogt;"],[0,"&cirscir;"],[0,"&cirE;"],[0,"&solb;"],[0,"&bsolb;"],[3,"&boxbox;"],[3,"&trisb;"],[0,"&rtriltri;"],[0,{v:"&LeftTriangleBar;",n:824,o:"&NotLeftTriangleBar;"}],[0,{v:"&RightTriangleBar;",n:824,o:"&NotRightTriangleBar;"}],[11,"&iinfin;"],[0,"&infintie;"],[0,"&nvinfin;"],[4,"&eparsl;"],[0,"&smeparsl;"],[0,"&eqvparsl;"],[5,"&blacklozenge;"],[8,"&RuleDelayed;"],[1,"&dsol;"],[9,"&bigodot;"],[0,"&bigoplus;"],[0,"&bigotimes;"],[1,"&biguplus;"],[1,"&bigsqcup;"],[5,"&iiiint;"],[0,"&fpartint;"],[2,"&cirfnint;"],[0,"&awint;"],[0,"&rppolint;"],[0,"&scpolint;"],[0,"&npolint;"],[0,"&pointint;"],[0,"&quatint;"],[0,"&intlarhk;"],[10,"&pluscir;"],[0,"&plusacir;"],[0,"&simplus;"],[0,"&plusdu;"],[0,"&plussim;"],[0,"&plustwo;"],[1,"&mcomma;"],[0,"&minusdu;"],[2,"&loplus;"],[0,"&roplus;"],[0,"&Cross;"],[0,"&timesd;"],[0,"&timesbar;"],[1,"&smashp;"],[0,"&lotimes;"],[0,"&rotimes;"],[0,"&otimesas;"],[0,"&Otimes;"],[0,"&odiv;"],[0,"&triplus;"],[0,"&triminus;"],[0,"&tritime;"],[0,"&intprod;"],[2,"&amalg;"],[0,"&capdot;"],[1,"&ncup;"],[0,"&ncap;"],[0,"&capand;"],[0,"&cupor;"],[0,"&cupcap;"],[0,"&capcup;"],[0,"&cupbrcap;"],[0,"&capbrcup;"],[0,"&cupcup;"],[0,"&capcap;"],[0,"&ccups;"],[0,"&ccaps;"],[2,"&ccupssm;"],[2,"&And;"],[0,"&Or;"],[0,"&andand;"],[0,"&oror;"],[0,"&orslope;"],[0,"&andslope;"],[1,"&andv;"],[0,"&orv;"],[0,"&andd;"],[0,"&ord;"],[1,"&wedbar;"],[6,"&sdote;"],[3,"&simdot;"],[2,{v:"&congdot;",n:824,o:"&ncongdot;"}],[0,"&easter;"],[0,"&apacir;"],[0,{v:"&apE;",n:824,o:"&napE;"}],[0,"&eplus;"],[0,"&pluse;"],[0,"&Esim;"],[0,"&Colone;"],[0,"&Equal;"],[1,"&ddotseq;"],[0,"&equivDD;"],[0,"&ltcir;"],[0,"&gtcir;"],[0,"&ltquest;"],[0,"&gtquest;"],[0,{v:"&leqslant;",n:824,o:"&nleqslant;"}],[0,{v:"&geqslant;",n:824,o:"&ngeqslant;"}],[0,"&lesdot;"],[0,"&gesdot;"],[0,"&lesdoto;"],[0,"&gesdoto;"],[0,"&lesdotor;"],[0,"&gesdotol;"],[0,"&lap;"],[0,"&gap;"],[0,"&lne;"],[0,"&gne;"],[0,"&lnap;"],[0,"&gnap;"],[0,"&lEg;"],[0,"&gEl;"],[0,"&lsime;"],[0,"&gsime;"],[0,"&lsimg;"],[0,"&gsiml;"],[0,"&lgE;"],[0,"&glE;"],[0,"&lesges;"],[0,"&gesles;"],[0,"&els;"],[0,"&egs;"],[0,"&elsdot;"],[0,"&egsdot;"],[0,"&el;"],[0,"&eg;"],[2,"&siml;"],[0,"&simg;"],[0,"&simlE;"],[0,"&simgE;"],[0,{v:"&LessLess;",n:824,o:"&NotNestedLessLess;"}],[0,{v:"&GreaterGreater;",n:824,o:"&NotNestedGreaterGreater;"}],[1,"&glj;"],[0,"&gla;"],[0,"&ltcc;"],[0,"&gtcc;"],[0,"&lescc;"],[0,"&gescc;"],[0,"&smt;"],[0,"&lat;"],[0,{v:"&smte;",n:65024,o:"&smtes;"}],[0,{v:"&late;",n:65024,o:"&lates;"}],[0,"&bumpE;"],[0,{v:"&PrecedesEqual;",n:824,o:"&NotPrecedesEqual;"}],[0,{v:"&sce;",n:824,o:"&NotSucceedsEqual;"}],[2,"&prE;"],[0,"&scE;"],[0,"&precneqq;"],[0,"&scnE;"],[0,"&prap;"],[0,"&scap;"],[0,"&precnapprox;"],[0,"&scnap;"],[0,"&Pr;"],[0,"&Sc;"],[0,"&subdot;"],[0,"&supdot;"],[0,"&subplus;"],[0,"&supplus;"],[0,"&submult;"],[0,"&supmult;"],[0,"&subedot;"],[0,"&supedot;"],[0,{v:"&subE;",n:824,o:"&nsubE;"}],[0,{v:"&supE;",n:824,o:"&nsupE;"}],[0,"&subsim;"],[0,"&supsim;"],[2,{v:"&subnE;",n:65024,o:"&varsubsetneqq;"}],[0,{v:"&supnE;",n:65024,o:"&varsupsetneqq;"}],[2,"&csub;"],[0,"&csup;"],[0,"&csube;"],[0,"&csupe;"],[0,"&subsup;"],[0,"&supsub;"],[0,"&subsub;"],[0,"&supsup;"],[0,"&suphsub;"],[0,"&supdsub;"],[0,"&forkv;"],[0,"&topfork;"],[0,"&mlcp;"],[8,"&Dashv;"],[1,"&Vdashl;"],[0,"&Barv;"],[0,"&vBar;"],[0,"&vBarv;"],[1,"&Vbar;"],[0,"&Not;"],[0,"&bNot;"],[0,"&rnmid;"],[0,"&cirmid;"],[0,"&midcir;"],[0,"&topcir;"],[0,"&nhpar;"],[0,"&parsim;"],[9,{v:"&parsl;",n:8421,o:"&nparsl;"}],[44343,{n:new Map(U2([[56476,"&Ascr;"],[1,"&Cscr;"],[0,"&Dscr;"],[2,"&Gscr;"],[2,"&Jscr;"],[0,"&Kscr;"],[2,"&Nscr;"],[0,"&Oscr;"],[0,"&Pscr;"],[0,"&Qscr;"],[1,"&Sscr;"],[0,"&Tscr;"],[0,"&Uscr;"],[0,"&Vscr;"],[0,"&Wscr;"],[0,"&Xscr;"],[0,"&Yscr;"],[0,"&Zscr;"],[0,"&ascr;"],[0,"&bscr;"],[0,"&cscr;"],[0,"&dscr;"],[1,"&fscr;"],[1,"&hscr;"],[0,"&iscr;"],[0,"&jscr;"],[0,"&kscr;"],[0,"&lscr;"],[0,"&mscr;"],[0,"&nscr;"],[1,"&pscr;"],[0,"&qscr;"],[0,"&rscr;"],[0,"&sscr;"],[0,"&tscr;"],[0,"&uscr;"],[0,"&vscr;"],[0,"&wscr;"],[0,"&xscr;"],[0,"&yscr;"],[0,"&zscr;"],[52,"&Afr;"],[0,"&Bfr;"],[1,"&Dfr;"],[0,"&Efr;"],[0,"&Ffr;"],[0,"&Gfr;"],[2,"&Jfr;"],[0,"&Kfr;"],[0,"&Lfr;"],[0,"&Mfr;"],[0,"&Nfr;"],[0,"&Ofr;"],[0,"&Pfr;"],[0,"&Qfr;"],[1,"&Sfr;"],[0,"&Tfr;"],[0,"&Ufr;"],[0,"&Vfr;"],[0,"&Wfr;"],[0,"&Xfr;"],[0,"&Yfr;"],[1,"&afr;"],[0,"&bfr;"],[0,"&cfr;"],[0,"&dfr;"],[0,"&efr;"],[0,"&ffr;"],[0,"&gfr;"],[0,"&hfr;"],[0,"&ifr;"],[0,"&jfr;"],[0,"&kfr;"],[0,"&lfr;"],[0,"&mfr;"],[0,"&nfr;"],[0,"&ofr;"],[0,"&pfr;"],[0,"&qfr;"],[0,"&rfr;"],[0,"&sfr;"],[0,"&tfr;"],[0,"&ufr;"],[0,"&vfr;"],[0,"&wfr;"],[0,"&xfr;"],[0,"&yfr;"],[0,"&zfr;"],[0,"&Aopf;"],[0,"&Bopf;"],[1,"&Dopf;"],[0,"&Eopf;"],[0,"&Fopf;"],[0,"&Gopf;"],[1,"&Iopf;"],[0,"&Jopf;"],[0,"&Kopf;"],[0,"&Lopf;"],[0,"&Mopf;"],[1,"&Oopf;"],[3,"&Sopf;"],[0,"&Topf;"],[0,"&Uopf;"],[0,"&Vopf;"],[0,"&Wopf;"],[0,"&Xopf;"],[0,"&Yopf;"],[1,"&aopf;"],[0,"&bopf;"],[0,"&copf;"],[0,"&dopf;"],[0,"&eopf;"],[0,"&fopf;"],[0,"&gopf;"],[0,"&hopf;"],[0,"&iopf;"],[0,"&jopf;"],[0,"&kopf;"],[0,"&lopf;"],[0,"&mopf;"],[0,"&nopf;"],[0,"&oopf;"],[0,"&popf;"],[0,"&qopf;"],[0,"&ropf;"],[0,"&sopf;"],[0,"&topf;"],[0,"&uopf;"],[0,"&vopf;"],[0,"&wopf;"],[0,"&xopf;"],[0,"&yopf;"],[0,"&zopf;"]]))}],[8906,"&fflig;"],[0,"&filig;"],[0,"&fllig;"],[0,"&ffilig;"],[0,"&ffllig;"]]));var x5=/["&'<>$\x80-\uFFFF]/g,VV=new Map([[34,"&quot;"],[38,"&amp;"],[39,"&apos;"],[60,"&lt;"],[62,"&gt;"]]),GV=String.prototype.codePointAt!=null?(n,e)=>n.codePointAt(e):(n,e)=>(n.charCodeAt(e)&64512)===55296?(n.charCodeAt(e)-55296)*1024+n.charCodeAt(e+1)-56320+65536:n.charCodeAt(e);function dg(n){let e="",t=0,i;for(;(i=x5.exec(n))!==null;){let r=i.index,s=n.charCodeAt(r),o=VV.get(s);o!==void 0?(e+=n.substring(t,r)+o,t=r+1):(e+=`${n.substring(t,r)}&#x${GV(n,r).toString(16)};`,t=x5.lastIndex+=+((s&64512)===55296))}return e+n.substr(t)}function b5(n,e){return function(i){let r,s=0,o="";for(;r=n.exec(i);)s!==r.index&&(o+=i.substring(s,r.index)),o+=e.get(r[0].charCodeAt(0)),s=r.index+1;return o+i.substring(s)}}var HV=b5(/[&<>'"]/g,VV),V2=b5(/["&\u00A0]/g,new Map([[34,"&quot;"],[38,"&amp;"],[160,"&nbsp;"]])),G2=b5(/[&<>\u00A0]/g,new Map([[38,"&amp;"],[60,"&lt;"],[62,"&gt;"],[160,"&nbsp;"]]));var WV;(function(n){n[n.XML=0]="XML",n[n.HTML=1]="HTML"})(WV||(WV={}));var qV;(function(n){n[n.UTF8=0]="UTF8",n[n.ASCII=1]="ASCII",n[n.Extensive=2]="Extensive",n[n.Attribute=3]="Attribute",n[n.Text=4]="Text"})(qV||(qV={}));var JV=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(n=>[n.toLowerCase(),n])),QV=new Map(["definitionURL","attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(n=>[n.toLowerCase(),n]));var pTt=new Set(["style","script","xmp","iframe","noembed","noframes","plaintext","noscript"]);function hTt(n){return n.replace(/"/g,"&quot;")}function dTt(n,e){var t;if(!n)return;let i=((t=e.encodeEntities)!==null&&t!==void 0?t:e.decodeEntities)===!1?hTt:e.xmlMode||e.encodeEntities!=="utf8"?dg:V2;return Object.keys(n).map(r=>{var s,o;let a=(s=n[r])!==null&&s!==void 0?s:"";return e.xmlMode==="foreign"&&(r=(o=QV.get(r))!==null&&o!==void 0?o:r),!e.emptyAttrs&&!e.xmlMode&&a===""?r:`${r}="${i(a)}"`}).join(" ")}var tG=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]);function w5(n,e={}){let t="length"in n?n:[n],i="";for(let r=0;r<t.length;r++)i+=fTt(t[r],e);return i}var eG=w5;function fTt(n,e){switch(n.type){case AV:return w5(n.children,e);case jV:case OV:return gTt(n);case LV:return vTt(n);case DV:return bTt(n);case FV:case zV:case $V:return yTt(n,e);case RV:return xTt(n,e)}}var mTt=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignObject","desc","title"]),_Tt=new Set(["svg","math"]);function yTt(n,e){var t;e.xmlMode==="foreign"&&(n.name=(t=JV.get(n.name))!==null&&t!==void 0?t:n.name,n.parent&&mTt.has(n.parent.name)&&(e={...e,xmlMode:!1})),!e.xmlMode&&_Tt.has(n.name)&&(e={...e,xmlMode:"foreign"});let i=`<${n.name}`,r=dTt(n.attribs,e);return r&&(i+=` ${r}`),n.children.length===0&&(e.xmlMode?e.selfClosingTags!==!1:e.selfClosingTags&&tG.has(n.name))?(e.xmlMode||(i+=" "),i+="/>"):(i+=">",n.children.length>0&&(i+=w5(n.children,e)),(e.xmlMode||!tG.has(n.name))&&(i+=`</${n.name}>`)),i}function gTt(n){return`<${n.data}>`}function xTt(n,e){var t;let i=n.data||"";return((t=e.encodeEntities)!==null&&t!==void 0?t:e.decodeEntities)!==!1&&!(!e.xmlMode&&n.parent&&pTt.has(n.parent.name))&&(i=e.xmlMode||e.encodeEntities!=="utf8"?dg(i):G2(i)),i}function bTt(n){return`<![CDATA[${n.children[0].data}]]>`}function vTt(n){return`<!--${n.data}-->`}function nG(n,e){return eG(n,e)}function STt(n,e){return fr(n)?n.children.map(t=>nG(t,e)).join(""):""}function H2(n){return Array.isArray(n)?n.map(H2).join(""):er(n)?n.name==="br"?`
`:H2(n.children):hg(n)?H2(n.children):Ea(n)?n.data:""}function fg(n){return Array.isArray(n)?n.map(fg).join(""):fr(n)&&!Y2(n)?fg(n.children):Ea(n)?n.data:""}function P5(n){return Array.isArray(n)?n.map(P5).join(""):fr(n)&&(n.type===ri.Tag||hg(n))?P5(n.children):Ea(n)?n.data:""}function iG(n){return fr(n)?n.children:[]}function rG(n){return n.parent||null}function wTt(n){let e=rG(n);if(e!=null)return iG(e);let t=[n],{prev:i,next:r}=n;for(;i!=null;)t.unshift(i),{prev:i}=i;for(;r!=null;)t.push(r),{next:r}=r;return t}function PTt(n,e){var t;return(t=n.attribs)===null||t===void 0?void 0:t[e]}function kTt(n,e){return n.attribs!=null&&Object.prototype.hasOwnProperty.call(n.attribs,e)&&n.attribs[e]!=null}function TTt(n){return n.name}function ETt(n){let{next:e}=n;for(;e!==null&&!er(e);)({next:e}=e);return e}function MTt(n){let{prev:e}=n;for(;e!==null&&!er(e);)({prev:e}=e);return e}function mg(n){if(n.prev&&(n.prev.next=n.next),n.next&&(n.next.prev=n.prev),n.parent){let e=n.parent.children,t=e.lastIndexOf(n);t>=0&&e.splice(t,1)}n.next=null,n.prev=null,n.parent=null}function CTt(n,e){let t=e.prev=n.prev;t&&(t.next=e);let i=e.next=n.next;i&&(i.prev=e);let r=e.parent=n.parent;if(r){let s=r.children;s[s.lastIndexOf(n)]=e,n.parent=null}}function ITt(n,e){if(mg(e),e.next=null,e.parent=n,n.children.push(e)>1){let t=n.children[n.children.length-2];t.next=e,e.prev=t}else e.prev=null}function NTt(n,e){mg(e);let{parent:t}=n,i=n.next;if(e.next=i,e.prev=n,n.next=e,e.parent=t,i){if(i.prev=e,t){let r=t.children;r.splice(r.lastIndexOf(i),0,e)}}else t&&t.children.push(e)}function ATt(n,e){if(mg(e),e.parent=n,e.prev=null,n.children.unshift(e)!==1){let t=n.children[1];t.prev=e,e.next=t}else e.next=null}function RTt(n,e){mg(e);let{parent:t}=n;if(t){let i=t.children;i.splice(i.indexOf(n),0,e)}n.prev&&(n.prev.next=e),e.parent=t,e.prev=n.prev,e.next=n,n.prev=e}function qm(n,e,t=!0,i=1/0){return sG(n,Array.isArray(e)?e:[e],t,i)}function sG(n,e,t,i){let r=[],s=[Array.isArray(e)?e:[e]],o=[0];for(;;){if(o[0]>=s[0].length){if(o.length===1)return r;s.shift(),o.shift();continue}let a=s[0][o[0]++];if(n(a)&&(r.push(a),--i<=0))return r;t&&fr(a)&&a.children.length>0&&(o.unshift(0),s.unshift(a.children))}}function OTt(n,e){return e.find(n)}function W2(n,e,t=!0){let i=Array.isArray(e)?e:[e];for(let r=0;r<i.length;r++){let s=i[r];if(er(s)&&n(s))return s;if(t&&fr(s)&&s.children.length>0){let o=W2(n,s.children,!0);if(o)return o}}return null}function oG(n,e){return(Array.isArray(e)?e:[e]).some(t=>er(t)&&n(t)||fr(t)&&oG(n,t.children))}function LTt(n,e){let t=[],i=[Array.isArray(e)?e:[e]],r=[0];for(;;){if(r[0]>=i[0].length){if(i.length===1)return t;i.shift(),r.shift();continue}let s=i[0][r[0]++];er(s)&&n(s)&&t.push(s),fr(s)&&s.children.length>0&&(r.unshift(0),i.unshift(s.children))}}var q2={tag_name(n){return typeof n=="function"?e=>er(e)&&n(e.name):n==="*"?er:e=>er(e)&&e.name===n},tag_type(n){return typeof n=="function"?e=>n(e.type):e=>e.type===n},tag_contains(n){return typeof n=="function"?e=>Ea(e)&&n(e.data):e=>Ea(e)&&e.data===n}};function k5(n,e){return typeof e=="function"?t=>er(t)&&e(t.attribs[n]):t=>er(t)&&t.attribs[n]===e}function FTt(n,e){return t=>n(t)||e(t)}function aG(n){let e=Object.keys(n).map(t=>{let i=n[t];return Object.prototype.hasOwnProperty.call(q2,t)?q2[t](i):k5(t,i)});return e.length===0?null:e.reduce(FTt)}function zTt(n,e){let t=aG(n);return t?t(e):!0}function $Tt(n,e,t,i=1/0){let r=aG(n);return r?qm(r,e,t,i):[]}function DTt(n,e,t=!0){return Array.isArray(e)||(e=[e]),W2(k5("id",n),e,t)}function Gh(n,e,t=!0,i=1/0){return qm(q2.tag_name(n),e,t,i)}function jTt(n,e,t=!0,i=1/0){return qm(k5("class",n),e,t,i)}function BTt(n,e,t=!0,i=1/0){return qm(q2.tag_type(n),e,t,i)}function YTt(n){let e=n.length;for(;--e>=0;){let t=n[e];if(e>0&&n.lastIndexOf(t,e-1)>=0){n.splice(e,1);continue}for(let i=t.parent;i;i=i.parent)if(n.includes(i)){n.splice(e,1);break}}return n}var Es;(function(n){n[n.DISCONNECTED=1]="DISCONNECTED",n[n.PRECEDING=2]="PRECEDING",n[n.FOLLOWING=4]="FOLLOWING",n[n.CONTAINS=8]="CONTAINS",n[n.CONTAINED_BY=16]="CONTAINED_BY"})(Es||(Es={}));function cG(n,e){let t=[],i=[];if(n===e)return 0;let r=fr(n)?n:n.parent;for(;r;)t.unshift(r),r=r.parent;for(r=fr(e)?e:e.parent;r;)i.unshift(r),r=r.parent;let s=Math.min(t.length,i.length),o=0;for(;o<s&&t[o]===i[o];)o++;if(o===0)return Es.DISCONNECTED;let a=t[o-1],c=a.children,l=t[o],u=i[o];return c.indexOf(l)>c.indexOf(u)?a===e?Es.FOLLOWING|Es.CONTAINED_BY:Es.FOLLOWING:a===n?Es.PRECEDING|Es.CONTAINS:Es.PRECEDING}function XTt(n){return n=n.filter((e,t,i)=>!i.includes(e,t+1)),n.sort((e,t)=>{let i=cG(e,t);return i&Es.PRECEDING?-1:i&Es.FOLLOWING?1:0}),n}function UTt(n){let e=Z2(qTt,n);return e?e.name==="feed"?VTt(e):GTt(e):null}function VTt(n){var e;let t=n.children,i={type:"atom",items:Gh("entry",t).map(o=>{var a;let{children:c}=o,l={media:lG(c)};Dr(l,"id","id",c),Dr(l,"title","title",c);let u=(a=Z2("link",c))===null||a===void 0?void 0:a.attribs.href;u&&(l.link=u);let p=Yc("summary",c)||Yc("content",c);p&&(l.description=p);let f=Yc("updated",c);return f&&(l.pubDate=new Date(f)),l})};Dr(i,"id","id",t),Dr(i,"title","title",t);let r=(e=Z2("link",t))===null||e===void 0?void 0:e.attribs.href;r&&(i.link=r),Dr(i,"description","subtitle",t);let s=Yc("updated",t);return s&&(i.updated=new Date(s)),Dr(i,"author","email",t,!0),i}function GTt(n){var e,t;let i=(t=(e=Z2("channel",n.children))===null||e===void 0?void 0:e.children)!==null&&t!==void 0?t:[],r={type:n.name.substr(0,3),id:"",items:Gh("item",n.children).map(o=>{let{children:a}=o,c={media:lG(a)};Dr(c,"id","guid",a),Dr(c,"title","title",a),Dr(c,"link","link",a),Dr(c,"description","description",a);let l=Yc("pubDate",a)||Yc("dc:date",a);return l&&(c.pubDate=new Date(l)),c})};Dr(r,"title","title",i),Dr(r,"link","link",i),Dr(r,"description","description",i);let s=Yc("lastBuildDate",i);return s&&(r.updated=new Date(s)),Dr(r,"author","managingEditor",i,!0),r}var HTt=["url","type","lang"],WTt=["fileSize","bitrate","framerate","samplingrate","channels","duration","height","width"];function lG(n){return Gh("media:content",n).map(e=>{let{attribs:t}=e,i={medium:t.medium,isDefault:!!t.isDefault};for(let r of HTt)t[r]&&(i[r]=t[r]);for(let r of WTt)t[r]&&(i[r]=parseInt(t[r],10));return t.expression&&(i.expression=t.expression),i})}function Z2(n,e){return Gh(n,e,!0,1)[0]}function Yc(n,e,t=!1){return fg(Gh(n,e,t,1)).trim()}function Dr(n,e,t,i,r=!1){let s=Yc(t,i,r);s&&(n[e]=s)}function qTt(n){return n==="rss"||n==="feed"||n==="rdf:RDF"}var $5=Gt(Hh(),1);var de;(function(n){n.Attribute="attribute",n.Pseudo="pseudo",n.PseudoElement="pseudo-element",n.Tag="tag",n.Universal="universal",n.Adjacent="adjacent",n.Child="child",n.Descendant="descendant",n.Parent="parent",n.Sibling="sibling",n.ColumnCombinator="column-combinator"})(de||(de={}));var di;(function(n){n.Any="any",n.Element="element",n.End="end",n.Equals="equals",n.Exists="exists",n.Hyphen="hyphen",n.Not="not",n.Start="start"})(di||(di={}));var pG=/^[^\\#]?(?:\\(?:[\da-f]{1,6}\s?|.)|[\w\-\u00b0-\uFFFF])+/,ZTt=/\\([\da-f]{1,6}\s?|(\s)|.)/gi,KTt=new Map([[126,di.Element],[94,di.Start],[36,di.End],[42,di.Any],[33,di.Not],[124,di.Hyphen]]),JTt=new Set(["has","not","matches","is","where","host","host-context"]);function dG(n){switch(n.type){case de.Adjacent:case de.Child:case de.Descendant:case de.Parent:case de.Sibling:case de.ColumnCombinator:return!0;default:return!1}}var QTt=new Set(["contains","icontains"]);function t3t(n,e,t){let i=parseInt(e,16)-65536;return i!==i||t?e:i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,i&1023|56320)}function _g(n){return n.replace(ZTt,t3t)}function T5(n){return n===39||n===34}function hG(n){return n===32||n===9||n===10||n===12||n===13}function yg(n){let e=[],t=fG(e,`${n}`,0);if(t<n.length)throw new Error(`Unmatched selector: ${n.slice(t)}`);return e}function fG(n,e,t){let i=[];function r(f){let y=e.slice(t+f).match(pG);if(!y)throw new Error(`Expected name, found ${e.slice(t)}`);let[g]=y;return t+=f+g.length,_g(g)}function s(f){for(t+=f;t<e.length&&hG(e.charCodeAt(t));)t++}function o(){t+=1;let f=t,y=1;for(;y>0&&t<e.length;t++)e.charCodeAt(t)===40&&!a(t)?y++:e.charCodeAt(t)===41&&!a(t)&&y--;if(y)throw new Error("Parenthesis not matched");return _g(e.slice(f,t-1))}function a(f){let y=0;for(;e.charCodeAt(--f)===92;)y++;return(y&1)===1}function c(){if(i.length>0&&dG(i[i.length-1]))throw new Error("Did not expect successive traversals.")}function l(f){if(i.length>0&&i[i.length-1].type===de.Descendant){i[i.length-1].type=f;return}c(),i.push({type:f})}function u(f,y){i.push({type:de.Attribute,name:f,action:y,value:r(1),namespace:null,ignoreCase:"quirks"})}function p(){if(i.length&&i[i.length-1].type===de.Descendant&&i.pop(),i.length===0)throw new Error("Empty sub-selector");n.push(i)}if(s(0),e.length===t)return t;t:for(;t<e.length;){let f=e.charCodeAt(t);switch(f){case 32:case 9:case 10:case 12:case 13:{(i.length===0||i[0].type!==de.Descendant)&&(c(),i.push({type:de.Descendant})),s(1);break}case 62:{l(de.Child),s(1);break}case 60:{l(de.Parent),s(1);break}case 126:{l(de.Sibling),s(1);break}case 43:{l(de.Adjacent),s(1);break}case 46:{u("class",di.Element);break}case 35:{u("id",di.Equals);break}case 91:{s(1);let y,g=null;e.charCodeAt(t)===124?y=r(1):e.startsWith("*|",t)?(g="*",y=r(2)):(y=r(0),e.charCodeAt(t)===124&&e.charCodeAt(t+1)!==61&&(g=y,y=r(1))),s(0);let x=di.Exists,v=KTt.get(e.charCodeAt(t));if(v){if(x=v,e.charCodeAt(t+1)!==61)throw new Error("Expected `=`");s(2)}else e.charCodeAt(t)===61&&(x=di.Equals,s(1));let P="",w=null;if(x!=="exists"){if(T5(e.charCodeAt(t))){let I=e.charCodeAt(t),E=t+1;for(;E<e.length&&(e.charCodeAt(E)!==I||a(E));)E+=1;if(e.charCodeAt(E)!==I)throw new Error("Attribute value didn't end");P=_g(e.slice(t+1,E)),t=E+1}else{let I=t;for(;t<e.length&&(!hG(e.charCodeAt(t))&&e.charCodeAt(t)!==93||a(t));)t+=1;P=_g(e.slice(I,t))}s(0);let T=e.charCodeAt(t)|32;T===115?(w=!1,s(1)):T===105&&(w=!0,s(1))}if(e.charCodeAt(t)!==93)throw new Error("Attribute selector didn't terminate");t+=1;let k={type:de.Attribute,name:y,action:x,value:P,namespace:g,ignoreCase:w};i.push(k);break}case 58:{if(e.charCodeAt(t+1)===58){i.push({type:de.PseudoElement,name:r(2).toLowerCase(),data:e.charCodeAt(t)===40?o():null});continue}let y=r(1).toLowerCase(),g=null;if(e.charCodeAt(t)===40)if(JTt.has(y)){if(T5(e.charCodeAt(t+1)))throw new Error(`Pseudo-selector ${y} cannot be quoted`);if(g=[],t=fG(g,e,t+1),e.charCodeAt(t)!==41)throw new Error(`Missing closing parenthesis in :${y} (${e})`);t+=1}else{if(g=o(),QTt.has(y)){let x=g.charCodeAt(0);x===g.charCodeAt(g.length-1)&&T5(x)&&(g=g.slice(1,-1))}g=_g(g)}i.push({type:de.Pseudo,name:y,data:g});break}case 44:{p(),i=[],s(1);break}default:{if(e.startsWith("/*",t)){let x=e.indexOf("*/",t+2);if(x<0)throw new Error("Comment was not terminated");t=x+2,i.length===0&&s(0);break}let y=null,g;if(f===42)t+=1,g="*";else if(f===124){if(g="",e.charCodeAt(t+1)===124){l(de.ColumnCombinator),s(2);break}}else if(pG.test(e.slice(t)))g=r(0);else break t;e.charCodeAt(t)===124&&e.charCodeAt(t+1)!==124&&(y=g,e.charCodeAt(t+1)===42?(g="*",t+=2):g=r(1)),i.push(g==="*"?{type:de.Universal,namespace:y}:{type:de.Tag,name:g,namespace:y})}}}return p(),t}var Ca=Gt(Hh(),1);var mG=new Map([[de.Universal,50],[de.Tag,30],[de.Attribute,1],[de.Pseudo,0]]);function gg(n){return!mG.has(n.type)}var e3t=new Map([[di.Exists,10],[di.Equals,8],[di.Not,7],[di.Start,6],[di.End,6],[di.Any,5]]);function E5(n){let e=n.map(_G);for(let t=1;t<n.length;t++){let i=e[t];if(!(i<0))for(let r=t-1;r>=0&&i<e[r];r--){let s=n[r+1];n[r+1]=n[r],n[r]=s,e[r+1]=e[r],e[r]=i}}}function _G(n){var e,t;let i=(e=mG.get(n.type))!==null&&e!==void 0?e:-1;return n.type===de.Attribute?(i=(t=e3t.get(n.action))!==null&&t!==void 0?t:4,n.action===di.Equals&&n.name==="id"&&(i=9),n.ignoreCase&&(i>>=1)):n.type===de.Pseudo&&(n.data?n.name==="has"||n.name==="contains"?i=0:Array.isArray(n.data)?(i=Math.min(...n.data.map(r=>Math.min(...r.map(_G)))),i<0&&(i=0)):i=2:i=3),i}var xg=Gt(Hh(),1),n3t=/[-[\]{}()*+?.,\\^$|#\s]/g;function yG(n){return n.replace(n3t,"\\$&")}var i3t=new Set(["accept","accept-charset","align","alink","axis","bgcolor","charset","checked","clear","codetype","color","compact","declare","defer","dir","direction","disabled","enctype","face","frame","hreflang","http-equiv","lang","language","link","media","method","multiple","nohref","noresize","noshade","nowrap","readonly","rel","rev","rules","scope","scrolling","selected","shape","target","text","type","valign","valuetype","vlink"]);function Wh(n,e){return typeof n.ignoreCase=="boolean"?n.ignoreCase:n.ignoreCase==="quirks"?!!e.quirksMode:!e.xmlMode&&i3t.has(n.name)}var gG={equals(n,e,t){let{adapter:i}=t,{name:r}=e,{value:s}=e;return Wh(e,t)?(s=s.toLowerCase(),o=>{let a=i.getAttributeValue(o,r);return a!=null&&a.length===s.length&&a.toLowerCase()===s&&n(o)}):o=>i.getAttributeValue(o,r)===s&&n(o)},hyphen(n,e,t){let{adapter:i}=t,{name:r}=e,{value:s}=e,o=s.length;return Wh(e,t)?(s=s.toLowerCase(),function(c){let l=i.getAttributeValue(c,r);return l!=null&&(l.length===o||l.charAt(o)==="-")&&l.substr(0,o).toLowerCase()===s&&n(c)}):function(c){let l=i.getAttributeValue(c,r);return l!=null&&(l.length===o||l.charAt(o)==="-")&&l.substr(0,o)===s&&n(c)}},element(n,e,t){let{adapter:i}=t,{name:r,value:s}=e;if(/\s/.test(s))return xg.default.falseFunc;let o=new RegExp(`(?:^|\\s)${yG(s)}(?:$|\\s)`,Wh(e,t)?"i":"");return function(c){let l=i.getAttributeValue(c,r);return l!=null&&l.length>=s.length&&o.test(l)&&n(c)}},exists(n,{name:e},{adapter:t}){return i=>t.hasAttrib(i,e)&&n(i)},start(n,e,t){let{adapter:i}=t,{name:r}=e,{value:s}=e,o=s.length;return o===0?xg.default.falseFunc:Wh(e,t)?(s=s.toLowerCase(),a=>{let c=i.getAttributeValue(a,r);return c!=null&&c.length>=o&&c.substr(0,o).toLowerCase()===s&&n(a)}):a=>{var c;return!!(!((c=i.getAttributeValue(a,r))===null||c===void 0)&&c.startsWith(s))&&n(a)}},end(n,e,t){let{adapter:i}=t,{name:r}=e,{value:s}=e,o=-s.length;return o===0?xg.default.falseFunc:Wh(e,t)?(s=s.toLowerCase(),a=>{var c;return((c=i.getAttributeValue(a,r))===null||c===void 0?void 0:c.substr(o).toLowerCase())===s&&n(a)}):a=>{var c;return!!(!((c=i.getAttributeValue(a,r))===null||c===void 0)&&c.endsWith(s))&&n(a)}},any(n,e,t){let{adapter:i}=t,{name:r,value:s}=e;if(s==="")return xg.default.falseFunc;if(Wh(e,t)){let o=new RegExp(yG(s),"i");return function(c){let l=i.getAttributeValue(c,r);return l!=null&&l.length>=s.length&&o.test(l)&&n(c)}}return o=>{var a;return!!(!((a=i.getAttributeValue(o,r))===null||a===void 0)&&a.includes(s))&&n(o)}},not(n,e,t){let{adapter:i}=t,{name:r}=e,{value:s}=e;return s===""?o=>!!i.getAttributeValue(o,r)&&n(o):Wh(e,t)?(s=s.toLowerCase(),o=>{let a=i.getAttributeValue(o,r);return(a==null||a.length!==s.length||a.toLowerCase()!==s)&&n(o)}):o=>i.getAttributeValue(o,r)!==s&&n(o)}};var r3t=new Set([9,10,12,13,32]),xG=48,s3t=57;function bG(n){if(n=n.trim().toLowerCase(),n==="even")return[2,0];if(n==="odd")return[2,1];let e=0,t=0,i=s(),r=o();if(e<n.length&&n.charAt(e)==="n"&&(e++,t=i*(r??1),a(),e<n.length?(i=s(),a(),r=o()):i=r=0),r===null||e<n.length)throw new Error(`n-th rule couldn't be parsed ('${n}')`);return[t,i*r];function s(){return n.charAt(e)==="-"?(e++,-1):(n.charAt(e)==="+"&&e++,1)}function o(){let c=e,l=0;for(;e<n.length&&n.charCodeAt(e)>=xG&&n.charCodeAt(e)<=s3t;)l=l*10+(n.charCodeAt(e)-xG),e++;return e===c?null:l}function a(){for(;e<n.length&&r3t.has(n.charCodeAt(e));)e++}}var M5=Gt(Hh(),1);function vG(n){let e=n[0],t=n[1]-1;if(t<0&&e<=0)return M5.default.falseFunc;if(e===-1)return s=>s<=t;if(e===0)return s=>s===t;if(e===1)return t<0?M5.default.trueFunc:s=>s>=t;let i=Math.abs(e),r=(t%i+i)%i;return e>1?s=>s>=t&&s%i===r:s=>s<=t&&s%i===r}function Zm(n){return vG(bG(n))}var jr=Gt(Hh(),1);function J2(n,e){return t=>{let i=e.getParent(t);return i!=null&&e.isTag(i)&&n(t)}}var bg={contains(n,e,{adapter:t}){return function(r){return n(r)&&t.getText(r).includes(e)}},icontains(n,e,{adapter:t}){let i=e.toLowerCase();return function(s){return n(s)&&t.getText(s).toLowerCase().includes(i)}},"nth-child"(n,e,{adapter:t,equals:i}){let r=Zm(e);return r===jr.default.falseFunc?jr.default.falseFunc:r===jr.default.trueFunc?J2(n,t):function(o){let a=t.getSiblings(o),c=0;for(let l=0;l<a.length&&!i(o,a[l]);l++)t.isTag(a[l])&&c++;return r(c)&&n(o)}},"nth-last-child"(n,e,{adapter:t,equals:i}){let r=Zm(e);return r===jr.default.falseFunc?jr.default.falseFunc:r===jr.default.trueFunc?J2(n,t):function(o){let a=t.getSiblings(o),c=0;for(let l=a.length-1;l>=0&&!i(o,a[l]);l--)t.isTag(a[l])&&c++;return r(c)&&n(o)}},"nth-of-type"(n,e,{adapter:t,equals:i}){let r=Zm(e);return r===jr.default.falseFunc?jr.default.falseFunc:r===jr.default.trueFunc?J2(n,t):function(o){let a=t.getSiblings(o),c=0;for(let l=0;l<a.length;l++){let u=a[l];if(i(o,u))break;t.isTag(u)&&t.getName(u)===t.getName(o)&&c++}return r(c)&&n(o)}},"nth-last-of-type"(n,e,{adapter:t,equals:i}){let r=Zm(e);return r===jr.default.falseFunc?jr.default.falseFunc:r===jr.default.trueFunc?J2(n,t):function(o){let a=t.getSiblings(o),c=0;for(let l=a.length-1;l>=0;l--){let u=a[l];if(i(o,u))break;t.isTag(u)&&t.getName(u)===t.getName(o)&&c++}return r(c)&&n(o)}},root(n,e,{adapter:t}){return i=>{let r=t.getParent(i);return(r==null||!t.isTag(r))&&n(i)}},scope(n,e,t,i){let{equals:r}=t;return!i||i.length===0?bg.root(n,e,t):i.length===1?s=>r(i[0],s)&&n(s):s=>i.includes(s)&&n(s)},hover:C5("isHovered"),visited:C5("isVisited"),active:C5("isActive")};function C5(n){return function(t,i,{adapter:r}){let s=r[n];return typeof s!="function"?jr.default.falseFunc:function(a){return s(a)&&t(a)}}}var Q2={empty(n,{adapter:e}){return!e.getChildren(n).some(t=>e.isTag(t)||e.getText(t)!=="")},"first-child"(n,{adapter:e,equals:t}){if(e.prevElementSibling)return e.prevElementSibling(n)==null;let i=e.getSiblings(n).find(r=>e.isTag(r));return i!=null&&t(n,i)},"last-child"(n,{adapter:e,equals:t}){let i=e.getSiblings(n);for(let r=i.length-1;r>=0;r--){if(t(n,i[r]))return!0;if(e.isTag(i[r]))break}return!1},"first-of-type"(n,{adapter:e,equals:t}){let i=e.getSiblings(n),r=e.getName(n);for(let s=0;s<i.length;s++){let o=i[s];if(t(n,o))return!0;if(e.isTag(o)&&e.getName(o)===r)break}return!1},"last-of-type"(n,{adapter:e,equals:t}){let i=e.getSiblings(n),r=e.getName(n);for(let s=i.length-1;s>=0;s--){let o=i[s];if(t(n,o))return!0;if(e.isTag(o)&&e.getName(o)===r)break}return!1},"only-of-type"(n,{adapter:e,equals:t}){let i=e.getName(n);return e.getSiblings(n).every(r=>t(n,r)||!e.isTag(r)||e.getName(r)!==i)},"only-child"(n,{adapter:e,equals:t}){return e.getSiblings(n).every(i=>t(n,i)||!e.isTag(i))}};function I5(n,e,t,i){if(t===null){if(n.length>i)throw new Error(`Pseudo-class :${e} requires an argument`)}else if(n.length===i)throw new Error(`Pseudo-class :${e} doesn't have any arguments`)}var N5={"any-link":":is(a, area, link)[href]",link:":any-link:not(:visited)",disabled:`:is(
        :is(button, input, select, textarea, optgroup, option)[disabled],
        optgroup[disabled] > option,
        fieldset[disabled]:not(fieldset[disabled] legend:first-of-type *)
    )`,enabled:":not(:disabled)",checked:":is(:is(input[type=radio], input[type=checkbox])[checked], option:selected)",required:":is(input, select, textarea)[required]",optional:":is(input, select, textarea):not([required])",selected:"option:is([selected], select:not([multiple]):not(:has(> option[selected])) > :first-of-type)",checkbox:"[type=checkbox]",file:"[type=file]",password:"[type=password]",radio:"[type=radio]",reset:"[type=reset]",image:"[type=image]",submit:"[type=submit]",parent:":not(:empty)",header:":is(h1, h2, h3, h4, h5, h6)",button:":is(button, input[type=button])",input:":is(input, textarea, select, button)",text:"input:is(:not([type!='']), [type=text])"};var Ms=Gt(Hh(),1);var O5={};function L5(n,e){return n===Ms.default.falseFunc?Ms.default.falseFunc:t=>e.isTag(t)&&n(t)}function F5(n,e){let t=e.getSiblings(n);if(t.length<=1)return[];let i=t.indexOf(n);return i<0||i===t.length-1?[]:t.slice(i+1).filter(e.isTag)}function R5(n){return{xmlMode:!!n.xmlMode,lowerCaseAttributeNames:!!n.lowerCaseAttributeNames,lowerCaseTags:!!n.lowerCaseTags,quirksMode:!!n.quirksMode,cacheResults:!!n.cacheResults,pseudos:n.pseudos,adapter:n.adapter,equals:n.equals}}var A5=(n,e,t,i,r)=>{let s=r(e,R5(t),i);return s===Ms.default.trueFunc?n:s===Ms.default.falseFunc?Ms.default.falseFunc:o=>s(o)&&n(o)},tS={is:A5,matches:A5,where:A5,not(n,e,t,i,r){let s=r(e,R5(t),i);return s===Ms.default.falseFunc?n:s===Ms.default.trueFunc?Ms.default.falseFunc:o=>!s(o)&&n(o)},has(n,e,t,i,r){let{adapter:s}=t,o=R5(t);o.relativeSelector=!0;let a=e.some(u=>u.some(gg))?[O5]:void 0,c=r(e,o,a);if(c===Ms.default.falseFunc)return Ms.default.falseFunc;let l=L5(c,s);if(a&&c!==Ms.default.trueFunc){let{shouldTestNextSiblings:u=!1}=c;return p=>{if(!n(p))return!1;a[0]=p;let f=s.getChildren(p),y=u?[...f,...F5(p,s)]:f;return s.existsOne(l,y)}}return u=>n(u)&&s.existsOne(l,s.getChildren(u))}};function SG(n,e,t,i,r){var s;let{name:o,data:a}=e;if(Array.isArray(a)){if(!(o in tS))throw new Error(`Unknown pseudo-class :${o}(${a})`);return tS[o](n,a,t,i,r)}let c=(s=t.pseudos)===null||s===void 0?void 0:s[o],l=typeof c=="string"?c:N5[o];if(typeof l=="string"){if(a!=null)throw new Error(`Pseudo ${o} doesn't have any arguments`);let u=yg(l);return tS.is(n,u,t,i,r)}if(typeof c=="function")return I5(c,o,a,1),u=>c(u,a)&&n(u);if(o in bg)return bg[o](n,a,t,i);if(o in Q2){let u=Q2[o];return I5(u,o,a,2),p=>u(p,t,a)&&n(p)}throw new Error(`Unknown pseudo-class :${o}`)}function z5(n,e){let t=e.getParent(n);return t&&e.isTag(t)?t:null}function wG(n,e,t,i,r){let{adapter:s,equals:o}=t;switch(e.type){case de.PseudoElement:throw new Error("Pseudo-elements are not supported by css-select");case de.ColumnCombinator:throw new Error("Column combinators are not yet supported by css-select");case de.Attribute:{if(e.namespace!=null)throw new Error("Namespaced attributes are not yet supported by css-select");return(!t.xmlMode||t.lowerCaseAttributeNames)&&(e.name=e.name.toLowerCase()),gG[e.action](n,e,t)}case de.Pseudo:return SG(n,e,t,i,r);case de.Tag:{if(e.namespace!=null)throw new Error("Namespaced tag names are not yet supported by css-select");let{name:a}=e;return(!t.xmlMode||t.lowerCaseTags)&&(a=a.toLowerCase()),function(l){return s.getName(l)===a&&n(l)}}case de.Descendant:{if(t.cacheResults===!1||typeof WeakSet>"u")return function(l){let u=l;for(;u=z5(u,s);)if(n(u))return!0;return!1};let a=new WeakSet;return function(l){let u=l;for(;u=z5(u,s);)if(!a.has(u)){if(s.isTag(u)&&n(u))return!0;a.add(u)}return!1}}case"_flexibleDescendant":return function(c){let l=c;do if(n(l))return!0;while(l=z5(l,s));return!1};case de.Parent:return function(c){return s.getChildren(c).some(l=>s.isTag(l)&&n(l))};case de.Child:return function(c){let l=s.getParent(c);return l!=null&&s.isTag(l)&&n(l)};case de.Sibling:return function(c){let l=s.getSiblings(c);for(let u=0;u<l.length;u++){let p=l[u];if(o(c,p))break;if(s.isTag(p)&&n(p))return!0}return!1};case de.Adjacent:return s.prevElementSibling?function(c){let l=s.prevElementSibling(c);return l!=null&&n(l)}:function(c){let l=s.getSiblings(c),u;for(let p=0;p<l.length;p++){let f=l[p];if(o(c,f))break;s.isTag(f)&&(u=f)}return!!u&&n(u)};case de.Universal:{if(e.namespace!=null&&e.namespace!=="*")throw new Error("Namespaced universal selectors are not yet supported by css-select");return n}}}function PG(n,e,t){let i=eS(n,e,t);return L5(i,e.adapter)}function eS(n,e,t){let i=typeof n=="string"?yg(n):n;return nS(i,e,t)}function kG(n){return n.type===de.Pseudo&&(n.name==="scope"||Array.isArray(n.data)&&n.data.some(e=>e.some(kG)))}var o3t={type:de.Descendant},a3t={type:"_flexibleDescendant"},c3t={type:de.Pseudo,name:"scope",data:null};function l3t(n,{adapter:e},t){let i=!!t?.every(r=>{let s=e.isTag(r)&&e.getParent(r);return r===O5||s&&e.isTag(s)});for(let r of n){if(!(r.length>0&&gg(r[0])&&r[0].type!==de.Descendant))if(i&&!r.some(kG))r.unshift(o3t);else continue;r.unshift(c3t)}}function nS(n,e,t){var i;n.forEach(E5),t=(i=e.context)!==null&&i!==void 0?i:t;let r=Array.isArray(t),s=t&&(Array.isArray(t)?t:[t]);if(e.relativeSelector!==!1)l3t(n,e,s);else if(n.some(c=>c.length>0&&gg(c[0])))throw new Error("Relative selectors are not allowed when the `relativeSelector` option is disabled");let o=!1,a=n.map(c=>{if(c.length>=2){let[l,u]=c;l.type!==de.Pseudo||l.name!=="scope"||(r&&u.type===de.Descendant?c[1]=a3t:(u.type===de.Adjacent||u.type===de.Sibling)&&(o=!0))}return u3t(c,e,s)}).reduce(p3t,Ca.default.falseFunc);return a.shouldTestNextSiblings=o,a}function u3t(n,e,t){var i;return n.reduce((r,s)=>r===Ca.default.falseFunc?Ca.default.falseFunc:wG(r,s,e,t,nS),(i=e.rootFunc)!==null&&i!==void 0?i:Ca.default.trueFunc)}function p3t(n,e){return e===Ca.default.falseFunc||n===Ca.default.trueFunc?n:n===Ca.default.falseFunc||e===Ca.default.trueFunc?e:function(i){return n(i)||e(i)}}var TG=(n,e)=>n===e,h3t={adapter:K2,equals:TG};function EG(n){var e,t,i,r;let s=n??h3t;return(e=s.adapter)!==null&&e!==void 0||(s.adapter=K2),(t=s.equals)!==null&&t!==void 0||(s.equals=(r=(i=s.adapter)===null||i===void 0?void 0:i.equals)!==null&&r!==void 0?r:TG),s}function D5(n){return function(t,i,r){let s=EG(i);return n(t,s,r)}}var KQt=D5(PG),JQt=D5(eS),QQt=D5(nS);function MG(n){return function(t,i,r){let s=EG(r);typeof t!="function"&&(t=eS(t,s,i));let o=d3t(i,s.adapter,t.shouldTestNextSiblings);return n(t,o,s)}}function d3t(n,e,t=!1){return t&&(n=f3t(n,e)),Array.isArray(n)?e.removeSubsets(n):e.getChildren(n)}function f3t(n,e){let t=Array.isArray(n)?n.slice(0):[n],i=t.length;for(let r=0;r<i;r++){let s=F5(t[r],e);t.push(...s)}return t}var j5=MG((n,e,t)=>n===$5.default.falseFunc||!e||e.length===0?[]:t.adapter.findAll(n,e)),iS=MG((n,e,t)=>n===$5.default.falseFunc||!e||e.length===0?null:t.adapter.findOne(n,e));Q();St();Q();var oH=Gt(Mn(),1);St();var lH=Gt(Mn(),1),pH=Gt(Mn(),1);St();si();H5();var W5=(n,e={})=>{let t=n._internal_store;if(!t){t={counts:{}},n._internal_store=t;for(let r of n){let s=r.type,o=r[`${s}_id`];if(!o)continue;let a=Number.parseInt(o.split("_").pop());Number.isNaN(a)||(t.counts[s]=Math.max(t.counts[s]??0,a))}}return new Proxy({},{get:(r,s)=>s==="toArray"?()=>n:{get:o=>n.find(a=>a.type===s&&a[`${s}_id`]===o),getUsing:o=>{let a=Object.keys(o);if(a.length!==1)throw new Error("getUsing requires exactly one key, e.g. { pcb_component_id }");let c=a[0],l=c.replace("_id",""),u=n.find(p=>p.type===l&&p[c]===o[c]);return u?n.find(p=>p.type===s&&p[`${s}_id`]===u[`${s}_id`]):null},getWhere:o=>{let a=Object.keys(o);return n.find(c=>c.type===s&&a.every(l=>c[l]===o[l]))},list:o=>{let a=o?Object.keys(o):[];return n.filter(c=>c.type===s&&a.every(l=>c[l]===o[l]))},insert:o=>{var l;(l=t.counts)[s]??(l[s]=-1),t.counts[s]++;let a=t.counts[s],c={type:s,[`${s}_id`]:`${s}_${a}`,...o};return e.validateInserts&&(jh[s]??Dh).parse(c),n.push(c),c},delete:o=>{let a=n.find(c=>c[`${s}_id`]===o);a&&n.splice(n.indexOf(a),1)},update:(o,a)=>{let c=n.find(l=>l.type===s&&l[`${s}_id`]===o);if(c)return Object.assign(c,a),c},select:o=>{if(s==="source_component")return n.find(a=>a.type==="source_component"&&a.name===o.replace(/\./g,""));if(s==="pcb_port"||s==="source_port"||s==="schematic_port"){let[a,c]=o.replace(/\./g,"").split(/[\s\>]+/),l=n.find(p=>p.type==="source_component"&&p.name===a);if(!l)return null;let u=n.find(p=>p.type==="source_port"&&p.source_component_id===l.source_component_id&&(p.name===c||(p.port_hints??[]).includes(c)));if(!u)return null;if(s==="source_port")return u;if(s==="pcb_port")return n.find(p=>p.type==="pcb_port"&&p.source_port_id===u.source_port_id);if(s==="schematic_port")return n.find(p=>p.type==="schematic_port"&&p.source_port_id===u.source_port_id)}}}})};W5.unparsed=W5;var YG=W5;var nne=Gt(UG(),1);ir();function no(n){let e=n.width/2,t=n.height/2;return{minX:n.center.x-e,maxX:n.center.x+e,minY:n.center.y-t,maxY:n.center.y+t}}function kg(n,e){let t=no(n),i=no(e),r=Math.max(t.minX-i.maxX,i.minX-t.maxX,0),s=Math.max(t.minY-i.maxY,i.minY-t.maxY,0),o={x:0,y:0},a={x:0,y:0};return r===0&&s===0?{distance:0,pointA:n.center,pointB:e.center}:(o.x=Gn(n.center.x,i.minX,i.maxX),o.y=Gn(n.center.y,i.minY,i.maxY),a.x=Gn(e.center.x,t.minX,t.maxX),a.y=Gn(e.center.y,t.minY,t.maxY),{distance:Math.hypot(o.x-a.x,o.y-a.y),pointA:o,pointB:a})}function Ao(n,e){return kg(n,e)}function Q5(n,e){let t=no(n),i=no(e),r=Math.max(t.minX-i.maxX,i.minX-t.maxX,0),s=Math.max(t.minY-i.maxY,i.minY-t.maxY,0);return Math.hypot(r,s)}function Gn(n,e,t){return Math.max(e,Math.min(t,n))}function Tg(n,e){let t=Number.POSITIVE_INFINITY,i={x:0,y:0},r={x:0,y:0};for(let s of n)for(let o of e){let{distance:a,pointA:c,pointB:l}=kg(s,o);a<t&&(t=a,i=c,r=l)}return{pointA:i,pointB:r,distance:t}}ir();ir();var KG="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";var JG=(n=21)=>{let e="",t=crypto.getRandomValues(new Uint8Array(n|=0));for(;n--;)e+=KG[t[n]&63];return e};ir();var td=(n,e)=>Math.abs(n.x-e.x)+Math.abs(n.y-e.y),QG=(n,e)=>{let t=e.x-n.x,i=e.y-n.y;return Math.abs(t)>Math.abs(i)?{dx:Math.sign(t),dy:0}:{dx:0,dy:Math.sign(i)}},rH=(n,e,t)=>Math.abs(n.x-e.x)*Math.abs(t.dx)+Math.abs(n.y-e.y)*Math.abs(t.dy),sH=(n,e=.1)=>`${Math.round(n.x/e)},${Math.round(n.y/e)}`,tH=(n,e)=>Math.abs(n-e)<1e-4,aH=(n,e,{viaDiameter:t=.5}={})=>{let i=[];for(let r=0;r<n.length-1;r++){let[s,o]=[n[r],n[r+1]],a=r-1>=0?n[r-1]:null,c=tH(s.y,o.y),l=tH(s.x,o.x);if(!c&&!l)throw new Error(`getObstaclesFromTrace currently only supports horizontal and vertical traces (not diagonals) Conflicting trace: ${e}, start: (${s.x}, ${s.y}), end: (${o.x}, ${o.y})`);let u={type:"rect",layers:[s.layer],center:{x:(s.x+o.x)/2,y:(s.y+o.y)/2},width:c?Math.abs(s.x-o.x):.1,height:l?Math.abs(s.y-o.y):.1,connectedTo:[e]};if(i.push(u),a&&a.layer===s.layer&&s.layer!==o.layer){let p={type:"rect",layers:[s.layer,o.layer],center:{x:s.x,y:s.y},connectedTo:[e],width:t,height:t};i.push(p)}}return i},cH=class{constructor(n){d(this,"obstacles");d(this,"GRID_STEP",.1);this.obstacles=n.map(e=>({...e,left:e.center.x-e.width/2,right:e.center.x+e.width/2,top:e.center.y+e.height/2,bottom:e.center.y-e.height/2}))}getObstacleAt(n,e,t){t??(t=this.GRID_STEP);for(let i of this.obstacles){let r=i.width/2+t,s=i.height/2+t;if(n>=i.center.x-r&&n<=i.center.x+r&&e>=i.center.y-s&&e<=i.center.y+s)return i}return null}isObstacleAt(n,e,t){return this.getObstacleAt(n,e,t)!==null}getDirectionDistancesToNearestObstacle(n,e){let{GRID_STEP:t}=this,i={left:1/0,top:1/0,bottom:1/0,right:1/0};for(let r of this.obstacles)if(r.type==="rect"){let s=r.center.x-r.width/2-t,o=r.center.x+r.width/2+t,a=r.center.y+r.height/2+t,c=r.center.y-r.height/2-t;e>=c&&e<=a&&n>s&&(i.left=Math.min(i.left,n-o)),e>=c&&e<=a&&n<o&&(i.right=Math.min(i.right,s-n)),n>=s&&n<=o&&e<a&&(i.top=Math.min(i.top,c-e)),n>=s&&n<=o&&e>c&&(i.bottom=Math.min(i.bottom,e-a))}return i}getOrthoDirectionCollisionInfo(n,e,{margin:t=0}={}){let{x:i,y:r}=n,{dx:s,dy:o}=e,a=1/0,c=null;for(let l of this.obstacles){let u=l.left-t,p=l.right+t,f=l.top+t,y=l.bottom-t,g=null;s===1&&o===0?r>y&&r<f&&i<l.left&&(g=l.left-i):s===-1&&o===0?r>y&&r<f&&i>l.right&&(g=i-l.right):s===0&&o===1?i>u&&i<p&&r<l.bottom&&(g=l.bottom-r):s===0&&o===-1&&i>u&&i<p&&r>l.top&&(g=r-l.top),g!==null&&g<a&&(a=g,c=l)}return{dx:s,dy:o,wallDistance:a,obstacle:c}}getObstaclesOverlappingRegion(n){let e=[];for(let t of this.obstacles){let{left:i,right:r,top:s,bottom:o}=t;i<=n.maxX&&r>=n.minX&&s<=n.maxY&&o>=n.minY&&e.push(t)}return e}};function b3t(n){if(n.length<4)return n;let e=[{...n[0]}],t=n[0].layer;for(let i=1;i<n.length;i++){let r={start:n[i-1],end:n[i]},s=n[i].route_type==="via"||n[i-1].route_type==="via";if(n[i].layer!==t||s){e.push({...n[i]}),t=n[i].layer;continue}let o=!1,a=null,c=-1;for(let u=0;u<e.length-1;u++){let p={start:e[u],end:e[u+1]};if(p.start.layer===r.start.layer&&p.start.layer===r.start.layer){let f=v3t(p,r);if(f){o=!0,a={...f,layer:t},c=u;break}}}o&&a&&(e.splice(c+1),e.push(a));let l=e[e.length-1];(l.x!==n[i].x||l.y!==n[i].y)&&e.push(n[i])}return e}function v3t(n,e){if(n.start.x===n.end.x&&e.start.x===e.end.x||n.start.y===n.end.y&&e.start.y===e.end.y)return null;let t;if(n.start.x===n.end.x){let i=n.start.x,r=e.start.y;t={...n.start,x:i,y:r}}else{let i=e.start.x,r=n.start.y;t={...n.start,x:i,y:r}}return eH(t,n)&&eH(t,e)?t:null}function eH(n,e){return n.x>=Math.min(e.start.x,e.end.x)&&n.x<=Math.max(e.start.x,e.end.x)&&n.y>=Math.min(e.start.y,e.end.y)&&n.y<=Math.max(e.start.y,e.end.y)}function S3t(n){let e=[n[0]];for(let t=1;t<n.length-1;t++){let[i,r,s]=[n[t-1],n[t],n[t+1]];e.push(r),!(r.route_type!=="wire"||i.route_type!=="wire"||s.route_type!=="wire")&&i.layer===r.layer&&r.layer!==s.layer&&e.push({route_type:"via",from_layer:r.layer,to_layer:s.layer,x:r.x,y:r.y})}return e.push(n[n.length-1]),e}var tne=(0,lH.default)("autorouter:shortenPathWithShortcuts");function w3t(n,e){if(n.length<=2)return n;let t=[n[0]];for(let i=1;i<n.length;i++){let r={start:t[t.length-1],end:n[i]},s=-1,o=r.start.x===r.end.x,a=r.start.y===r.end.y;for(let c=i+1;c<n.length;c++){if(c<=s)continue;let l={start:n[c],end:n[c+1]};if(!l.end)continue;let u=l.start.x===l.end.x,p=l.start.y===l.end.y,f=o&&u,y=a&&p;if(y&&f||!(f||y))continue;let x=!1,v=Math.min(r.start.x,r.end.x),P=Math.max(r.start.x,r.end.x),w=Math.min(l.start.x,l.end.x),k=Math.max(l.start.x,l.end.x),T=Math.min(r.start.y,r.end.y),I=Math.max(r.start.y,r.end.y),E=Math.min(l.start.y,l.end.y),N=Math.max(l.start.y,l.end.y);if(y?x=v<=k&&P>=w:f&&(x=T<=N&&I>=E),!x)continue;let M=[],A=t[t.length-1],R=n[c+2];if(!R)continue;y&&w<P&&R.x===w&&M.push({x:w,y:r.start.y,layer:r.start.layer}),y&&k>v&&R.x===k&&M.push({x:k,y:r.start.y,layer:r.start.layer}),f&&E<I&&R.y===E&&M.push({x:r.start.x,y:E,layer:r.start.layer}),f&&N>T&&R.y===N&&M.push({x:r.start.x,y:N,layer:r.start.layer});let j=null;for(let B of M)if(!(e(A,B)||e(R,B))){j=B;break}if(j){t.push(j),i=c+1,s=c+1;break}}s===-1&&t.push(n[i])}return t[t.length-1]!==n[n.length-1]&&t.push(n[n.length-1]),t}var Qh=(0,oH.default)("autorouting-dataset:astar"),uH=class{constructor(n){d(this,"openSet",[]);d(this,"closedSet",new Set);d(this,"debug",!1);d(this,"debugSolutions");d(this,"debugMessage",null);d(this,"debugTraceCount",0);d(this,"input");d(this,"obstacles");d(this,"allObstacles");d(this,"startNode");d(this,"goalPoint");d(this,"GRID_STEP");d(this,"OBSTACLE_MARGIN");d(this,"MAX_ITERATIONS");d(this,"isRemovePathLoopsEnabled");d(this,"isShortenPathWithShortcutsEnabled");d(this,"GREEDY_MULTIPLIER",1.1);d(this,"iterations",-1);this.input=n.input,this.allObstacles=n.input.obstacles,this.startNode=n.startNode,this.goalPoint=n.goalPoint?{l:0,...n.goalPoint}:void 0,this.GRID_STEP=n.GRID_STEP??.1,this.OBSTACLE_MARGIN=n.OBSTACLE_MARGIN??.15,this.MAX_ITERATIONS=n.MAX_ITERATIONS??100,this.debug=n.debug??Qh.enabled,this.isRemovePathLoopsEnabled=n.isRemovePathLoopsEnabled??!1,this.isShortenPathWithShortcutsEnabled=n.isShortenPathWithShortcutsEnabled??!1,this.debug&&(Qh.enabled=!0),Qh.enabled&&(this.debugSolutions={},this.debugMessage="")}getNeighbors(n){return[]}isSameNode(n,e){return td(n,e)<this.GRID_STEP}computeG(n,e){return n.g+td(n,e)}computeH(n){return td(n,this.goalPoint)}getNodeName(n){return sH(n,this.GRID_STEP)}solveOneStep(){this.iterations+=1;let{openSet:n,closedSet:e,GRID_STEP:t,goalPoint:i}=this;n.sort((a,c)=>a.f-c.f);let r=n.shift();if(this.computeH(r)<=t*2)return{solved:!0,current:r,newNeighbors:[]};this.closedSet.add(this.getNodeName(r));let o=[];for(let a of this.getNeighbors(r)){if(e.has(this.getNodeName(a)))continue;let c=this.computeG(r,a),l=this.openSet.find(u=>this.isSameNode(u,a));if(!l||c<l.g){let u=this.computeH(a),p=c+u*this.GREEDY_MULTIPLIER,f={...a,g:c,h:u,f:p,obstacleHit:a.obstacleHit??void 0,manDistFromParent:td(r,a),nodesInPath:r.nodesInPath+1,parent:r,enterMarginCost:a.enterMarginCost,travelMarginCostFactor:a.travelMarginCostFactor};n.push(f),o.push(f)}}return Qh.enabled&&(n.sort((a,c)=>a.f-c.f),this.drawDebugSolution({current:r,newNeighbors:o})),{solved:!1,current:r,newNeighbors:o}}getStartNode(n){return{x:n.pointsToConnect[0].x,y:n.pointsToConnect[0].y,manDistFromParent:0,f:0,g:0,h:0,nodesInPath:0,parent:null}}layerToIndex(n){return 0}indexToLayer(n){return"top"}preprocessConnectionBeforeSolving(n){return n}solveConnection(n){if(n.pointsToConnect.length>2)throw new Error("GeneralizedAstarAutorouter doesn't currently support 2+ points in a connection");n=this.preprocessConnectionBeforeSolving(n);let{pointsToConnect:e}=n;for(this.iterations=0,this.closedSet=new Set,this.startNode=this.getStartNode(n),this.goalPoint={...e[e.length-1],l:this.layerToIndex(e[e.length-1].layer)},this.openSet=[this.startNode];this.iterations<this.MAX_ITERATIONS;){let{solved:t,current:i}=this.solveOneStep();if(t){let r=[],s=i;for(;s;){let o=s.l;r.unshift({x:s.x,y:s.y,layer:o!==void 0?this.indexToLayer(o):e[0].layer}),s=s.parent}return Qh.enabled&&(this.debugMessage+=`t${this.debugTraceCount}: ${this.iterations} iterations
`),this.isRemovePathLoopsEnabled&&(r=b3t(r)),this.isShortenPathWithShortcutsEnabled&&(r=w3t(r,(o,a)=>{if(o.x===a.x&&o.y===a.y)return!1;let c=this.obstacles.getOrthoDirectionCollisionInfo({x:o.x,y:o.y,l:this.layerToIndex(o.layer)??0},{dx:Math.sign(a.x-o.x),dy:Math.sign(a.y-o.y),dl:0},{margin:.05}),l=Math.sqrt((o.x-a.x)**2+(o.y-a.y)**2);return c.wallDistance<l})),{solved:!0,route:r,connectionName:n.name}}if(this.openSet.length===0)break}return Qh.enabled&&(this.debugMessage+=`t${this.debugTraceCount}: ${this.iterations} iterations (failed)
`),{solved:!1,connectionName:n.name}}createObstacleList({dominantLayer:n,connection:e,obstaclesFromTraces:t}){return new cH(this.allObstacles.filter(i=>!i.connectedTo.includes(e.name)).filter(i=>i.layers.includes(n)).concat(t??[]))}postprocessConnectionSolveResult(n,e){return e}solve(){let n=[],e=[];this.debugTraceCount=0;for(let t of this.input.connections){let i=t.pointsToConnect[0].layer??"top";this.debugTraceCount+=1,this.obstacles=this.createObstacleList({dominantLayer:i,connection:t,obstaclesFromTraces:e});let r=this.solveConnection(t);r=this.postprocessConnectionSolveResult(t,r),n.push(r),Qh.enabled&&this.drawDebugTraceObstacles(e),r.solved&&e.push(...aH(r.route.map(s=>({x:s.x,y:s.y,layer:s.layer??i})),t.name))}return n}solveAndMapToTraces(){return this.solve().flatMap(e=>e.solved?[{type:"pcb_trace",pcb_trace_id:`pcb_trace_for_${e.connectionName}`,route:S3t(e.route.map(t=>({route_type:"wire",x:t.x,y:t.y,width:this.input.minTraceWidth,layer:t.layer})))}]:[])}getDebugGroup(){let n=`t${this.debugTraceCount}_iter[${this.iterations-1}]`;return this.iterations<30||this.iterations<100&&this.iterations%10===0||this.iterations<1e3&&this.iterations%100===0||!this.debugSolutions?n:null}drawDebugTraceObstacles(n){let{debugTraceCount:e,debugSolutions:t}=this;for(let i in t)i.startsWith(`t${e}_`)&&t[i].push(...n.map((r,s)=>({type:"pcb_smtpad",pcb_component_id:"",layer:r.layers[0],width:r.width,shape:"rect",x:r.center.x,y:r.center.y,pcb_smtpad_id:`trace_obstacle_${s}`,height:r.height})))}drawDebugSolution({current:n,newNeighbors:e}){let t=this.getDebugGroup();if(!t)return;let{openSet:i,debugTraceCount:r,debugSolutions:s}=this;s[t]??(s[t]=[]);let o=s[t];o.push({type:"pcb_fabrication_note_text",pcb_fabrication_note_text_id:`debug_note_${n.x}_${n.y}`,font:"tscircuit2024",font_size:.25,text:"X"+(n.l!==void 0?n.l:""),pcb_component_id:"",layer:"top",anchor_position:{x:n.x,y:n.y},anchor_alignment:"center"});for(let a=0;a<i.length;a++){let c=i[a];o.push({type:"pcb_fabrication_note_path",pcb_component_id:"",pcb_fabrication_note_path_id:`note_path_${c.x}_${c.y}`,layer:"top",route:[[0,.05],[.05,0],[0,-.05],[-.05,0],[0,.05]].map(([l,u])=>({x:c.x+l,y:c.y+u})),stroke_width:.01}),o.push({type:"pcb_fabrication_note_text",pcb_fabrication_note_text_id:`debug_note_${c.x}_${c.y}`,font:"tscircuit2024",font_size:.03,text:a.toString(),pcb_component_id:"",layer:"top",anchor_position:{x:c.x,y:c.y},anchor_alignment:"center"})}if(n.parent){let a=[],c=n;for(;c;)a.unshift(c),c=c.parent;o.push({type:"pcb_fabrication_note_path",pcb_component_id:"",pcb_fabrication_note_path_id:`note_path_${n.x}_${n.y}`,layer:"top",route:a,stroke_width:.01})}}},P3t=(0,pH.default)("autorouting-dataset:infinite-grid-ijump-astar:get-distance-to-overcome-obstacle");function t4({node:n,travelDir:e,wallDir:t,obstacle:i,obstacles:r,obstaclesInRow:s=0,OBSTACLE_MARGIN:o=.15,SHOULD_DETECT_CONJOINED_OBSTACLES:a=!1,MAX_CONJOINED_OBSTACLES:c=20}){let l;if(e.dx===0?e.dy>0?l=i.center.y+i.height/2-n.y:l=n.y-(i.center.y-i.height/2):e.dx>0?l=i.center.x+i.width/2-n.x:l=n.x-(i.center.x-i.width/2),l+=o,a&&s<c){let u=r.getObstacleAt(n.x+e.dx*l+t.dx*(t.wallDistance+.001),n.y+e.dy*l+t.dy*(t.wallDistance+.001));if(u===i)return l;if(u&&u.type==="rect"){let p=e.dy===0,f=p?i.height:i.width;if((p?u.height:u.width)>f)return P3t("next obstacle on path is bigger, not trying to overcome it"),l;let g=t4({node:{x:n.x+e.dx*l,y:n.y+e.dy*l},travelDir:e,wallDir:t,obstacle:u,obstacles:r,obstaclesInRow:s+1,SHOULD_DETECT_CONJOINED_OBSTACLES:a,MAX_CONJOINED_OBSTACLES:c,OBSTACLE_MARGIN:o});l+=g}}return l}var k3t=class extends uH{constructor(){super(...arguments);d(this,"MAX_ITERATIONS",200)}getNeighbors(e){let t=this.obstacles,i=this.goalPoint,r;e.parent?r=QG(e.parent,e):r=QG(e,i);let s=[{dx:0,dy:1},{dx:1,dy:0},{dx:0,dy:-1},{dx:-1,dy:0}].filter(a=>a.dx===r.dx*-1&&a.dy===r.dy*-1?!1:!(a.dx===r.dx&&a.dy===r.dy&&e.parent?.obstacleHit)).map(a=>t.getOrthoDirectionCollisionInfo(e,a,{margin:this.OBSTACLE_MARGIN})).filter(a=>a.wallDistance>=this.OBSTACLE_MARGIN),o=[];for(let a of s){let c=null;e?.obstacleHit&&(c=t4({node:e,travelDir:a,wallDir:{...r,wallDistance:this.OBSTACLE_MARGIN},obstacle:e.obstacleHit,obstacles:t,OBSTACLE_MARGIN:this.OBSTACLE_MARGIN,SHOULD_DETECT_CONJOINED_OBSTACLES:!0}));let l=rH(e,i,a),u=(a.dx===0||Math.sign(i.x-e.x)===a.dx)&&(a.dy===0||Math.sign(i.y-e.y)===a.dy);l<a.wallDistance&&l>0&&u?o.push({...a,travelDistance:l}):c!==null&&c<a.wallDistance?o.push({...a,travelDistance:c}):a.wallDistance!==1/0&&o.push({...a,travelDistance:a.wallDistance-this.OBSTACLE_MARGIN})}return o.filter(a=>!t.isObstacleAt(e.x+a.dx*a.travelDistance,e.y+a.dy*a.travelDistance)).map(a=>({x:e.x+a.dx*a.travelDistance,y:e.y+a.dy*a.travelDistance,obstacleHit:a.obstacle}))}};function T3t(n,e=4){let{center:t,width:i,height:r,rotation:s}=n,o=[],a=s*Math.PI/180,c=Math.cos(a),l=Math.sin(a),u=(s%360+360)%360;if(r<=i?u>=45&&u<135||u>=225&&u<315:u>=135&&u<225||u>=315||u<45){let f=i/e;for(let y=0;y<e;y++){let g=(y-e/2+.5)*f,x=-g*c,v=-g*l,P=f*1.1,w=Math.abs(r*c)+Math.abs(f*l);o.push({center:{x:t.x+x,y:t.y+v},width:P,height:w})}}else{let f=r/e;for(let y=0;y<e;y++){let g=(y-e/2+.5)*f,x=-g*l,v=g*c,P=Math.abs(i*c)+Math.abs(f*l),w=f*1.1;o.push({center:{x:t.x+x,y:t.y+v},width:P,height:w})}}return o}var lS=["top","inner1","inner2","bottom"],hH=(n,e)=>{let t=r=>e?r.concat(r.map(s=>e?.getNetConnectedToId(s)).filter(Boolean)):r,i=[];for(let r of n)if(r.type==="pcb_smtpad"){if(r.shape==="circle")i.push({type:"oval",layers:[r.layer],center:{x:r.x,y:r.y},width:r.radius*2,height:r.radius*2,connectedTo:t([r.pcb_smtpad_id])});else if(r.shape==="rect")i.push({type:"rect",layers:[r.layer],center:{x:r.x,y:r.y},width:r.width,height:r.height,connectedTo:t([r.pcb_smtpad_id])});else if(r.shape==="rotated_rect"){let s={center:{x:r.x,y:r.y},width:r.width,height:r.height,rotation:r.ccw_rotation},o=T3t(s);for(let a of o)i.push({type:"rect",layers:[r.layer],center:a.center,width:a.width,height:a.height,connectedTo:t([r.pcb_smtpad_id])})}}else if(r.type==="pcb_keepout")r.shape==="circle"?i.push({type:"oval",layers:r.layers,center:{x:r.center.x,y:r.center.y},width:r.radius*2,height:r.radius*2,connectedTo:[]}):r.shape==="rect"&&i.push({type:"rect",layers:r.layers,center:{x:r.center.x,y:r.center.y},width:r.width,height:r.height,connectedTo:[]});else if(r.type==="pcb_hole")r.hole_shape==="oval"?i.push({type:"oval",center:{x:r.x,y:r.y},width:r.hole_width,height:r.hole_height,connectedTo:[]}):r.hole_shape==="square"?i.push({type:"rect",layers:lS,center:{x:r.x,y:r.y},width:r.hole_diameter,height:r.hole_diameter,connectedTo:[]}):(r.hole_shape==="round"||r.hole_shape==="circle")&&i.push({type:"rect",layers:lS,center:{x:r.x,y:r.y},width:r.hole_diameter,height:r.hole_diameter,connectedTo:[]});else if(r.type==="pcb_plated_hole")r.shape==="circle"?i.push({type:"oval",layers:lS,center:{x:r.x,y:r.y},width:r.outer_diameter,height:r.outer_diameter,connectedTo:t([r.pcb_plated_hole_id])}):(r.shape==="oval"||r.shape==="pill")&&i.push({type:"oval",layers:lS,center:{x:r.x,y:r.y},width:r.outer_width,height:r.outer_height,connectedTo:t([r.pcb_plated_hole_id])});else if(r.type==="pcb_trace"){let s=aH(r.route.map(o=>({x:o.x,y:o.y,layer:"layer"in o?o.layer:o.from_layer})),r.source_trace_id);i.push(...s)}else r.type==="pcb_via"&&i.push({type:"rect",layers:r.layers,center:{x:r.x,y:r.y},connectedTo:[],width:r.outer_diameter,height:r.outer_diameter});return i};function nH(n){let{pcbConnMap:e,goalElementId:t}=n;if(!t.startsWith("pcb_port_"))throw new Error(`Currently alternative goal boxes must have a goal id with prefix "pcb_port_" (got ${t})`);let i=e.getAllTracesConnectedToPort(t);return hH(i).map(r=>({...r,connectedTo:[t]}))}var dH=n=>{let{connection:e,pcbConnMap:t}=n;if(e.pointsToConnect.length!==2)throw new Error(`Connection must have exactly 2 points for alternative goal boxes (got ${e.pointsToConnect.length})`);let[i,r]=e.pointsToConnect;if(!i.pcb_port_id||!r.pcb_port_id)throw new Error(`Connection points must have pcb_port_id for alternative goal box calculation (got ${i.pcb_port_id} and ${r.pcb_port_id})`);let s=nH({goalElementId:i.pcb_port_id,pcbConnMap:t}).concat([{center:i,width:.01,height:.01,connectedTo:[i.pcb_port_id],layers:[i.layer],type:"rect"}]),o=nH({goalElementId:r.pcb_port_id,pcbConnMap:t}).concat([{center:r,width:.01,height:.01,connectedTo:[r.pcb_port_id],layers:[r.layer],type:"rect"}]);if(s.length<=1&&o.length<=1)return{...e,startPoint:i,endPoint:r,goalBoxes:[]};let a=Tg(s,o),c,l,u;return s.length>=o.length?(c={...r,...a.pointB},l={...i,...a.pointA},u=s):(c={...i,...a.pointA},l={...r,...a.pointB},u=o),{startPoint:c,endPoint:l,goalBoxes:u,name:e.name,pointsToConnect:[c,l]}},E3t=(n,e={})=>{let t={minTraceWidth:.1};t.layerCount=e.layerCount??1,t.obstacles=hH(n,e.connMap),t.connections=[];for(let r of n)if(r.type==="source_trace"){let s={name:r.source_trace_id,pointsToConnect:r.connected_source_port_ids.map(o=>{let a=YG(n).pcb_port.getWhere({source_port_id:o});if(!a)throw new Error(`Could not find pcb_port for source_port_id "${o}"`);return{x:a.x,y:a.y,layer:a.layers?.[0]??"top",pcb_port_id:a.pcb_port_id}})};if(e.optimizeWithGoalBoxes){let o=new cS(n);s=dH({connection:s,pcbConnMap:o})}t.connections.push(s),M3t(t.obstacles,s.pointsToConnect,s.name)}let i={minX:1/0,maxX:-1/0,minY:1/0,maxY:-1/0};for(let r of t.obstacles)i.minX=Math.min(i.minX,r.center.x-r.width/2),i.maxX=Math.max(i.maxX,r.center.x+r.width/2),i.minY=Math.min(i.minY,r.center.y-r.height/2),i.maxY=Math.max(i.maxY,r.center.y+r.height/2);for(let r of t.connections)for(let s of r.pointsToConnect)i.minX=Math.min(i.minX,s.x),i.maxX=Math.max(i.maxX,s.x),i.minY=Math.min(i.minY,s.y),i.maxY=Math.max(i.maxY,s.y);return t.bounds=i,t},M3t=(n,e,t)=>{for(let i of e)for(let r of n)C3t(i,r)&&r.connectedTo.push(t)};function C3t(n,e){let t=e.width/2,i=e.height/2;if(e.type==="rect")return n.x>=e.center.x-t&&n.x<=e.center.x+t&&n.y>=e.center.y-i&&n.y<=e.center.y+i;if(e.type==="oval"){let r=(n.x-e.center.x)/t,s=(n.y-e.center.y)/i;return r*r+s*s<=1}return!1}function iH(n,e){let t=e.x>n.x?1:e.x<n.x?-1:0,i=e.y>n.y?1:e.y<n.y?-1:0,r=e.l>n.l?1:e.l<n.l?-1:0;return{dx:t,dy:i,dl:r}}var e4={1:["top"],2:["top","bottom"],4:["top","inner1","inner2","bottom"]},I3t=n=>e4[n];function fH(n,e){let i=e4[n].indexOf(e);if(i===-1)throw new Error(`Invalid layer for getLayerIndex (for layerCount === ${n}): "${e}"`);return i}function N3t(n,e){let i=e4[n][e];if(!i)throw new Error(`Invalid index for indexToLayer (for layerCount === ${n}): "${e}"`);return i}var A3t=class extends cH{constructor(e,t){super([]);d(this,"obstacles");d(this,"GRID_STEP",.1);d(this,"layerCount");this.layerCount=e;let i=I3t(e);this.obstacles=t.flatMap(r=>r.layers.filter(s=>i.includes(s)).map(s=>({...r,left:r.center.x-r.width/2,right:r.center.x+r.width/2,top:r.center.y+r.height/2,bottom:r.center.y-r.height/2,l:fH(e,s)})))}getObstacleAt(e,t,i,r){r??(r=this.GRID_STEP);for(let s of this.obstacles){if(s.l!==i)continue;let o=s.width/2+r,a=s.height/2+r;if(e>=s.center.x-o&&e<=s.center.x+o&&t>=s.center.y-a&&t<=s.center.y+a)return s}return null}isObstacleAt(e,t,i,r){return this.getObstacleAt(e,t,i,r)!==null}getDirectionDistancesToNearestObstacle3d(e,t,i){let{GRID_STEP:r}=this,s={left:1/0,top:1/0,bottom:1/0,right:1/0};for(let o of this.obstacles)if(o.l===i&&o.type==="rect"){let a=o.center.x-o.width/2-r,c=o.center.x+o.width/2+r,l=o.center.y+o.height/2+r,u=o.center.y-o.height/2-r;t>=u&&t<=l&&e>a&&(s.left=Math.min(s.left,e-c)),t>=u&&t<=l&&e<c&&(s.right=Math.min(s.right,a-e)),e>=a&&e<=c&&t<l&&(s.top=Math.min(s.top,u-t)),e>=a&&e<=c&&t>u&&(s.bottom=Math.min(s.bottom,t-l))}return s}getOrthoDirectionCollisionInfo(e,t,{margin:i=0}={}){let{x:r,y:s,l:o}=e,{dx:a,dy:c,dl:l}=t,u=1/0,p=null;if(l!==0){let f=o+l;return this.isObstacleAt(r,s,f,i)?(u=1,p=this.getObstacleAt(r,s,f,i)):u=1,{dx:a,dy:c,dl:l,wallDistance:u,obstacle:p}}else{for(let f of this.obstacles){if(f.l!==o)continue;let y=f.left-i,g=f.right+i,x=f.top+i,v=f.bottom-i,P=null;a===1&&c===0?s>v&&s<x&&r<f.left&&(P=f.left-r):a===-1&&c===0?s>v&&s<x&&r>f.right&&(P=r-f.right):a===0&&c===1?r>y&&r<g&&s<f.bottom&&(P=f.bottom-s):a===0&&c===-1&&r>y&&r<g&&s>f.top&&(P=s-f.top),P!==null&&P<u&&(u=P,p=f)}return{dx:a,dy:c,dl:0,wallDistance:u,obstacle:p}}}getObstaclesOverlappingRegion(e){let t=[];for(let i of this.obstacles){if(i.l!==e.l)continue;let{left:r,right:s,top:o,bottom:a}=i;r<=e.maxX&&s>=e.minX&&o>=e.minY&&a<=e.maxY&&t.push(i)}return t}},uS=class extends uH{constructor(e){super(e);d(this,"MAX_ITERATIONS",500);d(this,"VIA_COST",4);d(this,"VIA_DIAMETER",.5);d(this,"allowLayerChange",!0);d(this,"layerCount");d(this,"obstacles");d(this,"optimizeWithGoalBoxes");d(this,"connMap");d(this,"pcbConnMap");d(this,"GOAL_RUSH_FACTOR",1.1);d(this,"defaultGoalViaMargin",.5);d(this,"marginsWithCosts");this.layerCount=e.input.layerCount??2,this.MAX_ITERATIONS=e.MAX_ITERATIONS??this.MAX_ITERATIONS,this.VIA_COST=e.VIA_COST??this.VIA_COST,this.connMap=e.connMap,this.pcbConnMap=e.pcbConnMap??new cS,this.optimizeWithGoalBoxes=e.optimizeWithGoalBoxes??!1,this.obstacles=null,this.marginsWithCosts=e.marginsWithCosts??[{margin:1,enterCost:0,travelCostFactor:1},{margin:this.OBSTACLE_MARGIN,enterCost:10,travelCostFactor:2}]}get largestMargin(){return this.marginsWithCosts[0].margin}preprocessConnectionBeforeSolving(e){return this.optimizeWithGoalBoxes?dH({connection:e,pcbConnMap:this.pcbConnMap}):e}postprocessConnectionSolveResult(e,t){if(!t.solved)return t;if(this.optimizeWithGoalBoxes){let i=t.route.map(r=>({x:r.x,y:r.y,route_type:"wire",layer:r.layer,width:this.input.minTraceWidth}));i[0].start_pcb_port_id=e.pointsToConnect[0].pcb_port_id,i[i.length-1].end_pcb_port_id=e.pointsToConnect[1].pcb_port_id,this.pcbConnMap.addTrace({type:"pcb_trace",pcb_trace_id:`postprocess_trace_${JG(8)}`,route:i})}return t}createObstacleList({dominantLayer:e,connection:t,obstaclesFromTraces:i}){let r=this.connMap?this.connMap.getNetConnectedToId(t.name):t.name;if(!r)throw new Error(`The connection.name "${t.name}" wasn't present in the full connectivity map`);return new A3t(this.layerCount,this.allObstacles.filter(s=>!s.connectedTo.includes(r)).concat(i??[]))}computeG(e,t){let i=e.g+td(e,t)*(e.travelMarginCostFactor??1)+(t.enterMarginCost??0);return(t.l??e.l!==-1??-1)&&(i+=this.VIA_COST),i}computeH(e){let t=Math.abs(e.x-this.goalPoint.x),i=Math.abs(e.y-this.goalPoint.y),r=Math.abs(e.l-this.goalPoint.l);return(t+i)**this.GOAL_RUSH_FACTOR+r*this.VIA_COST}getStartNode(e){return{...super.getStartNode(e),l:this.layerToIndex(e.pointsToConnect[0].layer)}}layerToIndex(e){return fH(this.layerCount,e)}indexToLayer(e){return N3t(this.layerCount,e)}getNodeName(e){return`${sH(e,this.GRID_STEP)}-${e.l??0}`}hasSpaceForVia(e,t){return e.every(i=>this.obstacles.getObstaclesOverlappingRegion({minX:t.x-this.VIA_DIAMETER/2-this.OBSTACLE_MARGIN,minY:t.y-this.VIA_DIAMETER/2-this.OBSTACLE_MARGIN,maxX:t.x+this.VIA_DIAMETER/2+this.OBSTACLE_MARGIN,maxY:t.y+this.VIA_DIAMETER/2+this.OBSTACLE_MARGIN,l:i}).length===0)}getNeighborsSurroundingGoal(e){let t=this.obstacles,i=this.goalPoint,r=[],s=[{dx:1,dy:0,dl:0},{dx:-1,dy:0,dl:0},{dx:0,dy:1,dl:0},{dx:0,dy:-1,dl:0}],o=this.VIA_DIAMETER+this.OBSTACLE_MARGIN+this.defaultGoalViaMargin;for(let a of s){let c={x:e.x+a.dx*o,y:e.y+a.dy*o,l:e.l+a.dl,obstacleHit:null};this.hasSpaceForVia([e.l,i.l],c)&&r.push(c)}return r}getNeighbors(e){let t=this.obstacles,i=this.goalPoint,r=td(e,i);if(r<=this.OBSTACLE_MARGIN)return this.getNeighborsSurroundingGoal(e);let s;e.parent?s=iH(e.parent,e):s=iH(e,i);let o=[{dx:0,dy:1,dl:0},{dx:1,dy:0,dl:0},{dx:0,dy:-1,dl:0},{dx:-1,dy:0,dl:0}],a=r>this.VIA_DIAMETER+this.OBSTACLE_MARGIN,c=td(e,this.startNode)>this.VIA_DIAMETER+this.OBSTACLE_MARGIN;this.allowLayerChange&&a&&c&&(e.l<this.layerCount-1&&o.push({dx:0,dy:0,dl:1}),e.l>0&&o.push({dx:0,dy:0,dl:-1}));let l=o.filter(p=>p.dx===s.dx*-1&&p.dy===s.dy*-1&&p.dl===s.dl*-1?!1:!(p.dx===s.dx&&p.dy===s.dy&&p.dl===s.dl&&e.parent?.obstacleHit)).map(p=>t.getOrthoDirectionCollisionInfo(e,p,{margin:this.OBSTACLE_MARGIN})).filter(p=>!(p.wallDistance<this.OBSTACLE_MARGIN)),u=[];for(let p of l){let f=p.dx===0&&p.dy===0&&p.dl===1,y=p.dx===0&&p.dy===0&&p.dl===-1;if((f||y)&&![e.l,e.l+p.dl].every(w=>t.getObstaclesOverlappingRegion({minX:e.x-this.VIA_DIAMETER/2-this.OBSTACLE_MARGIN,minY:e.y-this.VIA_DIAMETER/2-this.OBSTACLE_MARGIN,maxX:e.x+this.VIA_DIAMETER/2+this.OBSTACLE_MARGIN,maxY:e.y+this.VIA_DIAMETER/2+this.OBSTACLE_MARGIN,l:w}).length===0))continue;if(f){e.l<this.layerCount-1&&u.push({...p,travelDistance:0,enterMarginCost:0,travelMarginCostFactor:1});continue}if(y){e.l>0&&u.push({...p,travelDistance:0,enterMarginCost:0,travelMarginCostFactor:1});continue}let g=null;e?.obstacleHit&&(g=t4({node:e,travelDir:p,wallDir:{...s,wallDistance:this.OBSTACLE_MARGIN},obstacle:e.obstacleHit,obstacles:t,OBSTACLE_MARGIN:this.OBSTACLE_MARGIN,SHOULD_DETECT_CONJOINED_OBSTACLES:!0}));let x=rH(e,i,p),v=(p.dx===0||Math.sign(i.x-e.x)===p.dx)&&(p.dy===0||Math.sign(i.y-e.y)===p.dy);if(x<p.wallDistance&&x>0&&v){let P=e.l===i.l,w=0;!P&&Math.abs(x-r)<this.GRID_STEP&&(w=this.VIA_DIAMETER+this.OBSTACLE_MARGIN+this.defaultGoalViaMargin),u.push({...p,travelDistance:x-w,enterMarginCost:0,travelMarginCostFactor:1})}else if(g!==null&&g<p.wallDistance){for(let{margin:P,enterCost:w,travelCostFactor:k}of this.marginsWithCosts)g-this.OBSTACLE_MARGIN+P*2<p.wallDistance&&u.push({...p,travelDistance:g-this.OBSTACLE_MARGIN+P,enterMarginCost:w,travelMarginCostFactor:k});if(p.wallDistance===1/0)u.push({...p,travelDistance:x,enterMarginCost:0,travelMarginCostFactor:1});else if(p.wallDistance>this.largestMargin)for(let{margin:P,enterCost:w,travelCostFactor:k}of this.marginsWithCosts)p.wallDistance>this.largestMargin+P&&u.push({...p,travelDistance:p.wallDistance-P,enterMarginCost:w,travelMarginCostFactor:k})}else if(p.wallDistance!==1/0)for(let{margin:P,enterCost:w,travelCostFactor:k}of this.marginsWithCosts)p.wallDistance>P&&u.push({...p,travelDistance:p.wallDistance-P,enterMarginCost:w,travelMarginCostFactor:k})}return u.map(p=>({x:e.x+p.dx*p.travelDistance,y:e.y+p.dy*p.travelDistance,l:e.l+p.dl,obstacleHit:p.obstacle,travelMarginCostFactor:p.travelMarginCostFactor,enterMarginCost:p.enterMarginCost}))}};function mH(n){let e=E3t(n),t=new k3t({input:e});return{solution:t.solveAndMapToTraces(),debugSolutions:t.debugSolutions,debugMessage:t.debugMessage}}Q();Q();St();Q();Q();St();St();Q();Q();St();Q();Q();Q();Q();St();Q();Q();Q();St();Q();Q();St();Q();Q();Q();Q();Q();Q();Q();Q();Q();Q();St();Q();St();Q();St();Q();Q();St();St();Q();St();Q();Q();St();Q();Q();St();Q();St();Q();St();Q();St();Q();St();Q();St();Q();St();Q();Q();Q();Q();Q();Q();Q();Q();St();Q();St();Q();Q();St();Q();St();Q();Q();Q();St();Q();St();St();Q();Q();Q();St();Q();Q();Q();St();Q();St();Q();St();Q();St();Q();St();Q();St();Q();St();Q();St();Q();Q();St();Q();St();Q();St();Q();Q();St();St();Q();Q();St();St();Q();Q();St();Q();St();Q();St();Q();St();Q();St();Q();St();Q();Q();St();Q();St();Q();St();Q();St();Q();St();Q();St();Q();St();Q();St();St();Q();St();Q();St();Q();Q();St();Q();St();Q();St();Q();St();Q();St();Q();Q();var Ct=n=>{};Ct("extra props b");Ct("missing props b");Ct(!0);Ct("property a has mismatched types");var R3t=h.enum(["up","down","left","right"]),gne=h.enum(["top-to-bottom","left-to-right","bottom-to-top","right-to-left"]);Ct(!0);Ct(!0);var io=h.array(h.string().or(h.number()));Ct(!0);var dS=h.object({x:Y,y:Y,z:Y}),O3t=h.object({x:h.union([h.number(),h.string()]),y:h.union([h.number(),h.string()]),z:h.union([h.number(),h.string()])}),Xc=h.object({rotationOffset:h.number().or(O3t).optional(),positionOffset:dS.optional(),size:dS.optional(),modelUnitToMmScale:Y.optional(),zOffsetFromSurface:Y.optional()});Ct(!0);var L3t=Xc.extend({stlUrl:h.string()}),F3t=Xc.extend({objUrl:h.string(),mtlUrl:h.string().optional()}),z3t=Xc.extend({gltfUrl:h.string()}),$3t=Xc.extend({glbUrl:h.string()}),D3t=Xc.extend({stepUrl:h.string()}),j3t=Xc.extend({wrlUrl:h.string()}),B3t=Xc.extend({jscad:h.record(h.any())}),wH=h.union([h.null(),h.string(),h.custom(n=>n&&typeof n=="object"&&"type"in n&&"props"in n),L3t,F3t,z3t,$3t,D3t,j3t,B3t]);Ct(!0);var Y3t=h.custom(n=>!0),r4=h.object({silkscreenFontSize:Y.optional(),silkscreenTextPosition:h.union([h.enum(["centered","outside","none"]),h.object({offsetX:h.number(),offsetY:h.number()})]).optional(),silkscreenTextVisibility:h.enum(["hidden","visible","inherit"]).optional()});Ct(!0);var X3t=h.custom(n=>!0),je=h.object({pcbX:Y.optional(),pcbY:Y.optional(),pcbOffsetX:Y.optional(),pcbOffsetY:Y.optional(),pcbRotation:He.optional(),pcbPositionAnchor:h.string().optional(),pcbPositionMode:h.enum(["relative_to_group_anchor","auto","relative_to_board_anchor","relative_to_component_anchor"]).optional(),layer:pe.optional(),pcbMarginTop:Y.optional(),pcbMarginRight:Y.optional(),pcbMarginBottom:Y.optional(),pcbMarginLeft:Y.optional(),pcbMarginX:Y.optional(),pcbMarginY:Y.optional(),pcbStyle:r4.optional(),pcbRelative:h.boolean().optional(),relative:h.boolean().optional()});Ct(!0);var fS=h.object({pcbX:Y.optional(),pcbY:Y.optional(),pcbOffsetX:Y.optional(),pcbOffsetY:Y.optional(),pcbRotation:He.optional(),pcbPositionAnchor:h.string().optional(),pcbPositionMode:h.enum(["relative_to_group_anchor","auto","relative_to_board_anchor","relative_to_component_anchor"]).optional(),pcbMarginTop:Y.optional(),pcbMarginRight:Y.optional(),pcbMarginBottom:Y.optional(),pcbMarginLeft:Y.optional(),pcbMarginX:Y.optional(),pcbMarginY:Y.optional(),pcbStyle:r4.optional(),schMarginTop:Y.optional(),schMarginRight:Y.optional(),schMarginBottom:Y.optional(),schMarginLeft:Y.optional(),schMarginX:Y.optional(),schMarginY:Y.optional(),schX:Y.optional(),schY:Y.optional(),schRotation:He.optional(),layer:pe.optional(),footprint:Y3t.optional(),symbol:X3t.optional(),relative:h.boolean().optional(),schRelative:h.boolean().optional(),pcbRelative:h.boolean().optional()});Ct(!0);var U3t=h.object({supplierPartNumbers:h.record(Nm,h.array(h.string())).optional()});Ct(!0);var V3t=h.object({providesPower:h.boolean().optional(),requiresPower:h.boolean().optional(),providesGround:h.boolean().optional(),requiresGround:h.boolean().optional(),providesVoltage:h.union([h.string(),h.number()]).optional(),requiresVoltage:h.union([h.string(),h.number()]).optional(),doNotConnect:h.boolean().optional(),includeInBoardPinout:h.boolean().optional(),highlightColor:h.string().optional()});Ct(!0);var Jn=fS.merge(U3t).extend({key:h.any().optional(),name:h.string(),cadModel:wH.optional(),children:h.any().optional(),symbolName:h.string().optional(),doNotPlace:h.boolean().optional(),obstructsWithinBounds:h.boolean().optional().describe("Does this component take up all the space within its bounds on a layer. This is generally true except for when separated pin headers are being represented by a single component (in which case, chips can be placed between the pin headers) or for tall modules where chips fit underneath"),pinAttributes:h.record(h.string(),V3t).optional()});Ct(!0);var s4=["pin1","left","pin2","right"],mS=["pin1","left","anode","pos","pin2","right","cathode","neg"],Nne=Y.or(h.enum(["2x","3x","4x"])),Uc=h.enum(["vertical","horizontal","pos_top","pos_bottom","pos_left","pos_right","neg_top","neg_bottom","neg_left","neg_right"]).describe("horizontal means pins go 1->2 rightward and vertical means pins go 1->2 downward (generally, positive on top)");Ct(!0);var pS=h.object({pins:h.array(h.union([h.number(),h.string()])),direction:h.union([h.literal("top-to-bottom"),h.literal("left-to-right"),h.literal("bottom-to-top"),h.literal("right-to-left")])}),Mg=h.object({leftSize:h.number().optional().describe("@deprecated, use leftPinCount"),topSize:h.number().optional().describe("@deprecated, use topPinCount"),rightSize:h.number().optional().describe("@deprecated, use rightPinCount"),bottomSize:h.number().optional().describe("@deprecated, use bottomPinCount"),leftPinCount:h.number().optional(),rightPinCount:h.number().optional(),topPinCount:h.number().optional(),bottomPinCount:h.number().optional(),leftSide:pS.optional(),rightSide:pS.optional(),topSide:pS.optional(),bottomSide:pS.optional()}),o4=Mg;Ct(!0);var Cg=h.record(h.object({marginLeft:Y.optional(),marginRight:Y.optional(),marginTop:Y.optional(),marginBottom:Y.optional(),leftMargin:Y.optional(),rightMargin:Y.optional(),topMargin:Y.optional(),bottomMargin:Y.optional()}));Ct(!0);var Is=h.string().regex(/^[A-Za-z0-9_]+$/),t_=h.enum(["top_left","top_center","top_right","center_left","center","center_right","bottom_left","bottom_center","bottom_right"]),Ro=h.object({x:Y,y:Y}),Ig=h.object({edit_event_id:h.string(),in_progress:h.boolean().optional(),created_at:h.number()});Ct(!0);var G3t=Ig.extend({pcb_edit_event_type:h.literal("edit_component_location").describe("deprecated"),edit_event_type:h.literal("edit_pcb_component_location"),pcb_component_id:h.string(),original_center:h.object({x:h.number(),y:h.number()}),new_center:h.object({x:h.number(),y:h.number()})});Ct(!0);var H3t=Ig.extend({pcb_edit_event_type:h.literal("edit_trace_hint").describe("deprecated"),edit_event_type:h.literal("edit_pcb_trace_hint").optional(),pcb_port_id:h.string(),pcb_trace_hint_id:h.string().optional(),route:h.array(h.object({x:h.number(),y:h.number(),via:h.boolean().optional()}))});Ct(!0);var W3t=Ig.extend({edit_event_type:h.literal("edit_schematic_component_location"),schematic_component_id:h.string(),original_center:h.object({x:h.number(),y:h.number()}),new_center:h.object({x:h.number(),y:h.number()})});Ct(!0);var Wne=Ig.extend({edit_event_type:h.literal("edit_pcb_group_location"),pcb_group_id:h.string(),original_center:h.object({x:h.number(),y:h.number()}),new_center:h.object({x:h.number(),y:h.number()})});Ct(!0);var Zne=Ig.extend({edit_event_type:h.literal("edit_schematic_group_location"),schematic_group_id:h.string(),original_center:h.object({x:h.number(),y:h.number()}),new_center:h.object({x:h.number(),y:h.number()})});Ct(!0);var Jne=h.union([G3t,H3t,W3t]);Ct(!0);var q3t=h.object({selector:h.string(),relative_to:h.string().optional().default("group_center").describe("Can be a selector or 'group_center'"),center:Zt});Ct(!0);var Z3t=h.object({pcb_port_selector:h.string(),offsets:h.array(Qi)});Ct(!0);var K3t=h.object({selector:h.string(),relative_to:h.string().optional().default("group_center").describe("Can be a selector or 'group_center'"),center:Zt});Ct(!0);var J3t=h.object({pcb_placements:h.array(q3t).optional(),manual_trace_hints:h.array(Z3t).optional(),schematic_placements:h.array(K3t).optional()});Ct(!0);var e_=h.string().or(h.array(h.string()).readonly()).or(h.array(h.string())),ed=n=>h.record(h.enum(n),e_),Eg=h.object({layoutMode:h.enum(["grid","flex","match-adapt","relative","none"]).optional(),position:h.enum(["absolute","relative"]).optional(),grid:h.boolean().optional(),gridCols:h.number().or(h.string()).optional(),gridRows:h.number().or(h.string()).optional(),gridTemplateRows:h.string().optional(),gridTemplateColumns:h.string().optional(),gridTemplate:h.string().optional(),gridGap:h.number().or(h.string()).optional(),gridRowGap:h.number().or(h.string()).optional(),gridColumnGap:h.number().or(h.string()).optional(),flex:h.boolean().or(h.string()).optional(),flexDirection:h.enum(["row","column"]).optional(),alignItems:h.enum(["start","center","end","stretch"]).optional(),justifyContent:h.enum(["start","center","end","stretch","space-between","space-around","space-evenly"]).optional(),flexRow:h.boolean().optional(),flexColumn:h.boolean().optional(),gap:h.number().or(h.string()).optional(),pack:h.boolean().optional().describe("Pack the contents of this group using a packing strategy"),packOrderStrategy:h.enum(["largest_to_smallest","first_to_last","highest_to_lowest_pin_count"]).optional(),packPlacementStrategy:h.enum(["shortest_connection_along_outline"]).optional(),padding:D.optional(),paddingLeft:D.optional(),paddingRight:D.optional(),paddingTop:D.optional(),paddingBottom:D.optional(),paddingX:D.optional(),paddingY:D.optional(),width:D.optional(),height:D.optional(),matchAdapt:h.boolean().optional(),matchAdaptTemplate:h.any().optional()});Ct(!0);var _H=h.object({strokeWidth:D.optional(),dashed:h.boolean().optional(),solid:h.boolean().optional()}),Q3t=h.custom(n=>typeof n=="string"),tEt=h.object({serverUrl:h.string().optional(),inputFormat:h.enum(["simplified","circuit-json"]).optional(),serverMode:h.enum(["job","solve-endpoint"]).optional(),serverCacheEnabled:h.boolean().optional(),cache:h.custom(n=>!0).optional(),traceClearance:D.optional(),groupMode:h.enum(["sequential_trace","subcircuit","sequential-trace"]).optional(),algorithmFn:h.custom(n=>typeof n=="function"||n===void 0).optional(),preset:h.enum(["sequential_trace","subcircuit","auto","auto_local","auto_cloud","freerouting","laser_prefab","sequential-trace","auto-local","auto-cloud"]).optional(),local:h.boolean().optional()}),eEt=h.union([h.literal("sequential_trace"),h.literal("subcircuit"),h.literal("auto"),h.literal("auto_local"),h.literal("auto_cloud"),h.literal("freerouting"),h.literal("laser_prefab"),h.literal("sequential-trace"),h.literal("auto-local"),h.literal("auto-cloud")]),nEt=h.string(),PH=h.union([tEt,eEt,nEt]),a4=fS.extend({name:h.string().optional(),children:h.any().optional(),schTitle:h.string().optional(),key:h.any().optional(),showAsSchematicBox:h.boolean().optional(),connections:h.record(h.string(),e_.optional()).optional(),schPinArrangement:o4.optional(),schPinSpacing:D.optional(),schPinStyle:Cg.optional(),...Eg.shape,grid:Eg.shape.grid.describe("@deprecated use pcbGrid"),flex:Eg.shape.flex.describe("@deprecated use pcbFlex"),pcbGrid:h.boolean().optional(),pcbGridCols:h.number().or(h.string()).optional(),pcbGridRows:h.number().or(h.string()).optional(),pcbGridTemplateRows:h.string().optional(),pcbGridTemplateColumns:h.string().optional(),pcbGridTemplate:h.string().optional(),pcbGridGap:h.number().or(h.string()).optional(),pcbGridRowGap:h.number().or(h.string()).optional(),pcbGridColumnGap:h.number().or(h.string()).optional(),pcbFlex:h.boolean().or(h.string()).optional(),pcbFlexGap:h.number().or(h.string()).optional(),pcbFlexDirection:h.enum(["row","column"]).optional(),pcbAlignItems:h.enum(["start","center","end","stretch"]).optional(),pcbJustifyContent:h.enum(["start","center","end","stretch","space-between","space-around","space-evenly"]).optional(),pcbFlexRow:h.boolean().optional(),pcbFlexColumn:h.boolean().optional(),pcbGap:h.number().or(h.string()).optional(),pcbPack:h.boolean().optional(),pcbPackGap:h.number().or(h.string()).optional(),schGrid:h.boolean().optional(),schGridCols:h.number().or(h.string()).optional(),schGridRows:h.number().or(h.string()).optional(),schGridTemplateRows:h.string().optional(),schGridTemplateColumns:h.string().optional(),schGridTemplate:h.string().optional(),schGridGap:h.number().or(h.string()).optional(),schGridRowGap:h.number().or(h.string()).optional(),schGridColumnGap:h.number().or(h.string()).optional(),schFlex:h.boolean().or(h.string()).optional(),schFlexGap:h.number().or(h.string()).optional(),schFlexDirection:h.enum(["row","column"]).optional(),schAlignItems:h.enum(["start","center","end","stretch"]).optional(),schJustifyContent:h.enum(["start","center","end","stretch","space-between","space-around","space-evenly"]).optional(),schFlexRow:h.boolean().optional(),schFlexColumn:h.boolean().optional(),schGap:h.number().or(h.string()).optional(),schPack:h.boolean().optional(),schMatchAdapt:h.boolean().optional(),pcbWidth:D.optional(),pcbHeight:D.optional(),minTraceWidth:D.optional(),schWidth:D.optional(),schHeight:D.optional(),pcbLayout:Eg.optional(),schLayout:Eg.optional(),cellBorder:_H.nullable().optional(),border:_H.nullable().optional(),schPadding:D.optional(),schPaddingLeft:D.optional(),schPaddingRight:D.optional(),schPaddingTop:D.optional(),schPaddingBottom:D.optional(),pcbPadding:D.optional(),pcbPaddingLeft:D.optional(),pcbPaddingRight:D.optional(),pcbPaddingTop:D.optional(),pcbPaddingBottom:D.optional(),pcbPositionAnchor:Q3t.optional()}),kH=h.custom(n=>"findPart"in n),c4=a4.extend({manualEdits:J3t.optional(),schAutoLayoutEnabled:h.boolean().optional(),schTraceAutoLabelEnabled:h.boolean().optional(),schMaxTraceDistance:Y.optional(),routingDisabled:h.boolean().optional(),defaultTraceWidth:D.optional(),minTraceWidth:D.optional(),partsEngine:kH.optional(),pcbRouteCache:h.custom(n=>!0).optional(),autorouter:PH.optional(),square:h.boolean().optional(),emptyArea:h.string().optional(),filledArea:h.string().optional(),width:Y.optional(),height:Y.optional(),outline:h.array(Ro).optional(),outlineOffsetX:Y.optional(),outlineOffsetY:Y.optional(),circuitJson:h.array(h.any()).optional()}),iEt=c4.extend({subcircuit:h.literal(!0)}),TH=h.discriminatedUnion("subcircuit",[a4.extend({subcircuit:h.literal(!1).optional()}),iEt]);Ct(!0);Ct(!0);Ct(!0);Ct(!0);var Qm=h.custom(n=>typeof n=="string"),l4=c4.omit({connections:!0}).extend({material:h.enum(["fr4","fr1"]).default("fr4"),layers:h.union([h.literal(2),h.literal(4)]).default(2),borderRadius:Y.optional(),thickness:Y.optional(),boardAnchorPosition:Ro.optional(),boardAnchorAlignment:t_.optional(),title:h.string().optional(),solderMaskColor:Qm.optional(),topSolderMaskColor:Qm.optional(),bottomSolderMaskColor:Qm.optional(),silkscreenColor:Qm.optional(),topSilkscreenColor:Qm.optional(),bottomSilkscreenColor:Qm.optional(),doubleSidedAssembly:h.boolean().optional().default(!1),schematicDisabled:h.boolean().optional()});Ct(!0);var EH=a4.omit({width:!0,height:!0,children:!0}).extend({width:Y,height:Y,children:h.any().optional(),noSolderMask:h.boolean().optional()});Ct(!0);var lie=c4.extend({padding:Y.optional(),paddingLeft:Y.optional(),paddingRight:Y.optional(),paddingTop:Y.optional(),paddingBottom:Y.optional()});Ct(!0);var rEt=h.string().or(h.array(h.string()).readonly()).or(h.array(h.string())),sEt=h.custom().pipe(h.record(h.string(),rEt)),oEt=h.record(Is,Is.or(h.array(Is).readonly()).or(h.array(Is)));Ct(!0);var aEt=h.object({manufacturerPartNumber:h.string().optional(),supplierPartNumber:h.record(Nm,h.array(h.string())).optional()}),n_=Jn.extend({manufacturerPartNumber:h.string().optional(),pinLabels:oEt.optional(),showPinAliases:h.boolean().optional(),pcbPinLabels:h.record(h.string(),h.string()).optional(),internallyConnectedPins:h.array(h.array(h.union([h.string(),h.number()]))).optional(),externallyConnectedPins:h.array(h.array(h.string())).optional(),schPinArrangement:Mg.optional(),schPortArrangement:Mg.optional(),pinCompatibleVariants:h.array(aEt).optional(),schPinStyle:Cg.optional(),schPinSpacing:Y.optional(),schWidth:Y.optional(),schHeight:Y.optional(),noSchematicRepresentation:h.boolean().optional(),connections:sEt.optional()});Ct(!0);var MH=n_;Ct(!0);var u4=Jn.extend({manufacturerPartNumber:h.string().optional(),pinLabels:h.record(h.number().or(Is),Is.or(h.array(Is))).optional(),schPinStyle:Cg.optional(),schPinSpacing:Y.optional(),schWidth:Y.optional(),schHeight:Y.optional(),schDirection:h.enum(["left","right"]).optional(),schPinArrangement:o4.optional(),schPortArrangement:Mg.optional(),pcbPinLabels:h.record(h.string(),h.string()).optional(),pinCount:h.union([h.literal(2),h.literal(3)]).optional(),internallyConnectedPins:h.array(h.array(h.union([h.string(),h.number()]))).optional(),connections:h.custom().pipe(h.record(h.string(),e_)).optional()});Ct(!0);var CH=u4.extend({bridgedPins:h.array(h.array(h.string())).optional(),bridged:h.boolean().optional()});Ct(!0);var yie=Jn.extend({manufacturerPartNumber:h.string().optional(),pinLabels:h.record(h.number().or(Is),Is.or(h.array(Is))).optional(),schPinStyle:Cg.optional(),schPinSpacing:Y.optional(),schWidth:Y.optional(),schHeight:Y.optional(),schDirection:h.enum(["left","right"]).optional(),schPortArrangement:Mg.optional(),internallyConnectedPins:h.array(h.array(h.union([h.string(),h.number()]))).optional(),standard:h.enum(["usb_c","m2"]).optional()});Ct(!0);var IH=Jn.extend({currentRating:h.union([h.number(),h.string()]),voltageRating:h.union([h.number(),h.string()]).optional(),schShowRatings:h.boolean().optional(),schOrientation:Uc.optional(),connections:h.record(h.string(),h.union([h.string(),h.array(h.string()).readonly(),h.array(h.string())])).optional()}),hS=h.custom().transform(n=>{if(n!==void 0)return Y.parse(n)}),NH=h.discriminatedUnion("shape",[je.omit({pcbRotation:!0,layer:!0}).extend({name:h.string().optional(),connectsTo:h.string().or(h.array(h.string())).optional(),shape:h.literal("circle"),holeDiameter:Y,outerDiameter:Y,portHints:io.optional()}),je.omit({layer:!0}).extend({name:h.string().optional(),connectsTo:h.string().or(h.array(h.string())).optional(),shape:h.literal("oval"),outerWidth:Y,outerHeight:Y,holeWidth:hS,holeHeight:hS,innerWidth:Y.optional().describe("DEPRECATED use holeWidth"),innerHeight:Y.optional().describe("DEPRECATED use holeHeight"),portHints:io.optional()}),je.omit({layer:!0}).extend({name:h.string().optional(),connectsTo:h.string().or(h.array(h.string())).optional(),shape:h.literal("pill"),rectPad:h.boolean().optional(),outerWidth:Y,outerHeight:Y,holeWidth:hS,holeHeight:hS,innerWidth:Y.optional().describe("DEPRECATED use holeWidth"),innerHeight:Y.optional().describe("DEPRECATED use holeHeight"),portHints:io.optional(),holeOffsetX:Y.optional(),holeOffsetY:Y.optional()}),je.omit({pcbRotation:!0,layer:!0}).extend({name:h.string().optional(),connectsTo:h.string().or(h.array(h.string())).optional(),shape:h.literal("circular_hole_with_rect_pad"),holeDiameter:Y,rectPadWidth:Y,rectPadHeight:Y,rectBorderRadius:Y.optional(),holeShape:h.literal("circle").optional(),padShape:h.literal("rect").optional(),portHints:io.optional(),holeOffsetX:Y.optional(),holeOffsetY:Y.optional()}),je.omit({pcbRotation:!0,layer:!0}).extend({name:h.string().optional(),connectsTo:h.string().or(h.array(h.string())).optional(),shape:h.literal("pill_hole_with_rect_pad"),holeShape:h.literal("pill"),padShape:h.literal("rect"),holeWidth:Y,holeHeight:Y,rectPadWidth:Y,rectPadHeight:Y,portHints:io.optional(),holeOffsetX:Y.optional(),holeOffsetY:Y.optional()}),je.omit({pcbRotation:!0,layer:!0}).extend({name:h.string().optional(),connectsTo:h.string().or(h.array(h.string())).optional(),shape:h.literal("hole_with_polygon_pad"),holeShape:h.enum(["circle","oval","pill","rotated_pill"]),holeDiameter:Y.optional(),holeWidth:Y.optional(),holeHeight:Y.optional(),padOutline:h.array(Ro),holeOffsetX:Y,holeOffsetY:Y,portHints:io.optional()})]).refine(n=>("innerWidth"in n&&n.innerWidth!==void 0&&(n.holeWidth??(n.holeWidth=n.innerWidth)),"innerHeight"in n&&n.innerHeight!==void 0&&(n.holeHeight??(n.holeHeight=n.innerHeight)),n));Ct(!0);var cEt=["pin1","pin2","pos","neg"],AH=Jn.extend({resistance:Fc,pullupFor:h.string().optional(),pullupTo:h.string().optional(),pulldownFor:h.string().optional(),pulldownTo:h.string().optional(),schOrientation:Uc.optional(),connections:ed(cEt).optional()}),RH=s4;Ct(!0);var OH=Jn.extend({maxResistance:Fc,pinVariant:h.enum(["two_pin","three_pin"]).optional()});Ct(!0);var lEt=s4,LH=Jn.extend({frequency:hr,loadCapacitance:va,manufacturerPartNumber:h.string().optional(),mpn:h.string().optional(),pinVariant:h.enum(["two_pin","four_pin"]).optional(),schOrientation:Uc.optional(),connections:ed(lEt).optional()});Ct(!0);var FH=Jn.extend({frequency:hr,loadCapacitance:va,pinVariant:h.enum(["no_ground","ground_pin","two_ground_pins"]).optional()});Ct(!0);var Nie=l4.extend({leftPinCount:h.number().optional(),rightPinCount:h.number().optional(),topPinCount:h.number().optional(),bottomPinCount:h.number().optional(),leftPins:h.array(h.string()).optional(),rightPins:h.array(h.string()).optional(),topPins:h.array(h.string()).optional(),bottomPins:h.array(h.string()).optional(),pinPitch:Y.optional(),innerHoles:h.boolean().optional()});Ct(!0);var uEt=["pin1","pin2","pos","neg","anode","cathode"],zH=Jn.extend({capacitance:va,maxVoltageRating:Pi.optional(),schShowRatings:h.boolean().optional().default(!1),polarized:h.boolean().optional().default(!1),decouplingFor:h.string().optional(),decouplingTo:h.string().optional(),bypassFor:h.string().optional(),bypassTo:h.string().optional(),maxDecouplingTraceLength:h.number().optional(),schOrientation:Uc.optional(),connections:ed(uEt).optional()}),$H=mS;Ct(!0);var Lie=h.object({name:h.string(),connectsTo:h.string().or(h.array(h.string())).optional(),highlightColor:h.string().optional(),isPowerNet:h.boolean().optional(),isGroundNet:h.boolean().optional()});Ct(!0);var zie=h.object({name:h.string().optional(),pcbOnly:h.boolean().optional(),schOnly:h.boolean().optional()});Ct(!0);var pEt=h.object({pcb:h.literal(!0).optional(),xDist:Y,left:h.string(),right:h.string(),edgeToEdge:h.literal(!0).optional(),centerToCenter:h.literal(!0).optional()});Ct(!0);var hEt=h.object({pcb:h.literal(!0).optional(),yDist:Y,top:h.string(),bottom:h.string(),edgeToEdge:h.literal(!0).optional(),centerToCenter:h.literal(!0).optional()});Ct(!0);var dEt=h.object({pcb:h.literal(!0).optional(),sameY:h.literal(!0).optional(),for:h.array(h.string())});Ct(!0);var fEt=h.object({pcb:h.literal(!0).optional(),sameX:h.literal(!0).optional(),for:h.array(h.string())});Ct(!0);var DH=h.union([pEt,hEt,dEt,fEt]);Ct(!0);var mEt=je.omit({layer:!0,pcbRotation:!0}).extend({name:h.string().optional(),shape:h.literal("rect"),width:Y,height:Y});Ct(!0);var _Et=je.omit({layer:!0,pcbRotation:!0}).extend({name:h.string().optional(),shape:h.literal("circle"),radius:Y});Ct(!0);var yEt=je.omit({layer:!0,pcbRotation:!0}).extend({name:h.string().optional(),shape:h.literal("polygon"),points:h.array(Ro)});Ct(!0);var jH=h.discriminatedUnion("shape",[mEt,_Et,yEt]),gEt=je.omit({pcbRotation:!0}).extend({name:h.string().optional(),shape:h.literal("rect"),width:Y,height:Y,rectBorderRadius:Y.optional(),cornerRadius:Y.optional(),portHints:io.optional(),coveredWithSolderMask:h.boolean().optional()});Ct(!0);var xEt=je.omit({pcbRotation:!0}).extend({name:h.string().optional(),shape:h.literal("rotated_rect"),width:Y,height:Y,ccwRotation:h.number(),cornerRadius:Y.optional(),portHints:io.optional(),coveredWithSolderMask:h.boolean().optional()});Ct(!0);var bEt=je.omit({pcbRotation:!0}).extend({name:h.string().optional(),shape:h.literal("circle"),radius:Y,portHints:io.optional(),coveredWithSolderMask:h.boolean().optional()});Ct(!0);var vEt=je.omit({pcbRotation:!0}).extend({name:h.string().optional(),shape:h.literal("pill"),width:Y,height:Y,radius:Y,portHints:io.optional(),coveredWithSolderMask:h.boolean().optional()});Ct(!0);var SEt=je.omit({pcbRotation:!0}).extend({name:h.string().optional(),shape:h.literal("polygon"),points:h.array(Ro),portHints:io.optional(),coveredWithSolderMask:h.boolean().optional()});Ct(!0);var BH=h.discriminatedUnion("shape",[bEt,gEt,xEt,vEt,SEt]);Ct(!0);var wEt=je.omit({pcbRotation:!0}).extend({shape:h.literal("rect"),width:Y,height:Y});Ct(!0);var PEt=je.omit({pcbRotation:!0}).extend({shape:h.literal("circle"),radius:Y});Ct(!0);var Yie=h.union([PEt,wEt]);Ct(!0);var kEt=je.extend({name:h.string().optional(),shape:h.literal("circle").optional(),diameter:Y.optional(),radius:Y.optional()}).transform(n=>({...n,diameter:n.diameter??2*n.radius,radius:n.radius??n.diameter/2})),TEt=je.extend({name:h.string().optional(),shape:h.literal("pill"),width:Y,height:Y}),EEt=je.extend({name:h.string().optional(),shape:h.literal("rect"),width:Y,height:Y}),YH=h.union([kEt,TEt,EEt]);Ct(!0);var n4=h.union([h.string(),h.custom(n=>!!n.getPortSelector)]),yH=h.object({key:h.string().optional(),thickness:Y.optional(),width:Y.optional().describe("Alias for trace thickness"),schematicRouteHints:h.array(Ro).optional(),pcbRouteHints:h.array(Qi).optional(),pcbPathRelativeTo:h.string().optional(),pcbPath:h.array(h.union([Ro,h.string()])).optional(),schDisplayLabel:h.string().optional(),schStroke:h.string().optional(),highlightColor:h.string().optional(),maxLength:Y.optional()}),XH=h.union([yH.extend({path:h.array(n4)}),yH.extend({from:n4,to:n4})]),UH=h.object({children:h.any().optional(),originalLayer:pe.default("top").optional(),circuitJson:h.array(h.any()).optional()});Ct(!0);var VH=h.object({originalFacingDirection:h.enum(["up","down","left","right"]).default("right").optional()});Ct(!0);var MEt=h.number().or(h.string().endsWith("mAh")).transform(n=>{if(typeof n=="string"){let e=n.replace("mAh",""),t=Number.parseFloat(e);if(Number.isNaN(t))throw new Error("Invalid capacity");return t}return n}).describe("Battery capacity in mAh"),GH=Jn.extend({capacity:MEt.optional(),voltage:Pi.optional(),standard:h.enum(["AA","AAA","9V","CR2032","18650","C"]).optional(),schOrientation:Uc.optional()});Ct(!0);var CEt=h.enum(["vertical","horizontal"]).describe("vertical means pins go 1->2 downward and horizontal means pins go 1->2 rightward");Ct(!0);var HH=Jn.extend({pinCount:h.number(),pitch:Y.optional(),schFacingDirection:h.enum(["up","down","left","right"]).optional(),gender:h.enum(["male","female","unpopulated"]).optional().default("male"),showSilkscreenPinLabels:h.boolean().optional(),pcbPinLabels:h.record(h.string(),h.string()).optional(),doubleRow:h.boolean().optional(),rightAngle:h.boolean().optional(),pcbOrientation:CEt.optional(),holeDiameter:Y.optional(),platedDiameter:Y.optional(),pinLabels:h.record(h.string(),Is).or(h.array(Is)).optional(),connections:h.custom().pipe(h.record(h.string(),e_)).optional(),facingDirection:h.enum(["left","right"]).optional(),schPinArrangement:o4.optional(),schPinStyle:Cg.optional(),schPinSpacing:Y.optional(),schWidth:Y.optional(),schHeight:Y.optional()});Ct(!0);var nre=h.object({net:h.string().optional(),connection:h.string().optional(),schX:Y.optional(),schY:Y.optional(),schRotation:He.optional(),anchorSide:h.enum(["left","top","right","bottom"]).optional()});Ct(!0);var WH=h.object({net:h.string().optional(),connection:h.string().optional(),connectsTo:h.string().or(h.array(h.string())).optional(),schX:Y.optional(),schY:Y.optional(),schRotation:He.optional(),anchorSide:h.enum(["left","top","right","bottom"]).optional()});Ct(!0);var qH=n_.extend({});Ct(!0);Ct(!0);var IEt=h.custom(n=>typeof n=="string"),ZH=h.object({simulationType:h.literal("spice_transient_analysis").default("spice_transient_analysis"),duration:pr.optional(),timePerStep:pr.optional(),spiceEngine:IEt.optional()});Ct(!0);var NEt=["pin1","pin2","pin3","emitter","collector","base","gate","source","drain"],KH=Jn.extend({type:h.enum(["npn","pnp","bjt","jfet","mosfet","igbt"]),connections:ed(NEt).optional()});Ct(!0);var JH=Jn.extend({channelType:h.enum(["n","p"]),mosfetMode:h.enum(["enhancement","depletion"])});Ct(!0);var AEt=s4,QH=Jn.extend({inductance:Bx,maxCurrentRating:h.union([h.string(),h.number()]).optional(),schOrientation:Uc.optional(),connections:ed(AEt).optional()});Ct(!0);var REt=h.enum(["anode","cathode","pin1","pin2","pos","neg"]),OEt=h.string().or(h.array(h.string()).readonly()).or(h.array(h.string())),LEt=h.record(REt,OEt),FEt=h.enum(["standard","schottky","zener","avalanche","photo","tvs"]),tW=Jn.extend({connections:LEt.optional(),variant:FEt.optional().default("standard"),standard:h.boolean().optional(),schottky:h.boolean().optional(),zener:h.boolean().optional(),avalanche:h.boolean().optional(),photo:h.boolean().optional(),tvs:h.boolean().optional(),schOrientation:Uc.optional()}).superRefine((n,e)=>{if([n.standard,n.schottky,n.zener,n.avalanche,n.photo,n.tvs].filter(Boolean).length>1)return e.addIssue({code:h.ZodIssueCode.custom,message:"Exactly one diode variant must be enabled",path:[]}),h.INVALID}).transform(n=>{let e={...n,standard:!1,schottky:!1,zener:!1,avalanche:!1,photo:!1,tvs:!1};if(n.standard)e.standard=!0;else if(n.schottky)e.schottky=!0;else if(n.zener)e.zener=!0;else if(n.photo)e.photo=!0;else if(n.tvs)e.tvs=!0;else switch(n.variant){case"standard":e.standard=!0;break;case"schottky":e.schottky=!0;break;case"zener":e.zener=!0;break;case"avalanche":e.avalanche=!0;break;case"photo":e.photo=!0;break;case"tvs":e.tvs=!0;break;default:e.standard=!0}return e}),eW=mS;Ct(!0);var nW=Jn.extend({color:h.string().optional(),wavelength:h.string().optional(),schDisplayValue:h.string().optional(),schOrientation:Uc.optional(),connections:ed(mS).optional(),laser:h.boolean().optional()}),iW=mS,rW=Jn.extend({type:h.enum(["spst","spdt","dpst","dpdt"]).optional(),isNormallyClosed:h.boolean().optional().default(!1),spst:h.boolean().optional(),spdt:h.boolean().optional(),dpst:h.boolean().optional(),dpdt:h.boolean().optional(),simSwitchFrequency:hr.optional(),simCloseAt:pr.optional(),simOpenAt:pr.optional(),simStartClosed:h.boolean().optional(),simStartOpen:h.boolean().optional(),connections:h.custom().pipe(h.record(h.string(),e_)).optional()}).transform(n=>{let e={...n};switch(e.dpdt?e.type="dpdt":e.spst?e.type="spst":e.spdt?e.type="spdt":e.dpst&&(e.type="dpst"),e.type){case"spdt":e.spdt=!0;break;case"spst":e.spst=!0;break;case"dpst":e.dpst=!0;break;case"dpdt":e.dpdt=!0;break}return e});Ct(!0);var sW=je.extend({text:h.string(),anchorAlignment:h.enum(["center","top_left","top_right","bottom_left","bottom_right"]).default("center"),font:h.enum(["tscircuit2024"]).optional(),fontSize:D.optional(),color:h.string().optional()});Ct(!0);var oW=je.omit({pcbRotation:!0}).extend({width:Y,height:Y,strokeWidth:Y.optional(),isFilled:h.boolean().optional(),hasStroke:h.boolean().optional(),isStrokeDashed:h.boolean().optional(),color:h.string().optional(),cornerRadius:Y.optional()}),aW=je.omit({pcbX:!0,pcbY:!0,pcbOffsetX:!0,pcbOffsetY:!0,pcbRotation:!0}).extend({route:h.array(Qi),strokeWidth:D.optional(),color:h.string().optional()}),gH=h.union([h.string(),Ro]),cW=je.omit({pcbX:!0,pcbY:!0,pcbOffsetX:!0,pcbOffsetY:!0,pcbRotation:!0}).extend({from:gH,to:gH,text:h.string().optional(),offset:Y.optional(),font:h.enum(["tscircuit2024"]).optional(),fontSize:D.optional(),color:h.string().optional(),arrowSize:Y.optional(),units:h.enum(["in","mm"]).optional(),outerEdgeToEdge:h.literal(!0).optional(),centerToCenter:h.literal(!0).optional(),innerEdgeToEdge:h.literal(!0).optional()});Ct(!0);var kre=h.object({layer:h.string().optional(),thickness:Y.optional(),route:h.array(Qi)}),lW=fS.extend({name:h.string().optional(),fromLayer:pe,toLayer:pe,holeDiameter:Y,outerDiameter:Y,connectsTo:h.string().or(h.array(h.string())).optional(),netIsAssignable:h.boolean().optional()});Ct(!0);var zEt=h.object({pin1:e_}).strict(),uW=Jn.extend({connections:zEt.optional(),footprintVariant:h.enum(["pad","through_hole"]).optional(),padShape:h.enum(["rect","circle"]).optional().default("circle"),padDiameter:Y.optional(),holeDiameter:Y.optional(),width:Y.optional(),height:Y.optional()}).refine(n=>n.footprintVariant!=="through_hole"||n.holeDiameter!==void 0,{message:"holeDiameter is required for through_hole testpoints"});Ct(!0);var pW=je.omit({pcbRotation:!0,layer:!0}).extend({connection:h.string()});Ct(!0);var hW=h.union([je.omit({pcbRotation:!0}).extend({shape:h.literal("circle"),radius:Y}),je.extend({shape:h.literal("rect"),width:Y,height:Y})]),Lre=je.omit({pcbRotation:!0}).extend({width:Y,height:Y,strokeWidth:Y.optional(),isFilled:h.boolean().optional(),hasStroke:h.boolean().optional(),isStrokeDashed:h.boolean().optional(),color:h.string().optional()}),$re=je.omit({pcbX:!0,pcbY:!0,pcbOffsetX:!0,pcbOffsetY:!0,pcbRotation:!0}).extend({outline:h.array(Ro),strokeWidth:D.optional(),isClosed:h.boolean().optional(),isStrokeDashed:h.boolean().optional(),color:h.string().optional()}),dW=h.object({name:h.string().optional(),layer:pe,connectsTo:h.string(),padMargin:Y.optional(),traceMargin:Y.optional(),clearance:Y.optional(),boardEdgeMargin:Y.optional(),cutoutMargin:Y.optional(),coveredWithSolderMask:h.boolean().optional().default(!0)});Ct(!0);var fW=h.object({originalLayer:pe.default("top").optional(),children:h.any().optional()});Ct(!0);var $Et=h.object({pcbX:Y.optional(),pcbY:Y.optional(),pcbOffsetX:Y.optional(),pcbOffsetY:Y.optional(),pcbZ:Y.optional()}),DEt=Xc.extend({modelUrl:h.string(),stepUrl:h.string().optional()}),jEt=DEt.merge($Et);Ct(!0);var mW=h.union([h.null(),h.string(),jEt]),_W=Jn.extend({voltage:Pi}),BEt=["pin1","pin2","pos","neg"],YEt=h.union([h.string(),h.number()]).transform(n=>typeof n=="string"?n.endsWith("%")?parseFloat(n.slice(0,-1))/100:parseFloat(n):n).pipe(h.number().min(0,"Duty cycle must be non-negative").max(1,"Duty cycle cannot be greater than 100%")),Hre=Jn.extend({voltage:Pi.optional(),frequency:hr.optional(),peakToPeakVoltage:Pi.optional(),waveShape:h.enum(["sinewave","square","triangle","sawtooth"]).optional(),phase:He.optional(),dutyCycle:YEt.optional(),connections:ed(BEt).optional()});Ct(!0);var yW=Jn.omit({name:!0}).extend({name:h.string().optional(),connectsTo:h.string().or(h.array(h.string()))});Ct(!0);var gW=h.object({center:Zt,radius:Y,startAngleDegrees:He,endAngleDegrees:He,direction:h.enum(["clockwise","counterclockwise"]).default("counterclockwise"),strokeWidth:Y.optional(),color:h.string().optional(),isDashed:h.boolean().optional().default(!1)}),xW=h.object({schX:Y.optional(),schY:Y.optional(),width:Y.optional(),height:Y.optional(),overlay:h.array(h.string()).optional(),padding:Y.optional(),paddingLeft:Y.optional(),paddingRight:Y.optional(),paddingTop:Y.optional(),paddingBottom:Y.optional(),title:h.string().optional(),titleAlignment:t_.default("top_left"),titleColor:h.string().optional(),titleFontSize:Y.optional(),titleInside:h.boolean().default(!1),strokeStyle:h.enum(["solid","dashed"]).default("solid")}).refine(n=>n.width!==void 0&&n.height!==void 0||Array.isArray(n.overlay)&&n.overlay.length>0,{message:"Must provide either both `width` and `height`, or a non-empty `overlay` array."}).refine(n=>!(n.width!==void 0&&n.height!==void 0&&Array.isArray(n.overlay)&&n.overlay.length>0),{message:"Cannot provide both `width`/`height` and `overlay` at the same time."}),bW=h.object({center:Zt,radius:Y,strokeWidth:Y.optional(),color:h.string().optional(),isFilled:h.boolean().optional().default(!1),fillColor:h.string().optional(),isDashed:h.boolean().optional().default(!1)}),vW=h.object({schX:Y.optional(),schY:Y.optional(),width:Y,height:Y,rotation:He.default(0),strokeWidth:Y.optional(),color:h.string().optional(),isFilled:h.boolean().optional().default(!1),fillColor:h.string().optional(),isDashed:h.boolean().optional().default(!1),cornerRadius:Y.optional()}),SW=h.object({x1:Y,y1:Y,x2:Y,y2:Y,strokeWidth:Y.optional(),color:h.string().optional(),isDashed:h.boolean().optional().default(!1)}),XEt=h.enum(["center","left","right","top","bottom"]),wW=h.object({schX:Y.optional(),schY:Y.optional(),text:h.string(),fontSize:h.number().default(1),anchor:h.union([XEt.describe("legacy"),t_]).default("center"),color:h.string().default("#000000"),schRotation:He.default(0)}),use=h.object({points:h.array(Zt),isFilled:h.boolean().optional().default(!1),fillColor:h.enum(["red","blue"]).optional()}),PW=h.object({schX:Y.optional(),schY:Y.optional(),children:h.any().optional(),cellPadding:Y.optional(),borderWidth:Y.optional(),anchor:t_.optional(),fontSize:Y.optional()});Ct(!0);var kW=h.object({children:h.any().optional(),height:Y.optional()});Ct(!0);var TW=h.object({children:h.string().optional(),horizontalAlign:h.enum(["left","center","right"]).optional(),verticalAlign:h.enum(["top","middle","bottom"]).optional(),fontSize:Y.optional(),rowSpan:h.number().optional(),colSpan:h.number().optional(),width:Y.optional(),text:h.string().optional()});Ct(!0);var xse=je.extend({text:h.string(),anchorAlignment:t_.default("center"),font:h.enum(["tscircuit2024"]).optional(),fontSize:D.optional(),layers:h.array(pe).optional()}),EW=je.extend({text:h.string(),anchorAlignment:t_.default("center"),font:h.enum(["tscircuit2024"]).optional(),fontSize:D.optional(),isKnockout:h.boolean().optional(),knockoutPadding:D.optional(),knockoutPaddingLeft:D.optional(),knockoutPaddingRight:D.optional(),knockoutPaddingTop:D.optional(),knockoutPaddingBottom:D.optional(),layers:h.array(pe).optional()}),MW=je.omit({pcbX:!0,pcbY:!0,pcbOffsetX:!0,pcbOffsetY:!0,pcbRotation:!0}).extend({route:h.array(Qi),strokeWidth:D.optional()}),CW=je.omit({pcbX:!0,pcbY:!0,pcbOffsetX:!0,pcbOffsetY:!0,pcbRotation:!0}).extend({strokeWidth:Y,x1:Y,y1:Y,x2:Y,y2:Y}),IW=je.omit({pcbRotation:!0}).extend({filled:h.boolean().default(!0).optional(),stroke:h.enum(["dashed","solid","none"]).optional(),strokeWidth:Y.optional(),width:Y,height:Y,cornerRadius:Y.optional()}),NW=je.omit({pcbRotation:!0}).extend({isFilled:h.boolean().optional(),isOutline:h.boolean().optional(),strokeWidth:Y.optional(),radius:Y}),xH=h.object({x:Y,y:Y,via:h.boolean().optional(),toLayer:pe.optional()}),AW=h.object({for:h.string().optional().describe("Selector for the port you're targeting, not required if you're inside a trace"),order:h.number().optional(),offset:Qi.or(xH).optional(),offsets:h.array(Qi).or(h.array(xH)).optional(),traceWidth:h.number().optional()}),Ase=fS.extend({name:h.string(),pinNumber:h.number().optional(),aliases:h.array(h.string()).optional(),direction:R3t,connectsTo:h.string().or(h.array(h.string())).optional()}),RW=je.extend({text:h.string(),anchorAlignment:h.enum(["center","top_left","top_right","bottom_left","bottom_right"]).default("center"),font:h.enum(["tscircuit2024"]).optional(),fontSize:D.optional(),color:h.string().optional()});Ct(!0);var OW=je.omit({pcbRotation:!0}).extend({width:Y,height:Y,strokeWidth:Y.optional(),isFilled:h.boolean().optional(),hasStroke:h.boolean().optional(),isStrokeDashed:h.boolean().optional(),color:h.string().optional(),cornerRadius:Y.optional()});Ct(!0);var LW=je.omit({pcbX:!0,pcbY:!0,pcbOffsetX:!0,pcbOffsetY:!0,pcbRotation:!0}).extend({route:h.array(Qi),strokeWidth:D.optional(),color:h.string().optional()});Ct(!0);var FW=je.omit({pcbX:!0,pcbY:!0,pcbOffsetX:!0,pcbOffsetY:!0,pcbRotation:!0}).extend({x1:Y,y1:Y,x2:Y,y2:Y,strokeWidth:Y.optional(),color:h.string().optional(),isDashed:h.boolean().optional()});Ct(!0);var bH=h.union([h.string(),Ro]),zW=je.omit({pcbX:!0,pcbY:!0,pcbOffsetX:!0,pcbOffsetY:!0,pcbRotation:!0}).extend({from:bH,to:bH,text:h.string().optional(),offset:Y.optional(),font:h.enum(["tscircuit2024"]).optional(),fontSize:D.optional(),color:h.string().optional(),arrowSize:Y.optional(),units:h.enum(["in","mm"]).optional(),outerEdgeToEdge:h.literal(!0).optional(),centerToCenter:h.literal(!0).optional(),innerEdgeToEdge:h.literal(!0).optional()});Ct(!0);var $W=h.array(h.any()).describe("Circuit JSON"),i4=h.object({footprintCircuitJson:h.array(h.any()),cadModel:wH.optional()}),vH=h.function().args(h.string()).returns(h.promise(i4)).or(h.function().args(h.string(),h.object({resolvedPcbStyle:r4.optional()}).optional()).returns(h.promise(i4))).describe("A function that takes a path and returns Circuit JSON"),UEt=h.object({loadFromUrl:h.function().args(h.string()).returns(h.promise(i4)).describe("A function that takes a footprint file URL and returns Circuit JSON")}),VEt=h.object({engineVersionString:h.string().optional(),simulationResultCircuitJson:$W}),GEt=h.object({simulate:h.function().args(h.string()).returns(h.promise(VEt)).describe("A function that takes a SPICE string and returns a simulation result")}),HEt=h.custom(n=>typeof n=="string"),SH=h.object({run:h.function().args().returns(h.promise(h.unknown())).describe("Run the autorouter"),getOutputSimpleRouteJson:h.function().args().returns(h.promise(h.any())).describe("Get the resulting SimpleRouteJson")}),WEt=h.object({createAutorouter:h.function().args(h.any(),h.any().optional()).returns(h.union([SH,h.promise(SH)])).describe("Create an autorouter instance")}),qEt=h.object({partsEngine:kH.optional(),autorouter:PH.optional(),autorouterMap:h.record(h.string(),WEt).optional(),registryApiUrl:h.string().optional(),cloudAutorouterUrl:h.string().optional(),projectName:h.string().optional(),projectBaseUrl:h.string().optional(),version:h.string().optional(),url:h.string().optional(),printBoardInformationToSilkscreen:h.boolean().optional(),includeBoardFiles:h.array(h.string()).describe('The board files to automatically build with "tsci build", defaults to ["**/*.circuit.tsx"]. Can be an array of files or globs').optional(),snapshotsDir:h.string().describe('The directory where snapshots are stored for "tsci snapshot", defaults to "tests/__snapshots__"').optional(),defaultSpiceEngine:HEt.optional(),localCacheEngine:h.any().optional(),pcbDisabled:h.boolean().optional(),schematicDisabled:h.boolean().optional(),partsEngineDisabled:h.boolean().optional(),spiceEngineMap:h.record(h.string(),GEt).optional(),footprintLibraryMap:h.record(h.string(),h.union([vH,h.record(h.string(),h.union([$W,vH]))])).optional(),footprintFileParserMap:h.record(h.string(),UEt).optional(),resolveProjectStaticFileImportUrl:h.function().args(h.string()).returns(h.promise(h.string())).describe("A function that returns a string URL for static files for the project").optional()});Ct(!0);var ZEt=qEt,Use=ZEt.pick({projectName:!0,projectBaseUrl:!0,version:!0,url:!0,printBoardInformationToSilkscreen:!0,includeBoardFiles:!0,snapshotsDir:!0,defaultSpiceEngine:!0});Ct(!0);St();Q();St();Ta();Q();var Ua=Gt(qs(),1);Ta();Q();function Vc(){return new p4}var p4=class n{constructor(){d(this,"index",{});d(this,"array",[])}size(){return this.array.length}empty(){return this.array.length===0}itemAt(e){return this.array[e]}contains(e){return this.index[e.id()]!==void 0}find(e){let t=this.index[e.id()];return t===void 0?void 0:this.array[t]}setDefault(e,t){let i=this.index[e.id()];if(i===void 0){let r=new _S(e,t());return this.index[e.id()]=this.array.length,this.array.push(r),r}else return this.array[i]}insert(e,t){let i=new _S(e,t),r=this.index[e.id()];return r===void 0?(this.index[e.id()]=this.array.length,this.array.push(i)):this.array[r]=i,i}erase(e){let t=this.index[e.id()];if(t===void 0)return;this.index[e.id()]=void 0;let i=this.array[t],r=this.array.pop();return i!==r&&(this.array[t]=r,this.index[r.first.id()]=t),i}copy(){let e=new n;for(let t=0;t<this.array.length;t++){let i=this.array[t].copy();e.array[t]=i,e.index[i.first.id()]=t}return e}},_S=class n{constructor(e,t){d(this,"first");d(this,"second");this.first=e,this.second=t}copy(){return new n(this.first,this.second)}};var Ia=class{constructor(e=""){d(this,"_name");d(this,"_value",0);d(this,"_context",null);d(this,"_id",KEt++);this._name=e}id(){return this._id}name(){return this._name}setName(e){this._name=e}context(){return this._context}setContext(e){this._context=e}value(){return this._value}setValue(e){this._value=e}plus(e){return new Dn(this,e)}minus(e){return new Dn(this,typeof e=="number"?-e:[-1,e])}multiply(e){return new Dn([e,this])}divide(e){return new Dn([1/e,this])}toJSON(){return{name:this._name,value:this._value}}toString(){return this._context+"["+this._name+":"+this._value+"]"}},KEt=0;var Dn=class n{constructor(){d(this,"_terms");d(this,"_constant");let e=JEt(arguments);this._terms=e.terms,this._constant=e.constant}terms(){return this._terms}constant(){return this._constant}value(){let e=this._constant;for(let t=0,i=this._terms.size();t<i;t++){let r=this._terms.itemAt(t);e+=r.first.value()*r.second}return e}plus(e){return new n(this,e)}minus(e){return new n(this,typeof e=="number"?-e:[-1,e])}multiply(e){return new n([e,this])}divide(e){return new n([1/e,this])}isConstant(){return this._terms.size()==0}toString(){let e=this._terms.array.map(function(t){return t.second+"*"+t.first.toString()}).join(" + ");return!this.isConstant()&&this._constant!==0&&(e+=" + "),e+=this._constant,e}};function JEt(n){let e=0,t=()=>0,i=Vc();for(let r=0,s=n.length;r<s;++r){let o=n[r];if(typeof o=="number")e+=o;else if(o instanceof Ia)i.setDefault(o,t).second+=1;else if(o instanceof Dn){e+=o.constant();let a=o.terms();for(let c=0,l=a.size();c<l;c++){let u=a.itemAt(c);i.setDefault(u.first,t).second+=u.second}}else if(o instanceof Array){if(o.length!==2)throw new Error("array must have length 2");let a=o[0],c=o[1];if(typeof a!="number")throw new Error("array item 0 must be a number");if(c instanceof Ia)i.setDefault(c,t).second+=a;else if(c instanceof Dn){e+=c.constant()*a;let l=c.terms();for(let u=0,p=l.size();u<p;u++){let f=l.itemAt(u);i.setDefault(f.first,t).second+=f.second*a}}else throw new Error("array item 1 must be a variable or expression")}else throw new Error("invalid Expression argument: "+o)}return{terms:i,constant:e}}var ro=class ro{static create(e,t,i,r=1){let s=0;return s+=Math.max(0,Math.min(1e3,e*r))*1e6,s+=Math.max(0,Math.min(1e3,t*r))*1e3,s+=Math.max(0,Math.min(1e3,i*r)),s}static clip(e){return Math.max(0,Math.min(ro.required,e))}};d(ro,"required",ro.create(1e3,1e3,1e3)),d(ro,"strong",ro.create(1,0,0)),d(ro,"medium",ro.create(0,1,0)),d(ro,"weak",ro.create(0,0,1));var On=ro;var oi;(function(n){n[n.Le=0]="Le",n[n.Ge=1]="Ge",n[n.Eq=2]="Eq"})(oi||(oi={}));var ki=class{constructor(e,t,i,r=On.required){d(this,"_expression");d(this,"_operator");d(this,"_strength");d(this,"_id",QEt++);this._operator=t,this._strength=On.clip(r),i===void 0&&e instanceof Dn?this._expression=e:this._expression=e.minus(i)}id(){return this._id}expression(){return this._expression}op(){return this._operator}strength(){return this._strength}toString(){return this._expression.toString()+" "+["<=",">=","="][this._operator]+" 0 ("+this._strength.toString()+")"}},QEt=0;var i_=class{constructor(){d(this,"maxIterations",1e3);d(this,"_cnMap",tMt());d(this,"_rowMap",eMt());d(this,"_varMap",nMt());d(this,"_editMap",iMt());d(this,"_infeasibleRows",[]);d(this,"_objective",new xS);d(this,"_artificial",null);d(this,"_idTick",0)}createConstraint(e,t,i,r=On.required){let s=new ki(e,t,i,r);return this.addConstraint(s),s}addConstraint(e){if(this._cnMap.find(e)!==void 0)throw new Error("duplicate constraint");let i=this._createRow(e),r=i.row,s=i.tag,o=this._chooseSubject(r,s);if(o.type()===nn.Invalid&&r.allDummies())if(yS(r.constant()))o=s.marker;else throw new Error("unsatisfiable constraint");if(o.type()===nn.Invalid){if(!this._addWithArtificialVariable(r))throw new Error("unsatisfiable constraint")}else r.solveFor(o),this._substitute(o,r),this._rowMap.insert(o,r);this._cnMap.insert(e,s),this._optimize(this._objective)}removeConstraint(e){let t=this._cnMap.erase(e);if(t===void 0)throw new Error("unknown constraint");this._removeConstraintEffects(e,t.second);let i=t.second.marker,r=this._rowMap.erase(i);if(r===void 0){let s=this._getMarkerLeavingSymbol(i);if(s.type()===nn.Invalid)throw new Error("failed to find leaving row");r=this._rowMap.erase(s),r.second.solveForEx(s,i),this._substitute(i,r.second)}this._optimize(this._objective)}hasConstraint(e){return this._cnMap.contains(e)}getConstraints(){return this._cnMap.array.map(({first:e})=>e)}addEditVariable(e,t){if(this._editMap.find(e)!==void 0)throw new Error("duplicate edit variable");if(t=On.clip(t),t===On.required)throw new Error("bad required strength");let r=new Dn(e),s=new ki(r,oi.Eq,void 0,t);this.addConstraint(s);let a={tag:this._cnMap.find(s).second,constraint:s,constant:0};this._editMap.insert(e,a)}removeEditVariable(e){let t=this._editMap.erase(e);if(t===void 0)throw new Error("unknown edit variable");this.removeConstraint(t.second.constraint)}hasEditVariable(e){return this._editMap.contains(e)}suggestValue(e,t){let i=this._editMap.find(e);if(i===void 0)throw new Error("unknown edit variable");let r=this._rowMap,s=i.second,o=t-s.constant;s.constant=t;let a=s.tag.marker,c=r.find(a);if(c!==void 0){c.second.add(-o)<0&&this._infeasibleRows.push(a),this._dualOptimize();return}let l=s.tag.other;if(c=r.find(l),c!==void 0){c.second.add(o)<0&&this._infeasibleRows.push(l),this._dualOptimize();return}for(let u=0,p=r.size();u<p;++u){let f=r.itemAt(u),y=f.second,g=y.coefficientFor(a);g!==0&&y.add(o*g)<0&&f.first.type()!==nn.External&&this._infeasibleRows.push(f.first)}this._dualOptimize()}updateVariables(){let e=this._varMap,t=this._rowMap;for(let i=0,r=e.size();i<r;++i){let s=e.itemAt(i),o=t.find(s.second);o!==void 0?s.first.setValue(o.second.constant()):s.first.setValue(0)}}_getVarSymbol(e){let t=()=>this._makeSymbol(nn.External);return this._varMap.setDefault(e,t).second}_createRow(e){let t=e.expression(),i=new xS(t.constant()),r=t.terms();for(let c=0,l=r.size();c<l;++c){let u=r.itemAt(c);if(!yS(u.second)){let p=this._getVarSymbol(u.first),f=this._rowMap.find(p);f!==void 0?i.insertRow(f.second,u.second):i.insertSymbol(p,u.second)}}let s=this._objective,o=e.strength(),a={marker:Gc,other:Gc};switch(e.op()){case oi.Le:case oi.Ge:{let c=e.op()===oi.Le?1:-1,l=this._makeSymbol(nn.Slack);if(a.marker=l,i.insertSymbol(l,c),o<On.required){let u=this._makeSymbol(nn.Error);a.other=u,i.insertSymbol(u,-c),s.insertSymbol(u,o)}break}case oi.Eq:{if(o<On.required){let c=this._makeSymbol(nn.Error),l=this._makeSymbol(nn.Error);a.marker=c,a.other=l,i.insertSymbol(c,-1),i.insertSymbol(l,1),s.insertSymbol(c,o),s.insertSymbol(l,o)}else{let c=this._makeSymbol(nn.Dummy);a.marker=c,i.insertSymbol(c)}break}}return i.constant()<0&&i.reverseSign(),{row:i,tag:a}}_chooseSubject(e,t){let i=e.cells();for(let s=0,o=i.size();s<o;++s){let a=i.itemAt(s);if(a.first.type()===nn.External)return a.first}let r=t.marker.type();return(r===nn.Slack||r===nn.Error)&&e.coefficientFor(t.marker)<0?t.marker:(r=t.other.type(),(r===nn.Slack||r===nn.Error)&&e.coefficientFor(t.other)<0?t.other:Gc)}_addWithArtificialVariable(e){let t=this._makeSymbol(nn.Slack);this._rowMap.insert(t,e.copy()),this._artificial=e.copy(),this._optimize(this._artificial);let i=yS(this._artificial.constant());this._artificial=null;let r=this._rowMap.erase(t);if(r!==void 0){let o=r.second;if(o.isConstant())return i;let a=this._anyPivotableSymbol(o);if(a.type()===nn.Invalid)return!1;o.solveForEx(t,a),this._substitute(a,o),this._rowMap.insert(a,o)}let s=this._rowMap;for(let o=0,a=s.size();o<a;++o)s.itemAt(o).second.removeSymbol(t);return this._objective.removeSymbol(t),i}_substitute(e,t){let i=this._rowMap;for(let r=0,s=i.size();r<s;++r){let o=i.itemAt(r);o.second.substitute(e,t),o.second.constant()<0&&o.first.type()!==nn.External&&this._infeasibleRows.push(o.first)}this._objective.substitute(e,t),this._artificial&&this._artificial.substitute(e,t)}_optimize(e){let t=0;for(;t<this.maxIterations;){let i=this._getEnteringSymbol(e);if(i.type()===nn.Invalid)return;let r=this._getLeavingSymbol(i);if(r.type()===nn.Invalid)throw new Error("the objective is unbounded");let s=this._rowMap.erase(r).second;s.solveForEx(r,i),this._substitute(i,s),this._rowMap.insert(i,s),t++}throw new Error("solver iterations exceeded")}_dualOptimize(){let e=this._rowMap,t=this._infeasibleRows;for(;t.length!==0;){let i=t.pop(),r=e.find(i);if(r!==void 0&&r.second.constant()<0){let s=this._getDualEnteringSymbol(r.second);if(s.type()===nn.Invalid)throw new Error("dual optimize failed");let o=r.second;e.erase(i),o.solveForEx(i,s),this._substitute(s,o),e.insert(s,o)}}}_getEnteringSymbol(e){let t=e.cells();for(let i=0,r=t.size();i<r;++i){let s=t.itemAt(i),o=s.first;if(s.second<0&&o.type()!==nn.Dummy)return o}return Gc}_getDualEnteringSymbol(e){let t=Number.MAX_VALUE,i=Gc,r=e.cells();for(let s=0,o=r.size();s<o;++s){let a=r.itemAt(s),c=a.first,l=a.second;if(l>0&&c.type()!==nn.Dummy){let p=this._objective.coefficientFor(c)/l;p<t&&(t=p,i=c)}}return i}_getLeavingSymbol(e){let t=Number.MAX_VALUE,i=Gc,r=this._rowMap;for(let s=0,o=r.size();s<o;++s){let a=r.itemAt(s),c=a.first;if(c.type()!==nn.External){let l=a.second,u=l.coefficientFor(e);if(u<0){let p=-l.constant()/u;p<t&&(t=p,i=c)}}}return i}_getMarkerLeavingSymbol(e){let t=Number.MAX_VALUE,i=t,r=t,s=Gc,o=s,a=s,c=s,l=this._rowMap;for(let u=0,p=l.size();u<p;++u){let f=l.itemAt(u),y=f.second,g=y.coefficientFor(e);if(g===0)continue;let x=f.first;if(x.type()===nn.External)c=x;else if(g<0){let v=-y.constant()/g;v<i&&(i=v,o=x)}else{let v=y.constant()/g;v<r&&(r=v,a=x)}}return o!==s?o:a!==s?a:c}_removeConstraintEffects(e,t){t.marker.type()===nn.Error&&this._removeMarkerEffects(t.marker,e.strength()),t.other.type()===nn.Error&&this._removeMarkerEffects(t.other,e.strength())}_removeMarkerEffects(e,t){let i=this._rowMap.find(e);i!==void 0?this._objective.insertRow(i.second,-t):this._objective.insertSymbol(e,-t)}_anyPivotableSymbol(e){let t=e.cells();for(let i=0,r=t.size();i<r;++i){let s=t.itemAt(i),o=s.first.type();if(o===nn.Slack||o===nn.Error)return s.first}return Gc}_makeSymbol(e){return new gS(e,this._idTick++)}};function yS(n){let e=1e-8;return n<0?-n<e:n<e}function tMt(){return Vc()}function eMt(){return Vc()}function nMt(){return Vc()}function iMt(){return Vc()}var nn;(function(n){n[n.Invalid=0]="Invalid",n[n.External=1]="External",n[n.Slack=2]="Slack",n[n.Error=3]="Error",n[n.Dummy=4]="Dummy"})(nn||(nn={}));var gS=class{constructor(e,t){d(this,"_id");d(this,"_type");this._id=t,this._type=e}id(){return this._id}type(){return this._type}},Gc=new gS(nn.Invalid,-1),xS=class n{constructor(e=0){d(this,"_cellMap",Vc());d(this,"_constant");this._constant=e}cells(){return this._cellMap}constant(){return this._constant}isConstant(){return this._cellMap.empty()}allDummies(){let e=this._cellMap;for(let t=0,i=e.size();t<i;++t)if(e.itemAt(t).first.type()!==nn.Dummy)return!1;return!0}copy(){let e=new n(this._constant);return e._cellMap=this._cellMap.copy(),e}add(e){return this._constant+=e}insertSymbol(e,t=1){let i=this._cellMap.setDefault(e,()=>0);yS(i.second+=t)&&this._cellMap.erase(e)}insertRow(e,t=1){this._constant+=e._constant*t;let i=e._cellMap;for(let r=0,s=i.size();r<s;++r){let o=i.itemAt(r);this.insertSymbol(o.first,o.second*t)}}removeSymbol(e){this._cellMap.erase(e)}reverseSign(){this._constant=-this._constant;let e=this._cellMap;for(let t=0,i=e.size();t<i;++t){let r=e.itemAt(t);r.second=-r.second}}solveFor(e){let t=this._cellMap,r=-1/t.erase(e).second;this._constant*=r;for(let s=0,o=t.size();s<o;++s)t.itemAt(s).second*=r}solveForEx(e,t){this.insertSymbol(e,-1),this.solveFor(t)}coefficientFor(e){let t=this._cellMap.find(e);return t!==void 0?t.second:0}substitute(e,t){let i=this._cellMap.erase(e);i!==void 0&&this.insertRow(t,i.second)}};var Wet=Gt(Mn(),1);Q();St();St();ir();var _4={};xh(_4,{areBoundsCompletelyInsidePolygon:()=>m4,areBoundsOverlappingPolygon:()=>f4,boundsAreaOverlap:()=>KW,boundsDistance:()=>JW,boundsIntersection:()=>QW,clamp:()=>Gn,computeDistanceBetweenBoxes:()=>Ao,computeGapBetweenBoxes:()=>Q5,computeManhattanDistanceBetweenBoxes:()=>kg,distSq:()=>UW,distance:()=>zi,doBoundsOverlap:()=>Hc,doSegmentsIntersect:()=>Ti,doesLineIntersectLine:()=>Na,doesSegmentIntersectRect:()=>h4,findNearestPointsBetweenBoxSets:()=>Tg,getBoundingBox:()=>no,getBoundsFromPoints:()=>Oo,getSegmentIntersection:()=>rd,getUnitVectorFromDirection:()=>PS,getUnitVectorFromPointAToB:()=>wS,grid:()=>tq,isPointInsidePolygon:()=>SS,isRectCompletelyInsidePolygon:()=>qW,isRectOverlappingPolygon:()=>WW,midpoint:()=>XW,normalizeDegrees:()=>sd,onSegment:()=>id,orientation:()=>nd,pointToBoundsDistance:()=>YW,pointToBoxDistance:()=>BW,pointToSegmentClosestPoint:()=>jW,pointToSegmentDistance:()=>gi,range:()=>ZW,segmentToBoundsMinDistance:()=>Ng,segmentToBoxMinDistance:()=>bS,segmentToCircleMinDistance:()=>vS,segmentToSegmentMinDistance:()=>r_});function Na([n,e],[t,i],{lineThickness:r=0}={}){return r===0?Ti(n,e,t,i):rMt(n,e,t,i)<=r}function Ti(n,e,t,i){let r=nd(n,e,t),s=nd(n,e,i),o=nd(t,i,n),a=nd(t,i,e);return!!(r!==s&&o!==a||r===0&&id(n,t,e)||s===0&&id(n,i,e)||o===0&&id(t,n,i)||a===0&&id(t,e,i))}function nd(n,e,t){let i=(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y);return i===0?0:i>0?1:2}function id(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function rMt(n,e,t,i){if(n.x===e.x&&n.y===e.y)return gi(n,t,i);if(t.x===i.x&&t.y===i.y)return gi(t,n,e);if(Ti(n,e,t,i))return 0;let r=[gi(n,t,i),gi(e,t,i),gi(t,n,e),gi(i,n,e)];return Math.min(...r)}function gi(n,e,t){let i=(t.x-e.x)**2+(t.y-e.y)**2;if(i===0)return zi(n,e);let r=((n.x-e.x)*(t.x-e.x)+(n.y-e.y)*(t.y-e.y))/i;r=Math.max(0,Math.min(1,r));let s={x:e.x+r*(t.x-e.x),y:e.y+r*(t.y-e.y)};return zi(n,s)}function zi(n,e){let t=n.x-e.x,i=n.y-e.y;return Math.sqrt(t*t+i*i)}function rd(n,e,t,i){let r=e.x-n.x,s=e.y-n.y,o=i.x-t.x,a=i.y-t.y,c=n.x-t.x,l=n.y-t.y,u=r*a-s*o;if(Math.abs(u)<1e-10)return null;let p=(l*o-c*a)/u,f=(r*l-s*c)/u,y=1e-9;if(p>=-y&&p<=1+y&&f>=-y&&f<=1+y){let g=n.x+p*r,x=n.y+p*s;return{x:g,y:x}}return null}function h4(n,e,t){let i=c=>c.x>=t.minX&&c.x<=t.maxX&&c.y>=t.minY&&c.y<=t.maxY;if(i(n)||i(e))return!0;let r={x:t.minX,y:t.minY},s={x:t.maxX,y:t.minY},o={x:t.minX,y:t.maxY},a={x:t.maxX,y:t.maxY};return Ti(n,e,r,s)||Ti(n,e,s,a)||Ti(n,e,a,o)||Ti(n,e,o,r)}function r_(n,e,t,i){if(n.x===e.x&&n.y===e.y)return gi(n,t,i);if(t.x===i.x&&t.y===i.y)return gi(t,n,e);if(Ti(n,e,t,i))return 0;let r=[gi(n,t,i),gi(e,t,i),gi(t,n,e),gi(i,n,e)];return Math.min(...r)}function Ng(n,e,t){let i={x:t.minX,y:t.minY},r={x:t.maxX,y:t.minY},s={x:t.minX,y:t.maxY},o={x:t.maxX,y:t.maxY};if(Ti(n,e,i,r)||Ti(n,e,r,o)||Ti(n,e,o,s)||Ti(n,e,s,i)||n.x>=t.minX&&n.x<=t.maxX&&n.y>=t.minY&&n.y<=t.maxY&&e.x>=t.minX&&e.x<=t.maxX&&e.y>=t.minY&&e.y<=t.maxY)return 0;let a=[gi(i,n,e),gi(r,n,e),gi(s,n,e),gi(o,n,e)];if(n.x>=t.minX&&n.x<=t.maxX&&n.y>=t.minY&&n.y<=t.maxY||e.x>=t.minX&&e.x<=t.maxX&&e.y>=t.minY&&e.y<=t.maxY)return 0;if(n.x<t.minX||n.x>t.maxX||n.y<t.minY||n.y>t.maxY){let c=Gn(n.x,t.minX,t.maxX),l=Gn(n.y,t.minY,t.maxY);a.push(zi(n,{x:c,y:l}))}if(e.x<t.minX||e.x>t.maxX||e.y<t.minY||e.y>t.maxY){let c=Gn(e.x,t.minX,t.maxX),l=Gn(e.y,t.minY,t.maxY);a.push(zi(e,{x:c,y:l}))}return Math.min(...a)}function bS(n,e,t){let i=t.width/2,r=t.height/2,s={minX:t.center.x-i,maxX:t.center.x+i,minY:t.center.y-r,maxY:t.center.y+r};return Ng(n,e,s)}function vS(n,e,t){let i={x:t.x,y:t.y};if(n.x===e.x&&n.y===e.y)return Math.max(0,zi(n,i)-t.radius);let r={x:e.x-n.x,y:e.y-n.y},s={x:i.x-n.x,y:i.y-n.y},o=r.x*r.x+r.y*r.y,a=Math.max(0,Math.min(1,(r.x*s.x+r.y*s.y)/o)),c={x:n.x+a*r.x,y:n.y+a*r.y},l=zi(c,i);return Math.max(0,l-t.radius)}function jW(n,e,t){let i=t.x-e.x,r=t.y-e.y,s=i*i+r*r;if(s===0)return{x:e.x,y:e.y};let o=((n.x-e.x)*i+(n.y-e.y)*r)/s;return o=Math.max(0,Math.min(1,o)),{x:e.x+o*i,y:e.y+o*r}}function sd(n){return(n%360+360)%360}function BW(n,e){let t=e.width/2,i=e.height/2,r=e.center.x-t,s=e.center.x+t,o=e.center.y-i,a=e.center.y+i;if(n.x>=r&&n.x<=s&&n.y>=o&&n.y<=a)return 0;let c=Gn(n.x,r,s),l=Gn(n.y,o,a);return zi(n,{x:c,y:l})}function YW(n,e){if(n.x>=e.minX&&n.x<=e.maxX&&n.y>=e.minY&&n.y<=e.maxY)return 0;let t=Gn(n.x,e.minX,e.maxX),i=Gn(n.y,e.minY,e.maxY);return zi(n,{x:t,y:i})}function XW(n,e){return{x:(n.x+e.x)/2,y:(n.y+e.y)/2}}function UW(n,e){let t=n.x-e.x,i=n.y-e.y;return t*t+i*i}var VW=n=>{if("minX"in n)return n;let e=n.width/2,t=n.height/2;return{minX:n.center.x-e,minY:n.center.y-t,maxX:n.center.x+e,maxY:n.center.y+t}},d4=n=>[{x:n.minX,y:n.minY},{x:n.maxX,y:n.minY},{x:n.maxX,y:n.maxY},{x:n.minX,y:n.maxY}],GW=n=>{let e=[];for(let t=0;t<n.length;t++){let i=n[t],r=n[(t+1)%n.length];e.push([i,r])}return e},sMt=(n,e,t)=>{let i=(n.y-e.y)*(t.x-e.x)-(n.x-e.x)*(t.y-e.y);if(Math.abs(i)>1e-9)return!1;let r=(n.x-e.x)*(t.x-e.x)+(n.y-e.y)*(t.y-e.y);if(r<0)return!1;let s=(t.x-e.x)**2+(t.y-e.y)**2;return!(r>s)},oMt=(n,e)=>n.x>=e.minX&&n.x<=e.maxX&&n.y>=e.minY&&n.y<=e.maxY,SS=(n,e)=>{if(e.length<3)return!1;let t=GW(e);for(let[r,s]of t)if(sMt(n,r,s))return!0;let i=!1;for(let r=0,s=e.length-1;r<e.length;s=r++){let o=e[r].x,a=e[r].y,c=e[s].x,l=e[s].y;a>n.y!=l>n.y&&n.x<(c-o)*(n.y-a)/(l-a)+o&&(i=!i)}return i},HW=(n,e)=>{let t=d4(n),i=[[t[0],t[1]],[t[1],t[2]],[t[2],t[3]],[t[3],t[0]]],r=GW(e);for(let[s,o]of r)for(let[a,c]of i)if(Ti(s,o,a,c))return!0;return!1},f4=(n,e)=>e.length<3?!1:e.some(i=>oMt(i,n))||d4(n).some(i=>SS(i,e))?!0:HW(n,e),m4=(n,e)=>e.length<3||!d4(n).every(i=>SS(i,e))?!1:!HW(n,e),WW=(n,e)=>f4(VW(n),e),qW=(n,e)=>m4(VW(n),e);function ZW(n,e,t=1){if(t===0)throw new Error("step cannot be 0");let i,r;e===void 0?(i=0,r=n):(i=n,r=e);let s=[];if(t>0)for(let o=i;o<r;o+=t)s.push(o);else for(let o=i;o>r;o+=t)s.push(o);return s}var KW=(n,e)=>{let t=Math.max(0,Math.min(n.maxX,e.maxX)-Math.max(n.minX,e.minX)),i=Math.max(0,Math.min(n.maxY,e.maxY)-Math.max(n.minY,e.minY));return t*i};var JW=(n,e)=>{let t=n.maxX<e.minX?e.minX-n.maxX:e.maxX<n.minX?n.minX-e.maxX:0,i=n.maxY<e.minY?e.minY-n.maxY:e.maxY<n.minY?n.minY-e.maxY:0;return Math.sqrt(t*t+i*i)};var QW=(n,e)=>{let t=Math.max(n.minX,e.minX),i=Math.max(n.minY,e.minY),r=Math.min(n.maxX,e.maxX),s=Math.min(n.maxY,e.maxY);return t>r||i>s?null:{minX:t,minY:i,maxX:r,maxY:s}};var Hc=(n,e)=>!(n.maxX<e.minX||e.maxX<n.minX||n.maxY<e.minY||e.maxY<n.minY);var Oo=n=>{if(n.length===0)return null;let e=n[0].x,t=n[0].y,i=n[0].x,r=n[0].y;for(let s=1;s<n.length;s++){let o=n[s];o.x<e&&(e=o.x),o.y<t&&(t=o.y),o.x>i&&(i=o.x),o.y>r&&(r=o.y)}return{minX:e,minY:t,maxX:i,maxY:r}};var wS=(n,e)=>{let t={x:e.x-n.x,y:e.y-n.y},i=Math.sqrt(t.x**2+t.y**2);return{x:t.x/i,y:t.y/i}},PS=n=>{switch(n){case"up":return{x:0,y:1};case"down":return{x:0,y:-1};case"left":return{x:-1,y:0};case"right":return{x:1,y:0}}};function tq({rows:n,cols:e,xSpacing:t,ySpacing:i,width:r,height:s,offsetX:o=0,offsetY:a=0,yDirection:c="cartesian",centered:l=!0}){let u=t??1,p=i??1,f=r??e*u,y=s??n*p,g=l?-f/2:0,x=l?-y/2:0,v=r?r/e:u,P=s?s/n:p,w=[];for(let k=0;k<n;k++)for(let T=0;T<e;T++){let I=k*e+T,E=o+g+T*v+v/2,N=a+k*P+P/2,M=c==="cartesian"?a+x+(n-1-k)*P+P/2:a+x+k*P+P/2;w.push({index:I,center:{x:E,y:M},topLeft:{x:E-v/2,y:M+P/2},bottomRight:{x:E+v/2,y:M-P/2},row:k,col:T})}return w}St();Ag();var eq={name:"@tscircuit/capacity-autorouter",main:"./dist/index.js",version:"0.0.140",type:"module",files:["dist"],scripts:{start:"cosmos",build:"tsup ./lib/index.ts --minify terser --external @tscircuit/core --external circuit-to-svg --format esm --dts --sourcemap",bench:"bun test tests/spatial-index-bench.test.ts",format:"biome format --write .","format:check":"biome format .","vercel-build":"cosmos-export","repomix:lib":"repomix --ignore 'testing/**,**/TwoRouteHighDensitySolver/**,**/RouteStitchingSolver/**,solvers/CapacitySegmentPointOptimizer/CapacitySegmentPointOptimizer.ts' lib","bug-report":"bun run scripts/download-bug-report.ts","bug-report-with-test":"bun run scripts/create-bug-report-test.ts"},devDependencies:{"@biomejs/biome":"^1.9.4","@radix-ui/react-icons":"^1.3.2","@radix-ui/react-menubar":"^1.1.14","@react-hook/resize-observer":"^2.0.2","@resvg/resvg-js":"^2.6.2","@tscircuit/checks":"^0.0.75","@tscircuit/circuit-json-util":"^0.0.46","@tscircuit/core":"^0.0.337","@tscircuit/math-utils":"^0.0.27","@types/bun":"^1.2.23","@types/fast-json-stable-stringify":"^2.1.2","@types/object-hash":"^3.0.6","@types/rbush":"^4.0.0","@types/react":"^19.0.8","@types/react-dom":"^19.0.3","@vercel/node":"^5.1.7","@vitejs/plugin-react":"^4.3.4","circuit-json-to-connectivity-map":"^0.0.19","circuit-to-svg":"^0.0.220",clsx:"^2.1.1",flatbush:"^4.4.0","graphics-debug":"^0.0.44","looks-same":"9",rbush:"^4.0.1",react:"18","react-cosmos":"^6.2.3","react-cosmos-plugin-vite":"^6.2.0","react-dom":"18","react-konva":"18",recharts:"^2.15.1","tailwind-merge":"^3.2.0",terser:"^5.43.1",tsup:"^8.3.6",typescript:"^5.9.3","use-mouse-matrix-transform":"^1.3.0",vite:"^6.0.11","vite-tsconfig-paths":"^5.1.4"},dependencies:{"fast-json-stable-stringify":"^2.1.0","object-hash":"^3.0.0"}};St();ir();Ae();var r9=Gt(qs(),1);St();var nnt=Gt(Mn(),1);var H4={};xh(H4,{AssignableViaAutoroutingPipelineSolver:()=>KCt,AutoroutingPipelineSolver:()=>PZ,CapacityMeshSolver:()=>VCt,InMemoryCache:()=>oZ,LocalStorageCache:()=>aZ,calculateOptimalCapacityDepth:()=>X4,convertSrjToGraphicsObject:()=>Vg,getGlobalInMemoryCache:()=>__,getGlobalLocalStorageCache:()=>cZ,getTunedTotalCapacity1:()=>oo,setupGlobalCaches:()=>Ug});var sZ=Gt(MS(),1),gZ=Gt(MS(),1),vZ=Gt(MS(),1);var ud=(...n)=>{let e={points:[],lines:[],circles:[],rects:[]};return n.forEach((t,i)=>{t&&(t.lines&&(e.lines=[...e.lines||[],...t.lines.map(r=>({...r,step:i}))]),t.points&&(e.points=[...e.points||[],...t.points.map(r=>({...r,step:i}))]),t.circles&&(e.circles=[...e.circles||[],...t.circles.map(r=>({...r,step:i}))]),t.rects&&(e.rects=[...e.rects||[],...t.rects.map(r=>({...r,step:i}))]))}),e},an=class{constructor(){d(this,"MAX_ITERATIONS",1e3);d(this,"solved",!1);d(this,"failed",!1);d(this,"iterations",0);d(this,"progress",0);d(this,"error",null);d(this,"activeSubSolver");d(this,"failedSubSolvers");d(this,"timeToSolve");d(this,"stats",{});d(this,"cacheHit");d(this,"cacheKey");d(this,"cacheToSolveSpaceTransform")}step(){if(!this.solved&&!this.failed){this.iterations++;try{this._step()}catch(n){throw this.error=`${this.constructor.name} error: ${n}`,console.error(this.error),this.failed=!0,n}!this.solved&&this.iterations>this.MAX_ITERATIONS&&this.tryFinalAcceptance(),!this.solved&&this.iterations>this.MAX_ITERATIONS&&(this.error=`${this.constructor.name} ran out of iterations`,console.error(this.error),this.failed=!0),"computeProgress"in this&&(this.progress=this.computeProgress())}}_step(){}getConstructorParams(){throw new Error("getConstructorParams not implemented")}solve(){let n=Date.now();for(;!this.solved&&!this.failed;)this.step();let e=Date.now();this.timeToSolve=e-n}visualize(){return{lines:[],points:[],rects:[],circles:[]}}tryFinalAcceptance(){}preview(){return{lines:[],points:[],rects:[],circles:[]}}};function mq(n){let e=n.width/2,t=n.height/2;return{minX:n.center.x-e,maxX:n.center.x+e,minY:n.center.y-t,maxY:n.center.y+t}}function Zc(n,e,t){return Math.max(e,Math.min(t,n))}function $i(n,e,t,i){let r=CS(n,e,t),s=CS(n,e,i),o=CS(t,i,n),a=CS(t,i,e);return r!==s&&o!==a||!(r!==0||!IS(n,t,e))||!(s!==0||!IS(n,i,e))||!(o!==0||!IS(t,n,i))||!(a!==0||!IS(t,e,i))}function CS(n,e,t){let i=(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y);return i===0?0:i>0?1:2}function IS(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function _r(n,e,t){let i=(t.x-e.x)**2+(t.y-e.y)**2;if(i===0)return Qt(n,e);let r=((n.x-e.x)*(t.x-e.x)+(n.y-e.y)*(t.y-e.y))/i;return r=Math.max(0,Math.min(1,r)),Qt(n,{x:e.x+r*(t.x-e.x),y:e.y+r*(t.y-e.y)})}function Qt(n,e){let t=n.x-e.x,i=n.y-e.y;return Math.sqrt(t*t+i*i)}function Yq(n,e,t,i){let r=e.x-n.x,s=e.y-n.y,o=i.x-t.x,a=i.y-t.y,c=n.x-t.x,l=n.y-t.y,u=r*a-s*o;if(Math.abs(u)<1e-10)return null;let p=(l*o-c*a)/u,f=(r*l-s*c)/u,y=1e-9;return p>=-1e-9&&p<=1+y&&f>=-1e-9&&f<=1+y?{x:n.x+p*r,y:n.y+p*s}:null}function _q(n,e){return{x:(n.x+e.x)/2,y:(n.y+e.y)/2}}var Xq=n=>{if("minX"in n)return n;let e=n.width/2,t=n.height/2;return{minX:n.center.x-e,minY:n.center.y-t,maxX:n.center.x+e,maxY:n.center.y+t}},Y4=n=>[{x:n.minX,y:n.minY},{x:n.maxX,y:n.minY},{x:n.maxX,y:n.maxY},{x:n.minX,y:n.maxY}],Uq=n=>{let e=[];for(let t=0;t<n.length;t++){let i=n[t],r=n[(t+1)%n.length];e.push([i,r])}return e},xMt=(n,e,t)=>{let i=(n.y-e.y)*(t.x-e.x)-(n.x-e.x)*(t.y-e.y);if(Math.abs(i)>1e-9)return!1;let r=(n.x-e.x)*(t.x-e.x)+(n.y-e.y)*(t.y-e.y);return r<0?!1:!(r>(t.x-e.x)**2+(t.y-e.y)**2)},Vq=(n,e)=>{if(e.length<3)return!1;let t=Uq(e);for(let[r,s]of t)if(xMt(n,r,s))return!0;let i=!1;for(let r=0,s=e.length-1;r<e.length;s=r++){let o=e[r].x,a=e[r].y,c=e[s].x,l=e[s].y;a>n.y!=l>n.y&&n.x<(c-o)*(n.y-a)/(l-a)+o&&(i=!i)}return i},Gq=(n,e)=>{let t=Y4(n),i=[[t[0],t[1]],[t[1],t[2]],[t[2],t[3]],[t[3],t[0]]],r=Uq(e);for(let[s,o]of r)for(let[a,c]of i)if($i(s,o,a,c))return!0;return!1},N4=(n,e)=>((t,i)=>!(i.length<3)&&(!!i.some(r=>((s,o)=>s.x>=o.minX&&s.x<=o.maxX&&s.y>=o.minY&&s.y<=o.maxY)(r,t))||!!Y4(t).some(r=>Vq(r,i))||Gq(t,i)))(Xq(n),e),Hq=(n,e)=>((t,i)=>!(i.length<3)&&!!Y4(t).every(r=>Vq(r,i))&&!Gq(t,i))(Xq(n),e);function A4(n,e,t,i){if(n.x===e.x&&n.y===e.y)return _r(n,t,i);if(t.x===i.x&&t.y===i.y)return _r(t,n,e);if($i(n,e,t,i))return 0;let r=[_r(n,t,i),_r(e,t,i),_r(t,n,e),_r(i,n,e)];return Math.min(...r)}function Wq(n,e,t){let i=t.width/2,r=t.height/2;return(function(s,o,a){let c={x:a.minX,y:a.minY},l={x:a.maxX,y:a.minY},u={x:a.minX,y:a.maxY},p={x:a.maxX,y:a.maxY};if($i(s,o,c,l)||$i(s,o,l,p)||$i(s,o,p,u)||$i(s,o,u,c)||s.x>=a.minX&&s.x<=a.maxX&&s.y>=a.minY&&s.y<=a.maxY&&o.x>=a.minX&&o.x<=a.maxX&&o.y>=a.minY&&o.y<=a.maxY)return 0;let f=[_r(c,s,o),_r(l,s,o),_r(u,s,o),_r(p,s,o)];if(s.x>=a.minX&&s.x<=a.maxX&&s.y>=a.minY&&s.y<=a.maxY||o.x>=a.minX&&o.x<=a.maxX&&o.y>=a.minY&&o.y<=a.maxY)return 0;if(s.x<a.minX||s.x>a.maxX||s.y<a.minY||s.y>a.maxY){let y=Zc(s.x,a.minX,a.maxX),g=Zc(s.y,a.minY,a.maxY);f.push(Qt(s,{x:y,y:g}))}if(o.x<a.minX||o.x>a.maxX||o.y<a.minY||o.y>a.maxY){let y=Zc(o.x,a.minX,a.maxX),g=Zc(o.y,a.minY,a.maxY);f.push(Qt(o,{x:y,y:g}))}return Math.min(...f)})(n,e,{minX:t.center.x-i,maxX:t.center.x+i,minY:t.center.y-r,maxY:t.center.y+r})}function p_(n,e,t){let i=t.x-e.x,r=t.y-e.y,s=i*i+r*r;if(s===0)return{x:e.x,y:e.y};let o=((n.x-e.x)*i+(n.y-e.y)*r)/s;return o=Math.max(0,Math.min(1,o)),{x:e.x+o*i,y:e.y+o*r}}function Yr(){return Yr=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)({}).hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Yr.apply(null,arguments)}function VS(n,e){return(VS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(n,e)}function qq(n){return(qq=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(n)}function Zq(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Zq=function(){return!!n})()}function R4(n){var e=typeof Map=="function"?new Map:void 0;return R4=function(t){if(t===null||!(function(r){try{return Function.toString.call(r).indexOf("[native code]")!==-1}catch{return typeof r=="function"}})(t))return t;if(typeof t!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(t))return e.get(t);e.set(t,i)}function i(){return(function(r,s,o){if(Zq())return Reflect.construct.apply(null,arguments);var a=[null];a.push.apply(a,s);var c=new(r.bind.apply(r,a));return o&&VS(c,o.prototype),c})(t,arguments,qq(this).constructor)}return i.prototype=Object.create(t.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),VS(i,t)},R4(n)}var Br=(function(n){var e,t;function i(r){var s;if(1)s=n.call(this,"An error occurred. See https://github.com/styled-components/polished/blob/main/src/internalHelpers/errors.md#"+r+" for more information.")||this;else for(var o,a,c;c<o;c++);return(function(l){if(l===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return l})(s)}return t=n,(e=i).prototype=Object.create(t.prototype),e.prototype.constructor=e,VS(e,t),i})(R4(Error));function yq(n,e){return n.substr(-e.length)===e}var bMt=/^([+-]?(?:\d+|\d*\.\d+))([a-z]*|%)$/;function gq(n){return typeof n!="string"?n:n.match(bMt)?parseFloat(n):n}var xq=function(n){return function(e,t){t===void 0&&(t="16px");var i=e,r=t;if(typeof e=="string"){if(!yq(e,"px"))throw new Br(69,n,e);i=gq(e)}if(typeof t=="string"){if(!yq(t,"px"))throw new Br(70,n,t);r=gq(t)}if(typeof i=="string")throw new Br(71,e,n);if(typeof r=="string")throw new Br(72,t,n);return""+i/r+n}};xq("em"),xq("rem");function b4(n){return Math.round(255*n)}function vMt(n,e,t){return b4(n)+","+b4(e)+","+b4(t)}function Bg(n,e,t,i){if(i===void 0&&(i=vMt),e===0)return i(t,t,t);var r=(n%360+360)%360/60,s=(1-Math.abs(2*t-1))*e,o=s*(1-Math.abs(r%2-1)),a=0,c=0,l=0;r>=0&&r<1?(a=s,c=o):r>=1&&r<2?(a=o,c=s):r>=2&&r<3?(c=s,l=o):r>=3&&r<4?(c=o,l=s):r>=4&&r<5?(a=o,l=s):r>=5&&r<6&&(a=s,l=o);var u=t-s/2;return i(a+u,c+u,l+u)}var bq={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"639",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},SMt=/^#[a-fA-F0-9]{6}$/,wMt=/^#[a-fA-F0-9]{8}$/,PMt=/^#[a-fA-F0-9]{3}$/,kMt=/^#[a-fA-F0-9]{4}$/,v4=/^rgb\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*\)$/i,TMt=/^rgb(?:a)?\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i,EMt=/^hsl\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*\)$/i,MMt=/^hsl(?:a)?\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i;function h_(n){if(typeof n!="string")throw new Br(3);var e=(function(f){if(typeof f!="string")return f;var y=f.toLowerCase();return bq[y]?"#"+bq[y]:f})(n);if(e.match(SMt))return{red:parseInt(""+e[1]+e[2],16),green:parseInt(""+e[3]+e[4],16),blue:parseInt(""+e[5]+e[6],16)};if(e.match(wMt)){var t=parseFloat((parseInt(""+e[7]+e[8],16)/255).toFixed(2));return{red:parseInt(""+e[1]+e[2],16),green:parseInt(""+e[3]+e[4],16),blue:parseInt(""+e[5]+e[6],16),alpha:t}}if(e.match(PMt))return{red:parseInt(""+e[1]+e[1],16),green:parseInt(""+e[2]+e[2],16),blue:parseInt(""+e[3]+e[3],16)};if(e.match(kMt)){var i=parseFloat((parseInt(""+e[4]+e[4],16)/255).toFixed(2));return{red:parseInt(""+e[1]+e[1],16),green:parseInt(""+e[2]+e[2],16),blue:parseInt(""+e[3]+e[3],16),alpha:i}}var r=v4.exec(e);if(r)return{red:parseInt(""+r[1],10),green:parseInt(""+r[2],10),blue:parseInt(""+r[3],10)};var s=TMt.exec(e.substring(0,50));if(s)return{red:parseInt(""+s[1],10),green:parseInt(""+s[2],10),blue:parseInt(""+s[3],10),alpha:parseFloat(""+s[4])>1?parseFloat(""+s[4])/100:parseFloat(""+s[4])};var o=EMt.exec(e);if(o){var a="rgb("+Bg(parseInt(""+o[1],10),parseInt(""+o[2],10)/100,parseInt(""+o[3],10)/100)+")",c=v4.exec(a);if(!c)throw new Br(4,e,a);return{red:parseInt(""+c[1],10),green:parseInt(""+c[2],10),blue:parseInt(""+c[3],10)}}var l=MMt.exec(e.substring(0,50));if(l){var u="rgb("+Bg(parseInt(""+l[1],10),parseInt(""+l[2],10)/100,parseInt(""+l[3],10)/100)+")",p=v4.exec(u);if(!p)throw new Br(4,e,u);return{red:parseInt(""+p[1],10),green:parseInt(""+p[2],10),blue:parseInt(""+p[3],10),alpha:parseFloat(""+l[4])>1?parseFloat(""+l[4])/100:parseFloat(""+l[4])}}throw new Br(5)}function Kc(n){return(function(e){var t,i=e.red/255,r=e.green/255,s=e.blue/255,o=Math.max(i,r,s),a=Math.min(i,r,s),c=(o+a)/2;if(o===a)return e.alpha!==void 0?{hue:0,saturation:0,lightness:c,alpha:e.alpha}:{hue:0,saturation:0,lightness:c};var l=o-a,u=c>.5?l/(2-o-a):l/(o+a);switch(o){case i:t=(r-s)/l+(r<s?6:0);break;case r:t=(s-i)/l+2;break;default:t=(i-r)/l+4}return t*=60,e.alpha!==void 0?{hue:t,saturation:u,lightness:c,alpha:e.alpha}:{hue:t,saturation:u,lightness:c}})(h_(n))}var O4=function(n){return n.length===7&&n[1]===n[2]&&n[3]===n[4]&&n[5]===n[6]?"#"+n[1]+n[3]+n[5]:n};function cd(n){var e=n.toString(16);return e.length===1?"0"+e:e}function S4(n){return cd(Math.round(255*n))}function CMt(n,e,t){return O4("#"+S4(n)+S4(e)+S4(t))}function NS(n,e,t){return Bg(n,e,t,CMt)}function L4(n,e,t){if(typeof n=="number"&&typeof e=="number"&&typeof t=="number")return O4("#"+cd(n)+cd(e)+cd(t));if(typeof n=="object"&&e===void 0&&t===void 0)return O4("#"+cd(n.red)+cd(n.green)+cd(n.blue));throw new Br(6)}function QS(n,e,t,i){if(typeof n=="string"&&typeof e=="number"){var r=h_(n);return"rgba("+r.red+","+r.green+","+r.blue+","+e+")"}if(typeof n=="number"&&typeof e=="number"&&typeof t=="number"&&typeof i=="number")return i>=1?L4(n,e,t):"rgba("+n+","+e+","+t+","+i+")";if(typeof n=="object"&&e===void 0&&t===void 0&&i===void 0)return n.alpha>=1?L4(n.red,n.green,n.blue):"rgba("+n.red+","+n.green+","+n.blue+","+n.alpha+")";throw new Br(7)}function Jc(n){if(typeof n!="object")throw new Br(8);if((function(e){return typeof e.red=="number"&&typeof e.green=="number"&&typeof e.blue=="number"&&typeof e.alpha=="number"})(n))return QS(n);if((function(e){return typeof e.red=="number"&&typeof e.green=="number"&&typeof e.blue=="number"&&(typeof e.alpha!="number"||e.alpha===void 0)})(n))return L4(n);if((function(e){return typeof e.hue=="number"&&typeof e.saturation=="number"&&typeof e.lightness=="number"&&typeof e.alpha=="number"})(n))return(function(e,t,i,r){if(typeof e=="number"&&typeof t=="number"&&typeof i=="number"&&typeof r=="number")return r>=1?NS(e,t,i):"rgba("+Bg(e,t,i)+","+r+")";if(typeof e=="object"&&t===void 0&&i===void 0&&r===void 0)return e.alpha>=1?NS(e.hue,e.saturation,e.lightness):"rgba("+Bg(e.hue,e.saturation,e.lightness)+","+e.alpha+")";throw new Br(2)})(n);if((function(e){return typeof e.hue=="number"&&typeof e.saturation=="number"&&typeof e.lightness=="number"&&(typeof e.alpha!="number"||e.alpha===void 0)})(n))return(function(e,t,i){if(typeof e=="number"&&typeof t=="number"&&typeof i=="number")return NS(e,t,i);if(typeof e=="object"&&t===void 0&&i===void 0)return NS(e.hue,e.saturation,e.lightness);throw new Br(1)})(n);throw new Br(8)}function Kq(n,e,t){return function(){var i=t.concat(Array.prototype.slice.call(arguments));return i.length>=e?n.apply(this,i):Kq(n,e,i)}}function os(n){return Kq(n,n.length,[])}os(function(n,e){if(e==="transparent")return e;var t=Kc(e);return Jc(Yr({},t,{hue:t.hue+parseFloat(n)}))});function m_(n,e,t){return Math.max(n,Math.min(e,t))}os(function(n,e){if(e==="transparent")return e;var t=Kc(e);return Jc(Yr({},t,{lightness:m_(0,1,t.lightness-parseFloat(n))}))});os(function(n,e){if(e==="transparent")return e;var t=Kc(e);return Jc(Yr({},t,{saturation:m_(0,1,t.saturation-parseFloat(n))}))});os(function(n,e){if(e==="transparent")return e;var t=Kc(e);return Jc(Yr({},t,{lightness:m_(0,1,t.lightness+parseFloat(n))}))});var Jq=os(function(n,e,t){if(e==="transparent")return t;if(t==="transparent")return e;if(n===0)return t;var i=h_(e),r=Yr({},i,{alpha:typeof i.alpha=="number"?i.alpha:1}),s=h_(t),o=Yr({},s,{alpha:typeof s.alpha=="number"?s.alpha:1}),a=r.alpha-o.alpha,c=2*parseFloat(n)-1,l=((c*a===-1?c:c+a)/(1+c*a)+1)/2,u=1-l;return QS({red:Math.floor(r.red*l+o.red*u),green:Math.floor(r.green*l+o.green*u),blue:Math.floor(r.blue*l+o.blue*u),alpha:r.alpha*parseFloat(n)+o.alpha*(1-parseFloat(n))})});os(function(n,e){if(e==="transparent")return e;var t=h_(e);return QS(Yr({},t,{alpha:m_(0,1,(100*(typeof t.alpha=="number"?t.alpha:1)+100*parseFloat(n))/100)}))});os(function(n,e){if(e==="transparent")return e;var t=Kc(e);return Jc(Yr({},t,{saturation:m_(0,1,t.saturation+parseFloat(n))}))});os(function(n,e){return e==="transparent"?e:Jc(Yr({},Kc(e),{hue:parseFloat(n)}))});os(function(n,e){return e==="transparent"?e:Jc(Yr({},Kc(e),{lightness:parseFloat(n)}))});os(function(n,e){return e==="transparent"?e:Jc(Yr({},Kc(e),{saturation:parseFloat(n)}))});os(function(n,e){return e==="transparent"?e:Jq(parseFloat(n),"rgb(0, 0, 0)",e)});os(function(n,e){return e==="transparent"?e:Jq(parseFloat(n),"rgb(255, 255, 255)",e)});var IMt=os(function(n,e){if(e==="transparent")return e;var t=h_(e);return QS(Yr({},t,{alpha:m_(0,1,+(100*(typeof t.alpha=="number"?t.alpha:1)-100*parseFloat(n)).toFixed(2)/100)}))}),vq=["blue","orange","purple","cyan","magenta","yellowgreen","darkgoldenrod","deeppink"],Yg=(n,e)=>{let t={};for(let i=0;i<n.connections.length;i++){let r=n.connections[i],s=e?.getNetConnectedToId(r.name);s&&!t[s]&&(t[s]=`hsl(${300*i/n.connections.length}, 100%, 50%)`),t[r.name]=(s?t[s]:null)??`hsl(${340*i/n.connections.length}, 100%, 50%)`}return t},Qn=(n,e)=>{try{return IMt(e,n)}catch(t){return console.error(t),n}},pd=(n,e)=>n==="top"?0:n==="bottom"?e-1:parseInt(n.slice(5)),oo=(n,e=1)=>{let t=(("width"in n?n.width:n)/.5/2)**1.1*e;return n.availableZ?.length===1&&t>1?1:t},X4=(n,e=.5,t=16)=>{let i=0,r=n;for(;i<t&&!(oo({width:r})<=e);)r/=2,i++;return Math.max(1,i)};function Qq(n,e,t=0,i=n.length-1,r=NMt){for(;i>t;){if(i-t>600){let c=i-t+1,l=e-t+1,u=Math.log(c),p=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*p*(c-p)/c)*(l-c/2<0?-1:1);Qq(n,e,Math.max(t,Math.floor(e-l*p/c+f)),Math.min(i,Math.floor(e+(c-l)*p/c+f)),r)}let s=n[e],o=t,a=i;for(Og(n,t,e),r(n[i],s)>0&&Og(n,t,i);o<a;){for(Og(n,o,a),o++,a--;r(n[o],s)<0;)o++;for(;r(n[a],s)>0;)a--}r(n[t],s)===0?Og(n,t,a):(a++,Og(n,a,i)),a<=e&&(t=a+1),e<=a&&(i=a-1)}}function Og(n,e,t){let i=n[e];n[e]=n[t],n[t]=i}function NMt(n,e){return n<e?-1:n>e?1:0}var AMt=class{constructor(n=9){this._maxEntries=Math.max(4,n),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}all(){return this._all(this.data,[])}search(n){let e=this.data,t=[];if(!RS(n,e))return t;let i=this.toBBox,r=[];for(;e;){for(let s=0;s<e.children.length;s++){let o=e.children[s],a=e.leaf?i(o):o;RS(n,a)&&(e.leaf?t.push(o):P4(n,a)?this._all(o,t):r.push(o))}e=r.pop()}return t}collides(n){let e=this.data;if(!RS(n,e))return!1;let t=[];for(;e;){for(let i=0;i<e.children.length;i++){let r=e.children[i],s=e.leaf?this.toBBox(r):r;if(RS(n,s)){if(e.leaf||P4(n,s))return!0;t.push(r)}}e=t.pop()}return!1}load(n){if(!n||!n.length)return this;if(n.length<this._minEntries){for(let t=0;t<n.length;t++)this.insert(n[t]);return this}let e=this._build(n.slice(),0,n.length-1,0);if(this.data.children.length)if(this.data.height===e.height)this._splitRoot(this.data,e);else{if(this.data.height<e.height){let t=this.data;this.data=e,e=t}this._insert(e,this.data.height-e.height-1,!0)}else this.data=e;return this}insert(n){return n&&this._insert(n,this.data.height-1),this}clear(){return this.data=l_([]),this}remove(n,e){if(!n)return this;let t=this.data,i=this.toBBox(n),r=[],s=[],o,a,c;for(;t||r.length;){if(t||(t=r.pop(),a=r[r.length-1],o=s.pop(),c=!0),t.leaf){let l=RMt(n,t.children,e);if(l!==-1)return t.children.splice(l,1),r.push(t),this._condense(r),this}c||t.leaf||!P4(t,i)?a?(o++,t=a.children[o],c=!1):t=null:(r.push(t),s.push(o),o=0,a=t,t=t.children[0])}return this}toBBox(n){return n}compareMinX(n,e){return n.minX-e.minX}compareMinY(n,e){return n.minY-e.minY}toJSON(){return this.data}fromJSON(n){return this.data=n,this}_all(n,e){let t=[];for(;n;)n.leaf?e.push(...n.children):t.push(...n.children),n=t.pop();return e}_build(n,e,t,i){let r=t-e+1,s,o=this._maxEntries;if(r<=o)return s=l_(n.slice(e,t+1)),c_(s,this.toBBox),s;i||(i=Math.ceil(Math.log(r)/Math.log(o)),o=Math.ceil(r/Math.pow(o,i-1))),s=l_([]),s.leaf=!1,s.height=i;let a=Math.ceil(r/o),c=a*Math.ceil(Math.sqrt(o));Sq(n,e,t,c,this.compareMinX);for(let l=e;l<=t;l+=c){let u=Math.min(l+c-1,t);Sq(n,l,u,a,this.compareMinY);for(let p=l;p<=u;p+=a){let f=Math.min(p+a-1,u);s.children.push(this._build(n,p,f,i-1))}}return c_(s,this.toBBox),s}_chooseSubtree(n,e,t,i){for(;i.push(e),!e.leaf&&i.length-1!==t;){let r,s=1/0,o=1/0;for(let a=0;a<e.children.length;a++){let c=e.children[a],l=w4(c),u=FMt(n,c)-l;u<o?(o=u,s=l<s?l:s,r=c):u===o&&l<s&&(s=l,r=c)}e=r||e.children[0]}return e}_insert(n,e,t){let i=t?n:this.toBBox(n),r=[],s=this._chooseSubtree(i,this.data,e,r);for(s.children.push(n),Fg(s,i);e>=0&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(i,r,e)}_split(n,e){let t=n[e],i=t.children.length,r=this._minEntries;this._chooseSplitAxis(t,r,i);let s=this._chooseSplitIndex(t,r,i),o=l_(t.children.splice(s,t.children.length-s));o.height=t.height,o.leaf=t.leaf,c_(t,this.toBBox),c_(o,this.toBBox),e?n[e-1].children.push(o):this._splitRoot(t,o)}_splitRoot(n,e){this.data=l_([n,e]),this.data.height=n.height+1,this.data.leaf=!1,c_(this.data,this.toBBox)}_chooseSplitIndex(n,e,t){let i,r=1/0,s=1/0;for(let o=e;o<=t-e;o++){let a=Lg(n,0,o,this.toBBox),c=Lg(n,o,t,this.toBBox),l=zMt(a,c),u=w4(a)+w4(c);l<r?(r=l,i=o,s=u<s?u:s):l===r&&u<s&&(s=u,i=o)}return i||t-e}_chooseSplitAxis(n,e,t){let i=n.leaf?this.compareMinX:OMt,r=n.leaf?this.compareMinY:LMt;this._allDistMargin(n,e,t,i)<this._allDistMargin(n,e,t,r)&&n.children.sort(i)}_allDistMargin(n,e,t,i){n.children.sort(i);let r=this.toBBox,s=Lg(n,0,e,r),o=Lg(n,t-e,t,r),a=AS(s)+AS(o);for(let c=e;c<t-e;c++){let l=n.children[c];Fg(s,n.leaf?r(l):l),a+=AS(s)}for(let c=t-e-1;c>=e;c--){let l=n.children[c];Fg(o,n.leaf?r(l):l),a+=AS(o)}return a}_adjustParentBBoxes(n,e,t){for(let i=t;i>=0;i--)Fg(e[i],n)}_condense(n){for(let e,t=n.length-1;t>=0;t--)n[t].children.length===0?t>0?(e=n[t-1].children,e.splice(e.indexOf(n[t]),1)):this.clear():c_(n[t],this.toBBox)}};function RMt(n,e,t){if(!t)return e.indexOf(n);for(let i=0;i<e.length;i++)if(t(n,e[i]))return i;return-1}function c_(n,e){Lg(n,0,n.children.length,e,n)}function Lg(n,e,t,i,r){r||(r=l_(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let s=e;s<t;s++){let o=n.children[s];Fg(r,n.leaf?i(o):o)}return r}function Fg(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function OMt(n,e){return n.minX-e.minX}function LMt(n,e){return n.minY-e.minY}function w4(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function AS(n){return n.maxX-n.minX+(n.maxY-n.minY)}function FMt(n,e){return(Math.max(e.maxX,n.maxX)-Math.min(e.minX,n.minX))*(Math.max(e.maxY,n.maxY)-Math.min(e.minY,n.minY))}function zMt(n,e){let t=Math.max(n.minX,e.minX),i=Math.max(n.minY,e.minY),r=Math.min(n.maxX,e.maxX),s=Math.min(n.maxY,e.maxY);return Math.max(0,r-t)*Math.max(0,s-i)}function P4(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function RS(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function l_(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Sq(n,e,t,i,r){let s=[e,t];for(;s.length;){if((t=s.pop())-(e=s.pop())<=i)continue;let o=e+Math.ceil((t-e)/i/2)*i;Qq(n,o,e,t,r),s.push(e,o,o,t)}}var wq=class{constructor(n=9){d(this,"tree");this.tree=new AMt(n)}insert(n,e,t,i,r){this.tree.insert({minX:e,minY:t,maxX:i,maxY:r,data:n})}bulkLoad(n){let e=n.map(({item:t,minX:i,minY:r,maxX:s,maxY:o})=>({minX:i,minY:r,maxX:s,maxY:o,data:t}));this.tree.load(e)}search(n,e,t,i){return this.tree.search({minX:n,minY:e,maxX:t,maxY:i}).map(r=>r.data)}clear(){this.tree.clear()}},$Mt=class{constructor(){this.ids=[],this.values=[],this.length=0}clear(){this.length=0}push(n,e){let t=this.length++;for(;t>0;){let i=t-1>>1,r=this.values[i];if(e>=r)break;this.ids[t]=this.ids[i],this.values[t]=r,t=i}this.ids[t]=n,this.values[t]=e}pop(){if(this.length===0)return;let n=this.ids,e=this.values,t=n[0],i=--this.length;if(i>0){let r=n[i],s=e[i],o=0,a=i>>1;for(;o<a;){let c=1+(o<<1),l=c+1,u=c+(+(l<i)&+(e[l]<e[c]));if(e[u]>=s)break;n[o]=n[u],e[o]=e[u],o=u}n[o]=r,e[o]=s}return t}peek(){return this.length>0?this.ids[0]:void 0}peekValue(){return this.length>0?this.values[0]:void 0}shrink(){this.ids.length=this.values.length=this.length}},Pq=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],kq=class tZ{static from(e,t=0){if(t%8!=0)throw new Error("byteOffset must be 8-byte aligned.");if(!e||e.byteLength===void 0||e.buffer)throw new Error("Data must be an instance of ArrayBuffer or SharedArrayBuffer.");let[i,r]=new Uint8Array(e,t+0,2);if(i!==251)throw new Error("Data does not appear to be in a Flatbush format.");let s=r>>4;if(s!==3)throw new Error(`Got v${s} data when expected v3.`);let o=Pq[15&r];if(!o)throw new Error("Unrecognized array type.");let[a]=new Uint16Array(e,t+2,1),[c]=new Uint32Array(e,t+4,1);return new tZ(c,a,o,void 0,e,t)}constructor(e,t=16,i=Float64Array,r=ArrayBuffer,s,o=0){if(e===void 0)throw new Error("Missing required argument: numItems.");if(isNaN(e)||e<=0)throw new Error(`Unexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+t,2),65535),this.byteOffset=o;let a=e,c=a;this._levelBounds=[4*a];do a=Math.ceil(a/this.nodeSize),c+=a,this._levelBounds.push(4*c);while(a!==1);this.ArrayType=i,this.IndexArrayType=c<16384?Uint16Array:Uint32Array;let l=Pq.indexOf(i),u=4*c*i.BYTES_PER_ELEMENT;if(l<0)throw new Error(`Unexpected typed array class: ${i}.`);if(s)this.data=s,this._boxes=new i(s,o+8,4*c),this._indices=new this.IndexArrayType(s,o+8+u,c),this._pos=4*c,this.minX=this._boxes[this._pos-4],this.minY=this._boxes[this._pos-3],this.maxX=this._boxes[this._pos-2],this.maxY=this._boxes[this._pos-1];else{let p=this.data=new r(8+u+c*this.IndexArrayType.BYTES_PER_ELEMENT);this._boxes=new i(p,8,4*c),this._indices=new this.IndexArrayType(p,8+u,c),this._pos=0,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,new Uint8Array(p,0,2).set([251,48+l]),new Uint16Array(p,2,1)[0]=t,new Uint32Array(p,4,1)[0]=e}this._queue=new $Mt}add(e,t,i=e,r=t){let s=this._pos>>2,o=this._boxes;return this._indices[s]=s,o[this._pos++]=e,o[this._pos++]=t,o[this._pos++]=i,o[this._pos++]=r,e<this.minX&&(this.minX=e),t<this.minY&&(this.minY=t),i>this.maxX&&(this.maxX=i),r>this.maxY&&(this.maxY=r),s}finish(){if(this._pos>>2!==this.numItems)throw new Error(`Added ${this._pos>>2} items when expected ${this.numItems}.`);let e=this._boxes;if(this.numItems<=this.nodeSize)return e[this._pos++]=this.minX,e[this._pos++]=this.minY,e[this._pos++]=this.maxX,void(e[this._pos++]=this.maxY);let t=this.maxX-this.minX||1,i=this.maxY-this.minY||1,r=new Uint32Array(this.numItems);for(let s=0,o=0;s<this.numItems;s++){let a=e[o++],c=e[o++],l=e[o++],u=e[o++],p=Math.floor(65535*((a+l)/2-this.minX)/t),f=Math.floor(65535*((c+u)/2-this.minY)/i);r[s]=jMt(p,f)}F4(r,e,this._indices,0,this.numItems-1,this.nodeSize);for(let s=0,o=0;s<this._levelBounds.length-1;s++){let a=this._levelBounds[s];for(;o<a;){let c=o,l=e[o++],u=e[o++],p=e[o++],f=e[o++];for(let y=1;y<this.nodeSize&&o<a;y++)l=Math.min(l,e[o++]),u=Math.min(u,e[o++]),p=Math.max(p,e[o++]),f=Math.max(f,e[o++]);this._indices[this._pos>>2]=c,e[this._pos++]=l,e[this._pos++]=u,e[this._pos++]=p,e[this._pos++]=f}}}search(e,t,i,r,s){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let o=this._boxes.length-4,a=[],c=[];for(;o!==void 0;){let l=Math.min(o+4*this.nodeSize,Tq(o,this._levelBounds));for(let u=o;u<l;u+=4){let p=this._boxes[u];if(i<p)continue;let f=this._boxes[u+1];if(r<f)continue;let y=this._boxes[u+2];if(e>y)continue;let g=this._boxes[u+3];if(t>g)continue;let x=0|this._indices[u>>2];o>=4*this.numItems?a.push(x):(s===void 0||s(x,p,f,y,g))&&c.push(x)}o=a.pop()}return c}neighbors(e,t,i=1/0,r=1/0,s){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let o=this._boxes.length-4,a=this._queue,c=[],l=r*r;t:for(;o!==void 0;){let u=Math.min(o+4*this.nodeSize,Tq(o,this._levelBounds));for(let p=o;p<u;p+=4){let f=0|this._indices[p>>2],y=this._boxes[p],g=this._boxes[p+1],x=this._boxes[p+2],v=this._boxes[p+3],P=e<y?y-e:e>x?e-x:0,w=t<g?g-t:t>v?t-v:0,k=P*P+w*w;k>l||(o>=4*this.numItems?a.push(f<<1,k):(s===void 0||s(f))&&a.push(1+(f<<1),k))}for(;a.length&&1&a.peek();)if(a.peekValue()>l||(c.push(a.pop()>>1),c.length===i))break t;o=a.length?a.pop()>>1:void 0}return a.clear(),c}};function Tq(n,e){let t=0,i=e.length-1;for(;t<i;){let r=t+i>>1;e[r]>n?i=r:t=r+1}return e[t]}function F4(n,e,t,i,r,s){if(Math.floor(i/s)>=Math.floor(r/s))return;let o=n[i],a=n[i+r>>1],c=n[r],l=c,u=Math.max(o,a);c>u?l=u:u===o?l=Math.max(a,c):u===a&&(l=Math.max(o,c));let p=i-1,f=r+1;for(;;){do p++;while(n[p]<l);do f--;while(n[f]>l);if(p>=f)break;DMt(n,e,t,p,f)}F4(n,e,t,i,f,s),F4(n,e,t,f+1,r,s)}function DMt(n,e,t,i,r){let s=n[i];n[i]=n[r],n[r]=s;let o=4*i,a=4*r,c=e[o],l=e[o+1],u=e[o+2],p=e[o+3];e[o]=e[a],e[o+1]=e[a+1],e[o+2]=e[a+2],e[o+3]=e[a+3],e[a]=c,e[a+1]=l,e[a+2]=u,e[a+3]=p;let f=t[i];t[i]=t[r],t[r]=f}function jMt(n,e){let t=n^e,i=65535^t,r=65535^(n|e),s=n&(65535^e),o=t|i>>1,a=t>>1^t,c=r>>1^i&s>>1^r,l=t&r>>1^s>>1^s;t=o,i=a,r=c,s=l,o=t&t>>2^i&i>>2,a=t&i>>2^i&(t^i)>>2,c^=t&r>>2^i&s>>2,l^=i&r>>2^(t^i)&s>>2,t=o,i=a,r=c,s=l,o=t&t>>4^i&i>>4,a=t&i>>4^i&(t^i)>>4,c^=t&r>>4^i&s>>4,l^=i&r>>4^(t^i)&s>>4,t=o,i=a,r=c,s=l,c^=t&r>>8^i&s>>8,l^=i&r>>8^(t^i)&s>>8,t=c^c>>1,i=l^l>>1;let u=n^e,p=i|65535^(u|t);return u=16711935&(u|u<<8),u=252645135&(u|u<<4),u=858993459&(u|u<<2),u=1431655765&(u|u<<1),p=16711935&(p|p<<8),p=252645135&(p|p<<4),p=858993459&(p|p<<2),p=1431655765&(p|p<<1),(p<<1|u)>>>0}var BMt=class{constructor(n){d(this,"index");d(this,"items",[]);d(this,"currentIndex",0);d(this,"capacity");this.capacity=Math.max(1,n),this.index=new kq(this.capacity)}insert(n,e,t,i,r){if(this.currentIndex>=this.index.numItems)throw new Error("Exceeded initial capacity");this.items[this.currentIndex]=n,this.index.add(e,t,i,r),this.currentIndex++}finish(){this.index.finish()}search(n,e,t,i){return this.index.search(n,e,t,i).map(r=>this.items[r]||null).filter(Boolean)}clear(){this.items=[],this.currentIndex=0,this.index=new kq(this.capacity)}},eZ=class{constructor(n="native",e=[]){d(this,"idx");d(this,"storage",[]);n==="flatbush"?e.length===0?(this.idx=new wq,n="rbush"):this.idx=new BMt(e.length):this.idx=n==="rbush"?new wq:new class{constructor(){d(this,"shi",new YMt(e))}insert(t){}search(t,i,r,s){let o=(t+r)/2,a=(i+s)/2,c=r-t,l=s-i;return this.shi.getNodesInArea(o,a,c,l)}clear(){}},e.forEach(t=>this.insert(t)),n==="flatbush"&&e.length>0&&this.idx.finish?.()}insert(n){this.storage.push(n),this.idx.insert(n,n.center.x-n.width/2,n.center.y-n.height/2,n.center.x+n.width/2,n.center.y+n.height/2)}search(n){return this.idx.search(n.minX,n.minY,n.maxX,n.maxY)}searchArea(n,e,t,i){return this.search({minX:n-t/2,minY:e-i/2,maxX:n+t/2,maxY:e+i/2})}},YMt=class{constructor(n){d(this,"buckets");d(this,"CELL_SIZE",.4);this.obstacles=n,this.buckets=new Map;for(let e=0;e<n.length;e++){let t=n[e],i=t.center.x-t.width/2,r=t.center.y-t.height/2,s=t.center.x+t.width/2,o=t.center.y+t.height/2;for(let a=i;a<=s;a+=this.CELL_SIZE)for(let c=r;c<=o;c+=this.CELL_SIZE){let l=this.getBucketKey(a,c),u=this.buckets.get(l);u?u.push([t,e]):this.buckets.set(l,[[t,e]])}}}getBucketKey(n,e){return`${Math.floor(n/this.CELL_SIZE)}x${Math.floor(e/this.CELL_SIZE)}`}getNodesInArea(n,e,t,i){let r=[],s=new Set,o=e-i/2,a=n+t/2,c=e+i/2;for(let l=n-t/2;l<=a;l+=this.CELL_SIZE)for(let u=o;u<=c;u+=this.CELL_SIZE){let p=this.getBucketKey(l,u),f=this.buckets.get(p)||[];for(let y of f)s.has(y[1])||(s.add(y[1]),r.push(y[0]))}return r}},XMt=class{constructor(n){d(this,"buckets");d(this,"CELL_SIZE",5);this.targets=n,this.buckets=new Map;for(let e=0;e<n.length;e++){let t=n[e],i=Math.floor(t.bounds.minX/this.CELL_SIZE)*this.CELL_SIZE,r=Math.floor(t.bounds.minY/this.CELL_SIZE)*this.CELL_SIZE,s=t.bounds.maxX,o=t.bounds.maxY;for(let a=i;a<=s;a+=this.CELL_SIZE)for(let c=r;c<=o;c+=this.CELL_SIZE){let l=this.getBucketKey(a,c),u=this.buckets.get(l);u?u.push([t,e]):this.buckets.set(l,[[t,e]])}}}getBucketKey(n,e){return`${Math.floor(n/this.CELL_SIZE)}x${Math.floor(e/this.CELL_SIZE)}`}getTargetsInArea(n,e,t,i){let r=[],s=new Set,o=Math.floor((n-t/2)/this.CELL_SIZE)*this.CELL_SIZE,a=Math.floor((e-i/2)/this.CELL_SIZE)*this.CELL_SIZE,c=n+t/2,l=e+i/2;for(let u=o;u<=c;u+=this.CELL_SIZE)for(let p=a;p<=l;p+=this.CELL_SIZE){let f=this.getBucketKey(u,p),y=this.buckets.get(f)||[];for(let g of y)s.has(g[1])||(s.add(g[1]),r.push(g[0]))}return r}},UMt=class extends an{constructor(e,t={}){super();d(this,"unfinishedNodes");d(this,"finishedNodes");d(this,"nodeToXYOverlappingObstaclesMap");d(this,"layerCount");d(this,"outlinePolygon");d(this,"MAX_DEPTH",4);d(this,"targets");d(this,"targetTree");d(this,"obstacleTree");d(this,"_nextNodeCounter",0);this.srj=e,this.opts=t,this.MAX_DEPTH=t?.capacityDepth??this.MAX_DEPTH,this.MAX_ITERATIONS=1e5,this.layerCount=e.layerCount??2,this.outlinePolygon=e.outline&&e.outline.length>=3?e.outline:void 0;for(let o of e.obstacles)if(!o.zLayers){let a=[];for(let c of o.layers)a.push(pd(c,e.layerCount));o.zLayers=a}let i={x:(e.bounds.minX+e.bounds.maxX)/2,y:(e.bounds.minY+e.bounds.maxY)/2},r={width:e.bounds.maxX-e.bounds.minX,height:e.bounds.maxY-e.bounds.minY},s=Math.max(r.width,r.height);this.unfinishedNodes=[{capacityMeshNodeId:this.getNextNodeId(),center:i,width:s,height:s,layer:"top",availableZ:Array.from({length:this.layerCount},(o,a)=>a),_depth:0,_containsTarget:!0,_containsObstacle:!0,_completelyInsideObstacle:!1}],this.finishedNodes=[],this.nodeToXYOverlappingObstaclesMap=new Map,this.obstacleTree=new eZ("flatbush",this.srj.obstacles),this.targets=this.computeTargets(),this.targetTree=new XMt(this.targets)}computeTargets(){let e=[];for(let t of this.srj.connections)for(let i of t.pointsToConnect){let r=this.obstacleTree.searchArea(i.x,i.y,.01,.01).filter(a=>a.zLayers.some(c=>c===pd(i.layer,this.layerCount))),s={minX:i.x-.005,minY:i.y-.005,maxX:i.x+.005,maxY:i.y+.005};r.length>0&&(s={minX:Math.min(...r.map(a=>a.center.x-a.width/2)),minY:Math.min(...r.map(a=>a.center.y-a.height/2)),maxX:Math.max(...r.map(a=>a.center.x+a.width/2)),maxY:Math.max(...r.map(a=>a.center.y+a.height/2))});let o={...i,connectionName:t.name,availableZ:[pd(i.layer,this.layerCount)],bounds:s};e.push(o)}return e}getNodeBounds(e){let t=e.width/2,i=e.height/2;return{minX:e.center.x-t,maxX:e.center.x+t,minY:e.center.y-i,maxY:e.center.y+i}}getNodeRect(e){return{center:{x:e.center.x,y:e.center.y},width:e.width,height:e.height}}getNextNodeId(){return"cn"+this._nextNodeCounter++}getCapacityFromDepth(e){return(this.MAX_DEPTH-e+1)**2}getTargetIfNodeContainsTarget(e){let t=e.width>4*this.targetTree.CELL_SIZE?this.targets:this.targetTree.getTargetsInArea(e.center.x,e.center.y,e.width,e.height);for(let i of t)if(i.bounds.minX<=e.center.x+e.width/2&&i.bounds.maxX>=e.center.x-e.width/2&&i.bounds.minY<=e.center.y+e.height/2&&i.bounds.maxY>=e.center.y-e.height/2&&i.availableZ.some(r=>e.availableZ.includes(r)))return i;return null}getXYOverlappingObstacles(e){let t=this.nodeToXYOverlappingObstaclesMap.get(e.capacityMeshNodeId);if(t)return t;let i=[],r=this.getNodeBounds(e),s=r.minX,o=r.maxX,a=r.minY,c=r.maxY,l=e._parent?this.getXYOverlappingObstacles(e._parent):this.srj.obstacles;for(let u of l){let p=u.center.x-u.width/2,f=u.center.x+u.width/2,y=u.center.y-u.height/2,g=u.center.y+u.height/2;(o>=p&&s<=f&&c>=y&&a<=g||s>=p&&o<=f&&a>=y&&c<=g||p>=s&&f<=o&&y>=a&&g<=c)&&i.push(u)}return this.nodeToXYOverlappingObstaclesMap.set(e.capacityMeshNodeId,i),i}getXYZOverlappingObstacles(e){let t=this.getXYOverlappingObstacles(e),i=[];for(let r of t)e.availableZ.some(s=>r.zLayers.includes(s))&&i.push(r);return i}doesNodeOverlapObstacle(e){if(this.getXYZOverlappingObstacles(e).length>0)return!0;let t=this.getNodeBounds(e);if(this.outlinePolygon){let i=this.getNodeRect(e);if(!Hq(i,this.outlinePolygon))return!0}return t.minX<this.srj.bounds.minX||t.maxX>this.srj.bounds.maxX||t.minY<this.srj.bounds.minY||t.maxY>this.srj.bounds.maxY}isNodeCompletelyInsideObstacle(e){let t=this.getXYZOverlappingObstacles(e),i=this.getNodeBounds(e);if(this.outlinePolygon){let r=this.getNodeRect(e);if(!N4(r,this.outlinePolygon))return!0}for(let r of t){let s=r.center.x-r.width/2,o=r.center.x+r.width/2,a=r.center.y-r.height/2,c=r.center.y+r.height/2;if(i.minX>=s&&i.maxX<=o&&i.minY>=a&&i.maxY<=c)return!0}return!1}getChildNodes(e){if(e._depth===this.MAX_DEPTH)return[];let t=[],i={width:e.width/2,height:e.height/2},r=[{x:e.center.x-i.width/2,y:e.center.y-i.height/2},{x:e.center.x+i.width/2,y:e.center.y-i.height/2},{x:e.center.x-i.width/2,y:e.center.y+i.height/2},{x:e.center.x+i.width/2,y:e.center.y+i.height/2}];for(let s of r){let o={capacityMeshNodeId:this.getNextNodeId(),center:s,width:i.width,height:i.height,layer:e.layer,availableZ:e.availableZ,_depth:(e._depth??0)+1,_parent:e};o._containsObstacle=this.doesNodeOverlapObstacle(o);let a=this.getTargetIfNodeContainsTarget(o);a&&(o._targetConnectionName=a.connectionName,o.availableZ=a.availableZ,o._containsTarget=!0),o._containsObstacle&&(o._completelyInsideObstacle=this.isNodeCompletelyInsideObstacle(o)),o._completelyInsideObstacle&&!o._containsTarget||t.push(o)}return t}shouldNodeBeXYSubdivided(e){return!(e._depth>=this.MAX_DEPTH)&&(!!e._containsTarget||!(!e._containsObstacle||e._completelyInsideObstacle))}_step(){let e=this.unfinishedNodes.pop();if(!e)return void(this.solved=!0);let t=this.getChildNodes(e),i=[],r=[];for(let s of t){let o=this.shouldNodeBeXYSubdivided(s);o?r.push(s):o||s._containsObstacle?!o&&s._containsTarget&&i.push(s):i.push(s)}this.unfinishedNodes.push(...r),this.finishedNodes.push(...i)}visualize(){let e={lines:[],points:[],rects:[],circles:[],coordinateSystem:"cartesian",title:"Capacity Mesh Visualization"};if(this.outlinePolygon&&this.outlinePolygon.length>=2){let i=this.outlinePolygon.map(r=>({x:r.x,y:r.y}));i.push({...i[0]}),e.lines.push({points:i,strokeColor:"rgba(0, 136, 255, 0.95)",label:"outline"});for(let r of this.outlinePolygon)e.points.push({x:r.x,y:r.y,color:"rgba(0, 136, 255, 0.95)"})}for(let i of this.srj.obstacles)e.rects.push({center:i.center,width:i.width,height:i.height,fill:i.zLayers?.length===1&&i.zLayers?.includes(1)?"rgba(0,0,255,0.3)":"rgba(255,0,0,0.3)",stroke:"red",label:["obstacle",`z: ${i.zLayers.join(",")}`].join(`
`)});let t=[...this.finishedNodes,...this.unfinishedNodes];for(let i of t){let r=Math.min(...i.availableZ),s=this.unfinishedNodes.length>0&&i===this.unfinishedNodes[this.unfinishedNodes.length-1];e.rects.push({center:{x:i.center.x+r*i.width*.05,y:i.center.y-r*i.width*.05},width:Math.max(i.width-2,.8*i.width),height:Math.max(i.height-2,.8*i.height),fill:i._containsObstacle?"rgba(255,0,0,0.1)":{"0,1":"rgba(0,0,0,0.1)",0:"rgba(0,200,200, 0.1)",1:"rgba(0,0,200, 0.1)"}[i.availableZ.join(",")]??"rgba(0,200,200,0.1)",stroke:s?"rgba(255,165,0,0.5)":void 0,label:[i.capacityMeshNodeId,`availableZ: ${i.availableZ.join(",")}`,`target? ${i._containsTarget??!1}`,`obs? ${i._containsObstacle??!1}`,`${i.width.toFixed(2)}x${i.height.toFixed(2)}`,`capacity: ${oo(i).toFixed(2)}`].join(`
`)})}return e.rects.sort((i,r)=>i.center.y-r.center.y),this.srj.connections.forEach((i,r)=>{let s=vq[r%vq.length];for(let o of i.pointsToConnect)e.points.push({x:o.x,y:o.y,label:`conn-${r} (${o.layer})`,color:s})}),e}},nZ=class extends UMt{constructor(e,t={}){super(e,t);d(this,"VIA_DIAMETER",.6);d(this,"OBSTACLE_MARGIN",.1);d(this,"OVERLAP_THRESHOLD_FOR_SINGLE_LAYER_NODES",.2);this.srj=e,this.opts=t}isNodeCompletelyOutsideBounds(e){if(this.outlinePolygon){let t=this.getNodeRect(e);if(!N4(t,this.outlinePolygon))return!0}return e.center.x+e.width/2<this.srj.bounds.minX||e.center.x-e.width/2>this.srj.bounds.maxX||e.center.y+e.height/2<this.srj.bounds.minY||e.center.y-e.height/2>this.srj.bounds.maxY}isNodePartiallyOutsideBounds(e){if(this.outlinePolygon){let t=this.getNodeRect(e);return!!N4(t,this.outlinePolygon)&&!Hq(t,this.outlinePolygon)}return e.center.x-e.width/2<this.srj.bounds.minX||e.center.x+e.width/2>this.srj.bounds.maxX||e.center.y-e.height/2<this.srj.bounds.minY||e.center.y+e.height/2>this.srj.bounds.maxY}getObstacleCoveragePercentage(e){let t=this.getXYZOverlappingObstacles(e);if(t.length===0)return 0;let i=e.center.x-e.width/2,r=e.center.x+e.width/2,s=e.center.y-e.height/2,o=e.center.y+e.height/2,a=e.width*e.height,c=0;for(let l of t){let u=Math.max(i,l.center.x-l.width/2),p=Math.min(r,l.center.x+l.width/2),f=Math.max(s,l.center.y-l.height/2),y=Math.min(o,l.center.y+l.height/2);u<p&&f<y&&(c+=(p-u)*(y-f))}return c/a}shouldFilterSingleLayerNodeForObstacle(e){return e.availableZ.length!==1||!e._containsObstacle?!1:this.getObstacleCoveragePercentage(e)>this.OVERLAP_THRESHOLD_FOR_SINGLE_LAYER_NODES}shouldFilterNodeForObstacle(e){return!!e._containsObstacle&&(e.availableZ.length!==1||this.shouldFilterSingleLayerNodeForObstacle(e))}createChildNodeAtPosition(e,t){let i={capacityMeshNodeId:this.getNextNodeId(),center:t.center,width:t.width,height:t.height,layer:e.layer,availableZ:t.availableZ,_depth:t._depth??(e._depth??0)+1,_parent:e},r=this.getXYZOverlappingObstacles(i);i._containsObstacle=r.length>0||this.isNodePartiallyOutsideBounds(i);let s=this.getTargetIfNodeContainsTarget(i);return s&&(i._targetConnectionName=s.connectionName,i._containsTarget=!0),i._containsObstacle&&(i._completelyInsideObstacle=this.isNodeCompletelyInsideObstacle(i)),i}getZSubdivisionChildNodes(e){if(e.availableZ.length===1)return[];let t=[],i=e.availableZ.map(r=>[r]);for(let r of i){let s=this.createChildNodeAtPosition(e,{center:{...e.center},width:e.width,height:e.height,availableZ:r,_depth:e._depth});this.isNodeCompletelyOutsideBounds(s)||t.push(s)}return t}getChildNodes(e){if(e._depth>=this.MAX_DEPTH)return[];let t=[],i={width:e.width/2,height:e.height/2},r=[{x:e.center.x-i.width/2,y:e.center.y-i.height/2},{x:e.center.x+i.width/2,y:e.center.y-i.height/2},{x:e.center.x-i.width/2,y:e.center.y+i.height/2},{x:e.center.x+i.width/2,y:e.center.y+i.height/2}];for(let s of r){let o=this.createChildNodeAtPosition(e,{center:s,width:i.width,height:i.height,availableZ:e.availableZ});this.isNodeCompletelyOutsideBounds(o)||t.push(o)}return t}shouldNodeBeXYSubdivided(e){return!(e._depth>=this.MAX_DEPTH)&&(!!e._containsTarget||e.availableZ.length===1&&e._depth<=this.MAX_DEPTH||!(!e._containsObstacle||e._completelyInsideObstacle))}_step(){let e=this.unfinishedNodes.pop();if(!e)return void(this.solved=!0);let t=this.getChildNodes(e),i=[],r=[];for(let s of t){let o=this.shouldNodeBeXYSubdivided(s),a=s.availableZ.length>1&&!o&&(s._containsObstacle||s.width<this.VIA_DIAMETER+this.OBSTACLE_MARGIN);if(o)r.push(s);else if(o||this.shouldFilterNodeForObstacle(s)||a)if(!o&&s._containsTarget)if(a){let c=this.getZSubdivisionChildNodes(s);i.push(...c.filter(l=>l._containsTarget||!this.shouldFilterNodeForObstacle(l)))}else i.push(s);else a&&i.push(...this.getZSubdivisionChildNodes(s).filter(c=>!this.shouldFilterNodeForObstacle(c)));else i.push(s)}this.unfinishedNodes.push(...r),this.finishedNodes.push(...i)}};function d_(n){let e=new Map;for(let t of n)for(let i of t.nodeIds)e.set(i,[...e.get(i)??[],t]);return e}var iZ=class extends an{constructor({nodes:e,edges:t,capacityPaths:i,colorMap:r}){super();d(this,"nodes");d(this,"edges");d(this,"capacityPaths");d(this,"nodeMap");d(this,"nodeEdgeMap");d(this,"unprocessedNodeIds");d(this,"nodePortSegments");d(this,"colorMap");this.nodes=e,this.edges=t,this.nodeMap=new Map(e.map(s=>[s.capacityMeshNodeId,s])),this.nodeEdgeMap=d_(t),this.capacityPaths=i,this.colorMap=r??{},this.unprocessedNodeIds=[...new Set(i.flatMap(s=>s.nodeIds))],this.nodePortSegments=new Map}step(){let e=this.unprocessedNodeIds.pop();if(!e)return void(this.solved=!0);let t=[];for(let o of this.capacityPaths){let a=o.nodeIds.indexOf(e);a!==-1&&t.push({path:o,indexOfNodeInPath:a})}let i=this.nodeMap.get(e),r=[];for(let{path:o,indexOfNodeInPath:a}of t){let c=o.nodeIds[a-1],l=o.nodeIds[a+1];for(let u of[c,l]){let p=this.nodeMap.get(u);if(!p)continue;let f=VMt(i,p),y=p.availableZ.filter(x=>i.availableZ.includes(x));if(y.length===0)continue;let g={capacityMeshNodeId:e,start:f.start,end:f.end,connectionNames:[o.connectionName],availableZ:y};r.push(g)}}let s=(function(o){let a=[],c=o.map(l=>({...l,connectionNames:[...l.connectionNames],availableZ:[...l.availableZ].sort((u,p)=>u-p)}));for(;c.length>0;){let l=c.pop(),u=!1;for(let p=0;p<a.length;p++){let f=a[p],y=OS(f.start,l.start)&&OS(f.end,l.end)||OS(f.start,l.end)&&OS(f.end,l.start),g=GMt(f.availableZ,l.availableZ);if(y&&g){let x=new Set(f.connectionNames);l.connectionNames.forEach(v=>x.add(v)),f.connectionNames=Array.from(x),u=!0;break}}u||a.push(l)}return a})(r);this.nodePortSegments.set(e,s)}visualize(){let e={lines:[],points:[],rects:[],circles:[]};return this.nodePortSegments.forEach((t,i)=>{this.nodeMap.get(i),t.forEach(r=>{r.start.x,r.end.x;for(let s=0;s<r.connectionNames.length;s++){let o={x:.05*Math.max(...r.availableZ),y:.05*Math.max(...r.availableZ)},a={x:(r.start.x+r.end.x)/2,y:(r.start.y+r.end.y)/2},c={x:a.x+o.x,y:a.y+o.y};o.x>0&&e.lines.push({points:[a,c],strokeColor:"rgba(0, 0, 0, 0.25)",strokeDash:"5 5"}),e.points.push({x:c.x,y:c.y,label:`${i}: ${r.connectionNames.join(", ")}
availableZ: ${r.availableZ.join(",")}
nodePortSegmentId: ${r.nodePortSegmentId}`}),e.lines.push({points:[r.start,r.end],strokeColor:Qn(this.colorMap[r.connectionNames[s]],.6)})}})}),e}};function VMt(n,e){let t={start:Math.max(n.center.x-n.width/2,e.center.x-e.width/2),end:Math.min(n.center.x+n.width/2,e.center.x+e.width/2)},i={start:Math.max(n.center.y-n.height/2,e.center.y-e.height/2),end:Math.min(n.center.y+n.height/2,e.center.y+e.height/2)};if(t.end-t.start<i.end-i.start){let r=(t.start+t.end)/2;return{start:{x:r,y:i.start},end:{x:r,y:i.end}}}{let r=(i.start+i.end)/2;return{start:{x:t.start,y:r},end:{x:t.end,y:r}}}}var Eq=1e-9;function OS(n,e){return Math.abs(n.x-e.x)<Eq&&Math.abs(n.y-e.y)<Eq}function GMt(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}var rZ=class extends an{constructor({segments:e,colorMap:t,nodes:i}){super();d(this,"unsolvedSegments");d(this,"solvedSegments");d(this,"nodeMap");d(this,"colorMap");this.MAX_ITERATIONS=1e5,this.unsolvedSegments=e,this.solvedSegments=[],this.colorMap=t??{},this.nodeMap=Object.fromEntries(i.map(r=>[r.capacityMeshNodeId,r]))}_step(){let e=!1,t=[...this.unsolvedSegments];for(let i of t){let r=i.connectionNames.length;if((!("assignedPoints"in i)||i.assignedPoints?.length!==r)&&r===1){let s={x:(i.start.x+i.end.x)/2,y:(i.start.y+i.end.y)/2,z:i.availableZ[0]};i.assignedPoints=[{connectionName:i.connectionNames[0],point:s}],this.unsolvedSegments.splice(this.unsolvedSegments.indexOf(i),1),this.solvedSegments.push(i),e=!0}}if(!e&&t.length>0){let i=t[0];for(let l of t)l.connectionNames.length<i.connectionNames.length&&(i=l);let r=[...i.connectionNames].sort(),s=i.end.x-i.start.x,o=i.end.y-i.start.y,a=r.length,c=[];for(let l=1;l<=a;l++){let u=l/(a+1);c.push({x:i.start.x+s*u,y:i.start.y+o*u,z:i.availableZ[0]})}i.assignedPoints=r.map((l,u)=>({connectionName:l,point:c[u]})),this.unsolvedSegments.splice(this.unsolvedSegments.indexOf(i),1),this.solvedSegments.push(i),e=!0}this.unsolvedSegments.length===0&&(this.solved=!0)}getNodesWithPortPoints(){if(!this.solved)throw new Error("CapacitySegmentToPointSolver not solved, can't give port points yet");let e=new Map;for(let t of this.solvedSegments){let i=t.capacityMeshNodeId,r=this.nodeMap[i];e.has(i)||e.set(i,{capacityMeshNodeId:i,portPoints:[],center:r.center,width:r.width,height:r.height}),e.get(i).portPoints.push(...t.assignedPoints.map(s=>({...s.point,connectionName:s.connectionName})))}return Array.from(e.values())}visualize(){let e={points:[],lines:this.solvedSegments.map(r=>({points:[r.start,r.end],step:4})),rects:[],circles:[],coordinateSystem:"cartesian",title:"Capacity Segment to Point Solver"};for(let r=0;r<this.solvedSegments.length;r++){let s=this.solvedSegments[r];for(let o=0;o<s.assignedPoints.length;o++){let a=s.assignedPoints[o],c={x:a.point.x,y:a.point.y},l={x:a.point.x+.05*a.point.z,y:a.point.y+.05*a.point.z};a.point.z!==0&&e.lines.push({points:[c,l],strokeColor:"rgba(0, 0, 0, 0.25)",strokeDash:"5 5",step:4}),e.points.push({x:l.x,y:l.y,label:[`${s.capacityMeshNodeId}-${a.connectionName}`,`z: ${s.availableZ.join(",")}`,`nodePortSegmentId: ${s.nodePortSegmentId}`].join(`
`),color:this.colorMap[a.connectionName],step:4})}}let t=[],i={};for(let r of this.solvedSegments){let s=r.capacityMeshNodeId;i[s]||(i[s]={});for(let o of r.assignedPoints)i[s][o.connectionName]||(i[s][o.connectionName]=[]),i[s][o.connectionName].push({x:o.point.x,y:o.point.y})}for(let r in i)for(let s in i[r]){let o=i[r][s];o.length>1&&t.push({points:o,step:4,strokeDash:"5 5",strokeColor:this.colorMap[s]||"#000"})}return e.lines.push(...t),e}},oZ=class{constructor(){d(this,"cacheHitsByPrefix",{});d(this,"cacheMissesByPrefix",{});d(this,"isSyncCache",!0);d(this,"cacheHits",0);d(this,"cacheMisses",0);d(this,"cache",new Map)}getCachedSolutionSync(n){let e=this.cache.get(n);if(e!==void 0){this.cacheHits++;let t=n.split(":")[0];return this.cacheHitsByPrefix[t]=(this.cacheHitsByPrefix[t]||0)+1,structuredClone(e)}{this.cacheMisses++;let t=n.split(":")[0];return void(this.cacheMissesByPrefix[t]=(this.cacheMissesByPrefix[t]||0)+1)}}async getCachedSolution(n){return this.getCachedSolutionSync(n)}setCachedSolutionSync(n,e){this.cache.set(n,structuredClone(e))}async setCachedSolution(n,e){this.setCachedSolutionSync(n,e)}clearCache(){this.cache.clear(),this.cacheHits=0,this.cacheMisses=0,this.cacheHitsByPrefix={},this.cacheMissesByPrefix={}}getAllCacheKeys(){return Array.from(this.cache.keys())}},k4="tscircuit_autorouter_cache_",aZ=class{constructor(){d(this,"isSyncCache",!0);d(this,"cacheHits",0);d(this,"cacheMisses",0);d(this,"cacheHitsByPrefix",{});d(this,"cacheMissesByPrefix",{})}getKey(n){return`${k4}${n}`}getCachedSolutionSync(n){if(typeof localStorage>"u")return;let e=this.getKey(n);try{let t=localStorage.getItem(e);if(t!==null){let i=JSON.parse(t);this.cacheHits++;let r=n.split(":")[0];return this.cacheHitsByPrefix[r]=(this.cacheHitsByPrefix[r]||0)+1,i}{this.cacheMisses++;let i=n.split(":")[0];return void(this.cacheMissesByPrefix[i]=(this.cacheMissesByPrefix[i]||0)+1)}}catch(t){console.error(`Error getting cached solution sync for ${e}:`,t),this.cacheMisses++;let i=n.split(":")[0];return void(this.cacheMissesByPrefix[i]=(this.cacheMissesByPrefix[i]||0)+1)}}async getCachedSolution(n){return this.getCachedSolutionSync(n)}setCachedSolutionSync(n,e){if(typeof localStorage>"u")return;let t=this.getKey(n);try{let i=JSON.stringify(e);localStorage.setItem(t,i)}catch(i){console.error(`Error setting cached solution sync for ${t}:`,i),i instanceof DOMException&&(i.name==="QuotaExceededError"||i.name==="NS_ERROR_DOM_QUOTA_REACHED")&&console.warn(`LocalStorage quota exceeded. Failed to cache solution for ${t}. Consider clearing the cache.`)}}async setCachedSolution(n,e){this.setCachedSolutionSync(n,e)}clearCache(){if(typeof localStorage<"u")try{let n=[];for(let e=0;e<localStorage.length;e++){let t=localStorage.key(e);t?.startsWith(k4)&&n.push(t)}n.forEach(e=>localStorage.removeItem(e)),console.log(`Cleared ${n.length} items from LocalStorage cache.`)}catch(n){console.error("Error clearing LocalStorage cache:",n)}finally{this.cacheHits=0,this.cacheMisses=0,this.cacheHitsByPrefix={},this.cacheMissesByPrefix={}}}getAllCacheKeys(){let n=[];for(let e=0;e<1e4;e++){let t=localStorage.key(e);if(!t)break;t.includes(k4)&&n.push(t)}return n}};function cZ(){return globalThis.TSCIRCUIT_AUTOROUTER_LOCAL_STORAGE_CACHE||Ug(),globalThis.TSCIRCUIT_AUTOROUTER_LOCAL_STORAGE_CACHE}function __(){return globalThis.TSCIRCUIT_AUTOROUTER_IN_MEMORY_CACHE||Ug(),globalThis.TSCIRCUIT_AUTOROUTER_IN_MEMORY_CACHE}function Ug(){globalThis.TSCIRCUIT_AUTOROUTER_LOCAL_STORAGE_CACHE??(globalThis.TSCIRCUIT_AUTOROUTER_LOCAL_STORAGE_CACHE=new aZ),globalThis.TSCIRCUIT_AUTOROUTER_IN_MEMORY_CACHE??(globalThis.TSCIRCUIT_AUTOROUTER_IN_MEMORY_CACHE=new oZ)}var HMt=class{constructor(n){d(this,"heap",[]);this.heap=[];for(let e of n)this.enqueue(e)}getLeftChildIndex(n){return 2*n+1}getRightChildIndex(n){return 2*n+2}getParentIndex(n){return Math.floor((n-1)/2)}hasLeftChild(n){return this.getLeftChildIndex(n)<this.heap.length}hasRightChild(n){return this.getRightChildIndex(n)<this.heap.length}hasParent(n){return this.getParentIndex(n)>=0}leftChild(n){return this.heap[this.getLeftChildIndex(n)]}rightChild(n){return this.heap[this.getRightChildIndex(n)]}parent(n){return this.heap[this.getParentIndex(n)]}swap(n,e){let t=this.heap[n];this.heap[n]=this.heap[e],this.heap[e]=t}dequeue(){if(this.heap.length===0)return null;let n=this.heap[0];return this.heap[0]=this.heap[this.heap.length-1],this.heap.pop(),this.heapifyDown(),n}peek(){return this.heap.length===0?null:this.heap[0]}enqueue(n){this.heap.push(n),this.heapifyUp()}heapifyUp(){let n=this.heap.length-1;for(;this.hasParent(n)&&this.parent(n).f>this.heap[n].f;)this.swap(this.getParentIndex(n),n),n=this.getParentIndex(n)}heapifyDown(){let n=0;for(;this.hasLeftChild(n);){let e=this.getLeftChildIndex(n);if(this.hasRightChild(n)&&this.rightChild(n).f<this.leftChild(n).f&&(e=this.getRightChildIndex(n)),this.heap[n].f<this.heap[e].f)break;this.swap(n,e),n=e}}},WMt=class extends an{constructor(e){super();d(this,"obstacleRoutes");d(this,"bounds");d(this,"boundsSize");d(this,"boundsCenter");d(this,"A");d(this,"B");d(this,"straightLineDistance");d(this,"viaDiameter");d(this,"traceThickness");d(this,"obstacleMargin");d(this,"layerCount");d(this,"minCellSize",.05);d(this,"cellStep",.05);d(this,"GREEDY_MULTIPLER",1.1);d(this,"numRoutes");d(this,"VIA_PENALTY_FACTOR",.3);d(this,"CELL_SIZE_FACTOR");d(this,"exploredNodes");d(this,"candidates");d(this,"connectionName");d(this,"solvedPath",null);d(this,"futureConnections");d(this,"hyperParameters");d(this,"connMap");d(this,"debug_exploredNodesOrdered");d(this,"debug_nodesTooCloseToObstacle");d(this,"debug_nodePathToParentIntersectsObstacle");d(this,"debugEnabled",!0);d(this,"initialNodeGridOffset");this.bounds=e.bounds,this.connMap=e.connMap,this.hyperParameters=e.hyperParameters??{},this.CELL_SIZE_FACTOR=this.hyperParameters.CELL_SIZE_FACTOR??1,this.boundsSize={width:this.bounds.maxX-this.bounds.minX,height:this.bounds.maxY-this.bounds.minY},this.boundsCenter={x:(this.bounds.minX+this.bounds.maxX)/2,y:(this.bounds.minY+this.bounds.maxY)/2},this.connectionName=e.connectionName,this.obstacleRoutes=e.obstacleRoutes,this.A=e.A,this.B=e.B,this.viaDiameter=e.viaDiameter??.6,this.traceThickness=e.traceThickness??.15,this.obstacleMargin=e.obstacleMargin??.2,this.layerCount=e.layerCount??2,this.exploredNodes=new Set,this.straightLineDistance=Qt(this.A,this.B),this.futureConnections=e.futureConnections??[],this.MAX_ITERATIONS=5e3,this.debug_exploredNodesOrdered=[],this.debug_nodesTooCloseToObstacle=new Set,this.debug_nodePathToParentIntersectsObstacle=new Set,this.numRoutes=this.obstacleRoutes.length+this.futureConnections.length;let t=Math.ceil(5*(this.numRoutes+1)),i=this.boundsSize.width/this.cellStep,r=this.boundsSize.height/this.cellStep;for(;i*r>t**2&&!(2*this.cellStep>e.minDistBetweenEnteringPoints);)this.cellStep*=2,i=this.boundsSize.width/this.cellStep,r=this.boundsSize.height/this.cellStep;this.cellStep*=this.CELL_SIZE_FACTOR,this.futureConnections&&this.futureConnections.length===0&&this.obstacleRoutes.length===0&&this.handleSimpleCases();let s={x:Math.round(e.A.x/(this.cellStep/2))*(this.cellStep/2),y:Math.round(e.A.y/(this.cellStep/2))*(this.cellStep/2)};this.initialNodeGridOffset={x:s.x-Math.round(e.A.x/this.cellStep)*this.cellStep,y:s.y-Math.round(e.A.y/this.cellStep)*this.cellStep},this.candidates=new HMt([{...e.A,...s,z:e.A.z??0,g:0,h:0,f:0,parent:{...e.A,z:e.A.z??0,g:0,h:0,f:0,parent:null}}])}handleSimpleCases(){this.solved=!0;let{A:e,B:t}=this,i=e.z===t.z?[e,t]:[e,{...this.boundsCenter,z:this.A.z},{...this.boundsCenter,z:t.z},t];this.solvedPath={connectionName:this.connectionName,route:i,traceThickness:this.traceThickness,viaDiameter:this.viaDiameter,vias:this.A.z===this.B.z?[]:[this.boundsCenter]}}get viaPenaltyDistance(){return this.cellStep+this.straightLineDistance*this.VIA_PENALTY_FACTOR}isNodeTooCloseToObstacle(e,t,i){if(t??(t=this.obstacleMargin),i&&e.parent){let r=this.getViasInNodePath(e.parent);for(let s of r)if(Qt(e,s)<this.viaDiameter/2+t)return!0}for(let r of this.obstacleRoutes){if(!this.connMap?.areIdsConnected?.(this.connectionName,r.connectionName)){let o=Mq(r);for(let a of o)if((i||a.z===e.z)&&_r(e,a.A,a.B)<this.traceThickness+t)return!0}for(let o of r.vias)if(Qt(e,o)<this.viaDiameter/2+this.traceThickness/2+t)return!0}return!1}isNodeTooCloseToEdge(e,t){let i=t?this.viaDiameter/2+this.obstacleMargin/2:this.obstacleMargin/2,r=e.x<this.bounds.minX+i||e.x>this.bounds.maxX-i||e.y<this.bounds.minY+i||e.y>this.bounds.maxY-i;return!(r&&!t&&(Qt(e,this.B)<2*i||Qt(e,this.A)<2*i))&&r}doesPathToParentIntersectObstacle(e){let t=e.parent;if(!t)return!1;for(let i of this.obstacleRoutes)if(!this.connMap?.areIdsConnected?.(this.connectionName,i.connectionName)){for(let s of Mq(i))if(s.z===e.z&&$i(e,t,s.A,s.B))return!0}return!1}computeH(e){return Qt(e,this.B)+Math.abs(e.z-this.B.z)*this.viaPenaltyDistance}computeG(e){return(e.parent?.g??0)+(e.z===0?0:this.viaPenaltyDistance)+Qt(e,e.parent)}computeF(e,t){return e+t*this.GREEDY_MULTIPLER}getNodeKey(e){return`${Math.round(e.x/this.cellStep)*this.cellStep},${Math.round(e.y/this.cellStep)*this.cellStep},${e.z}`}getNeighbors(e){let t=[],{maxX:i,minX:r,maxY:s,minY:o}=this.bounds;for(let c=-1;c<=1;c++)for(let l=-1;l<=1;l++){if(c===0&&l===0)continue;let u={...e,parent:e,x:Cq(e.x+c*this.cellStep,r,i),y:Cq(e.y+l*this.cellStep,o,s)},p=this.getNodeKey(u);this.exploredNodes.has(p)||(this.isNodeTooCloseToObstacle(u)?(this.debug_nodesTooCloseToObstacle.add(p),this.exploredNodes.add(p)):this.isNodeTooCloseToEdge(u,!1)?this.exploredNodes.add(p):this.doesPathToParentIntersectObstacle(u)?(this.debug_nodePathToParentIntersectsObstacle.add(p),this.exploredNodes.add(p)):(u.g=this.computeG(u),u.h=this.computeH(u),u.f=this.computeF(u.g,u.h),t.push(u)))}let a={...e,parent:e,z:e.z===0?this.layerCount-1:0};return this.exploredNodes.has(this.getNodeKey(a))||this.isNodeTooCloseToObstacle(a,this.viaDiameter/2+this.obstacleMargin/2,!0)||this.isNodeTooCloseToEdge(a,!0)||(a.g=this.computeG(a),a.h=this.computeH(a),a.f=this.computeF(a.g,a.h),t.push(a)),t}getNodePath(e){let t=[];for(;e;)t.push(e),e=e.parent;return t}getViasInNodePath(e){let t=this.getNodePath(e),i=[];for(let r=0;r<t.length-1;r++)t[r].z!==t[r+1].z&&i.push({x:t[r].x,y:t[r].y});return i}setSolvedPath(e){let t=this.getNodePath(e);t.reverse();let i=[];for(let r=0;r<t.length-1;r++)t[r].z!==t[r+1].z&&i.push({x:t[r].x,y:t[r].y});this.solvedPath={connectionName:this.connectionName,traceThickness:this.traceThickness,viaDiameter:this.viaDiameter,route:t.map(r=>({x:r.x,y:r.y,z:r.z})).concat([this.B]),vias:i}}computeProgress(e,t,i){i||(t+=this.viaPenaltyDistance);let r=1-t/this.straightLineDistance;return Math.max(this.progress||0,2/Math.PI*Math.atan(.112*r/(1-r)))}_step(){let e=this.candidates.dequeue(),t=e?this.getNodeKey(e):void 0;for(;e&&t&&this.exploredNodes.has(t);)e=this.candidates.dequeue(),t=e?this.getNodeKey(e):void 0;if(!e||!t)return void(this.failed=!0);this.exploredNodes.add(t),this.debug_exploredNodesOrdered.push(t);let i=Qt(e,this.B);this.progress=this.computeProgress(e,i,e.z===this.B.z),i<=this.cellStep*Math.SQRT2&&e.z===this.B.z&&!this.doesPathToParentIntersectObstacle({...e,parent:e,x:this.B.x,y:this.B.y})&&(this.solved=!0,this.setSolvedPath(e));let r=this.getNeighbors(e);for(let s of r)this.candidates.enqueue(s)}visualize(){let e={lines:[],points:[],rects:[],circles:[]};e.points.push({x:this.A.x,y:this.A.y,label:`Input A
z: ${this.A.z}`,color:"orange"}),e.points.push({x:this.B.x,y:this.B.y,label:`Input B
z: ${this.B.z}`,color:"orange"}),e.lines.push({points:[this.A,this.B],strokeColor:"rgba(255, 0, 0, 0.5)",label:"Direct Input Connection"});for(let t=0;t<this.obstacleRoutes.length;t++){let i=this.obstacleRoutes[t];for(let r=0;r<i.route.length-1;r++){let s=i.route[r].z;e.lines.push({points:[i.route[r],i.route[r+1]],strokeColor:s===0?"rgba(255, 0, 0, 0.75)":"rgba(255, 128, 0, 0.25)",strokeWidth:i.traceThickness,label:"Obstacle Route",layer:`obstacle${t.toString()}`})}}for(let t=0;t<this.debug_exploredNodesOrdered.length;t++){let i=this.debug_exploredNodesOrdered[t],[r,s,o]=i.split(",").map(Number);this.debug_nodesTooCloseToObstacle.has(i)||this.debug_nodePathToParentIntersectsObstacle.has(i)||e.rects.push({center:{x:r+this.initialNodeGridOffset.x+o*this.cellStep/20,y:s+this.initialNodeGridOffset.y+o*this.cellStep/20},fill:o===0?`rgba(255,0,255,${.3-t/this.debug_exploredNodesOrdered.length*.2})`:`rgba(0,0,255,${.3-t/this.debug_exploredNodesOrdered.length*.2})`,width:.9*this.cellStep,height:.9*this.cellStep,label:`Explored (z=${o})`})}if(this.candidates.peek()){let t=this.candidates.peek();e.rects.push({center:{x:t.x+t.z*this.cellStep/20,y:t.y+t.z*this.cellStep/20},fill:"rgba(0, 255, 0, 0.8)",width:.9*this.cellStep,height:.9*this.cellStep,label:`Next (z=${t.z})`})}for(let t of this.obstacleRoutes)for(let i of t.vias)e.circles.push({center:{x:i.x,y:i.y},radius:this.viaDiameter/2,fill:"rgba(255, 0, 0, 0.5)",label:"Via"});if(this.solvedPath){e.lines.push({points:this.solvedPath.route,strokeColor:"green",label:"Solved Route"});for(let t of this.solvedPath.vias)e.circles.push({center:t,radius:this.viaDiameter/2,fill:"green",label:"Via"})}return e}};function Mq(n){let e=[];for(let t=0;t<n.route.length-1;t++)n.route[t].z===n.route[t+1].z&&e.push({z:n.route[t].z,A:n.route[t],B:n.route[t+1]});return e}function Cq(n,e,t){return Math.max(e,Math.min(n,t))}var qMt=class extends WMt{constructor(e){super(e);d(this,"FUTURE_CONNECTION_PROX_TRACE_PENALTY_FACTOR",2);d(this,"FUTURE_CONNECTION_PROX_VIA_PENALTY_FACTOR",1);d(this,"FUTURE_CONNECTION_PROXIMITY_VD",10);d(this,"MISALIGNED_DIST_PENALTY_FACTOR",5);d(this,"VIA_PENALTY_FACTOR_2",1);d(this,"FLIP_TRACE_ALIGNMENT_DIRECTION",!1);for(let i in e.hyperParameters)this[i]=e.hyperParameters[i];let t=this.boundsSize.width/this.viaDiameter;this.VIA_PENALTY_FACTOR=t/this.numRoutes*.3*this.VIA_PENALTY_FACTOR_2}getClosestFutureConnectionPoint(e){let t=1/0,i=null;for(let r of this.futureConnections)for(let s of r.points){let o=Qt(e,s)+(e.z!==s.z?this.viaPenaltyDistance:0);o<t&&(t=o,i=s)}return i}diminishCloseToGoal(e){let t=Qt(e,this.B);return 1-Math.exp(-t/this.straightLineDistance*5)}getFutureConnectionPenalty(e,t){let i=0,r=this.getClosestFutureConnectionPoint(e),s=Qt(e,this.B);if(r){let o=Qt(e,r);if(s<=o)return 0;let a=o/(this.viaDiameter*this.FUTURE_CONNECTION_PROXIMITY_VD);i=(t?this.straightLineDistance*this.FUTURE_CONNECTION_PROX_VIA_PENALTY_FACTOR:this.straightLineDistance*this.FUTURE_CONNECTION_PROX_TRACE_PENALTY_FACTOR)*Math.exp(5*-a)}return i}computeH(e){let t=Qt(e,this.B)**1.6;return this.straightLineDistance,t+(e.z!==this.B.z?this.viaPenaltyDistance:0)+this.getFutureConnectionPenalty(e,e.z!==e.parent?.z)}computeG(e){let t=Math.abs(e.x-e.parent.x),i=Math.abs(e.y-e.parent.y),r=Math.sqrt(t**2+i**2),s=this.FLIP_TRACE_ALIGNMENT_DIRECTION?e.z===0?t:i:e.z===0?i:t;return(e.parent?.g??0)+(e.z===e.parent?.z?0:this.viaPenaltyDistance)+r+s*this.MISALIGNED_DIST_PENALTY_FACTOR+this.getFutureConnectionPenalty(e,e.z!==e.parent?.z)}};function Dg(n){let e=n;for(let r=0;r<10;r++)e=16807*e%2147483647;let t=e;e=(69069*n+1)%2147483647;for(let r=0;r<10;r++)e=48271*e%2147483647;let i=e;return()=>{let r=t;t=i,r^=r<<23,r^=r>>>17,r^=i,r^=i>>>26,i=r;let s=(t+i)/4294967296;return s-Math.floor(s)}}var ZMt={1:[[0]],2:[[0,1],[1,0]],3:[[0,1,2],[2,0,1],[1,0,2],[0,2,1],[1,2,0],[2,1,0]],4:[[0,1,2,3],[2,0,1,3],[1,3,2,0],[3,0,1,2],[0,2,1,3],[2,1,3,0],[3,0,2,1],[1,2,0,3],[3,1,0,2],[0,3,2,1],[2,3,0,1],[2,3,1,0],[1,2,3,0],[3,1,2,0],[0,1,3,2],[0,2,3,1],[0,3,1,2],[1,0,2,3],[1,0,3,2],[1,3,0,2],[2,0,3,1],[2,1,0,3],[3,2,0,1],[3,2,1,0]]};function Xg(n,e){if(e===0)return n;if(n.length<=4){let r=ZMt[n.length];return r[e%r.length].map(s=>n[s])}let t=Dg(e),i=n.slice();for(let r=0;r<i.length;r++){let s=Math.floor(t()*i.length),o=Math.floor(t()*(r+1));[i[s],i[o]]=[i[o],i[s]]}return i}function z4(n){let e={minX:n.center.x-n.width/2,maxX:n.center.x+n.width/2,minY:n.center.y-n.height/2,maxY:n.center.y+n.height/2};for(let t of n.portPoints)t.x<e.minX&&(e.minX=t.x),t.x>e.maxX&&(e.maxX=t.x),t.y<e.minY&&(e.minY=t.y),t.y>e.maxY&&(e.maxY=t.y);return e}var KMt=class extends an{constructor(e){let{nodeWithPortPoints:t,colorMap:i}=e;super();d(this,"nodeWithPortPoints");d(this,"colorMap");d(this,"unsolvedConnections");d(this,"totalConnections");d(this,"solvedRoutes");d(this,"failedSubSolvers");d(this,"hyperParameters");d(this,"minDistBetweenEnteringPoints");d(this,"activeSubSolver",null);d(this,"connMap");this.nodeWithPortPoints=t,this.colorMap=i??{},this.solvedRoutes=[],this.hyperParameters=e.hyperParameters??{},this.failedSubSolvers=[],this.connMap=e.connMap;let r=new Map;for(let{connectionName:s,x:o,y:a,z:c}of t.portPoints)r.set(s,[...r.get(s)??[],{x:o,y:a,z:c??0}]);this.unsolvedConnections=Array.from(r.entries().map(([s,o])=>({connectionName:s,points:o}))),this.hyperParameters.SHUFFLE_SEED&&(this.unsolvedConnections=Xg(this.unsolvedConnections,this.hyperParameters.SHUFFLE_SEED??0),this.unsolvedConnections=this.unsolvedConnections.map(({points:s,...o},a)=>({...o,points:Xg(s,7117*a+(this.hyperParameters.SHUFFLE_SEED??0))}))),this.totalConnections=this.unsolvedConnections.length,this.MAX_ITERATIONS=1e3*this.totalConnections**1.5,this.minDistBetweenEnteringPoints=(s=>{let o=1/0,a=s.portPoints;for(let c=0;c<a.length;c++)for(let l=c+1;l<a.length;l++){if(a[c].z!==a[l].z)continue;let u=a[c],p=a[l],f=Math.sqrt((u.x-p.x)**2+(u.y-p.y)**2);o=Math.min(o,f)}return o===1/0?0:o})(this.nodeWithPortPoints)}get failedSolvers(){return this.failedSubSolvers}get activeSolver(){return this.activeSubSolver}computeProgress(){return(this.solvedRoutes.length+(this.activeSubSolver?.progress||0))/this.totalConnections}_step(){if(this.activeSubSolver)return this.activeSubSolver.step(),this.progress=this.computeProgress(),void(this.activeSubSolver.solved?(this.solvedRoutes.push(this.activeSubSolver.solvedPath),this.activeSubSolver=null):this.activeSubSolver.failed&&(this.failedSubSolvers.push(this.activeSubSolver),this.activeSubSolver=null,this.error=this.failedSubSolvers.map(r=>r.error).join(`
`),this.failed=!0));let e=this.unsolvedConnections.pop();if(this.progress=this.computeProgress(),!e)return void(this.solved=this.failedSubSolvers.length===0);if(e.points.length===1)return;if(e.points.length===2){let[r,s]=e.points;if(r.x===s.x&&r.y===s.y&&r.z===s.z)return}let{connectionName:t,points:i}=e;this.activeSubSolver=new qMt({connectionName:t,minDistBetweenEnteringPoints:this.minDistBetweenEnteringPoints,bounds:z4(this.nodeWithPortPoints),A:{x:i[0].x,y:i[0].y,z:i[0].z},B:{x:i[i.length-1].x,y:i[i.length-1].y,z:i[i.length-1].z},obstacleRoutes:this.connMap?this.solvedRoutes.filter(r=>!this.connMap.areIdsConnected(r.connectionName,t)):this.solvedRoutes,futureConnections:this.unsolvedConnections,layerCount:2,hyperParameters:this.hyperParameters,connMap:this.connMap})}visualize(){let e={lines:[],points:[],rects:[],circles:[]};for(let a of this.nodeWithPortPoints.portPoints)e.points.push({x:a.x,y:a.y,label:[a.connectionName,`layer: ${a.z}`].join(`
`),color:this.colorMap[a.connectionName]??"blue"});for(let a=0;a<this.solvedRoutes.length;a++){let c=this.solvedRoutes[a];if(c.route.length>0){let l=this.colorMap[c.connectionName]??"blue";for(let u=0;u<c.route.length-1;u++){let p=c.route[u],f=c.route[u+1];e.lines.push({points:[p,f],strokeColor:p.z===0?Qn(l,.2):Qn(l,.8),layer:`route-layer-${p.z}`,step:a,strokeWidth:c.traceThickness})}for(let u of c.vias)e.circles.push({center:{x:u.x,y:u.y},radius:c.viaDiameter/2,fill:Qn(l,.5),layer:"via",step:a})}}let t=z4(this.nodeWithPortPoints),{minX:i,minY:r,maxX:s,maxY:o}=t;return e.lines.push({points:[{x:i,y:r},{x:s,y:r},{x:s,y:o},{x:i,y:o},{x:i,y:r}],strokeColor:"rgba(255, 0, 0, 0.25)",strokeDash:"4 4",layer:"border"}),e}},od=n=>Math.round(200*n)/200,T4=n=>typeof structuredClone=="function"?structuredClone(n):JSON.parse(JSON.stringify(n));Ug();var JMt=class extends KMt{constructor(e){super(e);d(this,"cacheProvider");d(this,"cacheHit",!1);d(this,"hasAttemptedToUseCache",!1);d(this,"initialUnsolvedConnections");this.cacheProvider=e.cacheProvider===void 0?__():e.cacheProvider,this.initialUnsolvedConnections=T4(this.unsolvedConnections),(this.solved||this.failed)&&this.cacheProvider&&!this.cacheHit&&this.saveToCacheSync()}_step(){if(!this.hasAttemptedToUseCache&&this.cacheProvider&&this.attemptToUseCacheSync())return;let e=this.solved,t=this.failed;super._step(),!this.cacheProvider||this.cacheHit||!this.solved&&!this.failed||e||t||this.saveToCacheSync()}computeCacheKeyAndTransform(){let e=this.nodeWithPortPoints.center,t=this.initialUnsolvedConnections.map(({connectionName:c,points:l})=>({connectionName:c,points:l.map(u=>({connectionName:c,x:od(u.x-e.x),y:od(u.y-e.y),z:u.z??0}))})),i=Object.fromEntries(Object.entries(this.hyperParameters??{}).filter(([,c])=>c!==void 0).sort(([c],[l])=>c.localeCompare(l))),r=this.connMap?this.initialUnsolvedConnections.map(({connectionName:c})=>({connectionName:c,connectedIds:[...new Set(this.connMap.getIdsConnectedToNet(c)??[])].sort()})):void 0,s={node:{width:od(this.nodeWithPortPoints.width),height:od(this.nodeWithPortPoints.height),center:{x:od(this.nodeWithPortPoints.center.x),y:od(this.nodeWithPortPoints.center.y)},availableZ:this.nodeWithPortPoints.availableZ?[...this.nodeWithPortPoints.availableZ].sort():void 0},normalizedConnections:t,normalizedHyperParameters:i,minDistBetweenEnteringPoints:od(this.minDistBetweenEnteringPoints),normalizedConnMap:r},o=`intranode-solver:${(0,sZ.default)(s)}`,a={};return this.cacheKey=o,this.cacheToSolveSpaceTransform=a,{cacheKey:o,cacheToSolveSpaceTransform:a}}applyCachedSolution(e){e.success?(this.solvedRoutes=T4(e.solvedRoutes),this.solved=!0,this.failed=!1):(this.solvedRoutes=[],this.failedSubSolvers=[],this.solved=!1,this.failed=!0,this.error=e.error??this.error),this.unsolvedConnections=[],this.activeSubSolver=null,this.cacheHit=!0,this.progress=1}attemptToUseCacheSync(){if(this.hasAttemptedToUseCache=!0,!this.cacheProvider?.isSyncCache)return!1;if(!this.cacheKey)try{this.computeCacheKeyAndTransform()}catch(e){return console.error("Error computing cache key:",e),!1}if(!this.cacheKey)return console.error("Failed to compute cache key."),!1;try{let e=this.cacheProvider.getCachedSolutionSync(this.cacheKey);if(e!=null)return this.applyCachedSolution(e),!0}catch(e){console.error("Error attempting to use cache:",e)}return!1}saveToCacheSync(){if(!this.cacheProvider?.isSyncCache)return;if(!this.cacheKey)try{this.computeCacheKeyAndTransform()}catch(t){return void console.error("Error computing cache key during save:",t)}if(!this.cacheKey)return void console.error("Failed to compute cache key before saving.");let e=this.failed?{success:!1,error:this.error??void 0}:{success:!0,solvedRoutes:T4(this.solvedRoutes)};try{this.cacheProvider.setCachedSolutionSync(this.cacheKey,e)}catch(t){console.error("Error saving solution to cache:",t)}}},U4=class extends an{constructor(){super(...arguments);d(this,"GREEDY_MULTIPLIER",1.2);d(this,"MIN_SUBSTEPS",1);d(this,"supervisedSolvers");d(this,"winningSolver")}getHyperParameterDefs(){throw new Error("Not implemented")}getCombinationDefs(){return null}getHyperParameterCombinations(e){e||(e=this.getHyperParameterDefs());let t=[];if(e.length===0)return[{}];let[i,...r]=e,s=this.getHyperParameterCombinations(r);return i.possibleValues.forEach(o=>{s.forEach(a=>{t.push({...a,...o})})}),t}initializeSolvers(){let e=this.getHyperParameterDefs(),t=this.getCombinationDefs()??[e.map(i=>i.name)];this.supervisedSolvers=[];for(let i of t){let r=this.getHyperParameterCombinations(e.filter(s=>i.includes(s.name)));for(let s of r){let o=this.generateSolver(s),a=this.computeG(o);this.supervisedSolvers.push({hyperParameters:s,solver:o,h:0,g:a,f:a})}}}generateSolver(e){throw new Error("Not implemented")}computeG(e){return e.iterations/e.MAX_ITERATIONS}computeH(e){return 1-(e.progress||0)}computeF(e,t){return e+t*this.GREEDY_MULTIPLIER}getSupervisedSolverWithBestFitness(){let e=1/0,t=null;for(let i of this.supervisedSolvers??[]){if(i.solver.solved)return i;if(i.solver.failed)continue;let r=i.f;r<e&&(e=r,t=i)}return t}getFailureMessage(){return"All solvers failed in hyper solver."}_step(){this.supervisedSolvers||this.initializeSolvers();let e=this.getSupervisedSolverWithBestFitness();if(!e)return this.failed=!0,void(this.error=this.getFailureMessage());for(let t=0;t<this.MIN_SUBSTEPS;t++)e.solver.step();e.g=this.computeG(e.solver),e.h=this.computeH(e.solver),e.f=this.computeF(e.g,e.h),e.solver.solved&&(this.solved=!0,this.winningSolver=e.solver,this.onSolve?.(e))}onSolve(e){}visualize(){let e=this.getSupervisedSolverWithBestFitness(),t={lines:[],circles:[],points:[],rects:[]};return e&&(t=e.solver.visualize()),t}};function QMt({A:n,B:e,C:t,D:i,E:r,F:s,radius:o,margin:a,subdivisions:c=0}){let l=(N,M)=>({x:(N.x+M.x)/2,y:(N.y+M.y)/2}),u=(N,M,A)=>{let R=M.x-N.x,j=M.y-N.y,B=Math.sqrt(R*R+j*j),G=R/B,U=j/B,H=-U,tt=G;return{midpoint:{x:(N.x+M.x)/2,y:(N.y+M.y)/2},A_Opp:{x:N.x-G*A,y:N.y-U*A},A_Right:{x:N.x+H*A,y:N.y+tt*A},A_Left:{x:N.x-H*A,y:N.y-tt*A},B_Opp:{x:M.x+G*A,y:M.y+U*A},B_Right:{x:M.x+H*A,y:M.y+tt*A},B_Left:{x:M.x-H*A,y:M.y-tt*A}}},p=(N,M)=>{let A=Qt(N,M.start),R=Qt(N,M.end),j=Qt(M.start,M.end);return Math.abs(A+R-j)<1e-4},f=(N,M)=>{let{start:A,end:R}=N,{start:j,end:B}=M;if(p(A,M)||p(R,M)||p(j,N)||p(B,N))return!0;let G=R.x-A.x,U=R.y-A.y,H=B.x-j.x,tt=B.y-j.y,et=G*tt-U*H;if(Math.abs(et)<1e-4)return!1;let mt=j.x-A.x,V=j.y-A.y,J=(mt*tt-V*H)/et,nt=(mt*U-V*G)/et;return J>0&&J<1&&nt>0&&nt<1},y=(N,M)=>{let A=[];for(let j=0;j<N.length-1;j++)A.push({start:N[j],end:N[j+1]});let R=[];for(let j=0;j<M.length-1;j++)R.push({start:M[j],end:M[j+1]});for(let j of A)for(let B of R)if(f(j,B))return!0;return!1},g=N=>{let M=0;for(let A=1;A<N.length;A++){let R=N[A].x-N[A-1].x,j=N[A].y-N[A-1].y;M+=Math.sqrt(R*R+j*j)}return M},x=(N,M)=>{let{start:A,end:R}=N,j=R.x-A.x,B=R.y-A.y,G=j*j+B*B;if(G===0)return{...A,t:0};let U=Math.max(0,Math.min(1,((M.x-A.x)*j+(M.y-A.y)*B)/G));return{x:A.x+U*j,y:A.y+U*B,t:U}},v=(N,M,A)=>{let R=x(N,M);if(Qt(R,M)>=A)return R;let j=R.x-M.x,B=R.y-M.y,G=Math.sqrt(j*j+B*B);if(G===0){let U=N.end.x-N.start.x,H=N.end.y-N.start.y,tt=Math.sqrt(U*U+H*H);return{x:M.x+A*U/tt,y:M.y+A*H/tt,t:R.t,isSpecial:!0,specialType:M===n?"A":"B"}}return{x:M.x+A*j/G,y:M.y+A*B/G,t:R.t,isSpecial:!0,specialType:M===n?"A":"B"}},P=u(n,e,o),w=u(n,e,o+a),k=(N,M,A,R,j)=>{let B=N.points;if(B.length<2)return B;let G=A+R,U=[B[0]];for(let H=0;H<B.length-1;H++){let tt={start:B[H],end:B[H+1]};if(_r(M,tt.start,tt.end)<G){let et=x(tt,M),mt=et.x-M.x,V=et.y-M.y,J=Math.sqrt(mt*mt+V*V),nt=null;if(J>1e-6)nt={x:M.x+G*mt/J,y:M.y+G*V/J};else{let ut=tt.end.x-tt.start.x,ht=tt.end.y-tt.start.y,kt=Math.sqrt(ut*ut+ht*ht);kt>1e-6&&(nt={x:M.x+G*ut/kt,y:M.y+G*ht/kt})}nt&&Qt(tt.start,nt)>o/10&&U.push(nt)}Qt(U[U.length-1],tt.end)>o/10&&U.push(tt.end)}if(U.length>1){let H=[U[0]];for(let tt=1;tt<U.length;tt++)Qt(H[H.length-1],U[tt])>o/10&&H.push(U[tt]);return H}return U},T=(()=>{let N=[[t,P.B_Left,P.B_Opp,P.B_Right,l(P.midpoint,l(P.B_Right,P.A_Right)),l(P.midpoint,l(P.A_Left,P.B_Left)),P.A_Left,P.A_Opp,P.A_Right,i],[t,P.B_Right,P.B_Opp,P.B_Left,l(P.midpoint,l(P.A_Left,P.B_Left)),l(P.midpoint,l(P.A_Right,P.B_Right)),P.A_Right,P.A_Opp,P.A_Left,i],[i,P.B_Left,P.B_Opp,P.B_Right,l(P.midpoint,l(P.A_Right,P.B_Right)),l(P.midpoint,l(P.A_Left,P.B_Left)),P.A_Left,P.A_Opp,P.A_Right,t],[i,P.B_Right,P.B_Opp,P.B_Left,l(P.midpoint,l(P.A_Left,P.B_Left)),l(P.midpoint,l(P.A_Right,P.B_Right)),P.A_Right,P.A_Opp,P.A_Left,t]],M=[];for(let V=0;V<N.length;V++){let J=N[V],nt={start:J[0],end:J[1]},ut={start:J[J.length-2],end:J[J.length-1]},ht={start:J[3],end:J[4]};f(nt,ut)||f(nt,ht)||f(ut,ht)||M.push({index:V+1,path:J,length:g(J)})}if(M.length===0)return{index:0,path:[]};let A=M.sort((V,J)=>V.length-J.length)[0],R=[...A.path],j=R[0],B=Qt(j,R[2]),G=Qt(j,R[3]),U=B<G?2:3;(B<Qt(j,R[1])||G<Qt(j,R[1]))&&R.splice(1,U-1);let H=R[R.length-1],tt=Qt(H,R[R.length-3]),et=Qt(H,R[R.length-4]),mt=tt<et?R.length-3:R.length-4;return(tt<Qt(H,R[R.length-2])||et<Qt(H,R[R.length-2]))&&R.splice(mt+1,R.length-mt-2),{index:A.index,path:R,startsAt:R[0]===t?"C":"D",goesTo:R[R.length-1]===t?"C":"D"}})(),I=c>0?((N,M)=>{if(N.length<2)return N;let A=[N[0]];for(let R=0;R<N.length-1;R++){let j={start:N[R],end:N[R+1]},B={x:(j.start.x+j.end.x)/2,y:(j.start.y+j.end.y)/2},G=Qt(B,n),U=Qt(B,e);if((G<=o||U<=o)&&Math.abs(G-U)>1e-4){let H=x(j,n),tt=x(j,e),et=Qt(H,n),mt=Qt(tt,e)<o,V=et<o?v(j,n,o):null,J=mt?v(j,e,o):null,nt=[];if(Qt(j.start,j.end)>o/2&&M>0)for(let ut=1;ut<=M;ut++){let ht=ut/(M+1),kt={x:j.start.x+ht*(j.end.x-j.start.x),y:j.start.y+ht*(j.end.y-j.start.y),t:ht,isSpecial:!1},Mt=Qt(kt,n),ot=Qt(kt,e);Mt<o||ot<o||V&&Math.abs(kt.t-V.t)<.1||J&&Math.abs(kt.t-J.t)<.1||nt.push(kt)}if(V&&nt.push(V),J&&nt.push(J),nt.sort((ut,ht)=>ut.t-ht.t),nt.length>1){let ut=[nt[0]];for(let ht=1;ht<nt.length;ht++){let kt=ut[ut.length-1],Mt=nt[ht];Qt(kt,Mt)>o/10&&ut.push(Mt)}nt=ut}nt.forEach(ut=>A.push(ut))}A.push(N[R+1])}if(A.length>1){let R=[A[0]];for(let j=1;j<A.length;j++){let B=R[R.length-1],G=A[j];Qt(B,G)>o/10&&R.push(G)}return R}return A})(T.path,c):T.path,E=(()=>{if(T.path.length===0)return null;let N=(()=>{let B=l(P.A_Right,P.B_Right),G=l(P.B_Left,P.A_Left);return[{startsAt:"E",goesTo:"B",points:[r,e]},{startsAt:"E",goesTo:"A",points:[r,n]},{startsAt:"F",goesTo:"B",points:[s,e]},{startsAt:"F",goesTo:"A",points:[s,n]},{startsAt:"E",goesTo:"B",points:[r,B,e]},{startsAt:"E",goesTo:"A",points:[r,B,n]},{startsAt:"F",goesTo:"B",points:[s,B,e]},{startsAt:"F",goesTo:"A",points:[s,B,n]},{startsAt:"E",goesTo:"B",points:[r,G,e]},{startsAt:"E",goesTo:"A",points:[r,G,n]},{startsAt:"F",goesTo:"B",points:[s,G,e]},{startsAt:"F",goesTo:"A",points:[s,G,n]},{startsAt:"E",goesTo:"B",points:[r,w.A_Right,B,e]},{startsAt:"F",goesTo:"B",points:[s,w.B_Right,B,e]},{startsAt:"E",goesTo:"A",points:[r,w.B_Left,G,n]},{startsAt:"F",goesTo:"A",points:[s,w.A_Left,G,n]},{startsAt:"E",goesTo:"B",points:[r,w.A_Left,G,e]},{startsAt:"E",goesTo:"A",points:[r,w.B_Right,B,n]},{startsAt:"E",goesTo:"B",points:[r,w.A_Opp,w.A_Right,B,e]},{startsAt:"E",goesTo:"A",points:[r,w.B_Opp,w.B_Left,G,n]},{startsAt:"F",goesTo:"B",points:[s,w.A_Opp,w.A_Left,G,e]},{startsAt:"F",goesTo:"A",points:[s,w.B_Opp,w.B_Right,B,n]},{startsAt:"F",goesTo:"A",points:[s,w.B_Opp,w.B_Left,G,n]},{startsAt:"E",goesTo:"B",points:[r,w.A_Opp,w.A_Left,G,e]},{startsAt:"E",goesTo:"A",points:[r,w.B_Opp,w.B_Right,B,n]},{startsAt:"E",goesTo:"B",points:[r,w.A_Left,w.A_Opp,w.A_Right,B,e]},{startsAt:"E",goesTo:"A",points:[r,w.B_Right,w.B_Opp,w.B_Left,G,n]},{startsAt:"F",goesTo:"B",points:[s,w.A_Right,w.A_Opp,w.A_Left,G,e]},{startsAt:"F",goesTo:"A",points:[s,w.B_Left,w.B_Opp,w.B_Right,B,n]},{startsAt:"F",goesTo:"A",points:[s,w.B_Right,w.B_Opp,w.B_Left,G,n]},{startsAt:"E",goesTo:"B",points:[r,w.A_Right,w.A_Opp,w.A_Left,G,e]},{startsAt:"E",goesTo:"A",points:[r,w.B_Left,w.B_Opp,w.B_Right,B,n]}].map((U,H)=>({...U,index:H}))})(),M=N.filter(B=>B.startsAt==="E"),A=N.filter(B=>B.startsAt==="F"),R=[],j=[];for(let B of M)if(!y(B.points,T.path)){R.push(B);break}for(let B of A)if(!y(B.points,T.path)){j.push(B);break}return R.length===0||j.length===0?null:{line1:R[0],line2:j[0]}})();if(E){let N=E.line1.goesTo==="A"?e:n,M=E.line2.goesTo==="A"?e:n,A=k(E.line1,N,o,a),R=k(E.line2,M,o,a);E={line1:{...E.line1,points:A},line2:{...E.line2,points:R}}}return{jPair:E,optimalPath:{startsAt:T.startsAt,goesTo:T.goesTo,points:I}}}var tCt=class extends an{constructor(e){super();d(this,"nodeWithPortPoints");d(this,"routes");d(this,"viaDiameter");d(this,"traceThickness");d(this,"obstacleMargin");d(this,"layerCount",2);d(this,"debugViaPositions");d(this,"escapeLayer",1);d(this,"solvedRoutes",[]);d(this,"bounds");if(this.nodeWithPortPoints=e.nodeWithPortPoints,this.viaDiameter=e?.viaDiameter??.6,this.traceThickness=e?.traceThickness??.15,this.obstacleMargin=e?.obstacleMargin??.1,this.layerCount=e?.layerCount??2,this.debugViaPositions=[],this.routes=this.extractRoutesFromNode(),this.bounds=this.calculateBounds(),this.routes.length!==2)return void(this.failed=!0);let[t,i]=this.routes;if(t.startPort.z!==t.endPort.z)return void(this.failed=!0);if(i.startPort.z!==i.endPort.z)return void(this.failed=!0);t.startPort.z===i.startPort.z?t.startPort.z===0?this.escapeLayer=1:this.escapeLayer=0:this.failed=!0}extractRoutesFromNode(){let e=[],t=this.nodeWithPortPoints.portPoints,i=new Map;for(let r of t){let{connectionName:s}=r;i.has(s)||i.set(s,[]),i.get(s)?.push(r)}for(let[r,s]of i.entries())s.length===2&&e.push({startPort:{...s[0],z:s[0].z??0},endPort:{...s[1],z:s[1].z??0},connectionName:r});return e}calculateBounds(){return{minX:this.nodeWithPortPoints.center.x-this.nodeWithPortPoints.width/2,maxX:this.nodeWithPortPoints.center.x+this.nodeWithPortPoints.width/2,minY:this.nodeWithPortPoints.center.y-this.nodeWithPortPoints.height/2,maxY:this.nodeWithPortPoints.center.y+this.nodeWithPortPoints.height/2}}doRoutesCross(e,t){return $i(e.startPort,e.endPort,t.startPort,t.endPort)}calculateViaPositions(e,t){let i=this.bounds.maxX-this.bounds.minX,r=this.bounds.maxY-this.bounds.minY,s=this.bounds.minX,o=this.bounds.minY,a={width:i-2*this.obstacleMargin-this.viaDiameter,height:r-2*this.obstacleMargin-this.viaDiameter,x:s+this.obstacleMargin+this.viaDiameter/2,y:o+this.obstacleMargin+this.viaDiameter/2},c=this.viaDiameter+this.obstacleMargin,l=t.startPort,u=t.endPort,p=[{x:a.x,y:a.y},{x:a.x+a.width,y:a.y},{x:a.x+a.width,y:a.y+a.height},{x:a.x,y:a.y+a.height}],f=(T,I)=>Qt(T,I),y=[];p.forEach((T,I)=>{f(T,l)>=c&&f(T,u)>=c&&y.push({...T,type:"corner",index:I})});let g=[{p1:p[0],p2:p[1]},{p1:p[1],p2:p[2]},{p1:p[2],p2:p[3]},{p1:p[3],p2:p[0]}];if([l,u].forEach((T,I)=>{g.forEach((E,N)=>{((M,A)=>{let R=M.x,j=M.y,B=M.r,G=A.p1.x,U=A.p1.y,H=A.p2.x,tt=A.p2.y;if(Math.abs(H-G)<.001){let X=G,W=B*B-(X-R)**2;if(W<0)return[];if(Math.abs(W)<.001){let Z=j;return Z>=Math.min(U,tt)&&Z<=Math.max(U,tt)?[{x:X,y:Z}]:[]}let rt=j+Math.sqrt(W),pt=j-Math.sqrt(W),yt=[];return rt>=Math.min(U,tt)&&rt<=Math.max(U,tt)&&yt.push({x:X,y:rt}),pt>=Math.min(U,tt)&&pt<=Math.max(U,tt)&&yt.push({x:X,y:pt}),yt}let et=(tt-U)/(H-G),mt=U-et*G,V=1+et*et,J=2*(et*mt-et*j-R),nt=J*J-4*V*(R*R+(mt-j)*(mt-j)-B*B);if(nt<0)return[];if(Math.abs(nt)<.001){let X=-J/(2*V),W=et*X+mt;return X>=Math.min(G,H)&&X<=Math.max(G,H)&&W>=Math.min(U,tt)&&W<=Math.max(U,tt)?[{x:X,y:W}]:[]}let ut=(-J+Math.sqrt(nt))/(2*V),ht=(-J-Math.sqrt(nt))/(2*V),kt=et*ut+mt,Mt=et*ht+mt,ot=[];return ut>=Math.min(G,H)&&ut<=Math.max(G,H)&&kt>=Math.min(U,tt)&&kt<=Math.max(U,tt)&&ot.push({x:ut,y:kt}),ht>=Math.min(G,H)&&ht<=Math.max(G,H)&&Mt>=Math.min(U,tt)&&Mt<=Math.max(U,tt)&&ot.push({x:ht,y:Mt}),ot})({...T,r:c},E).forEach(M=>{f(M,I===0?u:l)>=c&&y.push({...M,type:"intersection",circle:I,edge:N})})})}),y.length<2){let T=.8*c;if(p.forEach((I,E)=>{f(I,l)>=T&&f(I,u)>=T&&!y.some(N=>N.x===I.x&&N.y===I.y)&&y.push({...I,type:"relaxed_corner",index:E})}),y.length<2){let I=[...p].sort((E,N)=>{let M=Math.min(f(E,l),f(E,u));return Math.min(f(N,l),f(N,u))-M});for(let E of I)if(!y.some(N=>N.x===E.x&&N.y===E.y)&&(y.push({...E,type:"forced_corner"}),y.length>=2))break}}if(y.length<2)return null;let x=0,v=[y[0],y[y.length>1?1:0]];for(let T=0;T<y.length;T++)for(let I=T+1;I<y.length;I++){let E=f(y[T],y[I]);E>x&&(x=E,v=[y[T],y[I]])}let P={x:v[0].x,y:v[0].y},w={x:v[1].x,y:v[1].y},k=Qt(P,e.startPort);return Qt(w,e.startPort)<k&&([P,w]=[w,P]),{via1:P,via2:w}}trySolveAOverB(e,t,i=!1){let r=i?this.calculateViaPositions(e,t):this.calculateViaPositions(t,e);if(!r)return!1;this.debugViaPositions.push(r);let{via1:s,via2:o}=this.pushViasFromEndpoints(this.moveViasAsCloseAsPossible(r));this.debugViaPositions.push({via1:s,via2:o});let{jPair:a,optimalPath:c}=QMt({A:s,B:o,C:e.startPort,D:e.endPort,E:t.startPort,F:t.endPort,radius:this.viaDiameter/2+this.obstacleMargin+this.traceThickness/2*1.5,margin:2*this.obstacleMargin+this.traceThickness/2*1.5,subdivisions:1});if(!a)return!1;let l={connectionName:e.connectionName,route:c.points.map(p=>({x:p.x,y:p.y,z:e.startPort.z??0})),traceThickness:this.traceThickness,viaDiameter:this.viaDiameter,vias:[]};a.line2.points.reverse();let u={connectionName:t.connectionName,route:[...a.line1.points.map(p=>({x:p.x,y:p.y,z:t.startPort.z??0})),{...a.line1.points[a.line1.points.length-1],z:this.escapeLayer},{...a.line2.points[0],z:this.escapeLayer},...a.line2.points.map(p=>({x:p.x,y:p.y,z:t.startPort.z??0}))],traceThickness:this.traceThickness,viaDiameter:this.viaDiameter,vias:[s,o]};return this.solvedRoutes.push(l,u),!0}pushViasFromEndpoints(e){let t={...e.via1},i={...e.via2},r=[this.routes[0].startPort,this.routes[0].endPort,this.routes[1].startPort,this.routes[1].endPort],s=this.getMinDistanceBetweenViaCenters(),o=this.viaDiameter/2+2*this.traceThickness+2*this.obstacleMargin;for(let c=0;c<10;c++){let l=!1,u=!1,p=.9**c;for(let y of r){let g=Qt(t,y);if(g<o){let v=(o-g)*p,P=t.x-y.x,w=t.y-y.y,k=Math.sqrt(P*P+w*w);k>1e-6&&(t.x+=P/k*v,t.y+=w/k*v,l=!0)}let x=Qt(i,y);if(x<o){let v=(o-x)*p,P=i.x-y.x,w=i.y-y.y,k=Math.sqrt(P*P+w*w);k>1e-6&&(i.x+=P/k*v,i.y+=w/k*v,u=!0)}}let f=Qt(t,i);if(f<s){let y=(s-f)/2,g=i.x-t.x,x=i.y-t.y,v=Math.sqrt(g*g+x*x);v>1e-6?(t.x-=g/v*y,t.y-=x/v*y,i.x+=g/v*y,i.y+=x/v*y,l=!0,u=!0):(t.x-=y,i.x+=y,l=!0,u=!0)}if(!l&&!u)break}let a=Qt(t,i);if(a<s){let c=(s-a)/2,l=i.x-t.x,u=i.y-t.y,p=Math.sqrt(l*l+u*u);p>1e-6?(t.x-=l/p*c,t.y-=u/p*c,i.x+=l/p*c,i.y+=u/p*c):(t.x-=c,i.x+=c)}return{via1:t,via2:i}}getMinDistanceBetweenViaCenters(){return this.viaDiameter+this.traceThickness+2*this.obstacleMargin}moveViasAsCloseAsPossible(e){let{via1:t,via2:i}=e,r=this.getMinDistanceBetweenViaCenters(),s=Qt(t,i);if(s<=r)return e;let o=i.x-t.x,a=i.y-t.y,c=Math.sqrt(o*o+a*a),l=o/c,u=a/c,p=(t.x,i.x,t.y,i.y,(s-r)/2);return{via1:{x:t.x+l*p,y:t.y+u*p},via2:{x:i.x-l*p,y:i.y-u*p}}}handleRoutesDontCross(){let[e,t]=this.routes,i={connectionName:e.connectionName,route:[{x:e.startPort.x,y:e.startPort.y,z:e.startPort.z??0},{x:e.endPort.x,y:e.endPort.y,z:e.endPort.z??0}],traceThickness:this.traceThickness,viaDiameter:this.viaDiameter,vias:[]},r={connectionName:t.connectionName,route:[{x:t.startPort.x,y:t.startPort.y,z:t.startPort.z??0},{x:t.endPort.x,y:t.endPort.y,z:t.endPort.z??0}],traceThickness:this.traceThickness,viaDiameter:this.viaDiameter,vias:[]};this.solvedRoutes.push(i,r),this.solved=!0}_step(){if(this.routes.length!==2)return void(this.failed=!0);let[e,t]=this.routes;this.doRoutesCross(e,t)?this.trySolveAOverB(e,t)||this.trySolveAOverB(t,e)||this.trySolveAOverB(e,t,!0)||this.trySolveAOverB(t,e,!0)?this.solved=!0:this.failed=!0:this.handleRoutesDontCross()}visualize(){let e={lines:[],points:[],rects:[],circles:[]};e.rects.push({center:{x:(this.bounds.minX+this.bounds.maxX)/2,y:(this.bounds.minY+this.bounds.maxY)/2},width:this.bounds.maxX-this.bounds.minX,height:this.bounds.maxY-this.bounds.minY,stroke:"rgba(0, 0, 0, 0.5)",fill:"rgba(240, 240, 240, 0.1)"});for(let[t,i]of[["Route A",this.routes[0]],["Route B",this.routes[1]]])e.points.push({x:i.startPort.x,y:i.startPort.y,label:`${t}
${i.connectionName} start`,color:"orange"}),e.points.push({x:i.endPort.x,y:i.endPort.y,label:`${t}
${i.connectionName} end`,color:"orange"}),e.lines.push({points:[i.startPort,i.endPort],strokeColor:"rgba(255, 0, 0, 0.5)",label:`${t}
${i.connectionName} direct`});for(let t=0;t<this.debugViaPositions.length;t++){let{via1:i,via2:r}=this.debugViaPositions[t],s=["rgba(255, 165, 0, 0.3)","rgba(128, 0, 128, 0.3)"],o=s[t%s.length];e.circles.push({center:i,radius:this.viaDiameter/2,fill:o,stroke:"rgba(0, 0, 0, 0.3)",label:`Computed Via A (attempt ${t+1})`}),e.circles.push({center:r,radius:this.viaDiameter/2,fill:o,stroke:"rgba(0, 0, 0, 0.3)",label:`Computed Via B (attempt ${t+1})`});let a=this.viaDiameter/2+this.obstacleMargin;e.circles.push({center:i,radius:a,stroke:o,fill:"rgba(0, 0, 0, 0)",label:`Debug Via 1 Safety Margin (attempt ${t+1})`}),e.circles.push({center:r,radius:a,stroke:o,fill:"rgba(0, 0, 0, 0)",label:`Debug Via 2 Safety Margin (attempt ${t+1})`}),e.lines.push({points:[this.routes[t%2].startPort,i,r,this.routes[t%2].endPort],strokeColor:`${o.substring(0,o.lastIndexOf(","))}, 0.3)`,strokeDash:[5,5],label:`Potential Route (attempt ${t+1})`})}for(let t=0;t<this.solvedRoutes.length;t++){let i=this.solvedRoutes[t],r=t%2==0?"rgba(0, 255, 0, 0.75)":"rgba(255, 0, 255, 0.75)";for(let s=0;s<i.route.length-1;s++){let o=i.route[s],a=i.route[s+1];e.lines.push({points:[o,a],strokeColor:r,strokeDash:o.z===1?[.2,.2]:void 0,strokeWidth:i.traceThickness,label:`${i.connectionName} z=${o.z}`}),o._label&&e.points.push({x:o.x,y:o.y,label:o._label})}for(let s of i.vias)e.circles.push({center:s,radius:this.viaDiameter/2,fill:"rgba(0, 0, 255, 0.8)",stroke:"black",label:"Solved Via"}),e.circles.push({center:s,radius:this.viaDiameter/2+this.obstacleMargin,fill:"rgba(0, 0, 255, 0.3)",stroke:"black",label:"Solved Via Margin"})}return e}getSolvedRoutes(){return this.solvedRoutes}};function eCt(n,e,t,i,r){let s={x:(n.x+e.x+t.x)/3,y:(n.y+e.y+t.y)/3},o=(w,k)=>Math.sqrt((k.x-w.x)**2+(k.y-w.y)**2),a=w=>{let k=o(w,n),T=o(w,e),I=o(w,t),E=w.x>=r.minX&&w.x<=r.maxX&&w.y>=r.minY&&w.y<=r.maxY;return k>=i&&T>=i&&I>=i&&E};if(a(s))return s;let c=(w,k,T)=>{let I=w.x-k.x,E=w.y-k.y,N=Math.sqrt(I*I+E*E);return N<1e-10?{x:k.x+T,y:k.y}:{x:k.x+I/N*T,y:k.y+E/N*T}},l=(w,k,T)=>{let I=k.x-w.x,E=k.y-w.y,N=Math.sqrt(I*I+E*E);if(N>2*T-1e-10||N<1e-10)return[];let M=N*N/(2*N),A=Math.sqrt(Math.max(0,T*T-M*M)),R=w.x+I*M/N,j=w.y+E*M/N,B={x:R+A*E/N,y:j-A*I/N},G={x:R-A*E/N,y:j+A*I/N},U=[],H=1e-6;return Math.abs(o(B,w)-T)<H&&Math.abs(o(B,k)-T)<H&&U.push(B),Math.abs(o(G,w)-T)<H&&Math.abs(o(G,k)-T)<H&&U.push(G),U},u=[c(s,n,i),c(s,e,i),c(s,t,i),...l(n,e,i),...l(e,t,i),...l(t,n,i)],p=u.filter(a);if(p.length>0){let w=p.filter(k=>!(T=>Math.abs(T.x-r.minX)<1e-6||Math.abs(T.x-r.maxX)<1e-6||Math.abs(T.y-r.minY)<1e-6||Math.abs(T.y-r.maxY)<1e-6)(k));if(w.length>0)return w.sort((k,T)=>o(k,s)-o(T,s)),w[0]}let f=null,y=1/0;for(let w=r.minX+1;w<r.maxX;w+=5)for(let k=r.minY+1;k<r.maxY;k+=5){let T={x:w,y:k};if(a(T)){let I=o(T,s);I<y&&(y=I,f=T)}}if(f!==null)return f;let g=[];for(let w=0;w<=100;w++){let k=w/100;g.push({x:r.minX+k*(r.maxX-r.minX),y:r.minY}),g.push({x:r.maxX,y:r.minY+k*(r.maxY-r.minY)}),g.push({x:r.maxX-k*(r.maxX-r.minX),y:r.maxY}),g.push({x:r.minX,y:r.maxY-k*(r.maxY-r.minY)})}let x=g.filter(a);if(x.length>0)return x.sort((w,k)=>o(w,s)-o(k,s)),x[0];let v=1/0,P={x:r.minX,y:r.minY};for(let w of[...u,...g])if(w.x>=r.minX&&w.x<=r.maxX&&w.y>=r.minY&&w.y<=r.maxY){let k=Math.max(0,i-o(w,n))+Math.max(0,i-o(w,e))+Math.max(0,i-o(w,t));k<v&&(v=k,P=w)}return P}function ad(n,e,t){let i=Iq(e,n,t.center,t.radius),r=Iq(n,e,t.center,t.radius),s=qc(i,e),o=qc(n,r),a=1e-6,c;if(s>a&&o>a){c={x:(i.x+r.x)/2,y:(i.y+r.y)/2};let l=qc(i,c),u=qc(r,c);if(Math.abs(l-u)>.5*Math.min(l,u)){let f=qc(n,i),y=qc(e,r),g=f+y;if(g>a){let x=y/g,v=f/g;c={x:i.x*x+r.x*v,y:i.y*x+r.y*v}}}let p=qc(c,t.center);if(p<1.05*t.radius){let f={x:(c.x-t.center.x)/p,y:(c.y-t.center.y)/p};c={x:t.center.x+f.x*t.radius*1.2,y:t.center.y+f.y*t.radius*1.2}}}else{let l={x:(n.x+e.x)/2,y:(n.y+e.y)/2},u=qc(l,t.center);if(u<1.1*t.radius){let p={x:(l.x-t.center.x)/u,y:(l.y-t.center.y)/u};c={x:t.center.x+p.x*t.radius*1.2,y:t.center.y+p.y*t.radius*1.2}}else c=l}return{B:i,D:r,E:c}}function Iq(n,e,t,i){let r=[t.x-n.x,t.y-n.y],s=Math.sqrt(r[0]*r[0]+r[1]*r[1]);if(s<=i){if(s<1e-8){let v=[e.x-n.x,e.y-n.y],P=Math.sqrt(v[0]*v[0]+v[1]*v[1]);return P<1e-8?{x:t.x+i,y:t.y}:{x:t.x+v[0]/P*i,y:t.y+v[1]/P*i}}let x=[r[0]/s,r[1]/s];return{x:t.x-x[0]*i,y:t.y-x[1]*i}}let o=[e.x-n.x,e.y-n.y],a=Math.sqrt(s*s-i*i),c=[r[0]/s,r[1]/s],l=[-c[1],c[0]],u=[c[1],-c[0]],p=o[0]*l[0]+o[1]*l[1]>o[0]*u[0]+o[1]*u[1]?l:u,f=i/s,y=a/s,g=[c[0]*y+p[0]*f,c[1]*y+p[1]*f];return{x:n.x+a*g[0],y:n.y+a*g[1]}}function qc(n,e){let t=e.x-n.x,i=e.y-n.y;return Math.sqrt(t*t+i*i)}var Pn=1e-9;function Nq(n,e,t,i="cw"){let r=jg(n,t),s=jg(e,t);return Math.abs(s-r)<Pn?{left:0,top:0,right:0,bottom:0}:(function(o,a,c,l){let u=c.maxX-c.minX,p=c.maxY-c.minY;if(u<Pn&&p<Pn)return{left:0,top:0,right:0,bottom:0};let f=2*(u+p);if(f<Pn)return{left:0,top:0,right:0,bottom:0};let y=u/f*(2*Math.PI),g=(u+p)/f*(2*Math.PI),x=(u+u+p)/f*(2*Math.PI),v=2*Math.PI,P=[{name:"top",start:0,end:y,length:u},{name:"right",start:y,end:g,length:p},{name:"bottom",start:g,end:x,length:u},{name:"left",start:x,end:v,length:p}],w={left:0,top:0,right:0,bottom:0},k=(T,I,E,N,M)=>{let A=I>2*Math.PI-Pn?2*Math.PI:I;if(A<=T+Pn)return 0;if(M){let R=Math.max(T,E),j=Math.min(A,2*Math.PI),B=Math.max(0,j-R),G=Math.max(T,0),U=Math.min(A,N);return B+Math.max(0,U-G)}{let R=Math.max(T,E),j=Math.min(A,N);return Math.max(0,j-R)}};for(let T of P){let I=T.end-T.start;if(I<Pn||T.length<Pn)continue;let E=0;if(l==="cw"){let N=o>a+Pn;E=k(T.start,T.end,o,a,N)}else{let N=a>o+Pn;E=k(T.start,T.end,a,o,N)}if(E>Pn){let N=E/I;w[T.name]+=Math.max(0,Number.isFinite(N)?N:0)}}for(let T in w)w[T]=Math.max(0,Math.min(1,w[T]));return w})(r,s,t,i)}function jg(n,e){let t=e.maxX-e.minX,i=e.maxY-e.minY;if(t<Pn&&i<Pn)return 0;let r=2*(t+i);if(r<Pn)return 0;let s=0;if(Math.abs(n.y-e.maxY)<Pn&&n.x>=e.minX-Pn&&n.x<=e.maxX+Pn)s=Math.max(0,Math.min(t,n.x-e.minX));else if(Math.abs(n.x-e.maxX)<Pn&&n.y>=e.minY-Pn&&n.y<=e.maxY+Pn)s=t+Math.max(0,Math.min(i,e.maxY-n.y));else if(Math.abs(n.y-e.minY)<Pn&&n.x>=e.minX-Pn&&n.x<=e.maxX+Pn)s=t+i+Math.max(0,Math.min(t,e.maxX-n.x));else{if(!(Math.abs(n.x-e.minX)<Pn&&n.y>=e.minY-Pn&&n.y<=e.maxY+Pn))throw new Error(`Point (${n.x}, ${n.y}) does not lie on the boundary defined by ${JSON.stringify(e)}`);s=t+i+t+Math.max(0,Math.min(i,n.y-e.minY))}return s=Math.max(0,Math.min(r,s)),r>Pn?s/r*(2*Math.PI):0}function nCt(n,e,t,i){return(function({angleA:r,angleB:s,angleC:o}){let a=Math.cos(r),c=Math.sin(r),l=Math.cos(s),u=Math.sin(s),p=Math.cos(o);return(l-a)*(Math.sin(o)-c)-(u-c)*(p-a)<0?"ccw":"cw"})({angleA:jg(n,i),angleB:jg(e,i),angleC:jg(t,i)})}var iCt=class extends an{constructor(e){super();d(this,"nodeWithPortPoints");d(this,"routes");d(this,"viaDiameter");d(this,"traceThickness");d(this,"obstacleMargin");d(this,"layerCount",2);d(this,"debugViaPositions");d(this,"solvedRoutes",[]);d(this,"bounds");if(this.nodeWithPortPoints=e.nodeWithPortPoints,this.viaDiameter=e?.viaDiameter??.6,this.traceThickness=e?.traceThickness??.15,this.obstacleMargin=e?.obstacleMargin??.1,this.layerCount=e?.layerCount??2,this.debugViaPositions=[],this.routes=this.extractRoutesFromNode(),this.bounds=this.calculateBounds(),this.routes.length!==2)return void(this.failed=!0);let[t,i]=this.routes,r=t.A.z!==t.B.z,s=i.A.z!==i.B.z;(r&&s||!r&&!s)&&(this.failed=!0)}extractRoutesFromNode(){let e=[],t=this.nodeWithPortPoints.portPoints,i=new Map;for(let r of t){let{connectionName:s}=r;i.has(s)||i.set(s,[]),i.get(s)?.push(r)}for(let[r,s]of i.entries())s.length===2&&e.push({A:{...s[0],z:s[0].z??0},B:{...s[1],z:s[1].z??0},connectionName:r});return e}calculateBounds(){return{minX:this.nodeWithPortPoints.center.x-this.nodeWithPortPoints.width/2,maxX:this.nodeWithPortPoints.center.x+this.nodeWithPortPoints.width/2,minY:this.nodeWithPortPoints.center.y-this.nodeWithPortPoints.height/2,maxY:this.nodeWithPortPoints.center.y+this.nodeWithPortPoints.height/2}}doRoutesCross(e,t){return $i(e.A,e.B,t.A,t.B)}calculateViaPosition(e,t){let i=t.A.z,r=e.A.z!==i?e.A:e.B,s=2*this.obstacleMargin+this.viaDiameter/2+this.traceThickness,o=this.obstacleMargin+this.viaDiameter/2,a=t.A,c=r,l=t.B,u=nCt(a,c,l,this.bounds),p=(function(y,g,x,v,P){let w=Nq(y,g,v,P),k=Nq(g,x,v,P),T={left:Math.min(1,w.left+k.left),top:Math.min(1,w.top+k.top),right:Math.min(1,w.right+k.right),bottom:Math.min(1,w.bottom+k.bottom)};for(let I in T)Math.abs(T[I])<Pn&&(T[I]=0);return T})(a,c,l,this.bounds,u),f={minX:this.bounds.minX+(p.left>.5?s:o),minY:this.bounds.minY+(p.bottom>.5?s:o),maxX:this.bounds.maxX-(p.right>.5?s:o),maxY:this.bounds.maxY-(p.top>.5?s:o)};return f.maxY<f.minY&&(f.minY=(f.minY+f.maxY)/2,f.maxY=f.minY),f.maxX<f.minX&&(f.minX=(f.minX+f.maxX)/2,f.maxX=f.minX),eCt(a,c,l,s,f)}createTransitionRoute(e,t,i,r){return{connectionName:r,route:[{x:e.x,y:e.y,z:e.z??0},{x:i.x,y:i.y,z:e.z??0},{x:i.x,y:i.y,z:t.z??0},{x:t.x,y:t.y,z:t.z??0}],traceThickness:this.traceThickness,viaDiameter:this.viaDiameter,vias:[i]}}createFlatRoute(e,t,i,r,s,o){r.z,e.z;let a=this.viaDiameter/2+this.traceThickness/2+this.obstacleMargin,c=((P,w,k,T)=>{let I=k.x-P.x,E=k.y-P.y;return((N,M)=>({x:(N.x+M.x)/2,y:(N.y+M.y)/2}))({x:P.x+I*w,y:P.y+E*w},{x:k.x-I*T,y:k.y-E*T})})(i,this.viaDiameter,r.z!==e.z?r:s,this.traceThickness),l={center:{x:i.x,y:i.y},radius:a},u=ad(e,c,l).E,p=ad(c,t,l).E,f=ad(e,u,l).E,y=ad(u,c,l).E,g=ad(c,p,l).E,x=ad(p,t,l).E,v=ad(y,g,l).E;return{connectionName:o,route:[{x:e.x,y:e.y,z:e.z??0},{x:f.x,y:f.y,z:e.z??0},{x:u.x,y:u.y,z:e.z??0},{x:y.x,y:y.y,z:e.z??0},{x:v.x,y:v.y,z:e.z??0},{x:g.x,y:g.y,z:e.z??0},{x:p.x,y:p.y,z:e.z??0},{x:x.x,y:x.y,z:e.z??0},{x:t.x,y:t.y,z:t.z??0}],traceThickness:this.traceThickness,viaDiameter:this.viaDiameter,vias:[]}}trySolve(){let[e,t]=this.routes,i=e.A.z!==e.B.z,r=i?e:t,s=i?t:e,o=this.calculateViaPosition(r,s);if(!o)return!1;this.debugViaPositions.push({via:o});let a=this.createTransitionRoute(r.A,r.B,o,r.connectionName),c=this.createFlatRoute(s.A,s.B,o,r.A,r.B,s.connectionName);return this.solvedRoutes.push(a,c),!0}_step(){if(!this.doRoutesCross(this.routes[0],this.routes[1]))return this.failed=!0,void(this.error="Can only solve routes that have a single transition crossing");this.trySolve()?this.solved=!0:this.failed=!0}visualize(){let e={lines:[],points:[],rects:[],circles:[]};e.rects.push({center:{x:(this.bounds.minX+this.bounds.maxX)/2,y:(this.bounds.minY+this.bounds.maxY)/2},width:this.bounds.maxX-this.bounds.minX,height:this.bounds.maxY-this.bounds.minY,stroke:"rgba(0, 0, 0, 0.5)",fill:"rgba(240, 240, 240, 0.1)",label:"PCB Bounds"});for(let t of this.routes)e.points.push({x:t.A.x,y:t.A.y,label:`${t.connectionName} start (z=${t.A.z})`,color:"orange"}),e.points.push({x:t.B.x,y:t.B.y,label:`${t.connectionName} end (z=${t.B.z})`,color:"orange"}),e.lines.push({points:[t.A,t.B],strokeColor:"rgba(255, 0, 0, 0.5)",label:`${t.connectionName} direct`});for(let t=0;t<this.debugViaPositions.length;t++){let{via:i}=this.debugViaPositions[t];e.circles.push({center:i,radius:this.viaDiameter/2,fill:"rgba(255, 165, 0, 0.7)",stroke:"rgba(0, 0, 0, 0.5)",label:`Computed Via (attempt ${t+1})`});let r=this.viaDiameter/2+this.obstacleMargin;e.circles.push({center:i,radius:r,stroke:"rgba(255, 165, 0, 0.7)",fill:"rgba(0, 0, 0, 0)",label:"Safety Margin"})}for(let t=0;t<this.solvedRoutes.length;t++){let i=this.solvedRoutes[t],r=t%2==0?"rgba(0, 255, 0, 0.75)":"rgba(255, 0, 255, 0.75)";for(let s=0;s<i.route.length-1;s++){let o=i.route[s],a=i.route[s+1];e.lines.push({points:[o,a],strokeColor:r,strokeDash:o.z!==i.route[0].z?[.2,.2]:void 0,strokeWidth:i.traceThickness,label:`${i.connectionName} z=${o.z}`})}for(let s of i.vias)e.circles.push({center:s,radius:this.viaDiameter/2,fill:"rgba(0, 0, 255, 0.8)",stroke:"black",label:"Solved Via"}),e.circles.push({center:s,radius:this.viaDiameter/2+this.obstacleMargin,fill:"rgba(0, 0, 255, 0.3)",stroke:"black",label:"Via Margin"})}return e}getSolvedRoutes(){return this.solvedRoutes}},lZ=(n,e)=>{let t={};return n.portPoints.forEach((i,r)=>{t[i.connectionName]=`hsl(${360*r/n.portPoints.length}, 100%, 50%)`}),t},rCt=class extends an{constructor({nodeWithPortPoints:e,colorMap:t,hyperParameters:i}){super();d(this,"bounds");d(this,"maxViaCount");d(this,"portPairMap");d(this,"colorMap");d(this,"nodeWidth");d(this,"availableZ");d(this,"hyperParameters");d(this,"VIA_INTERSECTION_BUFFER_DISTANCE",.05);d(this,"PLACEHOLDER_WALL_BUFFER_DISTANCE",.1);d(this,"NEW_HEAD_WALL_BUFFER_DISTANCE",.05);d(this,"unprocessedConnections");d(this,"completedPaths",new Map);d(this,"placeholderPaths",new Map);d(this,"currentHead");d(this,"currentConnectionName");d(this,"currentPath");d(this,"currentViaCount");this.MAX_ITERATIONS=1e5,this.colorMap=t??lZ(e),this.maxViaCount=5,this.bounds=z4(e),this.nodeWidth=this.bounds.maxX-this.bounds.minX,this.portPairMap=(s=>{let o=new Map;return s.portPoints.forEach(a=>{o.has(a.connectionName)?o.get(a.connectionName).end=a:o.set(a.connectionName,{start:a,end:null,connectionName:a.connectionName})}),o})(e),this.stats.solutionsFound=0,this.availableZ=e.availableZ??[0,1],this.hyperParameters=i??{SHUFFLE_SEED:0},this.unprocessedConnections=Array.from(this.portPairMap.keys()).sort(),i?.SHUFFLE_SEED&&(this.unprocessedConnections=Xg(this.unprocessedConnections,i.SHUFFLE_SEED));for(let[s,{start:o,end:a}]of this.portPairMap.entries())if(o.z===a.z){let c=Math.abs(o.x-a.x)<1e-9,l=Math.abs(o.y-a.y)<1e-9;c||l?this.placeholderPaths.set(s,[o,this._padByPlaceholderWallBuffer(o),this._padByPlaceholderWallBuffer(a),a]):this.placeholderPaths.set(s,[o,a])}else{let c=(o.x+a.x)/2,l=(o.y+a.y)/2,u=this._padByPlaceholderWallBuffer({x:c,y:l,z:o.z}),p=this._padByPlaceholderWallBuffer({x:c,y:l,z:a.z});this.placeholderPaths.set(s,[o,this._padByPlaceholderWallBuffer(o),u,p,this._padByPlaceholderWallBuffer(a),a])}this.currentConnectionName=this.unprocessedConnections.pop();let r=this.portPairMap.get(this.currentConnectionName).start;this.currentHead=this._padByNewHeadWallBuffer(r),this.currentPath=[r,this.currentHead],this.currentViaCount=0,this.placeholderPaths.delete(this.currentConnectionName)}_padByNewHeadWallBuffer(e){return{x:Zc(e.x,this.bounds.minX+this.NEW_HEAD_WALL_BUFFER_DISTANCE,this.bounds.maxX-this.NEW_HEAD_WALL_BUFFER_DISTANCE),y:Zc(e.y,this.bounds.minY+this.NEW_HEAD_WALL_BUFFER_DISTANCE,this.bounds.maxY-this.NEW_HEAD_WALL_BUFFER_DISTANCE),z:e.z}}_padByPlaceholderWallBuffer(e){return{x:Zc(e.x,this.bounds.minX+this.PLACEHOLDER_WALL_BUFFER_DISTANCE,this.bounds.maxX-this.PLACEHOLDER_WALL_BUFFER_DISTANCE),y:Zc(e.y,this.bounds.minY+this.PLACEHOLDER_WALL_BUFFER_DISTANCE,this.bounds.maxY-this.PLACEHOLDER_WALL_BUFFER_DISTANCE),z:e.z}}_step(){if(this.solved)return;let e=this.portPairMap.get(this.currentConnectionName).end,t=[this.currentHead,e],i=null,r=null,s=a=>{for(let c of a.values())for(let l=0;l<c.length-1;l++){let u=[c[l],c[l+1]];if(u[0].x===u[1].x&&u[0].y===u[1].y||u[0].z!==this.currentHead.z)continue;let p=Yq(t[0],t[1],u[0],u[1]);if(p){let f=Qt(this.currentHead,p);if(f<1e-6)continue;(!i||f<i.dist)&&(i={point:p,dist:f},r=u[0].z)}}};s(this.completedPaths),s(this.placeholderPaths);let o=this.currentHead.z!==e.z;if((i||o)&&(this.currentViaCount++,this.currentViaCount>=this.maxViaCount))this.failed=!0;else if(i){let a,c=i.dist;if(c<=this.VIA_INTERSECTION_BUFFER_DISTANCE+1e-6)a=_q(this.currentHead,i.point);else{let f=i.point,y=f.x-this.currentHead.x,g=f.y-this.currentHead.y,x=(c-this.VIA_INTERSECTION_BUFFER_DISTANCE)/c;a={x:this.currentHead.x+y*x,y:this.currentHead.y+g*x}}let l=this.availableZ.find(f=>f!==r);if(l===void 0)return console.error("Could not determine next Z level for via placement!"),void(this.failed=!0);let u={...a,z:this.currentHead.z},p={...a,z:l};this.currentPath.push(u,p),this.currentHead=p}else if(o){let a,c=Qt(this.currentHead,e);if(c<this.VIA_INTERSECTION_BUFFER_DISTANCE)a=_q(this.currentHead,e);else{let f=e.x-this.currentHead.x,y=e.y-this.currentHead.y,g=(c-this.VIA_INTERSECTION_BUFFER_DISTANCE)/c;a={x:this.currentHead.x+f*g,y:this.currentHead.y+y*g}}let l=e.z,u={...a,z:this.currentHead.z},p={...a,z:l};this.currentPath.push(u,p),this.currentHead=p}else if(this.currentPath.push(e),this.completedPaths.set(this.currentConnectionName,this.currentPath),this.unprocessedConnections.length===0)this.solved=!0,this.stats.solutionsFound=1;else{this.currentConnectionName=this.unprocessedConnections.pop();let{start:a}=this.portPairMap.get(this.currentConnectionName);this.currentHead=this._padByNewHeadWallBuffer(a),this.currentPath=[a,this.currentHead],this.currentViaCount=0,this.placeholderPaths.delete(this.currentConnectionName)}}visualize(){let e={points:[],lines:[],circles:[],rects:[],title:"Via Possibilities Solver State",coordinateSystem:"cartesian"},t=this.colorMap;e.lines.push({points:[{x:this.bounds.minX,y:this.bounds.minY},{x:this.bounds.maxX,y:this.bounds.minY},{x:this.bounds.maxX,y:this.bounds.maxY},{x:this.bounds.minX,y:this.bounds.maxY},{x:this.bounds.minX,y:this.bounds.minY}],strokeColor:"gray",strokeWidth:.01});for(let[r,{start:s,end:o}]of this.portPairMap.entries()){let a=this.colorMap[r]??"black";e.points.push({x:s.x,y:s.y,color:a,label:`Port: ${r} Start (z${s.z})`}),e.points.push({x:o.x,y:o.y,color:a,label:`Port: ${r} End (z${o.z})`})}let i=(r,s)=>{for(let[o,a]of r.entries()){let c=t[o]??"black";for(let l=0;l<a.length-1;l++){let u=a[l],p=a[l+1];u.x===p.x&&u.y===p.y&&u.z!==p.z?e.circles.push({center:{x:u.x,y:u.y},radius:.3,fill:Qn(c,.5),label:`${s}: ${o} Via (z${u.z}->z${p.z})`}):e.lines.push({points:[u,p],strokeColor:Qn(c,.5),strokeDash:u.z===0?void 0:[.1,.1],strokeWidth:.1,label:`${s}: ${o} (z${u.z})`})}}};if(i(this.placeholderPaths,"Placeholder"),i(this.completedPaths,"Completed"),this.currentPath&&this.currentPath.length>0){let r=t[this.currentConnectionName]??"orange";for(let s=0;s<this.currentPath.length-1;s++){let o=this.currentPath[s],a=this.currentPath[s+1];o.x===a.x&&o.y===a.y&&o.z!==a.z?e.circles.push({center:{x:o.x,y:o.y},radius:.3,fill:Qn(r,.5),label:`Current: ${this.currentConnectionName} Via (z${o.z}->z${a.z})`}):e.lines.push({points:[o,a],strokeColor:Qn(r,.5),strokeWidth:.15,strokeDash:"2,2",label:`Current: ${this.currentConnectionName} (z${o.z})`})}e.points.push({x:this.currentHead.x,y:this.currentHead.y,color:"green",label:`Current Head: ${this.currentConnectionName} (z${this.currentHead.z})`})}return e}},ld=1e-9;function GS(n,e,t=ld){return Math.abs(n-e)<t}function E4(n,e,t,i){return n*i-e*t}function sCt(n,e,t,i){let r={x:e.x-n.x,y:e.y-n.y},s={x:i.x-t.x,y:i.y-t.y},o=E4(r.x,r.y,s.x,s.y);if(GS(o,0))return null;let a={x:t.x-n.x,y:t.y-n.y},c=E4(a.x,a.y,s.x,s.y)/o,l=E4(a.x,a.y,r.x,r.y)/o;return c<-ld||c>1+ld||l<-ld||l>1+ld?null:{x:n.x+c*r.x,y:n.y+c*r.y}}function oCt(n){let e=0;for(let t=0,i=n.length;t<i;++t){let r=(t+1)%i;e+=n[t].x*n[r].y-n[r].x*n[t].y}return .5*e}function aCt(n){let e=0,t=0,i=0;for(let r=0,s=n.length;r<s;++r){let o=(r+1)%s,a=n[r].x*n[o].y-n[o].x*n[r].y;e+=a,t+=(n[r].x+n[o].x)*a,i+=(n[r].y+n[o].y)*a}return e*=.5,GS(e,0)?null:(t/=6*e,i/=6*e,{x:t,y:i})}var cCt=class{constructor(n,e){d(this,"x");d(this,"y");d(this,"out");d(this,"connectionNames");this.x=n,this.y=e,this.out=[],this.connectionNames=new Set}},Aq=class{constructor(n,e){d(this,"orig");d(this,"dest");d(this,"twin");d(this,"next");d(this,"visited");this.orig=n,this.dest=e,this.twin=null,this.next=null,this.visited=!1}};function lCt(n,e){let t=[...e,{start:{x:n.minX,y:n.minY},end:{x:n.maxX,y:n.minY}},{start:{x:n.maxX,y:n.minY},end:{x:n.maxX,y:n.maxY}},{start:{x:n.maxX,y:n.maxY},end:{x:n.minX,y:n.maxY}},{start:{x:n.minX,y:n.maxY},end:{x:n.minX,y:n.minY}}],i=t.map(()=>[]);for(let p=0;p<t.length;++p){let f=t[p];i[p].push(f.start,f.end)}for(let p=0;p<t.length;++p)for(let f=p+1;f<t.length;++f){let y=sCt(t[p].start,t[p].end,t[f].start,t[f].end);y&&(i[p].push(y),i[f].push(y))}let r=new Map,s=[];function o(p){let f=(function(y,g=ld){return`${Math.round(y.x/g)}:${Math.round(y.y/g)}`})(p);if(!r.has(f)){let y=s.length;return r.set(f,y),s.push(new cCt(p.x,p.y)),y}return r.get(f)}let a=[];for(let p=0;p<t.length;++p){let f=t[p],y=i[p].slice();y.sort((g,x)=>{let v=f.end.x-f.start.x,P=f.end.y-f.start.y;return(GS(Math.abs(v),0)?(g.y-f.start.y)/P:(g.x-f.start.x)/v)-(GS(Math.abs(v),0)?(x.y-f.start.y)/P:(x.x-f.start.x)/v)});for(let g=0;g<y.length-1;++g){let x=y[g],v=y[g+1],P=o(x),w=o(v);P!==w&&(a.push([P,w]),f.connectionName&&(s[P].connectionNames.add(f.connectionName),s[w].connectionNames.add(f.connectionName)))}}let c=[];for(let[p,f]of a){let y=new Aq(p,f),g=new Aq(f,p);y.twin=c.length+1,g.twin=c.length;let x=c.length;c.push(y,g),s[p].out.push(x),s[f].out.push(x+1)}for(let p=0;p<s.length;++p){let f=s[p];f.out.sort((g,x)=>{let v=c[g],P=c[x],w=s[v.dest],k=s[P.dest];return Math.atan2(w.y-f.y,w.x-f.x)-Math.atan2(k.y-f.y,k.x-f.x)});let y=f.out.length;for(let g=0;g<y;++g){let x=f.out[g],v=f.out[(g-1+y)%y],P=c[x];P.twin!==null&&(c[P.twin].next=v)}}let l=[],u=[];for(let p=0;p<c.length;++p){if(c[p].visited)continue;let f=p,y=[],g=[];do{if(f===null)break;let x=c[f];x.visited=!0,y.push(s[x.orig]),g.push(f),f=x.next}while(f!==null&&f!==p&&!c[f].visited);if(!(y.length<3)&&oCt(y)>ld){let x=aCt(y);x&&(l.push(x),u.push({vertices:y.map(v=>({x:v.x,y:v.y,connectionNames:v.connectionNames.size>0?v.connectionNames:void 0})),centroid:x}))}}return{centroids:l,faces:u,allVertices:s}}function uCt(n,e){if(n>e)throw new Error("oneCount cannot be greater than length");if(n<0||e<0)throw new Error("oneCount and length must be non-negative");let t=[];return(function i(r,s,o){o!==e?(r[o]=0,i(r,s,o+1),s>0&&(r[o]=1,i(r,s-1,o+1))):s===0&&t.push([...r])})(Array(e).fill(0),n,0),t}var uZ=n=>{if(n.length===0)return[[]];let e=[];for(let t=0;t<n.length;t++){let i=n[t],r=[...n.slice(0,t),...n.slice(t+1)],s=uZ(r);for(let o of s)e.push([i,...o])}return e},pCt=n=>{let{start:e,end:t,segmentsPerPolyline:i,viaPositions:r,viaCount:s,availableZ:o}=n,a=(function(y,g){let x=new Array(y).fill(0);if(g===0)return x;if(g===y)return x.fill(1);if(g<=y/2){let v=Math.floor(y/g),P=Math.floor((y-(v*(g-1)+1))/2);for(let w=0;w<g;w++)x[P+w*v]=1}else{let v=y-g,P=Math.floor(y/v),w=Math.floor((y-(P*(v-1)+1))/2);x.fill(1);for(let k=0;k<v;k++)x[w+k*P]=0}return x})(i,s),c=a.map(()=>null),l=0,u=e.z1,p=o.indexOf(e.z1);for(let y=0;y<a.length;y++)if(a[y]===1){let g=o[(p+l+1)%o.length];c[y]={...r[l],z1:u,z2:g},u=g,l++}let f=e;for(let y=0;y<c.length;y++){if(c[y]){f=c[y];continue}let g=t,x=c.length;for(let k=y+1;k<c.length;k++)if(c[k]){g=c[k],x=k;break}let v=x-y,P=g.x-f.x,w=g.y-f.y;for(let k=1/(v+1),T=0;y+T!==x;k+=1/(v+1),T++)c[y+T]={x:f.x+P*k,y:f.y+w*k,z1:f.z2,z2:f.z2}}return c},f_=1e-9;function HS(n,e){return Math.abs(n-e)<f_}function M4(n){return`${Math.round(n.x/f_)}:${Math.round(n.y/f_)}`}function C4(n,e,t,i){return n*i-e*t}function hCt(n,e,t,i){let r={x:e.x-n.x,y:e.y-n.y},s={x:i.x-t.x,y:i.y-t.y},o=C4(r.x,r.y,s.x,s.y),a={x:t.x-n.x,y:t.y-n.y};if(HS(o,0))return null;let c=C4(a.x,a.y,s.x,s.y)/o,l=C4(a.x,a.y,r.x,r.y)/o;return c>=-1e-9&&c<=1+f_&&l>=-1e-9&&l<=1+f_?{x:n.x+c*r.x,y:n.y+c*r.y}:null}function Rq(n,e,t){return HS(Math.hypot(n.x-e.x,n.y-e.y)+Math.hypot(n.x-t.x,n.y-t.y),Math.hypot(e.x-t.x,e.y-t.y))}function dCt(n,e){let t=[],i=new Map;for(let x of n){let v=[x.start,...x.mPoints,x.end];for(let w=0;w<v.length-1;w++){let k=v[w],T=v[w+1],I=k.z2;if(t.push({start:{x:k.x,y:k.y},end:{x:T.x,y:T.y},connectionName:x.connectionName,layer:I}),k.z1!==k.z2){let E=M4(k);i.has(E)||i.set(E,{point:k,connectionName:x.connectionName})}}let P=v[v.length-1];if(P.z1!==P.z2){let w=M4(P);i.has(w)||i.set(w,{point:P,connectionName:x.connectionName})}}let r=[{start:{x:e.minX,y:e.minY},end:{x:e.maxX,y:e.minY},connectionName:null,layer:0},{start:{x:e.maxX,y:e.minY},end:{x:e.maxX,y:e.maxY},connectionName:null,layer:0},{start:{x:e.maxX,y:e.maxY},end:{x:e.minX,y:e.maxY},connectionName:null,layer:0},{start:{x:e.minX,y:e.maxY},end:{x:e.minX,y:e.minY},connectionName:null,layer:0}];t.push(...r);let s=new Map,o=0;function a(x,v){let P=M4(x),w=s.get(P);if(!w){let k=i.has(P);w={id:o++,x:x.x,y:x.y,isVia:k,connectionNames:new Set,outgoingEdges:[]},s.set(P,w),k&&i.get(P)&&w.connectionNames.add(i.get(P).connectionName)}return v&&w.connectionNames.add(v),w}for(let x of t)a(x.start,x.connectionName),a(x.end,x.connectionName);let c=new Map;for(let x of t)c.set(x,[]);for(let x=0;x<t.length;x++)for(let v=x+1;v<t.length;v++){if(t[x].layer!==t[v].layer)continue;let P=hCt(t[x].start,t[x].end,t[v].start,t[v].end);P&&(a(P),Rq(P,t[x].start,t[x].end)&&c.get(t[x]).push(P),Rq(P,t[v].start,t[v].end)&&c.get(t[v]).push(P))}let l=[],u=0;for(let x of t){let v=[x.start,...c.get(x),x.end];v.sort((w,k)=>{let T=x.end.x-x.start.x,I=x.end.y-x.start.y;return Math.abs(T)>Math.abs(I)?(w.x-x.start.x)/T-(k.x-x.start.x)/T:Math.abs(I)<f_?0:(w.y-x.start.y)/I-(k.y-x.start.y)/I});let P=[];if(v.length>0){P.push(v[0]);for(let w=1;w<v.length;w++)HS(v[w].x,v[w-1].x)&&HS(v[w].y,v[w-1].y)||P.push(v[w])}for(let w=0;w<P.length-1;w++){let k=P[w],T=P[w+1],I=a(k,x.connectionName),E=a(T,x.connectionName);if(I===E)continue;let N={id:u++,origin:I,twin:null,next:null,face:null,connectionName:x.connectionName,layer:x.layer,visited:!1},M={id:u++,origin:E,twin:N,next:null,face:null,connectionName:x.connectionName,layer:x.layer,visited:!1};N.twin=M,l.push(N,M),I.outgoingEdges.push(N),E.outgoingEdges.push(M)}}for(let x of s.values()){x.outgoingEdges.sort((P,w)=>{let k=P.twin.origin,T=w.twin.origin;return Math.atan2(k.y-x.y,k.x-x.x)-Math.atan2(T.y-x.y,T.x-x.x)});let v=x.outgoingEdges.length;for(let P=0;P<v;P++){let w=x.outgoingEdges[P],k=x.outgoingEdges[(P-1+v)%v];w.twin&&(w.twin.next=k)}}let p=[],f=0,y=null,g=-1/0;for(let x of l){if(x.visited)continue;let v={id:f++,outerComponent:x,innerComponents:[],isOuterFace:!1};p.push(v);let P=x,w=[],k=[],T=new Set,I=0;do{if(!P||P.visited){console.warn("Face traversal encountered visited edge or null, breaking loop.",v.id),w.length=0;break}P.visited=!0,P.face=v,w.push(P),k.push(P.origin),P.connectionName!==null&&T.add(P.connectionName);let E=P.origin,N=P.twin.origin;I+=E.x*N.y-N.x*E.y,P=P.next}while(P!==x&&P!==null);if(P===x){if(I=.5*Math.abs(I),I>g&&(g=I,y&&(y.isOuterFace=!1),y=v,v.isOuterFace=!0),!v.isOuterFace&&w.length>0&&[...T].filter(E=>E!==null).length>1){let E=!1;for(let N of k)if(N.isVia){E=!0;break}if(!E)return!0}}else console.warn(`Face ${v.id} did not close properly.`),p.pop(),f--}return!1}var fCt=class extends an{constructor(e){super();d(this,"nodeWithPortPoints");d(this,"colorMap");d(this,"hyperParameters");d(this,"connMap");d(this,"candidates");d(this,"bounds");d(this,"solvedRoutes",[]);d(this,"unsolvedConnections",[]);d(this,"SEGMENTS_PER_POLYLINE");d(this,"cellSize");d(this,"MAX_CANDIDATES",5e4);d(this,"viaDiameter",.6);d(this,"obstacleMargin",.1);d(this,"traceWidth",.15);d(this,"availableZ",[]);d(this,"uniqueConnections",0);d(this,"BOUNDARY_PADDING");d(this,"lastCandidate",null);d(this,"maxViaCount");d(this,"minViaCount");d(this,"phase","setup");d(this,"progress",0);this.MAX_ITERATIONS=1e4,this.nodeWithPortPoints=e.nodeWithPortPoints,this.colorMap=e.colorMap??lZ(e.nodeWithPortPoints),this.hyperParameters=e.hyperParameters??{},this.SEGMENTS_PER_POLYLINE=e.hyperParameters?.SEGMENTS_PER_POLYLINE??3,this.BOUNDARY_PADDING=e.hyperParameters?.BOUNDARY_PADDING??.05,this.connMap=e.connMap,this.cellSize=this.nodeWithPortPoints.width/1024,this.candidates=[],this.availableZ=this.nodeWithPortPoints.availableZ??[0,1],this.bounds={minX:this.nodeWithPortPoints.center.x-this.nodeWithPortPoints.width/2,maxX:this.nodeWithPortPoints.center.x+this.nodeWithPortPoints.width/2,minY:this.nodeWithPortPoints.center.y-this.nodeWithPortPoints.height/2,maxY:this.nodeWithPortPoints.center.y+this.nodeWithPortPoints.height/2};let t=this.nodeWithPortPoints.width*this.nodeWithPortPoints.height,i=(this.viaDiameter+2*this.obstacleMargin+this.traceWidth/2)**2,r=new Set(this.nodeWithPortPoints.portPoints.map(a=>a.connectionName)).size;this.uniqueConnections=r;let{numSameLayerCrossings:s,numTransitions:o}=(a=>{let c=0,l=[],u=[],p=0;for(let y of a.portPoints){if(l.some(x=>x.connectionName===y.connectionName)||u.some(x=>x.connectionName===y.connectionName))continue;let g={connectionName:y.connectionName,z:y.z,points:[{x:y.x,y:y.y,z:y.z}]};for(let x of a.portPoints)y.connectionName===x.connectionName&&(y.x===x.x&&y.y===x.y||g.points.push({x:x.x,y:x.y,z:x.z}));g.points.some(x=>x.z!==g.z)?(p++,u.push(g)):l.push(g)}l=l.filter(y=>y.points.length>1);for(let y=0;y<l.length;y++)for(let g=y+1;g<l.length;g++){let x=l[y],v=l[g];x.z===v.z&&$i(x.points[0],x.points[1],v.points[0],v.points[1])&&c++}let f=0;for(let y=0;y<u.length;y++)for(let g=y+1;g<u.length;g++){let x=u[y],v=u[g];$i(x.points[0],x.points[1],v.points[0],v.points[1])&&f++}return{numSameLayerCrossings:c,numEntryExitLayerChanges:p,numTransitionPairCrossings:f,numTransitions:u.length}})(this.nodeWithPortPoints);if(this.minViaCount=2*s+o,this.maxViaCount=Math.min(Math.floor(t/i),Math.ceil(1.5*r)),this.minViaCount>this.SEGMENTS_PER_POLYLINE*(r/2))return this.failed=!0,void(this.error=`Not possible to solve problem with given SEGMENTS_PER_POLYLINE (${this.SEGMENTS_PER_POLYLINE}), atleast ${this.minViaCount} vias are required`);this.maxViaCount>this.SEGMENTS_PER_POLYLINE&&(this.maxViaCount=this.SEGMENTS_PER_POLYLINE),this.maxViaCount<this.minViaCount&&(this.maxViaCount=this.minViaCount)}computeMinGapBtwPolyLines(e){let t=[],i=[],r=[];for(let s=0;s<e.length;s++){let o=e[s],a=[o.start,...o.mPoints,o.end],c=new Map(this.availableZ.map(l=>[l,[]]));for(let l=0;l<a.length-1;l++){let u=[a[l],a[l+1]],p=u[0].z2;c.has(p)||c.set(p,[]),c.get(p).push(u)}i.push(c),r.push(a.filter(l=>l.z1!==l.z2))}for(let s=0;s<e.length;s++){let o=i[s],a=r[s];for(let c=s+1;c<e.length;c++){if(this.connMap?.areIdsConnected(e[s].connectionName,e[c].connectionName))continue;let l=i[c],u=r[c],p=1;for(let f of this.availableZ){let y=o.get(f)??[],g=l.get(f)??[];for(let x of y)for(let v of g)p=Math.min(p,A4(x[0],x[1],v[0],v[1])-this.traceWidth);for(let x of a)for(let v of g)p=Math.min(p,_r(x,v[0],v[1])-this.traceWidth/2-this.viaDiameter/2);for(let x of u)for(let v of y)p=Math.min(p,_r(x,v[0],v[1])-this.traceWidth/2-this.viaDiameter/2);for(let x of a)for(let v of u)p=Math.min(p,Qt(x,v)-this.viaDiameter)}t.push(p)}}return t}insertCandidate(e){let t=0,i=this.candidates.length-1;for(;t<=i;){let r=Math.floor((t+i)/2);this.candidates[r].f<e.f?t=r+1:i=r-1}this.candidates.splice(t,0,e)}setupInitialPolyLines(){let e=new Map;this.nodeWithPortPoints.portPoints.forEach(o=>{e.has(o.connectionName)?e.get(o.connectionName).end={...o,z1:o.z??0,z2:o.z??0}:e.set(o.connectionName,{start:{...o,z1:o.z??0,z2:o.z??0},end:null})});for(let[o,a]of e.entries())a.end===null&&e.delete(o);if(e.size===0)return this.failed=!0,void(this.error="No port pairs found, can't solve");let t=Array.from(e.entries()),i=((o,a,c,l)=>{let u=[];for(let[,f]of o){let y=f.start.z1!==f.end.z1,g=[];for(let x=0;x<=a;x++){let v=x%2!=0;y&&v?g.push(x):y||v||g.push(x)}u.push(g)}if(u.length===0)return[[]];let p=(f=>{if(!f||f.length===0)return[[]];let y=[[]];for(let g of f){let x=[];for(let v of y)for(let P of g)x.push([...v,P]);y=x}return y})(u).filter(f=>{for(let y=0;y<f.length;y++)if(f.reduce((g,x)=>g+x,0)<l)return!1;return!0});return p=p.filter(f=>{for(let y=0;y<o.length;y++){let[,g]=o[y];if(g.start.z1!==g.start.z2&&f[y]===0)return!1}return!0}),p=p.filter(f=>{for(let y=0;y<o.length;y++){let[,g]=o[y];if(o[y][1].start.z1===o[y][1].start.z2)for(let x=y+1;x<o.length;x++){if(o[x][1].start.z1!==o[x][1].start.z2)continue;let[,v]=o[x];if(g.start.z1===g.end.z1&&v.start.z1===v.end.z1&&g.start.z1===v.start.z1&&$i(g.start,g.end,v.start,v.end)&&f[y]+f[x]<2)return!1}}return!0}),p=p.filter(f=>!(f.reduce((y,g)=>y+g,0)>c)),p})(t,this.SEGMENTS_PER_POLYLINE,this.maxViaCount,this.minViaCount),r=(o=>{let{bounds:a,portPairsEntries:c,viaCountVariants:l}=o,{centroids:u}=lCt(a,c.map(([f,y])=>y)),p=[];for(let f of l){let y=f.reduce((v,P)=>v+P,0),g=u;if(u.length<y){g=[];let v=Math.ceil(Math.sqrt(y)),P=v;for(let w=0;w<v;w++)for(let k=0;k<P;k++)g.push({x:a.minX+(k+1)/(P+1)*(a.maxX-a.minX),y:a.minY+(w+1)/(v+1)*(a.maxY-a.minY)})}let x=uCt(y,g.length);for(let v of x){let P=[];for(let w=0;w<v.length;w++)v[w]===1&&P.push(g[w]);p.push({viaPositions:P,viaCountVariant:f})}}return p})({portPairsEntries:t,viaCountVariants:i,bounds:this.bounds}),s=[];for(let{viaCountVariant:o,viaPositions:a}of r){let c=uZ(a);for(let l of c)s.push({viaCountVariant:o,viaPositions:l})}for(let{viaPositions:o,viaCountVariant:a}of s){let c=[],l=0;for(let y=0;y<t.length;y++){let[g,x]=t[y],v=a[y],P=o.slice(l,l+v),w=pCt({start:x.start,end:x.end,segmentsPerPolyline:this.SEGMENTS_PER_POLYLINE,viaPositions:P,viaCount:v,availableZ:this.availableZ});l+=v,c.push({connectionName:g,start:x.start,end:x.end,mPoints:w})}if(dCt(c,this.bounds))continue;let u=this.computeMinGapBtwPolyLines(c),p=this.computeH({minGaps:u,forces:[]}),f={polyLines:c,g:0,h:p,f:p,viaCount:a.reduce((y,g)=>y+g,0),minGaps:u};if(this.checkIfSolved(f))return void(this.candidates=[f]);if(this.candidates.push(f),this.candidates.length>this.MAX_CANDIDATES)return}this.candidates.sort((o,a)=>o.f-a.f)}computeG(e,t){return t.g+5e-6+5e-6*t.viaCount*100}computeH(e){let t=0;for(let i of e.forces??[])for(let r of i)for(let s of r.values())t+=s.fx*s.fx+s.fy*s.fy;return t}getNeighbors(e){let{polyLines:t}=e,i=t.length,r=.02,s=.008,o=1e-6,a=Array.from({length:i},(g,x)=>Array.from({length:t[x].mPoints.length},()=>new Map)),c=(g,x,v,P,w)=>{if(x>0&&x<t[g].mPoints.length+1){let k=x-1,T=a[g][k],I=T.get(v)||{fx:0,fy:0};T.set(v,{fx:I.fx+P,fy:I.fy+w})}};for(let g=0;g<i;g++)for(let x=g+1;x<i;x++){let v=t[g],P=t[x],w=[v.start,...v.mPoints,v.end],k=[P.start,...P.mPoints,P.end],T=[],I=[];for(let M=0;M<w.length-1;M++)T.push({p1:w[M],p2:w[M+1],layer:w[M].z2,p1Idx:M,p2Idx:M+1});w.forEach((M,A)=>{M.z1!==M.z2&&I.push({point:M,layers:[M.z1,M.z2],index:A})});let E=[],N=[];for(let M=0;M<k.length-1;M++)E.push({p1:k[M],p2:k[M+1],layer:k[M].z2,p1Idx:M,p2Idx:M+1});k.forEach((M,A)=>{M.z1!==M.z2&&N.push({point:M,layers:[M.z1,M.z2],index:A})});for(let M of T)for(let A of E)if(M.layer===A.layer){if(A4(M.p1,M.p2,A.p1,A.p2)<o)continue;let R={x:(M.p1.x+M.p2.x)/2,y:(M.p1.y+M.p2.y)/2},j={x:(A.p1.x+A.p2.x)/2,y:(A.p1.y+A.p2.y)/2},B=R.x-j.x,G=R.y-j.y,U=B*B+G*G;if(U>o){let H=Math.sqrt(U),tt=(Math.exp(-6*H),`seg:${x}:${A.p1Idx}:${A.p2Idx}`),et=`seg:${g}:${M.p1Idx}:${M.p2Idx}`,mt=(V,J,nt,ut,ht,kt,Mt)=>{let ot=p_(V,nt.p1,nt.p2),X=V.x-ot.x,W=V.y-ot.y,rt=X*X+W*W;if(rt<=o)return;let pt=Math.sqrt(rt),yt=.02*Math.exp(-6*pt),Z=X/pt*yt,at=W/pt*yt;c(ut,J,kt,Z,at),c(ht,nt.p1Idx,Mt,-Z/2,-at/2),c(ht,nt.p2Idx,Mt,-Z/2,-at/2)};mt(M.p1,M.p1Idx,A,g,x,tt,et),mt(M.p2,M.p2Idx,A,g,x,tt,et),mt(A.p1,A.p1Idx,M,x,g,et,tt),mt(A.p2,A.p2Idx,M,x,g,et,tt)}}for(let M of I)for(let A of E)if(M.layers.includes(A.layer)){let R=p_(M.point,A.p1,A.p2),j=M.point.x-R.x,B=M.point.y-R.y,G=j*j+B*B;if(G>o){let U=Math.sqrt(G),H=2,tt=U;U<this.viaDiameter/2?(H*=4,tt=Math.max(o,U)):tt=Math.max(o,U-this.viaDiameter/2);let et=H*r*Math.exp(-6*tt),mt=j/U*et,V=B/U*et,J=`seg:${x}:${A.p1Idx}:${A.p2Idx}`;c(g,M.index,J,mt,V);let nt=`via:${g}:${M.index}`;c(x,A.p1Idx,nt,-mt/2,-V/2),c(x,A.p2Idx,nt,-mt/2,-V/2)}}for(let M of N)for(let A of T)if(M.layers.includes(A.layer)){let R=p_(M.point,A.p1,A.p2),j=M.point.x-R.x,B=M.point.y-R.y,G=j*j+B*B;if(G>o){let U=Math.sqrt(G),H=2,tt=U;U<this.viaDiameter/2?(H*=4,tt=Math.max(o,U)):tt=Math.max(o,U-this.viaDiameter/2);let et=H*r*Math.exp(-6*tt),mt=j/U*et,V=B/U*et,J=`seg:${g}:${A.p1Idx}:${A.p2Idx}`;c(x,M.index,J,mt,V);let nt=`via:${x}:${M.index}`;c(g,A.p1Idx,nt,-mt/2,-V/2),c(g,A.p2Idx,nt,-mt/2,-V/2)}}for(let M of I)for(let A of N)if(M.layers.filter(R=>A.layers.includes(R)).length>0){let R=M.point.x-A.point.x,j=M.point.y-A.point.y,B=R*R+j*j;if(B>o){let G=Math.sqrt(B),U=2,H=G;G<this.viaDiameter?(U*=4,H=Math.max(o,G)):H=Math.max(o,G-this.viaDiameter);let tt=U*r*Math.exp(-6*H),et=R/G*tt,mt=j/G*tt,V=`via:${x}:${A.index}`,J=`via:${g}:${M.index}`;c(g,M.index,V,et,mt),c(x,A.index,J,-et,-mt)}}}for(let g=0;g<i;g++){let x=t[g],v=[x.start,...x.mPoints,x.end],P=[];if(v.forEach((w,k)=>{w.z1!==w.z2&&P.push({point:w,layers:[w.z1,w.z2],index:k})}),!(P.length<2))for(let w=0;w<P.length;w++)for(let k=w+1;k<P.length;k++){let T=P[w],I=P[k],E=T.point.x-I.point.x,N=T.point.y-I.point.y,M=E*E+N*N;if(M>o){let A=Math.sqrt(M),R=2,j=A;A<this.viaDiameter?(R*=4,j=Math.max(o,A)):j=Math.max(o,A-this.viaDiameter);let B=R*r*Math.exp(-6*j),G=E/A*B,U=N/A*B,H=`via:${g}:${I.index}`,tt=`via:${g}:${T.index}`;c(g,T.index,H,G,U),c(g,I.index,tt,-G,-U)}}}let l=t.map(g=>({...g,mPoints:g.mPoints.map(x=>({...x}))})),u=!1;for(let g=0;g<i;g++)for(let x=0;x<l[g].mPoints.length;x++){let v=l[g].mPoints[x],P=a[g][x],w={fx:0,fy:0};for(let E of P.values())w.fx+=E.fx,w.fy+=E.fy;let k=v.z1!==v.z2,T=v.x+w.fx,I=v.y+w.fy;if(k){let E=this.viaDiameter/2,N=0,M=0,A=this.viaDiameter/2+this.BOUNDARY_PADDING,R=this.bounds.minX+A,j=this.bounds.maxX-A,B=this.bounds.minY+A,G=this.bounds.maxY-A,U=R+E-v.x,H=v.x-(j-E),tt=B+E-v.y,et=v.y-(G-E);U>0?N=s*(Math.exp(U/(2*this.obstacleMargin))-1):H>0&&(N=-.008*(Math.exp(H/(2*this.obstacleMargin))-1)),tt>0?M=s*(Math.exp(tt/(2*this.obstacleMargin))-1):et>0&&(M=-.008*(Math.exp(et/(2*this.obstacleMargin))-1)),w.fx+=N,w.fy+=M,T=v.x+w.fx,I=v.y+w.fy}else{let E=this.traceWidth/2+this.BOUNDARY_PADDING;T=Math.max(this.bounds.minX+E,Math.min(this.bounds.maxX-E,T)),I=Math.max(this.bounds.minY+E,Math.min(this.bounds.maxY-E,I))}Math.abs(w.fx)<o&&Math.abs(w.fy)<o||(Math.abs(v.x-T)>o||Math.abs(v.y-I)>o)&&(v.x=T,v.y=I,u=!0)}if(!u)return[];let p=this.computeMinGapBtwPolyLines(l),f=this.computeG(l,e),y=this.computeH({minGaps:p,forces:a});return[{polyLines:l,g:f,h:y,f:Math.round(5*f)/5+y,minGaps:p,forces:a,viaCount:e.viaCount}]}checkIfSolved(e){let t=e.minGaps.every(r=>r>=this.obstacleMargin),i=e.polyLines.every(r=>r.mPoints.every(s=>{let o=(s.z1!==s.z2?this.viaDiameter/2:this.traceWidth/2)+this.BOUNDARY_PADDING;return((a,c,l=0)=>a.x>=c.minX+l&&a.x<=c.maxX-l&&a.y>=c.minY+l&&a.y<=c.maxY-l)(s,this.bounds,o)}));return t&&i}tryFinalAcceptance(){let e=this.hyperParameters?.MINIMUM_FINAL_ACCEPTANCE_GAP??void 0;if(!(e===void 0||this.lastCandidate===null||this.lastCandidate.minGaps.length===0))return Math.min(...this.lastCandidate.minGaps)>=e?(this.solved=!0,void this._setSolvedRoutes()):void 0}_step(){if(this.phase==="setup")return this.setupInitialPolyLines(),void(this.phase="solving");let e=this.candidates.shift();if(!e)return this.tryFinalAcceptance(),this.solved?void 0:(this.failed=!0,void(this.error="No candidates left"));if(this.lastCandidate=e,this.checkIfSolved(e))return this.solved=!0,void this._setSolvedRoutes();if(!e)return void(this.failed=!0);let t=this.getNeighbors(e);for(let i of t)this.insertCandidate(i)}visualize(){let e={points:[],lines:[],rects:[],circles:[],coordinateSystem:"cartesian",title:"MultiHeadPolyLineIntraNodeSolver Visualization"};e.lines.push({points:[{x:this.bounds.minX,y:this.bounds.minY},{x:this.bounds.maxX,y:this.bounds.minY},{x:this.bounds.maxX,y:this.bounds.maxY},{x:this.bounds.minX,y:this.bounds.maxY},{x:this.bounds.minX,y:this.bounds.minY}],strokeColor:"gray"});let t=this.lastCandidate??this.candidates[0];if(t?.hasClosedSameLayerFace){let i=.1*(this.bounds.maxX-this.bounds.minX),r=.1*(this.bounds.maxY-this.bounds.minY);e.rects.push({center:{x:this.bounds.maxX+.6*i,y:this.bounds.maxY+.6*r},width:i,height:r,fill:"red",label:"HAS CLOSED FACE"})}for(let i of this.nodeWithPortPoints.portPoints)e.points.push({x:i.x,y:i.y,label:`${i.connectionName} (Port z=${i.z??0})`,color:this.colorMap[i.connectionName]??"blue"});return t&&t.polyLines.forEach((i,r)=>{let s=this.colorMap[i.connectionName]??"purple",o=[i.start,...i.mPoints,i.end];for(let a=0;a<o.length-1;a++){let c=o[a],l=o[a+1],u=c.z2,p=u===0,f=p?s:Qn(s,.5);e.lines.push({points:[c,l],strokeColor:f,strokeWidth:this.traceWidth,strokeDash:p?void 0:[.15,.15],label:`${i.connectionName} segment (z=${u})`})}o.forEach((a,c)=>{let l=a.z1!==a.z2,u=a.z1,p=c>0&&c<o.length-1,f="",y="";if(p){let g=c-1,x=t.forces?.[r]?.[g];if(x&&x.size>0){let v={fx:0,fy:0};x.forEach((P,w)=>{if(v.fx+=P.fx,v.fy+=P.fy,Math.abs(P.fx)>1e-6||Math.abs(P.fy)>1e-6){let k=w.split(":"),T=k[0],I=parseInt(k[1],10),E=t.polyLines[I],N=this.colorMap[E.connectionName]??"gray",M=20,A={x:a.x+P.fx*M,y:a.y+P.fy*M},R=E.connectionName;T==="via"?R+=` Via ${parseInt(k[2],10)}`:T==="seg"&&(R+=` Seg ${parseInt(k[2],10)}-${parseInt(k[3],10)}`),e.lines.push({points:[a,A],strokeColor:N,strokeWidth:.02,strokeDash:"2,2",label:`Force by ${R} on ${i.connectionName} mPoint ${g}`})}}),(Math.abs(v.fx)>1e-6||Math.abs(v.fy)>1e-6)&&(y=`
Net Force: (${v.fx.toFixed(3)}, ${v.fy.toFixed(3)})`)}}if(l)f=`Via (${i.connectionName} z=${a.z1} -> z=${a.z2})${y}`,e.circles.push({center:a,radius:this.viaDiameter/2,fill:Qn(s,.5),label:f});else if(p){let g=u===0?s:Qn(s,.5);f=`mPoint (${i.connectionName} z=${u})${y}`,e.circles.push({center:a,radius:this.cellSize/8,fill:g,label:f})}})}),e}_setSolvedRoutes(){if(!this.solved||!this.lastCandidate)return[];let e=[];for(let t of this.lastCandidate.polyLines){let i=[],r=[],s=[t.start,...t.mPoints,t.end];for(let o=0;o<s.length;o++){let a=s[o];i.push({x:a.x,y:a.y,z:a.z1}),a.z1!==a.z2&&(r.push({x:a.x,y:a.y}),i.push({x:a.x,y:a.y,z:a.z2}))}e.push({connectionName:t.connectionName,traceThickness:this.traceWidth,viaDiameter:this.viaDiameter,route:i,vias:r})}this.solvedRoutes=e}},mCt=class extends fCt{computeG(n,e){return e.g+5e-6+5e-6*e.viaCount*100}computeH(n){let{minGaps:e}=n,t=0;for(let i of e)i<0&&(t+=this.obstacleMargin),i<this.obstacleMargin&&(t+=this.obstacleMargin-i);return .011*t}_step(){if(this.phase==="setup")return this.setupInitialPolyLines(),void(this.phase="solving");let n=this.candidates.shift();if(!n)return this.tryFinalAcceptance(),this.solved?void 0:void(this.failed=!0);if(this.lastCandidate=n,this.checkIfSolved(n))return this.solved=!0,void this._setSolvedRoutes();let e=!1,t=0,i=n.magForceApplied===void 0?1:10;for(let r=0;r<i;r++){let s=this.applyForcesToPolyLines(n.polyLines);if(t+=s.magForceApplied,e=s.lastStepMoved,!s.lastStepMoved)break}if(n.magForceApplied=t,n.minGaps=this.computeMinGapBtwPolyLines(n.polyLines),this.checkIfSolved(n))return this.solved=!0,void this._setSolvedRoutes();n.g=this.computeG(n.polyLines,n),n.h=this.computeH(n),n.f=n.g+n.h,e&&this.insertCandidate(n)}applyForcesToPolyLines(n){let e=0,t=n.length,i=.02,r=.008,s=1e-6,o=Array.from({length:t},(u,p)=>Array.from({length:n[p].mPoints.length},()=>({fx:0,fy:0}))),a=(u,p,f,y)=>{if(p>0&&p<n[u].mPoints.length+1){let g=p-1;o[u][g].fx+=f,o[u][g].fy+=y}},c=(u,p,f,y,g)=>{let x=p_(u,f.p1,f.p2),v=u.x-x.x,P=u.y-x.y,w=v*v+P*P;if(w<=s)return;let k=Math.sqrt(w),T=.02*Math.exp(-6*k),I=v/k*T,E=P/k*T;a(y,p,I,E),a(g,f.p1Idx,-I/2,-E/2),a(g,f.p2Idx,-I/2,-E/2)};for(let u=0;u<t;u++)for(let p=u+1;p<t;p++){let f=n[u],y=n[p],g=[f.start,...f.mPoints,f.end],x=[y.start,...y.mPoints,y.end],v=[],P=[];for(let T=0;T<g.length-1;T++)v.push({p1:g[T],p2:g[T+1],layer:g[T].z2,p1Idx:T,p2Idx:T+1});g.forEach((T,I)=>{T.z1!==T.z2&&P.push({point:T,layers:[T.z1,T.z2],index:I})});let w=[],k=[];for(let T=0;T<x.length-1;T++)w.push({p1:x[T],p2:x[T+1],layer:x[T].z2,p1Idx:T,p2Idx:T+1});x.forEach((T,I)=>{T.z1!==T.z2&&k.push({point:T,layers:[T.z1,T.z2],index:I})});for(let T of v)for(let I of w)T.layer===I.layer&&(A4(T.p1,T.p2,I.p1,I.p2),c(T.p1,T.p1Idx,I,u,p),c(T.p2,T.p2Idx,I,u,p),c(I.p1,I.p1Idx,T,p,u),c(I.p2,I.p2Idx,T,p,u));for(let T of P)for(let I of w)if(T.layers.includes(I.layer)){let E=p_(T.point,I.p1,I.p2),N=T.point.x-E.x,M=T.point.y-E.y,A=N*N+M*M;if(A>s){let R=Math.sqrt(A),j=2,B=R;R<this.viaDiameter/2?(j*=4,B=Math.max(s,R)):B=Math.max(s,R-this.viaDiameter/2);let G=j*i*Math.exp(-6*B),U=N/R*G,H=M/R*G;a(u,T.index,U,H),a(p,I.p1Idx,-U/2,-H/2),a(p,I.p2Idx,-U/2,-H/2)}}for(let T of k)for(let I of v)if(T.layers.includes(I.layer)){let E=p_(T.point,I.p1,I.p2),N=T.point.x-E.x,M=T.point.y-E.y,A=N*N+M*M;if(A>s){let R=Math.sqrt(A),j=2,B=R;R<this.viaDiameter/2?(j*=4,B=Math.max(s,R)):B=Math.max(s,R-this.viaDiameter/2);let G=j*i*Math.exp(-6*B),U=N/R*G,H=M/R*G;a(p,T.index,U,H),a(u,I.p1Idx,-U/2,-H/2),a(u,I.p2Idx,-U/2,-H/2)}}for(let T of P)for(let I of k)if(T.layers.filter(E=>I.layers.includes(E)).length>0){let E=T.point.x-I.point.x,N=T.point.y-I.point.y,M=E*E+N*N;if(M>s){let A=Math.sqrt(M),R=2,j=A;A<this.viaDiameter?(R*=4,j=Math.max(s,A)):j=Math.max(s,A-this.viaDiameter);let B=R*i*Math.exp(-6*j),G=E/A*B,U=N/A*B;a(u,T.index,G,U),a(p,I.index,-G,-U)}}}for(let u=0;u<t;u++){let p=n[u],f=[p.start,...p.mPoints,p.end],y=[];if(f.forEach((g,x)=>{g.z1!==g.z2&&y.push({point:g,layers:[g.z1,g.z2],index:x})}),!(y.length<2))for(let g=0;g<y.length;g++)for(let x=g+1;x<y.length;x++){let v=y[g],P=y[x],w=v.point.x-P.point.x,k=v.point.y-P.point.y,T=w*w+k*k;if(T>s){let I=Math.sqrt(T),E=2,N=I;I<this.viaDiameter?(E*=4,N=Math.max(s,I)):N=Math.max(s,I-this.viaDiameter);let M=E*i*Math.exp(-6*N),A=w/I*M,R=k/I*M;a(u,v.index,A,R),a(u,P.index,-A,-R)}}}let l=!1;for(let u=0;u<t;u++)for(let p=0;p<n[u].mPoints.length;p++){let f=n[u].mPoints[p],y=o[u][p],g=f.z1!==f.z2,x=y.fx,v=y.fy,P=f.x+x,w=f.y+v;if(g){let k=this.viaDiameter/2,T=0,I=0,E=this.viaDiameter/2+this.BOUNDARY_PADDING,N=this.bounds.minX+E,M=this.bounds.maxX-E,A=this.bounds.minY+E,R=this.bounds.maxY-E,j=N+k-f.x,B=f.x-(M-k),G=A+k-f.y,U=f.y-(R-k);j>0?T=r*(Math.exp(j/(2*this.obstacleMargin))-1):B>0&&(T=-.008*(Math.exp(B/(2*this.obstacleMargin))-1)),G>0?I=r*(Math.exp(G/(2*this.obstacleMargin))-1):U>0&&(I=-.008*(Math.exp(U/(2*this.obstacleMargin))-1)),x+=T,v+=I,P=f.x+x,w=f.y+v}else{let k=this.traceWidth/2+this.BOUNDARY_PADDING;P=Math.max(this.bounds.minX+k,Math.min(this.bounds.maxX-k,P)),w=Math.max(this.bounds.minY+k,Math.min(this.bounds.maxY-k,w))}Math.abs(x)<s&&Math.abs(v)<s||(e+=Math.sqrt(x*x+v*v),(Math.abs(f.x-P)>s||Math.abs(f.y-w)>s)&&(f.x=P,f.y=w,l=!0))}return{lastStepMoved:l,magForceApplied:e}}},_Ct=n=>n.flatMap(e=>`${e.connectionName}-${e.mPoints.map(t=>`${t.x.toFixed(2)},${t.y.toFixed(2)},${t.z1},${t.z2}`)}`).sort().join("|"),yCt=class extends mCt{constructor(n){super(n),this.MAX_ITERATIONS=1e3}createInitialCandidateFromSeed(n){let e=new rCt({nodeWithPortPoints:this.nodeWithPortPoints,colorMap:this.colorMap,hyperParameters:{SHUFFLE_SEED:n}});if(e.solve(),e.failed||!e.solved)return null;let t=[],i=0;for(let[a,c]of e.completedPaths.entries()){if(c.length<2){console.warn(`Skipping connection "${a}" due to insufficient points (${c.length}) in ViaPossibilitiesSolver2 path.`);continue}let l=c[0],u=c[c.length-1],p=c.slice(1,-1),f=[],y=0,g=l.z;for(let P=0;P<p.length;P++){let w=p[P],k=P+1<p.length?p[P+1]:u,T=g,I=P+1<p.length&&w.x===k.x&&w.y===k.y&&w.z!==k.z?k.z:w.z;f.push({x:w.x,y:w.y,z1:T,z2:I}),T!==I?(y++,P++,g=I):g=w.z}i+=y;let x=this.SEGMENTS_PER_POLYLINE,v=f.length+1;for(;v<x;){let P=-1,w=-1,k=null,T=null,I=[{...l,z1:l.z,z2:l.z,connectionName:a},...f,{...u,z1:u.z,z2:u.z,connectionName:a}];for(let R=0;R<I.length-1;R++){let j=I[R],B=I[R+1];if(j.x===B.x&&j.y===B.y)continue;let G=Qt(j,B);G>P&&(P=G,w=R,k=j,T=B)}if(w===-1||!k||!T){console.warn(`Could not find longest segment for ${a} while trying to reach ${x} segments.`);break}let E=(k.x+T.x)/2,N=(k.y+T.y)/2,M=k.z2,A={x:E,y:N,z1:M,z2:M};f.splice(w,0,A),v++}t.push({connectionName:a,start:{...l,z1:l.z,z2:l.z},end:{...u,z1:u.z,z2:u.z},mPoints:f})}if(t.length===0)return this.failed=!0,this.error="No valid polylines generated from ViaPossibilitiesSolver2.",console.error(this.error),null;let r=this.computeMinGapBtwPolyLines(t),s=this.computeH({minGaps:r,forces:[]}),o={polyLines:t,g:0,h:s,f:0+s,viaCount:i,minGaps:r};return o.g=this.computeG(t,o),o.f=o.g+o.h,o}setupInitialPolyLines(){this.candidates=[];let n=Math.min(2e3,(function(t){if(!Number.isInteger(t)||t<0)throw new RangeError("n must be a non-negative integer");let i=1;for(let r=2;r<=t;r++)i*=r;return i})(this.uniqueConnections)),e=new Set;for(let t=0;t<n;t++){let i=this.createInitialCandidateFromSeed(t);if(!i)continue;let r=_Ct(i.polyLines);e.has(r)||(e.add(r),this.candidates.push(i))}this.candidates.sort((t,i)=>t.f-i.f)}},gCt=class extends U4{constructor(e){super();d(this,"constructorParams");d(this,"solvedRoutes",[]);d(this,"nodeWithPortPoints");d(this,"connMap");this.nodeWithPortPoints=e.nodeWithPortPoints,this.connMap=e.connMap,this.constructorParams=e,this.MAX_ITERATIONS=25e4,this.GREEDY_MULTIPLIER=5,this.MIN_SUBSTEPS=100}getCombinationDefs(){return[["multiHeadPolyLine"],["majorCombinations","orderings6","cellSizeFactor"],["noVias"],["orderings50"],["flipTraceAlignmentDirection","orderings6"],["closedFormTwoTrace"]]}getHyperParameterDefs(){return[{name:"majorCombinations",possibleValues:[{FUTURE_CONNECTION_PROX_TRACE_PENALTY_FACTOR:2,FUTURE_CONNECTION_PROX_VIA_PENALTY_FACTOR:1,FUTURE_CONNECTION_PROXIMITY_VD:10,MISALIGNED_DIST_PENALTY_FACTOR:5},{FUTURE_CONNECTION_PROX_TRACE_PENALTY_FACTOR:1,FUTURE_CONNECTION_PROX_VIA_PENALTY_FACTOR:.5,FUTURE_CONNECTION_PROXIMITY_VD:5,MISALIGNED_DIST_PENALTY_FACTOR:2},{FUTURE_CONNECTION_PROX_TRACE_PENALTY_FACTOR:10,FUTURE_CONNECTION_PROX_VIA_PENALTY_FACTOR:1,FUTURE_CONNECTION_PROXIMITY_VD:5,MISALIGNED_DIST_PENALTY_FACTOR:10,VIA_PENALTY_FACTOR_2:1}]},{name:"orderings6",possibleValues:[{SHUFFLE_SEED:0},{SHUFFLE_SEED:1},{SHUFFLE_SEED:2},{SHUFFLE_SEED:3},{SHUFFLE_SEED:4},{SHUFFLE_SEED:5}]},{name:"cellSizeFactor",possibleValues:[{CELL_SIZE_FACTOR:.5},{CELL_SIZE_FACTOR:1}]},{name:"flipTraceAlignmentDirection",possibleValues:[{FLIP_TRACE_ALIGNMENT_DIRECTION:!0}]},{name:"noVias",possibleValues:[{CELL_SIZE_FACTOR:2,VIA_PENALTY_FACTOR_2:10}]},{name:"orderings50",possibleValues:Array.from({length:50},(e,t)=>({SHUFFLE_SEED:100+t}))},{name:"closedFormTwoTrace",possibleValues:[{CLOSED_FORM_TWO_TRACE_SAME_LAYER:!0},{CLOSED_FORM_TWO_TRACE_TRANSITION_CROSSING:!0}]},{name:"multiHeadPolyLine",possibleValues:[{MULTI_HEAD_POLYLINE_SOLVER:!0,SEGMENTS_PER_POLYLINE:6,BOUNDARY_PADDING:.05},{MULTI_HEAD_POLYLINE_SOLVER:!0,SEGMENTS_PER_POLYLINE:6,BOUNDARY_PADDING:-.05,ITERATION_PENALTY:1e4,MINIMUM_FINAL_ACCEPTANCE_GAP:.001}]}]}computeG(e){return e?.hyperParameters?.MULTI_HEAD_POLYLINE_SOLVER?1e3+((e.hyperParameters?.ITERATION_PENALTY??0)+e.iterations)/1e4+1e4*(e.hyperParameters.SEGMENTS_PER_POLYLINE-3):e.iterations/1e4}computeH(e){return 1-(e.progress||0)}generateSolver(e){return e.CLOSED_FORM_TWO_TRACE_SAME_LAYER?new tCt({nodeWithPortPoints:this.nodeWithPortPoints}):e.CLOSED_FORM_TWO_TRACE_TRANSITION_CROSSING?new iCt({nodeWithPortPoints:this.nodeWithPortPoints}):e.MULTI_HEAD_POLYLINE_SOLVER?new yCt({nodeWithPortPoints:this.nodeWithPortPoints,connMap:this.connMap,hyperParameters:e}):new JMt({...this.constructorParams,hyperParameters:e})}onSolve(e){this.solvedRoutes=e.solver.solvedRoutes}};function xCt(n,e,t){let i=[],r=null;for(let s=0;s<n.length;s++){let o=n[s];r?r.z===o.z?r.points.push({x:o.x,y:o.y}):(i.push(r),r={points:[{x:o.x,y:o.y}],z:o.z,connectionName:e,color:t}):r={points:[{x:o.x,y:o.y}],z:o.z,connectionName:e,color:t},s===n.length-1&&r&&i.push(r)}return i}var pZ=class extends an{constructor({nodePortPoints:e,colorMap:t,connMap:i}){super();d(this,"unsolvedNodePortPoints");d(this,"routes");d(this,"colorMap");d(this,"defaultViaDiameter",.6);d(this,"defaultTraceThickness",.15);d(this,"failedSolvers");d(this,"activeSubSolver",null);d(this,"connMap");this.unsolvedNodePortPoints=e,this.colorMap=t??{},this.connMap=i,this.routes=[],this.failedSolvers=[],this.MAX_ITERATIONS=1e6}_step(){if(this.updateCacheStats(),this.activeSubSolver)return this.activeSubSolver.step(),this.activeSubSolver.solved?(this.routes.push(...this.activeSubSolver.solvedRoutes),this.activeSubSolver=null):this.activeSubSolver.failed&&(this.failedSolvers.push(this.activeSubSolver),this.activeSubSolver=null),void this.updateCacheStats();if(this.unsolvedNodePortPoints.length===0)return this.failedSolvers.length>0?(this.solved=!1,this.failed=!0,this.error=`Failed to solve ${this.failedSolvers.length} nodes, ${this.failedSolvers.slice(0,5).map(t=>t.nodeWithPortPoints.capacityMeshNodeId)}. err0: ${this.failedSolvers[0].error}.`,void this.updateCacheStats()):(this.solved=!0,void this.updateCacheStats());let e=this.unsolvedNodePortPoints.pop();this.activeSubSolver=new gCt({nodeWithPortPoints:e,colorMap:this.colorMap,connMap:this.connMap}),this.updateCacheStats()}updateCacheStats(){let e=__();this.stats.intraNodeCacheHits=e.cacheHits,this.stats.intraNodeCacheMisses=e.cacheMisses}visualize(){let e={lines:[],points:[],rects:[],circles:[]};for(let t of this.routes){let i=xCt(t.route,t.connectionName,this.colorMap[t.connectionName]);for(let r of i)e.lines.push({points:r.points,label:r.connectionName,strokeColor:r.z===0?r.color:Qn(r.color,.75),layer:`z${r.z}`,strokeWidth:t.traceThickness,strokeDash:r.z!==0?"10, 5":void 0});for(let r of t.vias)e.circles.push({center:r,layer:"z0,1",radius:t.viaDiameter/2,fill:this.colorMap[t.connectionName],label:`${t.connectionName} via`})}for(let t of this.failedSolvers){let i=t.nodeWithPortPoints,r=.1*i.width,s=.1*i.height;e.rects.push({center:{x:i.center.x-r/2,y:i.center.y-s/2},layer:"did_not_connect",width:r,height:s,fill:"red",label:`Failed: ${i.capacityMeshNodeId}`});let o={};for(let a of i.portPoints)o[a.connectionName]||(o[a.connectionName]=[]),o[a.connectionName].push({x:a.x,y:a.y,z:a.z});for(let[a,c]of Object.entries(o))for(let l=0;l<c.length-1;l++){let u=c[l],p=c[l+1];e.lines.push({points:[u,p],strokeColor:"red",strokeDash:"10, 5",layer:"did_not_connect"})}}return this.activeSubSolver&&(e=ud(e,this.activeSubSolver.visualize())),e}},hZ=class{constructor(n){d(this,"netMap");d(this,"idToNetMap");this.netMap=n,this.idToNetMap={};for(let[e,t]of Object.entries(n))for(let i of t)this.idToNetMap[i]=e}addConnections(n){for(let e of n){let t=new Set;for(let r of e){let s=this.idToNetMap[r];s&&t.add(s)}let i;if(t.size===0)i=`connectivity_net${Object.keys(this.netMap).length}`,this.netMap[i]=[];else if(t.size===1)i=t.values().next().value??`connectivity_net${Object.keys(this.netMap).length}`;else{i=t.values().next().value??`connectivity_net${Object.keys(this.netMap).length}`;for(let r of t)if(r!==i){this.netMap[i].push(...this.netMap[r]),this.netMap[r]=this.netMap[i];for(let s of this.netMap[i])this.idToNetMap[s]=i}}for(let r of e)this.netMap[i].includes(r)||this.netMap[i].push(r),this.idToNetMap[r]=i}}getIdsConnectedToNet(n){return this.netMap[n]||[]}getNetConnectedToId(n){return this.idToNetMap[n]}areIdsConnected(n,e){if(n===e)return!0;let t=this.getNetConnectedToId(n);if(!t)return!1;let i=this.getNetConnectedToId(e);return!!i&&(t===i||i===n||i===n)}areAllIdsConnected(n){let e=this.getNetConnectedToId(n[0]);for(let t of n){let i=this.getNetConnectedToId(t);if(i===void 0||i!==e)return!1}return!0}},WS=n=>{let e=new hZ({});for(let t of n.connections)for(let i of t.pointsToConnect)"pcb_port_id"in i&&i.pcb_port_id&&e.addConnections([[t.name,i.pcb_port_id]]);for(let t of n.obstacles)e.addConnections([t.connectedTo]);return e},bCt=class{constructor(n){d(this,"point");d(this,"left",null);d(this,"right",null);this.point=n}},vCt=class{constructor(n){d(this,"root",null);n.length>0&&(this.root=this.buildTree(n,0))}buildTree(n,e){let t=e%2==0?"x":"y";n.sort((s,o)=>s[t]-o[t]);let i=Math.floor(n.length/2),r=new bCt(n[i]);return i>0&&(r.left=this.buildTree(n.slice(0,i),e+1)),i<n.length-1&&(r.right=this.buildTree(n.slice(i+1),e+1)),r}findNearestNeighbor(n){if(!this.root)throw new Error("Tree is empty");let e=this.root.point,t=this.distance(n,e);return this.nearestNeighborSearch(this.root,n,0,e,t),e}nearestNeighborSearch(n,e,t,i,r){if(!n)return i;let s=t%2?"x":"y",o=this.distance(e,n.point);o<r&&(i=n.point,r=o);let a=e[s]-n.point[s],c=a<=0?n.left:n.right,l=a<=0?n.right:n.left;return i=this.nearestNeighborSearch(c,e,t+1,i,r),r=this.distance(e,i),Math.abs(a)<r&&(i=this.nearestNeighborSearch(l,e,t+1,i,r)),i}findKNearestNeighbors(n,e){if(!this.root)return[];let t=[];return this.kNearestNeighborSearch(this.root,n,0,t,e),t.sort((i,r)=>i.distance-r.distance).slice(0,e).map(i=>i.point)}kNearestNeighborSearch(n,e,t,i,r){if(!n)return;let s=t%2?"x":"y",o=this.distance(e,n.point);i.push({point:n.point,distance:o});let a=e[s]-n.point[s],c=a<=0?n.left:n.right,l=a<=0?n.right:n.left;this.kNearestNeighborSearch(c,e,t+1,i,r);let u=1/0;i.length>=r&&(i.sort((p,f)=>p.distance-f.distance),u=i[r-1]?.distance||1/0),(Math.abs(a)<u||i.length<r)&&this.kNearestNeighborSearch(l,e,t+1,i,r)}distance(n,e){return Math.sqrt((n.x-e.x)**2+(n.y-e.y)**2)}},SCt=class{constructor(n){d(this,"parent",new Map);d(this,"rank",new Map);for(let e of n){let t=this.pointToKey(e);this.parent.set(t,t),this.rank.set(t,0)}}pointToKey(n){return`${n.x},${n.y}`}find(n){let e=this.pointToKey(n);if(!this.parent.has(e))throw new Error(`Point ${e} not found in DisjointSet`);let t=e;for(;t!==this.parent.get(t);)t=this.parent.get(t);let i=e;for(;i!==t;){let r=this.parent.get(i);this.parent.set(i,t),i=r}return t}union(n,e){let t=this.find(n),i=this.find(e);if(t===i)return!1;let r=this.rank.get(t)||0,s=this.rank.get(i)||0;return r<s?this.parent.set(t,i):r>s?this.parent.set(i,t):(this.parent.set(i,t),this.rank.set(t,r+1)),!0}},dZ=class extends an{constructor(e,t={}){super();d(this,"unprocessedConnections");d(this,"newConnections");this.ogSrj=e,this.colorMap=t,this.unprocessedConnections=[...e.connections],this.newConnections=[]}_step(){if(this.unprocessedConnections.length===0)return void(this.solved=!0);let e=this.unprocessedConnections.pop(),t=e.externallyConnectedPointIds??[],i=new Map;t.forEach((a,c)=>a.forEach(l=>i.set(l,c)));let r=(a,c)=>{if(!a.pointId||!c.pointId)return!1;let l=i.get(a.pointId),u=i.get(c.pointId);return l!==void 0&&l===u};if(e.pointsToConnect.length===2)return r(e.pointsToConnect[0],e.pointsToConnect[1])?void 0:void this.newConnections.push(e);let s=(function(a){if(a.length<=1)return[];let c=new vCt(a),l=[],u=Math.min(10,a.length-1);for(let y of a){let g=c.findKNearestNeighbors(y,u+1);for(let x of g){if(y.x===x.x&&y.y===x.y)continue;let v=Math.sqrt((y.x-x.x)**2+(y.y-x.y)**2);l.push({from:y,to:x,weight:v})}}l.sort((y,g)=>y.weight-g.weight);let p=new SCt(a),f=[];for(let y of l)if(p.union(y.from,y.to)&&(f.push(y),f.length===a.length-1))break;return f})(e.pointsToConnect),o=0;for(let a of s)r(a.from,a.to)||this.newConnections.push({pointsToConnect:[a.from,a.to],name:`${e.name}_mst${o++}`})}getNewSimpleRouteJson(){return{...this.ogSrj,connections:this.newConnections}}visualize(){let e={lines:[],points:[],rects:[],circles:[],coordinateSystem:"cartesian",title:"Net To Point Pairs Visualization"};return this.unprocessedConnections.forEach(t=>{t.pointsToConnect.forEach(o=>{e.points.push({x:o.x,y:o.y,color:"red",label:t.name})});let i=t.pointsToConnect.length**2,r=Dg(0),s=new Set;for(let o=0;o<Math.max(i,2*t.pointsToConnect.length);o++){let a=Math.floor(r()*t.pointsToConnect.length),c=Math.floor(r()*t.pointsToConnect.length);s.has(`${a}-${c}`)||(s.add(`${a}-${c}`),e.lines.push({points:[t.pointsToConnect[a],t.pointsToConnect[c]],strokeColor:"rgba(255,0,0,0.25)"}))}}),this.newConnections.forEach(t=>{let i=this.colorMap?.[t.name]||"blue";t.pointsToConnect.forEach(r=>{e.points.push({x:r.x,y:r.y,color:i,label:t.name})});for(let r=0;r<t.pointsToConnect.length-1;r++)for(let s=r+1;s<t.pointsToConnect.length;s++)e.lines.push({points:[t.pointsToConnect[r],t.pointsToConnect[s]],strokeColor:i})}),e}},zg=(n,e)=>{if(n<0||n>=e)throw new Error(`Invalid z "${n}" for layer count: ${e}`);return n===0?"top":n===e-1?"bottom":`inner${n}`},fZ=(n,e)=>{let t=[];if(n.route.length===0)return t;let i=[],r=n.route[0].z;for(let o=0;o<n.route.length;o++){let a=n.route[o];if(a.z!==r){let c=zg(r,e);for(let l of i)t.push({route_type:"wire",x:l.x,y:l.y,width:n.traceThickness,layer:c});if(n.vias.some(l=>Math.abs(l.x-a.x)<.001&&Math.abs(l.y-a.y)<.001)){let l=zg(r,e),u=zg(a.z,e);t.push({route_type:"via",x:a.x,y:a.y,from_layer:l,to_layer:u})}i=[a],r=a.z}else i.push(a)}let s=zg(r,e);for(let o of i)t.push({route_type:"wire",x:o.x,y:o.y,width:n.traceThickness,layer:s});return t},wCt=class extends an{constructor(e){super();d(this,"mergedHdRoute");d(this,"remainingHdRoutes");d(this,"start");d(this,"end");d(this,"colorMap");if(this.remainingHdRoutes=[...e.hdRoutes],this.colorMap=e.colorMap??{},e.hdRoutes.length===0){this.start=e.start,this.end=e.end;let i=[{x:e.start.x,y:e.start.y,z:e.start.z}],r=[];return e.start.z!==e.end.z&&(i.push({x:e.start.x,y:e.start.y,z:e.end.z}),r.push({x:e.start.x,y:e.start.y})),i.push({x:e.end.x,y:e.end.y,z:e.end.z}),this.mergedHdRoute={connectionName:e.connectionName,route:i,vias:r,viaDiameter:e.defaultViaDiameter??.6,traceThickness:e.defaultTraceThickness??.15},void(this.solved=!0)}let{firstRoute:t}=this.getDisjointedRoute();Math.min(Qt(t.route[0],e.start),Qt(t.route[t.route.length-1],e.start))<Math.min(Qt(t.route[0],e.end),Qt(t.route[t.route.length-1],e.end))?(this.start=e.start,this.end=e.end):(this.start=e.end,this.end=e.start),this.mergedHdRoute={connectionName:e.connectionName,route:[{x:this.start.x,y:this.start.y,z:this.start.z}],vias:[],viaDiameter:t.viaDiameter,traceThickness:t.traceThickness}}getDisjointedRoute(){for(let e of this.remainingHdRoutes)if([e.route[0],e.route[e.route.length-1]].some(t=>!this.remainingHdRoutes.some(i=>i===e?!1:[i.route[0],i.route[i.route.length-1]].some(r=>r.z===t.z&&Qt(t,r)<5e-6))))return{firstRoute:e};return{firstRoute:this.remainingHdRoutes[0]}}_step(){if(this.remainingHdRoutes.length===0)return this.mergedHdRoute.route.push({x:this.end.x,y:this.end.y,z:this.end.z}),void(this.solved=!0);let e=this.mergedHdRoute.route[this.mergedHdRoute.route.length-1],t=0,i="first",r=1/0;for(let o=0;o<this.remainingHdRoutes.length;o++){let a=this.remainingHdRoutes[o],c=a.route[a.route.length-1],l=a.route[0],u=Qt(e,l),p=Qt(e,c);u<r&&e.z===l.z&&(r=u,t=o,i="first"),p<r&&e.z===c.z&&(r=p,t=o,i="last")}let s=this.remainingHdRoutes[t];this.remainingHdRoutes.splice(t,1),i==="first"?this.mergedHdRoute.route.push(...s.route):this.mergedHdRoute.route.push(...[...s.route].reverse()),this.mergedHdRoute.vias.push(...s.vias)}visualize(){let e={points:[],lines:[],circles:[],title:"Single High Density Route Stitch Solver"};if(e.points?.push({x:this.start.x,y:this.start.y,color:"green",label:"Start"},{x:this.end.x,y:this.end.y,color:"red",label:"End"}),this.mergedHdRoute&&this.mergedHdRoute.route.length>1){e.lines?.push({points:this.mergedHdRoute.route.map(t=>({x:t.x,y:t.y})),strokeColor:"green"});for(let t of this.mergedHdRoute.route)e.points?.push({x:t.x,y:t.y,color:"green"});for(let t of this.mergedHdRoute.vias)e.circles?.push({center:{x:t.x,y:t.y},radius:this.mergedHdRoute.viaDiameter/2,fill:"green"})}for(let[t,i]of this.remainingHdRoutes.entries()){let r=this.colorMap[i.connectionName]??"gray";i.route.length>1&&e.lines?.push({points:i.route.map(s=>({x:s.x,y:s.y})),strokeColor:r});for(let s=0;s<i.route.length;s++){let o=i.route[s];e.points?.push({x:o.x+(t%2-.5)/500+(s%8-4)/1e3,y:o.y+(t%2-.5)/500+(s%8-4)/1e3,color:r,label:`Route ${i.connectionName} ${o===i.route[0]?"First":o===i.route[i.route.length-1]?"Last":""}`})}for(let s of i.vias)e.circles?.push({center:{x:s.x,y:s.y},radius:i.viaDiameter/2,fill:r})}return e}},mZ=class extends an{constructor(e){super();d(this,"unsolvedRoutes");d(this,"activeSolver",null);d(this,"mergedHdRoutes",[]);d(this,"colorMap",{});d(this,"defaultTraceThickness");d(this,"defaultViaDiameter");this.colorMap=e.colorMap??{},e.hdRoutes.length>0?(this.defaultTraceThickness=e.hdRoutes[0].traceThickness,this.defaultViaDiameter=e.hdRoutes[0].viaDiameter):(this.defaultTraceThickness=.15,this.defaultViaDiameter=.6),this.unsolvedRoutes=e.connections.map(t=>({connectionName:t.name,hdRoutes:e.hdRoutes.filter(i=>i.connectionName===t.name),start:{...t.pointsToConnect[0],z:pd(t.pointsToConnect[0].layer,e.layerCount)},end:{...t.pointsToConnect[1],z:pd(t.pointsToConnect[1].layer,e.layerCount)}})),this.MAX_ITERATIONS=1e5}_step(){if(this.activeSolver)return this.activeSolver.step(),void(this.activeSolver.solved?(this.mergedHdRoutes.push(this.activeSolver.mergedHdRoute),this.activeSolver=null):this.activeSolver.failed&&(this.failed=!0,this.error=this.activeSolver.error));let e=this.unsolvedRoutes.pop();e?this.activeSolver=new wCt({connectionName:e.connectionName,hdRoutes:e.hdRoutes,start:e.start,end:e.end,colorMap:this.colorMap,defaultTraceThickness:this.defaultTraceThickness,defaultViaDiameter:this.defaultViaDiameter}):this.solved=!0}visualize(){let e={points:[],lines:[],circles:[],title:"Multiple High Density Route Stitch Solver"};if(this.activeSolver){let t=this.activeSolver.visualize();t.points?.length&&e.points?.push(...t.points),t.lines?.length&&e.lines?.push(...t.lines),t.circles?.length&&e.circles?.push(...t.circles),t.rects?.length&&(e.rects=t.rects)}for(let[t,i]of this.mergedHdRoutes.entries()){let r=this.colorMap[i.connectionName]??`hsl(120, 100%, ${40+10*t%40}%)`;for(let s=0;s<i.route.length-1;s++){let o=i.route[s],a=i.route[s+1],c=o.z!==0?Qn(r,.5):r;e.lines?.push({points:[{x:o.x,y:o.y},{x:a.x,y:a.y}],strokeColor:c,strokeWidth:i.traceThickness})}for(let s of i.route){let o=s.z!==0?Qn(r,.5):r;e.points?.push({x:s.x,y:s.y,color:o})}for(let s of i.vias)e.circles?.push({center:{x:s.x,y:s.y},radius:i.viaDiameter/2,fill:r})}for(let t of this.unsolvedRoutes){let i=this.colorMap[t.connectionName]??"gray";e.points?.push({x:t.start.x,y:t.start.y,color:i,label:`${t.connectionName} Start (z=${t.start.z})`},{x:t.end.x,y:t.end.y,color:i,label:`${t.connectionName} End (z=${t.end.z})`}),e.lines?.push({points:[{x:t.start.x,y:t.start.y},{x:t.end.x,y:t.end.y}],strokeColor:i,strokeDash:"2 2"});for(let r of t.hdRoutes){r.route.length>1&&e.lines?.push({points:r.route.map(s=>({x:s.x,y:s.y})),strokeColor:Qn(i,.5),strokeDash:"10 5"});for(let s of r.vias)e.circles?.push({center:{x:s.x,y:s.y},radius:r.viaDiameter/2,fill:i})}}return e}},Vg=n=>{let e=[],t=[],i=[],r=Yg(n);if(n.connections)for(let s of n.connections)for(let o of s.pointsToConnect)i.push({x:o.x,y:o.y,color:r[s.name],layer:o.layer??("z"in o?zg(o.z,2):"top"),label:`${s.name} (${o.layer})`});if(n.traces)for(let s of n.traces)for(let o=0;o<s.route.length-1;o++){let a=s.route[o],c=s.route[o+1];a.route_type==="via"?t.push({center:{x:a.x,y:a.y},radius:.3,fill:"blue",stroke:"none",layer:"z0,1"}):a.route_type==="wire"&&c.route_type==="wire"&&c.layer===a.layer&&e.push({points:[{x:a.x,y:a.y},{x:c.x,y:c.y}],layer:`z${pd(a.layer,2)}`,strokeWidth:.15,strokeColor:Qn({top:"red",bottom:"blue",inner1:"green",inner2:"yellow"}[a.layer],.5)})}return{rects:n.obstacles.map(s=>({center:s.center,width:s.width,height:s.height,fill:"rgba(255,0,0,0.5)",layer:`z${s.layers.map(pd).join(",")}`})),circles:t,lines:e,points:i}};function Oq(n){let{nodeId:e,nodeIdToSegmentIds:t,segmentIdToNodeIds:i,hops:r}=n;if(r===0)return[e];let s=new Set([e]),o=[{nodeId:e,remainingHops:r}];for(;o.length>0;){let{nodeId:a,remainingHops:c}=o.shift();if(c===0)continue;let l=t.get(a)||[];for(let u of l){let p=i.get(u)||[];for(let f of p)s.has(f)||(s.add(f),o.push({nodeId:f,remainingHops:c-1}))}}return Array.from(s)}var $4=n=>Array.from(n.entries()).map(([e,{x:t,y:i,z:r}])=>`${e}(${t?.toFixed(3)??""},${i?.toFixed(3)??""},${r??""})`).sort().join("&"),PCt=(n,e,t,i)=>{let r=Math.min(n,e),s=Math.max(n,e),o=Math.min(t,i);return r<=Math.max(t,i)&&s>=o},XS=(n,e,t,i)=>{let r=[],s=new Map(n.originalPointMap);for(let[o,a]of t.entries()){let c=s.get(o);s.set(o,{x:a.x??c.x,y:a.y??c.y,z:a.z??c.z})}for(let o of n.allNodeIds){if(!e.get(o))continue;let a=n.segmentPairsInNode.get(o);for(let c of a){let l=s.get(c[0]),u=s.get(c[1]);l.z!==u.z&&r.push({type:"transition_via",segmentPoints:c,capacityMeshNodeId:o,probabilityOfFailure:0})}for(let c=0;c<a.length;c++)for(let l=c+1;l<a.length;l++){if(i?.areIdsConnected(a[c][0],a[c][1]))continue;let u=a[c],p=a[l],f=s.get(u[0]),y=s.get(u[1]),g=s.get(p[0]),x=s.get(p[1]);if(!PCt(f.z,y.z,g.z,x.z))continue;let v=$i(f,y,g,x),P=f.z===y.z&&g.z===x.z&&f.z===g.z;v&&(P?r.push({type:"same_layer_crossing",segmentPoints:[u,p],capacityMeshNodeId:o,crossingLine1:u,crossingLine2:p,probabilityOfFailure:0}):f.z===y.z&&g.z!==x.z?r.push({type:"single_transition_crossing",segmentPoints:[u,p],capacityMeshNodeId:o,sameLayerCrossingLine:u,transitionCrossingLine:p,probabilityOfFailure:0}):f.z!==y.z&&g.z===x.z?r.push({type:"single_transition_crossing",segmentPoints:[u,p],capacityMeshNodeId:o,sameLayerCrossingLine:p,transitionCrossingLine:u,probabilityOfFailure:0}):f.z!==y.z&&g.z!==x.z&&r.push({type:"double_transition_crossing",segmentPoints:[u,p],capacityMeshNodeId:o,crossingLine1:u,crossingLine2:p,probabilityOfFailure:0}))}}return r},_Z=(n,e,t)=>{if(e.type==="change_layer")for(let i of e.segmentPointIds){let r=n.get(i)||{};n.set(i,{...r,z:e.newZ})}else if(e.type==="swap_position_on_segment"){let[i,r]=e.segmentPointIds,s=t(i),o=t(r),a=n.get(i)||{},c=n.get(r)||{};n.set(i,{...a,x:o.x,y:o.y}),n.set(r,{...c,x:s.x,y:s.y})}else if(e.type==="combined")for(let i of e.operations)_Z(n,i,t)},yZ=(n,e)=>{let t=new Map,i=new Map,r=new Map,s=[],o=0;for(let a of n)for(let c of a.assignedPoints){let l={segmentPointId:"SP"+o++,segmentId:a.nodePortSegmentId,capacityMeshNodeIds:e.get(a.nodePortSegmentId),connectionName:c.connectionName,x:c.point.x,y:c.point.y,z:c.point.z,directlyConnectedSegmentPointIds:[]};t.set(l.segmentPointId,l);for(let u of l.capacityMeshNodeIds)i.set(u,[...i.get(u)??[],l.segmentPointId]);r.set(a.nodePortSegmentId,[...r.get(a.nodePortSegmentId)??[],l.segmentPointId]),s.push(l)}return{segmentPointMap:t,nodeToSegmentPointMap:i,segmentToSegmentPointMap:r}},D4=(n,e,t,i)=>n?._containsTarget?0:((.82*e+.41*t+.2*i)/2)**1.1/oo(n),kCt=class extends an{constructor(e){super();d(this,"nodeMap");d(this,"dedupedSegments");d(this,"dedupedSegmentMap");d(this,"MUTABLE_HOPS",1);d(this,"unravelSection");d(this,"candidates",[]);d(this,"lastProcessedCandidate",null);d(this,"bestCandidate",null);d(this,"originalCandidate");d(this,"rootNodeId");d(this,"nodeIdToSegmentIds");d(this,"segmentIdToNodeIds");d(this,"colorMap");d(this,"tunedNodeCapacityMap");d(this,"MAX_CANDIDATES",500);d(this,"iterationsSinceImprovement",0);d(this,"hyperParameters");d(this,"selectedCandidateIndex",null);d(this,"queuedOrExploredCandidatePointModificationHashes",new Set);d(this,"constructorParams");if(this.constructorParams=e,this.MUTABLE_HOPS=e.MUTABLE_HOPS??this.MUTABLE_HOPS,this.MAX_ITERATIONS=5e4,this.hyperParameters={...e.hyperParameters,MAX_ITERATIONS_WITHOUT_IMPROVEMENT:200},this.nodeMap=e.nodeMap,this.dedupedSegments=e.dedupedSegments,e.dedupedSegmentMap)this.dedupedSegmentMap=e.dedupedSegmentMap;else{this.dedupedSegmentMap=new Map;for(let t of this.dedupedSegments)this.dedupedSegmentMap.set(t.nodePortSegmentId,t)}this.nodeIdToSegmentIds=e.nodeIdToSegmentIds,this.segmentIdToNodeIds=e.segmentIdToNodeIds,this.rootNodeId=e.rootNodeId,this.colorMap=e.colorMap??{},this.unravelSection=this.createUnravelSection({segmentPointMap:e.segmentPointMap,nodeToSegmentPointMap:e.nodeToSegmentPointMap,segmentToSegmentPointMap:e.segmentToSegmentPointMap}),this.tunedNodeCapacityMap=new Map;for(let t of this.unravelSection.allNodeIds)this.tunedNodeCapacityMap.set(t,oo(this.nodeMap.get(t)));this.originalCandidate=this.createInitialCandidate(),this.candidates=[this.originalCandidate]}getConstructorParams(){return{...this.constructorParams,segmentPointMap:this.unravelSection.segmentPointMap,nodeToSegmentPointMap:this.unravelSection.segmentPointsInNode,segmentToSegmentPointMap:this.unravelSection.segmentPointsInSegment}}createUnravelSection(e){let t=Oq({nodeId:this.rootNodeId,nodeIdToSegmentIds:this.nodeIdToSegmentIds,segmentIdToNodeIds:this.segmentIdToNodeIds,hops:this.MUTABLE_HOPS}),i=Oq({nodeId:this.rootNodeId,nodeIdToSegmentIds:this.nodeIdToSegmentIds,segmentIdToNodeIds:this.segmentIdToNodeIds,hops:this.MUTABLE_HOPS+1}),r=Array.from(new Set(i).difference(new Set(t)));e?.segmentPointMap||(e=yZ(this.dedupedSegments,this.segmentIdToNodeIds));let s=new Map;for(let f of i)s.set(f,e.nodeToSegmentPointMap.get(f));let o=new Map;for(let f of i)for(let y of s.get(f)){let g=e.segmentPointMap.get(y);o.set(y,g)}let a=Array.from(o.values()),c=new Map;for(let f of a)c.set(f.segmentId,[...c.get(f.segmentId)??[],f.segmentPointId]);for(let[f,y]of s.entries())for(let g=0;g<y.length;g++){let x=e.segmentPointMap.get(y[g]);for(let v=g+1;v<y.length;v++){let P=e.segmentPointMap.get(y[v]);P.segmentPointId!==x.segmentPointId&&P.segmentId!==x.segmentId&&P.connectionName===x.connectionName&&(P.directlyConnectedSegmentPointIds.includes(x.segmentPointId)||(x.directlyConnectedSegmentPointIds.push(P.segmentPointId),P.directlyConnectedSegmentPointIds.push(x.segmentPointId)))}}let l=new Map;for(let f of i)l.set(f,[]);for(let f of a)for(let y of f.capacityMeshNodeIds){let g=l.get(y);if(g)for(let x of f.directlyConnectedSegmentPointIds){let v=e.segmentPointMap.get(x);v.segmentPointId!==f.segmentPointId&&v.capacityMeshNodeIds.some(P=>P===y)&&(g.some(([P,w])=>P===f.segmentPointId&&w===v.segmentPointId||P===v.segmentPointId&&w===f.segmentPointId)||g.push([f.segmentPointId,v.segmentPointId]))}}let u=new Set;for(let f of t)for(let y of this.nodeIdToSegmentIds.get(f))this.segmentIdToNodeIds.get(y).every(g=>!this.nodeMap.get(g)._containsTarget)&&u.add(y);let p=new Set;for(let f of a)f.capacityMeshNodeIds.some(y=>t.includes(y))&&p.add(f.segmentPointId);return{allNodeIds:i,mutableNodeIds:t,immutableNodeIds:r,mutableSegmentIds:u,segmentPairsInNode:l,segmentPointMap:o,segmentPointsInNode:s,segmentPointsInSegment:c,originalPointMap:o,mutableSegmentPointIds:p}}createInitialCandidate(){let e=new Map,t=XS(this.unravelSection,this.nodeMap,e),i=this.computeG({issues:t,originalCandidate:{},operationsPerformed:0,operation:{}});return{pointModifications:e,g:i,h:0,f:i,operationsPerformed:0,candidateHash:$4(e),issues:XS(this.unravelSection,this.nodeMap,e)}}get nextCandidate(){return this.candidates[0]??null}getPointInCandidate(e,t){let i=this.unravelSection.segmentPointMap.get(t),r=e.pointModifications.get(t);return{x:r?.x??i.x,y:r?.y??i.y,z:r?.z??i.z,segmentId:i.segmentId}}getOperationsForIssue(e,t){let i=[];if(t.type==="transition_via"){let[r,s]=t.segmentPoints,o=this.getPointInCandidate(e,r),a=this.getPointInCandidate(e,s),c=this.dedupedSegmentMap.get(o.segmentId).availableZ,l=this.dedupedSegmentMap.get(a.segmentId).availableZ;this.unravelSection.mutableSegmentPointIds.has(r)&&c.includes(a.z)&&i.push({type:"change_layer",newZ:a.z,segmentPointIds:[r]}),this.unravelSection.mutableSegmentPointIds.has(s)&&l.includes(o.z)&&i.push({type:"change_layer",newZ:o.z,segmentPointIds:[s]})}if(t.type==="same_layer_crossing"){let[r,s]=t.crossingLine1,[o,a]=t.crossingLine2,c=[],l=this.unravelSection.segmentPointMap.get(r),u=this.unravelSection.segmentPointMap.get(s),p=this.unravelSection.segmentPointMap.get(o),f=this.unravelSection.segmentPointMap.get(a),y=this.unravelSection.mutableSegmentPointIds.has(r),g=this.unravelSection.mutableSegmentPointIds.has(s),x=this.unravelSection.mutableSegmentPointIds.has(o),v=this.unravelSection.mutableSegmentPointIds.has(a);y&&x&&l.segmentId===p.segmentId&&c.push([r,o]),y&&v&&l.segmentId===f.segmentId&&c.push([r,a]),g&&x&&u.segmentId===p.segmentId&&c.push([s,o]),g&&v&&u.segmentId===f.segmentId&&c.push([s,a]);for(let[E,N]of c)i.push({type:"swap_position_on_segment",segmentPointIds:[E,N]});let P=this.dedupedSegmentMap.get(l.segmentId),w=this.dedupedSegmentMap.get(u.segmentId),k=this.dedupedSegmentMap.get(p.segmentId),T=this.dedupedSegmentMap.get(f.segmentId),I=(E,N)=>E.every(M=>M.availableZ.includes(N));if(y&&g){let E=l.z===0?1:0;I([P,w],E)&&i.push({type:"change_layer",newZ:E,segmentPointIds:[r,s]})}if(x&&v){let E=p.z===0?1:0;I([k,T],E)&&i.push({type:"change_layer",newZ:E,segmentPointIds:[o,a]})}if(y){let E=l.z===0?1:0;P.availableZ.includes(E)&&i.push({type:"change_layer",newZ:E,segmentPointIds:[r]})}if(g){let E=u.z===0?1:0;w.availableZ.includes(E)&&i.push({type:"change_layer",newZ:E,segmentPointIds:[s]})}if(x){let E=p.z===0?1:0;k.availableZ.includes(E)&&i.push({type:"change_layer",newZ:E,segmentPointIds:[o]})}if(v){let E=f.z===0?1:0;T.availableZ.includes(E)&&i.push({type:"change_layer",newZ:E,segmentPointIds:[a]})}}return i}computeG(e){let{issues:t,originalCandidate:i,operationsPerformed:r,operation:s}=e,o=new Map;for(let l of t){o.has(l.capacityMeshNodeId)||o.set(l.capacityMeshNodeId,{numTransitionCrossings:0,numSameLayerCrossings:0,numEntryExitLayerChanges:0});let u=o.get(l.capacityMeshNodeId);l.type==="transition_via"?u.numTransitionCrossings++:l.type==="same_layer_crossing"?u.numSameLayerCrossings++:l.type==="double_transition_crossing"||l.type==="single_transition_crossing"?u.numEntryExitLayerChanges++:l.type}let a=0;for(let[l,{numEntryExitLayerChanges:u,numSameLayerCrossings:p,numTransitionCrossings:f}]of o){let y=this.nodeMap.get(l),g=Math.min(D4(y,p,u,f),.999999);a+=Math.log(1-g)}var c;return(c=a)<-Math.LN2?Math.log(1-Math.exp(c)):Math.log(-Math.expm1(c))}getUnexploredNeighborByApplyingOperation(e,t){let i=new Map(e.pointModifications);_Z(i,t,c=>this.getPointInCandidate(e,c));let r=$4(i);if(this.queuedOrExploredCandidatePointModificationHashes.has(r))return null;let s=XS(this.unravelSection,this.nodeMap,i),o=e.operationsPerformed+1,a=this.computeG({issues:s,originalCandidate:e,operationsPerformed:o,operation:t});return{issues:s,g:a,h:0,f:a,pointModifications:i,candidateHash:r,operationsPerformed:o}}getNeighborOperationsForCandidate(e){return e.issues.flatMap(t=>this.getOperationsForIssue(e,t))}getNeighbors(e){let t=[],i=this.getNeighborOperationsForCandidate(e);for(let r of i){let s=this.getUnexploredNeighborByApplyingOperation(e,r);s&&t.push(s)}return t}_step(){let e=this.candidates.shift();this.iterationsSinceImprovement++,this.iterationsSinceImprovement>this.hyperParameters.MAX_ITERATIONS_WITHOUT_IMPROVEMENT?this.solved=!0:e?(this.lastProcessedCandidate=e,e.f<(this.bestCandidate?.f??1/0)&&(this.bestCandidate=e,this.iterationsSinceImprovement=0),this.getNeighbors(e).forEach(t=>{this.queuedOrExploredCandidatePointModificationHashes.has(t.candidateHash)||(this.queuedOrExploredCandidatePointModificationHashes.add(t.candidateHash),this.candidates.push(t))}),this.candidates.sort((t,i)=>t.f-i.f),this.candidates.length=Math.min(this.candidates.length,this.MAX_CANDIDATES)):this.solved=!0}visualize(){let e={points:[],lines:[],rects:[],circles:[],coordinateSystem:"cartesian",title:"Unravel Section Solver"},t=null;if(t=this.selectedCandidateIndex!==null?this.selectedCandidateIndex==="best"?this.bestCandidate:this.selectedCandidateIndex==="original"?this.originalCandidate:this.candidates[this.selectedCandidateIndex]:this.solved?this.bestCandidate:this.lastProcessedCandidate||this.candidates[0],!t)return e;let i=new Map;for(let[s,o]of this.unravelSection.segmentPointMap){let a={...o},c=t.pointModifications.get(s);c&&(c.x!==void 0&&(a.x=c.x),c.y!==void 0&&(a.y=c.y),c.z!==void 0&&(a.z=c.z)),i.set(s,a)}for(let[s,o]of i)e.points.push({x:o.x,y:o.y,label:`${s}
Segment: ${o.segmentId} ${this.unravelSection.mutableSegmentIds.has(o.segmentId)?"MUTABLE":"IMMUTABLE"}
Layer: ${o.z}`,color:this.colorMap[o.connectionName]||"#000"});let r=new Map;for(let s of this.unravelSection.allNodeIds)r.set(s,{numTransitionCrossings:0,numSameLayerCrossings:0,numEntryExitLayerChanges:0,estPf:0});for(let s of t.issues){let o=r.get(s.capacityMeshNodeId);s.type==="transition_via"?o.numTransitionCrossings++:s.type==="same_layer_crossing"?o.numSameLayerCrossings++:s.type!=="double_transition_crossing"&&s.type!=="single_transition_crossing"||o.numEntryExitLayerChanges++}for(let[s,o]of r.entries()){let a=this.nodeMap.get(s);o.estPf=D4(a,o.numSameLayerCrossings,o.numEntryExitLayerChanges,o.numTransitionCrossings)}for(let s of this.unravelSection.allNodeIds){let o=this.nodeMap.get(s),a=this.unravelSection.mutableNodeIds.includes(s),c=r.get(s),l=[`${s} (${a?"MUT":"IMM"})`,`${o.width.toFixed(2)}x${o.height.toFixed(2)}`,`Pf: ${c.estPf.toFixed(3)}`,`TC: ${c.numTransitionCrossings}`,`SLC: ${c.numSameLayerCrossings}`,`EELC: ${c.numEntryExitLayerChanges}`].join(`
`);e.rects.push({center:o.center,label:l,color:a?"green":"red",width:o.width/8,height:o.height/8})}for(let[s,o]of this.unravelSection.segmentPointsInSegment){if(o.length<=1)continue;let a=o.map(c=>i.get(c));for(let c=0;c<a.length-1;c++)e.lines.push({points:[{x:a[c].x,y:a[c].y},{x:a[c+1].x,y:a[c+1].y}],strokeColor:this.colorMap[s]||"#000"})}for(let[s,o]of i)for(let a of o.directlyConnectedSegmentPointIds)if(s<a){let c=i.get(a);if(!c)continue;let l=o.z===c.z,u=o.z,p;p=l?u===0?void 0:"10 5":"3 3 10",e.lines.push({points:[{x:o.x,y:o.y},{x:c.x,y:c.y}],strokeDash:p,strokeColor:this.colorMap[o.connectionName]||"#000"})}for(let s of t.issues){let o=this.nodeMap.get(s.capacityMeshNodeId);if(s.type==="transition_via")for(let a of s.segmentPoints){let c=i.get(a);e.circles.push({center:{x:c.x,y:c.y},radius:o.width/16,stroke:"#ff0000",fill:"rgba(255, 0, 0, 0.2)",label:`Via Issue
${a}
Layer: ${c.z}`})}else if(s.type==="same_layer_crossing")for(let[a,c]of[s.crossingLine1,s.crossingLine2]){let l=i.get(a),u=i.get(c);e.lines.push({points:[{x:l.x,y:l.y},{x:u.x,y:u.y}],strokeColor:"rgba(255,0,0,0.2)",strokeWidth:o.width/32})}}for(let[s,o]of t.pointModifications){let a=i.get(s),c=this.unravelSection.segmentPointMap.get(s);e.circles.push({center:{x:a.x,y:a.y},radius:.05,stroke:"#0000ff",fill:"rgba(0, 0, 255, 0.2)",label:`${s}
Original: (${c.x.toFixed(2)}, ${c.y.toFixed(2)}, ${c.z})
New: (${a.x.toFixed(2)}, ${a.y.toFixed(2)}, ${a.z})`})}return e}};function Lq(n,e){return Array.isArray(e)?[n.a*e[0]+n.c*e[1]+n.e,n.b*e[0]+n.d*e[1]+n.f]:{x:n.a*e.x+n.c*e.y+n.e,y:n.b*e.x+n.d*e.y+n.f}}var{cos:sae,sin:oae,PI:aae}=Math,{tan:cae}=Math,LS=n=>(Math.round(20*n)/20).toFixed(2),Fq=n=>(Math.round(1e3*n)/1e3).toFixed(3);Ug();var TCt=class extends kCt{constructor(e){super(e);d(this,"cacheHit",!1);d(this,"cacheProvider");d(this,"hasAttemptedToUseCache",!1);this.cacheProvider=e.cacheProvider===void 0?cZ():e.cacheProvider}_step(){!this.hasAttemptedToUseCache&&this.cacheProvider&&this.attemptToUseCacheSync()||(super._step(),(this.solved||this.failed)&&this.cacheProvider&&this.saveToCacheSync())}computeCacheKeyAndTransform(){let e=this.nodeMap.get(this.rootNodeId),t=(function(k,T=0){return{a:1,c:0,e:k,b:0,d:1,f:T}})(-e.center.x,-e.center.y),i=new Map,r=new Map,s=new Map,o=new Map,a=new Map,c=new Map,l=0,u=0,p=0,f=[...this.unravelSection.allNodeIds].sort((k,T)=>{let I=this.nodeMap.get(k),E=this.nodeMap.get(T);return I.center.x!==E.center.x?I.center.x-E.center.x:I.center.y-E.center.y});for(let k of f){let T="node_"+l++;i.set(k,T),r.set(T,k)}let y=[...Array.from(this.unravelSection.segmentPointMap.entries()).sort(([,k],[,T])=>k.x!==T.x?k.x-T.x:k.y-T.y).map(([k])=>k)].sort();for(let k of y){let T="sp_"+p++;a.set(k,T),c.set(T,k);let I=this.unravelSection.segmentPointMap.get(k).segmentId;if(!s.has(I)){let E="seg_"+u++;s.set(I,E),o.set(E,I)}}let g={};for(let[k,T]of i.entries()){let I=this.nodeMap.get(k),E=Lq(t,I.center);g[T]={width:I.width,height:I.height,availableZ:I.availableZ,center:{x:LS(E.x),y:LS(E.y)}}}let x={};for(let[k,T]of a.entries()){let I=this.unravelSection.segmentPointMap.get(k),E=Lq(t,{x:I.x,y:I.y});x[T]={x:LS(E.x),y:LS(E.y),z:I.z}}let v={hyperParameters:this.hyperParameters,normalizedNodes:g,normalizedSegmentPoints:x,mutableHops:this.MUTABLE_HOPS},P=`unravelsec:${(0,gZ.default)(v)}`,w={realToCacheTransform:t,nodeIdMap:i,segmentIdMap:s,segmentPointIdMap:a,reverseNodeIdMap:r,reverseSegmentIdMap:o,reverseSegmentPointIdMap:c};return this.cacheKey=P,this.cacheToSolveSpaceTransform=w,{cacheKey:P,cacheToSolveSpaceTransform:w}}applyCachedSolution(e){if(e.success===!1)return void(this.failed=!0);if(!this.cacheToSolveSpaceTransform)return void console.error("Cache transform not available to apply cached solution.");let{reverseSegmentPointIdMap:t,reverseNodeIdMap:i}=this.cacheToSolveSpaceTransform,r=new Map;for(let[o,a]of e.bestCandidatePointModificationsDelta){let c=t.get(o);if(!c){console.warn(`Could not find original ID for normalized SP ID: ${o} when applying cache.`);continue}let l=this.unravelSection.segmentPointMap.get(c);if(!l){console.warn(`Could not find original segment point for ID: ${c} when applying cache.`);continue}let u={};if(a.dx!==void 0){let p=parseFloat(a.dx);Number.isNaN(p)?console.warn(`Failed to parse cached dx coordinate: ${a.dx}`):u.x=l.x+p}if(a.dy!==void 0){let p=parseFloat(a.dy);Number.isNaN(p)?console.warn(`Failed to parse cached dy coordinate: ${a.dy}`):u.y=l.y+p}a.dz!==void 0&&(u.z=l.z+a.dz),Object.keys(u).length>0&&r.set(c,u)}let s=XS(this.unravelSection,this.nodeMap,r);this.bestCandidate={pointModifications:r,issues:s,f:e.bestCandidateF,g:e.bestCandidateF,h:0,operationsPerformed:-1,candidateHash:$4(r)},this.cacheHit=!0,this.solved=!0}attemptToUseCacheSync(){if(this.hasAttemptedToUseCache=!0,!this.cacheProvider?.isSyncCache)return console.log("Cache provider is not synchronous, skipping sync cache check."),!1;if(this.cacheKey||this.computeCacheKeyAndTransform(),!this.cacheKey)return console.error("Failed to compute cache key."),!1;try{let e=this.cacheProvider.getCachedSolutionSync(this.cacheKey);if(e)return this.applyCachedSolution(e),!0}catch(e){console.error("Error attempting to use cache:",e)}return!1}saveToCacheSync(){if(this.failed)return void this.cacheProvider?.setCachedSolutionSync(this.cacheKey,{success:!1});if(!this.bestCandidate)return;let{segmentPointIdMap:e}=this.cacheToSolveSpaceTransform,t=[];for(let[r,s]of this.bestCandidate.pointModifications.entries()){let o=e.get(r);if(!o){console.warn(`Could not find normalized ID for original SP ID: ${r} when saving to cache.`);continue}let a=this.unravelSection.segmentPointMap.get(r);if(!a){console.warn(`Could not find original segment point for ID: ${r} when saving cache.`);continue}let c={},l=!1;if(s.x!==void 0){let u=s.x-a.x,p=Fq(u);parseFloat(p)!==0&&(c.dx=p,l=!0)}if(s.y!==void 0){let u=s.y-a.y,p=Fq(u);parseFloat(p)!==0&&(c.dy=p,l=!0)}if(s.z!==void 0){let u=s.z-a.z;u!==0&&(c.dz=u,l=!0)}l&&t.push([o,c])}let i={success:!0,bestCandidatePointModificationsDelta:t,bestCandidateF:this.bestCandidate.f};this.cacheProvider?.setCachedSolutionSync(this.cacheKey,i)}},xZ=class extends an{constructor({assignedSegments:e,colorMap:t,nodes:i,cacheProvider:r}){super();d(this,"nodeMap");d(this,"dedupedSegmentMap");d(this,"dedupedSegments");d(this,"nodeIdToSegmentIds");d(this,"segmentIdToNodeIds");d(this,"nodeToSegmentPointMap");d(this,"segmentToSegmentPointMap");d(this,"colorMap");d(this,"tunedNodeCapacityMap");d(this,"MAX_NODE_ATTEMPTS",2);d(this,"MUTABLE_HOPS",1);d(this,"ACCEPTABLE_PF",.05);d(this,"MAX_ITERATIONS_WITHOUT_IMPROVEMENT",200);d(this,"nodePfMap");d(this,"attemptsToFixNode");d(this,"activeSubSolver",null);d(this,"segmentPointMap");d(this,"cacheProvider",null);this.stats.successfulOptimizations=0,this.stats.failedOptimizations=0,this.stats.cacheHits=0,this.stats.cacheMisses=0,this.cacheProvider=r??null,this.MAX_ITERATIONS=1e6,this.dedupedSegments=(c=>{let l=[],u=new Map,p=-1;for(let f of c){let y=`${f.start.x}-${f.start.y}-${f.end.x}-${f.end.y}-${f.availableZ.join(",")}`,g=u.get(y);g?f.nodePortSegmentId=g.nodePortSegmentId:(p++,f.nodePortSegmentId=`SEG${p}`,u.set(y,f),l.push(f))}return l})(e),this.dedupedSegmentMap=new Map;for(let c of this.dedupedSegments)this.dedupedSegmentMap.set(c.nodePortSegmentId,c);this.nodeMap=new Map;for(let c of i)this.nodeMap.set(c.capacityMeshNodeId,c);this.nodeIdToSegmentIds=new Map,this.segmentIdToNodeIds=new Map,this.attemptsToFixNode=new Map;for(let c of e)this.segmentIdToNodeIds.set(c.nodePortSegmentId,[...this.segmentIdToNodeIds.get(c.nodePortSegmentId)??[],c.capacityMeshNodeId]),this.nodeIdToSegmentIds.set(c.capacityMeshNodeId,[...this.nodeIdToSegmentIds.get(c.capacityMeshNodeId)??[],c.nodePortSegmentId]);this.colorMap=t??{},this.tunedNodeCapacityMap=new Map;for(let[c,l]of this.nodeMap)this.tunedNodeCapacityMap.set(c,oo(l));let{segmentPointMap:s,nodeToSegmentPointMap:o,segmentToSegmentPointMap:a}=yZ(this.dedupedSegments,this.segmentIdToNodeIds);this.segmentPointMap=s,this.nodeToSegmentPointMap=o,this.segmentToSegmentPointMap=a,this.nodePfMap=this.computeInitialPfMap()}computeInitialPfMap(){let e=new Map;for(let[t,i]of this.nodeMap.entries())e.set(t,this.computeNodePf(i));return e}computeNodePf(e){let{numSameLayerCrossings:t,numEntryExitLayerChanges:i,numTransitionCrossings:r}=(s=>{let o=0,a=0,c=0,l=new Map;for(let f of s)l.has(f.connectionName)||l.set(f.connectionName,[]),l.get(f.connectionName).push(f);let u=[],p=[];for(let[f,y]of l.entries()){if(y.length<2)continue;let g=y[0];for(let x=1;x<y.length;x++){let v=y[x],P={connectionName:f,z:g.z,points:[g,v]};g.z!==v.z?(a++,p.push({connectionName:f,points:[g,v]})):u.push(P)}}for(let f=0;f<u.length;f++)for(let y=f+1;y<u.length;y++){let g=u[f],x=u[y];g.z===x.z&&$i(g.points[0],g.points[1],x.points[0],x.points[1])&&o++}for(let f=0;f<p.length;f++)for(let y=f+1;y<p.length;y++){let g=p[f],x=p[y];$i(g.points[0],g.points[1],x.points[0],x.points[1])&&c++}for(let f=0;f<p.length;f++)for(let y=0;y<u.length;y++){let g=p[f],x=u[y];$i(g.points[0],g.points[1],x.points[0],x.points[1])&&c++}return{numSameLayerCrossings:o,numEntryExitLayerChanges:a,numTransitionCrossings:c}})((this.nodeToSegmentPointMap.get(e.capacityMeshNodeId)??[]).map(s=>this.segmentPointMap.get(s)));return D4(e,t,i,r)}_step(){if(this.iterations>=this.MAX_ITERATIONS-1)return void(this.solved=!0);if(!this.activeSubSolver){let r=null,s=0;for(let[o,a]of this.nodePfMap.entries())a*(1-(this.attemptsToFixNode.get(o)??0)/this.MAX_NODE_ATTEMPTS)>s&&(s=a,r=o);if(!r||s<this.ACCEPTABLE_PF)return void(this.solved=!0);this.attemptsToFixNode.set(r,(this.attemptsToFixNode.get(r)??0)+1),this.activeSubSolver=new TCt({dedupedSegments:this.dedupedSegments,dedupedSegmentMap:this.dedupedSegmentMap,nodeMap:this.nodeMap,nodeIdToSegmentIds:this.nodeIdToSegmentIds,segmentIdToNodeIds:this.segmentIdToNodeIds,colorMap:this.colorMap,rootNodeId:r,MUTABLE_HOPS:this.MUTABLE_HOPS,segmentPointMap:this.segmentPointMap,nodeToSegmentPointMap:this.nodeToSegmentPointMap,segmentToSegmentPointMap:this.segmentToSegmentPointMap,cacheProvider:this.cacheProvider})}this.activeSubSolver.step();let{bestCandidate:e,originalCandidate:t,lastProcessedCandidate:i}=this.activeSubSolver;if(this.activeSubSolver.failed)return this.stats.failedOptimizations+=1,void(this.activeSubSolver=null);if(this.activeSubSolver.solved){if(this.activeSubSolver.cacheHit?this.stats.cacheHits+=1:this.stats.cacheMisses+=1,e&&e.g<t.g){this.stats.successfulOptimizations+=1;for(let[r,s]of e.pointModifications.entries()){let o=this.segmentPointMap.get(r);o.x=s.x??o.x,o.y=s.y??o.y,o.z=s.z??o.z}for(let r of this.activeSubSolver.unravelSection.allNodeIds)this.nodePfMap.set(r,this.computeNodePf(this.nodeMap.get(r)))}else this.stats.failedOptimizations+=1;this.activeSubSolver=null}}visualize(){if(this.activeSubSolver)return this.activeSubSolver.visualize();let e={lines:[],points:[],rects:[],circles:[],coordinateSystem:"cartesian",title:"Unravel Multi Section Solver"};for(let[s,o]of this.nodeMap.entries()){let a=this.nodePfMap.get(s)||0,c=Math.min(a,1),l=`rgb(${Math.floor(255*c)}, ${Math.floor(255*(1-c))}, 0)`;(this.attemptsToFixNode.get(s)??0)===0&&c===0||e.rects.push({center:o.center,label:[s,`${o.width.toFixed(2)}x${o.height.toFixed(2)}`,`Pf: ${a.toFixed(3)}`].join(`
`),color:l,width:o.width/8,height:o.height/8})}for(let s of this.segmentPointMap.values()){let o=this.dedupedSegmentMap.get(s.segmentId);e.points.push({x:s.x,y:s.y,label:[s.segmentPointId,s.segmentId,`z: ${s.z}`,`segment.availableZ: ${o?.availableZ.join(",")}`].join(`
`),color:this.colorMap[s.connectionName]||"#000"})}let t=new Map;for(let s of this.segmentPointMap.values())t.has(s.segmentId)||t.set(s.segmentId,[]),t.get(s.segmentId).push(s);for(let[s,o]of t.entries()){if(o.length<2)continue;let a=[...o].sort((c,l)=>c.x!==l.x?c.x-l.x:c.y-l.y);for(let c=0;c<a.length-1;c++)e.lines.push({points:[{x:a[c].x,y:a[c].y},{x:a[c+1].x,y:a[c+1].y}],strokeColor:this.colorMap[s]||"#000"})}let i=new Set,r=Array.from(this.segmentPointMap.values());for(let s=0;s<r.length;s++){let o=r[s];for(let a=s+1;a<r.length;a++){let c=r[a];if(!(o.connectionName!==c.connectionName||o.segmentId===c.segmentId)&&o.capacityMeshNodeIds.some(l=>c.capacityMeshNodeIds.includes(l))){let l=`${o.segmentPointId}-${c.segmentPointId}`;if(i.has(l))continue;i.add(l);let u=o.z===c.z,p=o.z,f;f=u?p===0?void 0:"10 5":"3 3 10",e.lines.push({points:[{x:o.x,y:o.y},{x:c.x,y:c.y}],strokeDash:f,strokeColor:this.colorMap[o.connectionName]||"#666"})}}}return e}getNodesWithPortPoints(){if(!this.solved)throw new Error("CapacitySegmentToPointSolver not solved, can't give port points yet");let e=new Map;for(let t of this.dedupedSegments){let i=t.nodePortSegmentId;for(let r of this.segmentIdToNodeIds.get(i)){let s=this.nodeMap.get(r);e.has(r)||e.set(r,{capacityMeshNodeId:r,portPoints:[],center:s.center,width:s.width,height:s.height})}}for(let t of this.segmentPointMap.values())for(let i of t.capacityMeshNodeIds){let r=e.get(i);r&&r.portPoints.push({x:t.x,y:t.y,z:t.z,connectionName:t.connectionName})}return Array.from(e.values())}},so=(n,e={})=>{let t=Math.min(...n.availableZ);return{center:!e.rectMargin||e.zOffset?{x:n.center.x+t*n.width*(e.zOffset??.05),y:n.center.y-t*n.width*(e.zOffset??.05)}:n.center,width:e.rectMargin?n.width-2*e.rectMargin:Math.max(n.width-.5,.8*n.width),height:e.rectMargin?n.height-2*e.rectMargin:Math.max(n.height-.5,.8*n.height),fill:n._containsObstacle?"rgba(255,0,0,0.1)":{"0,1":"rgba(0,0,0,0.1)",0:"rgba(0,200,200, 0.1)",1:"rgba(0,0,200, 0.1)"}[n.availableZ.join(",")]??"rgba(0,200,200,0.1)",layer:`z${n.availableZ.join(",")}`,label:[n.capacityMeshNodeId,`availableZ: ${n.availableZ.join(",")}`,n._containsTarget?"containsTarget":"",n._containsObstacle?"containsObstacle":""].filter(Boolean).join(`
`)}},ECt=class extends an{constructor({simpleRouteJson:e,nodes:t,edges:i,colorMap:r,MAX_ITERATIONS:s=1e6,hyperParameters:o={}}){super();d(this,"connectionsWithNodes");d(this,"usedNodeCapacityMap");d(this,"simpleRouteJson");d(this,"nodes");d(this,"edges");d(this,"GREEDY_MULTIPLIER",1.1);d(this,"MAX_CANDIDATES_IN_MEMORY",1e5);d(this,"nodeMap");d(this,"nodeEdgeMap");d(this,"connectionNameToGoalNodeIds");d(this,"colorMap");d(this,"maxDepthOfNodes");d(this,"activeCandidateStraightLineDistance");d(this,"debug_lastNodeCostMap");d(this,"hyperParameters");d(this,"currentConnectionIndex",0);d(this,"candidates");d(this,"visitedNodes");this.MAX_ITERATIONS=s,this.simpleRouteJson=e,this.nodes=t,this.edges=i,this.colorMap=r??{};let{connectionsWithNodes:a,connectionNameToGoalNodeIds:c}=this.getConnectionsWithNodes();this.connectionsWithNodes=a,this.connectionNameToGoalNodeIds=c,this.hyperParameters=o,this.usedNodeCapacityMap=new Map(this.nodes.map(l=>[l.capacityMeshNodeId,0])),this.nodeMap=new Map(this.nodes.map(l=>[l.capacityMeshNodeId,l])),this.nodeEdgeMap=d_(this.edges),this.maxDepthOfNodes=Math.max(...this.nodes.map(l=>l._depth??0)),this.debug_lastNodeCostMap=new Map}getTotalCapacity(e){let t=e._depth??0;return(this.maxDepthOfNodes-t+1)**2}getConnectionsWithNodes(){let e=[],t=this.nodes.filter(r=>r._containsTarget),i=new Map;for(let r of this.simpleRouteJson.connections){let s=[];for(let o of r.pointsToConnect){let a=this.nodes[0],c=Number.MAX_VALUE;for(let l of t){let u=Math.sqrt((l.center.x-o.x)**2+(l.center.y-o.y)**2);u<c&&(c=u,a=l)}s.push(a)}if(s.length<2)throw new Error(`Not enough nodes for connection "${r.name}", only ${s.length} found`);i.set(r.name,s.map(o=>o.capacityMeshNodeId)),e.push({connection:r,nodes:s,pathFound:!1,straightLineDistance:Qt(s[0].center,s[s.length-1].center)})}return e.sort((r,s)=>r.straightLineDistance-s.straightLineDistance),{connectionsWithNodes:e,connectionNameToGoalNodeIds:i}}computeG(e,t,i){return e.g+this.getDistanceBetweenNodes(e.node,t)}computeH(e,t,i){return this.getDistanceBetweenNodes(t,i)}getBacktrackedPath(e){let t=[],i=e;for(;i;)t.push(i.node),i=i.prevCandidate;return t}getNeighboringNodes(e){return this.nodeEdgeMap.get(e.capacityMeshNodeId).flatMap(t=>t.nodeIds.filter(i=>i!==e.capacityMeshNodeId)).map(t=>this.nodeMap.get(t))}getCapacityPaths(){let e=[];for(let t of this.connectionsWithNodes){let i=t.path;i&&e.push({capacityPathId:t.connection.name,connectionName:t.connection.name,nodeIds:i.map(r=>r.capacityMeshNodeId)})}return e}doesNodeHaveCapacityForTrace(e,t){let i=this.usedNodeCapacityMap.get(e.capacityMeshNodeId)??0,r=this.getTotalCapacity(e);if(e.availableZ.length===1&&!e._containsTarget&&i>0)return!1;let s=0;return e.availableZ.length>1&&t.availableZ.length===1&&(s+=.5),i+s<r}canTravelThroughObstacle(e,t){return this.connectionNameToGoalNodeIds.get(t)?.includes(e.capacityMeshNodeId)??!1}getDistanceBetweenNodes(e,t){return Math.sqrt((e.center.x-t.center.x)**2+(e.center.y-t.center.y)**2)}reduceCapacityAlongPath(e){for(let t of e.path??[])this.usedNodeCapacityMap.set(t.capacityMeshNodeId,this.usedNodeCapacityMap.get(t.capacityMeshNodeId)+1)}isConnectedToEndGoal(e,t){return this.nodeEdgeMap.get(e.capacityMeshNodeId).some(i=>i.nodeIds.includes(t.capacityMeshNodeId))}_step(){let e=this.connectionsWithNodes[this.currentConnectionIndex];if(!e)return void(this.solved=!0);let[t,i]=e.nodes;this.candidates||(this.candidates=[{prevCandidate:null,node:t,f:0,g:0,h:0}],this.debug_lastNodeCostMap=new Map,this.visitedNodes=new Set([t.capacityMeshNodeId]),this.activeCandidateStraightLineDistance=Qt(t.center,i.center)),this.candidates.sort((o,a)=>o.f-a.f);let r=this.candidates.shift();if(this.candidates.length>this.MAX_CANDIDATES_IN_MEMORY&&this.candidates.splice(this.MAX_CANDIDATES_IN_MEMORY,this.candidates.length-this.MAX_CANDIDATES_IN_MEMORY),!r)return console.error(`Ran out of candidates on connection ${e.connection.name}`),this.currentConnectionIndex++,this.candidates=null,this.visitedNodes=null,void(this.failed=!0);if(this.isConnectedToEndGoal(r.node,i))return e.path=this.getBacktrackedPath({prevCandidate:r,node:i,f:0,g:0,h:0}),this.reduceCapacityAlongPath(e),this.currentConnectionIndex++,this.candidates=null,void(this.visitedNodes=null);let s=this.getNeighboringNodes(r.node);for(let o of s){if(this.visitedNodes?.has(o.capacityMeshNodeId)||!this.doesNodeHaveCapacityForTrace(o,r.node))continue;let a=this.connectionsWithNodes[this.currentConnectionIndex].connection.name;if(o._containsObstacle&&!this.canTravelThroughObstacle(o,a))continue;let c=this.computeG(r,o,i),l=this.computeH(r,o,i),u=c+l*this.GREEDY_MULTIPLIER;this.debug_lastNodeCostMap.set(o.capacityMeshNodeId,{f:u,g:c,h:l});let p={prevCandidate:r,node:o,f:u,g:c,h:l};this.candidates.push(p)}this.visitedNodes.add(r.node.capacityMeshNodeId)}visualize(){let e={lines:[],points:[],rects:[],circles:[]};if(this.connectionsWithNodes)for(let i=0;i<this.connectionsWithNodes.length;i++){let r=this.connectionsWithNodes[i];if(r.path&&r.path.length>0){let s=r.path.map(({center:{x:o,y:a},width:c,availableZ:l})=>({x:o+.005*c*(i%10+i%19),y:a+.005*c*(i%10+i%19),availableZ:l}));e.lines.push({points:s,strokeColor:this.colorMap[r.connection.name]});for(let o=0;o<s.length;o++){let a=s[o];e.points.push({x:a.x,y:a.y,label:[`conn: ${r.connection.name}`,`node: ${r.path[o].capacityMeshNodeId}`,`z: ${a.availableZ.join(",")}`].join(`
`)})}}}for(let i of this.nodes){let r=this.usedNodeCapacityMap.get(i.capacityMeshNodeId)??0,s=this.getTotalCapacity(i),o=this.debug_lastNodeCostMap.get(i.capacityMeshNodeId);e.rects.push({...so(i,{rectMargin:.025,zOffset:.01}),label:[`${i.capacityMeshNodeId}`,`${r}/${s}`,`${i.width.toFixed(2)}x${i.height.toFixed(2)}`,`g: ${o?.g!==void 0?o.g.toFixed(2):"?"}`,`h: ${o?.h!==void 0?o.h.toFixed(2):"?"}`,`f: ${o?.f!==void 0?o.f.toFixed(2):"?"}`,`z: ${i.availableZ.join(", ")}`].join(`
`),stroke:r>s+.5?"red":void 0})}if(this.connectionsWithNodes){for(let i of this.connectionsWithNodes)if(i.connection?.pointsToConnect)for(let r of i.connection.pointsToConnect)e.points.push({x:r.x,y:r.y,label:[`pointsToConnect ${i.connection.name}`].join(`
`)})}let t=this.connectionsWithNodes[this.currentConnectionIndex];if(!this.candidates&&this.currentConnectionIndex>0&&!this.connectionsWithNodes[this.currentConnectionIndex-1].path&&(t=this.connectionsWithNodes[this.currentConnectionIndex-1]),t){let[i,r]=t.connection.pointsToConnect;e.lines.push({points:[{x:i.x,y:i.y},{x:r.x,y:r.y}],strokeColor:"red",strokeDash:"10 5"})}if(this.candidates){let i=this.candidates.slice(0,5),r=this.connectionsWithNodes[this.currentConnectionIndex].connection.name;i.forEach((s,o)=>{let a=.5*(1-o/5),c=this.getBacktrackedPath(s);e.lines.push({points:c.map(({center:{x:l,y:u}})=>({x:l,y:u})),strokeColor:Qn(this.colorMap[r]??"red",1-a)})})}return e}},MCt=class extends ECt{constructor(...e){super(...e);d(this,"NEGATIVE_CAPACITY_PENALTY_FACTOR",1);d(this,"REDUCED_CAPACITY_PENALTY_FACTOR",1);this.GREEDY_MULTIPLIER=2.5}get maxCapacityFactor(){return this.hyperParameters.MAX_CAPACITY_FACTOR??1}getTotalCapacity(e){return oo(e,this.maxCapacityFactor)}getNodeCapacityPenalty(e){let t=e.width+e.height,i=.05,r=this.getTotalCapacity(e)-(this.usedNodeCapacityMap.get(e.capacityMeshNodeId)??0);return r>2?i:(t-i)*Math.max(1,(2-r)/(t-i))+i}getDistanceBetweenNodes(e,t){let i=e.center.x-t.center.x,r=e.center.y-t.center.y;return Math.sqrt(i**2+r**2)}computeG(e,t,i){return e.g+this.getDistanceBetweenNodes(e.node,t)+this.getNodeCapacityPenalty(t)}computeH(e,t,i){return this.getDistanceBetweenNodes(t,i)+this.getNodeCapacityPenalty(t)}},bZ=class extends MCt{doesNodeHaveCapacityForTrace(n,e){return!0}getNodeCapacityPenalty(n){let e=this.getTotalCapacity(n)-(this.usedNodeCapacityMap.get(n.capacityMeshNodeId)??0)-1;if(e>0)return 0;let t=1;return n.availableZ.length===1&&(t=10),(.05+2*Math.abs(e))*t}};function zq(n,e,t){let i=e.x-n.x,r=e.y-n.y;if(Math.abs(i)<1e-9&&Math.abs(r)<1e-9)return n;let s=t.width/2,o=t.height/2,a=t.center.x-s,c=t.center.x+s,l=t.center.y-o,u=t.center.y+o,p=0,f=1/0;if(Math.abs(i)>1e-9){let y=(a-n.x)/i,g=(c-n.x)/i;p=Math.max(p,Math.min(y,g)),f=Math.min(f,Math.max(y,g))}else if(n.x<a||n.x>c)return n;if(Math.abs(r)>1e-9){let y=(l-n.y)/r,g=(u-n.y)/r;p=Math.max(p,Math.min(y,g)),f=Math.min(f,Math.max(y,g))}else if(n.y<l||n.y>u)return n;return f<p||p===1/0||p<-1e9?n:{x:n.x+i*p,y:n.y+r*p}}function CCt(n,e){let t=n.center,i=e.center,r=zq(t,i,n),s=zq(i,t,e),o=i.x-t.x,a=i.y-t.y,c=Math.sqrt(o*o+a*a),l=r,u=s;if(c>1e-9){let p={x:o/c,y:a/c},f=.3*n.width,y=.3*e.width;f+y<Math.sqrt((s.x-r.x)**2+(s.y-r.y)**2)?(l={x:r.x+p.x*f,y:r.y+p.y*f},u={x:s.x-p.x*y,y:s.y-p.y*y}):(l=r,u=s)}return{lineStart:l,lineEnd:u}}var qS=(n,e,t)=>{if(n<e||e<1&&n<=1)return 0;if(t===1&&n>1)return 1-.01**n;let i=n/e-1;return 1-Math.exp(-2*i)},j4=(n,e,t)=>{if(t._containsTarget||n<=e)return 0;let i=1-qS(n,e,t.availableZ.length);return i<=0?-1e9:Math.log(i)},$g=({totalNodeCapacityMap:n,usedNodeCapacityMap:e,nodeMap:t,sectionNodeIds:i})=>{let r=0,s=i??new Set(e.keys());for(let o of s){if(!n.has(o))continue;let a=t.get(o);if(!a)continue;let c=n.get(o),l=e.get(o)??0;r+=j4(l,c,a)}return r};function V4({sectionNodes:n,sectionEdges:e,sectionConnectionTerminals:t,completedPaths:i,nodeMap:r,colorMap:s,centerNodeId:o,title:a,nodeOpacity:c=.1,usedNodeCapacityMap:l,totalCapacityMap:u}){let p={points:[],lines:[],rects:[],circles:[],title:a},f=new Set(n.map(y=>y.capacityMeshNodeId));for(let y of n){let g=`rgba(128, 128, 128, ${c})`,x=`rgba(128, 128, 128, ${c})`,v=y.availableZ??[],P=v.includes(0),w=v.includes(1);P&&w?(g=`rgba(128, 0, 128, ${c})`,x=`rgba(128, 0, 128, ${c})`):P?(g=`rgba(0, 0, 255, ${c})`,x=`rgba(0, 0, 255, ${c})`):w&&(g=`rgba(255, 0, 0, ${c})`,x=`rgba(255, 0, 0, ${c})`),o&&y.capacityMeshNodeId===o&&(g=`rgba(0, 255, 0, ${c})`,x=`rgba(0, 128, 0, ${c})`),p.rects.push({...so(y),fill:g,stroke:x,label:`${y.capacityMeshNodeId}
(Section Node)
Z: ${v.join(",")}`});let k=p.rects.length-1;if(l&&u){let T=l.get(y.capacityMeshNodeId)??0,I=u.get(y.capacityMeshNodeId)??0,E=I>0?(T/I*100).toFixed(1):"N/A",N=qS(T,I,y.availableZ.length);p.rects[k].label+=`
${T.toFixed(1)} / ${I.toFixed(1)}
${E}% (Pf: ${(100*N).toFixed(1)}%)`,N>.2&&(p.rects[k].stroke=Qn("red",.7*(.8+c)))}}for(let y of e){let[g,x]=y.nodeIds,v=r.get(g),P=r.get(x);if(v&&P){let{lineStart:w,lineEnd:k}=CCt(v,P);p.lines.push({points:[w,k],strokeColor:`rgba(0, 0, 0, ${.2*Math.min(1,c/.1)})`})}}return t.forEach((y,g)=>{let x=r.get(y.startNodeId),v=r.get(y.endNodeId),P=s[y.connectionName]??"black",w=x&&f.has(x.capacityMeshNodeId),k=v&&f.has(v.capacityMeshNodeId),T=(g+g/50)%5,I=0,E=0,N=0,M=0;if(w&&x){let A=.02*Math.min(x.width,x.height);I=A*T,E=A*T,p.points.push({x:x.center.x+I,y:x.center.y+E,color:P,label:`Start: ${y.connectionName}
(${y.startNodeId})`}),p.lines.push({points:[{x:x.center.x,y:x.center.y},{x:x.center.x+I,y:x.center.y+E}],strokeColor:"gray",strokeDash:"2 2"})}if(k&&v){let A=.02*Math.min(v.width,v.height);N=A*T,M=A*T,p.points.push({x:v.center.x+N,y:v.center.y+M,color:P,label:`End: ${y.connectionName}
(${y.endNodeId})`}),p.lines.push({points:[{x:v.center.x,y:v.center.y},{x:v.center.x+N,y:v.center.y+M}],strokeColor:"gray",strokeDash:"2 2"})}w&&k&&x&&v&&p.lines.push({points:[{x:x.center.x+I,y:x.center.y+E},{x:v.center.x+N,y:v.center.y+M}],strokeColor:P,strokeDash:"5 5"})}),i&&i.forEach((y,g)=>{if(y.path&&y.path.length>0){let x=s[y.connectionName]??"gray",v={x:(g+g/50)%5*.03,y:(g+g/50)%5*.03};p.lines.push({points:y.path.map(({center:{x:P,y:w}})=>({x:P+v.x,y:w+v.y})),strokeColor:Qn(x,.2)})}}),p}var ICt=class extends an{constructor(e){super();d(this,"GREEDY_MULTIPLIER",1.5);d(this,"sectionNodes");d(this,"sectionEdges");d(this,"sectionConnectionTerminals");d(this,"nodeMap");d(this,"nodeEdgeMap");d(this,"colorMap");d(this,"usedNodeCapacityMap");d(this,"totalNodeCapacityMap");d(this,"centerNodeId");d(this,"currentSectionScore",0);d(this,"MAX_CANDIDATES_IN_MEMORY",1e4);d(this,"currentConnectionIndex",0);d(this,"candidates",null);d(this,"visitedNodes",null);d(this,"queuedNodes",null);d(this,"activeCandidateStraightLineDistance");d(this,"debug_lastNodeCostMap",new Map);d(this,"maxCapacityFactor",1);this.MAX_ITERATIONS=1e4,this.centerNodeId=e.centerNodeId,this.sectionNodes=e.sectionNodes,this.sectionEdges=e.sectionEdges,this.sectionConnectionTerminals=e.sectionConnectionTerminals.map(i=>({...i,path:void 0})),this.nodeMap=e.nodeMap??new Map(this.sectionNodes.map(i=>[i.capacityMeshNodeId,i])),this.nodeEdgeMap=e.nodeEdgeMap??d_(this.sectionEdges),this.colorMap=e.colorMap??{},this.usedNodeCapacityMap=new Map(this.sectionNodes.map(i=>[i.capacityMeshNodeId,0])),this.totalNodeCapacityMap=new Map(this.sectionNodes.map(i=>[i.capacityMeshNodeId,this.getTotalCapacity(i)]));let t=new Set(this.sectionNodes.map(i=>i.capacityMeshNodeId));this.currentSectionScore=$g({totalNodeCapacityMap:this.totalNodeCapacityMap,usedNodeCapacityMap:this.usedNodeCapacityMap,nodeMap:this.nodeMap,sectionNodeIds:t}),e.hyperParameters?.SHUFFLE_SEED&&(this.sectionConnectionTerminals=Xg(this.sectionConnectionTerminals,e.hyperParameters?.SHUFFLE_SEED))}getTotalCapacity(e){return oo(e,this.maxCapacityFactor)}getNodeCapacityPenalty(e){if(!this.nodeMap.has(e.capacityMeshNodeId))return 1/0;let t=this.getTotalCapacity(e)-(this.usedNodeCapacityMap.get(e.capacityMeshNodeId)??0)-1;if(t>0)return 0;let i=1;return e.availableZ.length===1&&(i=10),(.05+t**2*4)*i}getDistanceBetweenNodes(e,t){let i=e.center.x-t.center.x,r=e.center.y-t.center.y;return Math.sqrt(i**2+r**2)}computeG(e,t,i){return e.g+this.getDistanceBetweenNodes(e.node,t)+this.getNodeCapacityPenalty(t)}computeH(e,t,i){return this.getDistanceBetweenNodes(t,i)+this.getNodeCapacityPenalty(t)}getBacktrackedPath(e){let t=[],i=e;for(;i;){if(t.push(i.node),!this.nodeMap.has(i.node.capacityMeshNodeId)){console.warn("Backtracked path went outside section bounds");break}i=i.prevCandidate}return t.reverse()}getNeighboringNodes(e){return this.nodeMap.has(e.capacityMeshNodeId)?this.nodeEdgeMap.get(e.capacityMeshNodeId)?.flatMap(t=>t.nodeIds.filter(i=>i!==e.capacityMeshNodeId)).map(t=>this.nodeMap.get(t)).filter(Boolean)??[]:[]}isConnectedToEndGoal(e,t){return!(!this.nodeMap.has(e.capacityMeshNodeId)||!this.nodeMap.has(t.capacityMeshNodeId))&&(this.nodeEdgeMap.get(e.capacityMeshNodeId)??[]).some(i=>i.nodeIds.includes(t.capacityMeshNodeId))}doesNodeHaveCapacityForTrace(e,t){return!0}reduceCapacityAlongPath(e){for(let t of e)if(this.usedNodeCapacityMap.has(t.capacityMeshNodeId)){let i=t.capacityMeshNodeId,r=this.nodeMap.get(i);if(!r){console.warn(`Node ${i} from path not found in section's nodeMap during score update.`);continue}let s=this.totalNodeCapacityMap.get(i),o=this.usedNodeCapacityMap.get(i)??0,a=j4(o,s,r);this.currentSectionScore-=a;let c=o+1;this.usedNodeCapacityMap.set(i,c);let l=j4(c,s,r);this.currentSectionScore+=l}}getSolvedSectionScore(){return this.currentSectionScore}_step(){let e=this.sectionConnectionTerminals[this.currentConnectionIndex];if(!e)return void(this.solved=!0);let t=this.nodeMap.get(e.startNodeId),i=this.nodeMap.get(e.endNodeId);if(!t||!i)return console.error(`Start or end node not found in section for connection ${e.connectionName}`),this.currentConnectionIndex++,this.candidates=null,void(this.visitedNodes=null);this.candidates||this._setupAStar(t,i);let r=this.candidates;if(r.length===0)return void this._handleCandidatesExhausted(e);r.sort((a,c)=>a.f-c.f);let s=r.shift();if(r.length>this.MAX_CANDIDATES_IN_MEMORY&&r.splice(this.MAX_CANDIDATES_IN_MEMORY,r.length-this.MAX_CANDIDATES_IN_MEMORY),this.visitedNodes.add(s.node.capacityMeshNodeId),s.node.capacityMeshNodeId===i.capacityMeshNodeId)return void this._handleGoalReached(s,e,i);let o=this.getNeighboringNodes(s.node);for(let a of o){if(this.queuedNodes?.has(a.capacityMeshNodeId)||!this.doesNodeHaveCapacityForTrace(a,s.node))continue;if(a._containsObstacle){let f=a.capacityMeshNodeId===e.startNodeId,y=a.capacityMeshNodeId===e.endNodeId;if(!f&&!y)continue}let c=this.computeG(s,a,i),l=this.computeH(s,a,i),u=c+l*this.GREEDY_MULTIPLIER;this.debug_lastNodeCostMap.set(a.capacityMeshNodeId,{f:u,g:c,h:l});let p={prevCandidate:s,node:a,f:u,g:c,h:l};this.queuedNodes?.add(a.capacityMeshNodeId),r.push(p)}}computeProgress(){let e=this.sectionConnectionTerminals.length;if(e===0)return 1;let t=this.currentConnectionIndex/e;if(this.currentConnectionIndex<e&&this.candidates&&this.candidates.length>0&&this.activeCandidateStraightLineDistance&&this.activeCandidateStraightLineDistance>0){let i=this.candidates.reduce((r,s)=>s.f<r.f?s:r);t+=Math.max(0,Math.min(1,1-i.h/this.activeCandidateStraightLineDistance))/e}else this.solved&&(t=1);return Math.min(1,t)}_setupAStar(e,t){this.candidates=[{prevCandidate:null,node:e,f:0,g:0,h:0}],this.visitedNodes=new Set([e.capacityMeshNodeId]),this.debug_lastNodeCostMap=new Map,this.activeCandidateStraightLineDistance=Qt(e.center,t.center);let i=this.computeH(null,e,t);this.candidates[0].h=i,this.candidates[0].f=i*this.GREEDY_MULTIPLIER,this.debug_lastNodeCostMap.set(e.capacityMeshNodeId,{f:this.candidates[0].f,g:0,h:i}),this.queuedNodes=new Set([e.capacityMeshNodeId])}_handleCandidatesExhausted(e){console.error(`Ran out of candidates for section connection ${e.connectionName}`),this.currentConnectionIndex++,this.candidates=null,this.visitedNodes=null,this.queuedNodes=null}_handleGoalReached(e,t,i){let r=this.getBacktrackedPath(e);t.path=r,this.reduceCapacityAlongPath(r),this.currentConnectionIndex++,this.candidates=null,this.visitedNodes=null,this.queuedNodes=null}visualize(){let e=this.sectionConnectionTerminals.filter(i=>i.path&&i.path.length>0).map(i=>({connectionName:i.connectionName,path:i.path})),t=V4({sectionNodes:this.sectionNodes,sectionEdges:this.sectionEdges,sectionConnectionTerminals:this.sectionConnectionTerminals,completedPaths:e,nodeMap:this.nodeMap,colorMap:this.colorMap,centerNodeId:null,title:`Section Pathing: Conn ${this.currentConnectionIndex+1}/${this.sectionConnectionTerminals.length} (${this.sectionNodes.length} nodes)`,nodeOpacity:.1});for(let i of this.sectionNodes){let r=t.rects.findIndex(s=>s.label?.includes(i.capacityMeshNodeId));if(r!==-1){let s=this.debug_lastNodeCostMap.get(i.capacityMeshNodeId),o=this.usedNodeCapacityMap.get(i.capacityMeshNodeId)??0,a=this.getTotalCapacity(i),c=`${o.toFixed(1)}/${a.toFixed(1)}`,l=s?`f:${s.f.toFixed(1)} g:${s.g.toFixed(1)} h:${s.h.toFixed(1)}`:"cost:?";t.rects[r].label=[i.capacityMeshNodeId,`Cap: ${c}`,l,`Z: ${i.availableZ.join(",")}`].join(`
`),o>a&&(t.rects[r].stroke=Qn("red",.7))}}if(this.candidates&&this.candidates.length>0){let i=this.candidates.slice().sort((a,c)=>a.f-c.f).slice(0,5),r=this.sectionConnectionTerminals[this.currentConnectionIndex],s=r?.connectionName??"unknown",o=this.colorMap[s]??"purple";i.forEach((a,c)=>{let l=.8*(1-c/5),u=this.getBacktrackedPath(a);u.length>0&&t.lines.push({points:u.map(({center:{x:p,y:f}})=>({x:p,y:f})),strokeColor:Qn(o,1-l),strokeWidth:.05})})}return t}},FS=n=>Array.from({length:n},(e,t)=>t),NCt=class extends U4{constructor(e){super();d(this,"constructorParams");this.MAX_ITERATIONS=1e5,this.constructorParams=e}computeG(e){return-e.getSolvedSectionScore()}computeH(e){return 0}getCombinationDefs(){let e=this.constructorParams.sectionConnectionTerminals.length;return e===2?[["orderings2_for2"]]:e===3?[["orderings6_for3"]]:e===4?[["orderings24_for4"]]:[["orderings30"]]}getFailureMessage(){return`All CapacityPathingSingleSection solvers failed for "${this.centerNodeId}"`}getHyperParameterDefs(){return[{name:"orderings2_for2",possibleValues:FS(2).map(e=>({SHUFFLE_SEED:e}))},{name:"orderings6_for3",possibleValues:FS(6).map(e=>({SHUFFLE_SEED:e}))},{name:"orderings24_for4",possibleValues:FS(24).map(e=>({SHUFFLE_SEED:e}))},{name:"orderings30",possibleValues:FS(30).map(e=>({SHUFFLE_SEED:e}))}]}generateSolver(e){return new ICt({...this.constructorParams,hyperParameters:{...this.constructorParams.hyperParameters,...e}})}onSolve({solver:e}){this.winningSolver=e}get centerNodeId(){return this.constructorParams.centerNodeId}get sectionNodes(){return this.constructorParams.sectionNodes}get sectionConnectionTerminals(){return this.winningSolver?.sectionConnectionTerminals}},ACt=n=>Math.floor(10*n)/10,RCt=class extends NCt{constructor(e){e.nodeMap=e.nodeMap??new Map(e.sectionNodes.map(t=>[t.capacityMeshNodeId,t]));super(e);d(this,"cacheHit",!1);d(this,"cacheProvider");d(this,"hasAttemptedToUseCache",!1);d(this,"sectionNodeIdSet");d(this,"cachedSectionConnectionTerminals",null);d(this,"sectionScore",0);this.sectionNodeIdSet=new Set(e.sectionNodes.map(t=>t.capacityMeshNodeId)),this.cacheProvider=e.cacheProvider===void 0?__():e.cacheProvider}_step(){!this.hasAttemptedToUseCache&&this.cacheProvider&&this.attemptToUseCacheSync()||(super._step(),(this.solved||this.failed)&&this.cacheProvider&&this.saveToCacheSync())}_computeBfsOrderingOfNodesInSection(){let e=new Set(this.constructorParams.centerNodeId),t=[],i=[{ancestorCapacitySum:0,capacity:0,g:0,capacityMeshNodeId:this.constructorParams.centerNodeId}];for(;i.length>0;){i.sort((o,a)=>a.g-o.g);let r=i.pop();if(!r)break;t.push(r.capacityMeshNodeId);let s=this.constructorParams.nodeEdgeMap.get(r.capacityMeshNodeId).flatMap(o=>o.nodeIds).filter(o=>!e.has(o)).filter(o=>this.sectionNodeIdSet.has(o));for(let o of s){e.add(o);let a=this.constructorParams.nodeMap.get(o),c=oo(a);i.push({ancestorCapacitySum:r.g,capacity:c,g:r.g+c,capacityMeshNodeId:o})}}return t}computeCacheKeyAndTransform(){let e=this._computeBfsOrderingOfNodesInSection(),t=new Map,i=new Map;e.forEach((f,y)=>{let g=`node${y}`;t.set(f,g),i.set(g,f)});let r={};for(let f of e){let y=t.get(f),g=this.constructorParams.nodeMap.get(f),x=oo(g);r[y]=ACt(x).toFixed(1)}let s=new Set,o=[];for(let f of e){let y=t.get(f),g=this.constructorParams.nodeEdgeMap.get(f)??[];for(let x of g){let v=x.nodeIds.find(P=>P!==f);if(this.sectionNodeIdSet.has(v)){let P=[y,t.get(v)].sort(),w=`${P[0]}-${P[1]}`;s.has(w)||(o.push(P),s.add(w))}}}o.sort((f,y)=>f[0]!==y[0]?f[0].localeCompare(y[0]):f[1].localeCompare(y[1]));let a={},c=new Map,l=new Map;for(let f of this.constructorParams.sectionConnectionTerminals){let y=t.get(f.startNodeId),g=t.get(f.endNodeId),[x,v]=[y,g].sort(),P=`${x}->${v}`,w=l.get(P)??0;l.set(P,w+1);let k=`${x}->${v}::${w}`;a[k]={start:x,end:v},c.set(k,f.connectionName)}let u=`capacitypathing:${(0,vZ.default)({node_capacity_map:r,node_edge_map:o,terminals:a})}`,p={cacheSpaceToRealConnectionId:c,cacheSpaceToRealNodeId:i};return this.cacheKey=u,this.cacheToSolveSpaceTransform=p,{cacheKey:u,cacheToSolveSpaceTransform:p}}applyCachedSolution(e){if(!this.cacheToSolveSpaceTransform)return console.error("Cache transform not available, cannot apply cached solution."),void(this.failed=!0);if(!e.success)return this.failed=!0,void(this.cacheHit=!0);this.cachedSectionConnectionTerminals=[];let{cacheSpaceToRealNodeId:t,cacheSpaceToRealConnectionId:i}=this.cacheToSolveSpaceTransform;for(let[r,s]of Object.entries(e.solutionPaths)){let o=i.get(r);if(!o){console.warn(`Could not find real connection name for ${r}`);continue}let a=this.constructorParams.sectionConnectionTerminals.find(l=>l.connectionName===o);if(!a){console.warn(`Could not find original terminal for connection name ${o}`);continue}let c=s.map(l=>{let u=t.get(l);if(!u)throw new Error(`Could not map cache node ID ${l} to real node ID for connection ${o}`);let p=this.constructorParams.nodeMap.get(u);if(!p)throw new Error(`Could not find node with ID ${u} in nodeMap for connection ${o}`);return p});this.cachedSectionConnectionTerminals.push({...a,path:c})}this.sectionScore=e.sectionScore,this.solved=!0,this.cacheHit=!0}attemptToUseCacheSync(){if(this.hasAttemptedToUseCache=!0,!this.cacheProvider?.isSyncCache)return console.log("Cache provider is not synchronous, skipping sync cache check."),!1;if(this.cacheKey||this.computeCacheKeyAndTransform(),!this.cacheKey)return console.error("Failed to compute cache key."),!1;try{let e=this.cacheProvider.getCachedSolutionSync(this.cacheKey);if(e)return this.applyCachedSolution(e),!0}catch(e){console.error("Error attempting to use cache:",e)}return!1}saveToCacheSync(){if(!this.cacheKey)return void console.error("Cannot save to cache without cache key.");if(!this.cacheToSolveSpaceTransform)return void console.error("Cache transform not available, cannot save solution to cache.");let e;if(this.failed)e={success:!1};else{if(!this.solved)return;{let t={},{cacheSpaceToRealNodeId:i,cacheSpaceToRealConnectionId:r}=this.cacheToSolveSpaceTransform,s=new Map;for(let[c,l]of i)s.set(l,c);let o=new Map;for(let[c,l]of r)o.set(l,c);let a=[];if(super.sectionConnectionTerminals){for(let c of super.sectionConnectionTerminals)if(c.path&&c.path.length>0){let l=c.path.map(u=>u.capacityMeshNodeId);a.push([c.connectionName,l])}}for(let[c,l]of a){let u=o.get(c);if(!u){console.warn(`Could not find cache space connection ID for ${c} when saving to cache.`);continue}let p=l.map(f=>{let y=s.get(f);if(!y)throw new Error(`Could not map real node ID ${f} to cache node ID for connection ${c} when saving to cache.`);return y});t[u]=p}e={success:!0,sectionScore:this.sectionScore,solutionPaths:t}}}try{this.cacheProvider?.setCachedSolutionSync(this.cacheKey,e)}catch(t){console.error("Error saving solution to cache:",t)}}get sectionConnectionTerminals(){return this.cacheHit&&this.solved&&this.cachedSectionConnectionTerminals?(console.log("returning the cached section connection terminals"),this.cachedSectionConnectionTerminals):super.sectionConnectionTerminals}visualize(){return this.cacheHit?V4({sectionNodes:this.constructorParams.sectionNodes,sectionEdges:this.constructorParams.sectionEdges,sectionConnectionTerminals:this.cachedSectionConnectionTerminals,completedPaths:this.cachedSectionConnectionTerminals.map(e=>({connectionName:e.connectionName,path:e.path})),nodeMap:this.constructorParams.nodeMap,colorMap:this.constructorParams.colorMap,title:"CachedHyperCapacityPathingSingleSectionSolver"}):super.visualize()}},OCt=class extends an{constructor(e){super();d(this,"simpleRouteJson");d(this,"nodes");d(this,"edges");d(this,"nodeEdgeMap");d(this,"connectionsWithNodes",[]);d(this,"colorMap");d(this,"initialSolver");d(this,"cacheProvider");d(this,"stage","initialization");d(this,"nodeMap",new Map);d(this,"allNodeIdsSet");d(this,"usedNodeCapacityMap",new Map);d(this,"totalNodeCapacityMap",new Map);d(this,"nodeCapacityPercentMap",new Map);d(this,"nodeOptimizationAttemptCountMap",new Map);d(this,"currentSection",null);d(this,"sectionSolver",null);d(this,"currentScheduleIndex",0);d(this,"stats");d(this,"OPTIMIZATION_SCHEDULE",[{MAX_ATTEMPTS_PER_NODE:1,MAX_EXPANSION_DEGREES:3,MINIMUM_PROBABILITY_OF_FAILURE_TO_OPTIMIZE:.05},{MAX_ATTEMPTS_PER_NODE:2,MAX_EXPANSION_DEGREES:5,MINIMUM_PROBABILITY_OF_FAILURE_TO_OPTIMIZE:.2},{MAX_ATTEMPTS_PER_NODE:3,MAX_EXPANSION_DEGREES:7,MINIMUM_PROBABILITY_OF_FAILURE_TO_OPTIMIZE:.9}]);this.stats={successfulOptimizations:0,failedOptimizations:0,failedSectionSolvers:0,startingScore:0,scheduleScores:this.OPTIMIZATION_SCHEDULE.map(({MAX_EXPANSION_DEGREES:t})=>({maxExpansionDegrees:t,endingScore:0,endingHighestNodePf:0,sectionAttempts:0})),cacheHits:0,cacheMisses:0},this.MAX_ITERATIONS=e.MAX_ITERATIONS??1e7,this.cacheProvider=e.cacheProvider,this.simpleRouteJson=e.simpleRouteJson,this.nodes=e.nodes,this.edges=e.edges,this.nodeEdgeMap=d_(this.edges),this.colorMap=e.colorMap??{},this.nodeMap=new Map(this.nodes.map(t=>[t.capacityMeshNodeId,t])),this.nodeEdgeMap=d_(this.edges),this.initialSolver=e.initialPathingSolver||new bZ({simpleRouteJson:this.simpleRouteJson,nodes:this.nodes,edges:this.edges,colorMap:this.colorMap}),this.activeSubSolver=this.initialSolver;for(let t of this.nodes){let i=this.initialSolver.getTotalCapacity(t);this.totalNodeCapacityMap.set(t.capacityMeshNodeId,i)}this.allNodeIdsSet=new Set(this.nodes.map(t=>t.capacityMeshNodeId))}get currentSchedule(){return this.OPTIMIZATION_SCHEDULE[this.currentScheduleIndex]??null}_stepInitialization(){if(this.initialSolver?.step(),this.initialSolver?.failed)return this.failed=!0,void(this.error=this.initialSolver.error);if(this.initialSolver?.solved){this.usedNodeCapacityMap=new Map(this.initialSolver.usedNodeCapacityMap);for(let e of this.nodes){let t=this.totalNodeCapacityMap.get(e.capacityMeshNodeId)??0,i=this.usedNodeCapacityMap.get(e.capacityMeshNodeId)??0,r=t>0?i/t:0;this.nodeCapacityPercentMap.set(e.capacityMeshNodeId,r),this.nodeOptimizationAttemptCountMap.set(e.capacityMeshNodeId,0)}this.connectionsWithNodes=this.initialSolver.connectionsWithNodes,this.stats.startingScore=$g({totalNodeCapacityMap:this.totalNodeCapacityMap,usedNodeCapacityMap:this.usedNodeCapacityMap,nodeMap:this.nodeMap,sectionNodeIds:this.allNodeIdsSet}),this.stage="section-optimization"}}_getNextNodeToOptimize(){let e=0,t=0,i=null;for(let r of this.nodes){if(r._containsTarget)continue;let s=this.nodeOptimizationAttemptCountMap.get(r.capacityMeshNodeId),o=this.totalNodeCapacityMap.get(r.capacityMeshNodeId),a=qS(this.usedNodeCapacityMap.get(r.capacityMeshNodeId)??0,o,r.availableZ.length),c=a/(s+1);s<this.currentSchedule.MAX_ATTEMPTS_PER_NODE&&c>e&&a>this.currentSchedule.MINIMUM_PROBABILITY_OF_FAILURE_TO_OPTIMIZE&&(e=c,t=a,i=r.capacityMeshNodeId)}return i}getOverallScore(){let e=0;for(let t of this.nodes){if(t._containsTarget)continue;let i=this.totalNodeCapacityMap.get(t.capacityMeshNodeId),r=qS(this.usedNodeCapacityMap.get(t.capacityMeshNodeId)??0,i,t.availableZ.length);r>e&&(e=r)}return{highestNodePf:e,score:$g({totalNodeCapacityMap:this.totalNodeCapacityMap,usedNodeCapacityMap:this.usedNodeCapacityMap,nodeMap:this.nodeMap,sectionNodeIds:this.allNodeIdsSet})}}_stepSectionOptimization(){if(!this.sectionSolver){let e=this._getNextNodeToOptimize();if(!e){let{highestNodePf:i,score:r}=this.getOverallScore();return this.stats.scheduleScores[this.currentScheduleIndex].endingHighestNodePf=i,this.stats.scheduleScores[this.currentScheduleIndex].endingScore=r,this.currentScheduleIndex++,void(this.currentSchedule||(this.solved=!0))}let t=(i=>{let{centerNodeId:r,connectionsWithNodes:s,nodeMap:o,edges:a,nodeEdgeMap:c,expansionDegrees:l}=i,u=new Set,p=[{nodeId:r,depth:0}];u.add(r);let f=0;for(;f<p.length;){let{nodeId:v,depth:P}=p[f++];if(P>=l)continue;let w=c.get(v)?.flatMap(k=>k.nodeIds.filter(T=>T!==v))??[];for(let k of w)u.has(k)||(u.add(k),p.push({nodeId:k,depth:P+1}))}let y=Array.from(u).map(v=>o.get(v)),g=a.filter(v=>{let[P,w]=v.nodeIds;return u.has(P)&&u.has(w)}),x=[];for(let v of s){if(!v.path)continue;let P=null,w=null;for(let k of v.path)if(u.has(k.capacityMeshNodeId)){P=k.capacityMeshNodeId;break}for(let k=v.path.length-1;k>=0;k--){let T=v.path[k];if(u.has(T.capacityMeshNodeId)){w=T.capacityMeshNodeId;break}}P&&w&&x.push({connectionName:v.connection.name,startNodeId:P,endNodeId:w})}return{sectionConnectionTerminals:x,sectionNodes:y,sectionEdges:g,centerNodeId:r}})({centerNodeId:e,connectionsWithNodes:this.connectionsWithNodes,nodeMap:this.nodeMap,edges:this.edges,expansionDegrees:this.currentSchedule.MAX_EXPANSION_DEGREES,nodeEdgeMap:this.nodeEdgeMap});this.stats.scheduleScores[this.currentScheduleIndex].sectionAttempts++,this.currentSection=t,this.sectionSolver=new RCt({sectionNodes:this.currentSection.sectionNodes,sectionEdges:this.currentSection.sectionEdges,sectionConnectionTerminals:this.currentSection.sectionConnectionTerminals,colorMap:this.colorMap,centerNodeId:this.currentSection.centerNodeId,nodeEdgeMap:this.nodeEdgeMap,hyperParameters:{EXPANSION_DEGREES:this.currentSchedule.MAX_EXPANSION_DEGREES},cacheProvider:this.cacheProvider}),this.activeSubSolver=this.sectionSolver,this.nodeOptimizationAttemptCountMap.set(e,(this.nodeOptimizationAttemptCountMap.get(e)??0)+1)}if(this.sectionSolver.step(),(this.sectionSolver.failed||this.sectionSolver.solved)&&(this.sectionSolver.cacheHit?this.stats.cacheHits++:this.stats.cacheMisses++),this.sectionSolver.failed)return console.warn(`Section solver failed for node ${this.currentSection.centerNodeId}. Error: ${this.sectionSolver.error}`),this.stats.failedSectionSolvers++,this.stats.failedOptimizations++,this.sectionSolver=null,void(this.activeSubSolver=null);if(this.sectionSolver.solved){let e=this.sectionSolver.sectionConnectionTerminals,t=this.sectionSolver.sectionNodes,i=this.sectionSolver.centerNodeId;if(this.sectionSolver=null,this.activeSubSolver=null,!e)return void console.warn(`Pathing sub-solver for section ${this.currentSection.centerNodeId} did not complete successfully. Discarding results.`);let r=new Set(t.map(c=>c.capacityMeshNodeId)),s=$g({totalNodeCapacityMap:this.totalNodeCapacityMap,usedNodeCapacityMap:this.usedNodeCapacityMap,nodeMap:this.nodeMap,sectionNodeIds:r}),o=new Map(this.usedNodeCapacityMap),a=e;for(let c of a){let l=this.connectionsWithNodes.find(u=>u.connection.name===c.connectionName);if(l?.path){for(let u of l.path)if(r.has(u.capacityMeshNodeId)){let p=o.get(u.capacityMeshNodeId)??0;o.set(u.capacityMeshNodeId,Math.max(0,p-1))}}}for(let c of a)if(c.path)for(let l of c.path)r.has(l.capacityMeshNodeId)&&o.set(l.capacityMeshNodeId,(o.get(l.capacityMeshNodeId)??0)+1);$g({totalNodeCapacityMap:this.totalNodeCapacityMap,usedNodeCapacityMap:o,nodeMap:this.nodeMap,sectionNodeIds:r})>s?(this.stats.successfulOptimizations++,this._mergeSolvedSectionPaths({centerNodeId:i,sectionConnectionTerminals:e}),this._recalculateNodeCapacityUsage()):this.stats.failedOptimizations++}}_mergeSolvedSectionPaths({centerNodeId:e,sectionConnectionTerminals:t}){for(let i of t){if(!i.path){console.warn(`No path found for connection ${i.connectionName} in section ${e}`);continue}let r=this.connectionsWithNodes.find(g=>g.connection.name===i.connectionName);if(!r||!r.path){console.warn(`Original connection or path not found for ${i.connectionName} while merging section ${e}`);continue}let s=r.path,o=i.path,a=s.findIndex(g=>g.capacityMeshNodeId===i.startNodeId),c=s.findIndex(g=>g.capacityMeshNodeId===i.endNodeId);if(a===-1||c===-1){console.warn(`Could not find start/end nodes (${i.startNodeId}/${i.endNodeId}) in original path for ${i.connectionName}`);continue}let[l,u]=a<=c?[a,c]:[c,a],p=s.slice(0,l),f=s.slice(u+1),y=o;if(o.length>0&&s[l]&&o[0].capacityMeshNodeId!==s[l].capacityMeshNodeId){if(o[o.length-1].capacityMeshNodeId!==s[l].capacityMeshNodeId){console.warn(`New section path for ${i.connectionName} doesn't align with original path boundaries. Skipping merge for this connection.`);continue}y=[...o].reverse()}r.path=[...p,...y,...f]}}_recalculateNodeCapacityUsage(){this.usedNodeCapacityMap.clear();for(let e of this.connectionsWithNodes)if(e.path)for(let t of e.path)this.usedNodeCapacityMap.set(t.capacityMeshNodeId,(this.usedNodeCapacityMap.get(t.capacityMeshNodeId)??0)+1);for(let e of this.nodes){let t=this.totalNodeCapacityMap.get(e.capacityMeshNodeId)??0,i=this.usedNodeCapacityMap.get(e.capacityMeshNodeId)??0,r=t>0?i/t:0;this.nodeCapacityPercentMap.set(e.capacityMeshNodeId,r)}}getCapacityPaths(){let e=[];for(let t of this.connectionsWithNodes){let i=t.path;i&&e.push({capacityPathId:t.connection.name,connectionName:t.connection.name,nodeIds:i.map(r=>r.capacityMeshNodeId)})}return e}_step(){this.iterations>=this.MAX_ITERATIONS-1?this.solved=!0:this.stage==="initialization"?this._stepInitialization():this.stage==="section-optimization"&&this._stepSectionOptimization()}visualize(){let e=this.connectionsWithNodes.filter(t=>t.path&&t.path.length>0).map(t=>({connectionName:t.connection.name,path:t.path}));return V4({nodeMap:this.nodeMap,sectionConnectionTerminals:this.connectionsWithNodes.map(t=>({connectionName:t.connection.name,startNodeId:t.path?.[0]?.capacityMeshNodeId,endNodeId:t.path?.[t.path.length-1]?.capacityMeshNodeId})),completedPaths:e,sectionNodes:this.nodes,sectionEdges:this.edges,colorMap:this.colorMap,totalCapacityMap:this.totalNodeCapacityMap,usedNodeCapacityMap:this.usedNodeCapacityMap,nodeOpacity:.05,title:"Capacity Pathing Multi-Section Solver (Solved)"})}},LCt=class extends an{constructor(e){super();d(this,"multiLayerNodes");d(this,"strawNodes");d(this,"skippedNodes");d(this,"unprocessedNodes");d(this,"strawSize");d(this,"nodeIdCounter");this.MAX_ITERATIONS=1e5,this.strawSize=e.strawSize??.5,this.multiLayerNodes=[],this.strawNodes=[],this.skippedNodes=[],this.nodeIdCounter=0,this.unprocessedNodes=[];for(let t of e.nodes)t.availableZ.length===1?this.unprocessedNodes.push(t):this.multiLayerNodes.push(t)}getCapacityOfMultiLayerNodesWithinBounds(e){let t=0;for(let i of this.multiLayerNodes){let r=i.center.x-i.width/2,s=i.center.x+i.width/2,o=i.center.y-i.height/2,a=i.center.y+i.height/2,c=Math.max(e.minX,r),l=Math.min(e.maxX,s),u=Math.max(e.minY,o),p=Math.min(e.maxY,a);if(c<l&&u<p){let f=(l-c)*(p-u)/(i.width*i.height);t+=oo(i)*f}}return t}getSurroundingCapacities(e){let t=Math.min(e.width,e.height);return{leftSurroundingCapacity:this.getCapacityOfMultiLayerNodesWithinBounds({minX:e.center.x-e.width/2-t,maxX:e.center.x-e.width/2,minY:e.center.y-e.height/2,maxY:e.center.y+e.height/2}),rightSurroundingCapacity:this.getCapacityOfMultiLayerNodesWithinBounds({minX:e.center.x+e.width/2,maxX:e.center.x+e.width/2+t,minY:e.center.y-e.height/2,maxY:e.center.y+e.height/2}),topSurroundingCapacity:this.getCapacityOfMultiLayerNodesWithinBounds({minX:e.center.x-e.width/2,maxX:e.center.x+e.width/2,minY:e.center.y-e.height/2-t,maxY:e.center.y-e.height/2}),bottomSurroundingCapacity:this.getCapacityOfMultiLayerNodesWithinBounds({minX:e.center.x-e.width/2,maxX:e.center.x+e.width/2,minY:e.center.y+e.height/2,maxY:e.center.y+e.height/2+t})}}createStrawsForNode(e){let t=[],{leftSurroundingCapacity:i,rightSurroundingCapacity:r,topSurroundingCapacity:s,bottomSurroundingCapacity:o}=this.getSurroundingCapacities(e);if(1*(i+r)>s+o){let a=Math.floor(e.height/this.strawSize),c=e.height/a;for(let l=0;l<a;l++){let u=e.center.y-e.height/2+l*c+c/2;t.push({capacityMeshNodeId:`${e.capacityMeshNodeId}_straw${l}`,center:{x:e.center.x,y:u},width:e.width,height:c,layer:e.layer,availableZ:[...e.availableZ],_depth:e._depth,_strawNode:!0,_strawParentCapacityMeshNodeId:e.capacityMeshNodeId})}}else{let a=Math.floor(e.width/this.strawSize),c=e.width/a;for(let l=0;l<a;l++){let u=e.center.x-e.width/2+l*c+c/2;t.push({capacityMeshNodeId:`${e.capacityMeshNodeId}_straw${l}`,center:{x:u,y:e.center.y},width:c,height:e.height,layer:e.layer,availableZ:[...e.availableZ],_depth:e._depth,_strawNode:!0,_strawParentCapacityMeshNodeId:e.capacityMeshNodeId})}}return t}getResultNodes(){return[...this.multiLayerNodes,...this.strawNodes,...this.skippedNodes]}_step(){let e=this.unprocessedNodes.pop();if(!e)return void(this.solved=!0);if(e.width<this.strawSize&&e.height<this.strawSize)return void this.skippedNodes.push(e);if(e._containsTarget)return void this.skippedNodes.push(e);let t=this.createStrawsForNode(e);this.strawNodes.push(...t)}visualize(){let e={rects:[],lines:[],points:[],circles:[],title:"Straw Solver"};for(let t of this.unprocessedNodes)e.rects.push({center:t.center,width:t.width,height:t.height,fill:"rgba(200, 200, 200, 0.5)",stroke:"rgba(0, 0, 0, 0.5)",label:`${t.capacityMeshNodeId}
Unprocessed
${t.width}x${t.height}`});for(let t of this.strawNodes){let i=t.availableZ[0]===0?"rgba(0, 150, 255, 0.5)":"rgba(255, 100, 0, 0.5)";e.rects.push({center:t.center,width:t.width,height:t.height,fill:i,stroke:"rgba(0, 0, 0, 0.5)",label:`${t.capacityMeshNodeId}
Layer: ${t.availableZ[0]}
${t.width}x${t.height}`,layer:`z${t.availableZ.join(",")}`})}for(let t of this.multiLayerNodes)e.rects.push({center:t.center,width:.9*t.width,height:.9*t.height,fill:"rgba(100, 255, 100, 0.5)",stroke:"rgba(0, 0, 0, 0.5)",layer:`z${t.availableZ.join(",")}`,label:`${t.capacityMeshNodeId}
Layers: ${t.availableZ.join(",")}
${t.width}x${t.height}`});return e}};function tw(n,e){let t=n.center.x-n.width/2,i=n.center.x+n.width/2,r=n.center.y-n.height/2,s=n.center.y+n.height/2,o=e.center.x-e.width/2,a=e.center.x+e.width/2,c=e.center.y-e.height/2,l=e.center.y+e.height/2,u=.001,p=(Math.abs(i-o)<u||Math.abs(t-a)<u)&&Math.min(s,l)-Math.max(r,c)>=u,f=(Math.abs(s-c)<u||Math.abs(r-l)<u)&&Math.min(i,a)-Math.max(t,o)>=u;return p||f}var G4=class{constructor(n){d(this,"buckets");d(this,"CELL_SIZE",.4);this.nodes=n,this.buckets=new Map;for(let e of n){let t=e.center.x-e.width/2,i=e.center.y-e.height/2,r=e.center.x+e.width/2,s=e.center.y+e.height/2;for(let o=t;o<=r;o+=this.CELL_SIZE)for(let a=i;a<=s;a+=this.CELL_SIZE){let c=this.getBucketKey(o,a),l=this.buckets.get(c);l?l.push(e):this.buckets.set(c,[e])}}}getBucketKey(n,e){return`${Math.floor(n/this.CELL_SIZE)}x${Math.floor(e/this.CELL_SIZE)}`}getNodesInArea(n,e,t,i){let r=[],s=new Set,o=e-i/2,a=n+t/2,c=e+i/2;for(let l=n-t/2;l<=a;l+=this.CELL_SIZE)for(let u=o;u<=c;u+=this.CELL_SIZE){let p=this.getBucketKey(l,u),f=this.buckets.get(p)||[];for(let y of f)s.has(y.capacityMeshNodeId)||(s.add(y.capacityMeshNodeId),r.push(y))}return r}},zS=.005,FCt=class extends an{constructor(e){super();d(this,"nodeMap");d(this,"currentBatchNodeIds");d(this,"absorbedNodeIds");d(this,"nextBatchNodeIds");d(this,"batchHadModifications");d(this,"hasComputedAdjacentNodeIds",!1);d(this,"newNodes");this.nodeMap=new Map,this.MAX_ITERATIONS=1e5;for(let i of e)this.nodeMap.set(i.capacityMeshNodeId,i);this.newNodes=[],this.absorbedNodeIds=new Set;let t=[];for(let i of e)i.availableZ.length>1?(this.newNodes.push(i),this.absorbedNodeIds.add(i.capacityMeshNodeId)):t.push([i,i.width*i.height]);t.sort((i,r)=>i[1]-r[1]);for(let[i,r]of t){let s={...i,center:{...i.center}};this.nodeMap.set(i.capacityMeshNodeId,s)}this.currentBatchNodeIds=t.map(([i])=>i.capacityMeshNodeId),this.nextBatchNodeIds=[],this.batchHadModifications=!1}computeAdjacentNodeIdsForFirstBatch(e){let t=Math.max(...e.map(r=>Math.max(...r.availableZ))),i=[];for(let r=0;r<=t;r++)i.push(new G4(e.filter(s=>s.availableZ[0]===r)));for(let r of e){let s=[],o=i[r.availableZ[0]].getNodesInArea(r.center.x,r.center.y,4*r.width,4*r.height);for(let a of o)a._containsTarget&&a._targetConnectionName!==r._targetConnectionName||r._containsTarget&&(!a._containsTarget||a._targetConnectionName!==r._targetConnectionName)||a.capacityMeshNodeId!==r.capacityMeshNodeId&&tw(r,a)&&s.push(a);r._adjacentNodeIds=s.map(a=>a.capacityMeshNodeId)}}getAdjacentSameLayerUnprocessedNodes(e){return this.getAdjacentSameLayerUnprocessedNodes2(e)}getAdjacentSameLayerUnprocessedNodes2(e){let t=[],i=Array.from(new Set((e._adjacentNodeIds??[]).map(r=>this.nodeMap.get(r)))).filter(r=>r&&r.capacityMeshNodeId!==e.capacityMeshNodeId);i.sort((r,s)=>r.width*r.height-s.width*s.height);for(let r of i)this.absorbedNodeIds.has(r.capacityMeshNodeId)||t.push(r);return t}_step(){this.hasComputedAdjacentNodeIds||(this.computeAdjacentNodeIdsForFirstBatch(this.currentBatchNodeIds.map(u=>this.nodeMap.get(u))),this.hasComputedAdjacentNodeIds=!0);let e=this.currentBatchNodeIds.pop();for(;e&&this.absorbedNodeIds.has(e);)e=this.currentBatchNodeIds.pop();if(!e)return this.batchHadModifications?(this.currentBatchNodeIds=this.nextBatchNodeIds.sort((u,p)=>{let f=this.nodeMap.get(u),y=this.nodeMap.get(p);return f.width*f.height-y.width*y.height}),this.nextBatchNodeIds=[],void(this.batchHadModifications=!1)):(this.solved=!0,void this.newNodes.push(...this.nextBatchNodeIds.map(u=>this.nodeMap.get(u))));let t=this.nodeMap.get(e),i=!1,r=this.getAdjacentSameLayerUnprocessedNodes(t);if(r.length===0)return void this.nextBatchNodeIds.push(e);let s=u=>{for(let p of u)this.absorbedNodeIds.add(p.capacityMeshNodeId);t._adjacentNodeIds=Array.from(new Set([...t._adjacentNodeIds??[],...u.flatMap(p=>p._adjacentNodeIds??[])].filter(p=>p!==t.capacityMeshNodeId&&!this.absorbedNodeIds.has(p))))},o=r.filter(u=>u.center.x<t.center.x&&Math.abs(u.center.y-t.center.y)<t.height/2);if(o.length>0){let{width:u,height:p}=o[0],f=o.every(y=>y.width===u&&y.height===p);Math.abs(o.reduce((y,g)=>y+g.height,0)-t.height)<zS&&f&&(t.width+=u,t.center.x=t.center.x-u/2,s(o),i=!0)}let a=r.filter(u=>u.center.x>t.center.x&&Math.abs(u.center.y-t.center.y)<t.height/2);if(a.length>0&&!i){let{width:u,height:p}=a[0],f=a.every(y=>y.width===u&&y.height===p);Math.abs(a.reduce((y,g)=>y+g.height,0)-t.height)<zS&&f&&(t.width+=u,t.center.x=t.center.x+u/2,s(a),i=!0)}let c=r.filter(u=>u.center.y>t.center.y&&Math.abs(u.center.x-t.center.x)<t.width/2);if(c.length>0&&!i){let{width:u,height:p}=c[0],f=c.every(y=>y.width===u&&y.height===p);Math.abs(c.reduce((y,g)=>y+g.width,0)-t.width)<zS&&f&&(t.height+=p,t.center.y=t.center.y+p/2,s(c),i=!0)}let l=r.filter(u=>u.center.y<t.center.y&&Math.abs(u.center.x-t.center.x)<t.width/2);if(l.length>0&&!i){let{width:u,height:p}=l[0],f=l.every(y=>y.width===u&&y.height===p);Math.abs(l.reduce((y,g)=>y+g.width,0)-t.width)<zS&&f&&(t.height+=p,t.center.y=t.center.y-p/2,s(l),i=!0)}i?(this.batchHadModifications=!0,this.currentBatchNodeIds.push(e)):this.nextBatchNodeIds.unshift(e)}visualize(){let e={circles:[],lines:[],points:[],rects:[],coordinateSystem:"cartesian",title:"Same Layer Node Merger"};for(let r of this.newNodes)e.rects.push(so(r));let t=this.currentBatchNodeIds[this.currentBatchNodeIds.length-1],i;t&&(i=this.getAdjacentSameLayerUnprocessedNodes(this.nodeMap.get(t)));for(let r of this.currentBatchNodeIds){let s=this.nodeMap.get(r);if(!this.absorbedNodeIds.has(r)&&s){let o=so(s,{rectMargin:.01});r===t?o.stroke="rgba(0, 255, 0, 0.8)":i?.some(a=>a.capacityMeshNodeId===r)?o.stroke="rgba(128, 0, 128, 0.8)":o.stroke="rgba(255, 165, 0, 0.8)",o.layer=`z${s.availableZ.join(",")}`,o.label=`${o.label}
(unprocessed)`,e.rects.push(o)}}for(let r of this.nextBatchNodeIds){let s=this.nodeMap.get(r);if(!this.absorbedNodeIds.has(r)&&s){let o=so(s,{rectMargin:.01});o.layer=`z${s.availableZ.join(",")}`,o.stroke="rgba(0, 217, 255, 0.8)",o.label=`${o.label}
x: ${s.center.x}, y: ${s.center.y}
${s.width}x${s.height}
(next batch)`,e.rects.push(o)}}return e}},zCt=class extends an{constructor(e){super();d(this,"newRoute");d(this,"newVias");d(this,"headIndex",0);d(this,"tailIndex",0);d(this,"inputRoute");d(this,"otherHdRoutes");d(this,"obstacles");d(this,"connMap");d(this,"colorMap");d(this,"outline");this.inputRoute=e.inputRoute,this.otherHdRoutes=e.otherHdRoutes,this.obstacles=e.obstacles,this.connMap=e.connMap,this.colorMap=e.colorMap,this.outline=e.outline,this.newRoute=[this.inputRoute.route[0]],this.newVias=[]}getConstructorParams(){return{inputRoute:this.inputRoute,otherHdRoutes:this.otherHdRoutes,obstacles:this.obstacles,connMap:this.connMap.netMap,colorMap:this.colorMap,outline:this.outline}}get simplifiedRoute(){return{connectionName:this.inputRoute.connectionName,traceThickness:this.inputRoute.traceThickness,viaDiameter:this.inputRoute.viaDiameter,route:this.newRoute,vias:this.newVias}}isValidPath(e){throw new Error("Not implemented")}_step(){throw new Error("Not implemented")}getVisualsForNewRouteAndObstacles(){let e={lines:[],points:[],circles:[],rects:[],coordinateSystem:"cartesian",title:"Simplified Path Solver"};for(let t=0;t<this.inputRoute.route.length-1;t++)e.lines.push({points:[{x:this.inputRoute.route[t].x,y:this.inputRoute.route[t].y},{x:this.inputRoute.route[t+1].x,y:this.inputRoute.route[t+1].y}],strokeColor:"rgba(255, 0, 0, 0.8)",strokeDash:this.inputRoute.route[t].z===1?"5, 5":void 0,layer:`z${this.inputRoute.route[t].z.toString()}`});for(let t=0;t<this.newRoute.length;t++)t<this.newRoute.length-1&&e.lines.push({points:[{x:this.newRoute[t].x,y:this.newRoute[t].y},{x:this.newRoute[t+1].x,y:this.newRoute[t+1].y}],strokeWidth:.15,strokeColor:"rgba(0, 255, 0, 0.8)",strokeDash:this.newRoute[t].z===1?[.4,.4]:void 0,layer:`z${this.newRoute[t].z.toString()}`}),e.points.push({x:this.newRoute[t].x,y:this.newRoute[t].y,color:"rgba(0, 255, 0, 0.8)",label:`z: ${this.newRoute[t].z}`,layer:`z${this.newRoute[t].z.toString()}`});for(let t of this.newVias)e.circles.push({center:t,radius:this.inputRoute.viaDiameter/2,fill:"rgba(0, 0, 255, 0.5)"});for(let t of this.obstacles)e.rects.push({center:t.center,width:t.width,height:t.height,fill:t.layers?.includes("top")?"rgba(255, 0, 0, 0.3)":t.layers?.includes("bottom")?"rgba(0, 0, 255, 0.3)":"rgba(128, 128, 128, 0.3)"});for(let t of this.otherHdRoutes)for(let i=0;i<t.route.length-1;i++)e.lines.push({points:[{x:t.route[i].x,y:t.route[i].y},{x:t.route[i+1].x,y:t.route[i+1].y}],strokeWidth:.15,strokeColor:t.route[i].z===0?"rgba(255, 0, 255, 0.5)":t.route[i].z===1?"rgba(128, 0, 128, 0.5)":"rgba(0, 0, 255, 0.5)",layer:`z${t.route[i].z.toString()}`});if("filteredObstaclePathSegments"in this){let t=this.filteredObstaclePathSegments;for(let[i,r]of t)e.lines.push({points:[i,r]})}return e}};function $q(n,e,t,i){if((function(c,l,u,p){let f=DS(c,l,u),y=DS(c,l,p),g=DS(u,p,c),x=DS(u,p,l);return f!==y&&g!==x||!(f!==0||!jS(c,u,l))||!(y!==0||!jS(c,p,l))||!(g!==0||!jS(u,c,p))||!(x!==0||!jS(u,l,p))})(n,e,t,i))return 0;let r=$S(n,t,i),s=$S(e,t,i),o=$S(t,n,e),a=$S(i,n,e);return Math.min(r,s,o,a)}function $S(n,e,t){let i={x:t.x-e.x,y:t.y-e.y},r=Dq({x:n.x-e.x,y:n.y-e.y},i);if(r<=0)return I4(n,e);let s=Dq(i,i);if(s<=r)return I4(n,t);let o=r/s;return I4(n,{x:e.x+o*i.x,y:e.y+o*i.y})}function Dq(n,e){return n.x*e.x+n.y*e.y}function I4(n,e){let t=e.x-n.x,i=e.y-n.y;return Math.sqrt(t*t+i*i)}function DS(n,e,t){let i=(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y);return i===0?0:i>0?1:2}function jS(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}var $Ct=n=>({minX:Math.min(n[0].x,n[1].x),maxX:Math.max(n[0].x,n[1].x),minY:Math.min(n[0].y,n[1].y),maxY:Math.max(n[0].y,n[1].y)}),DCt=class{constructor(n){d(this,"buckets");d(this,"CELL_SIZE",.4);d(this,"SEGMENT_MARGIN",.4);this.segments=n,this.buckets=new Map;let e=new Map;for(let t of n){let i=this.getSegmentKey(t);if(e.has(i))continue;e.set(i,t);let r=$Ct(t),s=Math.floor(r.minX/this.CELL_SIZE),o=Math.floor(r.maxX/this.CELL_SIZE),a=Math.floor(r.minY/this.CELL_SIZE),c=Math.floor(r.maxY/this.CELL_SIZE);for(let l=s;l<=o;l++)for(let u=a;u<=c;u++){let p=`${l}x${u}`,f=this.buckets.get(p),y=[t[0],t[1],i];f?f.push(y):this.buckets.set(p,[y])}}}getBucketKey(n,e){return`${Math.floor(n/this.CELL_SIZE)}x${Math.floor(e/this.CELL_SIZE)}`}getSegmentKey(n){return`${n[0].x}-${n[0].y}-${n[0].z}-${n[1].x}-${n[1].y}-${n[1].z}`}getSegmentsThatCouldIntersect(n,e){let t=[],i=new Set,r=Math.min(n.x,e.x)-this.SEGMENT_MARGIN,s=Math.min(n.y,e.y)-this.SEGMENT_MARGIN,o=Math.max(n.x,e.x)+this.SEGMENT_MARGIN,a=Math.max(n.y,e.y)+this.SEGMENT_MARGIN,c=Math.floor(r/this.CELL_SIZE),l=Math.floor(o/this.CELL_SIZE),u=Math.floor(s/this.CELL_SIZE),p=Math.floor(a/this.CELL_SIZE);for(let f=c;f<=l;f++)for(let y=u;y<=p;y++){let g=`${f}x${y}`,x=this.buckets.get(g);if(x)for(let v of x){let P=v[2];i.has(P)||(i.add(P),t.push(v))}}return t}},ZS=1e-6,B4=(n,e,t)=>_r(n,e,t)<=ZS,BS=(n,e)=>Math.abs(n.x-e.x)<=ZS&&Math.abs(n.y-e.y)<=ZS,jq=(n,e)=>{if(!e||e.length<3)return!1;for(let i=0;i<e.length;i++){let r=e[i],s=e[(i+1)%e.length];if(B4(n,r,s))return!0}let t=!1;for(let i=0,r=e.length-1;i<e.length;r=i++){let s=e[i],o=e[r];s.y>n.y!=o.y>n.y&&n.x<(o.x-s.x)*(n.y-s.y)/(o.y-s.y)+s.x&&(t=!t)}return t},jCt=class extends zCt{constructor(e){super(e);d(this,"pathSegments",[]);d(this,"totalPathLength",0);d(this,"headDistanceAlongPath",0);d(this,"tailDistanceAlongPath",0);d(this,"minStepSize",.25);d(this,"lastValidPath",null);d(this,"lastValidPathHeadDistance",0);d(this,"STEP_SIZE_REDUCTION_FACTOR",.25);d(this,"maxStepSize",4);d(this,"currentStepSize",this.maxStepSize);d(this,"lastHeadMoveDistance",0);d(this,"cachedValidPathSegments");d(this,"filteredObstacles",[]);d(this,"filteredObstaclePathSegments",[]);d(this,"filteredVias",[]);d(this,"segmentTree");d(this,"OBSTACLE_MARGIN",.1);d(this,"TRACE_THICKNESS",.15);d(this,"TAIL_JUMP_RATIO",.8);if(this.cachedValidPathSegments=new Set,this.inputRoute.route.length<=1)return this.newRoute=[...this.inputRoute.route],void(this.solved=!0);let t=this.inputRoute.route.reduce((r,s)=>(r.minX=Math.min(r.minX,s.x),r.maxX=Math.max(r.maxX,s.x),r.minY=Math.min(r.minY,s.y),r.maxY=Math.max(r.maxY,s.y),r),{minX:1/0,maxX:-1/0,minY:1/0,maxY:-1/0}),i={center:{x:(t.minX+t.maxX)/2,y:(t.minY+t.maxY)/2},width:t.maxX-t.minX,height:t.maxY-t.minY};this.filteredObstacles=this.obstacles.filter(r=>!r.connectedTo.some(s=>this.connMap.areIdsConnected(this.inputRoute.connectionName,s))).filter(r=>r.connectedTo.some(s=>this.connMap.areIdsConnected(this.inputRoute.connectionName,s))?!1:(function(s,o){let a=mq(s),c=mq(o),l=Math.max(a.minX-c.maxX,c.minX-a.maxX,0),u=Math.max(a.minY-c.maxY,c.minY-a.maxY,0);return Math.hypot(l,u)})(i,r)<this.OBSTACLE_MARGIN+this.TRACE_THICKNESS/2),this.filteredObstaclePathSegments=this.otherHdRoutes.flatMap(r=>{if(this.connMap.areIdsConnected(this.inputRoute.connectionName,r.connectionName))return[];let s=r.route,o=[];for(let a=0;a<s.length-1;a++){let c=s[a],l=s[a+1],u=Math.min(c.x,l.x),p=Math.max(c.x,l.x),f=Math.min(c.y,l.y),y=Math.max(c.y,l.y);u<=t.maxX&&p>=t.minX&&f<=t.maxY&&y>=t.minY&&o.push([c,l])}return o}),this.segmentTree=new DCt(this.filteredObstaclePathSegments),this.filteredVias=this.otherHdRoutes.flatMap(r=>{if(this.connMap.areIdsConnected(this.inputRoute.connectionName,r.connectionName))return[];let s=r.vias,o=[];for(let a of s){let c=this.OBSTACLE_MARGIN+this.TRACE_THICKNESS/2+r.viaDiameter/2,l=a.x-c,u=a.x+c,p=a.y-c,f=a.y+c;l<=t.maxX&&u>=t.minX&&p<=t.maxY&&f>=t.minY&&o.push({...a,diameter:r.viaDiameter})}return o}),this.computePathSegments()}computePathSegments(){let e=0;for(let t=0;t<this.inputRoute.route.length-1;t++){let i=this.inputRoute.route[t],r=this.inputRoute.route[t+1],s=Math.sqrt((r.x-i.x)**2+(r.y-i.y)**2)+t/1e4;this.pathSegments.push({start:i,end:r,length:s,startDistance:e,endDistance:e+s}),e+=s}this.totalPathLength=e}arePointsEqual(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z}getPointAtDistance(e){e=Math.max(0,Math.min(e,this.totalPathLength));let t=this.pathSegments.find(r=>e>=r.startDistance&&e<=r.endDistance);if(!t)return this.inputRoute.route[this.inputRoute.route.length-1];let i=(e-t.startDistance)/t.length;return{x:t.start.x+i*(t.end.x-t.start.x),y:t.start.y+i*(t.end.y-t.start.y),z:i<.5?t.start.z:t.end.z}}getNearestIndexForDistance(e){if(e<=0)return 0;if(e>=this.totalPathLength)return this.inputRoute.route.length-1;let t=this.pathSegments.findIndex(s=>e>=s.startDistance&&e<=s.endDistance);if(t===-1)return 0;let i=this.pathSegments[t],r=(i.startDistance+i.endDistance)/2;return e>r?t+1:t}isValidPathSegment(e,t){for(let r of this.filteredObstacles)if(r.zLayers?.includes(e.z)&&Wq(e,t,r)<this.OBSTACLE_MARGIN+this.TRACE_THICKNESS/2)return!1;let i=this.segmentTree.getSegmentsThatCouldIntersect(e,t);for(let[r,s,o]of i)if(r.z===e.z&&s.z===e.z&&$q({x:e.x,y:e.y},{x:t.x,y:t.y},{x:r.x,y:r.y},{x:s.x,y:s.y})<this.OBSTACLE_MARGIN+this.TRACE_THICKNESS)return!1;for(let r of this.filteredVias)if(_r(r,e,t)<this.OBSTACLE_MARGIN+r.diameter/2+this.TRACE_THICKNESS/2)return!1;return!(this.outline&&this.outline.length>=3&&(({start:s,end:o,polygon:a,margin:c=.2})=>{if(!a||a.length<3)return!1;let l=jq(s,a),u=jq(o,a);if(!l||!u)return!0;for(let p=0;p<a.length;p++){let f=a[p],y=a[(p+1)%a.length],g=B4(s,f,y),x=B4(o,f,y);if(g&&x)continue;if(!$i(s,o,f,y)){if(!g&&!x&&$q(s,o,f,y)<c-ZS)return!0;continue}let v=Yq(s,o,f,y);if(!(v&&(g&&BS(v,s)||x&&BS(v,o))||v&&(BS(v,s)||BS(v,o))))return!0}return!1})({start:{x:e.x,y:e.y},end:{x:t.x,y:t.y},polygon:this.outline}))}isValidPath(e){if(e.length<2)return!0;for(let t=0;t<e.length-1;t++)if(e[t].z!==e[t+1].z)return!1;for(let t=0;t<e.length-1;t++)if(!this.isValidPathSegment(e[t],e[t+1]))return!1;return!0}find45DegreePath(e,t){if(this.arePointsEqual(e,t))return[e];if(e.z!==t.z)return null;let i=((r,s)=>{let o=[],a=Math.abs(s.x-r.x),c=Math.abs(s.y-r.y),l=s.x>r.x?1:-1,u=s.y>r.y?1:-1,p={x:s.x-l*Math.abs(s.y-r.y),y:r.y};(p.x-r.x)*l>=0&&(p.x-s.x)*l<=0&&o.push([r,p,s]);let f={x:r.x,y:s.y-u*Math.abs(s.x-r.x)};(f.y-r.y)*u>=0&&(f.y-s.y)*u<=0&&o.push([r,f,s]);let y=Math.min(a,c),g={x:r.x+l*y,y:r.y+u*y};return(g.x-r.x)*l>=0&&(g.x-s.x)*l<=0&&(g.y-r.y)*u>=0&&(g.y-s.y)*u<=0&&o.push([r,g,s]),o})({x:e.x,y:e.y},{x:t.x,y:t.y});for(let r of i){let s=r.map(o=>({x:o.x,y:o.y,z:e.z}));if(this.isValidPath(s))return s}return null}addPathToResult(e){if(e.length!==0){for(let t=0;t<e.length;t++)t===0&&this.newRoute.length>0&&this.arePointsEqual(this.newRoute[this.newRoute.length-1],e[t])||this.newRoute.push(e[t]);this.currentStepSize=this.maxStepSize}}moveHead(e){this.lastHeadMoveDistance=e,this.headDistanceAlongPath=Math.min(this.headDistanceAlongPath+e,this.totalPathLength)}stepBackAndReduceStepSize(){this.headDistanceAlongPath=Math.max(this.tailDistanceAlongPath,this.headDistanceAlongPath-this.lastHeadMoveDistance),this.currentStepSize=Math.max(this.minStepSize,this.currentStepSize*this.STEP_SIZE_REDUCTION_FACTOR)}_step(){let e=this.tailDistanceAlongPath>=this.totalPathLength,t=this.headDistanceAlongPath>=this.totalPathLength;if(e){let u=this.inputRoute.route[this.inputRoute.route.length-1];return this.newRoute.length!==0&&this.arePointsEqual(this.newRoute[this.newRoute.length-1],u)||this.newRoute.push(u),void(this.solved=!0)}if(t){let u=this.getPointAtDistance(this.tailDistanceAlongPath),p=this.inputRoute.route[this.inputRoute.route.length-1],f=this.find45DegreePath(u,p);if(f)return this.addPathToResult(f),void(this.solved=!0);this.lastValidPath=null,this.tailDistanceAlongPath=this.totalPathLength,this.headDistanceAlongPath=this.totalPathLength;let y=[];for(let g of this.inputRoute.route)y.length!==0&&this.arePointsEqual(y[y.length-1],g)||y.push(g);return this.newRoute=y,this.newVias=[...this.inputRoute.vias],void(this.solved=!0)}this.moveHead(this.currentStepSize);let i=this.getPointAtDistance(this.tailDistanceAlongPath),r=this.getPointAtDistance(this.headDistanceAlongPath),s=this.getNearestIndexForDistance(this.tailDistanceAlongPath),o=this.getNearestIndexForDistance(this.headDistanceAlongPath),a=!1,c=-1;for(let u=s;u<o;u++)if(u+1<this.inputRoute.route.length&&this.inputRoute.route[u].z!==this.inputRoute.route[u+1].z){a=!0;let p=u;c=this.pathSegments[p].startDistance;break}if(a&&this.lastHeadMoveDistance>this.minStepSize)return void this.stepBackAndReduceStepSize();if(a&&c>0){let u=this.getNearestIndexForDistance(c)+1,p=this.inputRoute.route[u],f={x:p.x,y:p.y};this.lastValidPath&&(this.addPathToResult(this.lastValidPath),this.lastValidPath=null);let y=this.newRoute[this.newRoute.length-1];y.x===f.x&&y.y===f.y||this.newRoute.push({x:f.x,y:f.y,z:y.z}),this.newVias.push(f),this.newRoute.push({x:f.x,y:f.y,z:p.z}),this.currentStepSize=this.maxStepSize;let g=this.pathSegments.findIndex(x=>x.start===p);if(g!==-1)this.tailDistanceAlongPath=this.pathSegments[g].startDistance,this.headDistanceAlongPath=this.tailDistanceAlongPath,this.lastValidPath=null,this.lastValidPathHeadDistance=this.tailDistanceAlongPath;else if(u<this.inputRoute.route.length){console.warn("Fallback used for tailDistanceAlongPath after layer change");let x=this.pathSegments.find(v=>v.start===this.inputRoute.route[u]);x?(this.tailDistanceAlongPath=x.startDistance,this.headDistanceAlongPath=this.tailDistanceAlongPath,this.lastValidPath=null,this.lastValidPathHeadDistance=this.tailDistanceAlongPath):(console.error("Could not find segment start after layer change, path might be incomplete."),this.solved=!0)}else console.warn("Layer change occurred at the end of the path."),this.solved=!0;return}let l=this.find45DegreePath(i,r);if(!l&&this.lastHeadMoveDistance>this.minStepSize)this.stepBackAndReduceStepSize();else{if(!l&&!this.lastValidPath){let u=this.getPointAtDistance(this.tailDistanceAlongPath);this.tailDistanceAlongPath+=this.minStepSize,this.moveHead(this.minStepSize);let p=this.getNearestIndexForDistance(this.tailDistanceAlongPath),f=this.inputRoute.route[p],y=this.inputRoute.route[this.inputRoute.route.length-1];return void(this.arePointsEqual(u,f)||this.arePointsEqual(f,y)||this.newRoute.push(f))}if(l)return this.lastValidPath=l,void(this.lastValidPathHeadDistance=this.headDistanceAlongPath);this.lastValidPath&&(this.addPathToResult(this.lastValidPath),this.lastValidPath=null,this.tailDistanceAlongPath=this.lastValidPathHeadDistance,this.moveHead(this.minStepSize))}}visualize(){let e=this.getVisualsForNewRouteAndObstacles(),t=this.getPointAtDistance(this.tailDistanceAlongPath),i=this.getPointAtDistance(this.headDistanceAlongPath);e.points.push({x:t.x,y:t.y,color:"yellow",label:["Tail",`z: ${t.z}`].join(`
`)}),e.points.push({x:i.x,y:i.y,color:"orange",label:["Head",`z: ${i.z}`].join(`
`)});let r=this.getPointAtDistance(this.headDistanceAlongPath+this.currentStepSize);e.points.push({x:r.x,y:r.y,color:"red",label:["Tentative Head",`z: ${r.z}`].join(`
`)});let s=0;for(;s<this.totalPathLength;){let o=this.getPointAtDistance(s);e.circles.push({center:{x:o.x,y:o.y},radius:.05,fill:"rgba(100, 100, 100, 0.5)"}),s+=this.totalPathLength/20}if(this.lastValidPath&&this.lastValidPath.length>1)for(let o=0;o<this.lastValidPath.length-1;o++)e.lines.push({points:[{x:this.lastValidPath[o].x,y:this.lastValidPath[o].y},{x:this.lastValidPath[o+1].x,y:this.lastValidPath[o+1].y}],strokeColor:"rgba(0, 255, 255, 0.9)",strokeDash:"3, 3"});return e}},KS=class extends an{constructor(e){super();d(this,"simplifiedHdRoutes");d(this,"currentUnsimplifiedHdRouteIndex",0);d(this,"activeSubSolver",null);d(this,"unsimplifiedHdRoutes");d(this,"obstacles");d(this,"connMap");d(this,"colorMap");d(this,"outline");this.MAX_ITERATIONS=1e8,this.unsimplifiedHdRoutes=e.unsimplifiedHdRoutes,this.obstacles=e.obstacles,this.connMap=e.connMap||new hZ({}),this.colorMap=e.colorMap||{},this.outline=e.outline,this.simplifiedHdRoutes=[]}_step(){let e=this.unsimplifiedHdRoutes[this.currentUnsimplifiedHdRouteIndex];if(!this.activeSubSolver)return e?(this.activeSubSolver=new jCt({inputRoute:e,otherHdRoutes:this.unsimplifiedHdRoutes.slice(this.currentUnsimplifiedHdRouteIndex+1).concat(this.simplifiedHdRoutes),obstacles:this.obstacles,connMap:this.connMap,colorMap:this.colorMap,outline:this.outline}),void this.currentUnsimplifiedHdRouteIndex++):void(this.solved=!0);this.activeSubSolver.step(),this.activeSubSolver.solved&&(this.simplifiedHdRoutes.push(this.activeSubSolver.simplifiedRoute),this.activeSubSolver=null)}visualize(){if(this.activeSubSolver)return this.activeSubSolver.visualize();let e={lines:[],points:[],circles:[],rects:[],coordinateSystem:"cartesian",title:"Multi Simplified Path Solver"};for(let t of this.unsimplifiedHdRoutes)if(!this.simplifiedHdRoutes.some(i=>i.connectionName===t.connectionName)){for(let i=0;i<t.route.length-1;i++)e.lines.push({points:[{x:t.route[i].x,y:t.route[i].y},{x:t.route[i+1].x,y:t.route[i+1].y}],strokeColor:t.route[i].z===1?"rgba(0, 0, 255, 0.4)":"rgba(255, 0, 0, 0.4)",strokeWidth:.15,strokeDash:t.route[i].z===1?[.5,.5]:void 0});for(let i of t.vias||[])e.circles.push({center:i,radius:t.viaDiameter/2||.3,fill:"rgba(0, 0, 255, 0.4)"})}for(let t of this.simplifiedHdRoutes){let i=this.colorMap?.[t.connectionName]||"rgba(128, 128, 128, 0.8)";for(let r=0;r<t.route.length-1;r++)e.lines.push({points:[{x:t.route[r].x,y:t.route[r].y},{x:t.route[r+1].x,y:t.route[r+1].y}],strokeWidth:.15,strokeColor:i,strokeDash:t.route[r].z===1?[.5,.5]:void 0,step:1});for(let r of t.vias||[])e.circles.push({center:r,radius:t.viaDiameter/2,fill:"rgba(0, 0, 255, 0.5)",step:1})}for(let t of this.unsimplifiedHdRoutes){for(let i=0;i<t.route.length-1;i++)e.lines.push({points:[{x:t.route[i].x,y:t.route[i].y},{x:t.route[i+1].x,y:t.route[i+1].y}],strokeWidth:.15,strokeColor:"rgba(255, 0, 0, 0.2)",strokeDash:[.5,.5],step:0,layer:`z${t.route[i].z.toString()}`});for(let i of t.vias)e.circles.push({center:{x:i.x,y:i.y},radius:t.viaDiameter/2,fill:"rgba(255, 0, 0, 0.2)",step:0})}for(let t of this.obstacles)e.rects.push({center:t.center,width:t.width,height:t.height,fill:t.layers?.includes("top")?"rgba(255, 0, 0, 0.3)":t.layers?.includes("bottom")?"rgba(0, 0, 255, 0.3)":"rgba(128, 128, 128, 0.3)"});if(this.currentUnsimplifiedHdRouteIndex<this.unsimplifiedHdRoutes.length){let t=this.unsimplifiedHdRoutes[this.currentUnsimplifiedHdRouteIndex];t.route.length>0&&e.circles.push({center:{x:t.route[0].x,y:t.route[0].y},radius:.2,fill:"yellow",label:"Current"})}return e}},BCt=class extends an{constructor(e){super();d(this,"edges");d(this,"nodeMap");this.nodes=e,this.edges=[]}getNextCapacityMeshEdgeId(){return`ce${this.edges.length}`}_step(){this.edges=[];for(let e=0;e<this.nodes.length;e++)for(let t=e+1;t<this.nodes.length;t++)!(this.nodes[e]._strawNode&&this.nodes[t]._strawNode&&this.nodes[e]._strawParentCapacityMeshNodeId===this.nodes[t]._strawParentCapacityMeshNodeId)&&tw(this.nodes[e],this.nodes[t])&&this.doNodesHaveSharedLayer(this.nodes[e],this.nodes[t])&&this.edges.push({capacityMeshEdgeId:this.getNextCapacityMeshEdgeId(),nodeIds:[this.nodes[e].capacityMeshNodeId,this.nodes[t].capacityMeshNodeId]});this.handleTargetNodes(),this.solved=!0}handleTargetNodes(){let e=this.nodes.filter(t=>t._containsTarget);for(let t of e){if(this.edges.some(s=>s.nodeIds.includes(t.capacityMeshNodeId)))continue;let i=null,r=1/0;for(let s of this.nodes){if(s._containsObstacle||s._containsTarget)continue;let o=Qt(t.center,s.center);o<r&&(r=o,i=s)}i&&this.edges.push({capacityMeshEdgeId:this.getNextCapacityMeshEdgeId(),nodeIds:[t.capacityMeshNodeId,i.capacityMeshNodeId]})}}doNodesHaveSharedLayer(e,t){return e.availableZ.some(i=>t.availableZ.includes(i))}visualize(){let e=new Map;for(let i of this.edges)for(let r of i.nodeIds)e.set(r,1+(e.get(r)??0));let t={lines:[],points:[],rects:this.nodes.map(i=>{let r=Math.min(...i.availableZ);return{width:Math.max(i.width-2,.8*i.width),height:Math.max(i.height-2,.8*i.height),center:{x:i.center.x+r*i.width*.05,y:i.center.y-r*i.width*.05},fill:i._containsObstacle?"rgba(255,0,0,0.1)":{"0,1":"rgba(0,0,0,0.1)",0:"rgba(0,200,200, 0.1)",1:"rgba(0,0,200, 0.1)"}[i.availableZ.join(",")]??"rgba(0,200,200,0.1)",label:[i.capacityMeshNodeId,`availableZ: ${i.availableZ.join(",")}`,`target? ${i._containsTarget??!1}`,`obs? ${i._containsObstacle??!1}`,`conn: ${e.get(i.capacityMeshNodeId)??0}`].join(`
`),layer:`z${i.availableZ.join(",")}`}}),circles:[]};if(!this.nodeMap){this.nodeMap=new Map;for(let i of this.nodes)this.nodeMap.set(i.capacityMeshNodeId,i)}for(let i of this.edges){let r=this.nodeMap.get(i.nodeIds[0]),s=this.nodeMap.get(i.nodeIds[1]);if(r?.center&&s?.center){let o=Math.min(...r.availableZ),a=Math.min(...s.availableZ),c={x:r.center.x+o*r.width*.05,y:r.center.y-o*r.width*.05},l={x:s.center.x+a*s.width*.05,y:s.center.y-a*s.width*.05},u=Array.from(new Set([...r.availableZ,...s.availableZ])).sort();t.lines.push({layer:`z${u.join(",")}`,points:[c,l],strokeDash:r.availableZ.join(",")===s.availableZ.join(",")?void 0:"10 5"})}}return t}},SZ=class extends BCt{constructor(e){super(e);d(this,"nodeTree");d(this,"currentNodeIndex");d(this,"edgeSet");this.nodes=e,this.MAX_ITERATIONS=1e7,this.nodeTree=new G4(this.nodes),this.currentNodeIndex=0,this.edgeSet=new Set}_step(){if(this.currentNodeIndex>=this.nodes.length)return this.handleTargetNodes(),void(this.solved=!0);let e=this.nodes[this.currentNodeIndex],t=this.nodeTree.getNodesInArea(e.center.x,e.center.y,2*e.width,2*e.height);for(let i of t){if(!tw(e,i))continue;let r=e._strawNode&&i._strawNode&&e._strawParentCapacityMeshNodeId===i._strawParentCapacityMeshNodeId;e.capacityMeshNodeId===i.capacityMeshNodeId||r||!this.doNodesHaveSharedLayer(e,i)||this.edgeSet.has(`${e.capacityMeshNodeId}-${i.capacityMeshNodeId}`)||(this.edgeSet.add(`${e.capacityMeshNodeId}-${i.capacityMeshNodeId}`),this.edgeSet.add(`${i.capacityMeshNodeId}-${e.capacityMeshNodeId}`),this.edges.push({capacityMeshEdgeId:this.getNextCapacityMeshEdgeId(),nodeIds:[e.capacityMeshNodeId,i.capacityMeshNodeId]}))}this.currentNodeIndex++}},wZ=class extends an{constructor({nodes:e,edges:t}){super();d(this,"removedNodeIds");d(this,"targetNodeIds");d(this,"leaves");d(this,"leavesIndex");d(this,"adjacencyList");d(this,"nodeMap");d(this,"nodes");d(this,"edges");this.MAX_ITERATIONS=e.length,this.nodes=e,this.edges=t,this.removedNodeIds=new Set,this.targetNodeIds=new Set(e.filter(i=>i._containsTarget).map(i=>i.capacityMeshNodeId)),this.adjacencyList=new Map(e.map(({capacityMeshNodeId:i})=>[i,new Set]));for(let{nodeIds:[i,r]}of t)this.adjacencyList.get(i).add(r),this.adjacencyList.get(r).add(i);this.leavesIndex=0,this.leaves=[...this.adjacencyList.entries()].filter(([i,r])=>r.size===1).filter(([i,r])=>!this.targetNodeIds.has(i)).map(([i,r])=>i)}_step(){if(this.leavesIndex===this.leaves.length)return void(this.solved=!0);let e=this.leaves[this.leavesIndex],t=this.adjacencyList.get(e);if(!t||t.size===0)return this.removedNodeIds.add(e),this.adjacencyList.delete(e),this.leavesIndex+=1,void(this.leavesIndex===this.leaves.length&&(this.solved=!0));let[i]=t,r=i?this.adjacencyList.get(i):void 0;if(!i||!r)return this.removedNodeIds.add(e),this.adjacencyList.delete(e),this.leavesIndex+=1,void(this.leavesIndex===this.leaves.length&&(this.solved=!0));r.delete(e),this.removedNodeIds.add(e),this.adjacencyList.delete(e),r.size!==1||this.targetNodeIds.has(i)||this.leaves.push(i),this.leavesIndex+=1,this.leavesIndex===this.leaves.length&&(this.solved=!0)}visualize(){if(!this.nodeMap){this.nodeMap=new Map;for(let i of this.nodes)this.nodeMap.set(i.capacityMeshNodeId,i)}let e=new Map;for(let i of this.edges)for(let r of i.nodeIds)e.set(r,1+(e.get(r)??0));let t={lines:[],points:[],rects:this.nodes.map(i=>{let r=Math.min(...i.availableZ);return{width:Math.max(i.width-2,.8*i.width),height:Math.max(i.height-2,.8*i.height),center:{x:i.center.x+r*i.width*.05,y:i.center.y-r*i.width*.05},fill:i._containsObstacle?"rgba(255,0,0,0.1)":{"0,1":"rgba(0,0,0,0.1)",0:"rgba(0,200,200, 0.1)",1:"rgba(0,0,200, 0.1)"}[i.availableZ.join(",")]??"rgba(0,200,200,0.1)",label:[i.capacityMeshNodeId,`availableZ: ${i.availableZ.join(",")}`,`target? ${i._containsTarget??!1}`,`obs? ${i._containsObstacle??!1}`,`conn: ${e.get(i.capacityMeshNodeId)??0}`].join(`
`),layer:`z${i.availableZ.join(",")}`}}),circles:[]};for(let i of this.edges){let r=this.nodeMap.get(i.nodeIds[0]),s=this.nodeMap.get(i.nodeIds[1]);if(r?.center&&s?.center){let o=Math.min(...r.availableZ),a=Math.min(...s.availableZ),c={x:r.center.x+o*r.width*.05,y:r.center.y-o*r.width*.05},l={x:s.center.x+a*s.width*.05,y:s.center.y-a*s.width*.05},u=Array.from(new Set([...r.availableZ,...s.availableZ])).sort();t.lines.push({layer:`z${u.join(",")}`,points:[c,l],strokeDash:r.availableZ.join(",")===s.availableZ.join(",")?void 0:"10 5",strokeColor:i.nodeIds.some(p=>this.removedNodeIds.has(p))?Qn("black",.9):void 0})}}return t}},Bq=n=>({minX:Math.min(n[0].x,n[1].x),maxX:Math.max(n[0].x,n[1].x),minY:Math.min(n[0].y,n[1].y),maxY:Math.max(n[0].y,n[1].y)});function US(n,e){let t=n.x-e.x,i=n.y-e.y;return t*t+i*i}function u_(n,e,t){let i=US(e,t);if(i===0)return US(n,e);let r=((n.x-e.x)*(t.x-e.x)+(n.y-e.y)*(t.y-e.y))/i;return r=Math.max(0,Math.min(1,r)),US(n,{x:e.x+r*(t.x-e.x),y:e.y+r*(t.y-e.y)})}function YCt(n,e,t,i){if($i(n,e,t,i))return 0;let r={x:n.x,y:n.y},s={x:e.x,y:e.y},o={x:t.x,y:t.y},a={x:i.x,y:i.y};return Math.min(u_(r,o,a),u_(s,o,a),u_(o,r,s),u_(a,r,s))}var XCt=class{constructor(n,e=1){d(this,"segmentBuckets");d(this,"viaBuckets");d(this,"routes");d(this,"CELL_SIZE");this.segmentBuckets=new Map,this.viaBuckets=new Map,this.routes=new Map,this.CELL_SIZE=e;for(let t of n)if(t&&t.connectionName)if(this.routes.has(t.connectionName))console.warn(`Skipping duplicate route connectionName: ${t.connectionName}`);else{if(this.routes.set(t.connectionName,t),t.route&&t.route.length>=2)for(let i=0;i<t.route.length-1;i++){let r=t.route[i],s=t.route[i+1];if(r.x===s.x&&r.y===s.y)continue;let o=[r,s],a=Bq(o),c={segmentId:`${t.connectionName}-seg-${i}`,segment:o,parentRoute:t},l=Math.floor(a.minX/this.CELL_SIZE),u=Math.floor((a.maxX+1e-9)/this.CELL_SIZE),p=Math.floor(a.minY/this.CELL_SIZE),f=Math.floor((a.maxY+1e-9)/this.CELL_SIZE);for(let y=l;y<=u;y++)for(let g=p;g<=f;g++){let x=`${y}x${g}`,v=this.segmentBuckets.get(x);v||(v=[],this.segmentBuckets.set(x,v)),v.push(c)}}if(t.vias&&t.vias.length>0)for(let i=0;i<t.vias.length;i++){let r=t.vias[i];if(r==null)continue;let s={viaId:`${t.connectionName}-via-${i}`,x:r.x,y:r.y,parentRoute:t},o=`${Math.floor(r.x/this.CELL_SIZE)}x${Math.floor(r.y/this.CELL_SIZE)}`,a=this.viaBuckets.get(o);a||(a=[],this.viaBuckets.set(o,a)),a.push(s)}}else console.warn("Skipping route with missing data:",t)}getConflictingRoutesForSegment(n,e,t){let i=Bq([n,e]),r=i.minX-t,s=i.minY-t,o=i.maxX+t,a=i.maxY+t,c=Math.floor(r/this.CELL_SIZE),l=Math.floor((o+1e-9)/this.CELL_SIZE),u=Math.floor(s/this.CELL_SIZE),p=Math.floor((a+1e-9)/this.CELL_SIZE),f=new Map,y=new Set,g=new Set,x={x:n.x,y:n.y},v={x:e.x,y:e.y};for(let w=c;w<=l;w++)for(let k=u;k<=p;k++){let T=`${w}x${k}`,I=this.segmentBuckets.get(T);if(I)for(let N of I){if(y.has(N.segmentId))continue;y.add(N.segmentId);let M=N.parentRoute,[A,R]=N.segment,j=t+M.traceThickness/2,B=j*j,G=YCt(n,e,A,R);if(G<B){let U=M.connectionName,H=f.get(U);(!H||G<H.minDistSq)&&f.set(U,{route:M,minDistSq:G})}}let E=this.viaBuckets.get(T);if(E)for(let N of E){if(g.has(N.viaId))continue;g.add(N.viaId);let M=N.parentRoute,A={x:N.x,y:N.y},R=t+M.viaDiameter/2,j=R*R,B=u_(A,x,v);if(B<j){let G=M.connectionName,U=f.get(G);(!U||B<U.minDistSq)&&f.set(G,{route:M,minDistSq:B})}}}let P=[];for(let w of f.values())P.push({conflictingRoute:w.route,distance:Math.sqrt(w.minDistSq)});return P}getConflictingRoutesNearPoint(n,e){let t=n.x-e,i=n.y-e,r=n.x+e,s=n.y+e,o=Math.floor(t/this.CELL_SIZE),a=Math.floor((r+1e-9)/this.CELL_SIZE),c=Math.floor(i/this.CELL_SIZE),l=Math.floor((s+1e-9)/this.CELL_SIZE),u=new Map,p=new Set,f=new Set;for(let g=o;g<=a;g++)for(let x=c;x<=l;x++){let v=`${g}x${x}`,P=this.segmentBuckets.get(v);if(P)for(let k of P){if(p.has(k.segmentId))continue;p.add(k.segmentId);let T=k.parentRoute,I={x:k.segment[0].x,y:k.segment[0].y},E={x:k.segment[1].x,y:k.segment[1].y},N=e+T.traceThickness/2,M=N*N,A=u_(n,I,E);if(A<M){let R=T.connectionName,j=u.get(R);(!j||A<j.minDistSq)&&u.set(R,{route:T,minDistSq:A})}}let w=this.viaBuckets.get(v);if(w)for(let k of w){if(f.has(k.viaId))continue;f.add(k.viaId);let T=k.parentRoute,I={x:k.x,y:k.y},E=e+T.viaDiameter/2,N=E*E,M=US(n,I);if(M<N){let A=T.connectionName,R=u.get(A);(!R||M<R.minDistSq)&&u.set(A,{route:T,minDistSq:M})}}}let y=[];for(let g of u.values())y.push({conflictingRoute:g.route,distance:Math.sqrt(g.minDistSq)});return y}},UCt=class extends an{constructor(e){super();d(this,"obstacleSHI");d(this,"hdRouteSHI");d(this,"unsimplifiedRoute");d(this,"routeSections");d(this,"currentSectionIndex");d(this,"TRACE_THICKNESS",.15);d(this,"OBSTACLE_MARGIN",.1);this.currentSectionIndex=1,this.obstacleSHI=e.obstacleSHI,this.hdRouteSHI=e.hdRouteSHI,this.unsimplifiedRoute=e.unsimplifiedRoute,this.routeSections=this.breakRouteIntoSections(this.unsimplifiedRoute)}breakRouteIntoSections(e){let t=[],i=e.route;if(i.length===0)return[];let r={startIndex:0,endIndex:-1,z:i[0].z,points:[i[0]]};for(let s=1;s<i.length;s++)i[s].z===r.z?r.points.push(i[s]):(r.endIndex=s-1,t.push(r),r={startIndex:s,endIndex:-1,z:i[s].z,points:[i[s]]});return r.endIndex=i.length-1,t.push(r),t}_step(){if(this.currentSectionIndex>=this.routeSections.length-1)return void(this.solved=!0);let e=this.routeSections[this.currentSectionIndex-1],t=this.routeSections[this.currentSectionIndex],i=this.routeSections[this.currentSectionIndex+1];if(e.z!==i.z)return void this.currentSectionIndex++;let r=e.z;if(this.canSectionMoveToLayer({currentSection:t,targetZ:r}))return t.z=r,t.points=t.points.map(s=>({...s,z:r})),void(this.currentSectionIndex+=2);this.currentSectionIndex++}canSectionMoveToLayer({currentSection:e,targetZ:t}){for(let i=0;i<e.points.length-1;i++){let r={...e.points[i],z:t},s={...e.points[i+1],z:t},o=this.hdRouteSHI.getConflictingRoutesForSegment(r,s,this.TRACE_THICKNESS);for(let{conflictingRoute:l,distance:u}of o)if(l.connectionName!==this.unsimplifiedRoute.connectionName&&u<this.TRACE_THICKNESS+l.traceThickness)return!1;let a={centerX:(r.x+s.x)/2,centerY:(r.y+s.y)/2,width:Math.abs(r.x-s.x),height:Math.abs(r.y-s.y)},c=this.obstacleSHI.searchArea(a.centerX,a.centerY,a.width+2*(this.TRACE_THICKNESS+this.OBSTACLE_MARGIN),a.height+2*(this.TRACE_THICKNESS+this.OBSTACLE_MARGIN));for(let l of c)if(Wq(r,s,l)<this.TRACE_THICKNESS+this.OBSTACLE_MARGIN)return!1}return!0}getConstructorParams(){return{obstacleSHI:this.obstacleSHI,hdRouteSHI:this.hdRouteSHI,unsimplifiedRoute:this.unsimplifiedRoute}}getOptimizedHdRoute(){let e=this.routeSections.flatMap(i=>i.points),t=[];for(let i=0;i<e.length-1;i++)e[i].z!==e[i+1].z&&t.push({x:e[i].x,y:e[i].y});return{connectionName:this.unsimplifiedRoute.connectionName,route:e,traceThickness:this.unsimplifiedRoute.traceThickness,vias:t,viaDiameter:this.unsimplifiedRoute.viaDiameter}}visualize(){let e={circles:[],lines:[],points:[],rects:[],coordinateSystem:"cartesian",title:"Single Route Useless Via Removal Solver"};for(let t=0;t<this.routeSections.length;t++){let i=this.routeSections[t];e.lines.push({points:i.points,strokeWidth:this.TRACE_THICKNESS,strokeColor:t===this.currentSectionIndex?"orange":i.z===0?"red":"blue"})}return e}},JS=class extends an{constructor(e){super();d(this,"unsimplifiedHdRoutes");d(this,"optimizedHdRoutes");d(this,"unprocessedRoutes");d(this,"activeSubSolver",null);d(this,"obstacleSHI",null);d(this,"hdRouteSHI",null);this.input=e,this.MAX_ITERATIONS=1e6,this.unsimplifiedHdRoutes=e.unsimplifiedHdRoutes,this.optimizedHdRoutes=[],this.unprocessedRoutes=[...e.unsimplifiedHdRoutes],this.obstacleSHI=new eZ("flatbush",e.obstacles),this.hdRouteSHI=new XCt(this.unsimplifiedHdRoutes)}_step(){if(this.activeSubSolver)return this.activeSubSolver.step(),void(this.activeSubSolver.solved?(this.optimizedHdRoutes.push(this.activeSubSolver.getOptimizedHdRoute()),this.activeSubSolver=null):(this.activeSubSolver.failed||this.activeSubSolver.error)&&(this.error=this.activeSubSolver.error,this.failed=!0));let e=this.unprocessedRoutes.shift();e?this.activeSubSolver=new UCt({hdRouteSHI:this.hdRouteSHI,obstacleSHI:this.obstacleSHI,unsimplifiedRoute:e}):this.solved=!0}getOptimizedHdRoutes(){return this.optimizedHdRoutes}visualize(){let e={lines:[],points:[],rects:[],circles:[],coordinateSystem:"cartesian",title:"Useless Via Removal Solver"};for(let t of this.input.obstacles){let i="rgba(128, 128, 128, 0.2)",r=t.zLayers?.includes(0),s=t.zLayers?.includes(1);r&&s?i="rgba(128, 0, 128, 0.2)":r?i="rgba(255, 0, 0, 0.2)":s&&(i="rgba(0, 0, 255, 0.2)"),e.rects.push({center:t.center,width:t.width,height:t.height,fill:i,label:`Obstacle (Z: ${t.zLayers?.join(", ")})`})}for(let t of this.optimizedHdRoutes)if(t.route.length!==0){this.input.colorMap[t.connectionName];for(let i=0;i<t.route.length-1;i++){let r=t.route[i],s=t.route[i+1];r.z===s.z&&e.lines.push({points:[{x:r.x,y:r.y},{x:s.x,y:s.y}],strokeColor:r.z===0?"red":"blue",strokeWidth:t.traceThickness,label:`${t.connectionName} (z=${r.z})`})}for(let i of t.vias)e.circles.push({center:{x:i.x,y:i.y},radius:t.viaDiameter/2,fill:"rgba(255, 0, 255, 0.5)",label:`${t.connectionName} via`})}return this.activeSubSolver&&e.lines.push(...this.activeSubSolver.visualize().lines??[]),e}};function rr(n,e,t,i={}){return{solverName:n,solverClass:e,getConstructorParams:t,onSolved:i.onSolved}}var PZ=class extends an{constructor(e,t={}){super();d(this,"netToPointPairsSolver");d(this,"nodeSolver");d(this,"nodeTargetMerger");d(this,"edgeSolver");d(this,"initialPathingSolver");d(this,"pathingOptimizer");d(this,"edgeToPortSegmentSolver");d(this,"colorMap");d(this,"segmentToPointSolver");d(this,"unravelMultiSectionSolver");d(this,"segmentToPointOptimizer");d(this,"highDensityRouteSolver");d(this,"highDensityStitchSolver");d(this,"singleLayerNodeMerger");d(this,"strawSolver");d(this,"deadEndSolver");d(this,"uselessViaRemovalSolver1");d(this,"uselessViaRemovalSolver2");d(this,"multiSimplifiedPathSolver1");d(this,"multiSimplifiedPathSolver2");d(this,"startTimeOfPhase");d(this,"endTimeOfPhase");d(this,"timeSpentOnPhase");d(this,"activeSubSolver",null);d(this,"connMap");d(this,"srjWithPointPairs");d(this,"capacityNodes",null);d(this,"capacityEdges",null);d(this,"cacheProvider",null);d(this,"pipelineDef",[rr("netToPointPairsSolver",dZ,e=>[e.srj,e.colorMap],{onSolved:e=>{e.srjWithPointPairs=e.netToPointPairsSolver?.getNewSimpleRouteJson(),e.colorMap=Yg(e.srjWithPointPairs,this.connMap),e.connMap=WS(e.srjWithPointPairs)}}),rr("nodeSolver",nZ,e=>[e.netToPointPairsSolver?.getNewSimpleRouteJson()||e.srj,e.opts],{onSolved:e=>{e.capacityNodes=e.nodeSolver?.finishedNodes}}),rr("singleLayerNodeMerger",FCt,e=>[e.nodeSolver?.finishedNodes],{onSolved:e=>{e.capacityNodes=e.singleLayerNodeMerger?.newNodes}}),rr("strawSolver",LCt,e=>[{nodes:e.singleLayerNodeMerger?.newNodes}],{onSolved:e=>{e.capacityNodes=e.strawSolver?.getResultNodes()}}),rr("edgeSolver",SZ,e=>[e.capacityNodes],{onSolved:e=>{e.capacityEdges=e.edgeSolver?.edges}}),rr("deadEndSolver",wZ,e=>[{nodes:e.capacityNodes,edges:e.capacityEdges}],{onSolved:e=>{let t=e.deadEndSolver?.removedNodeIds;e.capacityNodes=e.capacityNodes.filter(i=>!t.has(i.capacityMeshNodeId)),e.capacityEdges=e.capacityEdges.filter(i=>i.nodeIds.every(r=>!t.has(r)))}}),rr("initialPathingSolver",bZ,e=>[{simpleRouteJson:e.srjWithPointPairs,nodes:e.capacityNodes,edges:e.capacityEdges||[],colorMap:e.colorMap,hyperParameters:{MAX_CAPACITY_FACTOR:1}}]),rr("pathingOptimizer",OCt,e=>[{initialPathingSolver:e.initialPathingSolver,simpleRouteJson:e.srjWithPointPairs,nodes:e.capacityNodes,edges:e.capacityEdges||[],colorMap:e.colorMap,cacheProvider:e.cacheProvider,hyperParameters:{MAX_CAPACITY_FACTOR:1}}]),rr("edgeToPortSegmentSolver",iZ,e=>[{nodes:e.capacityNodes,edges:e.capacityEdges||[],capacityPaths:e.pathingOptimizer?.getCapacityPaths()||[],colorMap:e.colorMap}]),rr("segmentToPointSolver",rZ,e=>{let t=[];return e.edgeToPortSegmentSolver?.nodePortSegments&&e.edgeToPortSegmentSolver.nodePortSegments.forEach(i=>{t.push(...i)}),[{segments:t,colorMap:e.colorMap,nodes:e.capacityNodes}]}),rr("unravelMultiSectionSolver",xZ,e=>[{assignedSegments:e.segmentToPointSolver?.solvedSegments||[],colorMap:e.colorMap,nodes:e.capacityNodes,cacheProvider:this.cacheProvider}]),rr("highDensityRouteSolver",pZ,e=>[{nodePortPoints:e.unravelMultiSectionSolver?.getNodesWithPortPoints()??e.segmentToPointOptimizer?.getNodesWithPortPoints()??[],colorMap:e.colorMap,connMap:e.connMap}]),rr("highDensityStitchSolver",mZ,e=>[{connections:e.srjWithPointPairs.connections,hdRoutes:e.highDensityRouteSolver.routes,colorMap:e.colorMap,layerCount:e.srj.layerCount}]),rr("uselessViaRemovalSolver1",JS,e=>[{unsimplifiedHdRoutes:e.highDensityStitchSolver.mergedHdRoutes,obstacles:e.srj.obstacles,colorMap:e.colorMap,layerCount:e.srj.layerCount}]),rr("multiSimplifiedPathSolver1",KS,e=>[{unsimplifiedHdRoutes:e.uselessViaRemovalSolver1?.getOptimizedHdRoutes()||e.highDensityStitchSolver.mergedHdRoutes,obstacles:e.srj.obstacles,connMap:e.connMap,colorMap:e.colorMap,outline:e.srj.outline}]),rr("uselessViaRemovalSolver2",JS,e=>[{unsimplifiedHdRoutes:e.multiSimplifiedPathSolver1.simplifiedHdRoutes,obstacles:e.srj.obstacles,colorMap:e.colorMap,layerCount:e.srj.layerCount}]),rr("multiSimplifiedPathSolver2",KS,e=>[{unsimplifiedHdRoutes:e.uselessViaRemovalSolver2?.getOptimizedHdRoutes(),obstacles:e.srj.obstacles,connMap:e.connMap,colorMap:e.colorMap,outline:e.srj.outline}])]);d(this,"currentPipelineStepIndex",0);if(this.srj=e,this.opts=t,this.MAX_ITERATIONS=1e8,t.capacityDepth===void 0){let i=e.bounds.maxX-e.bounds.minX,r=e.bounds.maxY-e.bounds.minY,s=Math.max(i,r),o=t.targetMinCapacity??.5;t.capacityDepth=X4(s,o)}this.connMap=WS(e),this.colorMap=Yg(e,this.connMap),this.cacheProvider=t.cacheProvider===void 0?__():t.cacheProvider===null?null:t.cacheProvider,this.startTimeOfPhase={},this.endTimeOfPhase={},this.timeSpentOnPhase={}}_step(){let e=this.pipelineDef[this.currentPipelineStepIndex];if(!e)return void(this.solved=!0);if(this.activeSubSolver)return this.activeSubSolver.step(),void(this.activeSubSolver.solved?(this.endTimeOfPhase[e.solverName]=performance.now(),this.timeSpentOnPhase[e.solverName]=this.endTimeOfPhase[e.solverName]-this.startTimeOfPhase[e.solverName],e.onSolved?.(this),this.activeSubSolver=null,this.currentPipelineStepIndex++):this.activeSubSolver.failed&&(this.error=this.activeSubSolver?.error,this.failed=!0,this.activeSubSolver=null));let t=e.getConstructorParams(this);this.activeSubSolver=new e.solverClass(...t),this[e.solverName]=this.activeSubSolver,this.timeSpentOnPhase[e.solverName]=0,this.startTimeOfPhase[e.solverName]=performance.now()}solveUntilPhase(e){for(;this.getCurrentPhase()!==e;)this.step()}getCurrentPhase(){return this.pipelineDef[this.currentPipelineStepIndex]?.solverName??"none"}visualize(){if(!this.solved&&this.activeSubSolver)return this.activeSubSolver.visualize();let e=this.netToPointPairsSolver?.visualize(),t=this.nodeSolver?.visualize(),i=this.nodeTargetMerger?.visualize(),r=this.singleLayerNodeMerger?.visualize(),s=this.strawSolver?.visualize(),o=this.edgeSolver?.visualize(),a=this.deadEndSolver?.visualize(),c=this.initialPathingSolver?.visualize(),l=this.pathingOptimizer?.visualize(),u=this.edgeToPortSegmentSolver?.visualize(),p=this.segmentToPointSolver?.visualize(),f=this.unravelMultiSectionSolver?.visualize()??this.segmentToPointOptimizer?.visualize(),y=this.highDensityRouteSolver?.visualize(),g=this.highDensityStitchSolver?.visualize(),x=this.uselessViaRemovalSolver1?.visualize(),v=this.uselessViaRemovalSolver2?.visualize(),P=this.multiSimplifiedPathSolver1?.visualize(),w=this.multiSimplifiedPathSolver2?.visualize(),k=this.srj.outline,T=[];if(T.push({points:[{x:this.srj.bounds?.minX??-50,y:this.srj.bounds?.minY??-50},{x:this.srj.bounds?.maxX??50,y:this.srj.bounds?.minY??-50},{x:this.srj.bounds?.maxX??50,y:this.srj.bounds?.maxY??50},{x:this.srj.bounds?.minX??-50,y:this.srj.bounds?.maxY??50},{x:this.srj.bounds?.minX??-50,y:this.srj.bounds?.minY??-50}],strokeColor:"rgba(255,0,0,0.25)"}),k&&k.length>=2){let N=k.map(M=>({x:M.x,y:M.y}));N.push({...N[0]}),T.push({points:N,strokeColor:"rgba(0, 136, 255, 0.95)"})}let I={points:[...this.srj.connections.flatMap(N=>N.pointsToConnect.map(M=>({...M,label:`${N.name} ${M.pcb_port_id??""}`})))],rects:[...(this.srj.obstacles??[]).map(N=>({...N,fill:N.layers?.includes("top")?"rgba(255,0,0,0.25)":N.layers?.includes("bottom")?"rgba(0,0,255,0.25)":"rgba(255,0,0,0.25)",label:N.layers?.join(", ")}))],lines:T},E=[I,e,t,i,r,s,o,a,c,l,u,p,f,y?ud(I,y):null,g,x,P,v,w,this.solved?ud(I,Vg(this.getOutputSimpleRouteJson())):null].filter(Boolean);return ud(...E)}preview(){if(this.highDensityRouteSolver){let e=[];for(let t=this.highDensityRouteSolver.routes.length-1;t>=0;t--){let i=this.highDensityRouteSolver.routes[t];if(e.push({points:i.route.map(r=>({x:r.x,y:r.y})),strokeColor:this.colorMap[i.connectionName]}),e.length>200)break}return{lines:e}}if(this.pathingOptimizer){let e=[];for(let t of this.pathingOptimizer.connectionsWithNodes)t.path&&e.push({points:t.path.map(i=>({x:i.center.x,y:i.center.y})),strokeColor:this.colorMap[t.connection.name]});return{lines:e}}return this.netToPointPairsSolver?this.netToPointPairsSolver?.visualize():{}}getOriginalConnectionName(e){let t=e.match(/^(.+?)_mst\d+$/);return t?t[1]:e}_getOutputHdRoutes(){return this.multiSimplifiedPathSolver2?.simplifiedHdRoutes??this.uselessViaRemovalSolver2?.getOptimizedHdRoutes()??this.multiSimplifiedPathSolver1?.simplifiedHdRoutes??this.uselessViaRemovalSolver1?.getOptimizedHdRoutes()??this.highDensityStitchSolver.mergedHdRoutes}getOutputSimplifiedPcbTraces(){if(!this.solved||!this.highDensityRouteSolver)throw new Error("Cannot get output before solving is complete");let e=[],t=this._getOutputHdRoutes();for(let i of this.netToPointPairsSolver?.newConnections??[]){let r=this.srj.connections.find(o=>o.name===i.name)?.netConnectionName,s=t.filter(o=>o.connectionName===i.name);for(let o=0;o<s.length;o++){let a=s[o],c={type:"pcb_trace",pcb_trace_id:`${i.name}_${o}`,connection_name:r??this.getOriginalConnectionName(i.name),route:fZ(a,this.srj.layerCount)};e.push(c)}}return e}getOutputSimpleRouteJson(){return{...this.srj,traces:this.getOutputSimplifiedPcbTraces()}}},VCt=PZ,GCt=class extends nZ{constructor(e,t={}){super(e,t);d(this,"MAX_SIZE_FOR_SINGLE_LAYER_NODES",2);this.srj=e,this.opts=t}isObstacleAssignable(e){return!!e?.netIsAssignable}getOverlappingAssignableObstacles(e){return this.getXYZOverlappingObstacles(e).filter(t=>this.isObstacleAssignable(t))}shouldNodeBeXYSubdivided(e){return!(e._depth>=this.MAX_DEPTH)&&(!!e._containsTarget||!(!e._containsObstacle||e._completelyInsideObstacle)||e.availableZ.length===1&&(e.width>this.MAX_SIZE_FOR_SINGLE_LAYER_NODES||e.height>this.MAX_SIZE_FOR_SINGLE_LAYER_NODES))}shouldFilterNodeForObstacle(e){return e._containsObstacle?!(this.getOverlappingAssignableObstacles(e).length>0)&&(e.availableZ.length!==1||this.shouldFilterSingleLayerNodeForObstacle(e)):!1}insertAssignableObstaclesAsNodes(){let e=this.srj.obstacles.filter(r=>this.isObstacleAssignable(r)),t=new Map;for(let r of e){let s=[];for(let o of this.finishedNodes)this.getXYZOverlappingObstacles(o).some(a=>a===r)&&s.push(o);t.set(r,s)}let i=new Set;for(let r of t.values())for(let s of r)i.add(s);this.finishedNodes=this.finishedNodes.filter(r=>!i.has(r));for(let r of e){let s=t.get(r)||[],o=Array.from({length:this.srj.layerCount},(P,w)=>this.srj.layerCount-w-1),a=r.center.x-r.width/2,c=r.center.x+r.width/2,l=r.center.y-r.height/2,u=r.center.y+r.height/2;for(let P of s){let w=P.center.x-P.width/2,k=P.center.x+P.width/2,T=P.center.y-P.height/2,I=P.center.y+P.height/2;a=Math.min(a,w),c=Math.max(c,k),l=Math.min(l,T),u=Math.max(u,I)}let p=c-a,f=u-l,y=(a+c)/2,g=(l+u)/2,x=!1;for(let P of this.srj.connections){for(let w of P.pointsToConnect)if(w.x>=a&&w.x<=c&&w.y>=l&&w.y<=u){x=!0;break}if(x)break}let v={capacityMeshNodeId:`assignable_via_${r.center.x}_${r.center.y}`,center:{x:y,y:g},width:p,height:f,layer:o.length===1?`z${o[0]}`:`z${o.join(",")}`,availableZ:o,_depth:0,_containsTarget:x,_containsObstacle:!1,_completelyInsideObstacle:!1};v._assignedViaObstacle=r,this.finishedNodes.push(v)}}_step(){let e=this.unfinishedNodes.pop();if(!e)return this.insertAssignableObstaclesAsNodes(),void(this.solved=!0);let t=this.getChildNodes(e),i=[],r=[];for(let s of t){let o=this.shouldNodeBeXYSubdivided(s),a=s.availableZ.length>1&&!o;if(o)r.push(s);else{if(a){let c=this.getZSubdivisionChildNodes(s);for(let l of c)!l._containsTarget&&this.shouldFilterNodeForObstacle(l)||(this.shouldNodeBeXYSubdivided(l)?r.push(l):(l._containsObstacle=!1,i.push(l)));continue}this.shouldFilterNodeForObstacle(s)&&!s._containsTarget||i.push(s)}}this.unfinishedNodes.push(...r),this.finishedNodes.push(...i)}},YS=.005,HCt=class extends an{constructor(e){super();d(this,"nodeMap");d(this,"currentBatchNodeIds");d(this,"absorbedNodeIds");d(this,"nextBatchNodeIds");d(this,"batchHadModifications");d(this,"hasComputedAdjacentNodeIds",!1);d(this,"newNodes");this.nodeMap=new Map,this.MAX_ITERATIONS=1e5;for(let i of e)this.nodeMap.set(i.capacityMeshNodeId,i);this.newNodes=[],this.absorbedNodeIds=new Set;let t=[];for(let i of e)i._assignedViaObstacle?(this.newNodes.push(i),this.absorbedNodeIds.add(i.capacityMeshNodeId)):i._containsTarget?i.availableZ.length>1?(this.newNodes.push(i),this.absorbedNodeIds.add(i.capacityMeshNodeId)):t.push([i,i.width*i.height]):(this.newNodes.push(i),this.absorbedNodeIds.add(i.capacityMeshNodeId));t.sort((i,r)=>i[1]-r[1]);for(let[i,r]of t){let s={...i,center:{...i.center}};this.nodeMap.set(i.capacityMeshNodeId,s)}this.currentBatchNodeIds=t.map(([i])=>i.capacityMeshNodeId),this.nextBatchNodeIds=[],this.batchHadModifications=!1}computeAdjacentNodeIdsForFirstBatch(e){let t=Math.max(...e.map(r=>Math.max(...r.availableZ))),i=[];for(let r=0;r<=t;r++)i.push(new G4(e.filter(s=>s.availableZ[0]===r)));for(let r of e){let s=[],o=i[r.availableZ[0]].getNodesInArea(r.center.x,r.center.y,4*r.width,4*r.height);for(let a of o)a._containsTarget&&a._targetConnectionName!==r._targetConnectionName||r._containsTarget&&(!a._containsTarget||a._targetConnectionName!==r._targetConnectionName)||a.capacityMeshNodeId!==r.capacityMeshNodeId&&tw(r,a)&&s.push(a);r._adjacentNodeIds=s.map(a=>a.capacityMeshNodeId)}}getAdjacentSameLayerUnprocessedNodes(e){let t=[],i=Array.from(new Set((e._adjacentNodeIds??[]).map(r=>this.nodeMap.get(r)))).filter(r=>r&&r.capacityMeshNodeId!==e.capacityMeshNodeId);i.sort((r,s)=>r.width*r.height-s.width*s.height);for(let r of i)this.absorbedNodeIds.has(r.capacityMeshNodeId)||t.push(r);return t}_step(){this.hasComputedAdjacentNodeIds||(this.computeAdjacentNodeIdsForFirstBatch(this.currentBatchNodeIds.map(u=>this.nodeMap.get(u))),this.hasComputedAdjacentNodeIds=!0);let e=this.currentBatchNodeIds.pop();for(;e&&this.absorbedNodeIds.has(e);)e=this.currentBatchNodeIds.pop();if(!e)return this.batchHadModifications?(this.currentBatchNodeIds=this.nextBatchNodeIds.sort((u,p)=>{let f=this.nodeMap.get(u),y=this.nodeMap.get(p);return f.width*f.height-y.width*y.height}),this.nextBatchNodeIds=[],void(this.batchHadModifications=!1)):(this.solved=!0,void this.newNodes.push(...this.nextBatchNodeIds.map(u=>this.nodeMap.get(u))));let t=this.nodeMap.get(e),i=!1,r=this.getAdjacentSameLayerUnprocessedNodes(t);if(r.length===0)return void this.nextBatchNodeIds.push(e);let s=u=>{for(let p of u)this.absorbedNodeIds.add(p.capacityMeshNodeId);t._adjacentNodeIds=Array.from(new Set([...t._adjacentNodeIds??[],...u.flatMap(p=>p._adjacentNodeIds??[])].filter(p=>p!==t.capacityMeshNodeId&&!this.absorbedNodeIds.has(p))))},o=r.filter(u=>u.center.x<t.center.x&&Math.abs(u.center.y-t.center.y)<t.height/2);if(o.length>0){let{width:u,height:p}=o[0],f=o.every(y=>y.width===u&&y.height===p);Math.abs(o.reduce((y,g)=>y+g.height,0)-t.height)<YS&&f&&(t.width+=u,t.center.x=t.center.x-u/2,s(o),i=!0)}let a=r.filter(u=>u.center.x>t.center.x&&Math.abs(u.center.y-t.center.y)<t.height/2);if(a.length>0&&!i){let{width:u,height:p}=a[0],f=a.every(y=>y.width===u&&y.height===p);Math.abs(a.reduce((y,g)=>y+g.height,0)-t.height)<YS&&f&&(t.width+=u,t.center.x=t.center.x+u/2,s(a),i=!0)}let c=r.filter(u=>u.center.y>t.center.y&&Math.abs(u.center.x-t.center.x)<t.width/2);if(c.length>0&&!i){let{width:u,height:p}=c[0],f=c.every(y=>y.width===u&&y.height===p);Math.abs(c.reduce((y,g)=>y+g.width,0)-t.width)<YS&&f&&(t.height+=p,t.center.y=t.center.y+p/2,s(c),i=!0)}let l=r.filter(u=>u.center.y<t.center.y&&Math.abs(u.center.x-t.center.x)<t.width/2);if(l.length>0&&!i){let{width:u,height:p}=l[0],f=l.every(y=>y.width===u&&y.height===p);Math.abs(l.reduce((y,g)=>y+g.width,0)-t.width)<YS&&f&&(t.height+=p,t.center.y=t.center.y-p/2,s(l),i=!0)}i?(this.batchHadModifications=!0,this.currentBatchNodeIds.push(e)):this.nextBatchNodeIds.unshift(e)}visualize(){let e={circles:[],lines:[],points:[],rects:[],coordinateSystem:"cartesian",title:"Single Layer Node Merger (Only Merge Targets)"};for(let r of this.newNodes)e.rects.push(so(r));let t=this.currentBatchNodeIds[this.currentBatchNodeIds.length-1],i;t&&(i=this.getAdjacentSameLayerUnprocessedNodes(this.nodeMap.get(t)));for(let r of this.currentBatchNodeIds){let s=this.nodeMap.get(r);if(!this.absorbedNodeIds.has(r)&&s){let o=so(s,{rectMargin:.01});r===t?o.stroke="rgba(0, 255, 0, 0.8)":i?.some(a=>a.capacityMeshNodeId===r)?o.stroke="rgba(128, 0, 128, 0.8)":o.stroke="rgba(255, 165, 0, 0.8)",o.layer=`z${s.availableZ.join(",")}`,o.label=`${o.label}
(unprocessed)`,e.rects.push(o)}}for(let r of this.nextBatchNodeIds){let s=this.nodeMap.get(r);if(!this.absorbedNodeIds.has(r)&&s){let o=so(s,{rectMargin:.01});o.layer=`z${s.availableZ.join(",")}`,o.stroke="rgba(0, 217, 255, 0.8)",o.label=`${o.label}
x: ${s.center.x}, y: ${s.center.y}
${s.width}x${s.height}
(next batch)`,e.rects.push(o)}}return e}},WCt=class extends an{constructor(e){super();d(this,"newNodes");d(this,"obstacleToNodesMap");d(this,"obstaclesToProcess");d(this,"mergedNodeIds");this.MAX_ITERATIONS=1e4,this.newNodes=[],this.obstacleToNodesMap=new Map,this.mergedNodeIds=new Set;for(let t of e){let i=t._assignedViaObstacle;if(i){let r=this.obstacleToNodesMap.get(i)||[];r.push(t),this.obstacleToNodesMap.set(i,r)}else this.newNodes.push(t)}this.obstaclesToProcess=Array.from(this.obstacleToNodesMap.keys())}_step(){let e=this.obstaclesToProcess.pop();if(!e)return void(this.solved=!0);let t=this.obstacleToNodesMap.get(e);if(!t||t.length===0)return;let i=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,s=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,a=new Set,c=!1;for(let x of t){let v=x.center.x-x.width/2,P=x.center.x+x.width/2,w=x.center.y-x.height/2,k=x.center.y+x.height/2;i=Math.min(i,v),r=Math.max(r,P),s=Math.min(s,w),o=Math.max(o,k);for(let T of x.availableZ)a.add(T);x._containsTarget&&(c=!0)}let l=r-i,u=o-s,p=(i+r)/2,f=(s+o)/2,y=Array.from(a).sort((x,v)=>x-v),g={capacityMeshNodeId:`merged_via_${e.center.x}_${e.center.y}`,center:{x:p,y:f},width:l,height:u,layer:y.length===1?`z${y[0]}`:`z${y.join(",")}`,availableZ:y,_containsTarget:c,_containsObstacle:!1,_completelyInsideObstacle:!1};g._assignedViaObstacle=e;for(let x of t)this.mergedNodeIds.add(x.capacityMeshNodeId);this.newNodes.push(g)}visualize(){let e={circles:[],lines:[],points:[],rects:[],coordinateSystem:"cartesian",title:"Assignable Via Node Merger"};for(let i of this.newNodes){let r=so(i);i._assignedViaObstacle&&(r.stroke="rgba(255, 0, 255, 0.8)",r.label=`${r.label||""}
(merged via)`),e.rects.push(r)}let t=this.obstaclesToProcess[this.obstaclesToProcess.length-1];if(t){let i=this.obstacleToNodesMap.get(t)||[];for(let r of i){let s=so(r,{rectMargin:.01});s.stroke="rgba(0, 255, 0, 0.8)",s.label=`${s.label||""}
(to be merged)`,e.rects.push(s)}}return e}},qCt=class extends an{constructor(e){let{simpleRouteJson:t,nodes:i,edges:r,colorMap:s,MAX_ITERATIONS:o=1e6,hyperParameters:a={}}=e;super();d(this,"GREEDY_MULTIPLIER",1.5);d(this,"simpleRouteJson");d(this,"nodes");d(this,"edges");d(this,"colorMap");d(this,"MAX_ITERATIONS");d(this,"hyperParameters");d(this,"usedNodeMap",new Map);d(this,"nodeMap");d(this,"nodeEdgeMap");d(this,"unprocessedConnectionPairs");d(this,"solvedRoutes",[]);d(this,"activeConnectionPair",null);d(this,"ogUnprocessedSubpaths",null);d(this,"unprocessedSubpaths",null);d(this,"solvedSubpaths",null);d(this,"activeSubpath",null);d(this,"viaNodes",[]);d(this,"closestViaForConnectionStartMap",new Map);d(this,"closestViaForConnectionEndMap",new Map);d(this,"lastStepOperation","none");d(this,"queuedCandidateNodes",[]);d(this,"visitedNodes",new Set);this.inputParams=e,this.hyperParameters=a,this.MAX_ITERATIONS=o,this.simpleRouteJson=t,this.nodes=i,this.edges=r,this.colorMap=s??{},this.nodeMap=new Map(this.nodes.map(l=>[l.capacityMeshNodeId,l])),this.nodeEdgeMap=d_(this.edges);let c=this.nodes.filter(l=>l._containsTarget);this.unprocessedConnectionPairs=Xg(this.simpleRouteJson.connections.map(l=>{let[u,p]=l.pointsToConnect;return{start:c.find(f=>Qt(f.center,u)<f.width/2),end:c.find(f=>Qt(f.center,p)<f.width/2),connection:l}}),this.hyperParameters.SHUFFLE_SEED??0),this.viaNodes=this.nodes.filter(l=>l.availableZ.length>1)}getConstructorParams(){return this.inputParams}computeClosestViaForAllConnections(){this.closestViaForConnectionStartMap.clear(),this.closestViaForConnectionEndMap.clear();for(let e of this.unprocessedConnectionPairs){let t=this.viaNodes.filter(i=>!i._completelyInsideObstacle&&!i._containsObstacle).filter(i=>!this.usedNodeMap.has(i.capacityMeshNodeId));if(t.length>0){let i=t.reduce((s,o)=>{let a=this._dist(s,e.start);return this._dist(o,e.start)<a?o:s});this.closestViaForConnectionStartMap.set(e,i);let r=t.reduce((s,o)=>{let a=this._dist(s,e.end);return this._dist(o,e.end)<a?o:s});this.closestViaForConnectionEndMap.set(e,r)}}}_step(){if(!this.activeConnectionPair)return this.activeConnectionPair=this.unprocessedConnectionPairs.shift(),this.activeConnectionPair?(this.computeClosestViaForAllConnections(),void(this.lastStepOperation="dequeueConnectionPair")):void(this.solved=!0);if(this.activeConnectionPair&&!this.unprocessedSubpaths)return this.unprocessedSubpaths=this.breakConnectionPairIntoSubpaths(this.activeConnectionPair),this.ogUnprocessedSubpaths=this.unprocessedSubpaths.slice(),this.solvedSubpaths=[],void(this.lastStepOperation="breakConnectionPairIntoSubpaths");if(this.activeSubpath){if(this.activeSubpath&&(this.stepSolveSubpath(this.activeSubpath),this.activeSubpath.solved))return this.solvedSubpaths.push(this.activeSubpath),this.activeSubpath=null,this.clearCandidateNodes(),void(this.lastStepOperation="finishedSolvingSubpath");this.lastStepOperation="stepSolveSubpath"}else{if(this.activeSubpath=this.unprocessedSubpaths.shift(),!this.activeSubpath){let e=this.activeConnectionPair;return this.activeConnectionPair=null,this.unprocessedSubpaths=null,this.ogUnprocessedSubpaths=null,this.activeSubpath=null,this.solvedRoutes.push(this.createSolvedRoute(this.solvedSubpaths,e)),void(this.lastStepOperation="finishedSolvingConnectionPair")}this.lastStepOperation="dequeueSubpath"}}_dist(e,t){return Math.hypot(e.center.x-t.center.x,e.center.y-t.center.y)}stepSolveSubpath(e){let{start:t,end:i}=e;if(t.capacityMeshNodeId===i.capacityMeshNodeId)return e.path=[t],e.solved=!0,void this.usedNodeMap.set(t.capacityMeshNodeId,!0);if(this.queuedCandidateNodes.length===0&&this.visitedNodes.size===0){let o=this._dist(t,i),a={prevCandidate:null,node:t,g:0,h:o,f:this.GREEDY_MULTIPLIER*o};this.queuedCandidateNodes.push(a)}let r;for(this.queuedCandidateNodes.sort((o,a)=>o.f-a.f);this.queuedCandidateNodes.length&&!r;){let o=this.queuedCandidateNodes.shift();this.visitedNodes.has(o.node.capacityMeshNodeId)||(r=o)}if(!r)return this.failed=!0,void(this.error="No viable candidates left");if(this.visitedNodes.add(r.node.capacityMeshNodeId),r.node.capacityMeshNodeId===i.capacityMeshNodeId){let o=[],a=r;for(;a;)o.unshift(a.node),this.usedNodeMap.set(a.node.capacityMeshNodeId,!0),a=a.prevCandidate;return e.path=o,void(e.solved=!0)}let s=this.getNeighbors(r.node);for(let o of s){let a=o.capacityMeshNodeId;if(this.visitedNodes.has(a))continue;let c=this.computeG(r,o,i),l=this.computeH(r,o,i),u=c+this.GREEDY_MULTIPLIER*l,p=this.queuedCandidateNodes.findIndex(f=>f.node.capacityMeshNodeId===a);if(p>=0){if(this.queuedCandidateNodes[p].g<=c)continue;this.queuedCandidateNodes.splice(p,1)}this.queuedCandidateNodes.push({prevCandidate:r,node:o,g:c,h:l,f:u})}}getNeighbors(e){let t=new Set,i=this.nodeEdgeMap.get(e.capacityMeshNodeId)??[];for(let s of i){let[o,a]=s.nodeIds,c=o===e.capacityMeshNodeId?a:o,l=this.nodeMap.get(c);l&&t.add(l)}let r=this.activeSubpath?.layer;return Array.from(t).filter(s=>s.capacityMeshNodeId===this.activeSubpath?.end.capacityMeshNodeId||!s._containsObstacle&&!s._containsTarget&&!this.usedNodeMap.has(s.capacityMeshNodeId)&&!(r!==void 0&&!s.availableZ.includes(r)))}clearCandidateNodes(){this.queuedCandidateNodes=[],this.visitedNodes=new Set}computeG(e,t,i){let r=this._dist(e.node,t);return e.g+r}computeH(e,t,i){return this._dist(t,i)}createSolvedRoute(e,t){let i=[];for(let r=0;r<e.length;r++){let s=e[r];s.path?r===0?i.push(...s.path):i.push(...s.path.slice(1)):(r===0&&i.push(s.start),r===e.length-1&&i.push(s.end))}return{connection:t.connection,path:i}}breakConnectionPairIntoSubpaths(e){var t,i;if(t=[this.hyperParameters.DIRECTIVE_SEED??0,this.solvedRoutes.length],i=this.hyperParameters.FORCE_VIA_TRAVEL_CHANCE??0,!(Dg(t.reduce((l,u)=>l+16807*u%2147483647,0))()<i))return[{start:e.start,end:e.end,solved:!1,layer:e.start.availableZ[0]??0}];let r=this.getClosestVia(e.start),s=this.getFarVia(r,e.end),o=e.start.availableZ[0]??0,a=e.end.availableZ[0]??0,c=[];return c.push({start:e.start,end:r,solved:!1,layer:o}),o===a?(c.push({start:r,end:s,solved:!1,layer:o===0?1:0}),c.push({start:s,end:e.end,solved:!1,layer:a})):c.push({start:r,end:e.end,solved:!1,layer:a}),c}getClosestVia(e){if(this.viaNodes.length===0)return e;let t=new Set;for(let[s,o]of this.closestViaForConnectionStartMap)s!==this.activeConnectionPair&&t.add(o.capacityMeshNodeId);for(let[s,o]of this.closestViaForConnectionEndMap)s!==this.activeConnectionPair&&t.add(o.capacityMeshNodeId);let i=this.viaNodes.filter(s=>!s._completelyInsideObstacle&&!s._containsObstacle).filter(s=>!this.usedNodeMap.has(s.capacityMeshNodeId)).filter(s=>!t.has(s.capacityMeshNodeId));if(i.length===0){let s=this.viaNodes.filter(o=>!o._completelyInsideObstacle&&!o._containsObstacle).filter(o=>!this.usedNodeMap.has(o.capacityMeshNodeId));return s.length===0?e:(s.sort((o,a)=>this._dist(o,e)-this._dist(a,e)),s[0])}i.sort((s,o)=>this._dist(s,e)-this._dist(o,e));let r=this.hyperParameters.MAX_CLOSEST_VIA_SKIP??0;if(r>0&&i.length>1){let s=Dg((this.hyperParameters.DIRECTIVE_SEED??0)+this.solvedRoutes.length),o=Math.floor(s()*(r+1));return i[Math.min(o,i.length-1)]}return i[0]}getFarVia(e,t){if(this.viaNodes.length===0)return e;let i=this.hyperParameters.FAR_VIA_MIN_DISTANCE!=null?this.hyperParameters.FAR_VIA_MIN_DISTANCE:50,r=new Set;for(let[a,c]of this.closestViaForConnectionStartMap)a!==this.activeConnectionPair&&r.add(c.capacityMeshNodeId);for(let[a,c]of this.closestViaForConnectionEndMap)a!==this.activeConnectionPair&&r.add(c.capacityMeshNodeId);let s=this.viaNodes.filter(a=>!this.usedNodeMap.has(a.capacityMeshNodeId)&&a.capacityMeshNodeId!==e.capacityMeshNodeId&&!a._completelyInsideObstacle&&!a._containsObstacle&&!r.has(a.capacityMeshNodeId)&&this._dist(a,e)>=i);if(s.length===0){let a=this.viaNodes.filter(c=>c.capacityMeshNodeId!==e.capacityMeshNodeId&&!c._completelyInsideObstacle&&!c._containsObstacle&&!this.usedNodeMap.has(c.capacityMeshNodeId)&&this._dist(c,e)>=i).sort((c,l)=>this._dist(c,t)-this._dist(l,t));return a.length>0?a[0]:this.viaNodes.filter(c=>c.capacityMeshNodeId!==e.capacityMeshNodeId&&!c._completelyInsideObstacle&&!c._containsObstacle&&!this.usedNodeMap.has(c.capacityMeshNodeId)).sort((c,l)=>this._dist(c,t)-this._dist(l,t))[0]??e}s.sort((a,c)=>this._dist(a,t)-this._dist(c,t));let o=this.hyperParameters.MAX_FURTHEST_VIA_SKIP??0;if(o>0&&s.length>1){let a=Dg((this.hyperParameters.DIRECTIVE_SEED??0)+this.solvedRoutes.length+1e3),c=Math.floor(a()*(o+1));return s[Math.min(c,s.length-1)]}return s[0]}getCapacityPaths(){let e=[];for(let t of this.solvedRoutes){let i=t.path;i&&i.length>0&&e.push({capacityPathId:t.connection.name,connectionName:t.connection.name,nodeIds:i.map(r=>r.capacityMeshNodeId)})}return e}visualize(){let e={lines:[],points:[],rects:[],circles:[]},t=s=>!!s&&typeof s.x=="number"&&typeof s.y=="number"&&!Number.isNaN(s.x)&&!Number.isNaN(s.y)&&Number.isFinite(s.x)&&Number.isFinite(s.y),i=s=>typeof s=="number"&&!Number.isNaN(s)&&Number.isFinite(s);for(let s of this.nodes){let o=this.queuedCandidateNodes.some(c=>c.node.capacityMeshNodeId===s.capacityMeshNodeId),a=this.queuedCandidateNodes.find(c=>c.node.capacityMeshNodeId===s.capacityMeshNodeId);if(t(s.center)&&i(s.width)&&i(s.height)){let c=so(s,{rectMargin:.025,zOffset:.01});e.rects.push({...c,fill:o?"rgba(255, 128, 255, 0.5)":s._containsTarget?"rgba(0, 150, 255, 0.15)":s._containsObstacle?"rgba(255, 0, 0, 0.1)":"rgba(200, 200, 200, 0.05)",label:[`ID: ${s.capacityMeshNodeId}`,`Size: ${s.width.toFixed(2)}x${s.height.toFixed(2)}`,`Z: ${s.availableZ.join(", ")}`,a?`g: ${a.g.toFixed(2)}`:"",a?`h: ${a.h.toFixed(2)}`:"",a?`f: ${a.f.toFixed(2)}`:"",s._containsTarget?"TARGET":"",s._containsObstacle?"OBSTACLE":""].filter(l=>l).join(`
`)})}}for(let s of this.edges){let[o,a]=s.nodeIds,c=this.nodeMap.get(o),l=this.nodeMap.get(a);c?.center&&l?.center&&t(c.center)&&t(l.center)&&e.lines.push({points:[c.center,l.center],strokeColor:"rgba(150, 150, 150, 0.2)"})}for(let s=0;s<this.solvedRoutes.length;s++){let o=this.solvedRoutes[s],a=o.path,c="blue";for(let l=0;l<a.length-1;l++){let u=a[l],p=a[l+1];if(u?.center&&p?.center&&t(u.center)&&t(p.center)){let f=u.availableZ.includes(1)&&p.availableZ.includes(1),y=s%5*.02;e.lines.push({points:[{x:u.center.x+y,y:u.center.y+y},{x:p.center.x+y,y:p.center.y+y}],strokeColor:c,strokeDash:f?"5 5":void 0})}}if(a.length>0){let l=a[0],u=a[a.length-1];l?.center&&t(l.center)&&e.points.push({x:l.center.x,y:l.center.y,label:`START: ${o.connection.name}`}),u?.center&&t(u.center)&&e.points.push({x:u.center.x,y:u.center.y,label:`END: ${o.connection.name}`})}}if(this.solvedSubpaths)for(let s=0;s<this.solvedSubpaths.length;s++){let o=this.solvedSubpaths[s];if(o.path&&o.path.length>1)for(let a=0;a<o.path.length-1;a++){let c=o.path[a],l=o.path[a+1];c?.center&&l?.center&&t(c.center)&&t(l.center)&&e.lines.push({points:[c.center,l.center],strokeColor:"green",strokeDash:o.layer===1?"3 3":void 0})}}if(this.activeSubpath){let s=this.activeSubpath.start?.center,o=this.activeSubpath.end?.center;s&&o&&t(s)&&t(o)&&(e.lines.push({points:[s,o],strokeColor:"orange",strokeDash:"5 5"}),e.points.push({x:s.x,y:s.y,label:"ACTIVE START"}),e.points.push({x:o.x,y:o.y,label:"ACTIVE END"}))}let r=this.queuedCandidateNodes.slice(0,10).sort((s,o)=>s.f-o.f);for(let s=0;s<r.length;s++){let o=.6*(1-s/10),a=[],c=r[s];for(;c;)a.push(c.node),c=c.prevCandidate;if(a.reverse(),a.length>1){let l=a.map(u=>u.center).filter(u=>t(u));l.length>1&&e.lines.push({points:l,strokeColor:Qn("purple",1-o),strokeDash:this.activeSubpath?.layer===1?"4 2":void 0})}}if(this.activeConnectionPair){let s=this.activeConnectionPair.start?.center,o=this.activeConnectionPair.end?.center;s&&o&&t(s)&&t(o)&&e.lines.push({points:[s,o],strokeColor:"cyan",strokeDash:"20 5"})}if(this.ogUnprocessedSubpaths&&this.ogUnprocessedSubpaths.length===3){let[,s]=this.ogUnprocessedSubpaths;if(s.start?.center&&t(s.start.center)){let o=Math.max(s.start.width||0,s.start.height||0);i(o)&&o>0&&(e.circles.push({center:s.start.center,radius:o,stroke:"blue"}),e.points.push({x:s.start.center.x,y:s.start.center.y,label:"DIRECTIVE VIA 1"}))}if(s.end?.center&&t(s.end.center)){let o=Math.max(s.end.width||0,s.end.height||0);i(o)&&o>0&&(e.circles.push({center:s.end.center,radius:o,stroke:"purple"}),e.points.push({x:s.end.center.x,y:s.end.center.y,label:"DIRECTIVE VIA 2"}))}}if(this.queuedCandidateNodes.length>0)for(let s of this.queuedCandidateNodes){let o=s.node;o?.center&&t(o.center)&&e.circles.push({center:o.center,radius:.05,fill:"rgba(255, 255, 0, 0.6)",stroke:"yellow"})}if(this.visitedNodes.size>0)for(let s of this.visitedNodes){let o=this.nodeMap.get(s);o?.center&&t(o.center)&&e.circles.push({center:o.center,radius:.08,fill:"rgba(128, 128, 128, 0.5)",stroke:"gray"})}return e}},ZCt=class extends U4{constructor(e){super();d(this,"constructorParams");this.constructorParams=e,this.MAX_ITERATIONS=e.MAX_ITERATIONS??12e4,this.MIN_SUBSTEPS=5,this.GREEDY_MULTIPLIER=1.35}getHyperParameterDefs(){return[{name:"traceOrderingSeed",possibleValues:[{SHUFFLE_SEED:0},{SHUFFLE_SEED:1},{SHUFFLE_SEED:2},{SHUFFLE_SEED:3},{SHUFFLE_SEED:4},{SHUFFLE_SEED:5},{SHUFFLE_SEED:6},{SHUFFLE_SEED:7},{SHUFFLE_SEED:8},{SHUFFLE_SEED:9}]},{name:"forceViaTravelChance",possibleValues:[{FORCE_VIA_TRAVEL_CHANCE:.6},{FORCE_VIA_TRAVEL_CHANCE:.8},{FORCE_VIA_TRAVEL_CHANCE:.9}]}]}computeG(e){let t=e.unprocessedConnectionPairs.length+e.solvedRoutes.length+(e.activeConnectionPair?1:0),i=e.solvedRoutes.length,r=t>0?i/t:0;return e.iterations/e.MAX_ITERATIONS+(1-r)}computeH(e){let t=e.unprocessedConnectionPairs.length+e.solvedRoutes.length+(e.activeConnectionPair?1:0),i=e.solvedRoutes.length;return t>0?1-i/t:0}generateSolver(e){return new qCt({...this.constructorParams,hyperParameters:{...this.constructorParams.hyperParameters,...e}})}};function mr(n,e,t,i={}){return{solverName:n,solverClass:e,getConstructorParams:t,onSolved:i.onSolved}}var KCt=class extends an{constructor(e,t={}){super();d(this,"netToPointPairsSolver");d(this,"nodeSolver");d(this,"nodeTargetMerger");d(this,"edgeSolver");d(this,"initialPathingSolver");d(this,"initialPathingHyperSolver");d(this,"pathingOptimizer");d(this,"edgeToPortSegmentSolver");d(this,"colorMap");d(this,"segmentToPointSolver");d(this,"unravelMultiSectionSolver");d(this,"segmentToPointOptimizer");d(this,"highDensityRouteSolver");d(this,"highDensityStitchSolver");d(this,"singleLayerNodeMerger");d(this,"mergeAssignableViaNodes");d(this,"strawSolver");d(this,"deadEndSolver");d(this,"uselessViaRemovalSolver1");d(this,"uselessViaRemovalSolver2");d(this,"multiSimplifiedPathSolver1");d(this,"multiSimplifiedPathSolver2");d(this,"startTimeOfPhase");d(this,"endTimeOfPhase");d(this,"timeSpentOnPhase");d(this,"activeSubSolver",null);d(this,"connMap");d(this,"srjWithPointPairs");d(this,"capacityNodes",null);d(this,"capacityEdges",null);d(this,"cacheProvider",null);d(this,"pipelineDef",[mr("netToPointPairsSolver",dZ,e=>[e.srj,e.colorMap],{onSolved:e=>{e.srjWithPointPairs=e.netToPointPairsSolver?.getNewSimpleRouteJson(),e.colorMap=Yg(e.srjWithPointPairs,this.connMap),e.connMap=WS(e.srjWithPointPairs)}}),mr("nodeSolver",GCt,e=>[e.netToPointPairsSolver?.getNewSimpleRouteJson()||e.srj,e.opts],{onSolved:e=>{e.capacityNodes=e.nodeSolver?.finishedNodes}}),mr("mergeAssignableViaNodes",WCt,e=>[e.nodeSolver?.finishedNodes],{onSolved:e=>{e.capacityNodes=e.mergeAssignableViaNodes?.newNodes}}),mr("singleLayerNodeMerger",HCt,e=>[e.capacityNodes],{onSolved:e=>{e.capacityNodes=e.singleLayerNodeMerger?.newNodes}}),mr("edgeSolver",SZ,e=>[e.capacityNodes],{onSolved:e=>{e.capacityEdges=e.edgeSolver?.edges}}),mr("deadEndSolver",wZ,e=>[{nodes:e.capacityNodes,edges:e.capacityEdges}],{onSolved:e=>{let t=e.deadEndSolver?.removedNodeIds;e.capacityNodes=e.capacityNodes.filter(i=>!t.has(i.capacityMeshNodeId)),e.capacityEdges=e.capacityEdges.filter(i=>i.nodeIds.every(r=>!t.has(r)))}}),mr("initialPathingHyperSolver",ZCt,e=>[{simpleRouteJson:e.srjWithPointPairs,nodes:e.capacityNodes,edges:e.capacityEdges||[],colorMap:e.colorMap,hyperParameters:{MAX_CAPACITY_FACTOR:1}}],{onSolved:e=>{let t=e.initialPathingHyperSolver?.winningSolver;t&&(e.initialPathingSolver=t)}}),mr("edgeToPortSegmentSolver",iZ,e=>[{nodes:e.capacityNodes,edges:e.capacityEdges||[],capacityPaths:e.initialPathingSolver?.getCapacityPaths()||[],colorMap:e.colorMap}]),mr("segmentToPointSolver",rZ,e=>{let t=[];return e.edgeToPortSegmentSolver?.nodePortSegments&&e.edgeToPortSegmentSolver.nodePortSegments.forEach(i=>{t.push(...i)}),[{segments:t,colorMap:e.colorMap,nodes:e.capacityNodes}]}),mr("unravelMultiSectionSolver",xZ,e=>[{assignedSegments:e.segmentToPointSolver?.solvedSegments||[],colorMap:e.colorMap,nodes:e.capacityNodes,cacheProvider:this.cacheProvider}]),mr("highDensityRouteSolver",pZ,e=>[{nodePortPoints:e.unravelMultiSectionSolver?.getNodesWithPortPoints()??e.segmentToPointOptimizer?.getNodesWithPortPoints()??[],colorMap:e.colorMap,connMap:e.connMap}]),mr("highDensityStitchSolver",mZ,e=>[{connections:e.srjWithPointPairs.connections,hdRoutes:e.highDensityRouteSolver.routes,colorMap:e.colorMap,layerCount:e.srj.layerCount}]),mr("uselessViaRemovalSolver1",JS,e=>[{unsimplifiedHdRoutes:e.highDensityStitchSolver.mergedHdRoutes,obstacles:e.srj.obstacles,colorMap:e.colorMap,layerCount:e.srj.layerCount}]),mr("multiSimplifiedPathSolver1",KS,e=>[{unsimplifiedHdRoutes:e.uselessViaRemovalSolver1?.getOptimizedHdRoutes()||e.highDensityStitchSolver.mergedHdRoutes,obstacles:e.srj.obstacles,connMap:e.connMap,colorMap:e.colorMap,outline:e.srj.outline}]),mr("uselessViaRemovalSolver2",JS,e=>[{unsimplifiedHdRoutes:e.multiSimplifiedPathSolver1.simplifiedHdRoutes,obstacles:e.srj.obstacles,colorMap:e.colorMap,layerCount:e.srj.layerCount}]),mr("multiSimplifiedPathSolver2",KS,e=>[{unsimplifiedHdRoutes:e.uselessViaRemovalSolver2?.getOptimizedHdRoutes(),obstacles:e.srj.obstacles,connMap:e.connMap,colorMap:e.colorMap,outline:e.srj.outline}])]);d(this,"currentPipelineStepIndex",0);if(this.srj=e,this.opts=t,this.MAX_ITERATIONS=1e8,t.capacityDepth===void 0){let i=e.bounds.maxX-e.bounds.minX,r=e.bounds.maxY-e.bounds.minY,s=Math.max(i,r),o=t.targetMinCapacity??.5;t.capacityDepth=X4(s,o)}this.connMap=WS(e),this.colorMap=Yg(e,this.connMap),this.cacheProvider=t.cacheProvider===void 0?__():t.cacheProvider===null?null:t.cacheProvider,this.startTimeOfPhase={},this.endTimeOfPhase={},this.timeSpentOnPhase={}}_step(){let e=this.pipelineDef[this.currentPipelineStepIndex];if(!e)return void(this.solved=!0);if(this.activeSubSolver)return this.activeSubSolver.step(),void(this.activeSubSolver.solved?(this.endTimeOfPhase[e.solverName]=performance.now(),this.timeSpentOnPhase[e.solverName]=this.endTimeOfPhase[e.solverName]-this.startTimeOfPhase[e.solverName],e.onSolved?.(this),this.activeSubSolver=null,this.currentPipelineStepIndex++):this.activeSubSolver.failed&&(this.error=this.activeSubSolver?.error,this.failed=!0,this.activeSubSolver=null));let t=e.getConstructorParams(this);this.activeSubSolver=new e.solverClass(...t),this[e.solverName]=this.activeSubSolver,this.timeSpentOnPhase[e.solverName]=0,this.startTimeOfPhase[e.solverName]=performance.now()}solveUntilPhase(e){for(;this.getCurrentPhase()!==e;)this.step()}getCurrentPhase(){return this.pipelineDef[this.currentPipelineStepIndex]?.solverName??"none"}visualize(){if(!this.solved&&this.activeSubSolver)return this.activeSubSolver.visualize();let e=this.netToPointPairsSolver?.visualize(),t=this.nodeSolver?.visualize(),i=this.nodeTargetMerger?.visualize(),r=this.mergeAssignableViaNodes?.visualize(),s=this.singleLayerNodeMerger?.visualize(),o=this.strawSolver?.visualize(),a=this.edgeSolver?.visualize(),c=this.deadEndSolver?.visualize(),l=this.initialPathingSolver?.visualize(),u=this.pathingOptimizer?.visualize(),p=this.edgeToPortSegmentSolver?.visualize(),f=this.segmentToPointSolver?.visualize(),y=this.unravelMultiSectionSolver?.visualize()??this.segmentToPointOptimizer?.visualize(),g=this.highDensityRouteSolver?.visualize(),x=this.highDensityStitchSolver?.visualize(),v=this.uselessViaRemovalSolver1?.visualize(),P=this.uselessViaRemovalSolver2?.visualize(),w=this.multiSimplifiedPathSolver1?.visualize(),k=this.multiSimplifiedPathSolver2?.visualize(),T=this.srj.outline,I=[];if(I.push({points:[{x:this.srj.bounds?.minX??-50,y:this.srj.bounds?.minY??-50},{x:this.srj.bounds?.maxX??50,y:this.srj.bounds?.minY??-50},{x:this.srj.bounds?.maxX??50,y:this.srj.bounds?.maxY??50},{x:this.srj.bounds?.minX??-50,y:this.srj.bounds?.maxY??50},{x:this.srj.bounds?.minX??-50,y:this.srj.bounds?.minY??-50}],strokeColor:"rgba(255,0,0,0.25)"}),T&&T.length>=2){let M=T.map(A=>({x:A.x,y:A.y}));M.push({...M[0]}),I.push({points:M,strokeColor:"rgba(0, 136, 255, 0.95)"})}let E={points:[...this.srj.connections.flatMap(M=>M.pointsToConnect.map(A=>({...A,label:`${M.name} ${A.pcb_port_id??""}`})))],rects:[...(this.srj.obstacles??[]).map(M=>({...M,fill:M.layers?.includes("top")?"rgba(255,0,0,0.25)":M.layers?.includes("bottom")?"rgba(0,0,255,0.25)":"rgba(255,0,0,0.25)",label:M.layers?.join(", ")}))],lines:I},N=[E,e,t,i,r,s,o,a,c,l,u,p,f,y,g?ud(E,g):null,x,v,w,P,k,this.solved?ud(E,Vg(this.getOutputSimpleRouteJson())):null].filter(Boolean);return ud(...N)}preview(){if(this.highDensityRouteSolver){let e=[];for(let t=this.highDensityRouteSolver.routes.length-1;t>=0;t--){let i=this.highDensityRouteSolver.routes[t];if(e.push({points:i.route.map(r=>({x:r.x,y:r.y})),strokeColor:this.colorMap[i.connectionName]}),e.length>200)break}return{lines:e}}if(this.pathingOptimizer){let e=[];for(let t of this.pathingOptimizer.connectionsWithNodes)t.path&&e.push({points:t.path.map(i=>({x:i.center.x,y:i.center.y})),strokeColor:this.colorMap[t.connection.name]});return{lines:e}}return this.netToPointPairsSolver?this.netToPointPairsSolver?.visualize():{}}getOriginalConnectionName(e){let t=e.match(/^(.+?)_mst\d+$/);return t?t[1]:e}_getOutputHdRoutes(){return this.multiSimplifiedPathSolver2?.simplifiedHdRoutes??this.uselessViaRemovalSolver2?.getOptimizedHdRoutes()??this.multiSimplifiedPathSolver1?.simplifiedHdRoutes??this.uselessViaRemovalSolver1?.getOptimizedHdRoutes()??this.highDensityStitchSolver.mergedHdRoutes}getOutputSimplifiedPcbTraces(){if(!this.solved||!this.highDensityRouteSolver)throw new Error("Cannot get output before solving is complete");let e=[],t=this._getOutputHdRoutes();for(let i of this.netToPointPairsSolver?.newConnections??[]){let r=this.srj.connections.find(o=>o.name===i.name)?.netConnectionName,s=t.filter(o=>o.connectionName===i.name);for(let o=0;o<s.length;o++){let a=s[o],c={type:"pcb_trace",pcb_trace_id:`${i.name}_${o}`,connection_name:r??this.getOriginalConnectionName(i.name),route:fZ(a,this.srj.layerCount)};e.push(c)}}return e}getOutputSimpleRouteJson(){return{...this.srj,traces:this.getOutputSimplifiedPcbTraces()}}};St();var U_=Gt(Mn(),1);Ae();Ae();Ae();Ae();Ae();ir();Ae();Ae();Ae();var JCt=Object.defineProperty,kZ=Object.getOwnPropertySymbols,QCt=Object.prototype.hasOwnProperty,tIt=Object.prototype.propertyIsEnumerable,TZ=(n,e,t)=>e in n?JCt(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,EZ=(n,e)=>{for(var t in e||(e={}))QCt.call(e,t)&&TZ(n,t,e[t]);if(kZ)for(var t of kZ(e))tIt.call(e,t)&&TZ(n,t,e[t]);return n},eIt=n=>{switch(n){case"left":return{x:-1,y:0};case"right":return{x:1,y:0};case"top":return{x:0,y:1};case"bottom":return{x:0,y:-1}}},nIt=n=>{var e,t;let i=Ke(n).schematic_component.list(),r=Ke(n).schematic_net_label.list(),s=Ke(n).schematic_port.list(),o={};for(let a of i){let c=Ke(n).source_component.get(a.source_component_id);o[a.schematic_component_id]=c?.name}for(let a of r){let c=Ke(n).source_net.get(a.source_net_id);if(!c?.name)continue;let l=0;for(;Object.values(o).includes(`NL_${c.name}${l}`);)l++;o[a.schematic_net_label_id]=`NL_${c.name}${l}`}for(let a of s){let c=Ke(n).source_port.get(a.source_port_id);if(!c)continue;let l=Ke(n).source_component.get(c.source_component_id);if(!l?.name)continue;let u=`${l.name}_${(t=(e=c?.name)!=null?e:c?.pin_number)!=null?t:""}`;o[a.schematic_port_id]=u}return o},iIt=n=>{var e;let t=Ke(n),i=new Set(t.schematic_net_label.list().map(s=>{var o,a,c,l;return`${(a=(o=s.anchor_position)==null?void 0:o.x)!=null?a:s.center.x},${(l=(c=s.anchor_position)==null?void 0:c.y)!=null?l:s.center.y}`})),r=[];for(let s of t.schematic_port.list()){let o=`${s.center.x},${s.center.y}`;if(i.has(o))continue;let a=t.source_port.get(s.source_port_id);if(!a)continue;let c=t.source_net.getWhere({subcircuit_connectivity_map_key:a.subcircuit_connectivity_map_key});if(!c)continue;let l=t.source_trace.list().find(y=>{var g;return(g=y.connected_source_port_ids)==null?void 0:g.includes(s.source_port_id)}),u=t.schematic_trace.getWhere({source_trace_id:l?.source_trace_id}),f={type:"schematic_net_label",schematic_net_label_id:`netlabel_for_${s.schematic_port_id}`,schematic_port_id:s.schematic_port_id,text:c.name,source_net_id:c.source_net_id,source_trace_id:l?.source_trace_id,schematic_trace_id:u?.schematic_trace_id,anchor_position:EZ({},s.center),center:EZ({},s.center),anchor_side:sq((e=s.facing_direction)!=null?e:"right")};r.push(f)}return r},W4=(n,e={})=>{let t={boxes:[],pins:[]},i=Ke(n).schematic_component.list(),r=Ke(n).schematic_net_label.list();e.inferNetLabels&&(r=r.concat(iIt(n)));let s=e.useReadableIds?nIt(n):{},o=c=>e.useReadableIds&&s[c]?s[c]:c,a=0;for(let c of i){let l={boxId:o(c.schematic_component_id),kind:"floating",center:c.center};t.boxes.push(l);let u={pinId:`${o(c.schematic_component_id)}_center`,color:"component_center",networkId:`center_${c.schematic_component_id}`,offset:{x:0,y:0},boxId:o(c.schematic_component_id)};t.pins.push(u);let p=Ke(n).schematic_port.list({schematic_component_id:c.schematic_component_id});for(let f of p){let y=Ke(n).source_port.get(f.source_port_id),g=y?.subcircuit_connectivity_map_key,x="normal";if(g){let P=Ke(n).source_net.getWhere({subcircuit_connectivity_map_key:y?.subcircuit_connectivity_map_key});P&&(P.is_power||P.name.startsWith("V"))&&(x="vcc"),P&&(P.is_ground||P.name.startsWith("GND"))&&(x="gnd")}else g=`disconnected-${a++}`,x="not_connected";let v={pinId:o(f.schematic_port_id),color:x,networkId:g,offset:{x:f.center.x-l.center.x,y:f.center.y-l.center.y},boxId:o(c.schematic_component_id)};t.pins.push(v)}}for(let c of r){let l=Ke(n).source_net.get(c.source_net_id),u=l?.subcircuit_connectivity_map_key,p="normal";u?(l&&(l.is_power||l.name.startsWith("V"))&&(p="vcc"),l&&(l.is_ground||l.name.startsWith("GND"))&&(p="gnd")):(u=`disconnected-${a++}`,p="not_connected");let f=eIt(c.anchor_side),y={x:c.anchor_position.x-f.x*c.text.length*.18*.5,y:c.anchor_position.y-f.y*.18},g={x:0,y:0};c.anchor_position&&(g={x:c.anchor_position.x-y.x,y:c.anchor_position.y-y.y});let x={boxId:o(c.schematic_net_label_id),kind:"fixed",center:y,boxAttributes:{is_net_label:!0,source_net_id:c.source_net_id,source_trace_id:c.source_trace_id}};t.boxes.push(x);let v={pinId:`${o(c.schematic_net_label_id)}_pin`,boxId:o(c.schematic_net_label_id),networkId:u,color:p,offset:g};t.pins.push(v),t.pins.push({pinId:`${o(c.schematic_net_label_id)}_center`,boxId:o(c.schematic_net_label_id),networkId:`${o(c.schematic_net_label_id)}_center`,color:"netlabel_center",offset:{x:0,y:0}})}return t};var ew=.6,nw=1;si();var S5t=Gt(as(),1),w5t=Gt(UK(),1);function dw(n,e,t){return{...n,points:n.points?.map(i=>({...i,x:i.x+e,y:i.y+t})),lines:n.lines?.map(i=>({...i,points:i.points.map(r=>({x:r.x+e,y:r.y+t}))})),rects:n.rects?.map(i=>({...i,center:{x:i.center.x+e,y:i.center.y+t}})),circles:n.circles?.map(i=>({...i,center:{x:i.center.x+e,y:i.center.y+t}})),texts:n.texts?.map(i=>({...i,x:i.x+e,y:i.y+t}))}}si();function Ur(n){let e=[...n.points||[],...(n.lines||[]).flatMap(t=>t.points),...(n.rects||[]).flatMap(t=>{let i=t.width/2,r=t.height/2;return[{x:t.center.x-i,y:t.center.y-r},{x:t.center.x+i,y:t.center.y-r},{x:t.center.x-i,y:t.center.y+r},{x:t.center.x+i,y:t.center.y+r}]}),...(n.circles||[]).flatMap(t=>[{x:t.center.x-t.radius,y:t.center.y},{x:t.center.x+t.radius,y:t.center.y},{x:t.center.x,y:t.center.y-t.radius},{x:t.center.x,y:t.center.y+t.radius}]),...(n.texts||[]).flatMap(t=>{let i=t.fontSize??12,r=t.text.length*i*ew,s=i*nw,o=t.anchorSide??"center",a={top_left:{dx:0,dy:0},top_center:{dx:-r/2,dy:0},top_right:{dx:-r,dy:0},center_left:{dx:0,dy:-s/2},center:{dx:-r/2,dy:-s/2},center_right:{dx:-r,dy:-s/2},bottom_left:{dx:0,dy:-s},bottom_center:{dx:-r/2,dy:-s},bottom_right:{dx:-r,dy:-s}},{dx:c,dy:l}=a[o],u=t.x+c,p=t.y+l;return[{x:u,y:p},{x:u+r,y:p+s}]})];return e.length===0?{minX:-1,maxX:1,minY:-1,maxY:1}:e.reduce((t,i)=>({minX:Math.min(t.minX,i.x),maxX:Math.max(t.maxX,i.x),minY:Math.min(t.minY,i.y),maxY:Math.max(t.maxY,i.y)}),{minX:1/0,maxX:-1/0,minY:1/0,maxY:-1/0})}var y_=(n,e)=>({...n,rects:[...n.rects??[],...e.rects??[]],points:[...n.points??[],...e.points??[]],lines:[...n.lines??[],...e.lines??[]],circles:[...n.circles??[],...e.circles??[]],texts:[...n.texts??[],...e.texts??[]]});function md(n,e={}){if(n.length===0)return{};let t=n[0],i=Ur(t),r=i.minY,s=[i];for(let o=1;o<n.length;o++){let a=n[o],c=Ur(a),l=i.maxX-i.minX,u=c.maxX-c.minX,p=(l+u)/8,f=i.maxX+p-c.minX,y=r-c.minY,g=dw(a,f,y);t=y_(t,g),i=Ur(g),s.push(i)}if(e.titles&&e.titles.length>0){let o=Ur(t),c=(o.maxX-o.minX)*.025,l=e.titles.slice(0,s.length).map((u,p)=>{let f=s[p];return{x:(f.minX+f.maxX)/2,y:f.maxY+c,text:u,fontSize:c,anchorSide:"bottom_center"}});t=y_(t,{texts:l})}return t}function i1(n,e={}){if(n.length===0)return{};let t=n[0],i=Ur(t),r=i.minX,s=[i];for(let o=1;o<n.length;o++){let a=n[o],c=Ur(a),l=i.maxY-i.minY,u=c.maxY-c.minY,p=(l+u)/8,f=r-c.minX,y=i.minY-p-c.maxY,g=dw(a,f,y);t=y_(t,g),i=Ur(g),s.push(i)}if(e.titles&&e.titles.length>0){let o=Ur(t),c=(o.maxY-o.minY)*.025,l=e.titles.slice(0,s.length).map((u,p)=>{let f=s[p];return{x:f.minX-c,y:f.maxY,text:u,fontSize:c,anchorSide:"top_right"}});t=y_(t,{texts:l})}return t}var JK=Gt(Mn(),1);var T5t=n=>n?"x"in n&&"y"in n?n:"center"in n?n.center:{x:(n.minX+n.maxX)/2,y:(n.minY+n.maxY)/2}:{x:0,y:0},yw=(n,e)=>{let t=n.boxes.find(l=>l.boxId===e),i=n.pins.filter(l=>l.boxId===e);if(!t)throw new Error(`Box "${e}" not found`);let r=t.center??{x:0,y:0},s=1/0,o=1/0,a=-1/0,c=-1/0;for(let l of i)s=Math.min(s,l.offset.x+r.x),o=Math.min(o,l.offset.y+r.y),a=Math.max(a,l.offset.x+r.x),c=Math.max(c,l.offset.y+r.y);return{minX:s,minY:o,maxX:a,maxY:c}},g_=(n,e,t)=>`hsl(${n*360/e}, 100%, 50%, ${t??1})`;var E5t=n=>{let e=new Set;for(let t of n.pins)e.add(t.networkId);return Array.from(e)},VK={not_connected:"rgba(0, 0, 0, 0.2)",normal:"blue",vcc:"orange",gnd:"purple",component_center:"gray"},M5t=["red","green","blue","yellow","purple","orange","brown","gray","black","white"];function C5t(n){let e=0;for(let t=0;t<n.length;t++)e=(e<<5)-e+n.charCodeAt(t);return e}var ZK=n=>n.startsWith("rgb")||n.startsWith("hsl")||n.startsWith("#")||M5t.includes(n)?n:n in VK?VK[n]:g_(C5t(n)%50,50),il=(n,e)=>{let t={points:[],lines:[],rects:[],circles:[],texts:[],coordinateSystem:"cartesian",title:"BPC Graph Graphics"},i=new Map,r=new Map;for(let a of n.boxes){let c=yw(n,a.boxId),l=T5t(c);t.rects.push({label:a.boxId,center:l,width:c.maxX-c.minX+.1,height:c.maxY-c.minY+.1,fill:"rgba(0, 0, 0, 0.2)"});let u=n.pins.filter(f=>f.boxId===a.boxId),p=a.center??{x:0,y:0};for(let f of u){let y={x:f.offset.x+p.x,y:f.offset.y+p.y},g=`${y.x.toFixed(6)},${y.y.toFixed(6)}`;r.has(g)||r.set(g,[]),r.get(g).push({box:a,pin:f}),i.set(`${a.boxId}.${f.pinId}`,y)}}for(let[a,c]of r){let l=a.split(",").map(Number),u=l[0],p=l[1];for(let f=0;f<c.length;f++){let y=c[f],{box:g,pin:x}=y,v={x:u,y:p};if(c.length>1){let P=g.center??{x:0,y:0},w=P.x-u,k=P.y-p,T=Math.sqrt(w*w+k*k),I=0,E=0;if(T>0)I=w/T,E=k/T;else{let N=f*2*Math.PI/c.length;I=Math.cos(N),E=Math.sin(N)}v={x:u+.01*I,y:p+.01*E}}i.set(`${g.boxId}.${x.pinId}`,v),t.points.push({...v,label:[x.pinId,x.color,x.networkId].join(`
`),color:ZK(x.color)})}}let s=E5t(n);for(let a=0;a<s.length;a++){let c=s[a],l=g_(a,s.length,.5),p=n.pins.filter(f=>f.networkId===c).map(f=>({pin:f,position:i.get(`${f.boxId}.${f.pinId}`)}));for(let f=0;f<p.length;f++){let{position:y}=p[f];for(let g=f+1;g<p.length;g++){let{position:x}=p[g];t.lines.push({points:[y,x],strokeColor:e?.grayNetworks?"rgba(0, 0, 0, 0.05)":l})}}}let o=Ur(t);return e?.title&&(t.title=e.title,t.texts.push({text:e.title,x:o.minX,y:o.maxY,fontSize:(o.maxY-o.minY)*.05,anchorSide:"bottom_left"})),e?.caption&&t.texts.push({text:e.caption,x:o.minX,y:o.minY,fontSize:(o.maxY-o.minY)*.05,anchorSide:"top_left"}),t},fw=(n,e,t)=>{let i=n.pins.find(o=>o.pinId===t&&o.boxId===e);if(!i)throw new Error(`Pin "${t}" not found`);let r=n.boxes.find(o=>o.boxId===i.boxId);if(!r)throw new Error(`Box "${i.boxId}" not found`);let s=r.center??{x:0,y:0};return{x:i.offset.x+s.x,y:i.offset.y+s.y}},I5t=(n,e,t)=>{let i=typeof t=="string"?n.pins.find(y=>y.pinId===t&&y.boxId===e):t;if(!i)throw new Error(`Pin not found "${t}"`);if(!(typeof e=="string"?n.boxes.find(y=>y.boxId===e):e))throw new Error(`Box not found for pin "${t}" (looked for "${i.boxId}")`);let s=yw(n,i.boxId),o=fw(n,i.boxId,i.pinId),a=s.maxX-s.minX,c=s.maxY-s.minY;if(a===0&&c===0)return Math.abs(i.offset.x)>Math.abs(i.offset.y)?i.offset.x>0?"x+":"x-":i.offset.y>0?"y+":"y-";if(a===0){if(Math.abs(o.y-s.minY)<1e-4)return"y-";if(Math.abs(o.y-s.maxY)<1e-4)return"y+"}if(c===0){if(Math.abs(o.x-s.minX)<1e-4)return"x-";if(Math.abs(o.x-s.maxX)<1e-4)return"x+"}let l=Math.abs(o.x-s.minX)<1e-4,u=Math.abs(o.x-s.maxX)<1e-4,p=Math.abs(o.y-s.minY)<1e-4,f=Math.abs(o.y-s.maxY)<1e-4;if((l||u)&&(p||f))return i.offset.x>0?"x+":"x-";if(l)return"x-";if(u)return"x+";if(p)return"y-";if(f)return"y+";throw new Error(`Pin "${i.pinId}" not on the edge of the box "${i.boxId}" so we couldn't determine the direction`)},x_=(n,e,t)=>{try{return I5t(n,e,t)}catch{return null}};var N5t=n=>{let e=new Map,t=[];n.nodes.forEach((s,o)=>{e.set(s.id,o),t.push(s.id)});let i=n.nodes.length,r=Array.from({length:i},()=>Array.from({length:i},()=>0));for(let[s,o]of n.undirectedEdges){let a=e.get(s),c=e.get(o);a!==void 0&&c!==void 0&&a!==c&&(r[a][c]=1,r[c][a]=1)}for(let s=0;s<i;++s)r[s][s]=1;return{matrix:r,mapping:e,indexMapping:t}};var mw=n=>{var s;let e=[],t=[],i=new Map;for(let o of n.boxes)o.kind,i.set(o.boxId,o.center),e.push({id:o.boxId,boxId:o.boxId,color:"box",x:o.center?.x,y:o.center?.y});let r={};for(let o of n.pins){let a=`${o.boxId}-${o.pinId}`,c=i.get(o.boxId);e.push({id:a,boxId:o.boxId,pinId:o.pinId,color:o.color,x:c?c.x+o.offset.x:void 0,y:c?c.y+o.offset.y:void 0}),r[s=o.networkId]??(r[s]=[]),r[o.networkId].push(a)}for(let o of Object.values(r))for(let a=0;a<o.length;a++)for(let c=a+1;c<o.length;c++)t.push([o[a],o[c]]);for(let o of n.boxes)for(let a of n.pins)a.boxId===o.boxId&&t.push([o.boxId,`${o.boxId}-${a.pinId}`]);return{nodes:e,undirectedEdges:t}},A5t=(n,e,t={})=>{let i=n.length;if(n.some(a=>a.length!==i))throw new Error("adjMatrix must be square");let r=(t.nodeInitialColors??Array.from({length:i},()=>"_")).slice(),s=a=>{let c={};for(let l of a)c[l]=(c[l]??0)+1;return c},o=[];o.push(s(r));for(let a=0;a<e;a++){let c=Array(i);for(let l=0;l<i;l++){let u=[];for(let p=0;p<i;p++)n[l][p]&&u.push(r[p]);u.sort(),c[l]=`${r[l]}|${u.join(",")}`}r=c,o.push(s(r))}return o},R5t=(n,e)=>{let t=0,i=Math.min(n.length,e.length);for(let r=0;r<i;r++){let s=n[r],o=e[r],a=new Set([...Object.keys(s),...Object.keys(o)]),c=0,l=0;for(let u of a){let p=s[u]??0,f=o[u]??0;c+=Math.min(p,f),l+=Math.max(p,f)}t+=l===0?0:c/l}return t};var O5t=R5t,_w=2,gw=(n,e=_w)=>{let t=mw(n),{matrix:i,indexMapping:r}=N5t(t);return A5t(i,e,{nodeInitialColors:r.map(s=>t.nodes.find(o=>o.id===s)?.color??"_")})},vN=(n,e,{wlDegrees:t=_w}={})=>{let i=gw(n,t),r=gw(e,t);return(_w+1-O5t(i,r))/(_w+1)},L5t=n=>{let e=0;for(let t=0;t<n.length;t++)e=(e<<5)-e+n.charCodeAt(t);return Math.abs(e)},bN=(n,e={})=>{let t={points:[],lines:[],rects:[],circles:[],texts:[],coordinateSystem:"cartesian",title:"Flat-BPC Graphics"},i=new Map;for(let s of n.nodes){if(s.x===void 0||s.y===void 0)continue;let o={x:s.x,y:s.y};i.set(s.id,o),t.points.push({...o,color:ZK(s.color),label:s.id})}for(let[s,o]of n.undirectedEdges){let a=i.get(s),c=i.get(o);a&&c&&t.lines.push({points:[a,c],strokeColor:"rgba(0,0,0,0.3)"})}let r=Ur(t);return e.title&&t.texts.push({text:e.title,x:r.minX,y:r.maxY,fontSize:(r.maxY-r.minY)*.05,anchorSide:"bottom_left"}),e.caption&&t.texts.push({text:e.caption,x:r.minX,y:r.minY,fontSize:(r.maxY-r.minY)*.05,anchorSide:"top_left"}),t};var F5t=n=>{let e=new Map;for(let r of n.pins){let s=n.boxes.find(a=>a.boxId===r.boxId);if(!s||!s.center)throw new Error(`Expected fixed graph \u2013 box "${r.boxId}" missing or has no center`);let o={x:s.center.x+r.offset.x,y:s.center.y+r.offset.y};e.has(r.networkId)||e.set(r.networkId,[]),e.get(r.networkId).push(o)}let t=new Map,i=0;for(let[r,s]of e){if(s.length===0){t.set(r,0);continue}let o=s.reduce((c,l)=>({x:c.x+l.x,y:c.y+l.y}),{x:0,y:0});o.x/=s.length,o.y/=s.length;let a=s.reduce((c,l)=>{let u=l.x-o.x,p=l.y-o.y;return c+Math.sqrt(u*u+p*p)},0);t.set(r,a),i+=a}return{totalNetworkLength:i,networkLengths:t}},z5t=(n,e)=>{let t=n.pins.filter(r=>r.networkId===e),i=[];for(let r of t){let s=Math.atan2(r.offset.y,r.offset.x);i.push(s)}return i},GK=n=>{let e=new Map,t=Array.from(new Set(n.pins.map(i=>i.networkId)));for(let i of t){let r=z5t(n,i);e.set(i,r)}return e},$5t=(n,e)=>{let t=2*Math.PI,i=(n%t+t)%t,r=(e%t+t)%t,s=Math.abs(i-r);return Math.min(s,t-s)},D5t=(n,e)=>{if(n.length===0&&e.length===0)return 0;if(n.length===0||e.length===0)return Math.PI;let t=(i,r)=>{let s=0;for(let o of i){let a=1/0;for(let c of r){let l=$5t(o,c);l<a&&(a=l)}s+=a}return s/i.length};return(t(n,e)+t(e,n))/2},j5t=(n,e)=>{let t=new Map,i=Array.from(n.entries()),r=Array.from(e.entries()),s=i.length,o=r.length,a=Array.from({length:s},()=>new Array(o).fill(0));for(let f=0;f<s;f++){let[,y]=i[f];for(let g=0;g<o;g++){let[,x]=r[g];a[f][g]=D5t(y,x)}}let c=new Set(Array.from({length:s},(f,y)=>y)),l=new Set(Array.from({length:o},(f,y)=>y)),u=0;for(;c.size&&l.size;){let f=-1,y=-1,g=1/0;for(let P of c)for(let w of l){let k=a[P][w];k<g&&(g=k,f=P,y=w)}let[x]=i[f],[v]=r[y];t.set(x,v),u+=g,c.delete(f),l.delete(y)}let p=Math.PI;return u+=(c.size+l.size)*p,{networkMapping:t,distance:u}},HK=n=>{let e=Math.min(...n.map(s=>s.offset.x)),t=Math.max(...n.map(s=>s.offset.x)),i=Math.min(...n.map(s=>s.offset.y)),r=Math.max(...n.map(s=>s.offset.y));return{minX:e,maxX:t,minY:i,maxY:r}},B5t=(n,e)=>{let t=c=>{switch(c.side){case"x+":return c.cwDistanceFromCorner;case"y-":return 1+c.cwDistanceFromCorner;case"x-":return 2+c.cwDistanceFromCorner;case"y+":return 3+c.cwDistanceFromCorner}},i=t(n)%4,r=t(e)%4,s=(r-i+4)%4,o=(i-r+4)%4,a=Math.min(s,o);return{cwDistance:s,ccwDistance:o,minDistance:a}},Oa=1e-6,WK=(n,e)=>{let{minX:t,minY:i,maxX:r,maxY:s}=n,o=(l,u)=>Math.abs(l-u)<Oa,a,c;if(o(e.x,r)&&e.y>=i-Oa&&e.y<=s+Oa)a="x+",c=(s-e.y)/(s-i);else if(o(e.y,s)&&e.x<=r+Oa&&e.x>=t-Oa)a="y+",c=(e.x-t)/(r-t);else if(o(e.x,t)&&e.y<=s+Oa&&e.y>=i-Oa)a="x-",c=(e.y-i)/(s-i);else if(o(e.y,i)&&e.x>=t-Oa&&e.x<=r+Oa)a="y-",c=(r-e.x)/(r-t);else return null;return c=Math.min(1,Math.max(0,c)),{side:a,cwDistanceFromCorner:c}},Y5t=(n,e)=>{let t=[],i=new Set,r=new Set,s=new Set,o=new Set,a=HK(n),c=HK(e);for(let l of n){let u=e.filter(g=>g.color===l.color).filter(g=>!o.has(g.pinId));if(u.length===0){i.add(l.pinId);continue}let p=WK(a,l.offset);if(p===null){i.add(l.pinId);continue}let f=1/0,y=u[0];for(let g of u){let x=WK(c,g.offset);if(x===null)continue;let{minDistance:v}=B5t(p,x);v<f&&(f=v,y=g)}t.push([l,y]),s.add(l.pinId),o.add(y.pinId)}for(let l of e)o.has(l.pinId)||r.add(l.pinId);return{matchedPins:t,unmatchedPin1Ids:i,unmatchedPin2Ids:r}},X5t=class{constructor(n,e){d(this,"wipGraph");d(this,"iterations",0);d(this,"solved",!1);d(this,"acceptedFloatingBoxIds",new Set);d(this,"rejectedFloatingBoxIds",new Set);d(this,"acceptedFixedBoxIds",new Set);d(this,"assignment",new Map);d(this,"lastAcceptedEvaluation",null);d(this,"fixedToFloatingNetworkMap");d(this,"floatingToFixedNetworkMap");d(this,"lastComputedEvaluations",[]);this.floatingGraph=n,this.fixedGraph=e,this.wipGraph={pins:[],boxes:[]},this.fixedToFloatingNetworkMap=this.computeFixedToFloatingNetworkMap(),this.floatingToFixedNetworkMap=new Map(Array.from(this.fixedToFloatingNetworkMap.entries()).map(([t,i])=>[i,t]))}computeFixedToFloatingNetworkMap(){let n=GK(this.floatingGraph),e=GK(this.fixedGraph),{networkMapping:t}=j5t(e,n);return t}getNextFloatingBoxId(){let n=this.floatingGraph.boxes.map(i=>i.boxId).filter(i=>!this.acceptedFloatingBoxIds.has(i)&&!this.rejectedFloatingBoxIds.has(i));if(!n.length)throw new Error("No remaining floating box ids");let e=n[0],t=0;for(let i of n){let r=this.floatingGraph.pins.filter(s=>s.boxId===i);r.length>t&&(e=i,t=r.length)}return e}getRemainingFloatingBoxIds(){return this.floatingGraph.boxes.map(n=>n.boxId).filter(n=>!this.acceptedFloatingBoxIds.has(n)&&!this.rejectedFloatingBoxIds.has(n))}getPartialFloatingGraph(n){let e={pins:[],boxes:[]};for(let t of this.floatingGraph.boxes)(this.acceptedFloatingBoxIds.has(t.boxId)||t.boxId===n)&&(e.boxes.push(t),e.pins.push(...this.floatingGraph.pins.filter(i=>i.boxId===t.boxId)));return e}evaluateFloatingBoxAssignment(n){let e=this.getPartialFloatingGraph(n),t=vN(e,this.wipGraph),i=null,r=null,s={floatingBoxId:n,originalWipGraph:this.wipGraph,partialFloatingGraph:e,currentWlDist:t,networkLengths:new Map,wlDistances:new Map,wlVecs:new Map,wipGraphsWithAddedFixedBoxId:new Map},o=t,a=t,c=1/0,l=gw(e);for(let u of this.fixedGraph.boxes.map(p=>p.boxId)){if(this.acceptedFixedBoxIds.has(u))continue;let p=this.getWipGraphWithAddedFixedBoxIdForFloatingAssignment(u,n),f=vN(e,p),y=gw(p),{totalNetworkLength:g}=F5t(p);s.wipGraphsWithAddedFixedBoxId.set(u,p),s.wlVecs.set(u,y),s.wlDistances.set(u,f),s.networkLengths.set(u,g);let x=f+g/100;x<o&&(o=x,a=f,c=g,r=p,i=u)}return{bestFixedBoxId:i,bestNewWipGraph:r,bestDist:o,bestWlDist:a,bestTotalNetworkLength:c,lastDistanceEvaluation:s,nextFloatingBoxId:n,partialFloatingGraph:e,floatingBoxWlVec:l}}getPinAssignment(){let n={},e={};for(let[t,i]of this.assignment)n[t]={},e[i]=t;for(let t of this.wipGraph.pins){let i=t.boxId,r=e[i],s=t._floatingPinId,o=t._fixedPinId;n[r][s]=o}return n}step(){if(this.solved)return;if(this.iterations>1e3)throw new Error("Too many iterations");if(this.iterations++,this.iterations===1){let i=this.getNextFloatingBoxId(),r=this.evaluateFloatingBoxAssignment(i);this.lastComputedEvaluations=[r],this.acceptEvaluationResult(r);return}let n=this.getRemainingFloatingBoxIds();if(n.length===0){this.solved=!0;return}let e=1/0,t=null;this.lastComputedEvaluations=[];for(let i of n){let r=this.evaluateFloatingBoxAssignment(i);this.lastComputedEvaluations.push(r),r.bestDist<e&&(e=r.bestDist,t=r)}t&&this.acceptEvaluationResult(t)}acceptEvaluationResult(n){let{bestFixedBoxId:e,bestNewWipGraph:t,nextFloatingBoxId:i}=n;if(e===null){this.rejectedFloatingBoxIds.add(i);return}this.acceptedFloatingBoxIds.add(i),this.assignment.set(i,e),this.acceptedFixedBoxIds.add(e),this.wipGraph=t,this.lastAcceptedEvaluation=n.lastDistanceEvaluation}getWipGraphWithAddedFixedBoxIdForFloatingAssignment(n,e){let t=structuredClone(this.wipGraph),i=this.fixedGraph.boxes.find(a=>a.boxId===n);t.boxes.push(i);let r=this.floatingGraph.pins.filter(a=>a.boxId===e),s=this.fixedGraph.pins.filter(a=>a.boxId===n),{matchedPins:o}=Y5t(r,s);return t.pins.push(...o.map(a=>{let[c,l]=a;return{...l,networkId:this.floatingToFixedNetworkMap.get(c.networkId),_floatingPinId:c.pinId,_fixedPinId:l.pinId}})),t}visualize(){let n=il(this.floatingGraph,{title:"Floating"}),e=il(this.wipGraph,{title:"WIP"}),t=il(this.fixedGraph,{title:"Fixed"}),i=il(this.getPartialFloatingGraph(),{title:"Partial Floating"}),r=new Map,s=new Map;for(let[x,v]of this.assignment){let P=g_(L5t(x)*47%100,100,.5);r.set(x,P),s.set(v,x)}function o(x,v,P){let w=r.get(v);x.fill=w,x.label=`${v}\u2192${P}`}for(let x of n.rects??[]){let v=x.label;if(!v)continue;let P=this.assignment.get(v);P&&o(x,v,P)}for(let x of i.rects??[]){let v=x.label;if(!v)continue;let P=this.assignment.get(v);P&&o(x,v,P)}let a=[e,t];for(let x of a)for(let v of x.rects??[]){let P=v.label;if(!P)continue;let w=s.get(P);w&&o(v,w,P)}let c=mw(this.floatingGraph),l=mw(this.wipGraph),u=mw(this.fixedGraph),p=bN(c,{title:"Floating Flat"}),f=bN(l,{title:"WIP Flat"}),y=bN(u,{title:"Fixed Flat"});return md([i1([n,p,i]),i1([e,f]),i1([t,y])])}},U5t=(n,e)=>{let t=new X5t(n,e);for(;!t.solved&&t.iterations<1e3;)t.step();let i={};for(let[o,a]of t.assignment.entries())i[o]=a;let r={};for(let[o,a]of t.floatingToFixedNetworkMap.entries())r[o]=a;let s=t.getPinAssignment();return{floatingToFixedBoxAssignment:i,floatingToFixedNetworkAssignment:r,floatingToFixedPinAssignment:s}};var V5t=(n,{renetworkedNetworkIdMap:e}={})=>{if(e??(e={}),n.length===1)return n[0];let t={boxes:[],pins:[]},i=new Map,r=new Map,s=Object.entries(n.flatMap(a=>Array.from(new Set(a.boxes.map(c=>c.boxId)))).reduce((a,c)=>(a[c]=(a[c]||0)+1,a),{})).filter(([a,c])=>c===n.length).map(([a])=>a);if(s.length>1)throw new Error(`Expected at most one shared box across all partitions, the following box ids are shared across all graphs: ${s.join(", ")}`);let o=s[0];for(let a of n){let c=a.boxes.find(l=>l.boxId===o)?.center;for(let l of a.boxes){if(i.has(l.boxId))continue;let u=structuredClone(l);u.center&&c&&(u.center={x:u.center.x-c.x,y:u.center.y-c.y}),i.set(l.boxId,u)}for(let l of a.pins)r.has(`${l.boxId}-${l.pinId}`)||r.set(`${l.boxId}-${l.pinId}`,structuredClone(l))}return t.boxes=Array.from(i.values()),t.pins=Array.from(r.values()),t};var KK=({graph:n,axis:e,centerBoxId:t})=>{let i=structuredClone(n),r=i.boxes.find(a=>a.boxId===t);if(!r||!r.center)throw new Error(`Center box "${t}" not found or has no center`);let{x:s,y:o}=r.center;for(let a of i.boxes)a.center&&(e==="x"?a.center.x=2*s-a.center.x:a.center.y=2*o-a.center.y);for(let a of i.pins)e==="x"?a.offset.x=-a.offset.x:a.offset.y=-a.offset.y;return i},G5t=n=>{let e=null,t=-1/0;for(let s of n.boxes){let o=n.pins.filter(a=>a.boxId===s.boxId).filter(a=>["x-","x+"].includes(x_(n,s,a)??"none"));o.length>t&&o.length>1&&(e=s,t=o.length)}if(!e)return{g:n,reflected:!1,centerBoxId:null};let i=n.pins.filter(s=>s.boxId===e.boxId).map(s=>x_(n,e,s)),r={"x+":0,"x-":0,"y+":0,"y-":0};for(let s of i)s&&r[s]++;return r["x+"]>=r["x-"]?{g:n,reflected:!1,centerBoxId:e.boxId}:{g:KK({graph:n,axis:"x",centerBoxId:e.boxId}),reflected:!0,centerBoxId:e.boxId}},nl=(0,JK.default)("schematic-partition-processor"),H5t=class{constructor(n,e={}){d(this,"lastGraph");d(this,"lastExploredPin");d(this,"solved",!1);d(this,"iteration",0);d(this,"wipPartitions");d(this,"unexploredPins",[]);d(this,"boxSingletonKeys");d(this,"exploredPins");d(this,"addedPins");d(this,"allAcceptedPins",new Set);d(this,"pinConnectionCount");d(this,"networkSize");d(this,"pinNetworkSize");d(this,"splitBoxIds");d(this,"acceptedBoxPartitionMap",new Map);d(this,"singletonKeys");d(this,"centerPinColors");this.initialGraph=n,this.lastGraph=n,this.singletonKeys=e.singletonKeys??[],this.centerPinColors=e.centerPinColors??[];let t=this.initializeWipPartitions();this.wipPartitions=t.wipPartitions,this.splitBoxIds=t.splitBoxIds,this.addedPins=t.addedPins,this.exploredPins=new Set,this.unexploredPins=this.wipPartitions.flatMap(s=>s.pins.map(o=>({...o,partitionId:s.partitionId}))),this.boxSingletonKeys=this.initializeBoxSingletonKeys(),this.pinConnectionCount=(()=>{let s={};for(let o of this.initialGraph.pins)s[`${o.boxId}:${o.pinId}`]=this.getNeighbors(o).length;return s})();let i={};for(let s of this.initialGraph.pins)i[s.networkId]=(i[s.networkId]??0)+1;this.networkSize=i;let r={};for(let s of this.initialGraph.pins)r[`${s.boxId}:${s.pinId}`]=i[s.networkId];this.pinNetworkSize=r}initializeBoxSingletonKeys(){let n={};for(let e of this.initialGraph.boxes){let t=this.initialGraph.pins.filter(s=>s.boxId===e.boxId),i=t.length,r=t.map(s=>`${s.color}/${i}`).filter(s=>this.singletonKeys.includes(s));n[e.boxId]=new Set(r)}return n}initializeWipPartitions(){let n=[],e=new Set,t=new Set,i=0;for(let r of this.initialGraph.boxes){let s=this.initialGraph.pins.filter(a=>a.boxId===r.boxId).filter(a=>x_(this.initialGraph,r,a)).filter(a=>!this.centerPinColors.includes(a.color));if(s.length<4)continue;let o=new Set(s.map(a=>x_(this.initialGraph,r,a)));o.size>1&&t.add(r.boxId);for(let a of o){let c={partitionId:`partition${i++}`,filledSingletonSlots:new Set,pins:[]};for(let l of s)x_(this.initialGraph,r,l)===a&&(c.pins.push({boxId:r.boxId,pinId:l.pinId}),e.add(`${r.boxId}:${l.pinId}`));n.push(c)}}return n.length===0&&(n.push(this.createWipPartitionFromEntireGraph()),this.solved=!0),nl(`splitBoxIds = ${Array.from(t).join(", ")}`),nl(`wipPartitions = ${n.map(r=>r.partitionId).join(", ")}`),{wipPartitions:n,splitBoxIds:t,addedPins:e}}createWipPartitionFromEntireGraph(){return{partitionId:"entire-graph",filledSingletonSlots:new Set,pins:this.initialGraph.pins.map(n=>({boxId:n.boxId,pinId:n.pinId}))}}step(){if(this.solved)return;if(this.iteration++,nl(`
\u2500\u2500 Iteration ${this.iteration} \u2500\u2500  unexplored=${this.unexploredPins.length}  explored=${this.exploredPins.size}`),this.unexploredPins.sort((l,u)=>{let p=`${l.boxId}:${l.pinId}`,f=`${u.boxId}:${u.pinId}`,y=this.pinNetworkSize[p]-this.pinNetworkSize[f];return y!==0?y:this.pinConnectionCount[p]-this.pinConnectionCount[f]}),this.unexploredPins.length===0){this.solved=!0;return}let n=this.unexploredPins.shift(),e=`${n.boxId}:${n.pinId}`;nl(`Exploring pin ${n.boxId}:${n.pinId} for partition "${n.partitionId}"`),this.lastExploredPin={...n,partitionId:n.partitionId};let t=`${n.partitionId}[${e}]`,i=this.initialGraph.pins.find(l=>l.boxId===n.boxId&&l.pinId===n.pinId);if(!i||this.exploredPins.has(t))return;let r=this.wipPartitions.find(l=>l.partitionId===n.partitionId);if(!r)return;let s=this.acceptedBoxPartitionMap.get(n.boxId);if(s&&s!==n.partitionId&&!this.splitBoxIds.has(n.boxId)){nl(`  \u21B3 rejected (box ${n.boxId} for partition ${n.partitionId} already in partition ${this.acceptedBoxPartitionMap.get(n.boxId)})`),this.exploredPins.add(t);return}let o=this.boxSingletonKeys[n.boxId];if(Array.from(o).some(l=>r.filledSingletonSlots.has(l))){nl(`  \u21B3 rejected (singleton already in partition "${n.partitionId}")`),this.exploredPins.add(t);return}for(let l of o)r.filledSingletonSlots.add(l);r.pins.push({boxId:n.boxId,pinId:n.pinId}),this.allAcceptedPins.add(e),this.addedPins.add(e),this.splitBoxIds.has(n.boxId)||this.acceptedBoxPartitionMap.set(n.boxId,n.partitionId),this.exploredPins.add(t),nl(`  \u21B3 accepted \u2192 pins in partition now = ${r.pins.length}`);let c=this.getNeighbors(i);for(let l of c){let u=`${l.boxId}:${l.pinId}`;this.addedPins.has(u)||this.centerPinColors.includes(l.color)||this.exploredPins.has(`${n.partitionId}[${u}]`)||this.unexploredPins.push({boxId:l.boxId,pinId:l.pinId,partitionId:n.partitionId})}this.unexploredPins.length===0&&(this.solved=!0),this.solved&&nl(`Solver finished in ${this.iteration} iterations, partitions=${this.getPartitions().length}`)}getNeighbors(n){let e=[];for(let t of this.initialGraph.pins)t.networkId===n.networkId&&(n.boxId===t.boxId&&t.pinId===n.pinId||e.push(t));for(let t of this.initialGraph.pins)t.boxId===n.boxId&&e.push(t);return e}solve(){for(;!this.solved&&this.iteration<1e3;)this.step()}getPartitions(){if(!this.solved)throw new Error("Graph not solved");let n=[];for(let e of this.wipPartitions){if(e.pins.length===0)continue;let t=new Set(e.pins.map(r=>r.boxId)),i=this.initialGraph.boxes.filter(r=>t.has(r.boxId));n.push({boxes:i,pins:this.initialGraph.pins.filter(r=>e.pins.some(s=>s.pinId===r.pinId&&s.boxId===r.boxId)||this.centerPinColors.includes(r.color)&&t.has(r.boxId))})}return n}getGraphicsForLastGraph(){let n=il(this.lastGraph,{title:`Iteration ${this.iteration}`}),e=this.wipPartitions.length,t=.4;if(this.wipPartitions.forEach((r,s)=>{if(r.pins.length===0)return;let o=g_(s,e,.25);for(let{boxId:a,pinId:c}of r.pins){let{x:l,y:u}=fw(this.lastGraph,a,c);n.rects.push({center:{x:l,y:u},width:t,height:t,fill:o})}}),this.lastExploredPin){let{boxId:r,pinId:s,color:o}=this.lastExploredPin,a=fw(this.lastGraph,r,s),c=.25;n.rects.push({center:{x:a.x,y:a.y},width:c,height:c,fill:this.lastExploredPin.partitionId?g_(this.wipPartitions.findIndex(l=>l.partitionId===this.lastExploredPin.partitionId),this.wipPartitions.length,1):"black"}),n.texts.push({x:a.x,y:a.y,text:`${r}:${s}-${Array.from(this.boxSingletonKeys[r]??[]).join(",")}`,fontSize:.1})}let i=t;for(let r of this.unexploredPins){let{boxId:s,pinId:o,partitionId:a}=r,c=this.wipPartitions.findIndex(y=>y.partitionId===a);if(c===-1)continue;let l=g_(c,this.wipPartitions.length,1),{x:u,y:p}=fw(this.lastGraph,s,o),f=1+.1*c;n.rects.push({center:{x:u,y:p},width:i*f,height:i*f,fill:"none",stroke:l})}return n}},W5t=(n,e,t={})=>{t.similarityMethod??(t.similarityMethod="wl-distance");let i=vN,r=Object.fromEntries(Object.entries(e).map(([o,a])=>[o,i(n,a)])),s=Object.entries(r).reduce((o,[a,c])=>c<o[1]?[a,c]:o);return{graphName:s[0],graph:e[s[0]],distance:s[1],corpusScores:r}},q5t=n=>n.x>0?"x+":n.x<0?"x-":n.y>0?"y+":n.y<0?"y-":null,Z5t=n=>{switch(n){case"x+":return{x:1,y:0};case"x-":return{x:-1,y:0};case"y+":return{x:0,y:1};case"y-":return{x:0,y:-1}}},qK=(n,e)=>{let t=n.boxes.find(a=>a.boxId===e);if(!t)throw new Error(`Box ${e} not found`);let r=n.pins.filter(a=>a.boxId===e).map(a=>x_(n,t,a)),s={"x-":0,"x+":0,"y-":0,"y+":0};for(let a of r)a&&s[a]++;let o=Math.max(...Object.values(s));for(let a of Object.keys(s))if(s[a]===o)return a;return null},K5t=(n,e,{floatingToFixedBoxAssignment:t,floatingBoxIdsWithMutablePinOffsets:i})=>{for(let r of n.boxes){let s=t[r.boxId];if(!s||!r.center||i?.has(r.boxId))continue;let o=yw(e,s),a=yw(n,r.boxId),c=qK(e,s),l=qK(n,r.boxId);if(c===null||l===null||c!==l)continue;let u=Z5t(c),p=o.maxX-o.minX,f=a.maxX-a.minX,y=o.maxY-o.minY,g=a.maxY-a.minY,x=f-p,v=g-y;if(!(x<.001&&v<.001))for(let P of n.boxes){if(P.boxId===r.boxId||!P.center)continue;let w={x:P.center.x-r.center.x,y:P.center.y-r.center.y};q5t({x:w.x*Math.abs(u.x),y:w.y*Math.abs(u.y)})===c&&(P.center.x+=u.x*x,P.center.y+=u.y*v)}}},J5t=(n,e,t={})=>{let{floatingBoxIdsWithMutablePinOffsets:i=new Set}=t,{floatingToFixedBoxAssignment:r,floatingToFixedPinAssignment:s}=U5t(n,e),o=structuredClone(n);for(let a of o.pins)if(i.has(a.boxId)&&s[a.boxId]?.[a.pinId]){let c=s[a.boxId]?.[a.pinId],l=r[a.boxId],u=e.pins.find(p=>p.boxId===l&&p.pinId===c);u&&(a.offset=u.offset)}for(let a of o.boxes)if(r[a.boxId]){let c=r[a.boxId],l=e.boxes.find(u=>u.boxId===c);l&&(a.center=l.center,a.kind="fixed")}return t.pushBoxesAsBoxesChangeSize&&K5t(o,e,{floatingToFixedBoxAssignment:r,floatingBoxIdsWithMutablePinOffsets:i}),o},Q5t=(n,{corpus:e,singletonKeys:t,centerPinColors:i,floatingBoxIdsWithMutablePinOffsets:r})=>{let s=new H5t(n,{singletonKeys:t,centerPinColors:i});for(;!s.solved&&s.iteration<1e3;)s.step();let c=s.getPartitions().map(G5t).map(f=>{let{graph:y,distance:g}=W5t(f.g,e);return{adaptedBpcGraph:J5t(structuredClone(f.g),y,{floatingBoxIdsWithMutablePinOffsets:r,pushBoxesAsBoxesChangeSize:!0}),reflected:f.reflected,centerBoxId:f.centerBoxId,distance:g}}),l=c.map(({adaptedBpcGraph:f,reflected:y,centerBoxId:g})=>y?KK({graph:f,axis:"x",centerBoxId:g}):f),u=V5t(l),p=c.reduce((f,y)=>f+(y.distance||0),0);return{fixedGraph:u,distance:p}},QK=(n,{corpus:e,singletonKeys:t,centerPinColors:i,floatingBoxIdsWithMutablePinOffsets:r})=>{let s=[],o=null;for(let a of n){let{fixedGraph:c,distance:l}=Q5t(a.floatingGraph,{corpus:e,singletonKeys:t,centerPinColors:i,floatingBoxIdsWithMutablePinOffsets:r});s.push({variantName:a.variantName,distance:l}),(!o||l<o.distance)&&(o={variantName:a.variantName,result:c,distance:l})}return{result:o.result,selectedVariantName:o.variantName,variantResults:s}};var ant=Gt(Mn(),1);Ae();Ae();var o1={CCW:-1,CW:1,NOT_ORIENTABLE:0},t4t=2*Math.PI,vw=1,pJ=0,Do=2,e4t=3,n4t=4,i4t=1,r4t=2,VN=0,a1=1,b_=2,Sw=Object.freeze({__proto__:null,BOUNDARY:Do,CCW:!0,CONTAINS:e4t,CW:!1,END_VERTEX:b_,INSIDE:vw,INTERLACE:n4t,NOT_VERTEX:VN,ORIENTATION:o1,OUTSIDE:pJ,OVERLAP_OPPOSITE:r4t,OVERLAP_SAME:i4t,PIx2:t4t,START_VERTEX:a1}),Yo=1e-6;function hJ(n){Yo=n}function dJ(){return Yo}var s4t=3;function PN(n){return n<Yo&&n>-Yo}function gd(n,e){return n-e<Yo&&n-e>-Yo}function fJ(n,e){return n-e>Yo}function o4t(n,e){return n-e>-Yo}function mJ(n,e){return n-e<-Yo}function a4t(n,e){return n-e<Yo}var c4t=Object.freeze({__proto__:null,DECIMALS:s4t,EQ:gd,EQ_0:PN,GE:o4t,GT:fJ,LE:a4t,LT:mJ,getTolerance:dJ,setTolerance:hJ}),L={Utils:c4t,Errors:void 0,Matrix:void 0,Planar_set:void 0,Point:void 0,Vector:void 0,Line:void 0,Circle:void 0,Segment:void 0,Arc:void 0,Box:void 0,Edge:void 0,Face:void 0,Ray:void 0,Ray_shooting:void 0,Multiline:void 0,Polygon:void 0,Distance:void 0,Inversion:void 0};for(let n in Sw)L[n]=Sw[n];Object.defineProperty(L,"DP_TOL",{get:function(){return dJ()},set:function(n){hJ(n)}});var In=class{static get ILLEGAL_PARAMETERS(){return new ReferenceError("Illegal Parameters")}static get ZERO_DIVISION(){return new Error("Zero division")}static get UNRESOLVED_BOUNDARY_CONFLICT(){return new Error("Unresolved boundary conflict in boolean operation")}static get INFINITE_LOOP(){return new Error("Infinite loop")}static get CANNOT_COMPLETE_BOOLEAN_OPERATION(){return new Error("Cannot complete boolean operation")}static get CANNOT_INVOKE_ABSTRACT_METHOD(){return new Error("Abstract method cannot be invoked")}static get OPERATION_IS_NOT_SUPPORTED(){return new Error("Operation is not supported")}static get UNSUPPORTED_SHAPE_TYPE(){return new Error("Unsupported shape type")}};L.Errors=In;var l1=class{constructor(e,t){this.first=e,this.last=t||this.first}[Symbol.iterator](){let e;return{next:()=>(e=e?e.next:this.first,{value:e,done:e===void 0})}}get size(){let e=0;for(let t of this)e++;return e}toArray(e=void 0,t=void 0){let i=[],r=e||this.first,s=t||this.last,o=r;if(o===void 0)return i;do i.push(o),o=o.next;while(o!==s.next);return i}append(e){return this.isEmpty()?this.first=e:(e.prev=this.last,this.last.next=e),this.last=e,this.last.next=void 0,this.first.prev=void 0,this}insert(e,t){if(this.isEmpty())this.first=e,this.last=e;else if(t==null)e.next=this.first,this.first.prev=e,this.first=e;else{let i=t.next;t.next=e,i&&(i.prev=e),e.prev=t,e.next=i,this.last===t&&(this.last=e)}return this.last.next=void 0,this.first.prev=void 0,this}remove(e){return e===this.first&&e===this.last?(this.first=void 0,this.last=void 0):(e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),e===this.first&&(this.first=e.next),e===this.last&&(this.last=e.prev)),this}isEmpty(){return this.first===void 0}static testInfiniteLoop(e){let t=e,i=e;do{if(t!=e&&t===i)throw In.INFINITE_LOOP;t=t.next,i=i.next.next}while(t!=e)}},tJ={stroke:"black"},kN=class{constructor(e=tJ){for(let t in e)this[t]=e[t];this.stroke=e.stroke??tJ.stroke}toAttributesString(){return Object.keys(this).reduce((e,t)=>e+(this[t]!==void 0?this.toAttrString(t,this[t]):""),"")}toAttrString(e,t){let i=e==="className"?"class":this.convertCamelToKebabCase(e);return t===null?`${i} `:`${i}="${t.toString()}" `}convertCamelToKebabCase(e){return e.match(/[A-Z]{2,}(?=[A-Z][a-z]+[0-9]*|\b)|[A-Z]?[a-z]+[0-9]*|[A-Z]|[0-9]+/g).join("-").toLowerCase()}};function bd(n){return new kN(n).toAttributesString()}function k_(n,e){let t=[],[i,r,s]=n.standard,[o,a,c]=e.standard,l=i*a-r*o,u=s*a-r*c,p=i*c-s*o;if(!L.Utils.EQ_0(l)){let f,y;r===0?(f=s/i,y=p/l):a===0?(f=c/o,y=p/l):i===0?(f=u/l,y=s/r):o===0?(f=u/l,y=c/a):(f=u/l,y=p/l),t.push(new L.Point(f,y))}return t}function vd(n,e){let t=[],i=e.pc.projectionOn(n),r=e.pc.distanceTo(i)[0];if(L.Utils.EQ(r,e.r))t.push(i);else if(L.Utils.LT(r,e.r)){let s=Math.sqrt(e.r*e.r-r*r),o,a;o=n.norm.rotate90CCW().multiply(s),a=i.translate(o),t.push(a),o=n.norm.rotate90CW().multiply(s),a=i.translate(o),t.push(a)}return t}function v_(n,e){let t=[];for(let i of e.toSegments()){let r=h1(i,n);for(let s of r)PJ(s,t)||t.push(s)}return t}function ww(n,e){let t=[];if(v_(n,e.box).length===0)return t;let i=new L.Circle(e.pc,e.r),r=vd(n,i);for(let s of r)s.on(e)&&t.push(s);return t}function h1(n,e){let t=[];if(n.ps.on(e)&&t.push(n.ps),n.pe.on(e)&&!n.isZeroLength()&&t.push(n.pe),t.length>0||n.isZeroLength()||n.ps.leftTo(e)&&n.pe.leftTo(e)||!n.ps.leftTo(e)&&!n.pe.leftTo(e))return t;let i=new L.Line(n.ps,n.pe);return k_(i,e)}function Pw(n,e){let t=[];if(n.box.not_intersect(e.box))return t;if(n.isZeroLength())return n.ps.on(e)&&t.push(n.ps),t;if(e.isZeroLength())return e.ps.on(n)&&t.push(e.ps),t;let i=new L.Line(n.ps,n.pe),r=new L.Line(e.ps,e.pe);if(i.incidentTo(r))n.ps.on(e)&&t.push(n.ps),n.pe.on(e)&&t.push(n.pe),e.ps.on(n)&&!e.ps.equalTo(n.ps)&&!e.ps.equalTo(n.pe)&&t.push(e.ps),e.pe.on(n)&&!e.pe.equalTo(n.ps)&&!e.pe.equalTo(n.pe)&&t.push(e.pe);else{let s=k_(i,r);s.length>0&&eJ(s[0],n)&&eJ(s[0],e)&&t.push(s[0])}return t}function eJ(n,e){let t=e.box;return L.Utils.LE(n.x,t.xmax)&&L.Utils.GE(n.x,t.xmin)&&L.Utils.LE(n.y,t.ymax)&&L.Utils.GE(n.y,t.ymin)}function kw(n,e){let t=[];if(n.box.not_intersect(e.box))return t;if(n.isZeroLength()){let[s,o]=n.ps.distanceTo(e.pc);return L.Utils.EQ(s,e.r)&&t.push(n.ps),t}let i=new L.Line(n.ps,n.pe),r=vd(i,e);for(let s of r)s.on(n)&&t.push(s);return t}function T_(n,e){let t=[];if(n.box.not_intersect(e.box))return t;if(n.isZeroLength())return n.ps.on(e)&&t.push(n.ps),t;let i=new L.Line(n.ps,n.pe),r=new L.Circle(e.pc,e.r),s=vd(i,r);for(let o of s)o.on(n)&&o.on(e)&&t.push(o);return t}function l4t(n,e){let t=[];for(let i of e.toSegments()){let r=Pw(i,n);for(let s of r)t.push(s)}return t}function _J(n,e){let t=[];if(n.box.not_intersect(e.box))return t;let i=new L.Vector(n.pc,e.pc),r=n.r,s=e.r;if(L.Utils.EQ_0(r)||L.Utils.EQ_0(s))return t;if(L.Utils.EQ_0(i.x)&&L.Utils.EQ_0(i.y)&&L.Utils.EQ(r,s))return t.push(n.pc.translate(-r,0)),t;let o=n.pc.distanceTo(e.pc)[0];if(L.Utils.GT(o,r+s)||L.Utils.LT(o,Math.abs(r-s)))return t;i.x/=o,i.y/=o;let a;if(L.Utils.EQ(o,r+s)||L.Utils.EQ(o,Math.abs(r-s)))return a=n.pc.translate(r*i.x,r*i.y),t.push(a),t;let c=r*r/(2*o)-s*s/(2*o)+o/2,l=n.pc.translate(c*i.x,c*i.y),u=Math.sqrt(r*r-c*c);return a=l.translate(i.rotate90CCW().multiply(u)),t.push(a),a=l.translate(i.rotate90CW().multiply(u)),t.push(a),t}function u4t(n,e){let t=[];for(let i of e.toSegments()){let r=kw(i,n);for(let s of r)t.push(s)}return t}function yJ(n,e){let t=[];if(n.box.not_intersect(e.box))return t;if(n.pc.equalTo(e.pc)&&L.Utils.EQ(n.r,e.r)){let o;return o=n.start,o.on(e)&&t.push(o),o=n.end,o.on(e)&&t.push(o),o=e.start,o.on(n)&&t.push(o),o=e.end,o.on(n)&&t.push(o),t}let i=new L.Circle(n.pc,n.r),r=new L.Circle(e.pc,e.r),s=i.intersect(r);for(let o of s)o.on(n)&&o.on(e)&&t.push(o);return t}function GN(n,e){let t=[];if(n.box.not_intersect(e.box))return t;if(e.pc.equalTo(n.pc)&&L.Utils.EQ(e.r,n.r))return t.push(n.start),t.push(n.end),t;let i=e,r=new L.Circle(n.pc,n.r),s=_J(i,r);for(let o of s)o.on(n)&&t.push(o);return t}function p4t(n,e){let t=[];for(let i of e.toSegments()){let r=T_(i,n);for(let s of r)t.push(s)}return t}function gJ(n,e){return n.isSegment?Pw(n.shape,e):T_(e,n.shape)}function xJ(n,e){return n.isSegment?T_(n.shape,e):yJ(n.shape,e)}function bJ(n,e){return n.isSegment?h1(n.shape,e):ww(e,n.shape)}function h4t(n,e){return n.isSegment?qN(e,n.shape):ZN(e,n.shape)}function d4t(n,e){return n.isSegment?kw(n.shape,e):GN(n.shape,e)}function HN(n,e){let t=[];for(let i of e.edges)for(let r of gJ(i,n))t.push(r);return t}function WN(n,e){let t=[];for(let i of e.edges)for(let r of xJ(i,n))t.push(r);return t}function d1(n,e){let t=[];if(e.isEmpty())return t;for(let i of e.edges)for(let r of bJ(i,n))PJ(r,t)||t.push(r);return n.sortPoints(t)}function vJ(n,e){let t=[];if(e.isEmpty())return t;for(let i of e.edges)for(let r of d4t(i,n))t.push(r);return t}function SJ(n,e){return n.isSegment?gJ(e,n.shape):n.isArc?xJ(e,n.shape):n.isLine?bJ(e,n.shape):n.isRay?h4t(e,n.shape):[]}function wJ(n,e){let t=[];if(e.isEmpty()||n.shape.box.not_intersect(e.box))return t;let i=e.edges.search(n.shape.box);for(let r of i)t=[...t,...SJ(n,r)];return t}function f4t(n,e){let t=[];if(e.isEmpty()||n.size===0)return t;for(let i of n)t=[...t,...wJ(i,e)];return t}function m4t(n,e){let t=[];if(n.isEmpty()||e.isEmpty()||n.box.not_intersect(e.box))return t;for(let i of n.edges)t=[...t,...wJ(i,e)];return t}function _4t(n,e){return n instanceof L.Line?d1(n,e):n instanceof L.Segment?HN(n,e):n instanceof L.Arc?WN(n,e):[]}function PJ(n,e){return e.some(t=>t.equalTo(n))}function sl(n){return new L.Line(n.start,n.norm)}function qN(n,e){return h1(e,sl(n)).filter(t=>n.contains(t))}function ZN(n,e){return ww(sl(n),e).filter(t=>n.contains(t))}function kJ(n,e){return vd(sl(n),e).filter(t=>n.contains(t))}function y4t(n,e){return v_(sl(n),e).filter(t=>n.contains(t))}function TJ(n,e){return k_(sl(n),e).filter(t=>n.contains(t))}function g4t(n,e){return k_(sl(n),sl(e)).filter(t=>n.contains(t)).filter(t=>e.contains(t))}function EJ(n,e){return d1(sl(n),e).filter(t=>n.contains(t))}function MJ(n,e){if(n.intersect&&n.intersect instanceof Function)return n.intersect(e);throw In.UNSUPPORTED_SHAPE_TYPE}function f1(n,e){let t=[];for(let i of e)t=[...t,...MJ(n,i.shape)];return t}function x4t(n,e){let t=[];for(let i of n)for(let r of e)t=[...t,...MJ(i.shape,r.shape)];return t}var Sd=class s1 extends l1{constructor(...e){if(super(),this.isInfinite=!1,e.length===1&&e[0]instanceof Array&&e[0].length>0){let t=e[0],i=t.length,r=c=>c instanceof L.Segment||c instanceof L.Arc||c instanceof L.Ray||c instanceof L.Line,s=c=>c instanceof L.Segment||c instanceof L.Arc||c instanceof L.Ray,o=c=>c instanceof L.Segment||c instanceof L.Arc;if(i===1&&r(t[0])||i>1&&s(t[0])&&s(t[i-1])&&t.slice(1,i-1).every(o)){this.isInfinite=t.some(c=>c instanceof L.Ray||c instanceof L.Line);for(let c of t){let l=new L.Edge(c);this.append(l)}this.setArcLength()}else throw L.Errors.ILLEGAL_PARAMETERS}}get edges(){return[...this]}get box(){return this.edges.reduce((e,t)=>e.merge(t.box),new L.Box)}get vertices(){let e=this.edges.map(t=>t.start);return e.push(this.last.end),e}get length(){if(this.isEmpty())return 0;if(this.isInfinite)return Number.POSITIVE_INFINITY;let e=0;for(let t of this)e+=t.length;return e}clone(){return new s1(this.toShapes())}setArcLength(){for(let e of this)this.setOneEdgeArcLength(e)}setOneEdgeArcLength(e){e===this.first?e.arc_length=0:e.arc_length=e.prev.arc_length+e.prev.length}pointAtLength(e){if(e>this.length||e<0||this.isInfinite)return null;let t=null;for(let i of this)if(e>=i.arc_length&&(i===this.last||e<i.next.arc_length)){t=i.pointAtLength(e-i.arc_length);break}return t}addVertex(e,t){let i=t.shape.split(e);if(i[0]===null)return t.prev;if(i[1]===null)return t;let r=new L.Edge(i[0]),s=t.prev;return this.insert(r,s),t.shape=i[1],r}getChain(e,t){let i=[];for(let r=e;r!==t.next;r=r.next)i.push(r);return i}split(e){for(let t of e){let i=this.findEdgeByPoint(t);this.addVertex(t,i)}return this}findEdgeByPoint(e){let t;for(let i of this)if(i.shape.contains(e)){t=i;break}return t}distanceTo(e){if(e instanceof Point){let[t,i]=L.Distance.shape2multiline(e,this);return[t,i.reverse()]}if(e instanceof L.Line){let[t,i]=L.Distance.shape2multiline(e,this);return[t,i.reverse()]}if(e instanceof L.Circle){let[t,i]=L.Distance.shape2multiline(e,this);return[t,i.reverse()]}if(e instanceof L.Segment){let[t,i]=L.Distance.shape2multiline(e,this);return[t,i.reverse()]}if(e instanceof L.Arc){let[t,i]=L.Distance.shape2multiline(e,this);return[t,i.reverse()]}if(e instanceof L.Multiline)return L.Distance.multiline2multiline(this,e);throw L.Errors.UNSUPPORTED_SHAPE_TYPE}intersect(e){return e instanceof L.Multiline?x4t(this,e):f1(e,this)}contains(e){if(e instanceof L.Point)return this.edges.some(t=>t.shape.contains(e));throw L.Errors.UNSUPPORTED_SHAPE_TYPE}translate(e){return new s1(this.edges.map(t=>t.shape.translate(e)))}rotate(e=0,t=new L.Point){return new s1(this.edges.map(i=>i.shape.rotate(e,t)))}transform(e=new L.Matrix){return new s1(this.edges.map(t=>t.shape.transform(e)))}toShapes(){return this.edges.map(e=>e.shape.clone())}toJSON(){return this.edges.map(e=>e.toJSON())}svgPoints(){return this.vertices.map(e=>`${e.x},${e.y}`).join(" ")}dpath(){let e=`M${this.first.start.x},${this.first.start.y}`;for(let t of this)e+=t.svg();return e}svg(e={}){let t=`
<path ${bd({fill:"none",...e})} d="`;t+=`
M${this.first.start.x},${this.first.start.y}`;for(let i of this)t+=i.svg();return t+=`" >
</path>`,t}};L.Multiline=Sd;var b4t=(...n)=>new L.Multiline(...n);L.multiline=b4t;function S_(n,e,t){let i=t.length,r=n.shape.split(e);if(r.length===0)return;let s=0;r[0]===null?s=0:r[1]===null?s=n.shape.length:s=r[0].length;let o=VN;gd(s,0)&&(o|=a1),gd(s,n.shape.length)&&(o|=b_);let a;s===1/0?a=r[0].coord(e):a=o&b_&&n.next&&n.next.arc_length===0?0:n.arc_length+s,t.push({id:i,pt:e,arc_length:a,edge_before:n,edge_after:void 0,face:n.face,is_vertex:o})}function u1(n){n.int_points1_sorted=rl(n.int_points1),n.int_points2_sorted=rl(n.int_points2)}function rl(n){let e=new Map,t=0;for(let r of n)e.has(r.face)||(e.set(r.face,t),t++);for(let r of n)r.faceId=e.get(r.face);return n.slice().sort(v4t)}function v4t(n,e){return n.faceId<e.faceId?-1:n.faceId>e.faceId?1:n.arc_length<e.arc_length?-1:n.arc_length>e.arc_length?1:0}function KN(n){if(n.int_points1.length<2)return;let e=!1,t,i,r,s;for(let o=0;o<n.int_points1_sorted.length;o++)if(n.int_points1_sorted[o].id!==-1){t=n.int_points1_sorted[o],i=n.int_points2[t.id];for(let a=o+1;a<n.int_points1_sorted.length&&(r=n.int_points1_sorted[a],!!gd(r.arc_length,t.arc_length));a++)r.id!==-1&&(s=n.int_points2[r.id],s.id!==-1&&r.edge_before===t.edge_before&&r.edge_after===t.edge_after&&s.edge_before===i.edge_before&&s.edge_after===i.edge_after&&(r.id=-1,s.id=-1,e=!0))}i=n.int_points2_sorted[0],t=n.int_points1[i.id];for(let o=1;o<n.int_points2_sorted.length;o++){let a=n.int_points2_sorted[o];if(a.id===-1)continue;if(i.id===-1||!gd(a.arc_length,i.arc_length)){i=a,t=n.int_points1[i.id];continue}let c=n.int_points1[a.id];c.edge_before===t.edge_before&&c.edge_after===t.edge_after&&a.edge_before===i.edge_before&&a.edge_after===i.edge_after&&(c.id=-1,a.id=-1,e=!0)}e&&(n.int_points1=n.int_points1.filter(o=>o.id>=0),n.int_points2=n.int_points2.filter(o=>o.id>=0),n.int_points1.forEach((o,a)=>o.id=a),n.int_points2.forEach((o,a)=>o.id=a))}function TN(n){for(let e of n)e.edge_before&&(e.edge_before.bvStart=void 0,e.edge_before.bvEnd=void 0,e.edge_before.bv=void 0,e.edge_before.overlap=void 0),e.edge_after&&(e.edge_after.bvStart=void 0,e.edge_after.bvEnd=void 0,e.edge_after.bv=void 0,e.edge_after.overlap=void 0);for(let e of n)e.edge_before&&(e.edge_before.bvEnd=Do),e.edge_after&&(e.edge_after.bvStart=Do)}function EN(n,e){for(let t of n)t.edge_before&&t.edge_before.setInclusion(e),t.edge_after&&t.edge_after.setInclusion(e)}function S4t(n){let e,t,i,r=n.int_points1.length;for(let s=0;s<r;s++){let o=n.int_points1_sorted[s];o.face!==e&&(t=s,e=o.face);let a=s,c=w_(n.int_points1_sorted,s,e),l;a+c<r&&n.int_points1_sorted[a+c].face===e?l=a+c:l=t;let u=w_(n.int_points1_sorted,l,e);i=null;for(let P=l;P<l+u;P++){let w=n.int_points1_sorted[P];if(w.face===e&&n.int_points2[w.id].face===n.int_points2[o.id].face){i=w;break}}if(i===null)continue;let p=o.edge_after,f=i.edge_before;if(!(p.bv===Do&&f.bv===Do)||p!==f)continue;let y=n.int_points2[o.id],g=n.int_points2[i.id],x=y.edge_after,v=g.edge_before;x.bv===Do&&v.bv===Do&&x===v||(y=n.int_points2[i.id],g=n.int_points2[o.id],x=y.edge_after,v=g.edge_before),x.bv===Do&&v.bv===Do&&x===v&&p.setOverlap(x)}}function w_(n,e,t){let i,r,s=1;if(n.length===1)return 1;i=n[e];for(let o=e+1;o<n.length&&!(i.face!==t||(r=n[o],!(r.pt.equalTo(i.pt)&&r.edge_before===i.edge_before&&r.edge_after===i.edge_after)));o++)s++;return s}function P_(n,e){if(e){for(let t of e){let i=t.edge_before;if(t.is_vertex=VN,i.shape.start&&i.shape.start.equalTo(t.pt)&&(t.is_vertex|=a1),i.shape.end&&i.shape.end.equalTo(t.pt)&&(t.is_vertex|=b_),t.is_vertex&a1){t.edge_before=i.prev,i.prev&&(t.is_vertex=b_);continue}if(t.is_vertex&b_)continue;let r=n.addVertex(t.pt,i);t.edge_before=r}for(let t of e)t.edge_before?t.edge_after=t.edge_before.next:n instanceof Sd&&t.is_vertex&a1&&(t.edge_after=n.first)}}function nJ(n,e,t){let i=n.edge_before,r=e.edge_after,s=t.length;i.next=t[0],t[0].prev=i,t[s-1].next=r,r.prev=t[s-1]}var{INSIDE:jo,OUTSIDE:Bo,BOUNDARY:Xi,OVERLAP_SAME:w4t,OVERLAP_OPPOSITE:P4t}=Sw,{NOT_VERTEX:Ule,START_VERTEX:iJ,END_VERTEX:rJ}=Sw,Tw=1,m1=2,xd=3;function k4t(n,e){let[t,i]=_1(n,e,Tw,!0);return t}function MN(n,e){let i=e.clone().reverse(),[r,s]=_1(n,i,xd,!0);return r}function CJ(n,e){let[t,i]=_1(n,e,m1,!0);return t}function IJ(n,e){let[t,i]=_1(n,e,m1,!1),r=[];for(let o of t.faces)r=[...r,...[...o.edges].map(a=>a.shape)];let s=[];for(let o of i.faces)s=[...s,...[...o.edges].map(a=>a.shape)];return[r,s]}function CN(n,e){let[t,i]=_1(n,e,xd,!1),r=[];for(let s of t.faces)r=[...r,...[...s.edges].map(o=>o.shape)];return r}function NJ(n,e){let t=n.clone(),i=e.clone(),r=AJ(t,i);u1(r),P_(t,r.int_points1_sorted),P_(i,r.int_points2_sorted),KN(r),u1(r);let s=r.int_points1_sorted.map(a=>a.pt),o=r.int_points2_sorted.map(a=>a.pt);return[s,o]}function T4t(n,e,t,i){let r=sJ(n,t.int_points1),s=sJ(e,t.int_points2);for(oJ(r,e),oJ(s,n),TN(t.int_points1),TN(t.int_points2),EN(t.int_points1,e),EN(t.int_points2,n);M4t(n,e,t.int_points1,t.int_points1_sorted,t.int_points2,t););S4t(t),IN(n,i,t.int_points1_sorted,!0),IN(e,i,t.int_points2_sorted,!1),aJ(n,r,i,!0),aJ(e,s,i,!1)}function E4t(n,e,t,i){C4t(n,e,i,t.int_points2),I4t(n,e,t),NN(n,t.int_points1),NN(e,t.int_points2),AN(n,t.int_points1,t.int_points2),AN(n,t.int_points2,t.int_points1)}function _1(n,e,t,i){let r=n.clone(),s=e.clone(),o=AJ(r,s);return u1(o),P_(r,o.int_points1_sorted),P_(s,o.int_points2_sorted),KN(o),u1(o),T4t(r,s,o,t),i&&E4t(r,s,o,t),[r,s]}function AJ(n,e){let t={int_points1:[],int_points2:[]};for(let i of n.edges){let r=e.edges.search(i.box);for(let s of r){let o=i.shape.intersect(s.shape);for(let a of o)S_(i,a,t.int_points1),S_(s,a,t.int_points2)}}return t}function sJ(n,e){let t=[];for(let i of n.faces)e.find(r=>r.face===i)||t.push(i);return t}function oJ(n,e){for(let t of n)t.first.bv=t.first.bvStart=t.first.bvEnd=void 0,t.first.setInclusion(e)}function M4t(n,e,t,i,r,s){let o,a,c,l=i.length,u=!1;for(let p=0;p<l;p++){let f=i[p];f.face!==o&&(a=p,o=f.face);let y=p,g=w_(i,p,o),x;y+g<l&&i[y+g].face===o?x=y+g:x=a;let v=w_(i,x,o);c=null;for(let k=x;k<x+v;k++){let T=i[k];if(T.face===o&&r[T.id].face===r[f.id].face){c=T;break}}if(c===null)continue;let P=f.edge_after,w=c.edge_before;if(P.bv===Xi&&w.bv!=Xi){P.bv=w.bv;continue}if(P.bv!=Xi&&w.bv===Xi){w.bv=P.bv;continue}if(P.bv===Xi&&w.bv===Xi&&P!=w||P.bv===jo&&w.bv===Bo||P.bv===Bo&&w.bv===jo){let k=P.next;for(;k!=w;)k.bvStart=void 0,k.bvEnd=void 0,k.bv=void 0,k.setInclusion(e),k=k.next}if(P.bv===Xi&&w.bv===Xi&&P!=w){let k=P.next,T;for(;k!=w;){if(k.bv!=Xi){if(T===void 0)T=k.bv;else if(k.bv!=T)throw In.UNRESOLVED_BOUNDARY_CONFLICT}k=k.next}T!=null&&(P.bv=T,w.bv=T);continue}if(P.bv===jo&&w.bv===Bo||P.bv===Bo&&w.bv===jo){let k=P;for(;k!=w;){if(k.bvStart===P.bv&&k.bvEnd===w.bv){let[T,I]=k.shape.distanceTo(e);if(T<10*L.DP_TOL){S_(k,I.ps,t);let E=t[t.length-1];if(E.is_vertex&iJ)E.edge_after=k,E.edge_before=k.prev,k.bvStart=Xi,k.bv=void 0,k.setInclusion(e);else if(E.is_vertex&rJ)E.edge_after=k.next,k.bvEnd=Xi,k.bv=void 0,k.setInclusion(e);else{let A=e.addVertex(E.pt,k);E.edge_before=A,E.edge_after=A.next,A.setInclusion(e),A.next.bvStart=Xi,A.next.bvEnd=void 0,A.next.bv=void 0,A.next.setInclusion(e)}let N=e.findEdgeByPoint(I.pe);S_(N,I.pe,r);let M=r[r.length-1];if(M.is_vertex&iJ)M.edge_after=N,M.edge_before=N.prev;else if(M.is_vertex&rJ)M.edge_after=N.next;else{let A=r.find(j=>j.edge_after===N),R=e.addVertex(M.pt,N);M.edge_before=R,M.edge_after=R.next,A&&(A.edge_after=R),R.bvStart=void 0,R.bvEnd=Xi,R.bv=void 0,R.setInclusion(n),R.next.bvStart=Xi,R.next.bvEnd=void 0,R.next.bv=void 0,R.next.setInclusion(n)}u1(s),u=!0;break}}k=k.next}if(u)break;throw In.UNRESOLVED_BOUNDARY_CONFLICT}}return u}function IN(n,e,t,i){if(!t)return;let r,s,o,a;for(let c=0;c<t.length;c++){if(o=t[c],o.face!==r&&(s=c,r=o.face),r.isEmpty())continue;let l=c,u=w_(t,c,r),p;l+u<t.length&&t[l+u].face===o.face?p=l+u:p=s,a=t[p];let f=p,y=w_(t,f,r),g=o.edge_after,x=a.edge_before;if(g.bv===jo&&x.bv===jo&&e===Tw||g.bv===Bo&&x.bv===Bo&&e===m1||(g.bv===Bo||x.bv===Bo)&&e===xd&&!i||(g.bv===jo||x.bv===jo)&&e===xd&&i||g.bv===Xi&&x.bv===Xi&&g.overlap&w4t&&i||g.bv===Xi&&x.bv===Xi&&g.overlap&P4t){n.removeChain(r,g,x);for(let v=l;v<l+u;v++)t[v].edge_after=void 0;for(let v=f;v<f+y;v++)t[v].edge_before=void 0}c+=u-1}}function C4t(n,e,t,i){for(let r of e.faces){for(let s of r)n.edges.add(s);i.find(s=>s.face===r)===void 0&&n.addFace(r.first,r.last)}}function I4t(n,e,t){if(t.int_points1.length!==0)for(let i=0;i<t.int_points1.length;i++){let r=t.int_points1[i],s=t.int_points2[i];if(r.edge_before!==void 0&&r.edge_after===void 0&&s.edge_before===void 0&&s.edge_after!==void 0&&(r.edge_before.next=s.edge_after,s.edge_after.prev=r.edge_before,r.edge_after=s.edge_after,s.edge_before=r.edge_before),s.edge_before!==void 0&&s.edge_after===void 0&&r.edge_before===void 0&&r.edge_after!==void 0&&(s.edge_before.next=r.edge_after,r.edge_after.prev=s.edge_before,s.edge_after=r.edge_after,r.edge_before=s.edge_before),r.edge_before!==void 0&&r.edge_after===void 0)for(let o of t.int_points1_sorted)o!==r&&o.edge_before===void 0&&o.edge_after!==void 0&&o.pt.equalTo(r.pt)&&(r.edge_before.next=o.edge_after,o.edge_after.prev=r.edge_before,r.edge_after=o.edge_after,o.edge_before=r.edge_before);if(s.edge_before!==void 0&&s.edge_after===void 0)for(let o of t.int_points2_sorted)o!==s&&o.edge_before===void 0&&o.edge_after!==void 0&&o.pt.equalTo(s.pt)&&(s.edge_before.next=o.edge_after,o.edge_after.prev=s.edge_before,s.edge_after=o.edge_after,o.edge_before=s.edge_before)}}function NN(n,e){for(let t of e)n.faces.delete(t.face),t.face=void 0,t.edge_before&&(t.edge_before.face=void 0),t.edge_after&&(t.edge_after.face=void 0)}function AN(n,e,t){for(let i of e){if(i.edge_before===void 0||i.edge_after===void 0||i.face||i.edge_after.face||i.edge_before.face)continue;let r=i.edge_after,s=i.edge_before;try{l1.testInfiniteLoop(r)}catch{throw In.CANNOT_COMPLETE_BOOLEAN_OPERATION}let o=n.addFace(r,s);for(let a of e)a.edge_before&&a.edge_after&&a.edge_before.face===o&&a.edge_after.face===o&&(a.face=o);for(let a of t)a.edge_before&&a.edge_after&&a.edge_before.face===o&&a.edge_after.face===o&&(a.face=o)}}function aJ(n,e,t,i){for(let r of e){let s=r.first.bv;(t===Tw&&s===jo||t===xd&&s===jo&&i||t===xd&&s===Bo&&!i||t===m1&&s===Bo)&&n.deleteFace(r)}}var JN=Object.freeze({__proto__:null,BOOLEAN_INTERSECT:m1,BOOLEAN_SUBTRACT:xd,BOOLEAN_UNION:Tw,calculateIntersections:NJ,innerClip:IJ,intersect:CJ,outerClip:CN,removeNotRelevantChains:IN,removeOldFaces:NN,restoreFaces:AN,subtract:MN,unify:k4t}),N4t=RegExp("T.F..FFF.|T.F...F.."),A4t=RegExp("T........|.T.......|...T.....|....T...."),R4t=RegExp("FT.......|F..T.....|F...T...."),O4t=RegExp("T.F..F..."),L4t=RegExp("T.F..F...|.TF..F...|..FT.F...|..F.TF..."),ol=class{constructor(){this.m=new Array(9).fill(void 0)}get I2I(){return this.m[0]}set I2I(e){this.m[0]=e}get I2B(){return this.m[1]}set I2B(e){this.m[1]=e}get I2E(){return this.m[2]}set I2E(e){this.m[2]=e}get B2I(){return this.m[3]}set B2I(e){this.m[3]=e}get B2B(){return this.m[4]}set B2B(e){this.m[4]=e}get B2E(){return this.m[5]}set B2E(e){this.m[5]=e}get E2I(){return this.m[6]}set E2I(e){this.m[6]=e}get E2B(){return this.m[7]}set E2B(e){this.m[7]=e}get E2E(){return this.m[8]}set E2E(e){this.m[8]=e}toString(){return this.m.map(e=>e instanceof Array&&e.length>0?"T":e instanceof Array&&e.length===0?"F":"*").join("")}equal(){return N4t.test(this.toString())}intersect(){return A4t.test(this.toString())}touch(){return R4t.test(this.toString())}inside(){return O4t.test(this.toString())}covered(){return L4t.test(this.toString())}};function c1(n,e){let t,i=new L.Ray(e),r=new L.Line(i.pt,i.norm),s=new L.Box(i.box.xmin-L.DP_TOL,i.box.ymin-L.DP_TOL,i.box.xmax+L.DP_TOL,i.box.ymax+L.DP_TOL);if(n.box.not_intersect(s))return L.OUTSIDE;let o=n.edges.search(s);if(o.length===0)return L.OUTSIDE;for(let u of o)if(u.shape.contains(e))return L.BOUNDARY;let a=[...n.faces],c=[];for(let u of o)for(let p of i.intersect(u.shape)){if(p.equalTo(e))return L.BOUNDARY;c.push({pt:p,edge:u,face_index:a.indexOf(u.face)})}c.sort((u,p)=>mJ(u.pt.x,p.pt.x)?-1:fJ(u.pt.x,p.pt.x)?1:u.face_index<p.face_index?-1:u.face_index>p.face_index?1:u.edge.arc_length<p.edge.arc_length?-1:u.edge.arc_length>p.edge.arc_length?1:0);let l=0;for(let u=0;u<c.length;u++){let p=c[u];if(p.pt.equalTo(p.edge.shape.start)){if(u>0&&p.pt.equalTo(c[u-1].pt)&&p.face_index===c[u-1].face_index&&p.edge.prev===c[u-1].edge)continue;let f=p.edge.prev;for(;PN(f.length);)f=f.prev;let y=f.shape.tangentInEnd(),g=p.pt.translate(y),x=p.edge.shape.tangentInStart(),v=p.pt.translate(x),P=g.leftTo(r),w=v.leftTo(r);(P&&!w||!P&&w)&&l++}else if(p.pt.equalTo(p.edge.shape.end)){if(u>0&&p.pt.equalTo(c[u-1].pt)&&p.face_index===c[u-1].face_index&&p.edge.next===c[u-1].edge)continue;let f=p.edge.next;for(;PN(f.length);)f=f.next;let y=f.shape.tangentInStart(),g=p.pt.translate(y),x=p.edge.shape.tangentInEnd(),v=p.pt.translate(x),P=g.leftTo(r),w=v.leftTo(r);(P&&!w||!P&&w)&&l++}else if(p.edge.shape instanceof L.Segment)l++;else{let f=p.edge.shape.box;gd(p.pt.y,f.ymin)||gd(p.pt.y,f.ymax)||l++}}return t=l%2===1?vw:pJ,t}function F4t(n,e){return E_(n,e).equal()}function RJ(n,e){return E_(n,e).intersect()}function z4t(n,e){return E_(n,e).touch()}function $4t(n,e){return!RJ(n,e)}function OJ(n,e){return E_(n,e).inside()}function LJ(n,e){return E_(n,e).covered()}function D4t(n,e){return OJ(e,n)}function FJ(n,e){return LJ(e,n)}function E_(n,e){if(n instanceof L.Line&&e instanceof L.Line)return j4t(n,e);if(n instanceof L.Line&&e instanceof L.Circle)return B4t(n,e);if(n instanceof L.Line&&e instanceof L.Box)return Y4t(n,e);if(n instanceof L.Line&&e instanceof L.Polygon)return X4t(n,e);if((n instanceof L.Segment||n instanceof L.Arc)&&e instanceof L.Polygon)return cJ(n,e);if((n instanceof L.Segment||n instanceof L.Arc)&&(e instanceof L.Circle||e instanceof L.Box))return cJ(n,new L.Polygon(e));if(n instanceof L.Polygon&&e instanceof L.Polygon)return xw(n,e);if((n instanceof L.Circle||n instanceof L.Box)&&(e instanceof L.Circle||e instanceof L.Box))return xw(new L.Polygon(n),new L.Polygon(e));if((n instanceof L.Circle||n instanceof L.Box)&&e instanceof L.Polygon)return xw(new L.Polygon(n),e);if(n instanceof L.Polygon&&(e instanceof L.Circle||e instanceof L.Box))return xw(n,new L.Polygon(e))}function j4t(n,e){let t=new ol,i=k_(n,e);return i.length===0?n.contains(e.pt)&&e.contains(n.pt)?(t.I2I=[n],t.I2E=[],t.E2I=[]):(t.I2I=[],t.I2E=[n],t.E2I=[e]):(t.I2I=i,t.I2E=n.split(i),t.E2I=e.split(i)),t}function B4t(n,e){let t=new ol,i=vd(n,e);if(i.length===0)t.I2I=[],t.I2B=[],t.I2E=[n],t.E2I=[e];else if(i.length===1)t.I2I=[],t.I2B=i,t.I2E=n.split(i),t.E2I=[e];else{let r=new Sd([n]),s=n.sortPoints(i);r.split(s);let o=r.toShapes();t.I2I=[o[1]],t.I2B=s,t.I2E=[o[0],o[2]],t.E2I=new L.Polygon([e.toArc()]).cutWithLine(n)}return t}function Y4t(n,e){let t=new ol,i=v_(n,e);if(i.length===0)t.I2I=[],t.I2B=[],t.I2E=[n],t.E2I=[e];else if(i.length===1)t.I2I=[],t.I2B=i,t.I2E=n.split(i),t.E2I=[e];else{let r=new Sd([n]),s=n.sortPoints(i);r.split(s);let o=r.toShapes();e.toSegments().some(a=>a.contains(i[0])&&a.contains(i[1]))?(t.I2I=[],t.I2B=[o[1]],t.I2E=[o[0],o[2]],t.E2I=[e]):(t.I2I=[o[1]],t.I2B=s,t.I2E=[o[0],o[2]],t.E2I=new L.Polygon(e.toSegments()).cutWithLine(n))}return t}function X4t(n,e){let t=new ol,i=d1(n,e),r=new Sd([n]),s=i.length>0?i.slice():n.sortPoints(i);return r.split(s),[...r].forEach(o=>o.setInclusion(e)),t.I2I=[...r].filter(o=>o.bv===L.INSIDE).map(o=>o.shape),t.I2B=[...r].slice(1).map(o=>o.bv===L.BOUNDARY?o.shape:o.shape.start),t.I2E=[...r].filter(o=>o.bv===L.OUTSIDE).map(o=>o.shape),t.E2I=e.cutWithLine(n),t}function cJ(n,e){let t=new ol,i=_4t(n,e),r=i.length>0?i.slice():n.sortPoints(i),s=new Sd([n]);s.split(r),[...s].forEach(o=>o.setInclusion(e)),t.I2I=[...s].filter(o=>o.bv===L.INSIDE).map(o=>o.shape),t.I2B=[...s].slice(1).map(o=>o.bv===L.BOUNDARY?o.shape:o.shape.start),t.I2E=[...s].filter(o=>o.bv===L.OUTSIDE).map(o=>o.shape),t.B2I=[],t.B2B=[],t.B2E=[];for(let o of[n.start,n.end])switch(c1(e,o)){case L.INSIDE:t.B2I.push(o);break;case L.BOUNDARY:t.B2B.push(o);break;case L.OUTSIDE:t.B2E.push(o);break}return t}function xw(n,e){let t=new ol,[i,r]=NJ(n,e),s=CJ(n,e),o=MN(n,e),a=MN(e,n),[c,l]=IJ(n,e),u=CN(n,e),p=CN(e,n);return t.I2I=s.isEmpty()?[]:[s],t.I2B=l,t.I2E=o.isEmpty()?[]:[o],t.B2I=c,t.B2B=i,t.B2E=u,t.E2I=a.isEmpty()?[]:[a],t.E2B=p,t}var U4t=Object.freeze({__proto__:null,contain:D4t,cover:FJ,covered:LJ,disjoint:$4t,equal:F4t,inside:OJ,intersect:RJ,relate:E_,touch:z4t}),yd=class n{constructor(e=1,t=0,i=0,r=1,s=0,o=0){this.a=e,this.b=t,this.c=i,this.d=r,this.tx=s,this.ty=o}fromMatrix3x3(e){let[t,i,r]=e[0],[s,o,a]=e[1];return new n(t,s,i,o,r,a)}toMatrix3x3(){return[[this.a,this.c,this.tx],[this.b,this.d,this.ty],[0,0,1]]}clone(){return new n(this.a,this.b,this.c,this.d,this.tx,this.ty)}transform(e){return[e[0]*this.a+e[1]*this.c+this.tx,e[0]*this.b+e[1]*this.d+this.ty]}multiply(e){return new n(this.a*e.a+this.c*e.b,this.b*e.a+this.d*e.b,this.a*e.c+this.c*e.d,this.b*e.c+this.d*e.d,this.a*e.tx+this.c*e.ty+this.tx,this.b*e.tx+this.d*e.ty+this.ty)}translate(...e){let t,i;if(e.length==1&&!isNaN(e[0].x)&&!isNaN(e[0].y))t=e[0].x,i=e[0].y;else if(e.length===2&&typeof e[0]=="number"&&typeof e[1]=="number")t=e[0],i=e[1];else throw In.ILLEGAL_PARAMETERS;return this.multiply(new n(1,0,0,1,t,i))}rotate(e,t=0,i=0){let r=Math.cos(e),s=Math.sin(e);return this.translate(t,i).multiply(new n(r,s,-s,r,0,0)).translate(-t,-i)}scale(e,t){return this.multiply(new n(e,0,0,t,0,0))}equalTo(e){return!(!L.Utils.EQ(this.tx,e.tx)||!L.Utils.EQ(this.ty,e.ty)||!L.Utils.EQ(this.a,e.a)||!L.Utils.EQ(this.b,e.b)||!L.Utils.EQ(this.c,e.c)||!L.Utils.EQ(this.d,e.d))}};L.Matrix=yd;var V4t=(...n)=>new L.Matrix(...n);L.matrix=V4t;var RN=class{constructor(e,t){this.low=e,this.high=t}get max(){return this.clone()}less_than(e){return this.low<e.low||this.low===e.low&&this.high<e.high}equal_to(e){return this.low===e.low&&this.high===e.high}intersect(e){return!this.not_intersect(e)}not_intersect(e){return this.high<e.low||e.high<this.low}merge(e){let t=this.low===void 0?e.low:this.low<e.low?this.low:e.low,i=this.high===void 0?e.high:this.high>e.high?this.high:e.high,r=this.clone();return r.low=t,r.high=i,r}output(){return[this.low,this.high]}comparable_less_than(e,t){return e<t}},ON=class n extends RN{clone(){return new n(this.low,this.high)}},or=1,bn=0,$o=class{constructor(e,t,i=null,r=null,s=null,o=bn){if(this.left=i,this.right=r,this.parent=s,this.color=o,this.item={key:void 0,values:[]},t!==void 0&&this.item.values.push(t),e!==void 0)if(Array.isArray(e)){let[a,c]=e;if(!Number.isNaN(a)&&!Number.isNaN(c)){let l=a,u=c;l>u&&([l,u]=[u,l]),this.item.key=new ON(l,u)}}else this.item.key=e;this.max=this.item.key?this.item.key.max:void 0}isNil(){return this.item.key===void 0&&this.item.values.length===0&&this.left===null&&this.right===null&&this.color===bn}requireKey(){if(!this.item.key)throw new Error("Node key is undefined (nil/sentinel). Operation is not applicable.");return this.item.key}less_than(e){let t=this.requireKey(),i=e.requireKey();return t.less_than(i)}_value_equal(e){let t=this.item.values[0],i=e.item.values[0];return t&&i&&t.equal_to?t.equal_to(i):t===i}equal_to(e){let t=this.requireKey(),i=e.requireKey();return t.equal_to(i)}intersect(e){let t=this.requireKey(),i=e.requireKey();return t.intersect(i)}copy_data(e){this.item.key=e.item.key,this.item.values=e.item.values.slice()}update_max(){this.max=this.item.key?this.item.key.max:void 0,this.right&&this.right.max&&(this.max=this.max?this.max.merge(this.right.max):this.right.max),this.left&&this.left.max&&(this.max=this.max?this.max.merge(this.left.max):this.left.max)}not_intersect_left_subtree(e){if(!this.left)return!0;let t=this.left.max?this.left.max.high:this.left.item.key.high,i=this.requireKey(),r=e.requireKey();return i.comparable_less_than(t,r.low)}not_intersect_right_subtree(e){if(!this.right)return!0;let t=this.right.max?this.right.max.low:this.right.item.key.low,i=this.requireKey(),r=e.requireKey();return i.comparable_less_than(r.high,t)}},p1=class n{constructor(){this.root=null,this.nil_node=new $o}get size(){let e=0;return this.tree_walk(this.root,t=>e+=t.item.values.length),e}get keys(){let e=[];return this.tree_walk(this.root,t=>e.push(t.item.key.output())),e}get values(){let e=[];return this.tree_walk(this.root,t=>{for(let i of t.item.values)e.push(i)}),e}get items(){let e=[];return this.tree_walk(this.root,t=>{let i=t.item.key.output();for(let r of t.item.values)e.push({key:i,value:r})}),e}isEmpty(){return this.root==null||this.root===this.nil_node}clear(){this.root=null}insert(e,t=e){if(e===void 0)return;let i=this.tree_search(this.root,new $o(e));if(i)return i.item.values.push(t),i;let r=new $o(e,t,this.nil_node,this.nil_node,null,or);return this.tree_insert(r),this.recalc_max(r),r}exist(e,t=e){let i=this.tree_search(this.root,new $o(e));return i?arguments.length<2||t===e?!0:i.item.values.some(r=>r&&r.equal_to?r.equal_to(t):r===t):!1}remove(e,t=e){let i=this.tree_search(this.root,new $o(e));if(!i)return;if(arguments.length<2)return this.tree_delete(i),i;let r=i.item.values.findIndex(s=>s&&s.equal_to?s.equal_to(t):s===t);if(r>=0)return i.item.values.splice(r,1),i.item.values.length===0&&this.tree_delete(i),i}search(e,t=(i,r)=>i===r?r.output():i){let i=new $o(e),r=[];this.tree_search_interval(this.root,i,r);let s=[];for(let o of r)for(let a of o.item.values)s.push(t(a,o.item.key));return s}intersect_any(e){let t=new $o(e);return this.tree_find_any_interval(this.root,t)}forEach(e){this.tree_walk(this.root,t=>{for(let i of t.item.values)e(t.item.key,i)})}map(e){let t=new n;return this.tree_walk(this.root,i=>{for(let r of i.item.values)t.insert(i.item.key,e(r,i.item.key))}),t}*iterate(e,t=(i,r)=>i===r?r.output():i){let i=null;for(e?i=this.tree_search_nearest_forward(this.root,new $o(e)):this.root&&(i=this.local_minimum(this.root));i;){for(let r of i.item.values)yield t(r,i.item.key);i=this.tree_successor(i)}}recalc_max(e){let t=e;for(;t.parent!=null;)t.parent.update_max(),t=t.parent}tree_insert(e){let t=this.root,i=null;if(this.root==null||this.root===this.nil_node)this.root=e;else{for(;t!==this.nil_node;)i=t,e.less_than(t)?t=t.left:t=t.right;e.parent=i,e.less_than(i)?i.left=e:i.right=e}this.insert_fixup(e)}insert_fixup(e){let t,i;for(t=e;t!==this.root&&t.parent.color===or;)t.parent===t.parent.parent.left?(i=t.parent.parent.right,i.color===or?(t.parent.color=bn,i.color=bn,t.parent.parent.color=or,t=t.parent.parent):(t===t.parent.right&&(t=t.parent,this.rotate_left(t)),t.parent.color=bn,t.parent.parent.color=or,this.rotate_right(t.parent.parent))):(i=t.parent.parent.left,i.color===or?(t.parent.color=bn,i.color=bn,t.parent.parent.color=or,t=t.parent.parent):(t===t.parent.left&&(t=t.parent,this.rotate_right(t)),t.parent.color=bn,t.parent.parent.color=or,this.rotate_left(t.parent.parent)));this.root.color=bn}tree_delete(e){let t,i;e.left===this.nil_node||e.right===this.nil_node?t=e:t=this.tree_successor(e),t.left!==this.nil_node?i=t.left:i=t.right,i.parent=t.parent,t===this.root?this.root=i:(t===t.parent.left?t.parent.left=i:t.parent.right=i,t.parent.update_max()),this.recalc_max(i),t!==e&&(e.copy_data(t),e.update_max(),this.recalc_max(e)),t.color===bn&&this.delete_fixup(i)}delete_fixup(e){let t=e,i;for(;t!==this.root&&t.parent!=null&&t.color===bn;)t===t.parent.left?(i=t.parent.right,i.color===or&&(i.color=bn,t.parent.color=or,this.rotate_left(t.parent),i=t.parent.right),i.left.color===bn&&i.right.color===bn?(i.color=or,t=t.parent):(i.right.color===bn&&(i.color=or,i.left.color=bn,this.rotate_right(i),i=t.parent.right),i.color=t.parent.color,t.parent.color=bn,i.right.color=bn,this.rotate_left(t.parent),t=this.root)):(i=t.parent.left,i.color===or&&(i.color=bn,t.parent.color=or,this.rotate_right(t.parent),i=t.parent.left),i.left.color===bn&&i.right.color===bn?(i.color=or,t=t.parent):(i.left.color===bn&&(i.color=or,i.right.color=bn,this.rotate_left(i),i=t.parent.left),i.color=t.parent.color,t.parent.color=bn,i.left.color=bn,this.rotate_right(t.parent),t=this.root));t.color=bn}tree_search(e,t){if(!(e==null||e===this.nil_node))return t.equal_to(e)?e:t.less_than(e)?this.tree_search(e.left,t):this.tree_search(e.right,t)}tree_search_nearest_forward(e,t){let i=null,r=e;for(;r&&r!==this.nil_node;)r.less_than(t)?r.intersect(t)?(i=r,r=r.left):r=r.right:((!i||r.less_than(i))&&(i=r),r=r.left);return i||null}tree_search_interval(e,t,i){e!=null&&e!==this.nil_node&&(e.left!==this.nil_node&&!e.not_intersect_left_subtree(t)&&this.tree_search_interval(e.left,t,i),e.intersect(t)&&i.push(e),e.right!==this.nil_node&&!e.not_intersect_right_subtree(t)&&this.tree_search_interval(e.right,t,i))}tree_find_any_interval(e,t){let i=!1;return e!=null&&e!==this.nil_node&&(e.left!==this.nil_node&&!e.not_intersect_left_subtree(t)&&(i=this.tree_find_any_interval(e.left,t)),i||(i=e.intersect(t)),!i&&e.right!==this.nil_node&&!e.not_intersect_right_subtree(t)&&(i=this.tree_find_any_interval(e.right,t))),i}local_minimum(e){let t=e;for(;t.left!=null&&t.left!==this.nil_node;)t=t.left;return t}local_maximum(e){let t=e;for(;t.right!=null&&t.right!==this.nil_node;)t=t.right;return t}tree_successor(e){let t,i,r;if(e.right!==this.nil_node)t=this.local_minimum(e.right);else{for(i=e,r=e.parent;r!=null&&r.right===i;)i=r,r=r.parent;t=r}return t}rotate_left(e){let t=e.right;e.right=t.left,t.left!==this.nil_node&&(t.left.parent=e),t.parent=e.parent,e===this.root?this.root=t:e===e.parent.left?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t,e!==null&&e!==this.nil_node&&e.update_max(),t!=null&&t!==this.nil_node&&t.update_max()}rotate_right(e){let t=e.left;e.left=t.right,t.right!==this.nil_node&&(t.right.parent=e),t.parent=e.parent,e===this.root?this.root=t:e===e.parent.left?e.parent.left=t:e.parent.right=t,t.right=e,e.parent=t,e!==null&&e!==this.nil_node&&e.update_max(),t!=null&&t!==this.nil_node&&t.update_max()}tree_walk(e,t){e!=null&&e!==this.nil_node&&(this.tree_walk(e.left,t),t(e),this.tree_walk(e.right,t))}testRedBlackProperty(){let e=!0;return this.tree_walk(this.root,function(t){t.color===or&&(t.left.color===bn&&t.right.color===bn||(e=!1))}),e}testBlackHeightProperty(e){let t=0,i=0,r=0;if(e.color===bn&&t++,e.left!==this.nil_node?i=this.testBlackHeightProperty(e.left):i=1,e.right!==this.nil_node?r=this.testBlackHeightProperty(e.right):r=1,i!==r)throw new Error("Red-black height property violated");return t+=i,t}},LN=class extends Set{constructor(e){super(e),this.index=new p1,this.forEach(t=>this.index.insert(t))}add(e){let t=this.size,{key:i,value:r}=e,s=i||e.box,o=r||e;return super.add(o),this.size>t&&this.index.insert(s,o),this}delete(e){let{key:t,value:i}=e,r=t||e.box,s=i||e,o=super.delete(s);return o&&this.index.remove(r,s),o}clear(){super.clear(),this.index=new p1}search(e){return this.index.search(e)}hit(e){let t=new L.Box(e.x-1,e.y-1,e.x+1,e.y+1);return this.index.search(t).filter(r=>e.on(r))}svg(){return[...this].reduce((t,i)=>t+i.svg(),"")}};L.PlanarSet=LN;var Xo=class{get name(){throw In.CANNOT_INVOKE_ABSTRACT_METHOD}get box(){throw In.CANNOT_INVOKE_ABSTRACT_METHOD}clone(){throw In.CANNOT_INVOKE_ABSTRACT_METHOD}translate(...e){return this.transform(new yd().translate(...e))}rotate(e,t=new L.Point){return this.transform(new yd().rotate(e,t.x,t.y))}scale(e,t){return this.transform(new yd().scale(e,t))}transform(...e){throw In.CANNOT_INVOKE_ABSTRACT_METHOD}toJSON(){return Object.assign({},this,{name:this.name})}svg(e={}){throw In.CANNOT_INVOKE_ABSTRACT_METHOD}},Uo=class zJ extends Xo{constructor(...e){if(super(),this.x=0,this.y=0,e.length!==0){if(e.length===1&&e[0]instanceof Array&&e[0].length===2){let t=e[0];if(typeof t[0]=="number"&&typeof t[1]=="number"){this.x=t[0],this.y=t[1];return}}if(e.length===1&&e[0]instanceof Object&&e[0].name==="point"){let{x:t,y:i}=e[0];this.x=t,this.y=i;return}if(e.length===2&&typeof e[0]=="number"&&typeof e[1]=="number"){this.x=e[0],this.y=e[1];return}throw In.ILLEGAL_PARAMETERS}}get box(){return new L.Box(this.x,this.y,this.x,this.y)}clone(){return new L.Point(this.x,this.y)}get vertices(){return[this.clone()]}equalTo(e){return L.Utils.EQ(this.x,e.x)&&L.Utils.EQ(this.y,e.y)}lessThan(e){return!!(L.Utils.LT(this.y,e.y)||L.Utils.EQ(this.y,e.y)&&L.Utils.LT(this.x,e.x))}transform(e){return new L.Point(e.transform([this.x,this.y]))}projectionOn(e){if(this.equalTo(e.pt))return this.clone();let t=new L.Vector(this,e.pt);if(L.Utils.EQ_0(t.cross(e.norm)))return e.pt.clone();let i=t.dot(e.norm),r=e.norm.multiply(i);return this.translate(r)}leftTo(e){let t=new L.Vector(e.pt,this);return L.Utils.GT(t.dot(e.norm),0)}distanceTo(e){if(e instanceof zJ){let t=e.x-this.x,i=e.y-this.y;return[Math.sqrt(t*t+i*i),new L.Segment(this,e)]}if(e instanceof L.Line)return L.Distance.point2line(this,e);if(e instanceof L.Circle)return L.Distance.point2circle(this,e);if(e instanceof L.Segment)return L.Distance.point2segment(this,e);if(e instanceof L.Arc)return L.Distance.point2arc(this,e);if(e instanceof L.Polygon)return L.Distance.point2polygon(this,e);if(e instanceof L.PlanarSet)return L.Distance.shape2planarSet(this,e);if(e instanceof L.Multiline)return L.Distance.shape2multiline(this,e)}on(e){if(e instanceof L.Point)return this.equalTo(e);if(e.contains&&e.contains instanceof Function)return e.contains(this);throw L.Errors.UNSUPPORTED_SHAPE_TYPE}get name(){return"point"}svg(e={}){let t=e.r??3;return`
<circle cx="${this.x}" cy="${this.y}" r="${t}"
            ${bd({fill:"red",...e})} />`}};L.Point=Uo;var G4t=(...n)=>new L.Point(...n);L.point=G4t;var H4t=class extends Xo{constructor(...e){if(super(),this.x=0,this.y=0,e.length!==0){if(e.length===1&&e[0]instanceof Array&&e[0].length===2){let t=e[0];if(typeof t[0]=="number"&&typeof t[1]=="number"){this.x=t[0],this.y=t[1];return}}if(e.length===1&&e[0]instanceof Object&&e[0].name==="vector"){let{x:t,y:i}=e[0];this.x=t,this.y=i;return}if(e.length===1&&e[0]instanceof Object&&e[0].name==="segment"){let{start:t,end:i}=e[0];this.x=i.x-t.x,this.y=i.y-t.y;return}if(e.length===2){let t=e[0],i=e[1];if(typeof t=="number"&&typeof i=="number"){this.x=t,this.y=i;return}if(t instanceof L.Point&&i instanceof L.Point){this.x=i.x-t.x,this.y=i.y-t.y;return}}throw In.ILLEGAL_PARAMETERS}}clone(){return new L.Vector(this.x,this.y)}get slope(){let e=Math.atan2(this.y,this.x);return e<0&&(e=2*Math.PI+e),e}get length(){return Math.sqrt(this.dot(this))}isZeroLength(){return L.Utils.EQ_0(this.length)}equalTo(e){return L.Utils.EQ(this.x,e.x)&&L.Utils.EQ(this.y,e.y)}multiply(e){return new L.Vector(e*this.x,e*this.y)}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}normalize(){if(this.isZeroLength())throw In.ZERO_DIVISION;return new L.Vector(this.x/this.length,this.y/this.length)}rotate(e,t=new L.Point){if(t.x===0&&t.y===0)return this.transform(new yd().rotate(e));throw In.OPERATION_IS_NOT_SUPPORTED}transform(e){return new L.Vector(e.transform([this.x,this.y]))}rotate90CCW(){return new L.Vector(-this.y,this.x)}rotate90CW(){return new L.Vector(this.y,-this.x)}invert(){return new L.Vector(-this.x,-this.y)}add(e){return new L.Vector(this.x+e.x,this.y+e.y)}subtract(e){return new L.Vector(this.x-e.x,this.y-e.y)}angleTo(e){let t=this.normalize(),i=e.normalize(),r=Math.atan2(t.cross(i),t.dot(i));return r<0&&(r+=2*Math.PI),r}projectionOn(e){let t=e.normalize(),i=this.dot(t);return t.multiply(i)}get name(){return"vector"}};L.Vector=H4t;var $J=(...n)=>new L.Vector(...n);L.vector=$J;var W4t=class FN extends Xo{constructor(...e){if(super(),this.ps=new L.Point,this.pe=new L.Point,e.length!==0){if(e.length===1&&e[0]instanceof Array&&e[0].length===4){let t=e[0];this.ps=new L.Point(t[0],t[1]),this.pe=new L.Point(t[2],t[3]);return}if(e.length===1&&e[0]instanceof Object&&e[0].name==="segment"){let{ps:t,pe:i}=e[0];this.ps=new L.Point(t.x,t.y),this.pe=new L.Point(i.x,i.y);return}if(e.length===1&&e[0]instanceof L.Point){this.ps=e[0].clone();return}if(e.length===2&&e[0]instanceof L.Point&&e[1]instanceof L.Point){this.ps=e[0].clone(),this.pe=e[1].clone();return}if(e.length===4){this.ps=new L.Point(e[0],e[1]),this.pe=new L.Point(e[2],e[3]);return}throw In.ILLEGAL_PARAMETERS}}clone(){return new L.Segment(this.start,this.end)}get start(){return this.ps}get end(){return this.pe}get vertices(){return[this.ps.clone(),this.pe.clone()]}get length(){return this.start.distanceTo(this.end)[0]}get slope(){return new L.Vector(this.start,this.end).slope}get box(){return new L.Box(Math.min(this.start.x,this.end.x),Math.min(this.start.y,this.end.y),Math.max(this.start.x,this.end.x),Math.max(this.start.y,this.end.y))}equalTo(e){return this.ps.equalTo(e.ps)&&this.pe.equalTo(e.pe)}contains(e){return L.Utils.EQ_0(this.distanceToPoint(e))}intersect(e){if(e instanceof L.Point)return this.contains(e)?[e]:[];if(e instanceof L.Line)return h1(this,e);if(e instanceof L.Ray)return qN(e,this);if(e instanceof L.Segment)return Pw(this,e);if(e instanceof L.Circle)return kw(this,e);if(e instanceof L.Box)return l4t(this,e);if(e instanceof L.Arc)return T_(this,e);if(e instanceof L.Polygon)return HN(this,e);if(e instanceof L.Multiline)return f1(this,e)}distanceTo(e){if(e instanceof L.Point){let[t,i]=L.Distance.point2segment(e,this);return i=i.reverse(),[t,i]}if(e instanceof L.Circle){let[t,i]=L.Distance.segment2circle(this,e);return[t,i]}if(e instanceof L.Line){let[t,i]=L.Distance.segment2line(this,e);return[t,i]}if(e instanceof L.Segment){let[t,i]=L.Distance.segment2segment(this,e);return[t,i]}if(e instanceof L.Arc){let[t,i]=L.Distance.segment2arc(this,e);return[t,i]}if(e instanceof L.Polygon){let[t,i]=L.Distance.shape2polygon(this,e);return[t,i]}if(e instanceof L.PlanarSet){let[t,i]=L.Distance.shape2planarSet(this,e);return[t,i]}if(e instanceof L.Multiline)return L.Distance.shape2multiline(this,e)}tangentInStart(){return new L.Vector(this.start,this.end).normalize()}tangentInEnd(){return new L.Vector(this.end,this.start).normalize()}reverse(){return new FN(this.end,this.start)}split(e){return this.start.equalTo(e)?[null,this.clone()]:this.end.equalTo(e)?[this.clone(),null]:[new L.Segment(this.start,e),new L.Segment(e,this.end)]}middle(){return new L.Point((this.start.x+this.end.x)/2,(this.start.y+this.end.y)/2)}pointAtLength(e){if(e>this.length||e<0)return null;if(e==0)return this.start;if(e==this.length)return this.end;let t=e/this.length;return new L.Point((this.end.x-this.start.x)*t+this.start.x,(this.end.y-this.start.y)*t+this.start.y)}distanceToPoint(e){let[t,...i]=L.Distance.point2segment(e,this);return t}definiteIntegral(e=0){let t=this.end.x-this.start.x,i=this.start.y-e,r=this.end.y-e;return t*(i+r)/2}transform(e=new L.Matrix){return new FN(this.ps.transform(e),this.pe.transform(e))}isZeroLength(){return this.ps.equalTo(this.pe)}sortPoints(e){return new L.Line(this.start,this.end).sortPoints(e)}get name(){return"segment"}svg(e={}){return`
<line x1="${this.start.x}" y1="${this.start.y}" x2="${this.end.x}" y2="${this.end.y}" ${bd(e)} />`}};L.Segment=W4t;var q4t=(...n)=>new L.Segment(...n);L.segment=q4t;var{vector:r1}=L,Z4t=class DJ extends Xo{constructor(...e){if(super(),this.pt=new L.Point,this.norm=new L.Vector(0,1),e.length!==0){if(e.length===1&&e[0]instanceof Object&&e[0].name==="line"){let{pt:t,norm:i}=e[0];this.pt=new L.Point(t),this.norm=new L.Vector(i);return}if(e.length===2){let t=e[0],i=e[1];if(t instanceof L.Point&&i instanceof L.Point){this.pt=t,this.norm=DJ.points2norm(t,i),this.norm.dot(r1(this.pt.x,this.pt.y))>=0&&this.norm.invert();return}if(t instanceof L.Point&&i instanceof L.Vector){if(L.Utils.EQ_0(i.x)&&L.Utils.EQ_0(i.y))throw In.ILLEGAL_PARAMETERS;this.pt=t.clone(),this.norm=i.clone(),this.norm=this.norm.normalize(),this.norm.dot(r1(this.pt.x,this.pt.y))>=0&&this.norm.invert();return}if(t instanceof L.Vector&&i instanceof L.Point){if(L.Utils.EQ_0(t.x)&&L.Utils.EQ_0(t.y))throw In.ILLEGAL_PARAMETERS;this.pt=i.clone(),this.norm=t.clone(),this.norm=this.norm.normalize(),this.norm.dot(r1(this.pt.x,this.pt.y))>=0&&this.norm.invert();return}}throw In.ILLEGAL_PARAMETERS}}clone(){return new L.Line(this.pt,this.norm)}get start(){}get end(){}get length(){return Number.POSITIVE_INFINITY}get box(){return new L.Box(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY)}get middle(){}get slope(){return new L.Vector(this.norm.y,-this.norm.x).slope}get standard(){let e=this.norm.x,t=this.norm.y,i=this.norm.dot(r1(this.pt.x,this.pt.y));return[e,t,i]}parallelTo(e){return L.Utils.EQ_0(this.norm.cross(e.norm))}incidentTo(e){return this.parallelTo(e)&&this.pt.on(e)}contains(e){if(this.pt.equalTo(e))return!0;let t=new L.Vector(this.pt,e);return L.Utils.EQ_0(this.norm.dot(t))}coord(e){return r1(e.x,e.y).cross(this.norm)}intersect(e){if(e instanceof L.Point)return this.contains(e)?[e]:[];if(e instanceof L.Line)return k_(this,e);if(e instanceof L.Ray)return TJ(e,this);if(e instanceof L.Circle)return vd(this,e);if(e instanceof L.Box)return v_(this,e);if(e instanceof L.Segment)return h1(e,this);if(e instanceof L.Arc)return ww(this,e);if(e instanceof L.Polygon)return d1(this,e);if(e instanceof L.Multiline)return f1(this,e)}distanceTo(e){if(e instanceof L.Point){let[t,i]=L.Distance.point2line(e,this);return i=i.reverse(),[t,i]}if(e instanceof L.Circle){let[t,i]=L.Distance.circle2line(e,this);return i=i.reverse(),[t,i]}if(e instanceof L.Segment){let[t,i]=L.Distance.segment2line(e,this);return[t,i.reverse()]}if(e instanceof L.Arc){let[t,i]=L.Distance.arc2line(e,this);return[t,i.reverse()]}if(e instanceof L.Polygon){let[t,i]=L.Distance.shape2polygon(this,e);return[t,i]}}split(e){if(e instanceof L.Point)return[new L.Ray(e,this.norm),new L.Ray(e,this.norm)];{let t=new L.Multiline([this]),i=this.sortPoints(e);return t.split(i),t.toShapes()}}rotate(e,t=new L.Point){return new L.Line(this.pt.rotate(e,t),this.norm.rotate(e))}transform(e){return new L.Line(this.pt.transform(e),this.norm.clone())}sortPoints(e){return e.slice().sort((t,i)=>this.coord(t)<this.coord(i)?-1:this.coord(t)>this.coord(i)?1:0)}get name(){return"line"}svg(e,t={}){let i=v_(this,e);if(i.length===0)return"";let r=i[0],s=i.length===2?i[1]:i.find(a=>!a.equalTo(r));return s===void 0&&(s=r),new L.Segment(r,s).svg(t)}static points2norm(e,t){if(e.equalTo(t))throw In.ILLEGAL_PARAMETERS;return new L.Vector(e,t).normalize().rotate90CCW()}};L.Line=Z4t;var K4t=(...n)=>new L.Line(...n);L.line=K4t;var J4t=class extends Xo{constructor(...e){if(super(),this.pc=new L.Point,this.r=1,e.length===1&&e[0]instanceof Object&&e[0].name==="circle"){let{pc:t,r:i}=e[0];this.pc=new L.Point(t),this.r=i}else{let[t,i]=[...e];t&&t instanceof L.Point&&(this.pc=t.clone()),i!==void 0&&(this.r=i)}}clone(){return new L.Circle(this.pc.clone(),this.r)}get center(){return this.pc}get box(){return new L.Box(this.pc.x-this.r,this.pc.y-this.r,this.pc.x+this.r,this.pc.y+this.r)}contains(e){if(e instanceof L.Point)return L.Utils.LE(e.distanceTo(this.center)[0],this.r);if(e instanceof L.Segment)return L.Utils.LE(e.start.distanceTo(this.center)[0],this.r)&&L.Utils.LE(e.end.distanceTo(this.center)[0],this.r);if(e instanceof L.Arc)return this.intersect(e).length===0&&L.Utils.LE(e.start.distanceTo(this.center)[0],this.r)&&L.Utils.LE(e.end.distanceTo(this.center)[0],this.r);if(e instanceof L.Circle)return this.intersect(e).length===0&&L.Utils.LE(e.r,this.r)&&L.Utils.LE(e.center.distanceTo(this.center)[0],this.r)}toArc(e=!0){return new L.Arc(this.center,this.r,Math.PI,-Math.PI,e)}scale(e,t){if(e!==t||!(this.pc.x===0&&this.pc.y===0))throw In.OPERATION_IS_NOT_SUPPORTED;return new L.Circle(this.pc,this.r*e)}transform(e=new L.Matrix){return new L.Circle(this.pc.transform(e),this.r)}intersect(e){if(e instanceof L.Point)return this.contains(e)?[e]:[];if(e instanceof L.Line)return vd(e,this);if(e instanceof L.Ray)return kJ(e,this);if(e instanceof L.Segment)return kw(e,this);if(e instanceof L.Circle)return _J(e,this);if(e instanceof L.Box)return u4t(this,e);if(e instanceof L.Arc)return GN(e,this);if(e instanceof L.Polygon)return vJ(this,e);if(e instanceof L.Multiline)return f1(this,e)}distanceTo(e){if(e instanceof L.Point){let[t,i]=L.Distance.point2circle(e,this);return i=i.reverse(),[t,i]}if(e instanceof L.Circle){let[t,i]=L.Distance.circle2circle(this,e);return[t,i]}if(e instanceof L.Line){let[t,i]=L.Distance.circle2line(this,e);return[t,i]}if(e instanceof L.Segment){let[t,i]=L.Distance.segment2circle(e,this);return i=i.reverse(),[t,i]}if(e instanceof L.Arc){let[t,i]=L.Distance.arc2circle(e,this);return i=i.reverse(),[t,i]}if(e instanceof L.Polygon){let[t,i]=L.Distance.shape2polygon(this,e);return[t,i]}if(e instanceof L.PlanarSet){let[t,i]=L.Distance.shape2planarSet(this,e);return[t,i]}if(e instanceof L.Multiline){let[t,i]=L.Distance.shape2multiline(this,e);return[t,i]}}get name(){return"circle"}svg(e={}){return`
<circle cx="${this.pc.x}" cy="${this.pc.y}" r="${this.r}"
                ${bd({fill:"none",...e})} />`}};L.Circle=J4t;var Q4t=(...n)=>new L.Circle(...n);L.circle=Q4t;var zN=class extends Xo{constructor(...e){if(super(),this.pc=new L.Point,this.r=1,this.startAngle=0,this.endAngle=2*Math.PI,this.counterClockwise=!0,e.length!==0)if(e.length===1&&e[0]instanceof Object&&e[0].name==="arc"){let{pc:t,r:i,startAngle:r,endAngle:s,counterClockwise:o}=e[0];this.pc=new L.Point(t.x,t.y),this.r=i,this.startAngle=r,this.endAngle=s,this.counterClockwise=o}else{let[t,i,r,s,o]=[...e];t&&t instanceof L.Point&&(this.pc=t.clone()),i!==void 0&&(this.r=i),r!==void 0&&(this.startAngle=r),s!==void 0&&(this.endAngle=s),o!==void 0&&(this.counterClockwise=o)}}clone(){return new L.Arc(this.pc.clone(),this.r,this.startAngle,this.endAngle,this.counterClockwise)}get sweep(){let e=this.startAngle,t=this.endAngle;if(L.Utils.EQ(Math.abs(e-t),L.PIx2))return L.PIx2;Math.abs(e)>L.PIx2&&(e-=Math.trunc(e/L.PIx2)*L.PIx2),e<0&&(e+=L.PIx2),Math.abs(t)>L.PIx2&&(t-=Math.trunc(t/L.PIx2)*L.PIx2),t<0&&(t+=L.PIx2);let i=this.counterClockwise?t-e:e-t;return i<0&&(i+=L.PIx2),i}get start(){return new L.Point(this.pc.x+this.r,this.pc.y).rotate(this.startAngle,this.pc)}get end(){return new L.Point(this.pc.x+this.r,this.pc.y).rotate(this.endAngle,this.pc)}get center(){return this.pc.clone()}get vertices(){return[this.start.clone(),this.end.clone()]}get length(){return Math.abs(this.sweep*this.r)}get box(){let t=this.breakToFunctional().reduce((i,r)=>i.merge(r.start.box),new L.Box);return t=t.merge(this.end.box),t}contains(e){if(!L.Utils.EQ(this.pc.distanceTo(e)[0],this.r))return!1;if(e.equalTo(this.start))return!0;let t=new L.Vector(this.pc,e).slope,i=new L.Arc(this.pc,this.r,this.startAngle,t,this.counterClockwise);return L.Utils.LE(i.length,this.length)}split(e){if(this.start.equalTo(e))return[null,this.clone()];if(this.end.equalTo(e))return[this.clone(),null];let t=new L.Vector(this.pc,e).slope;return[new L.Arc(this.pc,this.r,this.startAngle,t,this.counterClockwise),new L.Arc(this.pc,this.r,t,this.endAngle,this.counterClockwise)]}middle(){let e=this.counterClockwise?this.startAngle+this.sweep/2:this.startAngle-this.sweep/2;return new L.Arc(this.pc,this.r,this.startAngle,e,this.counterClockwise).end}pointAtLength(e){if(e>this.length||e<0)return null;if(e===0)return this.start;if(e===this.length)return this.end;let t=e/this.length,i=this.counterClockwise?this.startAngle+this.sweep*t:this.startAngle-this.sweep*t;return new L.Arc(this.pc,this.r,this.startAngle,i,this.counterClockwise).end}chordHeight(){return(1-Math.cos(Math.abs(this.sweep/2)))*this.r}intersect(e){if(e instanceof L.Point)return this.contains(e)?[e]:[];if(e instanceof L.Line)return ww(e,this);if(e instanceof L.Ray)return ZN(e,this);if(e instanceof L.Circle)return GN(this,e);if(e instanceof L.Segment)return T_(e,this);if(e instanceof L.Box)return p4t(this,e);if(e instanceof L.Arc)return yJ(this,e);if(e instanceof L.Polygon)return WN(this,e);if(e instanceof L.Multiline)return f1(this,e)}distanceTo(e){if(e instanceof L.Point){let[t,i]=L.Distance.point2arc(e,this);return i=i.reverse(),[t,i]}if(e instanceof L.Circle){let[t,i]=L.Distance.arc2circle(this,e);return[t,i]}if(e instanceof L.Line){let[t,i]=L.Distance.arc2line(this,e);return[t,i]}if(e instanceof L.Segment){let[t,i]=L.Distance.segment2arc(e,this);return i=i.reverse(),[t,i]}if(e instanceof L.Arc){let[t,i]=L.Distance.arc2arc(this,e);return[t,i]}if(e instanceof L.Polygon){let[t,i]=L.Distance.shape2polygon(this,e);return[t,i]}if(e instanceof L.PlanarSet){let[t,i]=L.Distance.shape2planarSet(this,e);return[t,i]}if(e instanceof L.Multiline)return L.Distance.shape2multiline(this,e)}breakToFunctional(){let e=[],t=[0,Math.PI/2,Math.PI,3*Math.PI/2],i=this.startAngle,r=this.endAngle;L.Utils.EQ(Math.abs(i-r),L.PIx2)&&(r=i),Math.abs(i)>L.PIx2&&(i-=Math.trunc(i/L.PIx2)*L.PIx2),i<0&&(i+=L.PIx2),Math.abs(r)>L.PIx2&&(r-=Math.trunc(r/L.PIx2)*L.PIx2),r<0&&(r+=L.PIx2);let s=i,o,a,c;this.counterClockwise?(a=Math.ceil(i/(Math.PI/2))%4,c=1):(a=Math.floor(i/(Math.PI/2))%4,c=-1);for(let l=0,u=a;l<4;l++,u=(u+c+4)%4){if(o=t[u],o===s)continue;let p=this.counterClockwise?o-i:i-o;if(p<0&&(p+=L.PIx2),p>this.sweep)break;e.push(new L.Arc(this.pc,this.r,s,o,this.counterClockwise)),s=o}return e.length===0?(e.push(this),e):(o=r,s!==o&&e.push(new L.Arc(this.pc,this.r,s,o,this.counterClockwise)),e)}tangentInStart(){let e=new L.Vector(this.pc,this.start),t=this.counterClockwise?Math.PI/2:-Math.PI/2;return e.rotate(t).normalize()}tangentInEnd(){let e=new L.Vector(this.pc,this.end),t=this.counterClockwise?-Math.PI/2:Math.PI/2;return e.rotate(t).normalize()}reverse(){return new L.Arc(this.pc,this.r,this.endAngle,this.startAngle,!this.counterClockwise)}transform(e=new L.Matrix){let t=this.start.transform(e),i=this.end.transform(e),r=this.pc.transform(e),s=this.counterClockwise;return e.a*e.d<0&&(s=!s),L.Arc.arcSE(r,t,i,s)}static arcSE(e,t,i,r){let{vector:s}=L,o=s(e,t).slope,a=s(e,i).slope;L.Utils.EQ(o,a)&&(a+=2*Math.PI,r=!0);let c=s(e,t).length;return new L.Arc(e,c,o,a,r)}definiteIntegral(e=0){return this.breakToFunctional().reduce((r,s)=>r+s.circularSegmentDefiniteIntegral(e),0)}circularSegmentDefiniteIntegral(e){let i=new L.Segment(this.start,this.end).definiteIntegral(e),r=L.Utils.EQ(this.sweep,L.PIx2)?0:this.circularSegmentArea();return this.counterClockwise?i-r:i+r}circularSegmentArea(){return .5*this.r*this.r*(this.sweep-Math.sin(this.sweep))}sortPoints(e){let{vector:t}=L;return e.slice().sort((i,r)=>{let s=t(this.pc,i).slope,o=t(this.pc,r).slope;return s<o?-1:s>o?1:0})}get name(){return"arc"}svg(e={}){let t=this.sweep<=Math.PI?"0":"1",i=this.counterClockwise?"1":"0";return L.Utils.EQ(this.sweep,2*Math.PI)?new L.Circle(this.pc,this.r).svg(e):`
<path d="M${this.start.x},${this.start.y}
                             A${this.r},${this.r} 0 ${t},${i} ${this.end.x},${this.end.y}"
                    ${bd({fill:"none",...e})} />`}};L.Arc=zN;var tNt=(...n)=>new L.Arc(...n);L.arc=tNt;var $N=class n extends Xo{constructor(e=void 0,t=void 0,i=void 0,r=void 0){super(),this.xmin=e,this.ymin=t,this.xmax=i,this.ymax=r}clone(){return new n(this.xmin,this.ymin,this.xmax,this.ymax)}get low(){return new L.Point(this.xmin,this.ymin)}get high(){return new L.Point(this.xmax,this.ymax)}get max(){return this.clone()}get center(){return new L.Point((this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)}get width(){return Math.abs(this.xmax-this.xmin)}get height(){return Math.abs(this.ymax-this.ymin)}get box(){return this.clone()}not_intersect(e){return this.xmax<e.xmin||this.xmin>e.xmax||this.ymax<e.ymin||this.ymin>e.ymax}intersect(e){return!this.not_intersect(e)}merge(e){return new n(this.xmin===void 0?e.xmin:Math.min(this.xmin,e.xmin),this.ymin===void 0?e.ymin:Math.min(this.ymin,e.ymin),this.xmax===void 0?e.xmax:Math.max(this.xmax,e.xmax),this.ymax===void 0?e.ymax:Math.max(this.ymax,e.ymax))}less_than(e){return!!(this.low.lessThan(e.low)||this.low.equalTo(e.low)&&this.high.lessThan(e.high))}equal_to(e){return this.low.equalTo(e.low)&&this.high.equalTo(e.high)}output(){return this.clone()}comparable_less_than(e,t){return e.lessThan(t)}set(e,t,i,r){this.xmin=e,this.ymin=t,this.xmax=i,this.ymax=r}extend(e){return e<=0?this.clone():new n(this.xmin-e,this.ymin-e,this.xmax+e,this.ymax+e)}toPoints(){return[new L.Point(this.xmin,this.ymin),new L.Point(this.xmax,this.ymin),new L.Point(this.xmax,this.ymax),new L.Point(this.xmin,this.ymax)]}toSegments(){let e=this.toPoints();return[new L.Segment(e[0],e[1]),new L.Segment(e[1],e[2]),new L.Segment(e[2],e[3]),new L.Segment(e[3],e[0])]}rotate(e,t=new L.Point){throw In.OPERATION_IS_NOT_SUPPORTED}transform(e=new L.Matrix){return this.toPoints().map(i=>i.transform(e)).reduce((i,r)=>i.merge(r.box),new n)}contains(e){if(e instanceof L.Point)return e.x>=this.xmin&&e.x<=this.xmax&&e.y>=this.ymin&&e.y<=this.ymax;if(e instanceof L.Segment)return e.vertices.every(t=>this.contains(t));if(e instanceof L.Box)return e.toSegments().every(t=>this.contains(t));if(e instanceof L.Circle)return this.contains(e.box);if(e instanceof L.Arc)return e.vertices.every(t=>this.contains(t))&&this.toSegments().every(t=>T_(t,e).length===0);if(e instanceof L.Line||e instanceof L.Ray)return!1;if(e instanceof L.Multiline)return e.toShapes().every(t=>this.contains(t));if(e instanceof L.Polygon)return this.contains(e.box)}distanceTo(e){let t=this.toSegments().map(r=>r.distanceTo(e)),i=[Number.MAX_SAFE_INTEGER,null];return t.forEach(r=>{r[0]<i[0]&&(i=r)}),i}get name(){return"box"}svg(e={}){let t=this.xmax-this.xmin,i=this.ymax-this.ymin;return`
<rect x="${this.xmin}" y="${this.ymin}" width="${t}" height="${i}"
                ${bd({fill:"none",...e})} />`}};L.Box=$N;var eNt=(...n)=>new L.Box(...n);L.box=eNt;var DN=class{constructor(e){this.shape=e,this.next=void 0,this.prev=void 0,this.face=void 0,this.arc_length=0,this.bvStart=void 0,this.bvEnd=void 0,this.bv=void 0,this.overlap=void 0}get start(){return this.shape.start}get end(){return this.shape.end}get length(){return this.shape.length}get box(){return this.shape.box}get isSegment(){return this.shape instanceof L.Segment}get isArc(){return this.shape instanceof L.Arc}get isLine(){return this.shape instanceof L.Line}get isRay(){return this.shape instanceof L.Ray}middle(){return this.shape.middle()}pointAtLength(e){return this.shape.pointAtLength(e)}contains(e){return this.shape.contains(e)}setInclusion(e){if(this.bv!==void 0)return this.bv;if(this.shape instanceof L.Line||this.shape instanceof L.Ray)return this.bv=L.OUTSIDE,this.bv;if(this.bvStart===void 0&&(this.bvStart=c1(e,this.start)),this.bvEnd===void 0&&(this.bvEnd=c1(e,this.end)),this.bvStart===L.OUTSIDE||this.bvEnd==L.OUTSIDE)this.bv=L.OUTSIDE;else if(this.bvStart===L.INSIDE||this.bvEnd==L.INSIDE)this.bv=L.INSIDE;else{let t=c1(e,this.middle());this.bv=t}return this.bv}setOverlap(e){let t,i=this.shape,r=e.shape;i instanceof L.Segment&&r instanceof L.Segment?i.start.equalTo(r.start)&&i.end.equalTo(r.end)?t=L.OVERLAP_SAME:i.start.equalTo(r.end)&&i.end.equalTo(r.start)&&(t=L.OVERLAP_OPPOSITE):(i instanceof L.Arc&&r instanceof L.Arc||i instanceof L.Segment&&r instanceof L.Arc||i instanceof L.Arc&&r instanceof L.Segment)&&(i.start.equalTo(r.start)&&i.end.equalTo(r.end)&&i.middle().equalTo(r.middle())?t=L.OVERLAP_SAME:i.start.equalTo(r.end)&&i.end.equalTo(r.start)&&i.middle().equalTo(r.middle())&&(t=L.OVERLAP_OPPOSITE)),this.overlap===void 0&&(this.overlap=t),e.overlap===void 0&&(e.overlap=t)}svg(){if(this.shape instanceof L.Segment)return` L${this.shape.end.x},${this.shape.end.y}`;if(this.shape instanceof L.Arc){let e=this.shape,t,i=e.counterClockwise?"1":"0";if(L.Utils.EQ(e.sweep,2*Math.PI)){let r=e.counterClockwise?1:-1,s=new L.Arc(e.pc,e.r,e.startAngle,e.startAngle+r*Math.PI,e.counterClockwise),o=new L.Arc(e.pc,e.r,e.startAngle+r*Math.PI,e.endAngle,e.counterClockwise);return t="0",` A${s.r},${s.r} 0 ${t},${i} ${s.end.x},${s.end.y}
                    A${o.r},${o.r} 0 ${t},${i} ${o.end.x},${o.end.y}`}else return t=e.sweep<=Math.PI?"0":"1",` A${e.r},${e.r} 0 ${t},${i} ${e.end.x},${e.end.y}`}}toJSON(){return this.shape.toJSON()}};L.Edge=DN;var jN=class extends l1{constructor(e,t){super(e,t),this.setCircularLinks()}setCircularLinks(){this.isEmpty()||(this.last.next=this.first,this.first.prev=this.last)}[Symbol.iterator](){let e;return{next:()=>{let t=e||this.first,i=this.first?e?e===this.first:!1:!0;return e=t?t.next:void 0,{value:t,done:i}}}}append(e){return super.append(e),this.setCircularLinks(),this}insert(e,t){return super.insert(e,t),this.setCircularLinks(),this}remove(e){return super.remove(e),this}},BN=class n extends jN{constructor(e,...t){if(super(),this._box=void 0,this._orientation=void 0,t.length!==0){if(t.length===1){if(t[0]instanceof Array){let i=t[0];if(i.length===0)return;if(i.every(r=>r instanceof L.Point)){let r=n.points2segments(i);this.shapes2face(e.edges,r)}else if(i.every(r=>r instanceof Array&&r.length===2)){let r=i.map(o=>new L.Point(o[0],o[1])),s=n.points2segments(r);this.shapes2face(e.edges,s)}else if(i.every(r=>r instanceof L.Segment||r instanceof L.Arc))this.shapes2face(e.edges,i);else if(i.every(r=>r.name==="segment"||r.name==="arc")){let r=[];for(let s of i){let o;s.name==="segment"?o=new L.Segment(s):o=new L.Arc(s),r.push(o)}this.shapes2face(e.edges,r)}}else if(t[0]instanceof n){let i=t[0];this.first=i.first,this.last=i.last;for(let r of i)e.edges.add(r)}else if(t[0]instanceof L.Circle)this.shapes2face(e.edges,[t[0].toArc(!0)]);else if(t[0]instanceof L.Box){let i=t[0];this.shapes2face(e.edges,[new L.Segment(new L.Point(i.xmin,i.ymin),new L.Point(i.xmax,i.ymin)),new L.Segment(new L.Point(i.xmax,i.ymin),new L.Point(i.xmax,i.ymax)),new L.Segment(new L.Point(i.xmax,i.ymax),new L.Point(i.xmin,i.ymax)),new L.Segment(new L.Point(i.xmin,i.ymax),new L.Point(i.xmin,i.ymin))])}}t.length===2&&t[0]instanceof L.Edge&&t[1]instanceof L.Edge&&(this.first=t[0],this.last=t[1],this.last.next=this.first,this.first.prev=this.last,this.setArcLength())}}get edges(){return this.toArray()}get vertices(){return this.edges.map(e=>e.shape.start.clone())}get shapes(){return this.edges.map(e=>e.shape.clone())}get box(){if(this._box===void 0){let e=new L.Box;for(let t of this)e=e.merge(t.box);this._box=e}return this._box}get perimeter(){return this.last.arc_length+this.last.length}pointAtLength(e){if(e>this.perimeter||e<0)return null;let t=null;for(let i of this)if(e>=i.arc_length&&(i===this.last||e<i.next.arc_length)){t=i.pointAtLength(e-i.arc_length);break}return t}static points2segments(e){let t=[];for(let i=0;i<e.length;i++)e[i].equalTo(e[(i+1)%e.length])||t.push(new L.Segment(e[i],e[(i+1)%e.length]));return t}shapes2face(e,t){for(let i of t){let r=new L.Edge(i);this.append(r),e.add(r)}}append(e){return super.append(e),this.setOneEdgeArcLength(e),e.face=this,this}insert(e,t){return super.insert(e,t),this.setOneEdgeArcLength(e),e.face=this,this}remove(e){return super.remove(e),this.setArcLength(),this}merge_with_next_edge(e){return e.shape.end.x=e.next.shape.end.x,e.shape.end.y=e.next.shape.end.y,this.remove(e.next),this}reverse(){let e=[],t=this.last;do t.shape=t.shape.reverse(),e.push(t),t=t.prev;while(t!==this.last);this.first=void 0,this.last=void 0;for(let i of e)this.first===void 0?(i.prev=i,i.next=i,this.first=i,this.last=i):(i.prev=this.last,this.last.next=i,this.last=i,this.last.next=this.first,this.first.prev=this.last),this.setOneEdgeArcLength(i);this._orientation!==void 0&&(this._orientation=void 0,this._orientation=this.orientation())}setArcLength(){for(let e of this)this.setOneEdgeArcLength(e),e.face=this}setOneEdgeArcLength(e){e===this.first?e.arc_length=0:e.arc_length=e.prev.arc_length+e.prev.length}area(){return Math.abs(this.signedArea())}signedArea(){let e=0,t=this.box.ymin;for(let i of this)e+=i.shape.definiteIntegral(t);return e}orientation(){if(this._orientation===void 0){let e=this.signedArea();L.Utils.EQ_0(e)?this._orientation=o1.NOT_ORIENTABLE:L.Utils.LT(e,0)?this._orientation=o1.CCW:this._orientation=o1.CW}return this._orientation}isSimple(e){return n.getSelfIntersections(this,e,!0).length===0}static getSelfIntersections(e,t,i=!1){let r=[];for(let s of e){let o=t.search(s.box);for(let a of o){if(s===a||a.face!==e||s.shape instanceof L.Segment&&a.shape instanceof L.Segment&&(s.next===a||s.prev===a))continue;let c=s.shape.intersect(a.shape);for(let l of c)if(!(l.equalTo(s.start)&&l.equalTo(a.end)&&a===s.prev)&&!(l.equalTo(s.end)&&l.equalTo(a.start)&&a===s.next)&&(r.push(l),i))break;if(r.length>0&&i)break}if(r.length>0&&i)break}return r}findEdgeByPoint(e){let t;for(let i of this)if(!e.equalTo(i.shape.start)&&(e.equalTo(i.shape.end)||i.shape.contains(e))){t=i;break}return t}toPolygon(){return new L.Polygon(this.shapes)}toJSON(){return this.edges.map(e=>e.toJSON())}svg(){let e=`M${this.first.start.x},${this.first.start.y}`;for(let t of this)e+=t.svg();return e+=" z",e}};L.Face=BN;var YN=class n extends Xo{constructor(...e){if(super(),this.pt=new L.Point,this.norm=new L.Vector(0,1),e.length!==0&&(e.length>=1&&e[0]instanceof L.Point&&(this.pt=e[0].clone()),e.length!==1)){if(e.length===2&&e[1]instanceof L.Vector){this.norm=e[1].clone();return}throw In.ILLEGAL_PARAMETERS}}clone(){return new n(this.pt,this.norm)}get slope(){return new L.Vector(this.norm.y,-this.norm.x).slope}get box(){let e=this.slope;return new L.Box(e>Math.PI/2&&e<3*Math.PI/2?Number.NEGATIVE_INFINITY:this.pt.x,e>=0&&e<=Math.PI?this.pt.y:Number.NEGATIVE_INFINITY,e>=Math.PI/2&&e<=3*Math.PI/2?this.pt.x:Number.POSITIVE_INFINITY,e>=Math.PI&&e<=2*Math.PI||e===0?this.pt.y:Number.POSITIVE_INFINITY)}get start(){return this.pt}get end(){}get length(){return Number.POSITIVE_INFINITY}contains(e){if(this.pt.equalTo(e))return!0;let t=new L.Vector(this.pt,e);return L.Utils.EQ_0(this.norm.dot(t))&&L.Utils.GE(t.cross(this.norm),0)}coord(e){return $J(e.x,e.y).cross(this.norm)}split(e){return this.contains(e)?this.pt.equalTo(e)?[this]:[new L.Segment(this.pt,e),new L.Ray(e,this.norm)]:[]}intersect(e){if(e instanceof L.Point)return this.contains(e)?[e]:[];if(e instanceof L.Segment)return qN(this,e);if(e instanceof L.Arc)return ZN(this,e);if(e instanceof L.Line)return TJ(this,e);if(e instanceof L.Ray)return g4t(this,e);if(e instanceof L.Circle)return kJ(this,e);if(e instanceof L.Box)return y4t(this,e);if(e instanceof L.Polygon)return EJ(this,e)}rotate(e,t=new L.Point){return new L.Ray(this.pt.rotate(e,t),this.norm.rotate(e))}transform(e){return new L.Ray(this.pt.transform(e),this.norm.clone())}get name(){return"ray"}svg(e,t={}){let i=new L.Line(this.pt,this.norm),r=v_(i,e);return r=r.filter(o=>this.contains(o)),r.length===0||r.length===2?"":new L.Segment(this.pt,r[0]).svg(t)}};L.Ray=YN;var nNt=(...n)=>new L.Ray(...n);L.ray=nNt;var y1=class _d{constructor(){this.faces=new L.PlanarSet,this.edges=new L.PlanarSet;let e=[...arguments];if(e.length===1&&(e[0]instanceof Array&&e[0].length>0||e[0]instanceof L.Circle||e[0]instanceof L.Box)){let t=e[0];if(e[0]instanceof Array&&e[0].every(i=>i instanceof Array))if(t.every(i=>i instanceof Array&&i.length===2&&typeof i[0]=="number"&&typeof i[1]=="number"))this.faces.add(new L.Face(this,t));else for(let i of t)if(i instanceof Array&&i[0]instanceof Array&&i[0].every(r=>r instanceof Array&&r.length===2&&typeof r[0]=="number"&&typeof r[1]=="number"))for(let r of i)this.faces.add(new L.Face(this,r));else this.faces.add(new L.Face(this,i));else this.faces.add(new L.Face(this,t))}}get box(){return[...this.faces].reduce((e,t)=>e.merge(t.box),new L.Box)}get vertices(){return[...this.faces].flatMap(e=>e.vertices)}clone(){let e=new _d;for(let t of this.faces)e.addFace(t.shapes);return e}isEmpty(){return this.edges.size===0||this.faces.size===0}isValid(){let e=!0;for(let t of this.faces)if(!t.isSimple(this.edges)){e=!1;break}return e}area(){let e=[...this.faces].reduce((t,i)=>t+i.signedArea(),0);return Math.abs(e)}addFace(...e){let t=new L.Face(this,...e);return this.faces.add(t),t}deleteFace(e){for(let t of e)this.edges.delete(t);return this.faces.delete(e)}recreateFaces(){this.faces.clear();for(let i of this.edges)i.face=null;let e,t=!0;for(;t;){t=!1;for(let i of this.edges)if(i.face===null){e=i,t=!0;break}if(t){let i=e;do i=i.next;while(i.next!==e);this.addFace(e,i)}}}removeChain(e,t,i){if(i.next===t){this.deleteFace(e);return}for(let r=t;r!==i.next;r=r.next)if(e.remove(r),this.edges.delete(r),e.isEmpty()){this.deleteFace(e);break}}addVertex(e,t){let i=t.shape.split(e);if(i[0]===null)return t.prev;if(i[1]===null)return t;let r=new L.Edge(i[0]),s=t.prev;return t.face.insert(r,s),this.edges.delete(t),this.edges.add(r),t.shape=i[1],this.edges.add(t),r}removeEndVertex(e){let t=e.next;t!==e&&(e.face.merge_with_next_edge(e),this.edges.delete(t))}cut(e){let t=this.clone(),i={int_points1:[],int_points2:[],int_points1_sorted:[],int_points2_sorted:[]};for(let o of e.edges)for(let a of t.edges){let c=SJ(o,a);for(let l of c)S_(o,l,i.int_points1),S_(a,l,i.int_points2)}if(i.int_points1.length===0)return t;i.int_points1_sorted=rl(i.int_points1),i.int_points2_sorted=rl(i.int_points2),P_(e,i.int_points1_sorted),P_(t,i.int_points2_sorted),KN(i),i.int_points1_sorted=rl(i.int_points1),i.int_points2_sorted=rl(i.int_points2),TN(i.int_points1),EN(i.int_points1,t);for(let o of i.int_points1_sorted)o.edge_before&&o.edge_after&&o.edge_before.bv===o.edge_after.bv&&(i.int_points2[o.id]=-1,o.id=-1);if(i.int_points1=i.int_points1.filter(o=>o.id>=0),i.int_points2=i.int_points2.filter(o=>o.id>=0),i.int_points1.forEach((o,a)=>{o.id=a}),i.int_points2.forEach((o,a)=>{o.id=a}),i.int_points1.length===0)return t;i.int_points1_sorted=rl(i.int_points1),i.int_points2_sorted=rl(i.int_points2);let r,s;for(let o=1;o<i.int_points1_sorted.length;o++)if(s=i.int_points1_sorted[o],r=i.int_points1_sorted[o-1],s.edge_before&&s.edge_before.bv===vw){let a=r.edge_after,c=s.edge_before,l=e.getChain(a,c);nJ(i.int_points2[r.id],i.int_points2[s.id],l),l.forEach(u=>t.edges.add(u)),l=l.reverse().map(u=>new L.Edge(u.shape.reverse()));for(let u=0;u<l.length-1;u++)l[u].next=l[u+1],l[u+1].prev=l[u];nJ(i.int_points2[s.id],i.int_points2[r.id],l),l.forEach(u=>t.edges.add(u))}return t.recreateFaces(),t}cutWithLine(e){let t=new Sd([e]);return this.cut(t)}findEdgeByPoint(e){let t;for(let i of this.faces)if(t=i.findEdgeByPoint(e),t!==void 0)break;return t}splitToIslands(){if(this.isEmpty())return[];let e=this.toArray();e.sort((r,s)=>s.area()-r.area());let t=[...e[0].faces][0].orientation(),i=e.filter(r=>[...r.faces][0].orientation()===t);for(let r of e){let s=[...r.faces][0];if(s.orientation()!==t){for(let o of i)if(s.shapes.every(a=>o.contains(a))){o.addFace(s.shapes);break}}}return i}rearrange(){if(this.faces.size<=1)return this.clone();let e=this.splitToIslands(),t=new _d;return e.forEach(i=>{i.faces.forEach(r=>t.addFace(r.shapes))}),t}orientation(){return this.isEmpty()?o1.NOT_ORIENTABLE:[...this.faces][0].orientation()}isOuter(e){return e.orientation()===this.orientation()}isMultiPolygon(){let e=0;return this.faces.forEach(t=>{this.isOuter(t)&&e++}),e>1}reverse(){for(let e of this.faces)e.reverse();return this}contains(e){if(e instanceof L.Point){let t=c1(this,e);return t===vw||t===Do}else return FJ(this,e)}distanceTo(e){if(e instanceof L.Point){let[t,i]=L.Distance.point2polygon(e,this);return i=i.reverse(),[t,i]}if(e instanceof L.Circle||e instanceof L.Line||e instanceof L.Segment||e instanceof L.Arc){let[t,i]=L.Distance.shape2polygon(e,this);return i=i.reverse(),[t,i]}if(e instanceof L.Polygon){let t=[Number.POSITIVE_INFINITY,new L.Segment],i,r;for(let s of this.edges){let o=t[0];[i,r]=L.Distance.shape2planarSet(s.shape,e.edges,o),L.Utils.LT(i,o)&&(t=[i,r])}return t}}intersect(e){if(e instanceof L.Point)return this.contains(e)?[e]:[];if(e instanceof L.Line)return d1(e,this);if(e instanceof L.Ray)return EJ(e,this);if(e instanceof L.Circle)return vJ(e,this);if(e instanceof L.Segment)return HN(e,this);if(e instanceof L.Arc)return WN(e,this);if(e instanceof L.Polygon)return m4t(e,this);if(e instanceof L.Multiline)return f4t(e,this)}translate(e){let t=new _d;for(let i of this.faces)t.addFace(i.shapes.map(r=>r.translate(e)));return t}rotate(e=0,t=new L.Point){let i=new _d;for(let r of this.faces)i.addFace(r.shapes.map(s=>s.rotate(e,t)));return i}scale(e,t){let i=new _d;for(let r of this.faces)i.addFace(r.shapes.map(s=>s.scale(e,t)));return i}transform(e=new L.Matrix){let t=new _d;for(let i of this.faces)t.addFace(i.shapes.map(r=>r.transform(e)));return t}toJSON(){return[...this.faces].map(e=>e.toJSON())}toArray(){return[...this.faces].map(e=>e.toPolygon())}dpath(){return[...this.faces].reduce((e,t)=>e+t.svg(),"")}svg(e={}){let t=`
<path ${bd({fillRule:"evenodd",fill:"lightcyan",...e})} d="`;for(let i of this.faces)t+=`
${i.svg()}`;return t+=`" >
</path>`,t}};L.Polygon=y1;var iNt=(...n)=>new L.Polygon(...n);L.polygon=iNt;var{Circle:SN,Line:lJ,Point:uJ,Vector:bw,Utils:wN}=L,XN=class n{constructor(e){this.circle=e}get inversion_circle(){return this.circle}static inversePoint(e,t){let i=new bw(e.pc,t),r=e.r*e.r,s=i.dot(i);return wN.EQ_0(s)?new uJ(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY):e.pc.translate(i.multiply(r/s))}static inverseCircle(e,t){let i=e.pc.distanceTo(t.pc)[0];if(wN.EQ(i,t.r)){let r=e.r*e.r/(2*t.r),s=new bw(e.pc,t.pc);s=s.normalize();let o=e.pc.translate(s.multiply(r));return new lJ(o,s)}else{let r=new bw(e.pc,t.pc),s=e.r*e.r/(r.dot(r)-t.r*t.r),o=e.pc.translate(r.multiply(s)),a=Math.abs(s)*t.r;return new SN(o,a)}}static inverseLine(e,t){let[i,r]=e.pc.distanceTo(t);if(wN.EQ_0(i))return t.clone();{let s=e.r*e.r/(2*i),o=new bw(e.pc,r.end);return o=o.multiply(s/i),new SN(e.pc.translate(o),s)}}inverse(e){if(e instanceof uJ)return n.inversePoint(this.circle,e);if(e instanceof SN)return n.inverseCircle(this.circle,e);if(e instanceof lJ)return n.inverseLine(this.circle,e)}};L.Inversion=XN;var rNt=n=>new L.Inversion(n);L.inversion=rNt;var UN=class n{static point2point(e,t){return e.distanceTo(t)}static point2line(e,t){let i=e.projectionOn(t);return[new L.Vector(e,i).length,new L.Segment(e,i)]}static point2circle(e,t){let[i,r]=e.distanceTo(t.center);if(L.Utils.EQ_0(i))return[t.r,new L.Segment(e,t.toArc().start)];{let s=Math.abs(i-t.r),o=new L.Vector(t.pc,e).normalize().multiply(t.r),a=t.pc.translate(o);return[s,new L.Segment(e,a)]}}static point2segment(e,t){if(t.start.equalTo(t.end))return n.point2point(e,t.start);let i=new L.Vector(t.start,t.end),r=new L.Vector(t.start,e),s=new L.Vector(t.end,e),o=i.dot(r),a=-i.dot(s),c,l;if(L.Utils.GE(o,0)&&L.Utils.GE(a,0)){let u=t.tangentInStart();return c=Math.abs(u.cross(r)),l=t.start.translate(u.multiply(u.dot(r))),[c,new L.Segment(e,l)]}else return o<0?e.distanceTo(t.start):e.distanceTo(t.end)}static point2arc(e,t){let i=new L.Circle(t.pc,t.r),r=[],s,o;return[s,o]=n.point2circle(e,i),o.end.on(t)&&r.push(n.point2circle(e,i)),r.push(n.point2point(e,t.start)),r.push(n.point2point(e,t.end)),n.sort(r),r[0]}static point2edge(e,t){return t.shape instanceof L.Segment?n.point2segment(e,t.shape):n.point2arc(e,t.shape)}static segment2line(e,t){let i=e.intersect(t);if(i.length>0)return[0,new L.Segment(i[0],i[0])];let r=[];return r.push(n.point2line(e.start,t)),r.push(n.point2line(e.end,t)),n.sort(r),r[0]}static segment2segment(e,t){let i=Pw(e,t);if(i.length>0)return[0,new L.Segment(i[0],i[0])];let r=[],s,o;return[s,o]=n.point2segment(t.start,e),r.push([s,o.reverse()]),[s,o]=n.point2segment(t.end,e),r.push([s,o.reverse()]),r.push(n.point2segment(e.start,t)),r.push(n.point2segment(e.end,t)),n.sort(r),r[0]}static segment2circle(e,t){let i=e.intersect(t);if(i.length>0)return[0,new L.Segment(i[0],i[0])];let r=new L.Line(e.ps,e.pe),[s,o]=n.point2line(t.center,r);if(L.Utils.GE(s,t.r)&&o.end.on(e))return n.point2circle(o.end,t);{let[a,c]=n.point2circle(e.start,t),[l,u]=n.point2circle(e.end,t);return L.Utils.LT(a,l)?[a,c]:[l,u]}}static segment2arc(e,t){let i=e.intersect(t);if(i.length>0)return[0,new L.Segment(i[0],i[0])];let r=new L.Line(e.ps,e.pe),s=new L.Circle(t.pc,t.r),[o,a]=n.point2line(s.center,r);if(L.Utils.GE(o,s.r)&&a.end.on(e)){let[p,f]=n.point2circle(a.end,s);if(f.end.on(t))return[p,f]}let c=[];c.push(n.point2arc(e.start,t)),c.push(n.point2arc(e.end,t));let l,u;return[l,u]=n.point2segment(t.start,e),c.push([l,u.reverse()]),[l,u]=n.point2segment(t.end,e),c.push([l,u.reverse()]),n.sort(c),c[0]}static circle2circle(e,t){let i=e.intersect(t);if(i.length>0)return[0,new L.Segment(i[0],i[0])];if(e.center.equalTo(t.center)){let r=e.toArc(),s=t.toArc();return n.point2point(r.start,s.start)}else{let r=new L.Line(e.center,t.center),s=r.intersect(e),o=r.intersect(t),a=[];return a.push(n.point2point(s[0],o[0])),a.push(n.point2point(s[0],o[1])),a.push(n.point2point(s[1],o[0])),a.push(n.point2point(s[1],o[1])),n.sort(a),a[0]}}static circle2line(e,t){let i=e.intersect(t);if(i.length>0)return[0,new L.Segment(i[0],i[0])];let[r,s]=n.point2line(e.center,t),[o,a]=n.point2circle(s.end,e);return a=a.reverse(),[o,a]}static arc2line(e,t){let i=t.intersect(e);if(i.length>0)return[0,new L.Segment(i[0],i[0])];let r=new L.Circle(e.center,e.r),[s,o]=n.point2line(r.center,t);if(L.Utils.GE(s,r.r)){let[a,c]=n.point2circle(o.end,r);if(c.end.on(e))return[a,c]}else{let a=[];return a.push(n.point2line(e.start,t)),a.push(n.point2line(e.end,t)),n.sort(a),a[0]}}static arc2circle(e,t){let i=e.intersect(t);if(i.length>0)return[0,new L.Segment(i[0],i[0])];let r=new L.Circle(e.center,e.r),[s,o]=n.circle2circle(r,t);if(o.start.on(e))return[s,o];{let a=[];return a.push(n.point2circle(e.start,t)),a.push(n.point2circle(e.end,t)),n.sort(a),a[0]}}static arc2arc(e,t){let i=e.intersect(t);if(i.length>0)return[0,new L.Segment(i[0],i[0])];let r=new L.Circle(e.center,e.r),s=new L.Circle(t.center,t.r),[o,a]=n.circle2circle(r,s);if(a.start.on(e)&&a.end.on(t))return[o,a];{let c=[],l,u;return[l,u]=n.point2arc(e.start,t),u.end.on(t)&&c.push([l,u]),[l,u]=n.point2arc(e.end,t),u.end.on(t)&&c.push([l,u]),[l,u]=n.point2arc(t.start,e),u.end.on(e)&&c.push([l,u.reverse()]),[l,u]=n.point2arc(t.end,e),u.end.on(e)&&c.push([l,u.reverse()]),[l,u]=n.point2point(e.start,t.start),c.push([l,u]),[l,u]=n.point2point(e.start,t.end),c.push([l,u]),[l,u]=n.point2point(e.end,t.start),c.push([l,u]),[l,u]=n.point2point(e.end,t.end),c.push([l,u]),n.sort(c),c[0]}}static point2polygon(e,t){let i=[Number.POSITIVE_INFINITY,new L.Segment];for(let r of t.edges){let[s,o]=n.point2edge(e,r);L.Utils.LT(s,i[0])&&(i=[s,o])}return i}static shape2polygon(e,t){let i=[Number.POSITIVE_INFINITY,new L.Segment];for(let r of t.edges){let[s,o]=e.distanceTo(r.shape);L.Utils.LT(s,i[0])&&(i=[s,o])}return i}static polygon2polygon(e,t){let i=[Number.POSITIVE_INFINITY,new L.Segment];for(let r of e.edges)for(let s of t.edges){let[o,a]=r.shape.distanceTo(s.shape);L.Utils.LT(o,i[0])&&(i=[o,a])}return i}static box2box_minmax(e,t){let i=Math.max(Math.max(e.xmin-t.xmax,0),Math.max(t.xmin-e.xmax,0)),r=Math.max(Math.max(e.ymin-t.ymax,0),Math.max(t.ymin-e.ymax,0)),s=i*i+r*r,o=e.merge(t),a=o.xmax-o.xmin,c=o.ymax-o.ymin,l=a*a+c*c;return[s,l]}static minmax_tree_process_level(e,t,i,r){let s,o;for(let u of t){[s,o]=n.box2box_minmax(e.box,u.item.key);for(let p of u.item.values)p instanceof L.Edge?r.insert([s,o],p.shape):r.insert([s,o],p);L.Utils.LT(o,i)&&(i=o)}if(t.length===0)return i;let a=t.map(u=>u.left.isNil()?void 0:u.left).filter(u=>u!==void 0),c=t.map(u=>u.right.isNil()?void 0:u.right).filter(u=>u!==void 0),l=[...a,...c].filter(u=>{let[p,f]=n.box2box_minmax(e.box,u.max);return L.Utils.LE(p,i)});return i=n.minmax_tree_process_level(e,l,i,r),i}static minmax_tree(e,t,i){let r=new p1,s=[t.index.root],o=i<Number.POSITIVE_INFINITY?i*i:Number.POSITIVE_INFINITY;return o=n.minmax_tree_process_level(e,s,o,r),r}static minmax_tree_calc_distance(e,t,i){let r,s;if(t!=null&&!t.isNil()){if([r,s]=n.minmax_tree_calc_distance(e,t.left,i),s)return[r,s];if(L.Utils.LT(r[0],Math.sqrt(t.item.key.low)))return[r,!0];let[o,a]=n.distanceToArray(e,t.item.values);return L.Utils.LT(o,r[0])&&(r=[o,a]),[r,s]=n.minmax_tree_calc_distance(e,t.right,r),[r,s]}return[i,!1]}static shape2planarSet(e,t,i=Number.POSITIVE_INFINITY){let r=[i,new L.Segment],s=!1;if(t instanceof L.PlanarSet){let o=n.minmax_tree(e,t,i);[r,s]=n.minmax_tree_calc_distance(e,o.root,r)}return r}static sort(e){e.sort((t,i)=>L.Utils.LT(t[0],i[0])?-1:L.Utils.GT(t[0],i[0])?1:0)}static distance(e,t){return e.distanceTo(t)}static distanceToArray(e,t){let i=[Number.POSITIVE_INFINITY,new L.Segment];for(let r of t){let[s,o]=e.distanceTo(r);L.Utils.LT(s,i[0])&&(i=[s,o])}return i}static shape2multiline(e,t){let i=[Number.POSITIVE_INFINITY,new L.Segment];for(let r of t){let[s,o]=n.distance(e,r.shape);L.Utils.LT(s,i[0])&&(i=[s,o])}return i}static multiline2multiline(e,t){let i=[Number.POSITIVE_INFINITY,new L.Segment];for(let r of e)for(let s of t){let[o,a]=n.distance(r.shape,s.shape);L.Utils.LT(o,i[0])&&(i=[o,a])}return i}};L.Distance=UN;var{Multiline:sNt,Point:jJ,Segment:oNt,Polygon:BJ}=L;function QN(n){return new jJ(n.split(" ").map(Number))}function YJ(n){return n.split(", ").map(QN)}function tA(n){let e=YJ(n),t=[];for(let i=0;i<e.length-1;i++)t.push(new oNt(e[i],e[i+1]));return new sNt(t)}function aNt(n){return n.replace(/\(\(/,"").replace(/\)\)$/,"").split("), (").map(tA)}function XJ(n){let e=n.replace(/\(\(/,"").replace(/\)\)$/,"").split("), ("),t=new BJ,i;return e.forEach((r,s)=>{let o=r.split(", ").map(c=>new jJ(c.split(" ").map(Number))),a=t.addFace(o);s===0?i=a.orientation():a.orientation()===i&&a.reverse()}),t}function cNt(n){let t=n.split(/\)\), \(\(/).map(s=>"(("+s+"))").map(XJ),i=new BJ;return t.reduce((s,o)=>[...s,...o?.faces],[]).forEach(s=>i.addFace([...s?.shapes])),i}function lNt(n){if(n.startsWith("POLYGON")){let e=n.replace(/^POLYGON /,"");return XJ(e)}else{let e=n.replace(/^MULTIPOLYGON \(\(\((.*)\)\)\)$/,"$1");return cNt(e)}}function uNt(n){return n.split(`
`).map(t=>t.match(/\(([^)]+)\)/)[1]).map(QN)}function pNt(n){return n.split(`
`).map(t=>t.match(/\(([^)]+)\)/)[1]).map(tA).reduce((t,i)=>[...t,...i],[])}function UJ(n){if(n.startsWith("POINT")){let e=n.replace(/^POINT \(/,"").replace(/\)$/,"");return QN(e)}else if(n.startsWith("MULTIPOINT")){let e=n.replace(/^MULTIPOINT \(/,"").replace(/\)$/,"");return YJ(e)}else if(n.startsWith("LINESTRING")){let e=n.replace(/^LINESTRING \(/,"").replace(/\)$/,"");return tA(e)}else if(n.startsWith("MULTILINESTRING")){let e=n.replace(/^MULTILINESTRING /,"");return aNt(e)}else{if(n.startsWith("POLYGON")||n.startsWith("MULTIPOLYGON"))return lNt(n);if(n.startsWith("GEOMETRYCOLLECTION")){let e=/(?<type>POINT|LINESTRING|POLYGON|MULTIPOINT|MULTILINESTRING|MULTIPOLYGON) \((?:[^\(\)]|\([^\)]*\))*\)/g,t=n.match(e);return t[0].startsWith("GEOMETRYCOLLECTION")&&(t[0]=t[0].replace("GEOMETRYCOLLECTION (","")),t.map(UJ).map(r=>r instanceof Array?r:[r]).reduce((r,s)=>[...r,...s],[])}else{if(VJ(n))return uNt(n);if(GJ(n))return pNt(n)}}return[]}function VJ(n){return n.split(`
`)?.every(e=>e.includes("POINT"))}function GJ(n){return n.split(`
`)?.every(e=>e.includes("LINESTRING"))}function hNt(n){return n.startsWith("POINT")||VJ(n)||n.startsWith("LINESTRING")||GJ(n)||n.startsWith("MULTILINESTRING")||n.startsWith("POLYGON")||n.startsWith("MULTIPOINT")||n.startsWith("MULTIPOLYGON")||n.startsWith("GEOMETRYCOLLECTION")}L.isWktString=hNt;L.parseWKT=UJ;L.BooleanOperations=JN;L.Relations=U4t;Ae();var M_=(n,e,t={x:0,y:0})=>{let i=Math.cos(e),r=Math.sin(e),s=n.x-t.x,o=n.y-t.y;return{x:t.x+s*i-o*r,y:t.y+s*r+o*i}},eA=n=>{n.pads=n.pads.map(e=>{let t=M_(e.offset,n.ccwRotationOffset*Math.PI/180),i=(n.ccwRotationOffset%360+360)%360;return{...e,size:i===90||i===270?{x:e.size.y,y:e.size.x}:e.size,absoluteCenter:{x:n.center.x+t.x,y:n.center.y+t.y}}})};function fNt({components:n,packOrderStrategy:e,packFirst:t=[]}){let i=new Map;return t.forEach((r,s)=>{i.set(r,s)}),[...n].sort((r,s)=>{let o=i.get(r.componentId),a=i.get(s.componentId);return o!==void 0&&a!==void 0?o-a:o!==void 0?-1:a!==void 0?1:e==="largest_to_smallest"?s.pads.length-r.pads.length:r.pads.length-s.pads.length})}var HJ=(n,e,t)=>(e.x-n.x)*(t.y-n.y)-(e.y-n.y)*(t.x-n.x);function mNt(n,e=1e-10){if(n.length<=1)return n;let t=[],i=n[0][0],r=n[0][1];for(let s=1;s<n.length;s++){let o=n[s],[a,c]=o,l=1e-10;if(!(Math.abs(r.x-a.x)<l&&Math.abs(r.y-a.y)<l)){t.push([i,r]),i=a,r=c;continue}let p=HJ(i,r,c);Math.abs(p)<e||(t.push([i,r]),i=a),r=c}if(n.length>2){let s=t[0],o=[i,r];if(s&&t.length>0)if(Math.abs(r.x-s[0].x)<1e-10&&Math.abs(r.y-s[0].y)<1e-10){let l=HJ(i,r,s[1]);Math.abs(l)<e?t[0]=[i,s[1]]:t.push(o)}else t.push(o);else t.push(o)}else t.push([i,r]);return t}var wd=(n,e=0)=>{let t={minX:1/0,maxX:-1/0,minY:1/0,maxY:-1/0};return n.pads.forEach(i=>{let r=i.size.x/2,s=i.size.y/2;[{x:i.offset.x-r,y:i.offset.y-s},{x:i.offset.x+r,y:i.offset.y-s},{x:i.offset.x+r,y:i.offset.y+s},{x:i.offset.x-r,y:i.offset.y+s}].forEach(a=>{let c=M_(a,n.ccwRotationOffset*Math.PI/180),l=c.x+n.center.x,u=c.y+n.center.y;t.minX=Math.min(t.minX,l),t.maxX=Math.max(t.maxX,l),t.minY=Math.min(t.minY,u),t.maxY=Math.max(t.maxY,u)})}),{minX:t.minX-e,maxX:t.maxX+e,minY:t.minY-e,maxY:t.maxY+e}},_Nt=n=>{let e=Math.min(...n.map(s=>s.minX)),t=Math.min(...n.map(s=>s.minY)),i=Math.max(...n.map(s=>s.maxX)),r=Math.max(...n.map(s=>s.maxY));return{minX:e,minY:t,maxX:i,maxY:r}},yNt=(n,e)=>n.pads.map(t=>{let i=t.size.x/2+e,r=t.size.y/2+e,o=[{x:t.offset.x-i,y:t.offset.y-r},{x:t.offset.x+i,y:t.offset.y-r},{x:t.offset.x+i,y:t.offset.y+r},{x:t.offset.x-i,y:t.offset.y+r}].map(f=>{let y=M_(f,n.ccwRotationOffset*Math.PI/180);return{x:y.x+n.center.x,y:y.y+n.center.y}}),a=o.map(({x:f,y})=>[f,y]),c=new L.Polygon(a),l=o.map(f=>f.x),u=o.map(f=>f.y),p={minX:Math.min(...l),minY:Math.min(...u),maxX:Math.max(...l),maxY:Math.max(...u)};return{poly:c,bbox:p}}),gNt=(n,e)=>n.map(t=>{let i=t.width/2+e,r=t.height/2+e,s=t.absoluteCenter.x,o=t.absoluteCenter.y,a=[{x:s-i,y:o-r},{x:s+i,y:o-r},{x:s+i,y:o+r},{x:s-i,y:o+r}],c=a.map(({x:y,y:g})=>[y,g]),l=new L.Polygon(c),u=a.map(y=>y.x),p=a.map(y=>y.y),f={minX:Math.min(...u),minY:Math.min(...p),maxX:Math.max(...u),maxY:Math.max(...p)};return{poly:l,bbox:f}}),xNt=(n,e={})=>{let{minGap:t=0,obstacles:i=[]}=e;if(n.length===0&&i.length===0)return[];let r=n.map(w=>wd(w,t)),s=i.map(w=>({minX:w.absoluteCenter.x-w.width/2-t,minY:w.absoluteCenter.y-w.height/2-t,maxX:w.absoluteCenter.x+w.width/2+t,maxY:w.absoluteCenter.y+w.height/2+t})),o=_Nt([...r,...s]),a=[];for(let w of n){let k=yNt(w,t);a.push(...k)}let c=gNt(i,t);if(a.push(...c),a.length===0)return[];let l=w=>Math.max(0,w.maxX-w.minX)*Math.max(0,w.maxY-w.minY),u=(w,k,T=1e-9)=>w.minX-T<=k.minX&&w.minY-T<=k.minY&&w.maxX+T>=k.maxX&&w.maxY+T>=k.maxY,p=[...a].sort((w,k)=>l(k.bbox)-l(w.bbox)),f=[];for(let w of p){let k=w.bbox.maxX-w.bbox.minX,T=w.bbox.maxY-w.bbox.minY;if(!(k>1e-12&&T>1e-12))continue;let I=!1;for(let E of f)if(u(E.bbox,w.bbox)){I=!0;break}I||f.push(w)}let y=f.map(w=>w.poly),g=new L.Polygon(new L.Box(o.minX,o.minY,o.maxX,o.maxY)),x=g.clone();for(let w=0;w<y.length;w++)try{g=L.BooleanOperations.subtract(g,y[w])}catch{}let v=null;try{v=L.BooleanOperations.subtract(x,g)}catch{try{if(y.length>0){let k=y[0];for(let T=1;T<y.length;T++)try{k=L.BooleanOperations.unify(k,y[T])}catch{}v=k}}catch{v=null}}let P=[];for(let w of v.faces){if(w.isHole)continue;let k=[],T=w.first;if(!T)continue;do{let E=T.shape,N=E.start??E.ps,M=E.end??E.pe;k.push([{x:N.x,y:N.y},{x:M.x,y:M.y}]),T=T.next}while(T!==w.first);let I=mNt(k);P.push(I)}return P},JJ=n=>typeof n=="number"?Math.round(n*100)/100:typeof n=="object"?Object.fromEntries(Object.entries(n).map(([e,t])=>[e,JJ(t)])):n,I_=class{constructor(){d(this,"MAX_ITERATIONS",1e5);d(this,"solved",!1);d(this,"failed",!1);d(this,"iterations",0);d(this,"progress",0);d(this,"error",null);d(this,"activeSubSolver");d(this,"failedSubSolvers");d(this,"timeToSolve");d(this,"stats",{});d(this,"_setupDone",!1)}setup(){this._setupDone||(this._setup(),this._setupDone=!0)}step(){if(this._setupDone||this.setup(),!this.solved&&!this.failed){this.iterations++;try{this._step()}catch(n){throw this.error=`${this.constructor.name} error: ${n}`,console.error(this.error),this.failed=!0,n}!this.solved&&this.iterations>this.MAX_ITERATIONS&&this.tryFinalAcceptance(),!this.solved&&this.iterations>this.MAX_ITERATIONS&&(this.error=`${this.constructor.name} ran out of iterations`,console.error(this.error),this.failed=!0),"computeProgress"in this&&(this.progress=this.computeProgress())}}_setup(){}_step(){}getConstructorParams(){throw new Error("getConstructorParams not implemented")}solve(){let n=Date.now();for(;!this.solved&&!this.failed;)this.step();let e=Date.now();this.timeToSolve=e-n}visualize(){return{lines:[],points:[],rects:[],circles:[]}}tryFinalAcceptance(){}preview(){return{lines:[],points:[],rects:[],circles:[]}}noisySolve(){let n=Date.now();for(;!this.solved&&!this.failed;)this.step(),console.log(JSON.stringify(JJ(this.visualize())));let e=Date.now();this.timeToSolve=e-n}},nA=class extends I_{constructor(e){super();d(this,"offsetPadPoints");d(this,"targetPointMap");d(this,"currentPosition");d(this,"constraintFn");d(this,"epsilon");d(this,"useSquaredDistance");d(this,"optimalPosition");d(this,"initialPosition");this.offsetPadPoints=[...e.offsetPadPoints],this.targetPointMap=new Map(e.targetPointMap),this.initialPosition={...e.initialPosition},this.currentPosition={...e.initialPosition},this.constraintFn=e.constraintFn,this.epsilon=e.epsilon??1e-6,this.useSquaredDistance=e.useSquaredDistance??!1,this.MAX_ITERATIONS=e.maxIterations??100}getConstructorParams(){return{offsetPadPoints:this.offsetPadPoints.map(e=>({...e})),targetPointMap:new Map(this.targetPointMap),initialPosition:this.initialPosition,constraintFn:this.constraintFn,epsilon:this.epsilon,useSquaredDistance:this.useSquaredDistance,maxIterations:this.MAX_ITERATIONS}}_setup(){this.currentPosition={...this.initialPosition},this.optimalPosition=void 0,(!Array.from(this.targetPointMap.values()).some(t=>t.length>0)||this.offsetPadPoints.length===0)&&(this.optimalPosition={...this.currentPosition},this.solved=!0)}_step(){if(this.offsetPadPoints.length===0)return;let{x:e,y:t}=this.currentPosition,i=0,r=0,s=0;for(let p of this.offsetPadPoints){let f=this.targetPointMap.get(p.id)||[];if(f.length===0)continue;let y=e+p.offsetX,g=t+p.offsetY;for(let x of f){let v=y-x.x,P=g-x.y,w=Math.sqrt(v*v+P*P),k;this.useSquaredDistance?k=1:k=w<this.epsilon?1e6:1/w;let T={x:x.x-p.offsetX,y:x.y-p.offsetY};i+=k*T.x,r+=k*T.y,s+=k}}let o={x:s>0?i/s:e,y:s>0?r/s:t},a=this.constraintFn?this.constraintFn(o):o,c=a.x-e,l=a.y-t;if(Math.sqrt(c*c+l*l)<this.epsilon){this.optimalPosition={...a},this.solved=!0;return}this.currentPosition=a}getBestPosition(){return this.optimalPosition||this.currentPosition}getOffsetPadPositions(){let e=this.getBestPosition(),t=new Map;for(let i of this.offsetPadPoints)t.set(i.id,{x:e.x+i.offsetX,y:e.y+i.offsetY});return t}getOffsetPadPosition(e){return this.getOffsetPadPositions().get(e)}getTotalDistance(e){let t=e||this.getBestPosition(),i=0;for(let r of this.offsetPadPoints){let s={x:t.x+r.offsetX,y:t.y+r.offsetY},o=this.targetPointMap.get(r.id)||[];for(let a of o){let c=s.x-a.x,l=s.y-a.y;this.useSquaredDistance?i+=c*c+l*l:i+=Math.sqrt(c*c+l*l)}}return i}getDistanceForPad(e,t){let i=t||this.getBestPosition(),r=this.offsetPadPoints.find(a=>a.id===e);if(!r)return 0;let s={x:i.x+r.offsetX,y:i.y+r.offsetY};return(this.targetPointMap.get(e)||[]).reduce((a,c)=>{let l=s.x-c.x,u=s.y-c.y;return this.useSquaredDistance?a+(l*l+u*u):a+Math.sqrt(l*l+u*u)},0)}computeProgress(){if(this.offsetPadPoints.length===0)return 1;let e=this.getTotalDistance(this.initialPosition),t=this.getTotalDistance();if(e===0)return 1;let i=Math.max(0,e-t);return Math.min(1,i/e)}visualize(){let e={lines:[],points:[],rects:[],circles:[]},t=["#4CAF50","#2196F3","#FF9800","#9C27B0","#F44336","#607D8B"],i=this.getBestPosition();for(let r=0;r<this.offsetPadPoints.length;r++){let s=this.offsetPadPoints[r];if(!s)continue;let o=t[r%t.length],a=this.targetPointMap.get(s.id)||[],c={x:i.x+s.offsetX,y:i.y+s.offsetY};for(let l of a)e.points.push({...l,color:o});for(let l of a)e.lines.push({points:[c,l],strokeColor:o});e.points.push({x:c.x,y:c.y,color:o})}return e.points.push({...this.currentPosition,color:"#f44336"}),this.optimalPosition&&e.points.push({...this.optimalPosition,color:"rgba(76, 175, 80, 0.3)"}),e}},bNt=class extends I_{constructor(e){super();d(this,"offsetPadPoints");d(this,"targetPointMap");d(this,"constraintFn");d(this,"currentPosition");d(this,"optimalPosition");d(this,"initialPosition");d(this,"phase1Epsilon");d(this,"phase2Epsilon");d(this,"maxIterations");d(this,"phase1Solver");d(this,"phase2Solver");d(this,"currentPhase",1);d(this,"phase1Position");d(this,"closestTargetPadId");d(this,"closestTargetPoint");this.offsetPadPoints=[...e.offsetPadPoints],this.targetPointMap=new Map(e.targetPointMap),this.initialPosition={...e.initialPosition},this.currentPosition={...e.initialPosition},this.constraintFn=e.constraintFn,this.phase1Epsilon=e.phase1Epsilon??e.epsilon??1e-6,this.phase2Epsilon=e.phase2Epsilon??e.epsilon??1e-6,this.maxIterations=e.maxIterations??100}getConstructorParams(){return{offsetPadPoints:this.offsetPadPoints.map(e=>({...e})),targetPointMap:new Map(this.targetPointMap),initialPosition:this.initialPosition,constraintFn:this.constraintFn,phase1Epsilon:this.phase1Epsilon,phase2Epsilon:this.phase2Epsilon,maxIterations:this.maxIterations}}_setup(){if(this.currentPosition={...this.initialPosition},this.optimalPosition=void 0,this.currentPhase=1,this.phase1Position=void 0,this.closestTargetPadId=void 0,this.closestTargetPoint=void 0,!Array.from(this.targetPointMap.values()).some(t=>t.length>0)||this.offsetPadPoints.length===0){this.optimalPosition={...this.currentPosition},this.solved=!0;return}this.phase1Solver=new nA({offsetPadPoints:this.offsetPadPoints,targetPointMap:this.targetPointMap,initialPosition:this.initialPosition,constraintFn:this.constraintFn,epsilon:this.phase1Epsilon,maxIterations:this.maxIterations,useSquaredDistance:!0}),this.phase1Solver.setup()}_step(){this.currentPhase===1?this.stepPhase1():this.stepPhase2()}stepPhase1(){this.phase1Solver&&(this.phase1Solver.step(),this.currentPosition=this.phase1Solver.getBestPosition(),this.phase1Solver.solved?(this.phase1Position=this.phase1Solver.getBestPosition(),this.setupPhase2()):this.phase1Solver.failed&&(this.failed=!0,this.error=`Phase 1 failed: ${this.phase1Solver.error}`))}setupPhase2(){if(!this.phase1Position)return;let e=1/0,t,i;for(let s of this.offsetPadPoints){let o=this.targetPointMap.get(s.id)||[];if(o.length===0)continue;let a=this.phase1Position.x+s.offsetX,c=this.phase1Position.y+s.offsetY;for(let l of o){let u=a-l.x,p=c-l.y,f=Math.sqrt(u*u+p*p);f<e&&(e=f,t=s.id,i=l)}}if(this.closestTargetPadId=t,this.closestTargetPoint=i,!t||!i){this.optimalPosition=this.phase1Position,this.solved=!0;return}let r=new Map;r.set(t,[i]),this.phase2Solver=new nA({offsetPadPoints:this.offsetPadPoints,targetPointMap:r,initialPosition:this.phase1Position,constraintFn:this.constraintFn,epsilon:this.phase2Epsilon,maxIterations:this.maxIterations,useSquaredDistance:!1}),this.phase2Solver.setup(),this.currentPhase=2}stepPhase2(){this.phase2Solver&&(this.phase2Solver.step(),this.currentPosition=this.phase2Solver.getBestPosition(),this.phase2Solver.solved?(this.optimalPosition=this.phase2Solver.getBestPosition(),this.solved=!0):this.phase2Solver.failed&&(this.failed=!0,this.error=`Phase 2 failed: ${this.phase2Solver.error}`))}getBestPosition(){return this.optimalPosition||this.currentPosition}getOffsetPadPositions(){let e=this.getBestPosition(),t=new Map;for(let i of this.offsetPadPoints)t.set(i.id,{x:e.x+i.offsetX,y:e.y+i.offsetY});return t}getTotalDistance(e){let t=e||this.getBestPosition(),i=0;for(let r of this.offsetPadPoints){let s={x:t.x+r.offsetX,y:t.y+r.offsetY},o=this.targetPointMap.get(r.id)||[];for(let a of o){let c=s.x-a.x,l=s.y-a.y;i+=c*c+l*l}}return i}visualize(){let e={lines:[],points:[],rects:[],circles:[]};if(e.points.push({...this.currentPosition,color:this.currentPhase===1?"#FF6B6B":"#4ECDC4",label:`Phase ${this.currentPhase}`}),this.phase1Position&&this.currentPhase===2&&e.points.push({...this.phase1Position,color:"rgba(255, 107, 107, 0.5)",label:"Phase 1 result"}),this.closestTargetPoint&&this.closestTargetPadId){e.points.push({...this.closestTargetPoint,color:"#FFA500",label:`Closest target (${this.closestTargetPadId})`});let i=this.offsetPadPoints.find(r=>r.id===this.closestTargetPadId);if(i){let r=this.getBestPosition(),s={x:r.x+i.offsetX,y:r.y+i.offsetY};e.lines.push({points:[s,this.closestTargetPoint],strokeColor:"#FFA500"})}}let t=this.currentPhase===1?this.phase1Solver:this.phase2Solver;if(t){let i=t.visualize(),r=this.currentPhase===1?"rgba(255, 107, 107, 0.7)":"rgba(76, 205, 196, 0.7)";if(i.lines){let s=i.lines.map(o=>({...o,strokeColor:r}));e.lines.push(...s)}i.points&&e.points.push(...i.points),i.rects&&e.rects.push(...i.rects),i.circles&&e.circles.push(...i.circles)}return this.optimalPosition&&e.points.push({...this.optimalPosition,color:"rgba(76, 175, 80, 0.8)",label:"Final optimal position"}),e}},vNt=n=>{let e={};for(let t=0;t<n.length;t++)e[n[t]]=`hsl(${t*300/n.length}, 100%, 50%)`;return e},iA=(n,e=1)=>`hsl(${n.split("").reduce((i,r)=>i*31+r.charCodeAt(0),0)%360}, 100%, 50%, ${e})`,La=1e-9;function SNt(n,e,t,i){return n*i-e*t}function rA(n,e,t){return SNt(e.x-n.x,e.y-n.y,t.x-n.x,t.y-n.y)}function wNt(n,e,t,i=La){let r=rA(e,t,n);if(Math.abs(r)>i)return!1;let s=Math.min(e.x,t.x)-i,o=Math.max(e.x,t.x)+i,a=Math.min(e.y,t.y)-i,c=Math.max(e.y,t.y)+i;return n.x>=s&&n.x<=o&&n.y>=a&&n.y<=c}function WJ(n,e,t="even-odd"){let i=1/0,r=1/0,s=-1/0,o=-1/0;for(let a of e){let[c,l]=a;i=Math.min(i,c.x,l.x),r=Math.min(r,c.y,l.y),s=Math.max(s,c.x,l.x),o=Math.max(o,c.y,l.y)}if(n.x<i-La||n.x>s+La||n.y<r-La||n.y>o+La)return"outside";for(let a of e){let[c,l]=a;if(wNt(n,c,l))return"boundary"}if(t==="even-odd"){let a=0;for(let c of e){let[l,u]=c,p=l.y,f=u.y,y=l.x,g=u.x;if(!(p<=n.y&&n.y<f||f<=n.y&&n.y<p))continue;let v=f-p;if(Math.abs(v)<La)continue;let P=(n.y-p)/v;y+P*(g-y)>n.x+La&&a++}return a%2===1?"inside":"outside"}else{let a=0;for(let c of e){let[l,u]=c;l.y<=n.y?u.y>n.y&&rA(l,u,n)>La&&a++:u.y<=n.y&&rA(l,u,n)<-La&&a--}return a!==0?"inside":"outside"}}function qJ(n,e){let[t,i]=n,r=i.x-t.x,s=i.y-t.y,o=Math.hypot(r,s);if(o===0)return{x:0,y:1};let a=r/o,c=s/o,l={x:-c,y:a},u={x:c,y:-a},p={x:(t.x+i.x)/2,y:(t.y+i.y)/2},f=PNt(e),y=Math.max(f.maxX-f.minX,f.maxY-f.minY)||1,g=Math.max(1e-4,.001*y),x={x:p.x+l.x*g,y:p.y+l.y*g},v={x:p.x+u.x*g,y:p.y+u.y*g};if(WJ(x,e)==="outside")return l;if(WJ(v,e)==="outside")return u;let k=[];if(e.length>0){k.push(e[0][0]);for(let A of e)k.push(A[1])}let T=(()=>{let A=0;for(let R=0;R<k.length;R++){let j=k[R],B=k[(R+1)%k.length];A+=j.x*B.y-B.x*j.y}return A/2})();if(Math.abs(T)>1e-12)return T>0?u:l;let I={x:(f.minX+f.maxX)/2,y:(f.minY+f.maxY)/2},E={x:p.x-I.x,y:p.y-I.y},N=l.x*E.x+l.y*E.y;return u.x*E.x+u.y*E.y>=N?u:l}function PNt(n,e=0){let t=1/0,i=1/0,r=-1/0,s=-1/0;for(let[o,a]of n)t=Math.min(t,o.x,a.x),i=Math.min(i,o.y,a.y),r=Math.max(r,o.x,a.x),s=Math.max(s,o.y,a.y);return{minX:t-e,minY:i-e,maxX:r+e,maxY:s+e}}var kNt=class extends I_{constructor(e){super();d(this,"fullOutline");d(this,"origin");d(this,"globalBounds");d(this,"largestRect",null);this.fullOutline=e.fullOutline,this.origin=e.origin,this.globalBounds=e.globalBounds}getConstructorParams(){return{fullOutline:this.fullOutline,origin:this.origin,globalBounds:this.globalBounds}}_setup(){}_step(){this.largestRect=this.computeLargestRectOutside(),this.solved=!0}computeLargestRectOutside(){let e=this.makeEdges(this.fullOutline),t={x:this.globalBounds.minX,y:this.globalBounds.minY,w:this.globalBounds.maxX-this.globalBounds.minX,h:this.globalBounds.maxY-this.globalBounds.minY};return this.largestRectContainingPointRegion(e,this.origin,t,"outside")}almostEqual(e,t,i=1e-9){return Math.abs(e-t)<=i}makeEdges(e){let t=[];for(let i=0;i<e.length;i++){let r=e[i],s=e[(i+1)%e.length];!r||!s||this.almostEqual(r.x,s.x)&&this.almostEqual(r.y,s.y)||t.push([r,s])}return t}isVertical(e){return this.almostEqual(e[0].x,e[1].x)}isHorizontal(e){return this.almostEqual(e[0].y,e[1].y)}scanlineIntervalsAtY(e,t){let i=[];for(let s of e){if(!this.isVertical(s))continue;let o=s[0].y,a=s[1].y,c=s[0].x,l=Math.min(o,a),u=Math.max(o,a);l<=t&&t<u&&i.push(c)}i.sort((s,o)=>s-o);let r=[];for(let s=0;s+1<i.length;s+=2){let o=i[s],a=i[s+1];o!==void 0&&a!==void 0&&r.push([o,a])}return r}clipIntervals(e,t,i){let r=[];for(let[s,o]of e){let a=Math.max(t,s),c=Math.min(i,o);c>a&&r.push([a,c])}return r}regionIntervalsAtY(e,t,i,r,s){let o=this.clipIntervals(this.scanlineIntervalsAtY(e,t),i,r),a=[],c=i;for(let[l,u]of o)l>c&&a.push([c,l]),c=Math.max(c,u);return c<r&&a.push([c,r]),a}largestRectContainingPointRegion(e,t,i,r){let s=i.x,o=i.x+i.w,a=i.y,c=i.y+i.h,u=this.regionIntervalsAtY(e,t.y,s,o,r).find(([I,E])=>I-1e-9<=t.x&&t.x<=E+1e-9);if(!u)return null;let[p,f]=u,y=new Set([p,f]);for(let I of e){if(!this.isVertical(I))continue;let E=I[0].x;p<E&&E<f&&y.add(E)}let g=Array.from(y).sort((I,E)=>I-E),x=g.length-1;if(x<=0)return null;let v=Array(x).fill(-1/0),P=Array(x).fill(1/0);for(let I=0;I<x;I++){let E=g[I],N=g[I+1];if(E===void 0||N===void 0)continue;let M=.5*(E+N);y.has(M)&&(M+=1e-6);let A=c,R=a;for(let j of e){if(!this.isHorizontal(j))continue;let B=j[0].y,G=Math.min(j[0].x,j[1].x),U=Math.max(j[0].x,j[1].x);G-1e-9<=M&&M<=U+1e-9&&(B>t.y&&(A=Math.min(A,B)),B<t.y&&(R=Math.max(R,B)))}R<A?(v[I]=A,P[I]=R):(v[I]=-1/0,P[I]=1/0)}let w=-1;for(let I=0;I<x;I++){let E=g[I],N=g[I+1];if(!(E===void 0||N===void 0)&&E-1e-9<=t.x&&t.x<=N+1e-9){w=I;break}}if(w===-1)return null;let k=null,T=-1;for(let I=0;I<=w;I++){let E=1/0,N=-1/0;for(let M=I;M<x;M++){let A=v[M],R=P[M];if(A===void 0||R===void 0||(E=Math.min(E,A),N=Math.max(N,R),M<w))continue;let j=Math.max(0,E-N);if(j<=0)continue;let B=g[I],G=g[M+1];if(B===void 0||G===void 0)continue;let U=G-B,H=U*j;H>T&&(T=H,k={x:B,y:N,w:U,h:j})}}return k}getLargestRect(){return this.solved||this.solve(),this.largestRect}getLargestRectBounds(){return this.solved||this.solve(),this.largestRect?{minX:this.largestRect.x,minY:this.largestRect.y,maxX:this.largestRect.x+this.largestRect.w,maxY:this.largestRect.y+this.largestRect.h}:{minX:0,minY:0,maxX:0,maxY:0}}visualize(){let e={lines:[],points:[],rects:[],circles:[]};for(let t=0;t<this.fullOutline.length;t++){let i=this.fullOutline[t],r=this.fullOutline[(t+1)%this.fullOutline.length];i&&r&&e.lines.push({points:[i,r],strokeColor:"rgba(0,0,0,0.5)"})}return e.lines.push({points:[...this.fullOutline,this.fullOutline[0]],strokeColor:"rgba(200, 200, 200, 0.5)",strokeDash:[10,5]}),e.circles.push({center:this.origin,radius:.05,fill:"#f44336",label:"Origin"}),this.largestRect&&e.rects.push({center:{x:this.largestRect.x+this.largestRect.w/2,y:this.largestRect.y+this.largestRect.h/2},width:this.largestRect.w,height:this.largestRect.h,fill:"rgba(0, 255, 0, 0.3)",stroke:"#4CAF50",label:`Largest Rectangle (Area: ${(this.largestRect.w*this.largestRect.h).toFixed(3)})`}),e}},TNt=(n,{rotationDegrees:e=0})=>{let t={minX:1/0,maxX:-1/0,minY:1/0,maxY:-1/0};for(let i of n.pads){let r=i.size.x/2,s=i.size.y/2,o=[{x:i.offset.x-r,y:i.offset.y-s},{x:i.offset.x+r,y:i.offset.y-s},{x:i.offset.x+r,y:i.offset.y+s},{x:i.offset.x-r,y:i.offset.y+s}];for(let a of o){let c=M_(a,e*Math.PI/180),l=c.x,u=c.y;t.minX=Math.min(t.minX,l),t.maxX=Math.max(t.maxX,l),t.minY=Math.min(t.minY,u),t.maxY=Math.max(t.maxY,u)}}return{minX:t.minX,maxX:t.maxX,minY:t.minY,maxY:t.maxY}},ENt=(n,e)=>{let[t,i]=n,r={x:i.x-t.x,y:i.y-t.y},s=MNt(r);return[{x:t.x-s.x*e,y:t.y-s.y*e},{x:i.x+s.x*e,y:i.y+s.y*e}]};function MNt(n){let e=Math.hypot(n.x,n.y);return{x:n.x/e,y:n.y/e}}function C_(n,e){if(e.length<3)return!1;let t=!1,i=e.length,r=[...e];(r[0].x!==r[i-1].x||r[0].y!==r[i-1].y)&&r.push({...r[0]});for(let s=0,o=r.length-1;s<r.length;o=s++){let a=r[s].x,c=r[s].y,l=r[o].x,u=r[o].y;c>n.y!=u>n.y&&n.x<(l-a)*(n.y-c)/(u-c)+a&&(t=!t)}return t}var CNt=class extends I_{constructor(e){super();d(this,"outlineSegment");d(this,"viableOutlineSegment",null);d(this,"fullOutline");d(this,"componentRotationDegrees");d(this,"packStrategy");d(this,"minGap");d(this,"obstacles");d(this,"packedComponents");d(this,"componentToPack");d(this,"viableBounds");d(this,"globalBounds");d(this,"boundaryOutline");d(this,"optimalPosition");d(this,"irlsSolver");d(this,"twoPhaseIrlsSolver");this.outlineSegment=e.outlineSegment,this.fullOutline=e.fullOutline,this.componentRotationDegrees=e.componentRotationDegrees,this.packStrategy=e.packStrategy,this.minGap=e.minGap,this.packedComponents=e.packedComponents,this.componentToPack=e.componentToPack,this.obstacles=e.obstacles??[],this.globalBounds=e.globalBounds,this.boundaryOutline=e.boundaryOutline}getConstructorParams(){return{outlineSegment:this.outlineSegment,fullOutline:this.fullOutline,componentRotationDegrees:this.componentRotationDegrees,packStrategy:this.packStrategy,minGap:this.minGap,packedComponents:this.packedComponents,componentToPack:this.componentToPack,obstacles:this.obstacles,globalBounds:this.globalBounds,boundaryOutline:this.boundaryOutline}}_getOutlineBoundsWithMargin(e={}){let t=1/0,i=1/0,r=-1/0,s=-1/0;for(let[a,c]of this.fullOutline)t=Math.min(t,a.x,c.x),i=Math.min(i,a.y,c.y),r=Math.max(r,a.x,c.x),s=Math.max(s,a.y,c.y);let o=e.margin??0;return{minX:t-o,minY:i-o,maxX:r+o,maxY:s+o}}_setup(){let{offsetPadPoints:e,targetPointMap:t}=this.getNetworkTargetPointMappings(),[i,r]=this.outlineSegment,s=A=>{let R=this.projectPointOntoSegment(A,this.viableOutlineSegment);return this.adjustPositionForOutlineCollision(R)},o=qJ(this.outlineSegment,this.fullOutline),a=TNt(this.componentToPack,{rotationDegrees:this.componentRotationDegrees}),c=this._getOutlineBoundsWithMargin({margin:Math.max(a.maxX-a.minX,a.maxY-a.minY)*2+this.minGap*2}),l={fullOutline:this.fullOutline.flatMap(([A])=>A),globalBounds:c,origin:{x:(i.x+r.x)/2+o.x*1e-4,y:(i.y+r.y)/2+o.y*1e-4}},u=new kNt(l);u.solve();let p=u.getLargestRectBounds(),f={x:Math.abs(Math.sign(this.outlineSegment[1].x-this.outlineSegment[0].x)),y:Math.abs(Math.sign(this.outlineSegment[1].y-this.outlineSegment[0].y))},y={minX:p.minX-a.minX*f.x,minY:p.minY-a.minY*f.y,maxX:p.maxX-a.maxX*f.x,maxY:p.maxY-a.maxY*f.y};if(this.boundaryOutline&&this.boundaryOutline.length>=3){let A=1/0,R=1/0,j=-1/0,B=-1/0;for(let G of this.boundaryOutline)A=Math.min(A,G.x),R=Math.min(R,G.y),j=Math.max(j,G.x),B=Math.max(B,G.y);y={minX:Math.max(y.minX,A-a.minX),minY:Math.max(y.minY,R-a.minY),maxX:Math.min(y.maxX,j-a.maxX),maxY:Math.min(y.maxY,B-a.maxY)}}this.viableBounds=y;let g=y.maxX-y.minX,x=y.maxY-y.minY,v=a.maxX-a.minX,P=a.maxY-a.minY;if(g<v||x<P){this.failed=!0,this.error="There is nowhere for the component to fit along this outline section";return}let w=Math.hypot(r.x-i.x,r.y-i.y),k=ENt(this.outlineSegment,w),[T,I]=k;this.viableOutlineSegment=[{x:Gn(T.x,y.minX,y.maxX),y:Gn(T.y,y.minY,y.maxY)},{x:Gn(I.x,y.minX,y.maxX),y:Gn(I.y,y.minY,y.maxY)}];let[E,N]=this.viableOutlineSegment,M=this.adjustPositionForOutlineCollision({x:(E.x+N.x)/2,y:(E.y+N.y)/2});this.packStrategy==="minimum_closest_sum_squared_distance"?this.twoPhaseIrlsSolver=new bNt({offsetPadPoints:e,targetPointMap:t,initialPosition:M,constraintFn:s,epsilon:1e-6,maxIterations:50}):this.irlsSolver=new nA({offsetPadPoints:e,targetPointMap:t,initialPosition:M,constraintFn:s,epsilon:1e-6,maxIterations:50,useSquaredDistance:this.packStrategy==="minimum_sum_squared_distance_to_network"})}_step(){let e=this.irlsSolver||this.twoPhaseIrlsSolver;if(!e){this.solved=!0;return}if(e.step(),e.solved){let t=e.getBestPosition();this.optimalPosition=t,this.solved=!0}else e.failed&&(this.failed=!0,this.error=e.error)}getNetworkTargetPointMappings(){let e=this.getRotatedComponentPads(),t=e.map(r=>({id:r.padId,offsetX:r.offset.x,offsetY:r.offset.y})),i=new Map;for(let r of e){let s=[];for(let o of this.packedComponents)for(let a of o.pads)a.networkId===r.networkId&&s.push({...a.absoluteCenter,networkId:a.networkId});i.set(r.padId,s)}return{offsetPadPoints:t,targetPointMap:i}}projectPointOntoSegment(e,t){let[i,r]=t,s=r.x-i.x,o=r.y-i.y,a=e.x-i.x,c=e.y-i.y,l=s*s+o*o;if(l===0)return{x:i.x,y:i.y};let u=Math.max(0,Math.min(1,(a*s+c*o)/l));return{x:i.x+u*s,y:i.y+u*o}}getRotatedComponentPads(){let e=this.componentRotationDegrees*Math.PI/180;return this.componentToPack.pads.map(t=>({...t,size:(this.componentRotationDegrees+90)%180===0?{x:t.size.y,y:t.size.x}:t.size,offset:M_(t.offset,e)}))}createTemporaryPackedComponent(e){let t=this.componentRotationDegrees*Math.PI/180,i=(this.componentRotationDegrees+90)%180===0;return{componentId:this.componentToPack.componentId,center:e,ccwRotationOffset:this.componentRotationDegrees,pads:this.componentToPack.pads.map(r=>{let s=M_(r.offset,t);return{...r,size:{x:i?r.size.y:r.size.x,y:i?r.size.x:r.size.y},absoluteCenter:{x:e.x+s.x,y:e.y+s.y}}})}}adjustPositionForOutlineCollision(e){let t=this.createTemporaryPackedComponent(e),i=wd(t,0),r=qJ(this.outlineSegment,this.fullOutline),s=Math.abs(r.x)>Math.abs(r.y),o=!s,a=e;if(s){let c=r.x>0;c?a={x:i.maxX,y:e.y}:!c&&(a={x:i.minX,y:e.y})}else if(o){let c=r.y>0;c?a={x:e.x,y:i.maxY}:!c&&(a={x:e.x,y:i.minY})}if(this.boundaryOutline&&this.boundaryOutline.length>=3){let c=this.createTemporaryPackedComponent(a),l=wd(c,0),u=c.pads.every(f=>C_(f.absoluteCenter,this.boundaryOutline)),p=[{x:l.minX,y:l.minY},{x:l.minX,y:l.maxY},{x:l.maxX,y:l.minY},{x:l.maxX,y:l.maxY}].every(f=>C_(f,this.boundaryOutline));(!u||!p)&&this.viableBounds&&(a={x:Gn(a.x,this.viableBounds.minX,this.viableBounds.maxX),y:Gn(a.y,this.viableBounds.minY,this.viableBounds.maxY)})}return a}visualize(){let e={lines:[],points:[],rects:[],circles:[]};if(this.obstacles&&this.obstacles.length>0)for(let a of this.obstacles)e.rects.push({center:a.absoluteCenter,width:a.width,height:a.height,fill:"rgba(0,0,0,0.1)",stroke:"#555",label:a.obstacleId});if(this.globalBounds&&e.lines.push({points:[{x:this.globalBounds.minX,y:this.globalBounds.minY},{x:this.globalBounds.minX,y:this.globalBounds.maxY},{x:this.globalBounds.maxX,y:this.globalBounds.maxY},{x:this.globalBounds.maxX,y:this.globalBounds.minY},{x:this.globalBounds.minX,y:this.globalBounds.minY}],strokeColor:"rgba(255,0,255,0.5)",strokeDash:"2 2"}),this.boundaryOutline&&this.boundaryOutline.length){let a=[...this.boundaryOutline];a.length>0&&(a[0].x!==a[a.length-1].x||a[0].y!==a[a.length-1].y)&&a.push({...a[0]}),e.lines.push({points:a,strokeColor:"rgba(0, 0, 255, 0.5)",strokeDash:"4 2"})}if(this.viableBounds&&e.rects.push({center:{x:(this.viableBounds.minX+this.viableBounds.maxX)/2,y:(this.viableBounds.minY+this.viableBounds.maxY)/2},width:this.viableBounds.maxX-this.viableBounds.minX,height:this.viableBounds.maxY-this.viableBounds.minY,fill:"rgba(0,255,0,0.1)",label:"Viable Bounds"}),this.viableOutlineSegment){let[a,c]=this.viableOutlineSegment;e.lines.push({points:[a,c],strokeColor:"#2196F3"})}let[t,i]=this.outlineSegment;e.lines.push({points:[t,i],strokeColor:"rgba(255,0,0,1)",strokeDash:"3 3"});for(let[a,c]of this.fullOutline)e.lines.push({points:[a,c],strokeColor:"rgba(0,0,0,0.5)",strokeDash:"4 4"});for(let a of this.packedComponents)for(let c of a.pads)e.rects.push({center:c.absoluteCenter,width:c.size.x,height:c.size.y,fill:iA(c.networkId,.5),stroke:"#333",label:`${c.padId} (${c.networkId})`});let r=this.optimalPosition??this.irlsSolver?.currentPosition??this.twoPhaseIrlsSolver?.currentPosition??{x:0,y:0},s=this.getRotatedComponentPads();for(let a of s){let c={x:r.x+a.offset.x,y:r.y+a.offset.y};e.rects.push({center:c,width:a.size.x,height:a.size.y,fill:this.failed?"rgba(255,0,0,0.5)":iA(a.networkId,.5),label:`${a.padId} (${a.networkId})`});for(let l of this.packedComponents)for(let u of l.pads)u.networkId===a.networkId&&e.lines.push({points:[c,u.absoluteCenter],strokeColor:a.networkId==="VCC"?"#FF6B6B":"#4ECDC4",strokeDash:[2,2],label:`${a.networkId} connection`})}let o=this.irlsSolver||this.twoPhaseIrlsSolver;if(o){let a=o.currentPosition;e.points.push({...a,color:"#f44336"});let c=o.visualize();c.lines&&e.lines.push(...c.lines),c.circles&&e.circles.push(...c.circles),c.rects&&e.rects.push(...c.rects),c.points&&e.points.push(...c.points)}return this.optimalPosition&&e.points.push({...this.optimalPosition,color:"rgba(76, 175, 80, 0.3)"}),e}},sA=n=>{let e=[],t=[];if(n.boundaryOutline&&n.boundaryOutline.length){let s=[...n.boundaryOutline];s.length>0&&(s[0].x!==s[s.length-1].x||s[0].y!==s[s.length-1].y)&&s.push({...s[0]}),t.push({points:s,strokeColor:"rgba(0, 0, 255, 0.5)",strokeDash:"4 2"})}let i=Array.from(new Set(n.components.flatMap(s=>s.pads.map(o=>o.networkId)))),r=vNt(i);if(n.obstacles&&n.obstacles.length>0)for(let s of n.obstacles)e.push({center:{x:s.absoluteCenter.x,y:s.absoluteCenter.y},width:s.width,height:s.height,fill:"rgba(0,0,0,0.1)",stroke:"#555",label:s.obstacleId});for(let s of n.components){let o=wd(s),a=o.maxX-o.minX,c=o.maxY-o.minY,l={center:{x:s.center.x,y:s.center.y},width:a,height:c,fill:"rgba(0,0,0,0.25)",label:[s.componentId,`ccwRotationOffset: ${s.ccwRotationOffset.toFixed(1)}\xB0`].join(`
`)};e.push(l);for(let u of s.pads){let{absoluteCenter:p,size:f,padId:y,networkId:g}=u,x={center:{x:p.x,y:p.y},width:f.x,height:f.y,label:`${y} ${g}`,fill:"rgba(255,0,0,0.8)"};e.push(x)}}for(let s of i){let o=n.components.flatMap(a=>a.pads.filter(c=>c.networkId===s));for(let a=0;a<o.length;a++)for(let c=a+1;c<o.length;c++)t.push({points:[o[a].absoluteCenter,o[c].absoluteCenter],strokeColor:r[s]})}return{coordinateSystem:"cartesian",rects:e,lines:t}};function INt({component:n,packedComponents:e,minGap:t}){let i=e.flatMap(s=>s.pads.map(o=>({center:{x:o.absoluteCenter.x,y:o.absoluteCenter.y},width:o.size.x,height:o.size.y}))),r=n.pads.map(s=>({center:{x:s.absoluteCenter.x,y:s.absoluteCenter.y},width:s.size.x,height:s.size.y}));for(let s of r)for(let o of i){let{distance:a}=Ao(s,o);if(a+1e-6<t)return{hasOverlap:!0,gapDistance:a}}return{hasOverlap:!1}}var ZJ=class extends I_{constructor(e){super();d(this,"componentToPack");d(this,"packedComponents");d(this,"packPlacementStrategy");d(this,"minGap");d(this,"obstacles");d(this,"boundaryOutline");d(this,"currentPhase","outline");d(this,"outlines",[]);d(this,"queuedOutlineSegments",[]);d(this,"currentSegmentIndex",0);d(this,"currentRotationIndex",0);d(this,"activeSubSolver",null);d(this,"candidateResults",[]);d(this,"rejectedCandidates",[]);d(this,"bestCandidate");d(this,"outputPackedComponent");d(this,"bounds");this.componentToPack=e.componentToPack,this.packedComponents=e.packedComponents,this.packPlacementStrategy=e.packPlacementStrategy,this.minGap=e.minGap??0,this.obstacles=e.obstacles??[],this.bounds=e.bounds,this.boundaryOutline=e.boundaryOutline}_setup(){super._setup(),this.currentPhase="outline",this.outlines=[],this.queuedOutlineSegments=[],this.candidateResults=[],this.activeSubSolver=void 0,this.currentSegmentIndex=0,this.currentRotationIndex=0}_step(){if(!(this.solved||this.failed))switch(this.currentPhase){case"outline":this.executeOutlinePhase();break;case"segment_candidate":this.executeSegmentCandidatePhase();break;case"evaluate":this.executeEvaluatePhase();break}}executeOutlinePhase(){if(this.packedComponents.length===0){let t=this.componentToPack.availableRotationDegrees??[0,90,180,270],i={x:0,y:0},r=t[0]??0,s=this.createPackedComponent(i,r);if(!(this.obstacles??[]).some(a=>{let c={center:{x:a.absoluteCenter.x,y:a.absoluteCenter.y},width:a.width,height:a.height};return s.pads.some(l=>{let u={center:{x:l.absoluteCenter.x,y:l.absoluteCenter.y},width:l.size.x,height:l.size.y},{distance:p}=Ao(u,c);return p+1e-6<this.minGap})})){this.outputPackedComponent=s,this.solved=!0;return}}this.outlines=xNt(this.packedComponents,{minGap:this.minGap,obstacles:this.obstacles});let e=this.componentToPack.availableRotationDegrees??[0,90,180,270];for(let t=0;t<this.outlines.length;t++){let i=this.outlines[t];for(let r=0;r<i.length;r++){let s=i[r];this.queuedOutlineSegments.push({segment:s,availableRotations:[...e],segmentIndex:t*1e3+r,fullOutline:i})}}this.currentPhase="segment_candidate",this.currentSegmentIndex=0,this.currentRotationIndex=0}executeSegmentCandidatePhase(){if(this.activeSubSolver?.solved||this.activeSubSolver?.failed){let e=this.queuedOutlineSegments[this.currentSegmentIndex],t=e.availableRotations[this.currentRotationIndex],i=1/0,r;if(this.activeSubSolver.solved&&this.activeSubSolver.optimalPosition){r=this.activeSubSolver.optimalPosition;let s=this.createPackedComponent(r,t),{hasOverlap:o,gapDistance:a}=INt({component:s,packedComponents:this.packedComponents,minGap:this.minGap}),c=1/0,l=(this.obstacles??[]).some(f=>{let y={center:{x:f.absoluteCenter.x,y:f.absoluteCenter.y},width:f.width,height:f.height};return s.pads.some(g=>{let x={center:{x:g.absoluteCenter.x,y:g.absoluteCenter.y},width:g.size.x,height:g.size.y},{distance:v}=Ao(x,y);return c=Math.min(c,v),v+1e-6<this.minGap})}),u=!1;if(this.bounds){let f=wd(s,0);u=f.minX<this.bounds.minX||f.maxX>this.bounds.maxX||f.minY<this.bounds.minY||f.maxY>this.bounds.maxY}let p=!1;if(this.boundaryOutline&&this.boundaryOutline.length>=3){let f=wd(s,0),y=s.pads.every(x=>C_(x.absoluteCenter,this.boundaryOutline)),g=[{x:f.minX,y:f.minY},{x:f.minX,y:f.maxY},{x:f.maxX,y:f.minY},{x:f.maxX,y:f.maxY}].every(x=>C_(x,this.boundaryOutline));p=!y||!g}i=this.calculateDistance(r,t),o?this.rejectedCandidates.push({segment:e.segment,rotation:t,optimalPosition:r,distance:i,segmentIndex:e.segmentIndex,rotationIndex:this.currentRotationIndex,gapDistance:a}):l?this.rejectedCandidates.push({segment:e.segment,rotation:t,optimalPosition:r,distance:i,segmentIndex:e.segmentIndex,rotationIndex:this.currentRotationIndex,gapDistance:c}):u?this.rejectedCandidates.push({segment:e.segment,rotation:t,optimalPosition:r,distance:i,segmentIndex:e.segmentIndex,rotationIndex:this.currentRotationIndex,gapDistance:-1}):p?this.rejectedCandidates.push({segment:e.segment,rotation:t,optimalPosition:r,distance:i,segmentIndex:e.segmentIndex,rotationIndex:this.currentRotationIndex,gapDistance:-1}):this.candidateResults.push({segment:e.segment,rotation:t,optimalPosition:r,distance:i,segmentIndex:e.segmentIndex,rotationIndex:this.currentRotationIndex})}this.currentRotationIndex++,this.activeSubSolver=void 0}for(;!this.activeSubSolver;){if(this.currentSegmentIndex>=this.queuedOutlineSegments.length){this.currentPhase="evaluate";return}let e=this.queuedOutlineSegments[this.currentSegmentIndex];if(this.currentRotationIndex>=e.availableRotations.length){this.currentSegmentIndex++,this.currentRotationIndex=0;continue}let t=e.availableRotations[this.currentRotationIndex];this.activeSubSolver=new CNt({outlineSegment:e.segment,fullOutline:e.fullOutline,componentRotationDegrees:t,packStrategy:this.packPlacementStrategy,minGap:this.minGap,packedComponents:this.packedComponents,componentToPack:this.componentToPack,obstacles:this.obstacles,globalBounds:this.bounds,boundaryOutline:this.boundaryOutline}),this.activeSubSolver.setup();break}this.activeSubSolver.step()}executeEvaluatePhase(){if(this.candidateResults.length===0){this.failed=!0,this.error="No valid candidates found";return}this.candidateResults.sort((e,t)=>e.distance-t.distance),this.bestCandidate=this.candidateResults[0],this.bestCandidate.optimalPosition&&(this.outputPackedComponent=this.createPackedComponent(this.bestCandidate.optimalPosition,this.bestCandidate.rotation)),this.solved=!0}calculateDistance(e,t){let i=this.createPackedComponent(e,t),r=0,s=this.packPlacementStrategy==="minimum_sum_squared_distance_to_network"||this.packPlacementStrategy==="minimum_closest_sum_squared_distance";for(let o of i.pads){let a=1/0;for(let c of this.packedComponents)for(let l of c.pads)if(l.networkId===o.networkId){let u=o.absoluteCenter.x-l.absoluteCenter.x,p=o.absoluteCenter.y-l.absoluteCenter.y,f=Math.sqrt(u*u+p*p);a=Math.min(a,f)}a<1/0&&(r+=s?a*a:a)}return r}createPackedComponent(e,t){let i={...this.componentToPack,center:e,ccwRotationOffset:t,pads:this.componentToPack.pads.map(r=>({...r,absoluteCenter:{x:0,y:0}}))};return eA(i),i}visualize(){if(this.activeSubSolver)return this.activeSubSolver.visualize();let e=sA({components:this.packedComponents,minGap:this.minGap,packOrderStrategy:"largest_to_smallest",packPlacementStrategy:this.packPlacementStrategy});if(e.points??(e.points=[]),e.lines??(e.lines=[]),e.rects??(e.rects=[]),e.texts??(e.texts=[]),e.circles??(e.circles=[]),this.obstacles&&this.obstacles.length>0)for(let t of this.obstacles)e.rects.push({center:t.absoluteCenter,width:t.width,height:t.height,fill:"rgba(0,0,0,0.1)",stroke:"#555",label:t.obstacleId});if(this.bounds&&e.lines.push({points:[{x:this.bounds.minX,y:this.bounds.minY},{x:this.bounds.minX,y:this.bounds.maxY},{x:this.bounds.maxX,y:this.bounds.maxY},{x:this.bounds.maxX,y:this.bounds.minY},{x:this.bounds.minX,y:this.bounds.minY}],strokeColor:"rgba(0,0,0,0.5)",strokeDash:"2 2"}),this.boundaryOutline&&this.boundaryOutline.length){let t=[...this.boundaryOutline];t.length>0&&(t[0].x!==t[t.length-1].x||t[0].y!==t[t.length-1].y)&&t.push({...t[0]}),e.lines.push({points:t,strokeColor:"rgba(0, 0, 255, 0.5)",strokeDash:"4 2"})}switch(this.currentPhase){case"outline":this.visualizeOutlinePhase(e);break;case"segment_candidate":this.visualizeSegmentCandidatePhase(e);break;case"evaluate":this.visualizeEvaluatePhase(e);break}return e}visualizeOutlinePhase(e){for(let t of this.outlines)for(let i of t){let[r,s]=i;e.lines.push({points:[r,s],strokeColor:"#ff4444"})}}visualizeSegmentCandidatePhase(e){if(this.visualizeOutlinePhase(e),this.activeSubSolver){let t=this.activeSubSolver.visualize();t.lines&&e.lines.push(...t.lines),t.points&&e.points.push(...t.points),t.rects&&e.rects.push(...t.rects),t.circles&&e.circles.push(...t.circles??[])}else for(let t=0;t<this.candidateResults.length;t++){let i=this.candidateResults[t];if(i.optimalPosition){let r=this.createPackedComponent(i.optimalPosition,i.rotation);for(let s of r.pads)e.rects.push({center:s.absoluteCenter,width:s.size.x,height:s.size.y,fill:"rgba(255,165,0,0.3)",stroke:"rgba(255,165,0,0.8)",strokeWidth:1});e.points.push({x:i.optimalPosition.x,y:i.optimalPosition.y,label:`c${t}, d=${i.distance.toFixed(3)}`,color:"rgba(255,165,0,0.8)"})}}}visualizeEvaluatePhase(e){this.visualizeOutlinePhase(e);for(let t=0;t<this.candidateResults.length;t++){let i=this.candidateResults[t];if(!i.optimalPosition)continue;let r=t,s=r===0;e.points.push({x:i.optimalPosition.x,y:i.optimalPosition.y,label:`step=${r}, d=${i.distance.toFixed(3)}`,color:s?"rgba(0,255,0,0.8)":"rgba(255,165,0,0.6)"})}for(let t=0;t<this.rejectedCandidates.length;t++){let i=this.rejectedCandidates[t];i.optimalPosition&&e.points.push({x:i.optimalPosition.x,y:i.optimalPosition.y,label:`rejected, d=${i.distance.toFixed(3)}
gap_distance=${i.gapDistance}`,color:"rgba(255,0,0,0.8)"})}if(this.outputPackedComponent)for(let t of this.outputPackedComponent.pads)e.rects.push({center:t.absoluteCenter,width:t.size.x,height:t.size.y,fill:"rgba(0,255,0,0.7)"})}getResult(){return this.outputPackedComponent}getConstructorParams(){return{componentToPack:this.componentToPack,packedComponents:this.packedComponents,packPlacementStrategy:this.packPlacementStrategy,minGap:this.minGap,obstacles:this.obstacles,bounds:this.bounds,boundaryOutline:this.boundaryOutline}}};function NNt(n){if(n.length<3){let s=n.reduce((a,c)=>a+c.x,0),o=n.reduce((a,c)=>a+c.y,0);return{x:s/n.length,y:o/n.length}}let e=0,t=0,i=0;for(let s=0;s<n.length;s++){let o=n[s],a=n[(s+1)%n.length],c=o.x*a.y-a.x*o.y;e+=c,t+=(o.x+a.x)*c,i+=(o.y+a.y)*c}if(e*=.5,Math.abs(e)<1e-10){let s=n.reduce((a,c)=>a+c.x,0),o=n.reduce((a,c)=>a+c.y,0);return{x:s/n.length,y:o/n.length}}return t/=6*e,i/=6*e,{x:t,y:i}}var g1=class extends I_{constructor(e){super();d(this,"packInput");d(this,"unpackedComponentQueue",[]);d(this,"packedComponents",[]);d(this,"componentToPack");this.packInput=e}getConstructorParams(){return this.packInput}_setup(){let{components:e,packOrderStrategy:t,packFirst:i=[]}=this.packInput;this.unpackedComponentQueue=fNt({components:e,packOrderStrategy:t,packFirst:i}),this.packedComponents=[]}packFirstComponent(){let e=this.unpackedComponentQueue.shift(),t={x:0,y:0};this.packInput.boundaryOutline&&this.packInput.boundaryOutline.length>=3&&(t=NNt(this.packInput.boundaryOutline));let i={...e,center:t,ccwRotationOffset:0,pads:e.pads.map(l=>({...l,absoluteCenter:{x:0,y:0}}))};eA(i);let r=this.packInput.obstacles??[],s=r.some(l=>{let u={center:{x:l.absoluteCenter.x,y:l.absoluteCenter.y},width:l.width,height:l.height};return i.pads.some(p=>{let f={center:{x:p.absoluteCenter.x,y:p.absoluteCenter.y},width:p.size.x,height:p.size.y},{distance:y}=Ao(f,u);return y+1e-6<this.packInput.minGap})}),o=!1;if(this.packInput.boundaryOutline&&this.packInput.boundaryOutline.length>=3){let l=wd(i,0),u=i.pads.every(f=>C_(f.absoluteCenter,this.packInput.boundaryOutline)),p=[{x:l.minX,y:l.minY},{x:l.minX,y:l.maxY},{x:l.maxX,y:l.minY},{x:l.maxX,y:l.maxY}].every(f=>C_(f,this.packInput.boundaryOutline));o=!u||!p}if(!s&&!o){this.packedComponents.push(i);return}let a=new ZJ({packedComponents:[],componentToPack:e,packPlacementStrategy:this.packInput.packPlacementStrategy,minGap:this.packInput.minGap,obstacles:r,bounds:this.packInput.bounds,boundaryOutline:this.packInput.boundaryOutline});a.solve();let c=a.getResult();c?this.packedComponents.push(c):this.packedComponents.push(i)}_step(){if(!(this.solved||this.failed)){if(this.packedComponents.length===0){if(this.unpackedComponentQueue.length===0){this.solved=!0;return}this.packFirstComponent();return}if(!this.activeSubSolver){if(this.unpackedComponentQueue.length===0){this.solved=!0;return}if(this.componentToPack=this.unpackedComponentQueue.shift(),!this.componentToPack){this.solved=!0;return}this.activeSubSolver=new ZJ({packedComponents:this.packedComponents,componentToPack:this.componentToPack,packPlacementStrategy:this.packInput.packPlacementStrategy,minGap:this.packInput.minGap,obstacles:this.packInput.obstacles??[],bounds:this.packInput.bounds,boundaryOutline:this.packInput.boundaryOutline}),this.activeSubSolver.setup()}if(this.activeSubSolver.step(),this.activeSubSolver.failed){this.failed=!0;return}if(this.activeSubSolver.solved){let e=this.activeSubSolver.getResult();if(e)this.packedComponents.push(e);else{let t={...this.componentToPack,center:{x:0,y:0},ccwRotationOffset:0,pads:this.componentToPack.pads.map(i=>({...i,absoluteCenter:{x:0,y:0}}))};eA(t),this.packedComponents.push(t)}this.componentToPack=void 0,this.activeSubSolver=void 0}}}visualize(){if(this.activeSubSolver)return this.activeSubSolver.visualize();let e={coordinateSystem:"cartesian",title:"Pack Solver 2",points:[],lines:[],rects:[],circles:[],texts:[]};if(this.packInput.obstacles&&this.packInput.obstacles.length>0)for(let r of this.packInput.obstacles)e.rects.push({center:r.absoluteCenter,width:r.width,height:r.height,fill:"rgba(0,0,0,0.1)",stroke:"#555",label:r.obstacleId});if(this.packInput.bounds&&e.lines.push({points:[{x:this.packInput.bounds.minX,y:this.packInput.bounds.minY},{x:this.packInput.bounds.minX,y:this.packInput.bounds.maxY},{x:this.packInput.bounds.maxX,y:this.packInput.bounds.maxY},{x:this.packInput.bounds.maxX,y:this.packInput.bounds.minY},{x:this.packInput.bounds.minX,y:this.packInput.bounds.minY}],strokeColor:"rgba(0,0,0,0.5)",strokeDash:"2 2"}),this.packInput.boundaryOutline&&this.packInput.boundaryOutline.length){let r=[...this.packInput.boundaryOutline];r.length>0&&(r[0].x!==r[r.length-1].x||r[0].y!==r[r.length-1].y)&&r.push({...r[0]}),e.lines.push({points:r,strokeColor:"rgba(0, 0, 255, 0.5)",strokeDash:"4 2"})}if(this.packedComponents.length===0)for(let r of this.unpackedComponentQueue)for(let s of r.pads)e.rects.push({center:{x:0,y:0},width:s.size.x,height:s.size.y,fill:"rgba(0,0,0,0.1)"});let t=this.packedComponents.flatMap(r=>r.pads),i=new Map;for(let r of t)r.networkId&&i.set(r.networkId,[...i.get(r.networkId)||[],r]);for(let r of t)e.rects.push({center:r.absoluteCenter,width:r.size.x,height:r.size.y,fill:"rgba(255,0,0,0.5)"});for(let[r,s]of i.entries())for(let o=0;o<s.length;o++)for(let a=o+1;a<s.length;a++){let c=s[o],l=s[a];e.lines.push({points:[c.absoluteCenter,l.absoluteCenter],strokeColor:iA(r,.5)})}return e}},Ew=n=>{let e=new g1(n);return e.solve(),{...n,components:e.packedComponents}},ANt=(n,e,t)=>{let i=[],r=({padId:s,pcbPortId:o,sx:a,sy:c,x:l,y:u})=>i.push({padId:s,networkId:t(o),size:{x:a,y:c},absoluteCenter:{x:l,y:u}});for(let s of e.pcb_plated_hole.list({pcb_component_id:n.pcb_component_id}))switch(s.shape){case"circle":{r({padId:s.pcb_plated_hole_id,pcbPortId:s.pcb_port_id,sx:s.outer_diameter??s.hole_diameter??0,sy:s.outer_diameter??s.hole_diameter??0,x:s.x,y:s.y});break}case"oval":{r({padId:s.pcb_plated_hole_id,pcbPortId:s.pcb_port_id,sx:s.outer_width,sy:s.outer_height,x:s.x,y:s.y});break}case"circular_hole_with_rect_pad":{r({padId:s.pcb_plated_hole_id,pcbPortId:s.pcb_port_id,sx:s.rect_pad_width,sy:s.rect_pad_height,x:s.x,y:s.y});break}case"pill":{r({padId:s.pcb_plated_hole_id,pcbPortId:s.pcb_port_id,sx:s.outer_width,sy:s.outer_height,x:s.x,y:s.y});break}case"pill_hole_with_rect_pad":{r({padId:s.pcb_plated_hole_id,pcbPortId:s.pcb_port_id,sx:s.rect_pad_width,sy:s.rect_pad_height,x:s.x,y:s.y});break}default:{console.warn(`Unsupported plated hole shape ${s.shape}`);break}}for(let s of e.pcb_smtpad.list({pcb_component_id:n.pcb_component_id}))switch(s.shape){case"rect":{r({padId:s.pcb_smtpad_id,pcbPortId:s.pcb_port_id,sx:s.width??0,sy:s.height??0,x:s.x,y:s.y});break}case"circle":{r({padId:s.pcb_smtpad_id,pcbPortId:s.pcb_port_id,sx:s.radius??0,sy:s.radius??0,x:s.x,y:s.y});break}case"pill":{r({padId:s.pcb_smtpad_id,pcbPortId:s.pcb_port_id,sx:s.width??0,sy:s.height??0,x:s.x,y:s.y});break}default:{console.warn(`smtpad shape ${s.shape} pads are not supported in pack layout yet`);break}}return i},KJ=(n,e,t,i,r,s={})=>{let o=n.flatMap(y=>{let g=ANt(y,t,i),x=s[y.pcb_component_id];return x?g.map(v=>({...v,size:{x:v.size.x+x.left+x.right,y:v.size.y+x.top+x.bottom},absoluteCenter:{x:v.absoluteCenter.x+(x.right-x.left)/2,y:v.absoluteCenter.y+(x.top-x.bottom)/2}})):g}),a=1/0,c=1/0,l=-1/0,u=-1/0;for(let y of o)a=Math.min(a,y.absoluteCenter.x-y.size.x/2),l=Math.max(l,y.absoluteCenter.x+y.size.x/2),c=Math.min(c,y.absoluteCenter.y-y.size.y/2),u=Math.max(u,y.absoluteCenter.y+y.size.y/2);let p={x:(a+l)/2,y:(c+u)/2},f=o.map(y=>({padId:y.padId,networkId:y.networkId,type:"rect",size:y.size,absoluteCenter:y.absoluteCenter,offset:{x:y.absoluteCenter.x-p.x,y:y.absoluteCenter.y-p.y}}));if(r){let y={padId:`${e}-inner`,networkId:`${e}-inner`,type:"rect",size:{x:l-a,y:u-c},absoluteCenter:p,offset:{x:0,y:0}};f.push(y)}return{componentId:e,center:p,ccwRotationOffset:0,pads:f}},QJ=(n,e)=>{if(n.nodeType==="component"){let t=n.otherChildElements[0]?.pcb_component_id;return t?[e.pcb_component.get(t)]:[]}return n.childNodes.flatMap(t=>QJ(t,e))},tQ=(n,e={})=>{let t={components:[],minGap:0,packOrderStrategy:"largest_to_smallest",packPlacementStrategy:"shortest_connection_along_outline",obstacles:e.obstacles},i=a_(n,{source_group_id:e.source_group_id}),r=Ke(n),s=0,o=n.find(l=>l.type==="pcb_board");o&&o.outline&&(t.boundaryOutline=o.outline);let a=l=>{if(l){let u=r.pcb_port.get(l);if(u){let p=r.source_port.get(u.source_port_id);if(p?.subcircuit_connectivity_map_key)return p.subcircuit_connectivity_map_key}}return`unnamed${s++}`},c=i.childNodes??[];for(let l of c)if(l.nodeType==="component"){let u=l.otherChildElements.find(f=>f.type==="pcb_component");if(!u)continue;let p=e.shouldAddInnerObstacles;u.obstructs_within_bounds===!1&&(p=!1),t.components.push(KJ([u],u.pcb_component_id,r,a,p,e.chipMarginsMap))}else if(l.nodeType==="group"){let u=QJ(l,r);if(!u.length)continue;let p=l.sourceGroup?.source_group_id??l.sourceGroup?.name??`group_${t.components.length}`;t.components.push(KJ(u,p,r,a,void 0,e.chipMarginsMap))}return t},eQ=n=>{let e=n.components.map(t=>({componentId:t.componentId,availableRotationDegrees:t.availableRotationDegrees,pads:t.pads.map(({absoluteCenter:i,...r})=>r)}));return{...n,components:e}};var A_=class{constructor(){d(this,"MAX_ITERATIONS",1e5);d(this,"solved",!1);d(this,"failed",!1);d(this,"iterations",0);d(this,"progress",0);d(this,"error",null);d(this,"activeSubSolver");d(this,"failedSubSolvers");d(this,"timeToSolve");d(this,"stats",{})}step(){if(!this.solved&&!this.failed){this.iterations++;try{this._step()}catch(n){throw this.error=`${this.constructor.name} error: ${n}`,this.failed=!0,n}!this.solved&&this.iterations>this.MAX_ITERATIONS&&this.tryFinalAcceptance(),!this.solved&&this.iterations>this.MAX_ITERATIONS&&(this.error=`${this.constructor.name} ran out of iterations`,this.failed=!0),"computeProgress"in this&&(this.progress=this.computeProgress())}}_step(){}getConstructorParams(){throw new Error("getConstructorParams not implemented")}solve(){let n=Date.now();for(;!this.solved&&!this.failed;)this.step();let e=Date.now();this.timeToSolve=e-n}visualize(){return{lines:[],points:[],rects:[],circles:[]}}tryFinalAcceptance(){}preview(){return{lines:[],points:[],rects:[],circles:[]}}};function oA(n,e){let t=e*Math.PI/180,i=Math.cos(t),r=Math.sin(t);return{x:n.x*i-n.y*r,y:n.x*r+n.y*i}}function RNt(n,e,t){let i=(t%360+360)%360;return Math.round((i+90)%180)===0?{width:e,height:n}:{width:n,height:e}}function N_(n,e){let t={points:[],rects:[],lines:[],circles:[],texts:[]},i={};for(let a of Object.keys(n.netConnMap)){let[c,l]=a.split("-");i[c]=l}for(let[a,c]of Object.entries(n.chipMap)){let l=c.pins.map(v=>n.chipPinMap[v]),u=e.chipPlacements[a];if(!u)continue;let p,f;if(c.size&&Number.isFinite(c.size.x)&&Number.isFinite(c.size.y))p=c.size.x,f=c.size.y;else{let v=l.map(E=>E.offset.x),P=l.map(E=>E.offset.y),w=v.length?Math.min(...v):-5,k=v.length?Math.max(...v):5,T=P.length?Math.min(...P):-5,I=P.length?Math.max(...P):5;p=Math.max(10,k-w+6),f=Math.max(10,I-T+6)}let y=u.x,g=u.y,x=RNt(p,f,u.ccwRotationDegrees);t.rects.push({center:{x:y,y:g},width:x.width,height:x.height,label:a}),t.texts.push({x:y,y:g,text:a});for(let v of l){let P=oA(v.offset,u.ccwRotationDegrees),w=u.x+P.x,k=u.y+P.y,T=i[v.pinId],I=T?`${v.pinId} (${T})`:v.pinId;t.points.push({x:w,y:k,label:I})}}let r={};for(let[a,c]of Object.entries(i))r[c]||(r[c]=[]),r[c].push(a);for(let[,a]of Object.entries(r)){let c=a.map(l=>{let u=n.chipPinMap[l];if(u){for(let[p,f]of Object.entries(n.chipMap))if(f.pins.includes(l)){let y=e.chipPlacements[p];if(y){let g=oA(u.offset,y.ccwRotationDegrees);return{x:y.x+g.x,y:y.y+g.y}}}return u.offset}return null}).filter(Boolean);for(let l=0;l<c.length;l++)for(let u=l+1;u<c.length;u++)t.lines.push({points:[c[l],c[u]],strokeColor:"rgba(0,0,0,0.1)"})}let s=a=>{let c=n.chipPinMap[a];if(c){for(let[l,u]of Object.entries(n.chipMap))if(u.pins.includes(a)){let p=e.chipPlacements[l];if(p){let f=oA(c.offset,p.ccwRotationDegrees);return{x:p.x+f.x,y:p.y+f.y}}}return c.offset}return null},o=new Set;for(let[a,c]of Object.entries(n.pinStrongConnMap)){if(!c)continue;let[l,u]=a.split("-"),p=l<u?`${l}-${u}`:`${u}-${l}`;if(o.has(p))continue;o.add(p);let f=s(l),y=s(u);!f||!y||t.lines.push({points:[f,y]})}return t}var ONt=n=>JSON.stringify(n),aA=new Map;function Cw(n){let e=ONt(n);if(aA.has(e))return structuredClone(aA.get(e));let t=Object.entries(n.chipMap).map(([o,a])=>{let l=a.pins.map(u=>n.chipPinMap[u]).map(u=>{let p=u.pinId;for(let[f,y]of Object.entries(n.pinStrongConnMap))if(y&&f.includes(u.pinId)){let[g,x]=f.split("-");if(g===u.pinId||x===u.pinId){p=[g,x].sort().join("_");break}}return{padId:u.pinId,networkId:p,type:"rect",offset:u.offset,size:{x:.001,y:.001}}});return l.push({padId:`${o}-body`,networkId:o,type:"rect",offset:{x:0,y:0},size:{x:a.size.x,y:a.size.y}}),{componentId:o,pads:l}}),i=Ew({components:t,minGap:.4,packOrderStrategy:"largest_to_smallest",packPlacementStrategy:"shortest_connection_along_outline"}),r={};for(let o of i.components)r[o.componentId]={x:o.center.x,y:o.center.y,ccwRotationDegrees:o.ccwRotationOffset};let s={chipPlacements:r,groupPlacements:{}};return aA.set(e,s),structuredClone(s)}var LNt=class extends A_{constructor({inputProblem:e,decouplingCapGroups:t}){super();d(this,"inputProblem");d(this,"partitions",[]);d(this,"decouplingCapGroups");this.inputProblem=e,this.decouplingCapGroups=t}_step(){this.partitions=this.createPartitions(this.inputProblem),this.solved=!0}createPartitions(e){let t=Object.keys(e.chipMap),i=new Set,r=[];if(this.decouplingCapGroups&&this.decouplingCapGroups.length>0)for(let l of this.decouplingCapGroups){let u=[];for(let p of l.decouplingCapChipIds)e.chipMap[p]&&u.push(p);if(u.length>=2){r.push(u);for(let p of u)i.add(p)}}let s=t.filter(l=>!i.has(l)),o=new Map;for(let l of s)o.set(l,new Set);for(let[l,u]of Object.entries(e.pinStrongConnMap)){if(!u)continue;let[p,f]=l.split("-"),y=this.findPinOwner(p,e),g=this.findPinOwner(f,e);y&&g&&y!==g&&!i.has(y)&&!i.has(g)&&(o.get(y).add(g),o.get(g).add(y))}let a=new Set,c=[];for(let l of s)if(!a.has(l)){let u=this.dfs(l,o,a);u.length>0&&c.push(u)}return[...r.map(l=>this.createInputProblemFromPartition(l,e,{partitionType:"decoupling_caps"})),...c.map(l=>this.createInputProblemFromPartition(l,e))]}findPinOwner(e,t){if(t.chipPinMap[e]){for(let[r,s]of Object.entries(t.chipMap))if(s.pins.includes(e))return r}return null}dfs(e,t,i){let r=[],s=[e];for(;s.length>0;){let o=s.pop();if(i.has(o))continue;i.add(o),r.push(o);let a=t.get(o)||new Set;for(let c of a)i.has(c)||s.push(c)}return r}createInputProblemFromPartition(e,t,i){let r=e,s=new Set;for(let f of r){let y=t.chipMap[f];for(let g of y.pins)s.add(g)}let o={},a={},c={},l={},u={};for(let f of r)o[f]=t.chipMap[f];for(let f of s)t.chipPinMap[f]&&(a[f]=t.chipPinMap[f]);for(let[f,y]of Object.entries(t.pinStrongConnMap)){let[g,x]=f.split("-");s.has(g)&&s.has(x)&&(l[f]=y)}let p=new Set;for(let[f,y]of Object.entries(t.netConnMap)){if(!y)continue;let[g,x]=f.split("-");s.has(g)&&(p.add(x),u[f]=y)}for(let f of p)t.netMap[f]&&(c[f]=t.netMap[f]);return{...t,chipMap:o,chipPinMap:a,netMap:c,pinStrongConnMap:l,netConnMap:u,isPartition:!0,partitionType:i?.partitionType}}visualize(){if(this.partitions.length===0)return super.visualize();let e=this.partitions.map(i=>{let r=Cw(i);return N_(i,r)}),t=this.partitions.map((i,r)=>`partition${r}`);return md(e,{titles:t})}},FNt=(n,e=1)=>{let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);t=(t<<5)-t+r,t=t&t}return`hsl(${Math.abs(t)%360}, 70%, 50%, ${e})`},zNt=class extends A_{constructor(e){super();d(this,"inputProblem");d(this,"queuedChips");d(this,"outputDecouplingCapGroups",[]);d(this,"groupsByMainChipId",new Map);d(this,"lastChip",null);this.inputProblem=e,this.queuedChips=Object.values(e.chipMap)}isTwoPinRestrictedRotation(e){if(e.pins.length!==2||!e.availableRotations)return!1;let t=new Set([0,180]);return e.availableRotations.length>0&&e.availableRotations.every(i=>t.has(i))}pinsOnOppositeYSides(e){if(e.pins.length!==2)return!1;let[t,i]=e.pins,r=this.inputProblem.chipPinMap[t],s=this.inputProblem.chipPinMap[i];if(!r||!s)return!1;let o=new Set([r.side,s.side]);return o.has("y+")&&o.has("y-")}getStronglyConnectedNeighborChips(e){let t=new Set;for(let[i,r]of Object.entries(this.inputProblem.pinStrongConnMap)){if(!r)continue;let[s,o]=i.split("-");if(s===e){let a=o.split(".")[0];t.add(a)}else if(o===e){let a=s.split(".")[0];t.add(a)}}return t}findMainChipIdForCap(e){let t=new Map;for(let r of e.pins){let s=this.getStronglyConnectedNeighborChips(r);for(let o of s)o!==e.chipId&&t.set(o,(t.get(o)||0)+1)}if(t.size===0)return null;let i=null;for(let[r,s]of t.entries())(!i||s>i.score||s===i.score&&r<i.id)&&(i={id:r,score:s});return i?i.id:null}getNetIdsForPin(e){let t=new Set;for(let[i,r]of Object.entries(this.inputProblem.netConnMap)){if(!r)continue;let[s,o]=i.split("-");s===e&&t.add(o)}return t}getNormalizedNetPair(e){if(e.pins.length!==2)return null;let t=new Set;for(let s of e.pins){let o=this.getNetIdsForPin(s);for(let a of o)t.add(a)}if(t.size!==2)return null;let[i,r]=Array.from(t).sort();return[i,r]}addToGroup(e,t,i){let[r,s]=t,o=`${e}__${r}__${s}`,a=this.groupsByMainChipId.get(o);a||(a={decouplingCapGroupId:`decap_group_${e}__${r}__${s}`,mainChipId:e,netPair:[r,s],decouplingCapChipIds:[]},this.groupsByMainChipId.set(o,a),this.outputDecouplingCapGroups.push(a)),a.decouplingCapChipIds.includes(i)||a.decouplingCapChipIds.push(i)}_step(){let e=this.queuedChips.shift();if(this.lastChip=e??null,!e){this.solved=!0;return}if(!(this.isTwoPinRestrictedRotation(e)&&this.pinsOnOppositeYSides(e)))return;let i=this.findMainChipIdForCap(e);if(!i)return;let r=this.getNormalizedNetPair(e);if(!r)return;let[s,o]=r,a=this.inputProblem.netMap[s],c=this.inputProblem.netMap[o];(a?.isGround&&c?.isPositiveVoltageSource||c?.isGround&&a?.isPositiveVoltageSource)&&this.addToGroup(i,r,e.chipId)}visualize(){let e=Cw(this.inputProblem),t=N_(this.inputProblem,e),i=new Map;for(let r of this.outputDecouplingCapGroups){i.set(r.mainChipId,r);for(let s of r.decouplingCapChipIds)i.set(s,r)}for(let r of t.rects||[])r.label!==this.lastChip?.chipId&&(r.fill="rgba(0,0,0,0.5)");for(let r of t.rects||[]){let s=r.label,o=i.get(s);o&&(r.label=`${r.label}
${o.decouplingCapGroupId}`,r.fill=FNt(o.decouplingCapGroupId,.8))}return t}getConstructorParams(){return[this.inputProblem]}computeProgress(){let e=Object.keys(this.inputProblem.chipMap).length||1,t=e-this.queuedChips.length;return Math.min(1,Math.max(0,t/e))}};function $Nt(n){let{inputProblem:e,pinIdToStronglyConnectedPins:t}=n,i=new Map,r=new Set,s=!1,o=new Map;for(let[a,c]of Object.entries(e.pinStrongConnMap)){if(!c)continue;s=!0;let l=a.split("-");if(l.length===2&&l[0]&&l[1]){let u=e.chipPinMap[l[0]],p=e.chipPinMap[l[1]];if(u&&p){let f=l[0].split(".")[0],y=l[1].split(".")[0];if(f&&y&&f!==y){let g=`${f}-${y}`,x=`${y}-${f}`;o.has(g)||o.set(g,new Set),o.has(x)||o.set(x,new Set),o.get(g).add(u.side),o.get(x).add(p.side)}}}}if(s)for(let[a,c]of Object.entries(e.netConnMap)){if(!c)continue;let[l,u]=a.split("-");l&&u&&r.add(l)}else for(let[a,c]of Object.entries(e.netConnMap)){if(!c)continue;let[l,u]=a.split("-");if(l&&u){if(!e.chipPinMap[l])continue;let f=l.split(".")[0],y=!0;for(let[g,x]of o.entries()){let[v,P]=g.split("-");if(v===f)for(let[w,k]of Object.entries(e.netConnMap)){if(!k)continue;let[T,I]=w.split("-");if(I===u&&T&&T!==l){let E=e.chipPinMap[T];if(!E)continue;if(T.split(".")[0]===P&&!x.has(E.side)){y=!1;break}}}}if(y)i.set(l,u);else{let g=`${l}_opposite-strong-side-disconnected`;i.set(l,g),r.add(l)}}}for(let[a,c]of Object.entries(e.pinStrongConnMap)){if(!c)continue;let l=a.split("-");if(l.length===2&&l[0]&&l[1]){let u=i.get(l[0])||i.get(l[1]);u?(i.set(l[0],u),i.set(l[1],u)):(i.set(l[0],a),i.set(l[1],a))}}return{pinToNetworkMap:i,filteredPins:r}}var DNt=n=>{let e=n.flatMap(a=>[a.offset.x-a.size.x/2,a.offset.x+a.size.x/2]),t=n.flatMap(a=>[a.offset.y-a.size.y/2,a.offset.y+a.size.y/2]),i=e.length?Math.min(...e):0,r=e.length?Math.max(...e):0,s=t.length?Math.min(...t):0,o=t.length?Math.max(...t):0;return{minX:i,maxX:r,minY:s,maxY:o}},nQ=.1,jNt=class extends A_{constructor(e){super();d(this,"partitionInputProblem");d(this,"layout",null);d(this,"pinIdToStronglyConnectedPins");this.partitionInputProblem=e.partitionInputProblem,this.pinIdToStronglyConnectedPins=e.pinIdToStronglyConnectedPins}_step(){if(!this.activeSubSolver){let e=this.createPackInput();this.activeSubSolver=new g1(e),this.activeSubSolver=this.activeSubSolver}if(this.activeSubSolver.step(),this.activeSubSolver.failed){this.failed=!0,this.error=`PackSolver2 failed: ${this.activeSubSolver.error}`;return}this.activeSubSolver.solved&&(this.layout=this.createLayoutFromPackingResult(this.activeSubSolver.packedComponents),this.solved=!0,this.activeSubSolver=null)}createPackInput(){let e=$Nt({inputProblem:this.partitionInputProblem,pinIdToStronglyConnectedPins:this.pinIdToStronglyConnectedPins}).pinToNetworkMap,t=Object.entries(this.partitionInputProblem.chipMap).map(([r,s])=>{let o=[];for(let l of s.pins){let u=this.partitionInputProblem.chipPinMap[l];if(!u)continue;let p=e.get(l)||`${l}_isolated`;o.push({padId:l,networkId:p,type:"rect",offset:{x:u.offset.x,y:u.offset.y},size:{x:nQ,y:nQ}})}let a=DNt(o),c={x:a.maxX-a.minX,y:a.maxY-a.minY};return o.push({padId:`${r}_body`,networkId:`${r}_body_disconnected`,type:"rect",offset:{x:0,y:0},size:{x:Math.max(c.x,s.size.x),y:Math.max(c.y,s.size.y)}}),{componentId:r,pads:o,availableRotationDegrees:s.availableRotations||[0,90,180,270]}}),i=this.partitionInputProblem.chipGap;return this.partitionInputProblem.partitionType==="decoupling_caps"&&(i=this.partitionInputProblem.decouplingCapsGap??i),{components:t,minGap:i,packOrderStrategy:"largest_to_smallest",packPlacementStrategy:"minimum_closest_sum_squared_distance"}}createLayoutFromPackingResult(e){let t={};for(let i of e){let r=i.componentId;t[r]={x:i.center.x,y:i.center.y,ccwRotationDegrees:i.ccwRotationOffset||i.ccwRotationDegrees||0}}return{chipPlacements:t,groupPlacements:{}}}visualize(){if(this.activeSubSolver&&!this.solved)return this.activeSubSolver.visualize();if(!this.layout){let e=Cw(this.partitionInputProblem);return N_(this.partitionInputProblem,e)}return N_(this.partitionInputProblem,this.layout)}getConstructorParams(){return[this.partitionInputProblem]}},BNt=class extends A_{constructor(e){super();d(this,"partitions");d(this,"packedPartitions",[]);d(this,"completedSolvers",[]);d(this,"activeSolver",null);d(this,"currentPartitionIndex",0);d(this,"pinIdToStronglyConnectedPins");this.partitions=e.partitions,this.pinIdToStronglyConnectedPins=e.pinIdToStronglyConnectedPins}_step(){if(this.currentPartitionIndex>=this.partitions.length){this.solved=!0;return}if(!this.activeSolver){let e=this.partitions[this.currentPartitionIndex];this.activeSolver=new jNt({partitionInputProblem:e,pinIdToStronglyConnectedPins:this.pinIdToStronglyConnectedPins}),this.activeSubSolver=this.activeSolver}if(this.activeSolver.step(),this.activeSolver.failed){this.failed=!0,this.error=`Partition ${this.currentPartitionIndex} failed: ${this.activeSolver.error}`;return}if(this.activeSolver.solved){if(this.completedSolvers.push(this.activeSolver),this.activeSolver.layout)this.packedPartitions.push({inputProblem:this.partitions[this.currentPartitionIndex],layout:this.activeSolver.layout});else{this.failed=!0,this.error=`Partition ${this.currentPartitionIndex} completed but has no layout`;return}this.activeSolver=null,this.activeSubSolver=null,this.currentPartitionIndex++}}visualize(){if(this.activeSolver)return this.activeSolver.visualize();if(this.completedSolvers.length===0)return super.visualize();let e=this.completedSolvers.map(i=>i.visualize()),t=this.completedSolvers.map((i,r)=>`packed_partition_${r}`);return md(e,{titles:t})}getConstructorParams(){return[this.partitions]}},YNt=class extends A_{constructor(e){super();d(this,"packedPartitions");d(this,"inputProblem");d(this,"finalLayout",null);d(this,"packSolver2",null);this.packedPartitions=e.packedPartitions,this.inputProblem=e.inputProblem}_step(){try{if(this.packedPartitions.length===0){this.finalLayout={chipPlacements:{},groupPlacements:{}},this.solved=!0;return}if(this.packedPartitions.length===1){this.finalLayout=this.packedPartitions[0].layout,this.solved=!0;return}let e=this.organizePackedPartitions();if(!this.packSolver2){let t=this.createPackInput(e);this.packSolver2=new g1(t),this.activeSubSolver=this.packSolver2}if(this.packSolver2.step(),this.packSolver2.failed){this.failed=!0,this.error=`PackSolver2 failed: ${this.packSolver2.error}`;return}if(this.packSolver2.solved){let t=this.applyPackingResult(this.packSolver2.packedComponents,e);this.finalLayout=t,this.solved=!0,this.activeSubSolver=null}}catch(e){this.failed=!0,this.error=`Failed to pack partitions: ${e}`}}organizePackedPartitions(){let e=[];for(let t=0;t<this.packedPartitions.length;t++){let i=this.packedPartitions[t],r=Object.keys(i.layout.chipPlacements);if(r.length>0){let s=1/0,o=-1/0,a=1/0,c=-1/0;for(let u of r){let p=i.layout.chipPlacements[u],f=i.inputProblem.chipMap[u],y=f.size.x,g=f.size.y;(p.ccwRotationDegrees===90||p.ccwRotationDegrees===270)&&([y,g]=[g,y]);let x=p.x-y/2,v=p.x+y/2,P=p.y-g/2,w=p.y+g/2;s=Math.min(s,x),o=Math.max(o,v),a=Math.min(a,P),c=Math.max(c,w)}let l={minX:s,maxX:o,minY:a,maxY:c};e.push({partitionIndex:t,chipIds:r,bounds:l})}}return e}createPackInput(e){let t=new Map;for(let r of this.packedPartitions){for(let[s,o]of Object.entries(r.inputProblem.netConnMap)){if(!o)continue;let[a,c]=s.split("-");a&&c&&t.set(a,c)}for(let[s,o]of Object.entries(r.inputProblem.pinStrongConnMap)){if(!o)continue;let a=s.split("-");if(a.length===2&&a[0]&&a[1]){let c=t.get(a[0])||t.get(a[1]);c?(t.set(a[0],c),t.set(a[1],c)):(t.set(a[0],s),t.set(a[1],s))}}}return{components:e.map(r=>{let s=this.packedPartitions[r.partitionIndex],o=r.bounds.maxX-r.bounds.minX,a=r.bounds.maxY-r.bounds.minY,c=(r.bounds.minX+r.bounds.maxX)/2,l=(r.bounds.minY+r.bounds.maxY)/2,u=[{padId:`partition_${r.partitionIndex}_body`,networkId:`partition_${r.partitionIndex}_disconnected`,type:"rect",offset:{x:0,y:0},size:{x:Math.max(o,.1),y:Math.max(a,.1)}}],p=new Set,f=new Map;for(let y of r.chipIds){let g=s.layout.chipPlacements[y],x=s.inputProblem.chipMap[y];for(let v of x.pins){let P=s.inputProblem.chipPinMap[v];if(!P)continue;let w={x:P.offset.x,y:P.offset.y},k=g.ccwRotationDegrees||0;k===90?w={x:-P.offset.y,y:P.offset.x}:k===180?w={x:-P.offset.x,y:-P.offset.y}:k===270&&(w={x:P.offset.y,y:-P.offset.x});let T=g.x+w.x,I=g.y+w.y;f.set(v,{x:T,y:I});let E=t.get(v)||`${v}_disconnected`;if(!p.has(E)){p.add(E);let N=T-c,M=I-l;u.push({padId:`${r.partitionIndex}_pin_${v}`,networkId:E,type:"rect",offset:{x:N,y:M},size:{x:.01,y:.01}})}}}return{componentId:`partition_${r.partitionIndex}`,pads:u,availableRotationDegrees:[0]}}),minGap:this.inputProblem.partitionGap,packOrderStrategy:"largest_to_smallest",packPlacementStrategy:"minimum_sum_squared_distance_to_network"}}applyPackingResult(e,t){let i={};for(let r of e){let s=parseInt(r.componentId.replace("partition_","")),o=t.find(c=>c.partitionIndex===s),a=this.packedPartitions[s];if(o&&a){let c=(o.bounds.minX+o.bounds.maxX)/2,l=(o.bounds.minY+o.bounds.maxY)/2,u=r.center.x,p=r.center.y,f=u-c,y=p-l;for(let g of o.chipIds){let x=a.layout.chipPlacements[g];i[g]={x:x.x+f,y:x.y+y,ccwRotationDegrees:x.ccwRotationDegrees}}}}return{chipPlacements:i,groupPlacements:{}}}visualize(){if(this.packSolver2&&!this.solved)return this.packSolver2.visualize();if(!this.finalLayout)return super.visualize();let e={chipMap:{},chipPinMap:{},pinStrongConnMap:{},netMap:{},netConnMap:{},chipGap:this.inputProblem.chipGap,partitionGap:this.inputProblem.partitionGap};for(let t of this.packedPartitions)Object.assign(e.chipMap,t.inputProblem.chipMap),Object.assign(e.chipPinMap,t.inputProblem.chipPinMap),Object.assign(e.pinStrongConnMap,t.inputProblem.pinStrongConnMap),Object.assign(e.netMap,t.inputProblem.netMap),Object.assign(e.netConnMap,t.inputProblem.netConnMap);return N_(e,this.finalLayout)}getConstructorParams(){return{packedPartitions:this.packedPartitions,inputProblem:this.inputProblem}}},XNt=n=>{let e={},t=Object.keys(n.chipPinMap);for(let i=0;i<t.length;i++)for(let r=i+1;r<t.length;r++){let s=t[i],o=t[r];(n.pinStrongConnMap[`${s}-${o}`]||n.pinStrongConnMap[`${o}-${s}`])&&(e[s]??(e[s]=[]),e[o]??(e[o]=[]),e[s].push(n.chipPinMap[o]),e[o].push(n.chipPinMap[s]))}return e};function Mw(n,e,t,i={}){return{solverName:n,solverClass:e,getConstructorParams:t,onSolved:i.onSolved}}var iQ=class extends A_{constructor(e){super();d(this,"identifyDecouplingCapsSolver");d(this,"chipPartitionsSolver");d(this,"packInnerPartitionsSolver");d(this,"partitionPackingSolver");d(this,"startTimeOfPhase");d(this,"endTimeOfPhase");d(this,"timeSpentOnPhase");d(this,"firstIterationOfPhase");d(this,"pinIdToStronglyConnectedPins");d(this,"inputProblem");d(this,"chipPartitions");d(this,"packedPartitions");d(this,"pipelineDef",[Mw("identifyDecouplingCapsSolver",zNt,()=>[this.inputProblem],{onSolved:e=>{}}),Mw("chipPartitionsSolver",LNt,()=>[{inputProblem:this.inputProblem,decouplingCapGroups:this.identifyDecouplingCapsSolver?.outputDecouplingCapGroups}],{onSolved:e=>{this.chipPartitions=this.chipPartitionsSolver.partitions}}),Mw("packInnerPartitionsSolver",BNt,()=>[{partitions:this.chipPartitions,pinIdToStronglyConnectedPins:this.pinIdToStronglyConnectedPins}],{onSolved:e=>{this.packedPartitions=this.packInnerPartitionsSolver.packedPartitions}}),Mw("partitionPackingSolver",YNt,()=>[{packedPartitions:this.packedPartitions||[],inputProblem:this.inputProblem}],{onSolved:e=>{}})]);d(this,"currentPipelineStepIndex",0);this.inputProblem=e,this.MAX_ITERATIONS=1e6,this.startTimeOfPhase={},this.endTimeOfPhase={},this.timeSpentOnPhase={},this.firstIterationOfPhase={},this.pinIdToStronglyConnectedPins=XNt(e)}_step(){let e=this.pipelineDef[this.currentPipelineStepIndex];if(!e){this.solved=!0;return}if(this.activeSubSolver){this.activeSubSolver.step(),this.activeSubSolver.solved?(this.endTimeOfPhase[e.solverName]=performance.now(),this.timeSpentOnPhase[e.solverName]=this.endTimeOfPhase[e.solverName]-this.startTimeOfPhase[e.solverName],e.onSolved?.(this),this.activeSubSolver=null,this.currentPipelineStepIndex++):this.activeSubSolver.failed&&(this.error=this.activeSubSolver?.error,this.failed=!0,this.activeSubSolver=null);return}let t=e.getConstructorParams(this);this.activeSubSolver=new e.solverClass(...t),this[e.solverName]=this.activeSubSolver,this.timeSpentOnPhase[e.solverName]=0,this.startTimeOfPhase[e.solverName]=performance.now(),this.firstIterationOfPhase[e.solverName]=this.iterations}solveUntilPhase(e){for(;this.getCurrentPhase()!==e;)this.step()}getCurrentPhase(){return this.pipelineDef[this.currentPipelineStepIndex]?.solverName??"none"}visualize(){if(!this.solved&&this.activeSubSolver)return this.activeSubSolver.visualize();if(this.solved&&this.partitionPackingSolver?.solved)return this.partitionPackingSolver.visualize();let e=this.identifyDecouplingCapsSolver?.visualize(),t=this.chipPartitionsSolver?.visualize(),i=this.packInnerPartitionsSolver?.visualize(),r=this.partitionPackingSolver?.visualize(),s=Cw(this.inputProblem),a=[N_(this.inputProblem,s),e,t,i,r].filter(Boolean).map((c,l)=>{for(let u of c.rects??[])u.step=l;for(let u of c.points??[])u.step=l;for(let u of c.circles??[])u.step=l;for(let u of c.texts??[])u.step=l;for(let u of c.lines??[])u.step=l;return c});return a.length===1?a[0]:{points:a.flatMap(c=>c.points||[]),rects:a.flatMap(c=>c.rects||[]),lines:a.flatMap(c=>c.lines||[]),circles:a.flatMap(c=>c.circles||[]),texts:a.flatMap(c=>c.texts||[])}}preview(){return this.activeSubSolver?this.activeSubSolver.preview():this.partitionPackingSolver?.solved?this.partitionPackingSolver.visualize():this.packInnerPartitionsSolver?.solved?this.packInnerPartitionsSolver.visualize():this.chipPartitionsSolver?.solved?this.chipPartitionsSolver.visualize():this.identifyDecouplingCapsSolver?.solved?this.identifyDecouplingCapsSolver.visualize():super.preview()}checkForOverlaps(e){let t=[],i=Object.keys(e.chipPlacements);for(let r=0;r<i.length;r++)for(let s=r+1;s<i.length;s++){let o=i[r],a=i[s],c=e.chipPlacements[o],l=e.chipPlacements[a],u=this.inputProblem.chipMap[o],p=this.inputProblem.chipMap[a];if(!u||!p)continue;let f=this.getRotatedBounds(c,u.size),y=this.getRotatedBounds(l,p.size),g=this.calculateOverlapArea(f,y);g>0&&t.push({chip1:o,chip2:a,overlapArea:g})}return t}getRotatedBounds(e,t){let i=t.x/2,r=t.y/2,s=e.ccwRotationDegrees*Math.PI/180,o=Math.abs(Math.cos(s)),a=Math.abs(Math.sin(s)),c=i*o+r*a,l=i*a+r*o;return{minX:e.x-c,maxX:e.x+c,minY:e.y-l,maxY:e.y+l}}calculateOverlapArea(e,t){if(e.maxX<=t.minX||e.minX>=t.maxX||e.maxY<=t.minY||e.minY>=t.maxY)return 0;let i=Math.min(e.maxX,t.maxX)-Math.max(e.minX,t.minX),r=Math.min(e.maxY,t.maxY)-Math.max(e.minY,t.minY);return i*r}getOutputLayout(){if(!this.solved)throw new Error("Pipeline not solved yet. Call solve() or step() until solved.");let e;if(this.partitionPackingSolver?.solved&&this.partitionPackingSolver.finalLayout)e=this.partitionPackingSolver.finalLayout;else throw new Error("No layout available. Pipeline may have failed or not progressed far enough.");let t=this.checkForOverlaps(e);if(t.length>0){let i=t.map(r=>`${r.chip1} overlaps ${r.chip2} (area: ${r.overlapArea.toFixed(4)})`).join(", ");console.warn(`Warning: ${t.length} chip overlaps detected in final layout: ${i}`)}return e}};var cnt=Gt(Mn(),1);ir();St();Ae();var sQ={flexGrow:0,flexShrink:1,flexBasis:0,alignSelf:"auto",width:void 0,height:void 0},oQ=class{constructor(n={}){d(this,"id");d(this,"metadata");d(this,"size",{width:0,height:0});d(this,"position",{x:0,y:0});d(this,"style");this.style={...sQ,...n},this.id=n.id,this.metadata=n.metadata}},UNt=class extends oQ{build(){}},rQ=class cA extends oQ{constructor(t,i,r={}){super({});d(this,"children",[]);d(this,"direction","row");d(this,"columnGap",0);d(this,"rowGap",0);d(this,"justifyContent","flex-start");d(this,"alignItems","stretch");this.size.width=t,this.size.height=i,this.id=r.id,Object.assign(this,r)}addChild(t,i){if(t instanceof cA){let s=t;return i&&(s.style={...sQ,...i}),this.children.push(s),s}let r=new UNt(t);return this.children.push(r),r}build(){let t=this.direction.startsWith("row"),i=t?"width":"height",r=t?"height":"width",s=t?this.columnGap:this.rowGap,o=t?this.rowGap:this.columnGap,a=s*Math.max(0,this.children.length-1),c=this.size[i],l=this.size[r],u=0,p=0,f=0;for(let E of this.children)u+=E.style.flexBasis,p+=E.style.flexGrow,f+=E.style.flexShrink;let y=c-u-a;for(let E of this.children){let N=E.style.flexBasis;y>0&&p>0?N+=y*E.style.flexGrow/p:y<0&&f>0&&(N+=y*E.style.flexShrink/f,N<0&&(N=0)),E.size[i]=N;let M=E.style.alignSelf!=="auto"?E.style.alignSelf:this.alignItems,A=t?E.style.height:E.style.width;A!==void 0?E.size[r]=A:M==="stretch"&&(E.size[r]=l)}let g=this.children.reduce((E,N)=>E+N.size[i],0)+a,x=c-g,v=0,P=s,w=this.children.length;switch(this.justifyContent){case"flex-start":break;case"flex-end":v=x;break;case"center":v=x/2;break;case"space-between":P=w>1?s+x/(w-1):0;break;case"space-around":P=s+x/w,v=P/2;break;case"space-evenly":P=s+x/(w+1),v=P;break}let k=this.direction.endsWith("reverse")?[...this.children].reverse():this.children,T=v;for(let E of k)t?(E.position.x=this.direction==="row"?T:c-T-E.size.width,E.position.y=I(E,r,l,this.alignItems)):(E.position.y=this.direction==="column"?T:c-T-E.size.height,E.position.x=I(E,r,l,this.alignItems)),T+=E.size[i]+P;for(let E of this.children)E instanceof cA&&E.build();function I(E,N,M,A){switch(E.style.alignSelf!=="auto"?E.style.alignSelf:A){case"flex-start":return 0;case"flex-end":return M-E.size[N];case"center":return(M-E.size[N])/2;case"stretch":default:return 0}}}},Iw=class extends rQ{constructor(n,e,t={}){super(n,e,t)}getLayout(){this.build();let n={};return this._collectLayout(this,n),n}_collectLayout(n,e,t={counter:0}){for(let i of n.children){let r=i.id??`_$$${t.counter++}`;e[r]={position:i.position,size:i.size},i instanceof rQ&&this._collectLayout(i,e,t)}}};St();Ae();St();var aQ=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20].map(n=>`hsl(${n*360/21}deg, 100%, 50%)`),VNt=n=>{let e=0;for(let t=0;t<n.length;t++)e=(e<<5)-e+n.charCodeAt(t);return e},pQ=n=>aQ[Math.abs(VNt(n))%aQ.length],GNt=n=>{let e=g=>g?typeof g=="string"?g:g.join(" "):void 0,t=["display:grid","background-color:gray"],{gridTemplateRows:i,gridTemplateColumns:r,gap:s,justifyItems:o,alignItems:a,containerWidth:c,containerHeight:l}=n.opts,u=e(i);u&&t.push(`grid-template-rows:${u}`);let p=e(r);if(p&&t.push(`grid-template-columns:${p}`),s!==void 0)if(typeof s=="number")t.push(`gap:${s}px`);else{let[g,x]=s;t.push(`row-gap:${g}px`,`column-gap:${x}px`)}o&&t.push(`justify-items:${o}`),a&&t.push(`align-items:${a}`),c!=null&&t.push(`width:${c}px`),l!=null&&t.push(`height:${l}px`);let f=t.join(";"),y=n.opts.children.map(g=>{let x=["display:flex",`background-color:${pQ(g.key)}`];if(g.area)x.push(`grid-area:${g.area}`);else{if(typeof g.row=="string"&&g.row.includes("/"))x.push(`grid-row:${g.row}`);else{let k=g.rowStart??g.row,T=g.rowEnd,I=g.rowSpan;k!==void 0||T!==void 0?k!==void 0&&T!==void 0?x.push(`grid-row:${k} / ${T}`):k!==void 0?I!==void 0?x.push(`grid-row:${k} / span ${I}`):x.push(`grid-row-start:${k}`):x.push(`grid-row-end:${T}`):I!==void 0&&x.push(`grid-row:auto / span ${I}`)}if(typeof g.column=="string"&&g.column.includes("/"))x.push(`grid-column:${g.column}`);else{let k=g.columnStart??g.column,T=g.columnEnd,I=g.columnSpan;k!==void 0||T!==void 0?k!==void 0&&T!==void 0?x.push(`grid-column:${k} / ${T}`):k!==void 0?I!==void 0?x.push(`grid-column:${k} / span ${I}`):x.push(`grid-column-start:${k}`):x.push(`grid-column-end:${T}`):I!==void 0&&x.push(`grid-column:auto / span ${I}`)}}let v=x.join(";"),P=["font-size: 7px"];if(g.contentWidth!==void 0){let k=typeof g.contentWidth=="string"?g.contentWidth:`${g.contentWidth}px`;P.push(`width:${k}`)}else P.push(`width:${g.key.length*5}px`);if(g.contentHeight!==void 0){let k=typeof g.contentHeight=="string"?g.contentHeight:`${g.contentHeight}px`;P.push(`height:${k}`)}let w=P.join(";");return`  <div id="${g.key}" style="${v}"><div style="${w}">${g.key}</div></div>`});return`<div style="${f}">
${y.join(`
`)}
</div>`},HNt=n=>{let e=n.layout(),t={title:"CssGrid",coordinateSystem:"screen",lines:[],circles:[],points:[],rects:[],texts:[]},{cells:i}=e;for(let r of i){let{x:s,y:o,width:a,height:c,key:l}=r;t.rects.push({center:{x:s+a/2,y:o+c/2},width:a,height:c,fill:pQ(l),label:l})}return t};function Nw(n){return n.replace(/repeat\((\d+),\s*([^)]+)\)/g,(e,t,i)=>Array(Number(t)).fill(i.trim()).join(" "))}function Aw(n){return n.trim().split(/\s+/).filter(Boolean)}function cQ(n){return n?Aw(Nw(n)).length:0}function lQ(n,e){if(n==="auto")return{fr:1};if(n.endsWith("%")){let i=parseFloat(n);return e!=null?e*i/100:0}if(n.endsWith("px"))return parseFloat(n);if(n.endsWith("em"))return parseFloat(n)*16;if(n.endsWith("fr"))return{fr:parseFloat(n)};let t=parseFloat(n);return Number.isNaN(t)?0:t}function uQ(n,e){return n>0?n:e+2+n}var WNt=n=>{let e=n.opts,t=e.children,i,r;if("gridTemplate"in e&&typeof e.gridTemplate=="string"){let[E,N]=e.gridTemplate.split("/");i=E?.trim(),r=N?.trim()}else i=typeof e.gridTemplateRows=="string"?e.gridTemplateRows:void 0,r=typeof e.gridTemplateColumns=="string"?e.gridTemplateColumns:void 0;let s=cQ(r),o=cQ(i);function a(E,N,M,A){if(!E)return 0;let R=Nw(E),j=Aw(R),B=j.length,G=0,U=!1;for(let tt=0;tt<j.length;tt++){let et=j[tt];if(et.endsWith("px"))G+=parseFloat(et);else if(et.endsWith("em"))G+=parseFloat(et)*16;else if(et.endsWith("fr")||et==="auto"){U=!0;let mt=0;for(let V of N){let J=M?V.columnStart||V.column:V.rowStart||V.row,nt=M?V.columnSpan||1:V.rowSpan||1,ut=M?V.contentWidth:V.contentHeight,ht=(typeof J=="number"?J:parseInt(J||"1"))-1,kt=typeof nt=="number"?nt:parseInt(nt.toString());if(ht<=tt&&tt<ht+kt&&ut){let Mt=typeof ut=="string"&&ut.endsWith("px")?parseFloat(ut):typeof ut=="number"?ut:0;mt=Math.max(mt,Mt/kt)}}G+=mt}}let H=A*(B-1);return G+H}function c(E,N,M,A=!0,R=1){if(!E)return[];if(N==null){let nt=Nw(E),ut=Aw(nt),ht=ut.length,kt=X=>X===void 0?0:typeof X=="number"?X:(X.endsWith("px"),parseFloat(X)),Mt=new Array(ht).fill(0),ot=0;for(let X of t){let W=A?typeof X.columnSpan=="number"?X.columnSpan:X.columnSpan?parseInt(X.columnSpan.toString()):1:typeof X.rowSpan=="number"?X.rowSpan:X.rowSpan?parseInt(X.rowSpan.toString()):1,rt=A?X.contentWidth:X.contentHeight,pt=kt(rt)/W,yt;A?(X.columnStart!==void 0||X.column!==void 0)&&(yt=parseInt(X.columnStart??X.column)-1):(X.rowStart!==void 0||X.row!==void 0)&&(yt=parseInt(X.rowStart??X.row)-1),(yt===void 0||Number.isNaN(yt))&&(A?yt=ot%ht:yt=Math.floor(ot/R),ot+=W);for(let Z=0;Z<W&&yt+Z<ht;Z++)Mt[yt+Z]=Math.max(Mt[yt+Z],pt)}return ut.forEach((X,W)=>{let rt=lQ(X,void 0);typeof rt=="number"&&(Mt[W]=rt)}),Mt}let j=Nw(E),B=Aw(j),G=B.length,U=N;U==null&&(U=a(E,t,A,M));let H=U-M*(G-1),tt=0,et=0,mt=[],V=[];B.forEach((nt,ut)=>{let ht=lQ(nt,H);typeof ht=="number"?(V.push(ht),tt+=ht):ht&&typeof ht=="object"&&"fr"in ht?(V.push(ht),et+=ht.fr,mt.push({idx:ut,fr:ht.fr})):(V.push(0),tt+=0)});let J=Math.max(H-tt,0);return V.map(nt=>typeof nt=="number"?nt:et>0?J/et*nt.fr:0)}let l=typeof e.gap=="number"?e.gap:Array.isArray(e.gap)?e.gap[0]:0,u=typeof e.gap=="number"?e.gap:Array.isArray(e.gap)?e.gap[1]:0,p=c(i,e.containerHeight,l,!1,s||1),f=c(r,e.containerWidth,u,!0,o||1),y=p.length,g=f.length;g===0&&t.length>0&&(g=1);let x=[],v=0;for(let E of t){let N=E.rowStart!==void 0?E.rowStart:E.row,M=E.columnStart!==void 0?E.columnStart:E.column,A=E.rowSpan!==void 0?typeof E.rowSpan=="string"?parseInt(E.rowSpan):E.rowSpan:1,R=E.columnSpan!==void 0?typeof E.columnSpan=="string"?parseInt(E.columnSpan):E.columnSpan:1;if(E.rowEnd!==void 0){let G=typeof E.rowEnd=="string"?parseInt(E.rowEnd):E.rowEnd;N!==void 0?A=G-(typeof N=="string"?parseInt(N):N):N=G-A}if(E.columnEnd!==void 0){let G=typeof E.columnEnd=="string"?parseInt(E.columnEnd):E.columnEnd;M!==void 0?R=G-(typeof M=="string"?parseInt(M):M):M=G-R}if(typeof N=="string"&&(N=parseInt(N)),typeof M=="string"&&(M=parseInt(M)),typeof N=="number"&&N<0&&(N=uQ(N,y)),typeof M=="number"&&M<0&&(M=uQ(M,g)),N===void 0&&M!==void 0)N=1;else if(M===void 0&&N!==void 0)M=1;else if(N===void 0&&M===void 0){let G=v;N=Math.floor(G/g)+1,M=G%g+1}let j=N-1,B=M-1;A=Math.max(1,A),R=Math.max(1,R),x.push({key:E.key,row:j,column:B,rowSpan:A,columnSpan:R,x:0,y:0,width:0,height:0}),v+=R}let P=p.length,w=f.length;for(let E of x)E.row+E.rowSpan>P&&(P=E.row+E.rowSpan),E.column+E.columnSpan>w&&(w=E.column+E.columnSpan);if(p.length===0&&P>0&&e.containerHeight){let E=P,M=(e.containerHeight-l*(E-1))/E;for(let A=0;A<E;A++)p.push(M)}else for(;p.length<P;)p.push(0);if(f.length===0&&w>0&&e.containerWidth){let E=w,M=(e.containerWidth-u*(E-1))/E;for(let A=0;A<E;A++)f.push(M)}else if(f.length===0&&t.length>0&&e.containerWidth)f.push(e.containerWidth);else for(;f.length<w;)f.push(0);let k=(E,N,M)=>{let A=0;for(let R=0;R<E;R++)A+=N[R]||0,A+=M;return A},T=(E,N,M,A)=>{let R=0;for(let j=E;j<E+N;j++)R+=M[j]||0,j>E&&(R+=A);return R},I={};for(let E of x){let N=t.find(V=>V.key===E.key),M=k(E.column,f,u),A=k(E.row,p,l),R=T(E.column,E.columnSpan,f,u),j=T(E.row,E.rowSpan,p,l),B=V=>V===void 0?0:typeof V=="string"?V.endsWith("px")?parseFloat(V):V.endsWith("%")?0:parseFloat(V):V,G=B(N?.contentWidth),U=B(N?.contentHeight),H=R,tt=j,et=M,mt=A;if(G>0)switch(H=G,e.justifyItems||"stretch"){case"start":et=M;break;case"end":et=M+R-H;break;case"center":et=M+(R-H)/2;break;case"stretch":H=R,et=M;break}if(U>0)switch(tt=U,e.alignItems||"stretch"){case"start":mt=A;break;case"end":mt=A+j-tt;break;case"center":mt=A+(j-tt)/2;break;case"stretch":tt=j,mt=A;break}E.x=et,E.y=mt,E.width=H,E.height=tt,I[E.key]={x:et,y:mt,width:H,height:tt}}return{cells:x,rowSizes:p,columnSizes:f,rowGap:l,columnGap:u,itemCoordinates:I}},hQ=class{constructor(n){d(this,"opts");this.opts=n}layout(){return WNt(this)}convertToHtml(){return GNt(this)}visualize(){return HNt(this)}};St();var lnt=Gt(Mn(),1);Ae();Ae();St();var lA=class{constructor(n){d(this,"netMap");d(this,"idToNetMap");this.netMap=n,this.idToNetMap={};for(let[e,t]of Object.entries(n))for(let i of t)this.idToNetMap[i]=e}addConnections(n){for(let e of n){let t=new Set;for(let r of e){let s=this.idToNetMap[r];s&&t.add(s)}let i;if(t.size===0)i=`connectivity_net${Object.keys(this.netMap).length}`,this.netMap[i]=[];else if(t.size===1)i=t.values().next().value??`connectivity_net${Object.keys(this.netMap).length}`;else{i=t.values().next().value??`connectivity_net${Object.keys(this.netMap).length}`;for(let r of t)if(r!==i){let s=this.netMap[i],o=this.netMap[r];if(s&&o){s.push(...o),this.netMap[r]=s;for(let a of s)this.idToNetMap[a]=i}}}for(let r of e){let s=this.netMap[i];s&&!s.includes(r)&&s.push(r),this.idToNetMap[r]=i}}}getIdsConnectedToNet(n){return this.netMap[n]||[]}getNetConnectedToId(n){return this.idToNetMap[n]}areIdsConnected(n,e){if(n===e)return!0;let t=this.getNetConnectedToId(n);if(!t)return!1;let i=this.getNetConnectedToId(e);return i?t===i||i===n||i===n:!1}areAllIdsConnected(n){if(n.length===0)return!0;let e=this.getNetConnectedToId(n[0]);if(!e)return!1;for(let t of n){let i=this.getNetConnectedToId(t);if(i===void 0||i!==e)return!1}return!0}};Ag();var x1=class{constructor(){this.ids=[],this.values=[],this.length=0}clear(){this.length=0}push(e,t){let i=this.length++;for(;i>0;){let r=i-1>>1,s=this.values[r];if(t>=s)break;this.ids[i]=this.ids[r],this.values[i]=s,i=r}this.ids[i]=e,this.values[i]=t}pop(){if(this.length===0)return;let e=this.ids,t=this.values,i=e[0],r=--this.length;if(r>0){let s=e[r],o=t[r],a=0,c=r>>1;for(;a<c;){let l=(a<<1)+1,u=l+1,p=l+(+(u<r)&+(t[u]<t[l]));if(t[p]>=o)break;e[a]=e[p],t[a]=t[p],a=p}e[a]=s,t[a]=o}return i}peek(){return this.length>0?this.ids[0]:void 0}peekValue(){return this.length>0?this.values[0]:void 0}shrink(){this.ids.length=this.values.length=this.length}};var dQ=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],uA=3,b1=class n{static from(e,t=0){if(t%8!==0)throw new Error("byteOffset must be 8-byte aligned.");if(!e||e.byteLength===void 0||e.buffer)throw new Error("Data must be an instance of ArrayBuffer or SharedArrayBuffer.");let[i,r]=new Uint8Array(e,t+0,2);if(i!==251)throw new Error("Data does not appear to be in a Flatbush format.");let s=r>>4;if(s!==uA)throw new Error(`Got v${s} data when expected v${uA}.`);let o=dQ[r&15];if(!o)throw new Error("Unrecognized array type.");let[a]=new Uint16Array(e,t+2,1),[c]=new Uint32Array(e,t+4,1);return new n(c,a,o,void 0,e,t)}constructor(e,t=16,i=Float64Array,r=ArrayBuffer,s,o=0){if(e===void 0)throw new Error("Missing required argument: numItems.");if(isNaN(e)||e<=0)throw new Error(`Unexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+t,2),65535),this.byteOffset=o;let a=e,c=a;this._levelBounds=[a*4];do a=Math.ceil(a/this.nodeSize),c+=a,this._levelBounds.push(c*4);while(a!==1);this.ArrayType=i,this.IndexArrayType=c<16384?Uint16Array:Uint32Array;let l=dQ.indexOf(i),u=c*4*i.BYTES_PER_ELEMENT;if(l<0)throw new Error(`Unexpected typed array class: ${i}.`);if(s)this.data=s,this._boxes=new i(s,o+8,c*4),this._indices=new this.IndexArrayType(s,o+8+u,c),this._pos=c*4,this.minX=this._boxes[this._pos-4],this.minY=this._boxes[this._pos-3],this.maxX=this._boxes[this._pos-2],this.maxY=this._boxes[this._pos-1];else{let p=this.data=new r(8+u+c*this.IndexArrayType.BYTES_PER_ELEMENT);this._boxes=new i(p,8,c*4),this._indices=new this.IndexArrayType(p,8+u,c),this._pos=0,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,new Uint8Array(p,0,2).set([251,(uA<<4)+l]),new Uint16Array(p,2,1)[0]=t,new Uint32Array(p,4,1)[0]=e}this._queue=new x1}add(e,t,i=e,r=t){let s=this._pos>>2,o=this._boxes;return this._indices[s]=s,o[this._pos++]=e,o[this._pos++]=t,o[this._pos++]=i,o[this._pos++]=r,e<this.minX&&(this.minX=e),t<this.minY&&(this.minY=t),i>this.maxX&&(this.maxX=i),r>this.maxY&&(this.maxY=r),s}finish(){if(this._pos>>2!==this.numItems)throw new Error(`Added ${this._pos>>2} items when expected ${this.numItems}.`);let e=this._boxes;if(this.numItems<=this.nodeSize){e[this._pos++]=this.minX,e[this._pos++]=this.minY,e[this._pos++]=this.maxX,e[this._pos++]=this.maxY;return}let t=this.maxX-this.minX||1,i=this.maxY-this.minY||1,r=new Uint32Array(this.numItems),s=65535;for(let o=0,a=0;o<this.numItems;o++){let c=e[a++],l=e[a++],u=e[a++],p=e[a++],f=Math.floor(s*((c+u)/2-this.minX)/t),y=Math.floor(s*((l+p)/2-this.minY)/i);r[o]=ZNt(f,y)}pA(r,e,this._indices,0,this.numItems-1,this.nodeSize);for(let o=0,a=0;o<this._levelBounds.length-1;o++){let c=this._levelBounds[o];for(;a<c;){let l=a,u=e[a++],p=e[a++],f=e[a++],y=e[a++];for(let g=1;g<this.nodeSize&&a<c;g++)u=Math.min(u,e[a++]),p=Math.min(p,e[a++]),f=Math.max(f,e[a++]),y=Math.max(y,e[a++]);this._indices[this._pos>>2]=l,e[this._pos++]=u,e[this._pos++]=p,e[this._pos++]=f,e[this._pos++]=y}}}search(e,t,i,r,s){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let o=this._boxes.length-4,a=[],c=[];for(;o!==void 0;){let l=Math.min(o+this.nodeSize*4,fQ(o,this._levelBounds));for(let u=o;u<l;u+=4){let p=this._boxes[u];if(i<p)continue;let f=this._boxes[u+1];if(r<f)continue;let y=this._boxes[u+2];if(e>y)continue;let g=this._boxes[u+3];if(t>g)continue;let x=this._indices[u>>2]|0;o>=this.numItems*4?a.push(x):(s===void 0||s(x,p,f,y,g))&&c.push(x)}o=a.pop()}return c}neighbors(e,t,i=1/0,r=1/0,s){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let o=this._boxes.length-4,a=this._queue,c=[],l=r*r;t:for(;o!==void 0;){let u=Math.min(o+this.nodeSize*4,fQ(o,this._levelBounds));for(let p=o;p<u;p+=4){let f=this._indices[p>>2]|0,y=this._boxes[p],g=this._boxes[p+1],x=this._boxes[p+2],v=this._boxes[p+3],P=e<y?y-e:e>x?e-x:0,w=t<g?g-t:t>v?t-v:0,k=P*P+w*w;k>l||(o>=this.numItems*4?a.push(f<<1,k):(s===void 0||s(f))&&a.push((f<<1)+1,k))}for(;a.length&&a.peek()&1;)if(a.peekValue()>l||(c.push(a.pop()>>1),c.length===i))break t;o=a.length?a.pop()>>1:void 0}return a.clear(),c}};function fQ(n,e){let t=0,i=e.length-1;for(;t<i;){let r=t+i>>1;e[r]>n?i=r:t=r+1}return e[t]}function pA(n,e,t,i,r,s){if(Math.floor(i/s)>=Math.floor(r/s))return;let o=n[i],a=n[i+r>>1],c=n[r],l=c,u=Math.max(o,a);c>u?l=u:u===o?l=Math.max(a,c):u===a&&(l=Math.max(o,c));let p=i-1,f=r+1;for(;;){do p++;while(n[p]<l);do f--;while(n[f]>l);if(p>=f)break;qNt(n,e,t,p,f)}pA(n,e,t,i,f,s),pA(n,e,t,f+1,r,s)}function qNt(n,e,t,i,r){let s=n[i];n[i]=n[r],n[r]=s;let o=4*i,a=4*r,c=e[o],l=e[o+1],u=e[o+2],p=e[o+3];e[o]=e[a],e[o+1]=e[a+1],e[o+2]=e[a+2],e[o+3]=e[a+3],e[a]=c,e[a+1]=l,e[a+2]=u,e[a+3]=p;let f=t[i];t[i]=t[r],t[r]=f}function ZNt(n,e){let t=n^e,i=65535^t,r=65535^(n|e),s=n&(e^65535),o=t|i>>1,a=t>>1^t,c=r>>1^i&s>>1^r,l=t&r>>1^s>>1^s;t=o,i=a,r=c,s=l,o=t&t>>2^i&i>>2,a=t&i>>2^i&(t^i)>>2,c^=t&r>>2^i&s>>2,l^=i&r>>2^(t^i)&s>>2,t=o,i=a,r=c,s=l,o=t&t>>4^i&i>>4,a=t&i>>4^i&(t^i)>>4,c^=t&r>>4^i&s>>4,l^=i&r>>4^(t^i)&s>>4,t=o,i=a,r=c,s=l,c^=t&r>>8^i&s>>8,l^=i&r>>8^(t^i)&s>>8,t=c^c>>1,i=l^l>>1;let u=n^e,p=i|65535^(u|t);return u=(u|u<<8)&16711935,u=(u|u<<4)&252645135,u=(u|u<<2)&858993459,u=(u|u<<1)&1431655765,p=(p|p<<8)&16711935,p=(p|p<<4)&252645135,p=(p|p<<2)&858993459,p=(p|p<<1)&1431655765,(p<<1|u)>>>0}var Tr=class{constructor(){d(this,"MAX_ITERATIONS",1e5);d(this,"solved",!1);d(this,"failed",!1);d(this,"iterations",0);d(this,"progress",0);d(this,"error",null);d(this,"activeSubSolver");d(this,"failedSubSolvers");d(this,"timeToSolve");d(this,"stats",{})}step(){if(!this.solved&&!this.failed){this.iterations++;try{this._step()}catch(n){throw this.error=`${this.constructor.name} error: ${n}`,this.failed=!0,n}!this.solved&&this.iterations>this.MAX_ITERATIONS&&this.tryFinalAcceptance(),!this.solved&&this.iterations>this.MAX_ITERATIONS&&(this.error=`${this.constructor.name} ran out of iterations`,this.failed=!0),"computeProgress"in this&&(this.progress=this.computeProgress())}}_step(){}getConstructorParams(){throw new Error("getConstructorParams not implemented")}solve(){let n=Date.now();for(;!this.solved&&!this.failed;)this.step();let e=Date.now();this.timeToSolve=e-n}visualize(){return{lines:[],points:[],rects:[],circles:[]}}tryFinalAcceptance(){}preview(){return{lines:[],points:[],rects:[],circles:[]}}},xA=n=>{let e=new lA({});for(let i of n.directConnections)e.addConnections([i.netId?[i.netId,...i.pinIds]:i.pinIds]);let t=new lA(e.netMap);for(let i of n.netConnections)t.addConnections([[i.netId,...i.pinIds]]);return{directConnMap:e,netConnMap:t}};function KNt(n,e={}){let t=n.length,i=e?.maxDistance??Number.POSITIVE_INFINITY;if(t<=1)return[];{let u=new Set;for(let p of n){if(u.has(p.pinId))throw new Error(`Duplicate pinId detected: "${p.pinId}"`);u.add(p.pinId)}}let r=(u,p)=>Math.abs(u.x-p.x)+Math.abs(u.y-p.y),s=new Array(t).fill(!1),o=new Array(t).fill(Number.POSITIVE_INFINITY),a=new Array(t).fill(-1),c=0;for(let u=1;u<t;u++)n[u].pinId<n[c].pinId&&(c=u);o[c]=0;let l=[];for(let u=0;u<t;u++){let p=-1,f=Number.POSITIVE_INFINITY,y="";for(let g=0;g<t;g++)if(!s[g]){let x=o[g];(x<f||x===f&&(y===""||n[g].pinId<y))&&(f=x,y=n[g].pinId,p=g)}s[p]=!0,a[p]!==-1&&l.push([n[p].pinId,n[a[p]].pinId]);for(let g=0;g<t;g++)if(!s[g]){let x=r(n[p],n[g]),v=e?.forbidEdge?.(n[p],n[g])??!1,P=x>i||v?Number.POSITIVE_INFINITY:x;(P<o[g]||P===o[g]&&n[p].pinId<n[a[g]]?.pinId)&&(o[g]=P,a[g]=p)}}return l}var v1=(n,e)=>{let{x:t,y:i}=n,{center:r,width:s,height:o}=e,a=r.y+o/2,c=r.y-o/2,l=r.x+s/2,u=r.x-s/2,p=a-i,f=i-c,y=l-t,g=t-u,x=Math.min(p,f,y,g);return x===p?"y+":x===f?"y-":x===y?"x+":"x-"},JNt=n=>{let{pins:e,inputProblem:t,pinIdMap:i,chipMap:r}=n,s=f=>{let y=new Set,g=[f];y.add(f);let x=t.directConnections||[];for(;g.length;){let v=g.shift();for(let P of x)if(P.pinIds.includes(v))for(let w of P.pinIds)y.has(w)||(y.add(w),g.push(w))}return y},o=e[0].pinId,a=e[1].pinId,c=new Set([...s(o),...s(a)]),l=new Map,u=new Map,p=new Set(e.map(f=>f.chipId));for(let f of c){let y=i.get(f);if(!y)continue;let g=r[y.chipId];if(!g)continue;let x=y._facingDirection??v1(y,g),v=u.get(g.chipId);if(!v){v={center:g.center};let P={xPos:0,xNeg:0,yPos:0,yNeg:0};for(let w of g.pins){let k=w._facingDirection??v1(w,g);k==="x+"&&P.xPos++,k==="x-"&&P.xNeg++,k==="y+"&&P.yPos++,k==="y-"&&P.yNeg++}v.counts=P,u.set(g.chipId,v)}x==="x+"&&(v.hasXPos=!0),x==="x-"&&(v.hasXNeg=!0),x==="y+"&&(v.hasYPos=!0),x==="y-"&&(v.hasYNeg=!0)}for(let[f,y]of u){let g=new Set,x={axes:g},v=y.counts;!!!(v&&(v.xPos>1||v.xNeg>1||v.yPos>1||v.yNeg>1))&&p.has(f)||(y.hasXPos&&y.hasXNeg&&(x.x=y.center.x,g.add("x")),y.hasYPos&&y.hasYNeg&&(x.y=y.center.y,g.add("y"))),g.size>0&&l.set(f,x)}return l},hA=n=>{let{inputProblem:e,chipMap:t,pinIdMap:i,p1:r,p2:s}=n,o=JNt({pins:[r,s],inputProblem:e,pinIdMap:i,chipMap:t});if(o.size===0)return!1;let a=1e-9,c=(y,g)=>{for(let[,x]of o)if(x.axes.has("x")&&typeof x.x=="number"&&(y.x-x.x)*(g.x-x.x)<-a||x.axes.has("y")&&typeof x.y=="number"&&(y.y-x.y)*(g.y-x.y)<-a)return!0;return!1};if(Math.abs(r.x-s.x)<a||Math.abs(r.y-s.y)<a)return c({x:r.x,y:r.y},{x:s.x,y:s.y});let l={x:s.x,y:r.y},u={x:r.x,y:s.y},p=c({x:r.x,y:r.y},l)||c(l,{x:s.x,y:s.y}),f=c({x:r.x,y:r.y},u)||c(u,{x:s.x,y:s.y});return p&&f},Os=(n,e=1)=>`hsl(${n.split("").reduce((i,r)=>i*31+r.charCodeAt(0),0)%360}, 100%, 50%, ${e})`,ls=(n,e={})=>{let{connectionAlpha:t=.8,chipAlpha:i=.8}=e,r={lines:[],points:[],rects:[]},s=new Map;for(let o of n.chips)for(let a of o.pins)s.set(a.pinId,a);for(let o of n.chips){r.rects.push({label:o.chipId,center:o.center,width:o.width,height:o.height,fill:Os(o.chipId,i)});for(let a of o.pins)r.points.push({label:`${a.pinId}
${a._facingDirection??v1(a,o)}`,x:a.x,y:a.y,color:Os(a.pinId,.8)})}for(let o of n.directConnections){let[a,c]=o.pinIds,l=s.get(a),u=s.get(c);r.lines.push({points:[{x:l.x,y:l.y},{x:u.x,y:u.y}],strokeColor:Os(o.netId??`${a}-${c}`,t)})}for(let o of n.netConnections){let a=o.pinIds.map(c=>s.get(c));for(let c=0;c<a.length-1;c++)for(let l=c+1;l<a.length;l++){let u=a[c],p=a[l];r.lines.push({points:[{x:u.x,y:u.y},{x:p.x,y:p.y}],strokeColor:Os(o.netId,t),strokeDash:"4 2"})}}return r},QNt=class extends Tr{constructor({inputProblem:e}){super();d(this,"inputProblem");d(this,"mspConnectionPairs",[]);d(this,"dcConnMap");d(this,"globalConnMap");d(this,"queuedDcNetIds");d(this,"chipMap");d(this,"maxMspPairDistance");d(this,"pinMap");d(this,"userNetIdByPinId");this.inputProblem=e,this.maxMspPairDistance=e.maxMspPairDistance??1;let{directConnMap:t,netConnMap:i}=xA(e);this.dcConnMap=t,this.globalConnMap=i,this.pinMap={};for(let r of e.chips)for(let s of r.pins)this.pinMap[s.pinId]={...s,chipId:r.chipId};this.chipMap={};for(let r of e.chips)this.chipMap[r.chipId]=r;this.userNetIdByPinId={};for(let r of e.directConnections)if(r.netId){let[s,o]=r.pinIds;this.userNetIdByPinId[s]=r.netId,this.userNetIdByPinId[o]=r.netId}for(let r of e.netConnections)for(let s of r.pinIds)this.userNetIdByPinId[s]=r.netId;this.queuedDcNetIds=Object.keys(i.netMap)}getConstructorParams(){return{inputProblem:this.inputProblem}}_step(){if(this.queuedDcNetIds.length===0){this.solved=!0;return}let e=this.queuedDcNetIds.shift(),i=this.globalConnMap.getIdsConnectedToNet(e).filter(o=>!!this.pinMap[o]);if(i.length<=1)return;if(i.length===2){let[o,a]=i,c=this.pinMap[o],l=this.pinMap[a];if(Math.abs(c.x-l.x)+Math.abs(c.y-l.y)>this.maxMspPairDistance)return;let p=new Map(Object.entries(this.pinMap));if(hA({inputProblem:this.inputProblem,chipMap:this.chipMap,pinIdMap:p,p1:c,p2:l}))return;let f=this.globalConnMap.getNetConnectedToId(o),y=this.userNetIdByPinId[o]??this.userNetIdByPinId[a];this.mspConnectionPairs.push({mspPairId:`${o}-${a}`,dcConnNetId:e,globalConnNetId:f,userNetId:y,pins:[c,l]});return}let r=new Map(Object.entries(this.pinMap)),s=KNt(i.map(o=>this.pinMap[o]).filter(Boolean),{maxDistance:this.maxMspPairDistance,forbidEdge:(o,a)=>hA({inputProblem:this.inputProblem,chipMap:this.chipMap,pinIdMap:r,p1:o,p2:a})});for(let[o,a]of s){let c=this.pinMap[o],l=this.pinMap[a];if(hA({inputProblem:this.inputProblem,chipMap:this.chipMap,pinIdMap:r,p1:c,p2:l}))continue;let u=this.globalConnMap.getNetConnectedToId(o),p=this.userNetIdByPinId[o]??this.userNetIdByPinId[a];this.mspConnectionPairs.push({mspPairId:`${o}-${a}`,dcConnNetId:e,globalConnNetId:u,userNetId:p,pins:[c,l]})}}visualize(){let e=ls(this.inputProblem,{chipAlpha:.1,connectionAlpha:.1});for(let t of this.mspConnectionPairs)e.lines.push({points:[{x:t.pins[0].x,y:t.pins[0].y},{x:t.pins[1].x,y:t.pins[1].y}],strokeColor:Os(t.mspPairId,.75)});return e}};function bA(n){let e=n.width/2,t=n.height/2;return{minX:n.center.x-e,maxX:n.center.x+e,minY:n.center.y-t,maxY:n.center.y+t}}var tAt=n=>{let e=bA(n);return{chipId:n.chipId,...e}},Ow=n=>n.chips.map(tAt),vA=1e-9,za=(n,e,t=vA)=>Math.abs(n.x-e.x)<t,ll=(n,e,t=vA)=>Math.abs(n.y-e.y)<t,w1=(n,e,t,i=vA)=>{let r=za(n,e,i),s=ll(n,e,i);if(!r&&!s)return!1;if(r){let o=n.x;if(o<t.minX-i||o>t.maxX+i)return!1;let a=Math.min(n.y,e.y),c=Math.max(n.y,e.y);return Math.min(c,t.maxY)-Math.max(a,t.minY)>i}else{let o=n.y;if(o<t.minY-i||o>t.maxY+i)return!1;let a=Math.min(n.x,e.x),c=Math.max(n.x,e.x);return Math.min(c,t.maxX)-Math.max(a,t.minX)>i}},eAt=(n,e,t={})=>{for(let i=0;i<n.length-1;i++){let r=n[i],s=n[i+1],o=t.excludeRectIdsForSegment?.(i)??new Set;for(let a of e)if(!o.has(a.chipId)&&w1(r,s,a))return{segIndex:i,rect:a}}return null},nAt=(n,e)=>{for(let t=0;t<n.length-1;t++)for(let i of e)if(w1(n[t],n[t+1],i))return!0;return!1},kQ=1e-9,iAt=(n,e)=>({minX:Math.min(n.x,e.x),maxX:Math.max(n.x,e.x),minY:Math.min(n.y,e.y),maxY:Math.max(n.y,e.y)}),mQ=(n,e,t,i=kQ)=>n==="x"?e.x<t.minX-i?[(e.x+t.minX)/2]:e.x>t.maxX+i?[(e.x+t.maxX)/2]:[t.minX-.2,t.maxX+.2]:e.y<t.minY-i?[(e.y+t.minY)/2]:e.y>t.maxY+i?[(e.y+t.maxY)/2]:[t.minY-.2,t.maxY+.2],rAt=(n,e,t,i,r,s=kQ)=>{let o=[...i].map(a=>t.get(a)).filter(a=>!!a);if(n==="x"){let a=[r.minX,...o.map(f=>f.maxX)].filter(f=>f<e.minX-s),c=[r.maxX,...o.map(f=>f.minX)].filter(f=>f>e.maxX+s),l=a.length>0?Math.max(...a):void 0,u=c.length>0?Math.min(...c):void 0,p=[];return l!==void 0&&p.push((l+e.minX)/2),u!==void 0&&p.push((e.maxX+u)/2),p}else{let a=[r.minY,...o.map(f=>f.maxY)].filter(f=>f<e.minY-s),c=[r.maxY,...o.map(f=>f.minY)].filter(f=>f>e.maxY+s),l=a.length>0?Math.max(...a):void 0,u=c.length>0?Math.min(...c):void 0,p=[];return l!==void 0&&p.push((l+e.minY)/2),u!==void 0&&p.push((e.maxY+u)/2),p}},sAt=1e-9,oAt=(n,e,t,i,r=sAt)=>{if(e<0||e>=n.length-1)return null;let s=n[e],o=n[e+1],a=za(s,o,r),c=ll(s,o,r);if(!a&&!c||a&&t!=="x"||c&&t!=="y")return null;let l=n.map(u=>({...u}));if(t==="x"){if(Math.abs(s.x-i)<r&&Math.abs(o.x-i)<r)return null;l[e]={...l[e],x:i},l[e+1]={...l[e+1],x:i}}else{if(Math.abs(s.y-i)<r&&Math.abs(o.y-i)<r)return null;l[e]={...l[e],y:i},l[e+1]={...l[e+1],y:i}}if(e-1>=0){let u=l[e-1],p=l[e];if(Math.abs(u.x-p.x)+Math.abs(u.y-p.y)<r)return null}if(e+2<=l.length-1){let u=l[e+1],p=l[e+2];if(Math.abs(u.x-p.x)+Math.abs(u.y-p.y)<r)return null}for(let u=0;u<l.length-1;u++){let p=l[u],f=l[u+1];if(!ll(p,f,r)&&!za(p,f,r))return null}return l},_Q=(n,e=6)=>n.map(i=>`${i.x.toFixed(e)},${i.y.toFixed(e)}`).join("|"),TQ=class extends Tr{constructor(e){super();d(this,"pins");d(this,"inputProblem");d(this,"chipMap");d(this,"obstacles");d(this,"rectById");d(this,"aabb");d(this,"baseElbow");d(this,"solvedTracePath",null);d(this,"queue",[]);d(this,"visited",new Set);this.pins=e.pins,this.inputProblem=e.inputProblem,this.chipMap=e.chipMap;for(let r of this.pins)if(!r._facingDirection){let s=this.chipMap[r.chipId];r._facingDirection=v1(r,s)}this.obstacles=Ow(this.inputProblem),this.rectById=new Map(this.obstacles.map(r=>[r.chipId,r]));let[t,i]=this.pins;this.baseElbow=Wc({x:t.x,y:t.y,facingDirection:t._facingDirection},{x:i.x,y:i.y,facingDirection:i._facingDirection},{overshoot:.2}),this.aabb=iAt({x:t.x,y:t.y},{x:i.x,y:i.y}),this.queue.push({path:this.baseElbow,collisionChipIds:new Set}),this.visited.add(_Q(this.baseElbow))}getConstructorParams(){return{chipMap:this.chipMap,pins:this.pins,inputProblem:this.inputProblem}}axisOfSegment(e,t){return za(e,t)?"x":ll(e,t)?"y":null}pathLength(e){let t=0;for(let i=0;i<e.length-1;i++)t+=Math.abs(e[i+1].x-e[i].x)+Math.abs(e[i+1].y-e[i].y);return t}_step(){if(this.solvedTracePath){this.solved=!0;return}let e=this.queue.shift();if(!e){this.failed=!0,this.error="No collision-free path found";return}let{path:t,collisionChipIds:i}=e,[r,s]=this.pins,o=eAt(t,this.obstacles);if(!o){let v=t[0],P=t[t.length-1],w=1e-9,k=(T,I)=>Math.abs(T.x-I.x)<w&&Math.abs(T.y-I.y)<w;k(v,{x:r.x,y:r.y})&&k(P,{x:s.x,y:s.y})&&(this.solvedTracePath=t,this.solved=!0);return}let{segIndex:a,rect:c}=o,l=a===0,u=a===t.length-2;if(l){if(t.length<3)return;a=1}else if(u){if(t.length<3)return;a=t.length-3}let p=t[a],f=t[a+1],y=this.axisOfSegment(p,f);if(!y)return;let g=[];if(i.size===0){let v=mQ(y,{x:r.x,y:r.y},c),P=mQ(y,{x:s.x,y:s.y},c),w=[...v,...P],k=[...new Set(w)];g.push(...k)}else{let v=rAt(y,c,this.rectById,i,this.aabb);g.push(...v)}let x=[];for(let v of g){let P=oAt(t,a,y,v);if(!P)continue;let w=_Q(P);if(this.visited.has(w))continue;this.visited.add(w);let k=new Set(i);k.add(c.chipId);let T=this.pathLength(P);x.push({path:P,collisionRectIds:k,len:T})}x.sort((v,P)=>v.len-P.len);for(let v of x)this.queue.push({path:v.path,collisionChipIds:v.collisionRectIds})}visualize(){let e=ls(this.inputProblem,{chipAlpha:.1,connectionAlpha:.1});e.lines.push({points:this.baseElbow,strokeColor:"red",strokeDash:"4 4"});let[t,i]=this.pins;e.lines.push({points:[{x:t.x,y:t.y},{x:i.x,y:i.y}],strokeColor:"blue",strokeDash:"5 5"});for(let{path:r,collisionChipIds:s}of this.queue)e.lines.push({points:r,strokeColor:"teal",strokeDash:"2 2"});return this.solvedTracePath?e.lines.push({points:this.solvedTracePath,strokeColor:"green"}):this.queue.length>0&&e.lines.push({points:this.queue[0].path,strokeColor:"orange"}),e}},aAt=class extends Tr{constructor(e){super();d(this,"inputProblem");d(this,"mspConnectionPairs");d(this,"dcConnMap");d(this,"globalConnMap");d(this,"queuedConnectionPairs");d(this,"chipMap");d(this,"currentConnectionPair",null);d(this,"solvedTracePaths",[]);d(this,"failedConnectionPairs",[]);this.inputProblem=e.inputProblem,this.mspConnectionPairs=e.mspConnectionPairs,this.dcConnMap=e.dcConnMap,this.globalConnMap=e.globalConnMap,this.chipMap=e.chipMap,this.queuedConnectionPairs=[...this.mspConnectionPairs]}getConstructorParams(){return{inputProblem:this.inputProblem,chipMap:this.chipMap,mspConnectionPairs:this.mspConnectionPairs,dcConnMap:this.dcConnMap,globalConnMap:this.globalConnMap}}_step(){if(this.activeSubSolver?.solved&&(this.solvedTracePaths.push({...this.currentConnectionPair,tracePath:this.activeSubSolver.solvedTracePath,mspConnectionPairIds:[this.currentConnectionPair.mspPairId],pinIds:[this.currentConnectionPair.pins[0].pinId,this.currentConnectionPair.pins[1].pinId]}),this.activeSubSolver=null,this.currentConnectionPair=null),this.activeSubSolver?.failed&&(this.currentConnectionPair&&this.failedConnectionPairs.push({...this.currentConnectionPair,error:this.activeSubSolver.error||void 0}),this.activeSubSolver=null,this.currentConnectionPair=null),this.activeSubSolver){this.activeSubSolver.step();return}let e=this.queuedConnectionPairs.shift();if(!e){this.solved=!0;return}this.currentConnectionPair=e;let{pins:t}=e;this.activeSubSolver=new TQ({inputProblem:this.inputProblem,pins:t,chipMap:this.chipMap})}visualize(){if(this.activeSubSolver)return this.activeSubSolver.visualize();let e=ls(this.inputProblem,{chipAlpha:.1,connectionAlpha:.1});for(let{mspPairId:t,tracePath:i}of this.solvedTracePaths)e.lines.push({points:i,strokeColor:"green"});for(let t of this.failedConnectionPairs)e.lines.push({points:[{x:t.pins[0].x,y:t.pins[0].y},{x:t.pins[1].x,y:t.pins[1].y}],strokeColor:"red",strokeDash:"4 2"});return e}},cAt=({pts:n,segmentIndex:e,offset:t,JOG_SIZE:i,EPS:r=1e-6})=>{if(e!==0&&e!==n.length-2)return;let s=n[e],o=n[e+1],a=Math.abs(s.x-o.x)<r,c=Math.abs(s.y-o.y)<r;if(!a&&!c)return;let l=a?o.y>s.y?1:-1:o.x>s.x?1:-1;if(e===0)if(a){let u=s.y+l*i;n.splice(1,1,{x:s.x,y:u},{x:s.x+t,y:u},{x:o.x+t,y:o.y})}else{let u=s.x+l*i;n.splice(1,1,{x:u,y:s.y},{x:u,y:s.y+t},{x:o.x,y:o.y+t})}else if(a){let u=o.y-l*i;n.splice(e,1,{x:s.x+t,y:s.y},{x:o.x+t,y:u},{x:o.x,y:u})}else{let u=o.x-l*i;n.splice(e,1,{x:s.x,y:s.y+t},{x:u,y:o.y+t},{x:u,y:o.y})}},lAt=class extends Tr{constructor(e){super();d(this,"overlappingTraceSegments");d(this,"traceNetIslands");d(this,"SHIFT_DISTANCE",.1);d(this,"correctedTraceMap",{});this.overlappingTraceSegments=e.overlappingTraceSegments,this.traceNetIslands=e.traceNetIslands;for(let{connNetId:t,pathsWithOverlap:i}of this.overlappingTraceSegments)for(let{solvedTracePathIndex:r,traceSegmentIndex:s}of i){let o=this.traceNetIslands[t][r].mspPairId;this.correctedTraceMap[o]=this.traceNetIslands[t][r]}}_step(){let t=this.overlappingTraceSegments.map((s,o)=>{let a=Math.floor(o/2)+1;return(o%2===0?-a:a)*this.SHIFT_DISTANCE}),i=(s,o)=>Math.abs(s-o)<1e-6,r=(s,o)=>!!s&&!!o&&i(s.x,o.x)&&i(s.y,o.y);this.overlappingTraceSegments.forEach((s,o)=>{let a=t[o],c=new Map;for(let l of s.pathsWithOverlap)c.has(l.solvedTracePathIndex)||c.set(l.solvedTracePathIndex,new Set),c.get(l.solvedTracePathIndex).add(l.traceSegmentIndex);for(let[l,u]of c){let p=this.traceNetIslands[s.connNetId][l],f=this.correctedTraceMap[p.mspPairId]??p,y=f.tracePath.map(w=>({...w})),g=Array.from(u).sort((w,k)=>w-k),x=Array.from(u).sort((w,k)=>w-k).reverse(),v=this.SHIFT_DISTANCE;for(let w of x)if(!(w<0||w>=y.length-1))if(w===0||w===y.length-2)cAt({pts:y,segmentIndex:w,offset:a,JOG_SIZE:v,EPS:1e-6});else{let k=y[w],T=y[w+1],I=Math.abs(k.x-T.x)<1e-6,E=Math.abs(k.y-T.y)<1e-6;if(!I&&!E)continue;I?(k.x+=a,T.x+=a):(k.y+=a,T.y+=a)}let P=[];for(let w of y)(P.length===0||!r(P[P.length-1],w))&&P.push(w);this.correctedTraceMap[p.mspPairId]={...f,tracePath:P}}}),this.solved=!0}visualize(){let e={lines:[],points:[],rects:[],circles:[]};for(let t of this.overlappingTraceSegments)for(let{solvedTracePathIndex:i,traceSegmentIndex:r}of t.pathsWithOverlap){let s=this.traceNetIslands[t.connNetId][i],o=s.tracePath[r],a=s.tracePath[r+1];e.lines.push({points:[o,a],strokeColor:"red"})}for(let t of Object.values(this.correctedTraceMap))e.lines.push({points:t.tracePath,strokeColor:"blue",strokeDash:"4 2"});return e}},uAt=class extends Tr{constructor(e){super();d(this,"inputProblem");d(this,"inputTracePaths");d(this,"globalConnMap");d(this,"traceNetIslands",{});d(this,"correctedTraceMap",{});d(this,"cleanupPhase",null);this.inputProblem=e.inputProblem,this.inputTracePaths=e.inputTracePaths,this.globalConnMap=e.globalConnMap;for(let t of this.inputTracePaths){let{mspPairId:i}=t;this.correctedTraceMap[i]=t}this.traceNetIslands=this.computeTraceNetIslands()}getConstructorParams(){return{inputProblem:this.inputProblem,inputTracePaths:this.inputTracePaths,globalConnMap:this.globalConnMap}}computeTraceNetIslands(){let e={};for(let t of this.inputTracePaths){let i=this.correctedTraceMap[t.mspPairId]??t,r=i.globalConnNetId;e[r]||(e[r]=[]),e[r].push(i)}return e}findNextOverlapIssue(){let t=Object.keys(this.traceNetIslands);for(let i=0;i<t.length;i++)for(let r=i+1;r<t.length;r++){let s=t[i],o=t[r],a=this.traceNetIslands[s]||[],c=this.traceNetIslands[o]||[],l=[],u=[],p=new Set,f=new Set,y=(g,x,v,P)=>{let w=Math.min(g,x),k=Math.max(g,x),T=Math.min(v,P),I=Math.max(v,P);return Math.min(k,I)-Math.max(w,T)>.002};for(let g=0;g<a.length;g++){let v=a[g].tracePath;for(let P=0;P<v.length-1;P++){let w=v[P],k=v[P+1],T=Math.abs(w.x-k.x)<.002,I=Math.abs(w.y-k.y)<.002;if(!(!T&&!I))for(let E=0;E<c.length;E++){let M=c[E].tracePath;for(let A=0;A<M.length-1;A++){let R=M[A],j=M[A+1],B=Math.abs(R.x-j.x)<.002,G=Math.abs(R.y-j.y)<.002;if(!(!B&&!G)){if(T&&B){if(Math.abs(w.x-R.x)<.002&&y(w.y,k.y,R.y,j.y)){let U=`${g}:${P}`,H=`${E}:${A}`;p.has(U)||(l.push({solvedTracePathIndex:g,traceSegmentIndex:P}),p.add(U)),f.has(H)||(u.push({solvedTracePathIndex:E,traceSegmentIndex:A}),f.add(H))}}else if(I&&G&&Math.abs(w.y-R.y)<.002&&y(w.x,k.x,R.x,j.x)){let U=`${g}:${P}`,H=`${E}:${A}`;p.has(U)||(l.push({solvedTracePathIndex:g,traceSegmentIndex:P}),p.add(U)),f.has(H)||(u.push({solvedTracePathIndex:E,traceSegmentIndex:A}),f.add(H))}}}}}}if(l.length>0&&u.length>0)return{overlappingTraceSegments:[{connNetId:s,pathsWithOverlap:l},{connNetId:o,pathsWithOverlap:u}]}}return null}findNextDiagonalSegment(){for(let t in this.correctedTraceMap){let i=this.correctedTraceMap[t].tracePath;for(let r=0;r<i.length-1;r++){let s=i[r],o=i[r+1],a=Math.abs(s.y-o.y)<.002,c=Math.abs(s.x-o.x)<.002;if(!a&&!c)return{mspPairId:t,tracePath:i,i:r,p1:s,p2:o}}}return null}findAndFixNextDiagonalSegment(){let e=this.findNextDiagonalSegment();if(!e)return!1;let{mspPairId:t,tracePath:i,i:r,p1:s,p2:o}=e,a=.002,c=r>0?i[r-1]:null,l=r+2<i.length?i[r+2]:null,u=c?Math.abs(c.x-s.x)<a:!1,p=c?Math.abs(c.y-s.y)<a:!1,f=l?Math.abs(o.x-l.x)<a:!1,y=l?Math.abs(o.y-l.y)<a:!1,g={x:s.x,y:o.y},x={x:o.x,y:s.y},v=0;u&&v++,y&&v++;let P=0;p&&P++,f&&P++;let w=v<P?g:x;return i.splice(r+1,0,w),!0}_step(){if(this.activeSubSolver?.solved){for(let[i,r]of Object.entries(this.activeSubSolver.correctedTraceMap))this.correctedTraceMap[i]=r;this.activeSubSolver=null,this.traceNetIslands=this.computeTraceNetIslands()}if(this.activeSubSolver){this.activeSubSolver.step();return}let e=this.findNextOverlapIssue();if(e===null){if(this.cleanupPhase===null&&(this.cleanupPhase="diagonals"),this.cleanupPhase==="diagonals"){this.findAndFixNextDiagonalSegment()||(this.cleanupPhase="done",this.solved=!0);return}this.solved=!0;return}let{overlappingTraceSegments:t}=e;this.activeSubSolver=new lAt({overlappingTraceSegments:t,traceNetIslands:this.traceNetIslands})}visualize(){if(this.activeSubSolver)return this.activeSubSolver.visualize();let e=ls(this.inputProblem);e.circles=e.circles||[];for(let t of Object.values(this.correctedTraceMap))e.lines.push({points:t.tracePath,strokeColor:"purple"});if(this.cleanupPhase==="diagonals"){let t=this.findNextDiagonalSegment();t&&e.lines.push({points:[t.p1,t.p2],strokeColor:"red",strokeWidth:.05})}return e}},pAt=class{constructor(n){d(this,"chips");d(this,"spatialIndex");d(this,"spatialIndexIdToChip");this.chips=n.map(e=>({...e,bounds:bA(e),spatialIndexId:null})),this.spatialIndexIdToChip=new Map,this.spatialIndex=new b1(n.length);for(let e of this.chips)e.spatialIndexId=this.spatialIndex.add(e.bounds.minX,e.bounds.minY,e.bounds.maxX,e.bounds.maxY),this.spatialIndexIdToChip.set(e.spatialIndexId,e);this.spatialIndex.finish()}getChipsInBounds(n){return this.spatialIndex.search(n.minX,n.minY,n.maxX,n.maxY).map(t=>this.spatialIndexIdToChip.get(t))}doesOrthogonalLineIntersectChip(n,e={}){let t=e.excludeChipIds??[],[i,r]=n,{x:s,y:o}=i,{x:a,y:c}=r;return this.getChipsInBounds({minX:Math.min(s,a),minY:Math.min(o,c),maxX:Math.max(s,a),maxY:Math.max(o,c)}).filter(u=>!t.includes(u.chipId)).length>0}},hAt=.45,yQ=.2;function yA(n){let{orientation:e,netLabelWidth:t}=n,i=typeof t=="number"?t:hAt;return e==="y+"||e==="y-"?{width:yQ,height:i}:{width:i,height:yQ}}function gA(n,e,t,i){switch(e){case"x+":return{x:n.x+t/2,y:n.y};case"x-":return{x:n.x-t/2,y:n.y};case"y+":return{x:n.x,y:n.y+i/2};case"y-":return{x:n.x,y:n.y-i/2}}}function Pd(n,e,t){return{minX:n.x-e/2,minY:n.y-t/2,maxX:n.x+e/2,maxY:n.y+t/2}}function EQ(n,e,t,i=1e-9){let r=Math.abs(n.x-e.x)<i,s=Math.abs(n.y-e.y)<i;if(!r&&!s)return!1;if(r){let o=n.x;if(o<t.minX-i||o>t.maxX+i)return!1;let a=Math.min(n.y,e.y),c=Math.max(n.y,e.y);return Math.min(c,t.maxY)-Math.max(a,t.minY)>i}else{let o=n.y;if(o<t.minY-i||o>t.maxY+i)return!1;let a=Math.min(n.x,e.x),c=Math.max(n.x,e.x);return Math.min(c,t.maxX)-Math.max(a,t.minX)>i}}function MQ(n,e,t,i){for(let[r,s]of Object.entries(e)){let o=s.tracePath;for(let a=0;a<o.length-1;a++)if(!(r===t&&a===i)&&EQ(o[a],o[a+1],n))return{hasIntersection:!0,mspPairId:r,segIndex:a}}return{hasIntersection:!1}}function gQ(n){let e=0,t=n.tracePath;for(let i=0;i<t.length-1;i++)e+=Math.abs(t[i+1].x-t[i].x)+Math.abs(t[i+1].y-t[i].y);return e}function CQ(n){let{inputProblem:e,inputTraceMap:t,globalConnNetId:i,fallbackTrace:r,mspConnectionPairIds:s}=n,o=Object.fromEntries(e.chips.map(f=>[f.chipId,f])),a=Object.values(t).filter(f=>f.globalConnNetId===i);if(s&&s.length>0){let f=new Set(s);a=a.filter(y=>y.mspConnectionPairIds.some(g=>f.has(g)))}let c=new Set;for(let f of a)c.add(f.pins[0].chipId),c.add(f.pins[1].chipId);let l=null,u=-1;for(let f of c){let g=o[f]?.pins?.length??0;g>u&&(u=g,l=f)}let p=l==null?[]:a.filter(f=>f.pins[0].chipId===l||f.pins[1].chipId===l);return p.length>0?p.reduce((f,y)=>gQ(f)>=gQ(y)?f:y):r}function dAt(n,e){return[{x:n.x,y:n.y},{x:(n.x+e.x)/2,y:(n.y+e.y)/2},{x:e.x,y:e.y}]}function fAt(n){let{inputProblem:e,inputTraceMap:t,chipObstacleSpatialIndex:i,overlappingSameNetTraceGroup:r,availableOrientations:s,netLabelWidth:o}=n,a=r.portOnlyPinId;if(!a)return{placement:null,testedCandidates:[],error:"No portOnlyPinId provided"};let c=null,l=null;for(let E of e.chips){let N=E.pins.find(M=>M.pinId===a);if(N){c={x:N.x,y:N.y},l=N._facingDirection||v1(N,E);break}}if(!c||!l)return{placement:null,testedCandidates:[],error:`Port-only pin not found: ${a}`};let u=s.length>0?s:["x+","x-","y+","y-"],p={x:c.x,y:c.y},f=E=>E==="x+"?{x:1,y:0}:E==="x-"?{x:-1,y:0}:E==="y+"?{x:0,y:1}:{x:0,y:-1},y=[];for(let E of u){let{width:N,height:M}=yA({orientation:E,netLabelWidth:o}),A=gA(p,E,N,M),R=f(E),j=.001,B={x:A.x+R.x*j,y:A.y+R.y*j},G=Pd(B,N,M);if(i.getChipsInBounds(G).length>0){y.push({center:B,width:N,height:M,bounds:G,anchor:p,orientation:E,status:"chip-collision",hostSegIndex:-1});continue}if(MQ(G,t,"",-1).hasIntersection){y.push({center:B,width:N,height:M,bounds:G,anchor:p,orientation:E,status:"trace-collision",hostSegIndex:-1});continue}return y.push({center:B,width:N,height:M,bounds:G,anchor:p,orientation:E,status:"ok",hostSegIndex:-1}),{placement:{globalConnNetId:r.globalConnNetId,dcConnNetId:void 0,netId:r.netId,mspConnectionPairIds:[],pinIds:[a],orientation:E,anchorPoint:p,width:N,height:M,center:B},testedCandidates:y}}let g=l,{width:x,height:v}=yA({orientation:g,netLabelWidth:o}),P=gA(p,g,x,v),w=f(g),k=.001,T={x:P.x+w.x*k,y:P.y+w.y*k};return{placement:{globalConnNetId:r.globalConnNetId,dcConnNetId:void 0,netId:r.netId,mspConnectionPairIds:[],pinIds:[a],orientation:g,anchorPoint:p,width:x,height:v,center:T},testedCandidates:y}}function mAt(n){let e=ls(n.inputProblem),t=n.overlappingSameNetTraceGroup.globalConnNetId,i=CQ({inputProblem:n.inputProblem,inputTraceMap:n.inputTraceMap,globalConnNetId:t,fallbackTrace:n.overlappingSameNetTraceGroup.overlappingTraces}),r=Os(t,.9),s=Os(t,.5);for(let o of Object.values(n.inputTraceMap)){let a=i?o.mspPairId===i.mspPairId:!1;e.lines.push({points:o.tracePath})}for(let o of n.testedCandidates){let a=o.status==="ok"?"rgba(0, 180, 0, 0.25)":o.status==="chip-collision"?"rgba(220, 0, 0, 0.25)":o.status==="trace-collision"?"rgba(220, 140, 0, 0.25)":"rgba(120, 120, 120, 0.15)",c=o.status==="ok"?"green":o.status==="chip-collision"?"red":o.status==="trace-collision"?"orange":"gray";e.rects.push({center:{x:(o.bounds.minX+o.bounds.maxX)/2,y:(o.bounds.minY+o.bounds.maxY)/2},width:o.width,height:o.height,fill:a,strokeColor:c}),e.points.push({x:o.anchor.x,y:o.anchor.y,color:c})}if(n.netLabelPlacement){let o=n.netLabelPlacement;e.rects.push({center:o.center,width:o.width,height:o.height,fill:"rgba(0, 128, 255, 0.35)",strokeColor:"blue"}),e.points.push({x:o.anchorPoint.x,y:o.anchorPoint.y,color:"blue"})}return e}var xQ=class extends Tr{constructor(e){super();d(this,"inputProblem");d(this,"inputTraceMap");d(this,"overlappingSameNetTraceGroup");d(this,"availableOrientations");d(this,"chipObstacleSpatialIndex");d(this,"netLabelWidth");d(this,"netLabelPlacement",null);d(this,"testedCandidates",[]);this.inputProblem=e.inputProblem,this.inputTraceMap=e.inputTraceMap,this.overlappingSameNetTraceGroup=e.overlappingSameNetTraceGroup,this.availableOrientations=e.availableOrientations,this.netLabelWidth=e.netLabelWidth,this.chipObstacleSpatialIndex=e.inputProblem._chipObstacleSpatialIndex??new pAt(e.inputProblem.chips)}getConstructorParams(){return{inputProblem:this.inputProblem,inputTraceMap:this.inputTraceMap,overlappingSameNetTraceGroup:this.overlappingSameNetTraceGroup,availableOrientations:this.availableOrientations,netLabelWidth:this.netLabelWidth}}_step(){if(this.netLabelPlacement){this.solved=!0;return}if(this.overlappingSameNetTraceGroup.portOnlyPinId){let f=fAt({inputProblem:this.inputProblem,inputTraceMap:this.inputTraceMap,chipObstacleSpatialIndex:this.chipObstacleSpatialIndex,overlappingSameNetTraceGroup:this.overlappingSameNetTraceGroup,availableOrientations:this.availableOrientations,netLabelWidth:this.netLabelWidth});if(this.testedCandidates.push(...f.testedCandidates),f.placement){this.netLabelPlacement=f.placement,this.solved=!0;return}this.failed=!0,this.error=f.error??"Could not place net label at port without collisions";return}let e=this.overlappingSameNetTraceGroup.globalConnNetId,t=CQ({inputProblem:this.inputProblem,inputTraceMap:this.inputTraceMap,globalConnNetId:e,fallbackTrace:this.overlappingSameNetTraceGroup.overlappingTraces,mspConnectionPairIds:this.overlappingSameNetTraceGroup.mspConnectionPairIds});if(!t){this.failed=!0,this.error="No host trace found for net label placement";return}let i=new Set(this.overlappingSameNetTraceGroup.mspConnectionPairIds??[]),r=Object.values(this.inputTraceMap).filter(f=>f.globalConnNetId===e&&(i.size===0||f.mspConnectionPairIds.some(y=>i.has(y)))),s=this.availableOrientations.length===1?[t,...r.filter(f=>f.mspPairId!==t.mspPairId)]:[t],o=this.availableOrientations.length>0?this.availableOrientations:["x+","x-","y+","y-"],a=this.availableOrientations.length===1,c=(f,y)=>{switch(f){case"y+":return y.y;case"y-":return-y.y;case"x+":return y.x;case"x-":return-y.x}},l=null,u=-1/0,p=1e-6;for(let f of s){let y=f.tracePath.slice();for(let g=0;g<y.length-1;g++){let x=y[g],v=y[g+1],P=Math.abs(x.y-v.y)<p,w=Math.abs(x.x-v.x)<p;if(!P&&!w)continue;let k=P?["y+","y-"]:["x+","x-"],T=o.filter(E=>k.includes(E));if(T.length===0)continue;let I=dAt(x,v);for(let E of I)for(let N of T){let{width:M,height:A}=yA({orientation:N,netLabelWidth:this.netLabelWidth}),R=gA(E,N,M,A),j=N==="x+"?{x:1,y:0}:N==="x-"?{x:-1,y:0}:N==="y+"?{x:0,y:1}:{x:0,y:-1},B=1e-4,G={x:R.x+j.x*B,y:R.y+j.y*B},U=Pd(G,M,A);if(this.chipObstacleSpatialIndex.getChipsInBounds(U).length>0){this.testedCandidates.push({center:G,width:M,height:A,bounds:U,anchor:E,orientation:N,status:"chip-collision",hostSegIndex:g});continue}if(MQ(U,this.inputTraceMap,f.mspPairId,g).hasIntersection){this.testedCandidates.push({center:G,width:M,height:A,bounds:U,anchor:E,orientation:N,status:"trace-collision",hostSegIndex:g});continue}if(this.testedCandidates.push({center:G,width:M,height:A,bounds:U,anchor:E,orientation:N,status:"ok",hostSegIndex:g}),a){let et=c(N,E);et>u+1e-9&&(u=et,l={anchor:E,orientation:N,width:M,height:A,center:R,hostSegIndex:g,dcConnNetId:f.dcConnNetId,mspPairId:f.mspPairId,pinIds:[f.pins[0].pinId,f.pins[1].pinId]});continue}this.netLabelPlacement={globalConnNetId:this.overlappingSameNetTraceGroup.globalConnNetId,dcConnNetId:f.dcConnNetId,netId:this.overlappingSameNetTraceGroup.netId,mspConnectionPairIds:[f.mspPairId],pinIds:[f.pins[0].pinId,f.pins[1].pinId],orientation:N,anchorPoint:E,width:M,height:A,center:R},this.solved=!0;return}}}if(a&&l){this.netLabelPlacement={globalConnNetId:this.overlappingSameNetTraceGroup.globalConnNetId,dcConnNetId:l.dcConnNetId,netId:this.overlappingSameNetTraceGroup.netId,mspConnectionPairIds:[l.mspPairId],pinIds:l.pinIds,orientation:l.orientation,anchorPoint:l.anchor,width:l.width,height:l.height,center:l.center},this.solved=!0;return}this.failed=!0,this.error="Could not place net label without collisions"}visualize(){return mAt(this)}},bQ=class extends Tr{constructor(e){super();d(this,"inputProblem");d(this,"inputTraceMap");d(this,"overlappingSameNetTraceGroups");d(this,"queuedOverlappingSameNetTraceGroups");d(this,"netLabelPlacements",[]);d(this,"currentGroup",null);d(this,"triedAnyOrientationFallbackForCurrentGroup",!1);this.inputProblem=e.inputProblem,this.inputTraceMap=e.inputTraceMap,this.overlappingSameNetTraceGroups=this.computeOverlappingSameNetTraceGroups(),this.queuedOverlappingSameNetTraceGroups=[...this.overlappingSameNetTraceGroups]}computeOverlappingSameNetTraceGroups(){let e={};for(let c of Object.values(this.inputTraceMap)){let l=c.globalConnNetId;e[l]||(e[l]=[]),e[l].push(c)}let{netConnMap:t}=xA(this.inputProblem),i=new Map;for(let c of this.inputProblem.chips)for(let l of c.pins)i.set(l.pinId,l);let r={};for(let c of this.inputProblem.directConnections)if(c.netId){let[l,u]=c.pinIds;r[l]=c.netId,r[u]=c.netId}for(let c of this.inputProblem.netConnections)for(let l of c.pinIds)r[l]=c.netId;let s=[],o=this.inputProblem.chips.flatMap(c=>c.pins.map(l=>l.pinId)),a=new Set;for(let c of o){let l=t.getNetConnectedToId(c);l&&a.add(l)}for(let c of a){let u=t.getIdsConnectedToNet(c).filter(y=>i.has(y)),p={};for(let y of u)p[y]=new Set;for(let y of e[c]??[]){let g=y.pins[0].pinId,x=y.pins[1].pinId;p[g]&&p[x]&&(p[g].add(x),p[x].add(g))}let f=new Set;for(let y of u){if(f.has(y))continue;let g=[y],x=new Set;for(f.add(y);g.length>0;){let P=g.pop();x.add(P);for(let w of p[P]??[])f.has(w)||(f.add(w),g.push(w))}let v=(e[c]??[]).filter(P=>x.has(P.pins[0].pinId)&&x.has(P.pins[1].pinId));if(v.length>0){let P=N=>{let M=0,A=N.tracePath;for(let R=0;R<A.length-1;R++)M+=Math.abs(A[R+1].x-A[R].x)+Math.abs(A[R+1].y-A[R].y);return M},w=v[0],k=P(w);for(let N=1;N<v.length;N++){let M=P(v[N]);M>k&&(w=v[N],k=M)}let T=v.find(N=>N.userNetId!=null)?.userNetId;if(!T){for(let N of x)if(r[N]){T=r[N];break}}let I=Array.from(new Set(v.flatMap(N=>N.mspConnectionPairIds??[N.mspPairId]))),E={globalConnNetId:c,netId:T,overlappingTraces:w,mspConnectionPairIds:I};s.push(E)}else for(let P of x){let w=r[P];w&&s.push({globalConnNetId:c,netId:w,portOnlyPinId:P})}}}return s}_step(){if(this.activeSubSolver?.solved){this.netLabelPlacements.push(this.activeSubSolver.netLabelPlacement),this.activeSubSolver=null,this.currentGroup=null,this.triedAnyOrientationFallbackForCurrentGroup=!1;return}if(this.activeSubSolver?.failed){let r=["x+","x-","y+","y-"],s=this.activeSubSolver.availableOrientations,o=s.length===4&&r.every(a=>s.includes(a));if(!this.triedAnyOrientationFallbackForCurrentGroup&&!o&&this.currentGroup){this.triedAnyOrientationFallbackForCurrentGroup=!0;let a=this.currentGroup.netId?this.inputProblem.netConnections.find(c=>c.netId===this.currentGroup.netId)?.netLabelWidth:void 0;this.activeSubSolver=new xQ({inputProblem:this.inputProblem,inputTraceMap:this.inputTraceMap,overlappingSameNetTraceGroup:this.currentGroup,availableOrientations:r,netLabelWidth:a});return}this.failed=!0,this.error=this.activeSubSolver.error;return}if(this.activeSubSolver){this.activeSubSolver.step();return}let e=this.queuedOverlappingSameNetTraceGroups.shift();if(!e){this.solved=!0;return}let t=e.netId??e.globalConnNetId;this.currentGroup=e,this.triedAnyOrientationFallbackForCurrentGroup=!1;let i=this.currentGroup.netId?this.inputProblem.netConnections.find(r=>r.netId===this.currentGroup.netId)?.netLabelWidth:void 0;this.activeSubSolver=new xQ({inputProblem:this.inputProblem,inputTraceMap:this.inputTraceMap,overlappingSameNetTraceGroup:e,availableOrientations:this.inputProblem.availableNetLabelOrientations[t]??["x+","x-","y+","y-"],netLabelWidth:i})}visualize(){if(this.activeSubSolver)return this.activeSubSolver.visualize();let e=ls(this.inputProblem);for(let t of Object.values(this.inputTraceMap))e.lines.push({points:t.tracePath,strokeColor:"purple"});for(let t of this.netLabelPlacements)e.rects.push({center:t.center,width:t.width,height:t.height,fill:Os(t.globalConnNetId,.35),strokeColor:Os(t.globalConnNetId,.9)}),e.points.push({x:t.anchorPoint.x,y:t.anchorPoint.y,color:Os(t.globalConnNetId,.9)});return e}},_At=class extends Tr{constructor(e){super();d(this,"input");d(this,"output");d(this,"inputProblem");d(this,"traces");this.input=e,this.inputProblem=e.inputProblem,this.traces=e.traces,this.output={netLabelPlacements:e.netLabelPlacements,mergedLabelNetIdMap:{}}}_step(){let e=this.input.netLabelPlacements,t={};if(!e||e.length===0){this.output={netLabelPlacements:[],mergedLabelNetIdMap:{}},this.solved=!0;return}let i={};for(let s of e){if(s.pinIds.length===0)continue;let o=s.pinIds[0].split(".")[0];if(!o)continue;let a=`${o}-${s.orientation}`;a in i||(i[a]=[]),i[a].push(s)}let r=[];for(let[s,o]of Object.entries(i)){if(o.length<=1){r.push(...o);continue}let a=1/0,c=1/0,l=-1/0,u=-1/0;for(let v of o){let P=Pd(v.center,v.width,v.height);a=Math.min(a,P.minX),c=Math.min(c,P.minY),l=Math.max(l,P.maxX),u=Math.max(u,P.maxY)}let p=l-a,f=u-c,y=o[0],g=`merged-group-${s}`,x=new Set(o.map(v=>v.globalConnNetId));t[g]=x,r.push({...y,globalConnNetId:g,width:p,height:f,center:{x:a+p/2,y:c+f/2},pinIds:[...new Set(o.flatMap(v=>v.pinIds))],mspConnectionPairIds:[...new Set(o.flatMap(v=>v.mspConnectionPairIds))]})}this.output={netLabelPlacements:r,mergedLabelNetIdMap:t},this.solved=!0}getOutput(){return this.output}visualize(){let e=ls(this.inputProblem,{chipAlpha:.1,connectionAlpha:.1});e.rects||(e.rects=[]),e.lines||(e.lines=[]),e.points||(e.points=[]),e.texts||(e.texts=[]);let t=new Map;for(let i of this.input.netLabelPlacements)t.set(i.globalConnNetId,i);for(let i of this.traces){let r={points:i.tracePath.map(s=>({x:s.x,y:s.y})),strokeColor:"blue"};e.lines.push(r)}for(let i of this.output.netLabelPlacements){let r=i.globalConnNetId.startsWith("merged-group-"),s=Os(i.globalConnNetId);if(r){e.rects.push({center:i.center,width:i.width,height:i.height,fill:s.replace(/, 1\)/,", 0.2)"),stroke:s,label:i.globalConnNetId});let o=this.output.mergedLabelNetIdMap[i.globalConnNetId];if(o)for(let a of o){let c=t.get(a);if(c){let l=Pd(c.center,c.width,c.height),u={x:l.minX,y:l.minY},p={x:l.maxX,y:l.minY},f={x:l.maxX,y:l.maxY},y={x:l.minX,y:l.maxY};e.lines.push({points:[u,p,f,y,u],strokeColor:s,strokeDash:"4 4"}),e.lines.push({points:[c.center,i.center],strokeColor:s,strokeDash:"2 2"})}}}else e.rects.push({center:i.center,width:i.width,height:i.height,stroke:s,label:i.globalConnNetId})}return e}},yAt=(n,e)=>{let t=[];for(let i of n)for(let r of e){let s=Pd(r.center,r.width,r.height);for(let o=0;o<i.tracePath.length-1;o++){let a=i.tracePath[o],c=i.tracePath[o+1];if(EQ(a,c,s)){if(i.globalConnNetId===r.globalConnNetId)break;t.push({trace:i,label:r});break}}}return t},gAt=(n,e)=>{let t=s=>s.x>e.minX&&s.x<e.maxX&&s.y>e.minY&&s.y<e.maxY,i=-1,r=-1;for(let s=0;s<n.length;s++)t(n[s])&&(i===-1&&(i=s),r=s);return{firstInsideIndex:i,lastInsideIndex:r}},xAt=({initialTrace:n,firstInsideIndex:e,lastInsideIndex:t,labelBounds:i,paddingBuffer:r,detourCount:s})=>{if(e<=0||t>=n.tracePath.length-1)return[];let o=n.tracePath[e-1],a=n.tracePath[t+1],c=n.tracePath.slice(0,e),l=n.tracePath.slice(t+1),u=[];o.x!==a.x&&o.y!==a.y?(u.push([{x:a.x,y:o.y}]),u.push([{x:o.x,y:a.y}])):(o.x===a.x||o.y===a.y)&&u.push([]);let p=r+s*r,f=i.minX-p,y=i.maxX+p,g=i.maxY+p,x=i.minY-p;return(o.x<=i.minX||a.x<=i.minX)&&o.x<i.maxX&&a.x<i.maxX&&u.push([{x:f,y:o.y},{x:f,y:a.y}]),(o.x>=i.maxX||a.x>=i.maxX)&&o.x>i.minX&&a.x>i.minX&&u.push([{x:y,y:o.y},{x:y,y:a.y}]),(o.y>=i.maxY||a.y>=i.maxY)&&o.y>i.minY&&a.y>i.minY&&u.push([{x:o.x,y:g},{x:a.x,y:g}]),(o.y<=i.minY||a.y<=i.minY)&&o.y<i.maxY&&a.y<i.maxY&&u.push([{x:o.x,y:x},{x:a.x,y:x}]),u.map(v=>[...c,...v,...l])},bAt=({initialTrace:n,label:e,labelBounds:t,paddingBuffer:i,detourCount:r})=>{let s=-1;for(let p=0;p<n.tracePath.length-1;p++)if(w1(n.tracePath[p],n.tracePath[p+1],t)){s=p;break}if(s===-1)return[];let o=n.tracePath[s],a=n.tracePath[s+1];if(!o||!a)return[];let c=[],l=Pd(e.center,e.width,e.height),u=i+r*i;if(za(o,a)){let p=[l.maxX+u,l.minX-u];for(let f of p)c.push(a.y>o.y?[{x:o.x,y:l.minY-u},{x:f,y:l.minY-u},{x:f,y:l.maxY+u},{x:a.x,y:l.maxY+u}]:[{x:o.x,y:l.maxY+u},{x:f,y:l.maxY+u},{x:f,y:l.minY-u},{x:a.x,y:l.minY-u}])}else{let p=[l.maxY+u,l.minY-u];for(let f of p)c.push(a.x>o.x?[{x:l.minX-u,y:o.y},{x:l.minX-u,y:f},{x:l.maxX+u,y:f},{x:l.maxX+u,y:a.y}]:[{x:l.maxX+u,y:o.y},{x:l.maxX+u,y:f},{x:l.minX-u,y:f},{x:l.minX-u,y:a.y}])}return c.map(p=>[...n.tracePath.slice(0,s+1),...p,...n.tracePath.slice(s+1)])},S1=n=>{if(n.length<3)return n;let e=[n[0]];for(let i=1;i<n.length-1;i++){let r=e[e.length-1],s=n[i],o=n[i+1];za(r,s)&&za(s,o)||ll(r,s)&&ll(s,o)||e.push(s)}if(e.push(n[n.length-1]),e.length<3)return e;let t=[e[0]];for(let i=1;i<e.length-1;i++){let r=t[t.length-1],s=e[i],o=e[i+1];za(r,s)&&za(s,o)||ll(r,s)&&ll(s,o)||t.push(s)}return t.push(e[e.length-1]),t},vAt=({trace:n,label:e,paddingBuffer:t,detourCount:i})=>{let r={...n,tracePath:S1(n.tracePath)};if(n.globalConnNetId===e.globalConnNetId)return[r.tracePath];let s=t,o=Pd(e.center,e.width,e.height),a={minX:o.minX-s,minY:o.minY-s,maxX:o.maxX+s,maxY:o.maxY+s,chipId:`netlabel-${e.netId}`},c=bAt({initialTrace:r,label:e,labelBounds:a,paddingBuffer:t,detourCount:i}),{firstInsideIndex:l,lastInsideIndex:u}=gAt(r.tracePath,a),p=xAt({initialTrace:r,firstInsideIndex:l,lastInsideIndex:u,labelBounds:a,paddingBuffer:t,detourCount:i});return[...c,...p]},SAt=class extends Tr{constructor(e){super();d(this,"queuedCandidatePaths");d(this,"solvedTracePath",null);d(this,"initialTrace");d(this,"problem");d(this,"obstacles");d(this,"label");this.initialTrace=e.trace,this.problem=e.problem,this.label=e.label;let t=vAt({...e}),i=r=>{let s=0;for(let o=0;o<r.length-1;o++){let a=r[o+1].x-r[o].x,c=r[o+1].y-r[o].y;s+=Math.sqrt(a*a+c*c)}return s};this.queuedCandidatePaths=t.sort((r,s)=>i(r)-i(s)),this.obstacles=Ow(this.problem)}_step(){if(this.queuedCandidatePaths.length===0){this.failed=!0;return}let e=this.queuedCandidatePaths.shift(),t=S1(e);nAt(t,this.obstacles)||(this.solvedTracePath=t,this.solved=!0)}visualize(){let e=ls(this.problem,{chipAlpha:.1,connectionAlpha:.1});return e.lines||(e.lines=[]),e.rects||(e.rects=[]),e.lines.push({points:this.initialTrace.tracePath,strokeColor:"red",strokeDash:"4 4"}),e.rects.push({center:this.label.center,width:this.label.width,height:this.label.height,fill:"rgba(255, 0, 0, 0.2)"}),this.queuedCandidatePaths.length>0&&e.lines.push({points:this.queuedCandidatePaths[0],strokeColor:"orange"}),this.solvedTracePath&&e.lines.push({points:this.solvedTracePath,strokeColor:"green"}),e}},wAt=class extends Tr{constructor(e){super();d(this,"inputProblem");d(this,"netLabelPlacements");d(this,"mergedLabelNetIdMap");d(this,"allTraces");d(this,"modifiedTraces",[]);d(this,"detourCountByLabel",{});d(this,"PADDING_BUFFER",.1);d(this,"activeSubSolver",null);d(this,"overlapQueue",[]);d(this,"recentlyFailed",new Set);this.inputProblem=e.inputProblem,this.netLabelPlacements=e.netLabelPlacements,this.mergedLabelNetIdMap=e.mergedLabelNetIdMap,this.allTraces=[...e.traces]}_step(){if(this.activeSubSolver){if(this.activeSubSolver.step(),this.activeSubSolver.solved){let r=this.activeSubSolver.solvedTracePath;if(r){let s=this.allTraces.findIndex(o=>o.mspPairId===this.activeSubSolver.initialTrace.mspPairId);s!==-1&&(this.allTraces[s].tracePath=r,this.modifiedTraces.push(this.allTraces[s]))}this.activeSubSolver=null,this.recentlyFailed.clear()}else if(this.activeSubSolver.failed){let r=`${this.activeSubSolver.initialTrace.mspPairId}-${this.activeSubSolver.label.globalConnNetId}`;this.recentlyFailed.add(r),this.activeSubSolver=null}return}let e=yAt(this.allTraces,this.netLabelPlacements).filter(r=>{let s=this.mergedLabelNetIdMap[r.label.globalConnNetId];return s?!s.has(r.trace.globalConnNetId):r.trace.globalConnNetId!==r.label.globalConnNetId});if(e.length===0){this.solved=!0;return}let t=e.filter(r=>{let s=`${r.trace.mspPairId}-${r.label.globalConnNetId}`;return!this.recentlyFailed.has(s)});if(t.length===0){this.solved=!0;return}this.overlapQueue=t;let i=this.overlapQueue.shift();if(i){let r=this.allTraces.find(s=>s.mspPairId===i.trace.mspPairId);if(r){let s=i.label.globalConnNetId,o=this.detourCountByLabel[s]||0;this.detourCountByLabel[s]=o+1,this.activeSubSolver=new SAt({trace:r,label:i.label,problem:this.inputProblem,paddingBuffer:this.PADDING_BUFFER,detourCount:o})}}}getOutput(){return{allTraces:this.allTraces,modifiedTraces:this.modifiedTraces}}visualize(){if(this.activeSubSolver)return this.activeSubSolver.visualize();let e=ls(this.inputProblem);e.lines||(e.lines=[]);for(let t of this.allTraces)e.lines.push({points:t.tracePath,strokeColor:"purple"});return e}},PAt=class extends Tr{constructor(e){super();d(this,"inputProblem");d(this,"traces");d(this,"netLabelPlacements");d(this,"labelMergingSolver");d(this,"overlapAvoidanceSolver");d(this,"pipelineStepIndex",0);this.inputProblem=e.inputProblem,this.traces=e.traces,this.netLabelPlacements=e.netLabelPlacements}_step(){if(this.activeSubSolver){this.activeSubSolver.step(),this.activeSubSolver.solved?(this.activeSubSolver=null,this.pipelineStepIndex++):this.activeSubSolver.failed&&(this.failed=!0,this.activeSubSolver=null);return}switch(this.pipelineStepIndex){case 0:this.labelMergingSolver=new _At({netLabelPlacements:this.netLabelPlacements,inputProblem:this.inputProblem,traces:this.traces}),this.activeSubSolver=this.labelMergingSolver;break;case 1:this.overlapAvoidanceSolver=new wAt({inputProblem:this.inputProblem,traces:this.traces,netLabelPlacements:this.labelMergingSolver.getOutput().netLabelPlacements,mergedLabelNetIdMap:this.labelMergingSolver.getOutput().mergedLabelNetIdMap}),this.activeSubSolver=this.overlapAvoidanceSolver;break;default:this.solved=!0;break}}getOutput(){return{traces:this.overlapAvoidanceSolver?.getOutput().allTraces??this.traces,netLabelPlacements:this.labelMergingSolver?.getOutput().netLabelPlacements??this.netLabelPlacements}}visualize(){if(this.activeSubSolver)return this.activeSubSolver.visualize();let e=ls(this.inputProblem);e.lines||(e.lines=[]),e.rects||(e.rects=[]);let t=this.getOutput();for(let i of t.traces)e.lines.push({points:i.tracePath,strokeColor:"purple"});for(let i of t.netLabelPlacements){let r=Os(i.globalConnNetId,.3);e.rects.push({center:i.center,width:i.width,height:i.height,fill:r,stroke:r.replace("0.3","1"),label:i.globalConnNetId})}return e}},kAt=n=>{for(let e of n.chips){let t=bA(e);for(let i of e.pins){if(!(i.x>t.minX&&i.x<t.maxX&&i.y>t.minY&&i.y<t.maxY))continue;let s=i.x-t.minX,o=t.maxX-i.x,a=i.y-t.minY,c=t.maxY-i.y,l=Math.min(s,o,a,c);l===s?i.x=t.minX:l===o?i.x=t.maxX:l===a?i.y=t.minY:i.y=t.maxY,i._facingDirection=void 0}}},TAt=n=>{for(let e of n.chips){let t=e.width/2,i=e.height/2,r=0,s=0;for(let c of e.pins){let l=Math.abs(c.x-e.center.x),u=Math.abs(c.y-e.center.y);l>r&&(r=l),u>s&&(s=u)}let o=Math.max(t,r),a=Math.max(i,s);if(o>t||a>i){e.width=o*2,e.height=a*2;for(let c of e.pins)c._facingDirection=void 0}}};function EAt(n,e){for(let t=0;t<n.length-1;t++){let i=n[t],r=n[t+1];for(let s of e)for(let o=0;o<s.tracePath.length-1;o++){let a=s.tracePath[o],c=s.tracePath[o+1];if(Ti(i,r,a,c))return!0}}return!1}var MAt=3,CAt=(n,e)=>Math.sqrt(Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2)),IAt=class extends Tr{constructor(e){super();d(this,"solvedLongDistanceTraces",[]);d(this,"queuedCandidatePairs",[]);d(this,"currentCandidatePair",null);d(this,"subSolver",null);d(this,"chipMap",{});d(this,"inputProblem");d(this,"netConnMap");d(this,"newlyConnectedPinIds",new Set);d(this,"allSolvedTraces",[]);this.params=e;let{inputProblem:t,primaryMspConnectionPairs:i,alreadySolvedTraces:r}=this.params;this.inputProblem=t,this.allSolvedTraces=[...r];let s=new Set;for(let u of i)s.add(u.pins[0].pinId),s.add(u.pins[1].pinId);let{netConnMap:o}=xA(t);this.netConnMap=o;let a=new Map;for(let u of t.chips){this.chipMap[u.chipId]=u;for(let p of u.pins)a.set(p.pinId,{...p,chipId:u.chipId})}let c=[],l=new Set;for(let u of Object.keys(o.netMap)){let p=o.getIdsConnectedToNet(u);if(p.length<2)continue;let f=p.filter(y=>!s.has(y));for(let y of f){let g=a.get(y);if(!g)continue;let x=p.filter(v=>v!==y).flatMap(v=>{let P=a.get(v);return P?[{pin:P,distance:CAt(g,P)}]:[]}).sort((v,P)=>v.distance-P.distance).slice(0,MAt);for(let v of x){let P=[g,v.pin],w=P.map(k=>k.pinId).sort().join("--");l.has(w)||(c.push(P),l.add(w))}}}this.queuedCandidatePairs=c}getConstructorParams(){return this.params}_step(){if(this.subSolver?.solved){let e=this.subSolver.solvedTracePath;if(e&&this.currentCandidatePair&&!EAt(e,this.allSolvedTraces)){let[i,r]=this.currentCandidatePair,s=this.netConnMap.getNetConnectedToId(i.pinId),o=`${i.pinId}-${r.pinId}`,a={mspPairId:o,dcConnNetId:s,globalConnNetId:s,pins:[i,r],tracePath:e,mspConnectionPairIds:[o],pinIds:[i.pinId,r.pinId]};this.solvedLongDistanceTraces.push(a),this.allSolvedTraces.push(a),this.newlyConnectedPinIds.add(i.pinId),this.newlyConnectedPinIds.add(r.pinId)}this.subSolver=null,this.currentCandidatePair=null}else this.subSolver?.failed&&(this.subSolver=null,this.currentCandidatePair=null);if(this.subSolver){this.subSolver.step();return}for(;this.queuedCandidatePairs.length>0;){let e=this.queuedCandidatePairs.shift(),[t,i]=e;if(!(this.newlyConnectedPinIds.has(t.pinId)||this.newlyConnectedPinIds.has(i.pinId))){this.currentCandidatePair=e,this.subSolver=new TQ({inputProblem:this.params.inputProblem,pins:this.currentCandidatePair,chipMap:this.chipMap});return}}this.solved=!0}visualize(){if(this.subSolver)return this.subSolver.visualize();let e=ls(this.inputProblem);for(let t of this.solvedLongDistanceTraces)e.lines.push({points:t.tracePath,strokeColor:"purple"});for(let[t,i]of this.queuedCandidatePairs)e.lines.push({points:[t,i],strokeColor:"gray",strokeDash:"4 4"});return e}getOutput(){return this.solved?{newTraces:this.solvedLongDistanceTraces,allTracesMerged:[...this.params.alreadySolvedTraces,...this.solvedLongDistanceTraces]}:{newTraces:[],allTracesMerged:this.params.alreadySolvedTraces}}},dA=(n,e)=>{for(let t=0;t<n.length-1;t++){let i=n[t],r=n[t+1];for(let s of e){let o={center:{x:s.minX+(s.maxX-s.minX)/2,y:s.minY+(s.maxY-s.minY)/2},width:s.maxX-s.minX,height:s.maxY-s.minY};if(bS(i,r,o)<=0)return!0}}return!1},fA=n=>{let e=0;for(let t=1;t<n.length-1;t++){let i=n[t-1],r=n[t],s=n[t+1],o=i.x===r.x,a=r.x===s.x;o!==a&&e++}return e},vQ=(n,e)=>{let t=[];return n.x===e.x||n.y===e.y?t.push([n,e]):(t.push([n,{x:e.x,y:n.y},e]),t.push([n,{x:n.x,y:e.y},e])),t},mA=(n,e)=>{for(let t=0;t<n.length-1;t++){let i=n[t],r=n[t+1];for(let s of e)if(w1(i,r,s))return!0}return!1},NAt=(n,e)=>{if(e>=n.length-3)return-1;let t=e,i=!0;for(let r=e;r<n.length-2&&r<e+10&&!(r+2>=n.length);r++){let s=n[r],o=n[r+1],a=n[r+2],c=s.x===o.x,l=o.x===a.x;if(c===l)break;let u=Math.sign(c?o.y-s.y:o.x-s.x);if(r>e){let p=n[r-1],f=p.x===s.x,y=Math.sign(f?s.y-p.y:s.x-p.x);if(c&&f&&u!==y||!c&&!f&&u!==y){i=!1;break}}t=r+2}return i&&t-e>=3?t:-1},R_=(n,e,t)=>{if(t.length<2)return!1;let i=t[0],r=t[t.length-1];return n.x===i.x&&n.y===i.y&&e.x===t[1].x&&e.y===t[1].y||n.x===t[t.length-2].x&&n.y===t[t.length-2].y&&e.x===r.x&&e.y===r.y},AAt=({path:n,obstacles:e,labelBounds:t,originalPath:i})=>{if(n.length<=2)return n;let r=[...n],s=fA(r),o=!0;for(;o;){o=!1;for(let c=0;c<r.length-3;c++){let l=NAt(r,c);if(l>0){if(R_(r[c],r[c+1],i)||R_(r[l-1],r[l],i))continue;let u=r[c],p=r[l],f=vQ(u,p);for(let y of f){let g=[...r.slice(0,c+1),...y.slice(1,-1),...r.slice(l)],x=dA(y,e),v=mA(y,t);if(!x&&!v){let P=fA(g);r=g,s=P,o=!0;break}}if(o)break}}if(!o)for(let c=0;c<r.length-2;c++){let l=Math.min(r.length-c-2,r.length-2);for(let u=1;u<=l;u++){let p=c+u+1;if(p>=r.length||R_(r[c],r[c+1],i)||R_(r[p-1],r[p],i))continue;let f=r[c],y=r[p],g=vQ(f,y);for(let x of g){let v=[...r.slice(0,c+1),...x.slice(1,-1),...r.slice(p)],P=x,w=dA(P,e),k=mA(P,t);if(!w&&!k){let T=fA(v);if(T<s||T===s&&v.length<r.length){r=v,s=T,o=!0;break}}}if(o)break}if(o)break}if(!o)for(let c=0;c<r.length-2;c++){let l=r[c],u=r[c+1],p=r[c+2];if(R_(l,u,i)||R_(u,p,i))continue;let f=l.x===u.x&&u.x===p.x,y=l.y===u.y&&u.y===p.y;if(f||y){let g=[...r.slice(0,c+1),...r.slice(c+2)],x=dA([l,p],e),v=mA([l,p],t);if(!x&&!v){r=g,o=!0;break}}}}return S1(r)},RAt=({targetMspConnectionPairId:n,traces:e,inputProblem:t,allLabelPlacements:i,mergedLabelNetIdMap:r,paddingBuffer:s})=>{let o=e.find(w=>w.mspPairId===n);if(!o)throw new Error(`Target trace ${n} not found`);let a=e.filter(w=>w.mspPairId!==n),c=.01,l=a.flatMap((w,k)=>w.tracePath.slice(0,-1).map((T,I)=>{let E=w.tracePath[I+1];return{chipId:`trace-obstacle-${k}-${I}`,minX:Math.min(T.x,E.x)-c/2,minY:Math.min(T.y,E.y)-c/2,maxX:Math.max(T.x,E.x)+c/2,maxY:Math.max(T.y,E.y)+c/2}})),u=Ow(t),p=.01,y=[...u.map(w=>({...w,minX:w.minX-p,minY:w.minY-p,maxX:w.maxX+p,maxY:w.maxY+p})),...l],g=o.tracePath,v=i.filter(w=>{let k=r[w.globalConnNetId];return k?!k.has(o.globalConnNetId):w.globalConnNetId!==o.globalConnNetId}).map(w=>({minX:w.center.x-w.width/2-s,maxX:w.center.x+w.width/2+s,minY:w.center.y-w.height/2-s,maxY:w.center.y+w.height/2+s})),P=AAt({path:g,obstacles:y,labelBounds:v,originalPath:g});return{...o,tracePath:P}},OAt=({targetMspConnectionPairId:n,traces:e,inputProblem:t,allLabelPlacements:i,mergedLabelNetIdMap:r,paddingBuffer:s})=>{let o=e.find(w=>w.mspPairId===n);if(!o)throw new Error(`Target trace ${n} not found`);let a=1e-5,c=e.filter(w=>w.mspPairId!==n),l=.01,u=c.flatMap((w,k)=>w.tracePath.slice(0,-1).map((T,I)=>{let E=w.tracePath[I+1];return{chipId:`trace-obstacle-${k}-${I}`,minX:Math.min(T.x,E.x)-l/2,minY:Math.min(T.y,E.y)-l/2,maxX:Math.max(T.x,E.x)+l/2,maxY:Math.max(T.y,E.y)+l/2}})),f=[...Ow(t).map(w=>({...w,minX:w.minX+a,maxX:w.maxX-a,minY:w.minY+a,maxY:w.maxY-a})),...u],y=(w,k,T)=>{for(let I of T)if(w1(w,k,I))return!0;return!1},x=i.filter(w=>{let k=r[w.globalConnNetId];return k?!k.has(o.globalConnNetId):w.globalConnNetId!==o.globalConnNetId}).map(w=>({minX:w.center.x-w.width/2+a,maxX:w.center.x+w.width/2-a,minY:w.center.y-w.height/2+a,maxY:w.center.y+w.height/2-a})),v=[...o.tracePath];if(v.length<4)return{...o};if(v.length===4){let[w,k,T,I]=v,E,N;if(w.y===k.y&&k.x===T.x&&T.y===I.y){let R=(w.x+I.x)/2;E={x:R,y:k.y},N={x:R,y:T.y}}else{let R=(w.y+I.y)/2;E={x:k.x,y:R},N={x:T.x,y:R}}return y(w,E,f)||y(E,N,f)||y(N,I,f)||y(w,E,x)||y(E,N,x)||y(N,I,x)||(v[1]=E,v[2]=N),{...o,tracePath:S1(v)}}for(let w=1;w<v.length-4;w++){let k=v[w],T=v[w+1],I=v[w+2],E=v[w+3],N=k.y===T.y&&T.x===I.x&&I.y===E.y,M=k.x===T.x&&T.y===I.y&&I.x===E.x,A=k.y===T.y&&T.y===I.y&&I.y===E.y,R=k.x===T.x&&T.x===I.x&&I.x===E.x,j=A||R,B=!1;if(N?B=Math.sign(T.x-k.x)===Math.sign(E.x-I.x):M&&(B=Math.sign(T.y-k.y)===Math.sign(E.y-I.y)),!((N||M)&&!j&&B))continue;let U,H,tt=Math.abs(N?k.x-T.x:k.y-T.y),et=Math.abs(N?I.x-E.x:I.y-E.y);if(Math.abs(tt-et)<.001)continue;if(N){let V=(k.x+E.x)/2;U={x:V,y:T.y},H={x:V,y:I.y}}else{let V=(k.y+E.y)/2;U={x:T.x,y:V},H={x:I.x,y:V}}y(k,U,f)||y(U,H,f)||y(H,E,f)||y(k,U,x)||y(U,H,x)||y(H,E,x)||(v[w+1]=U,v[w+2]=H,w=0)}let P=S1(v);return{...o,tracePath:P}},LAt=n=>{let e=[];if(n.length<3)return e;for(let t=0;t<n.length-2;t++){let i=n[t],r=n[t+1],s=n[t+2],o=r.x-i.x,a=r.y-i.y,c=s.x-r.x,l=s.y-r.y;(o===0&&l===0&&a!==0&&c!==0||a===0&&c===0&&o!==0&&l!==0)&&o*o+a*a>=.25&&c*c+l*l>=.25&&e.push({p1:i,p2:r,p3:s})}return e},FAt=(n,e)=>{let t=[];for(let i of n)i.mspPairId!==e&&t.push({points:i.tracePath});return t},SQ=(n,e,t)=>{let i=[];for(let r of t){let s=r.points;for(let o=0;o<s.length-1;o++){let a=s[o],c=s[o+1];if(!a||!c)continue;let l=rd(n,e,a,c);l&&i.push(l)}}return i},Fa=1e-6,al=(n,e,t=Fa)=>Math.abs(n.x-e.x)<t,zAt=({lShape:n,rectangle:e,padding:t=.5,interactionPoint1:i,interactionPoint2:r})=>{let{p1:s,p2:o,p3:a}=n,{x:c,y:l,width:u,height:p}=e,f,y=i,g=r;if(Math.abs(o.x-c)<Fa&&Math.abs(o.y-(l+p))<Fa)f={x:c+u+t,y:l-t},al(s,o)?y={x:i.x,y:i.y-t}:y={x:i.x+t,y:i.y},al(o,a)?g={x:r.x,y:r.y-t}:g={x:r.x+t,y:r.y};else if(Math.abs(o.x-(c+u))<Fa&&Math.abs(o.y-(l+p))<Fa)f={x:c-t,y:l-t},al(s,o)?y={x:i.x,y:i.y-t}:y={x:i.x-t,y:i.y},al(o,a)?g={x:r.x,y:r.y-t}:g={x:r.x-t,y:r.y};else if(Math.abs(o.x-c)<Fa&&Math.abs(o.y-l)<Fa)f={x:c+u+t,y:l+p+t},al(s,o)?y={x:i.x,y:i.y+t}:y={x:i.x+t,y:i.y},al(o,a)?g={x:r.x,y:r.y+t}:g={x:r.x+t,y:r.y};else if(Math.abs(o.x-(c+u))<Fa&&Math.abs(o.y-l)<Fa)f={x:c-t,y:l+p+t},al(s,o)?y={x:i.x,y:i.y+t}:y={x:i.x-t,y:i.y},al(o,a)?g={x:r.x,y:r.y+t}:g={x:r.x-t,y:r.y};else return[];return[[y,f,g]]},$At=(n,e,t)=>{if(n.length<2)return{isColliding:!1};for(let i=0;i<n.length-1;i++){let r=n[i],s=n[i+1];for(let o of e)if(o.mspPairId!==t)for(let a=0;a<o.tracePath.length-1;a++){let c=o.tracePath[a],l=o.tracePath[a+1],u=rd(r,s,c,l);if(u)return{isColliding:!0,collidingTraceId:o.mspPairId,collisionPoint:u}}}return{isColliding:!1}},DAt=(n,e)=>{let t=[];for(let i of n)for(let r of e){let s=Math.min(i.x,r.x),o=Math.min(i.y,r.y),a=Math.max(i.x,r.x),c=Math.max(i.y,r.y),l=a-s,u=c-o;l>1e-6&&u>1e-6&&t.push({rect:{x:s,y:o,width:l,height:u},i1:i,i2:r})}return t},Rw=n=>{let e={circles:[],lines:[]},t=Array.isArray(n)?n:[n];for(let i of t)e.circles.push({center:{x:i.p2.x,y:i.p2.y},radius:.01,fill:"blue"}),e.lines.push({points:[i.p1,i.p2,i.p3],strokeColor:"lightblue"});return e},wQ=(n,e="red")=>{let t={circles:[]};for(let i of n)t.circles.push({center:{x:i.x,y:i.y},radius:.01,fill:e});return t},PQ=n=>{let e={rects:[]};return e.rects.push({center:{x:n.x+n.width/2,y:n.y+n.height/2},width:n.width,height:n.height,stroke:"green"}),e},jAt=(n,e="gray",t=[])=>{let i={lines:[],circles:[]};for(let r of n)i.lines.push({points:r,strokeColor:e});for(let r of t)i.circles.push({center:r,radius:.01,fill:"green"});return i},_A=n=>{let e={lines:[],points:[],rects:[],circles:[],texts:[]};for(let t of n)t&&(t.lines&&e.lines.push(...t.lines),t.points&&e.points.push(...t.points),t.rects&&e.rects.push(...t.rects),t.circles&&e.circles.push(...t.circles),t.texts&&e.texts.push(...t.texts));return e},BAt=n=>{let e={circles:[]};return n?.isColliding&&n.collisionPoint&&e.circles.push({center:n.collisionPoint,radius:.01,fill:"red"}),e},YAt=class extends Tr{constructor(e){super();d(this,"input");d(this,"lShapesToProcess",[]);d(this,"visualizationMode","l_shapes");d(this,"currentLShape",null);d(this,"intersectionPoints",[]);d(this,"tightRectangle",null);d(this,"candidates",[]);d(this,"bestRoute",null);d(this,"lastCollision",null);d(this,"collidingCandidate",null);d(this,"rectangleCandidates",[]);d(this,"currentRectangleIndex",0);d(this,"isInitialStep",!0);d(this,"currentCandidateIndex",0);d(this,"lShapeProcessingStep","idle");d(this,"lShapeJustProcessed",!1);d(this,"bestRouteFound",null);this.input=e,this.visualizationMode="l_shapes";for(let t of this.input.allTraces){let i=LAt(t.tracePath);this.lShapesToProcess.push(...i.map(r=>({...r,traceId:t.mspPairId})))}}_step(){if(this.isInitialStep){this.isInitialStep=!1;return}if(this.lShapeJustProcessed){this._resetAfterLShapProcessing();return}if(this.lShapesToProcess.length===0&&this.currentLShape===null){this.solved=!0;return}switch(this.lShapeProcessingStep){case"idle":this._handleIdleStep();break;case"intersections":this._handleIntersectionsStep();break;case"rectangle_selection":this._handleRectangleSelectionStep();break;case"candidate_evaluation":this._handleCandidateEvaluationStep();break}}_resetAfterLShapProcessing(){this.lShapeProcessingStep="idle",this.currentLShape=null,this.currentCandidateIndex=0,this.lShapeJustProcessed=!1,this.visualizationMode="l_shapes",this.intersectionPoints=[],this.tightRectangle=null,this.candidates=[],this.bestRoute=null,this.lastCollision=null,this.collidingCandidate=null}_handleIdleStep(){if(this.currentLShape=this.lShapesToProcess.shift(),!this.currentLShape){this.solved=!0;return}this.lShapeProcessingStep="intersections",this.visualizationMode="l_shapes"}_handleIntersectionsStep(){if(!this.currentLShape.traceId){this.lShapeProcessingStep="idle";return}let e=FAt(this.input.allTraces,this.currentLShape.traceId),t=SQ(this.currentLShape.p1,this.currentLShape.p2,e),i=SQ(this.currentLShape.p2,this.currentLShape.p3,e);if(this.intersectionPoints=[...t,...i],t.length===0||i.length===0){this.lShapeProcessingStep="idle";return}this.rectangleCandidates=DAt(t,i),this.currentRectangleIndex=0,this.lShapeProcessingStep="rectangle_selection"}_handleRectangleSelectionStep(){if(this.currentRectangleIndex>=this.rectangleCandidates.length){this.lShapeProcessingStep="idle";return}let{rect:e,i1:t,i2:i}=this.rectangleCandidates[this.currentRectangleIndex];this.tightRectangle=e,this.candidates=zAt({lShape:this.currentLShape,rectangle:this.tightRectangle,padding:2*this.input.paddingBuffer,interactionPoint1:t,interactionPoint2:i}),this.currentCandidateIndex=0,this.lastCollision=null,this.collidingCandidate=null,this.visualizationMode="candidates",this.lShapeProcessingStep="candidate_evaluation"}_handleCandidateEvaluationStep(){if(this.visualizationMode="candidates",this.bestRouteFound){this._applyBestRoute(this.bestRouteFound),this.bestRouteFound=null;return}if(this.currentCandidateIndex>=this.candidates.length){this.currentRectangleIndex++,this.lShapeProcessingStep="rectangle_selection";return}let e=this.candidates[this.currentCandidateIndex],t=$At(e,this.input.allTraces,this.currentLShape.traceId);t?.isColliding?(this.lastCollision=t,this.collidingCandidate=e,this.currentCandidateIndex++):(this.bestRouteFound=e,this.lastCollision=null,this.collidingCandidate=null)}_applyBestRoute(e){this.bestRoute=e,this.collidingCandidate=null,this.lastCollision=null;let t=this.input.allTraces.findIndex(i=>i.mspPairId===this.currentLShape.traceId);if(t!==-1){let i=this.input.allTraces[t],r=i.tracePath.findIndex(s=>s.x===this.currentLShape.p2.x&&s.y===this.currentLShape.p2.y);if(r!==-1){let s=[...i.tracePath.slice(0,r),...e,...i.tracePath.slice(r+1)];this.input.allTraces[t]={...i,tracePath:s},this.lShapesToProcess=this.lShapesToProcess.filter(o=>o.traceId!==this.currentLShape.traceId)}}this.lShapeJustProcessed=!0}getOutput(){return{traces:this.input.allTraces}}visualize(){switch(this.visualizationMode){case"l_shapes":return Rw(this.lShapesToProcess);case"intersection_points":return _A([this.currentLShape?Rw(this.currentLShape):void 0,wQ(this.intersectionPoints)]);case"tight_rectangle":return _A([this.currentLShape?Rw(this.currentLShape):void 0,wQ(this.intersectionPoints),this.tightRectangle?PQ(this.tightRectangle):void 0]);case"candidates":{if(this.lShapeJustProcessed){let i={lines:[]};for(let r of this.input.allTraces){let s=r.mspPairId===this.currentLShape?.traceId;for(let o=0;o<r.tracePath.length-1;o++)i.lines.push({points:[r.tracePath[o],r.tracePath[o+1]],strokeColor:s?"green":"#ccc"})}return i}let e={lines:[]};for(let i of this.input.allTraces)for(let r=0;r<i.tracePath.length-1;r++)e.lines.push({points:[i.tracePath[r],i.tracePath[r+1]],strokeColor:"#ccc"});let t;return this.bestRouteFound?t=this.bestRouteFound:this.lastCollision?.isColliding?t=this.collidingCandidate??void 0:this.currentCandidateIndex<this.candidates.length&&(t=this.candidates[this.currentCandidateIndex]),_A([e,this.currentLShape?Rw(this.currentLShape):void 0,this.tightRectangle?PQ(this.tightRectangle):void 0,t?jAt([t],this.bestRouteFound?"green":"blue",this.intersectionPoints):void 0,this.lastCollision?BAt(this.lastCollision):void 0])}default:return{}}}},XAt=n=>{if(n.length!==4)return!1;let[e,t,i,r]=n,s=e.y===t.y&&t.x===i.x&&i.y===r.y&&e.x===r.x,o=e.x===t.x&&t.y===i.y&&i.x===r.x&&e.y===r.y;return s||o},UAt=class extends Tr{constructor(e){super();d(this,"input");d(this,"outputTraces");d(this,"traceIdQueue");d(this,"tracesMap");d(this,"pipelineStep","untangling_traces");d(this,"activeTraceId",null);d(this,"activeSubSolver",null);this.input=e,this.outputTraces=[...e.allTraces],this.tracesMap=new Map(this.outputTraces.map(t=>[t.mspPairId,t])),this.traceIdQueue=Array.from(e.allTraces.map(t=>t.mspPairId))}_step(){if(this.activeSubSolver){if(this.activeSubSolver.step(),this.activeSubSolver.solved){let e=this.activeSubSolver.getOutput();this.outputTraces=e.traces,this.tracesMap=new Map(this.outputTraces.map(t=>[t.mspPairId,t])),this.activeSubSolver=null,this.pipelineStep="minimizing_turns"}else this.activeSubSolver.failed&&(this.activeSubSolver=null,this.pipelineStep="minimizing_turns");return}switch(this.pipelineStep){case"untangling_traces":this._runUntangleTracesStep();break;case"minimizing_turns":this._runMinimizeTurnsStep();break;case"balancing_l_shapes":this._runBalanceLShapesStep();break}}_runUntangleTracesStep(){this.activeSubSolver=new YAt({...this.input,allTraces:Array.from(this.tracesMap.values())})}_runMinimizeTurnsStep(){if(this.traceIdQueue.length===0){this.pipelineStep="balancing_l_shapes",this.traceIdQueue=Array.from(this.input.allTraces.map(e=>e.mspPairId));return}this._processTrace("minimizing_turns")}_runBalanceLShapesStep(){if(this.traceIdQueue.length===0){this.solved=!0;return}this._processTrace("balancing_l_shapes")}_processTrace(e){let t=this.traceIdQueue.shift();this.activeTraceId=t;let i=this.tracesMap.get(t);if(XAt(i.tracePath))return;let r=Array.from(this.tracesMap.values()),s;e==="minimizing_turns"?s=RAt({...this.input,targetMspConnectionPairId:t,traces:r}):s=OAt({...this.input,targetMspConnectionPairId:t,traces:r}),this.tracesMap.set(t,s),this.outputTraces=Array.from(this.tracesMap.values())}getOutput(){return{traces:this.outputTraces}}visualize(){if(this.activeSubSolver)return this.activeSubSolver.visualize();let e=ls(this.input.inputProblem,{chipAlpha:.1,connectionAlpha:.1});e.lines||(e.lines=[]),e.points||(e.points=[]),e.rects||(e.rects=[]),e.circles||(e.circles=[]),e.texts||(e.texts=[]);for(let t of this.outputTraces){let i={points:t.tracePath.map(r=>({x:r.x,y:r.y})),strokeColor:t.mspPairId===this.activeTraceId?"red":"blue"};e.lines.push(i)}return e}};function cl(n,e,t,i={}){return{solverName:n,solverClass:e,getConstructorParams:t,onSolved:i.onSolved,shouldSkip:i.shouldSkip}}var IQ=class extends Tr{constructor(e){super();d(this,"mspConnectionPairSolver");d(this,"schematicTraceLinesSolver");d(this,"longDistancePairSolver");d(this,"traceOverlapShiftSolver");d(this,"netLabelPlacementSolver");d(this,"labelMergingSolver");d(this,"traceLabelOverlapAvoidanceSolver");d(this,"traceCleanupSolver");d(this,"startTimeOfPhase");d(this,"endTimeOfPhase");d(this,"timeSpentOnPhase");d(this,"firstIterationOfPhase");d(this,"inputProblem");d(this,"pipelineDef",[cl("mspConnectionPairSolver",QNt,()=>[{inputProblem:this.inputProblem}],{onSolved:e=>{}}),cl("schematicTraceLinesSolver",aAt,()=>[{mspConnectionPairs:this.mspConnectionPairSolver.mspConnectionPairs,dcConnMap:this.mspConnectionPairSolver.dcConnMap,globalConnMap:this.mspConnectionPairSolver.globalConnMap,inputProblem:this.inputProblem,chipMap:this.mspConnectionPairSolver.chipMap}]),cl("longDistancePairSolver",IAt,e=>[{inputProblem:e.inputProblem,primaryMspConnectionPairs:e.mspConnectionPairSolver.mspConnectionPairs,alreadySolvedTraces:e.schematicTraceLinesSolver.solvedTracePaths}],{onSolved:e=>{}}),cl("traceOverlapShiftSolver",uAt,()=>[{inputProblem:this.inputProblem,inputTracePaths:this.longDistancePairSolver?.getOutput().allTracesMerged,globalConnMap:this.mspConnectionPairSolver.globalConnMap}],{onSolved:e=>{}}),cl("netLabelPlacementSolver",bQ,()=>[{inputProblem:this.inputProblem,inputTraceMap:this.traceOverlapShiftSolver?.correctedTraceMap??Object.fromEntries(this.longDistancePairSolver.getOutput().allTracesMerged.map(e=>[e.mspPairId,e]))}],{onSolved:e=>{}}),cl("traceLabelOverlapAvoidanceSolver",PAt,e=>{let t=e.traceOverlapShiftSolver?.correctedTraceMap??Object.fromEntries(e.longDistancePairSolver.getOutput().allTracesMerged.map(s=>[s.mspPairId,s])),i=Object.values(t),r=e.netLabelPlacementSolver.netLabelPlacements;return[{inputProblem:e.inputProblem,traces:i,netLabelPlacements:r}]}),cl("traceCleanupSolver",UAt,e=>{let i=e.traceLabelOverlapAvoidanceSolver.getOutput().traces,r=e.traceLabelOverlapAvoidanceSolver.labelMergingSolver.getOutput();return[{inputProblem:e.inputProblem,allTraces:i,allLabelPlacements:r.netLabelPlacements,mergedLabelNetIdMap:r.mergedLabelNetIdMap,paddingBuffer:.1}]}),cl("netLabelPlacementSolver",bQ,e=>{let t=e.traceCleanupSolver?.getOutput().traces??e.traceLabelOverlapAvoidanceSolver.getOutput().traces;return[{inputProblem:e.inputProblem,inputTraceMap:Object.fromEntries(t.map(i=>[i.mspPairId,i]))}]})]);d(this,"currentPipelineStepIndex",0);this.inputProblem=this.cloneAndCorrectInputProblem(e),this.MAX_ITERATIONS=1e6,this.startTimeOfPhase={},this.endTimeOfPhase={},this.timeSpentOnPhase={},this.firstIterationOfPhase={}}getConstructorParams(){return this.inputProblem}cloneAndCorrectInputProblem(e){let t=structuredClone({...e,_chipObstacleSpatialIndex:void 0});return TAt(t),kAt(t),t}_step(){let e=this.pipelineDef[this.currentPipelineStepIndex];if(!e){this.solved=!0;return}if(this.activeSubSolver){this.activeSubSolver.step(),this.activeSubSolver.solved?(this.endTimeOfPhase[e.solverName]=performance.now(),this.timeSpentOnPhase[e.solverName]=this.endTimeOfPhase[e.solverName]-this.startTimeOfPhase[e.solverName],e.onSolved?.(this),this.activeSubSolver=null,this.currentPipelineStepIndex++):this.activeSubSolver.failed&&(this.error=this.activeSubSolver?.error,this.failed=!0,this.activeSubSolver=null);return}let t=e.getConstructorParams(this);this.activeSubSolver=new e.solverClass(...t),this[e.solverName]=this.activeSubSolver,this.timeSpentOnPhase[e.solverName]=0,this.startTimeOfPhase[e.solverName]=performance.now(),this.firstIterationOfPhase[e.solverName]=this.iterations}solveUntilPhase(e){for(;this.getCurrentPhase().toLowerCase()!==e.toLowerCase();)this.step()}getCurrentPhase(){return this.pipelineDef[this.currentPipelineStepIndex]?.solverName??"none"}visualize(){if(!this.solved&&this.activeSubSolver)return this.activeSubSolver.visualize();let e=[ls(this.inputProblem),...this.pipelineDef.map(i=>this[i.solverName]?.visualize()).filter(Boolean).map((i,r)=>{for(let s of i.rects??[])s.step=r;for(let s of i.points??[])s.step=r;for(let s of i.circles??[])s.step=r;for(let s of i.texts??[])s.step=r;for(let s of i.lines??[])s.step=r;return i})];return e.length===1?e[0]:{points:e.flatMap(i=>i.points||[]),rects:e.flatMap(i=>i.rects||[]),lines:e.flatMap(i=>i.lines||[]),circles:e.flatMap(i=>i.circles||[]),texts:e.flatMap(i=>i.texts||[])}}preview(){return this.activeSubSolver?this.activeSubSolver.preview():super.preview()}};var unt=Gt(Mn(),1);var pnt=Gt(Mn(),1);var hnt=Gt(Mn(),1);ir();Ae();var VAt=n=>{let e=[];e.push(n.title),n.models.size>0&&e.push(...Array.from(n.models.values()));for(let t of n.components)e.push(t.toSpiceString());for(let t of n.subcircuits)e.push(t.toSpiceString());return n.printStatements.length>0&&e.push(...n.printStatements),n.controls.length>0&&(e.push(".control"),e.push(...n.controls),e.push(".endc")),n.tranCommand&&!e.some(t=>t.trim().toLowerCase().startsWith(".tran"))&&e.push(n.tranCommand),e.push(".END"),e.join(`
`)},GAt=class{constructor(n="Circuit Netlist"){d(this,"title");d(this,"components");d(this,"nodes");d(this,"controls");d(this,"subcircuits");d(this,"models");d(this,"tranCommand");d(this,"printStatements");this.title=n,this.components=[],this.nodes=new Set,this.controls=[],this.subcircuits=[],this.models=new Map,this.tranCommand=null,this.printStatements=[]}addComponent(n){this.components.push(n);for(let e of n.nodes)this.nodes.add(e)}addSubcircuit(n){this.subcircuits.find(e=>e.name===n.name)||this.subcircuits.push(n)}toSpiceString(){return VAt(this)}},$a=class{constructor(n,e,t){d(this,"name");d(this,"command");d(this,"nodes");this.name=n,this.command=e,this.nodes=t}toSpiceString(){return this.command.toSpiceString()}},HAt=class{constructor(n){d(this,"commandName","resistor");d(this,"props");this.props=n}toSpiceString(){let{name:n,positiveNode:e,negativeNode:t,model:i,value:r}=this.props,s=`R${n} ${e} ${t}`;return i&&(s+=` ${i}`),s+=` ${r}`,s}},WAt=class{constructor(n){d(this,"commandName","capacitor");d(this,"props");this.props=n}toSpiceString(){let{name:n,positiveNode:e,negativeNode:t,modelName:i,value:r,initialCondition:s}=this.props,o=`C${n} ${e} ${t}`;return i&&(o+=` ${i}`),o+=` ${r}`,s&&(o+=` IC=${s}`),o}},SA=class{constructor(n){d(this,"commandName","voltage_source");d(this,"props");this.props=n}toSpiceString(){let{name:n,positiveNode:e,negativeNode:t,value:i,acMagnitude:r,acPhase:s}=this.props,o=`V${n} ${e} ${t}`;return i&&(o+=` ${i}`),r&&(o+=` AC ${r}`,s&&(o+=` ${s}`)),o}},qAt=class{constructor(n){d(this,"commandName","diode");d(this,"props");this.props=n}toSpiceString(){let{name:n,positiveNode:e,negativeNode:t,model:i,area:r}=this.props,s=`D${n} ${e} ${t} ${i}`;return r&&(s+=` ${r}`),s}},ZAt=class{constructor(n){d(this,"commandName","inductor");d(this,"props");this.props=n}toSpiceString(){let{name:n,positiveNode:e,negativeNode:t,model:i,value:r,initialCondition:s}=this.props,o=`L${n} ${e} ${t}`;return i&&(o+=` ${i}`),o+=` ${r}`,s&&(o+=` IC=${s}`),o}},NQ=class{constructor(n){d(this,"commandName","voltage_controlled_switch");d(this,"props");this.props=n}toSpiceString(){let{name:n,positiveNode:e,negativeNode:t,positiveControl:i,negativeControl:r,model:s}=this.props;return`S${n} ${e} ${t} ${i} ${r} ${s}`}};function AQ(n){let e=new GAt("* Circuit JSON to SPICE Netlist"),t=Me(n).source_component.list(),i=Me(n).source_port.list(),r=Me(n).source_trace.list(),s=n.filter(k=>k.type==="simulation_voltage_probe"),o=n.filter(k=>k.type==="simulation_switch").map(k=>k),a=new Map;for(let k of o)k.source_component_id&&a.set(k.source_component_id,k);let c=ZG(n),l=new Map,u=new Map,p=1,f=new Set;if(s.length>0)for(let k of s)k.name&&f.add(k.name);let y=[...f].map(k=>/^N(\d+)$/i.exec(k)).filter(k=>k!==null).map(k=>parseInt(k[1],10));y.length>0&&(p=Math.max(...y)+1);let g=new Set,x=new Set(Me(n).source_net.list().filter(k=>k.name?.toLowerCase().includes("gnd")).map(k=>k.source_net_id));if(x.size>0){for(let k of Me(n).source_trace.list())if(k.connected_source_port_ids.length>0&&k.connected_source_net_ids.some(I=>x.has(I))){let I=k.connected_source_port_ids[0],E=c.getNetConnectedToId(I);E&&g.add(E)}}let v=i.filter(k=>k.name?.toLowerCase()==="gnd");for(let k of v){let T=c.getNetConnectedToId(k.source_port_id);T&&g.add(T)}for(let k of Me(n).simulation_voltage_source.list()){let T=k.negative_source_port_id??k.terminal2_source_port_id;if(T){let I=c.getNetConnectedToId(T);I&&g.add(I)}}for(let k of g)u.set(k,"0");if(s.length>0)for(let k of s){if(!k.name)continue;let T;if(k.source_port_id)T=c.getNetConnectedToId(k.source_port_id);else if(k.source_net_id){let I=r.find(E=>E.connected_source_net_ids.includes(k.source_net_id));if(I&&I.connected_source_port_ids.length>0){let E=I.connected_source_port_ids[0];T=c.getNetConnectedToId(E)}}T?u.has(T)||u.set(T,k.name):k.source_port_id&&k.name&&l.set(k.source_port_id,k.name)}for(let k of i){let T=k.source_port_id,I=c.getNetConnectedToId(T);I&&(u.has(I)||u.set(I,`N${p++}`),l.set(T,u.get(I)))}for(let k of i){let T=k.source_port_id;l.has(T)||l.set(T,`N${p++}`)}for(let k of t){if(k.type!=="source_component")continue;let T=Me(n).source_port.list({source_component_id:k.source_component_id}).sort((E,N)=>(E.pin_number??0)-(N.pin_number??0)),I=T.map(E=>l.get(E.source_port_id)||"0");if("ftype"in k){let E=null;switch(k.ftype){case"simple_resistor":{if("resistance"in k&&"name"in k){let N=new HAt({name:k.name,positiveNode:I[0]||"0",negativeNode:I[1]||"0",value:KAt(k.resistance)});E=new $a(k.name,N,I)}break}case"simple_switch":{let N=t9t(k.name??k.source_component_id,"SW"),M=I[0]||"0",A=I[1]||"0",R=`NCTRL_${N}`,j=`SW_${N}`,B=a.get(k.source_component_id),G=e9t(B),U=new NQ({name:N,positiveNode:M,negativeNode:A,positiveControl:R,negativeControl:"0",model:j});E=new $a(N,U,[M,A,R,"0"]),e.models.has(j)||e.models.set(j,`.MODEL ${j} SW(Ron=0.1 Roff=1e9 Vt=2.5 Vh=0.1)`);let H=`CTRL_${N}`,tt=new SA({name:H,positiveNode:R,negativeNode:"0",value:G}),et=new $a(H,tt,[R,"0"]);e.addComponent(et);break}case"simple_capacitor":{if("capacitance"in k&&"name"in k){let N=new WAt({name:k.name,positiveNode:I[0]||"0",negativeNode:I[1]||"0",value:JAt(k.capacitance)});E=new $a(k.name,N,I)}break}case"simple_diode":{if("name"in k){let N=T.find(G=>G.name?.toLowerCase()==="anode"||G.port_hints?.includes("anode")),M=T.find(G=>G.name?.toLowerCase()==="cathode"||G.port_hints?.includes("cathode")),A=l.get(N?.source_port_id??"")||"0",R=l.get(M?.source_port_id??"")||"0",j="D",B=new qAt({name:k.name,positiveNode:A,negativeNode:R,model:j});e.models.set(j,`.MODEL ${j} D`),E=new $a(k.name,B,[A,R])}break}case"simple_inductor":{if("inductance"in k&&"name"in k){let N=new ZAt({name:k.name,positiveNode:I[0]||"0",negativeNode:I[1]||"0",value:QAt(k.inductance)});E=new $a(k.name,N,I)}break}case"simple_mosfet":{if("name"in k){let N=T.find(H=>H.name?.toLowerCase()==="drain"||H.port_hints?.includes("drain")),M=T.find(H=>H.name?.toLowerCase()==="gate"||H.port_hints?.includes("gate")),A=T.find(H=>H.name?.toLowerCase()==="source"||H.port_hints?.includes("source")),R=l.get(N?.source_port_id??"")||"0",j=l.get(M?.source_port_id??"")||"0",B=l.get(A?.source_port_id??"")||"0",G="SWMOD",U=new NQ({name:k.name,positiveNode:R,negativeNode:B,positiveControl:j,negativeControl:B,model:G});e.models.set(G,`.MODEL ${G} SW`),E=new $a(k.name,U,[R,j,B])}break}}E&&e.addComponent(E)}}let P=Me(n).simulation_voltage_source.list();for(let k of P)if(k.type==="simulation_voltage_source")if(k.is_dc_source===!1){if("terminal1_source_port_id"in k&&"terminal2_source_port_id"in k&&k.terminal1_source_port_id&&k.terminal2_source_port_id){let T=l.get(k.terminal1_source_port_id)||"0",I=l.get(k.terminal2_source_port_id)||"0",E="",N=k.wave_shape;if(N==="sinewave"){let A=k.voltage??0,R=k.frequency??0,j=0,B=0,G=k.phase??0;R>0?E=`SIN(0 ${A} ${R} ${j} ${B} ${G})`:E=`DC ${k.voltage??0}`}else if(N==="square"){let A=k.voltage??0,R=k.frequency??0,j=R===0?1/0:1/R,B=k.period??j,G=k.duty_cycle??.5,U=B*G;E=`PULSE(0 ${A} 0 1n 1n ${U} ${B})`}else k.voltage!==void 0&&(E=`DC ${k.voltage}`);if(E){let M=new SA({name:k.simulation_voltage_source_id,positiveNode:T,negativeNode:I,value:E}),A=new $a(k.simulation_voltage_source_id,M,[T,I]);e.addComponent(A)}}}else{let T=k.positive_source_port_id??k.terminal1_source_port_id,I=k.negative_source_port_id??k.terminal2_source_port_id;if(T&&I&&"voltage"in k&&k.voltage!==void 0){let E=l.get(T)||"0",N=l.get(I)||"0",M=new SA({name:k.simulation_voltage_source_id,positiveNode:E,negativeNode:N,value:`DC ${k.voltage}`}),A=new $a(k.simulation_voltage_source_id,M,[E,N]);e.addComponent(A)}}let w=n.find(k=>k.type==="simulation_experiment");if(w){if(s.length>0){let E=new Set;for(let N of s){let M;if(N.source_port_id)M=l.get(N.source_port_id);else if(N.source_net_id){let A=r.find(R=>R.connected_source_net_ids.includes(N.source_net_id));if(A&&A.connected_source_port_ids.length>0){let R=A.connected_source_port_ids[0];M=l.get(R)}}M&&M!=="0"&&E.add(`V(${M})`)}E.size>0&&w.experiment_type?.includes("transient")&&e.printStatements.push(`.PRINT TRAN ${[...E].join(" ")}`)}let k=w.time_per_step,T=w.end_time_ms,I=w.start_time_ms;if(k&&T){let E=(I??0)/1e3,N=`.tran ${Ui(k/1e3)} ${Ui(T/1e3)}`;E>0&&(N+=` ${Ui(E)}`),N+=" UIC",e.tranCommand=N}}return e}function KAt(n){return n>=1e6?`${n/1e6}MEG`:n>=1e3?`${n/1e3}K`:n.toString()}function JAt(n){return n>=.001?`${n*1e3}M`:n>=1e-6?`${n*1e6}U`:n>=1e-9?`${n*1e9}N`:n>=1e-12?`${n*1e12}P`:n.toString()}function QAt(n){return n>=1?n.toString():n>=.001?`${n*1e3}m`:n>=1e-6?`${n*1e6}u`:n>=1e-9?`${n*1e9}n`:n>=1e-12?`${n*1e12}p`:n.toString()}function t9t(n,e){if(!n)return e;let t=n.replace(/[^A-Za-z0-9_]/g,"_");return t?/^[0-9]/.test(t)?`${e}_${t}`:t:e}function e9t(n){if(!n)return"DC 0";let s=n.starts_closed??!1,o=n.closes_at??0,a=n.opens_at,c=n.switching_frequency,[l,u]=s?[5,0]:[0,5];if(c&&c>0){let p=1/c,f=a&&a>o?Math.min(a-o,p):0,y=f>0?f:Math.max(p/2,1e-9);return`PULSE(${Ui(l)} ${Ui(u)} ${Ui(o)} 1n 1n ${Ui(y)} ${Ui(p)})`}if(a!==void 0&&a>o){let p=Math.max(a-o,1e-9),f=o+p*2;return`PULSE(${Ui(l)} ${Ui(u)} ${Ui(o)} 1n 1n ${Ui(p)} ${Ui(f)})`}if(o>0){let p=o*2,f=Math.max(p/2,1e-9);return`PULSE(${Ui(l)} ${Ui(u)} ${Ui(o)} 1n 1n ${Ui(f)} ${Ui(p)})`}return`DC ${s?5:0}`}function Ui(n){if(!Number.isFinite(n))return`${n}`;if(n===0)return"0";let e=Math.abs(n);return e>=1e3||e<=.001?Number(n.toExponential(6)).toString():Number(n.toPrecision(6)).toString()}var dnt=Gt(Mn(),1);var ai=1e-15,n9t=class{constructor(){d(this,"map");d(this,"rev");this.map=new Map([["0",0]]),this.rev=["0"]}getOrCreate(n){let e=String(n),t=e.toUpperCase();if(this.map.has(t))return this.map.get(t);let i=this.rev.length;return this.map.set(t,i),this.rev.push(e),i}get(n){return this.map.get(String(n).toUpperCase())}count(){return this.rev.length}matrixIndexOfNode(n){return n===0?-1:n-1}};function yr(n){if(n==null)return NaN;let e=String(n).trim();if(e==="")return NaN;if(/^[+-]?\d*\.?\d+(?:[eE][+-]?\d+)?$/.test(e))return parseFloat(e);let t={t:1e12,g:1e9,meg:1e6,k:1e3,m:.001,u:1e-6,n:1e-9,p:1e-12,f:1e-15},i=e.match(/^([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)([a-zA-Z]+)$/);if(!i)return parseFloat(e);let[,r,s]=i;if(r==null)return parseFloat(e);let o=parseFloat(r),a=(s??"").toLowerCase();return a=a.replace(/(ohm|v|a|s|h|f)$/g,""),a==="meg"?o*t.meg:a.length===1&&a in t?o*t[a]:o}function i9t(n){let i=n.trim().replace(/^pulse\s*\(/i,"(").replace(/^\(/,"").replace(/\)$/,"").trim().split(/[\s,]+/).filter(s=>s.length);if(i.length<7)throw new Error("PULSE(...) requires 7 or 8 args");let r=i.map(s=>yr(s));if(r.some(s=>Number.isNaN(s)))throw new Error("Invalid PULSE() numeric value");return{v1:r[0],v2:r[1],td:r[2],tr:r[3],tf:r[4],ton:r[5],period:r[6],ncycles:i[7]!=null?r[7]:1/0}}function r9t(n){let i=n.trim().replace(/^pwl\s*\(/i,"(").replace(/^\(/,"").replace(/\)$/,"").trim().split(/[\s,]+/).filter(s=>s.length);if(i.length===0||i.length%2!==0)throw new Error("PWL(...) requires an even number of time/value pairs");let r=[];for(let s=0;s<i.length;s+=2){let o=yr(i[s]),a=yr(i[s+1]);if(Number.isNaN(o)||Number.isNaN(a))throw new Error("Invalid PWL() numeric value");r.push({t:o,v:a})}return r}function s9t(n,e){if(e<n.td)return n.v1;let t=e-n.td,i=Math.floor(t/n.period);if(i>=n.ncycles)return n.v1;let r=t-i*n.period;if(r<n.tr){let s=r/Math.max(n.tr,ai);return n.v1+(n.v2-n.v1)*s}if(r<n.tr+n.ton)return n.v2;if(r<n.tr+n.ton+n.tf){let s=(r-(n.tr+n.ton))/Math.max(n.tf,ai);return n.v2+(n.v1-n.v2)*s}return n.v1}function o9t(n,e){if(n.length===0)return 0;if(e<=n[0].t)return n[0].v;for(let t=1;t<n.length;t++){let i=n[t-1],r=n[t];if(e<=r.t){let s=Math.max(r.t-i.t,ai),o=(e-i.t)/s;return i.v+(r.v-i.v)*o}}return n[n.length-1].v}function a9t(n){let e=/"[^"]*"|\w+\s*\([^)]*\)|\([^()]*\)|\S+/g,t=[],i;for(;(i=e.exec(n))!==null;)t.push(i[0]);return t}function un(n,e,t){let i=n[e];if(i==null)throw new Error(t);return i}function c9t(n){let e=new Map,t=new Map,i={nodes:new n9t,R:[],C:[],L:[],V:[],S:[],D:[],analyses:{ac:null,tran:null},probes:{tran:[]},skipped:[],models:{vswitch:e,diode:t}},r=n.split(/\r?\n/),s=!1;for(let a of r){let c=a.trim();if(!c||/^\*/.test(c))continue;if(/^\s*\.end\b/i.test(c))break;c=c.replace(/\/\/.*$/,""),c=c.replace(/;.*$/,"");let l=a9t(c);if(l.length===0)continue;let u=l[0];if(u.length===0)continue;if(!s&&!/^[rclvgsmiqd]\w*$/i.test(u)&&!/^\./.test(u)){s=!0;continue}if(/^\./.test(u)){let y=u.toLowerCase();if(y===".ac"){let g=un(l,1,".ac missing mode").toLowerCase();if(g!=="dec"&&g!=="lin")throw new Error(".ac supports 'dec' or 'lin'");let x=parseInt(un(l,2,".ac missing point count"),10),v=yr(un(l,3,".ac missing start frequency")),P=yr(un(l,4,".ac missing stop frequency"));i.analyses.ac={mode:g,N:x,f1:v,f2:P}}else if(y===".tran"){let g=yr(un(l,1,".tran missing timestep")),x=yr(un(l,2,".tran missing stop time"));i.analyses.tran={dt:g,tstop:x}}else if(y===".print")if(un(l,1,".print missing analysis type").toLowerCase()==="tran"){let x=l.slice(2);for(let v of x){let P=v.match(/^v\(([^)]+)\)$/i);if(P&&P[1]){let w=P[1];i.probes.tran.some(k=>k.toUpperCase()===w.toUpperCase())||i.probes.tran.push(w)}}}else i.skipped.push(c);else if(y===".model"){let g=un(l,1,".model missing name"),v=un(l,2,".model missing type"),P="";if(v.includes("(")){let k=v.indexOf("(");P=v.slice(k+1),v=v.slice(0,k)}if(!P)P=l.slice(3).join(" ").replace(/^\(/,"").replace(/\)$/,"");else{let k=l.slice(3).join(" ").replace(/\)$/,"");P=`${P} ${k}`.trim()}P=P.replace(/^\(/,"").replace(/\)$/,"").trim();let w=v.toLowerCase();if(w==="vswitch"||w==="sw"){let k={name:g,Ron:1,Roff:1e12,Von:0,Voff:0},T,I;if(P.length>0){let E=P.split(/[\s,]+/).filter(Boolean);for(let N of E){let[M,A]=N.split("=");if(!M||A==null)continue;let R=M.toLowerCase(),j=yr(A);Number.isNaN(j)||(R==="ron"?k.Ron=j:R==="roff"?k.Roff=j:R==="von"?k.Von=j:R==="voff"?k.Voff=j:R==="vt"?T=j:R==="vh"&&(I=j))}}if(T!==void 0){let E=I??0;k.Von=T+E/2,k.Voff=T-E/2}e.set(g.toLowerCase(),k)}else if(w==="d"){let k={name:g,Is:1e-14,N:1};if(P.length>0){let T=P.split(/[\s,]+/).filter(Boolean);for(let I of T){let[E,N]=I.split("=");if(!E||N==null)continue;let M=E.toLowerCase(),A=yr(N);Number.isNaN(A)||(M==="is"?k.Is=A:M==="n"&&(k.N=A))}}t.set(g.toLowerCase(),k)}else i.skipped.push(c)}else i.skipped.push(c);continue}let p=u.charAt(0).toLowerCase(),f=u;try{if(p==="r"){let y=i.nodes.getOrCreate(un(l,1,"Resistor missing node")),g=i.nodes.getOrCreate(un(l,2,"Resistor missing node")),x=yr(un(l,3,"Resistor missing value"));i.R.push({name:f,n1:y,n2:g,R:x})}else if(p==="c"){let y=i.nodes.getOrCreate(un(l,1,"Capacitor missing node")),g=i.nodes.getOrCreate(un(l,2,"Capacitor missing node")),x=yr(un(l,3,"Capacitor missing value"));i.C.push({name:f,n1:y,n2:g,C:x,vPrev:0})}else if(p==="l"){let y=i.nodes.getOrCreate(un(l,1,"Inductor missing node")),g=i.nodes.getOrCreate(un(l,2,"Inductor missing node")),x=yr(un(l,3,"Inductor missing value"));i.L.push({name:f,n1:y,n2:g,L:x,iPrev:0})}else if(p==="v"){let y=i.nodes.getOrCreate(un(l,1,"Voltage source missing node")),g=i.nodes.getOrCreate(un(l,2,"Voltage source missing node")),x={dc:0,acMag:0,acPhaseDeg:0,waveform:null,index:-1},v=3;for(v<l.length&&!/^[a-zA-Z]/.test(l[v])&&(x.dc=yr(l[v]),v++);v<l.length;){let P=l[v].toLowerCase();if(P==="dc"){let w=un(l,v+1,"DC value missing");x.dc=yr(w),v+=2}else if(P==="ac"){let w=un(l,v+1,"AC magnitude missing");x.acMag=yr(w);let k=l[v+2];k!=null&&/^[+-]?\d/.test(k)?(x.acPhaseDeg=yr(k),v+=3):v+=2}else if(P.startsWith("pulse")){let w=P.includes("(")?P:un(l,v+1,"PULSE() missing arguments");if(!w||!/\(.*\)/.test(w))throw new Error("Malformed PULSE() specification");let k=i9t(w);x.waveform=T=>s9t(k,T),v+=P.includes("(")?1:2}else if(P.startsWith("pwl")){let w=P.includes("(")?P:un(l,v+1,"PWL() missing arguments");if(!w||!/\(.*\)/.test(w))throw new Error("Malformed PWL() specification");let k=r9t(w);x.waveform=T=>o9t(k,T),v+=P.includes("(")?1:2}else/^\(.*\)$/.test(P),v++}i.V.push({name:f,n1:y,n2:g,dc:x.dc,acMag:x.acMag,acPhaseDeg:x.acPhaseDeg,waveform:x.waveform,index:x.index??-1})}else if(p==="s"){let y=i.nodes.getOrCreate(un(l,1,"Switch missing node")),g=i.nodes.getOrCreate(un(l,2,"Switch missing node")),x=i.nodes.getOrCreate(un(l,3,"Switch missing control node")),v=i.nodes.getOrCreate(un(l,4,"Switch missing control node")),P=un(l,5,"Switch missing model");i.S.push({name:f,n1:y,n2:g,ncPos:x,ncNeg:v,modelName:P.toLowerCase(),model:null,isOn:!1})}else if(p==="d")if(l.length===4){let y=i.nodes.getOrCreate(un(l,1,"Diode missing node")),g=i.nodes.getOrCreate(un(l,2,"Diode missing node")),x=un(l,3,"Diode missing model");i.D.push({name:f,nPlus:y,nMinus:g,modelName:x.toLowerCase(),model:null,vdPrev:0})}else i.skipped.push(c);else i.skipped.push(c)}catch(y){throw y instanceof Error?new Error(`Parse error on line: "${c}"
${y.message}`):y}}let o=i.nodes.count()-1;for(let a=0;a<i.V.length;a++){let c=i.V[a];c&&(c.index=o+a)}for(let a of i.S){let c=e.get(a.modelName);if(!c)throw new Error(`Unknown .model ${a.modelName} referenced by switch ${a.name}`);a.model=c,a.isOn=!1}for(let a of i.D){let c=t.get(a.modelName);if(!c)throw new Error(`Unknown .model ${a.modelName} referenced by diode ${a.name}`);a.model=c}return i}var pn=class Da{constructor(e=0,t=0){d(this,"re");d(this,"im");this.re=e,this.im=t}static from(e,t=0){return new Da(e,t)}static fromPolar(e,t=0){let i=t*Math.PI/180;return new Da(e*Math.cos(i),e*Math.sin(i))}clone(){return new Da(this.re,this.im)}add(e){return new Da(this.re+e.re,this.im+e.im)}sub(e){return new Da(this.re-e.re,this.im-e.im)}mul(e){return new Da(this.re*e.re-this.im*e.im,this.re*e.im+this.im*e.re)}div(e){let t=e.re*e.re+e.im*e.im;if(t<ai)throw new Error("Complex divide by ~0");return new Da((this.re*e.re+this.im*e.im)/t,(this.im*e.re-this.re*e.im)/t)}inv(){let e=this.re*this.re+this.im*this.im;if(e<ai)throw new Error("Complex invert by ~0");return new Da(this.re/e,-this.im/e)}abs(){return Math.hypot(this.re,this.im)}phaseDeg(){return Math.atan2(this.im,this.re)*180/Math.PI}};function l9t(n,e){let t=n.length;for(let r=0;r<t;r++){let s=n[r],o=e[r];if(!s||!o)throw new Error("Matrix dimensions mismatch");let a=s.map(c=>c.clone());a.push(o.clone()),n[r]=a}for(let r=0;r<t;r++){let s=r,o=n[r];if(!o)throw new Error("Matrix row missing");let a=o[r]?.abs()??0;for(let u=r+1;u<t;u++){let p=n[u];if(!p)throw new Error("Matrix row missing");let f=p[r]?.abs()??0;f>a&&(a=f,s=u)}if(a<ai)throw new Error("Singular matrix (complex)");if(s!==r){let u=n[r];n[r]=n[s],n[s]=u}let c=n[r];if(!c)throw new Error("Pivot row missing");let l=c[r];if(!l)throw new Error("Zero pivot encountered");for(let u=r+1;u<t;u++){let p=n[u];if(!p)throw new Error("Matrix row missing");let f=p[r];if(!f)continue;let y=f.div(l);if(!(y.abs()<ai))for(let g=r;g<=t;g++){let x=p[g],v=c[g];!x||!v||(p[g]=x.sub(y.mul(v)))}}}let i=new Array(t);for(let r=t-1;r>=0;r--){let s=n[r];if(!s)throw new Error("Matrix row missing");let o=s[t];if(!o)throw new Error("Augmented column missing");for(let c=r+1;c<t;c++){let l=s[c],u=i[c];!l||!u||(o=o.sub(l.mul(u)))}let a=s[r];if(!a)throw new Error("Zero pivot on back-substitution");i[r]=o.div(a)}return i}function u9t(n,e,t){if(n<=0||e<=0)throw new Error(".ac frequencies must be > 0");e<n&&([n,e]=[e,n]);let i=Math.log10(e/n),r=Math.max(1,Math.ceil(i*t)),s=[];for(let a=0;a<=r;a++)s.push(n*Math.pow(10,a/t));let o=s[s.length-1];return(o==null||o<e*(1-ai))&&s.push(e),s}function wA(n,e,t,i,r){let s=e.matrixIndexOfNode(t),o=e.matrixIndexOfNode(i);if(s>=0){let a=n[s];if(!a)throw new Error("Matrix row missing while stamping");a[s]=a[s]?.add(r)??r}if(o>=0){let a=n[o];if(!a)throw new Error("Matrix row missing while stamping");a[o]=a[o]?.add(r)??r}if(s>=0&&o>=0){let a=n[s],c=n[o];if(!a||!c)throw new Error("Matrix row missing while stamping");a[o]=a[o]?.sub(r)??pn.from(0,0).sub(r),c[s]=c[s]?.sub(r)??pn.from(0,0).sub(r)}}function p9t(n,e,t,i,r){let s=t.matrixIndexOfNode(i.n1),o=t.matrixIndexOfNode(i.n2),a=i.index,c=pn.from(1,0),l=pn.from(-1,0);if(s>=0){let p=n[s];if(!p)throw new Error("Matrix row missing while stamping voltage source");p[a]=p[a]?.add(c)??c}if(o>=0){let p=n[o];if(!p)throw new Error("Matrix row missing while stamping voltage source");p[a]=p[a]?.sub(c)??l}let u=n[a];if(!u)throw new Error("Branch row missing while stamping voltage source");s>=0&&(u[s]=u[s]?.add(c)??c),o>=0&&(u[o]=u[o]?.sub(c)??l),e[a]=(e[a]??pn.from(0,0)).add(r)}function h9t(n){let{mode:e,N:t,f1:i,f2:r}=n;if(e==="dec")return u9t(i,r,t);let s=[],o=Math.max(2,t),a=(r-i)/(o-1);for(let c=0;c<o;c++)s.push(i+c*a);return s}function d9t(n,e,t){let i=Array.from({length:t},()=>Array.from({length:t},()=>pn.from(0,0))),r=Array.from({length:t},()=>pn.from(0,0)),s=2*Math.PI;for(let o of n.R){if(o.R<=0)throw new Error(`R ${o.name} must be > 0`);let a=pn.from(1/o.R,0);wA(i,n.nodes,o.n1,o.n2,a)}for(let o of n.C){let a=pn.from(0,s*e*o.C);wA(i,n.nodes,o.n1,o.n2,a)}for(let o of n.L){let a=pn.from(0,s*e*o.L),c=a.abs()<ai?pn.from(0,0):pn.from(1,0).div(a);wA(i,n.nodes,o.n1,o.n2,c)}for(let o of n.V){let a=pn.fromPolar(o.acMag||0,o.acPhaseDeg||0);p9t(i,r,n.nodes,o,a)}return{A:i,b:r}}function f9t(n){var f,y,g,x;if(!n.analyses.ac)return null;let{mode:e,N:t,f1:i,f2:r}=n.analyses.ac,s=n.nodes.count()-1,o=n.V.length,a=s+o,c=h9t({mode:e,N:t,f1:i,f2:r}),l={};n.nodes.rev.forEach((v,P)=>{P!==0&&(l[v]=[])});let u={},p=2*Math.PI;for(let v of c){let{A:P,b:w}=d9t(n,v,a),k=l9t(P,w);for(let T=1;T<n.nodes.count();T++){let I=T-1,E=n.nodes.rev[T];if(!E)continue;let N=l[E];N&&N.push(k[I]??pn.from(0,0))}for(let T of n.R){let I=T.n1===0?pn.from(0,0):k[T.n1-1]??pn.from(0,0),E=T.n2===0?pn.from(0,0):k[T.n2-1]??pn.from(0,0),M=pn.from(1/T.R,0).mul(I.sub(E));(u[f=T.name]||(u[f]=[])).push(M)}for(let T of n.C){let I=T.n1===0?pn.from(0,0):k[T.n1-1]??pn.from(0,0),E=T.n2===0?pn.from(0,0):k[T.n2-1]??pn.from(0,0),M=pn.from(0,p*v*T.C).mul(I.sub(E));(u[y=T.name]||(u[y]=[])).push(M)}for(let T of n.L){let I=T.n1===0?pn.from(0,0):k[T.n1-1]??pn.from(0,0),E=T.n2===0?pn.from(0,0):k[T.n2-1]??pn.from(0,0),N=pn.from(0,p*v*T.L),A=(N.abs()<ai?pn.from(0,0):pn.from(1,0).div(N)).mul(I.sub(E));(u[g=T.name]||(u[g]=[])).push(A)}for(let T of n.V){let I=k[T.index]??pn.from(0,0);(u[x=T.name]||(u[x]=[])).push(I)}}return{freqs:c,nodeVoltages:l,elementCurrents:u}}var RQ=.02585;function m9t(n,e){let t=n.length;for(let r=0;r<t;r++){let s=n[r],o=e[r];if(!s||o==null)throw new Error("Matrix dimensions mismatch");let a=s.slice();a.push(o),n[r]=a}for(let r=0;r<t;r++){let s=r,o=n[r];if(!o)throw new Error("Matrix row missing");let a=Math.abs(o[r]??0);for(let u=r+1;u<t;u++){let p=n[u];if(!p)throw new Error("Matrix row missing");let f=Math.abs(p[r]??0);f>a&&(a=f,s=u)}if(a<ai)throw new Error("Singular matrix (real)");if(s!==r){let u=n[r];n[r]=n[s],n[s]=u}let c=n[r];if(!c)throw new Error("Pivot row missing");let l=c[r];if(l==null)throw new Error("Zero pivot encountered");for(let u=r+1;u<t;u++){let p=n[u];if(!p)throw new Error("Matrix row missing");let f=p[r];if(f==null)continue;let y=f/l;if(!(Math.abs(y)<ai))for(let g=r;g<=t;g++){let x=p[g],v=c[g];x==null||v==null||(p[g]=x-y*v)}}}let i=new Array(t).fill(0);for(let r=t-1;r>=0;r--){let s=n[r];if(!s)throw new Error("Matrix row missing");let o=s[t];if(o==null)throw new Error("Augmented column missing");for(let c=r+1;c<t;c++){let l=s[c],u=i[c];l==null||u==null||(o-=l*u)}let a=s[r];if(a==null)throw new Error("Zero pivot on back-substitution");i[r]=o/a}return i}function P1(n,e,t,i,r){let s=e.matrixIndexOfNode(t),o=e.matrixIndexOfNode(i);if(s>=0){let a=n[s];if(!a)throw new Error("Matrix row missing while stamping");a[s]=(a[s]??0)+r}if(o>=0){let a=n[o];if(!a)throw new Error("Matrix row missing while stamping");a[o]=(a[o]??0)+r}if(s>=0&&o>=0){let a=n[s],c=n[o];if(!a||!c)throw new Error("Matrix row missing while stamping");a[o]=(a[o]??0)-r,c[s]=(c[s]??0)-r}}function PA(n,e,t,i,r){let s=e.matrixIndexOfNode(t),o=e.matrixIndexOfNode(i);s>=0&&(n[s]=(n[s]??0)-r),o>=0&&(n[o]=(n[o]??0)+r)}function _9t(n,e,t,i,r){let s=t.matrixIndexOfNode(i.n1),o=t.matrixIndexOfNode(i.n2),a=i.index;if(s>=0){let l=n[s];if(!l)throw new Error("Matrix row missing while stamping voltage source");l[a]=(l[a]??0)+1}if(o>=0){let l=n[o];if(!l)throw new Error("Matrix row missing while stamping voltage source");l[a]=(l[a]??0)-1}let c=n[a];if(!c)throw new Error("Branch row missing while stamping voltage source");s>=0&&(c[s]=(c[s]??0)+1),o>=0&&(c[o]=(c[o]??0)-1),e[a]=(e[a]??0)+r}function y9t(n,e){let t=n>ai?n:Math.max(e/1e3,ai),i=Math.max(1,Math.ceil(e/Math.max(t,ai)));return{dt:i>0?e/i:e,steps:i}}function g9t(n,e,t,i,r,s,o){for(let a of t.R){let c=1/a.R;P1(n,t.nodes,a.n1,a.n2,c)}for(let a of t.C){let c=a.C/Math.max(r,ai);P1(n,t.nodes,a.n1,a.n2,c);let l=-c*a.vPrev;PA(e,t.nodes,a.n1,a.n2,l)}for(let a of t.L){let c=Math.max(r,ai)/a.L;P1(n,t.nodes,a.n1,a.n2,c),PA(e,t.nodes,a.n1,a.n2,a.iPrev)}for(let a of t.S){let c=a.model;if(!c)continue;let l=a.isOn?c.Ron:c.Roff,p=1/Math.max(Math.abs(l),ai);P1(n,t.nodes,a.n1,a.n2,p)}for(let a of t.V){let c=a.waveform?a.waveform(i):a.dc||0;_9t(n,e,t.nodes,a,c)}for(let a of t.D){let c=a.model;if(!c)continue;let{nPlus:l,nMinus:u}=a,p=t.nodes.matrixIndexOfNode(l),f=t.nodes.matrixIndexOfNode(u),y=l===0?0:s[p]??0,g=u===0?0:s[f]??0,x=y-g,v=o===0?a.vdPrev:x,P=c.N*RQ,w=v;v>.8&&(w=.8),v<-1&&(w=-1);let k=Math.exp(w/P),T=c.Is*(k-1),I=Math.max(c.Is/P*k,1e-12),E=T-I*w;P1(n,t.nodes,l,u,I),PA(e,t.nodes,l,u,E)}}function x9t(n,e){let t=!1;for(let i of n.S){let r=i.model;if(!r)continue;let s=i.ncPos===0?0:e[i.ncPos-1]??0,o=i.ncNeg===0?0:e[i.ncNeg-1]??0,a=s-o,c=i.isOn;i.isOn?a<r.Voff&&(c=!1):a>r.Von&&(c=!0),c!==i.isOn&&(i.isOn=c,t=!0)}return t}function b9t(n){var f,y,g,x,v,P;if(!n.analyses.tran)return null;let{dt:e,tstop:t}=n.analyses.tran,{dt:i,steps:r}=y9t(e,t),s=n.nodes.count()-1,o=n.V.length,a=s+o,c=[],l={};n.nodes.rev.forEach((w,k)=>{k!==0&&(l[w]=[])});let u={},p=0;for(let w=0;w<=r;w++,p=w*i){c.push(p);let k=new Array(a).fill(0);for(let T=0;T<20;T++){let I=Array.from({length:a},()=>new Array(a).fill(0)),E=new Array(a).fill(0);if(g9t(I,E,n,p,i,k,T),k=m9t(I,E),!x9t(n,k)||T===19)break}for(let T=1;T<n.nodes.count();T++){let I=T-1,E=n.nodes.rev[T];if(!E)continue;let N=l[E];N&&N.push(k[I]??0)}for(let T of n.R){let I=T.n1===0?0:k[T.n1-1]??0,E=T.n2===0?0:k[T.n2-1]??0,N=(I-E)/T.R;(u[f=T.name]||(u[f]=[])).push(N)}for(let T of n.C){let I=T.n1===0?0:k[T.n1-1]??0,E=T.n2===0?0:k[T.n2-1]??0,N=T.C*(I-E-T.vPrev)/Math.max(i,ai);(u[y=T.name]||(u[y]=[])).push(N)}for(let T of n.L){let I=T.n1===0?0:k[T.n1-1]??0,E=T.n2===0?0:k[T.n2-1]??0,M=Math.max(i,ai)/T.L*(I-E)+T.iPrev;(u[g=T.name]||(u[g]=[])).push(M)}for(let T of n.V){let I=k[T.index]??0;(u[x=T.name]||(u[x]=[])).push(I)}for(let T of n.S){let I=T.model;if(!I)continue;let E=T.n1===0?0:k[T.n1-1]??0,N=T.n2===0?0:k[T.n2-1]??0,M=T.isOn?I.Ron:I.Roff,A=Math.max(Math.abs(M),ai),R=(E-N)/A;(u[v=T.name]||(u[v]=[])).push(R)}for(let T of n.D){if(!T.model)continue;let{nPlus:I,nMinus:E,model:N}=T,M=I===0?0:k[I-1]??0,A=E===0?0:k[E-1]??0,R=M-A,j=N.N*RQ,B=Math.exp(R/j),G=N.Is*(B-1);(u[P=T.name]||(u[P]=[])).push(G)}for(let T of n.C){let I=T.n1===0?0:k[T.n1-1]??0,E=T.n2===0?0:k[T.n2-1]??0;T.vPrev=I-E}for(let T of n.L){let I=T.n1===0?0:k[T.n1-1]??0,E=T.n2===0?0:k[T.n2-1]??0,N=Math.max(i,ai)/T.L;T.iPrev=N*(I-E)+T.iPrev}for(let T of n.D){let I=T.nPlus===0?0:k[T.nPlus-1]??0,E=T.nMinus===0?0:k[T.nMinus-1]??0;T.vdPrev=I-E}}if(n.probes.tran.length>0){let w={},k=n.probes.tran.map(T=>T.toUpperCase());for(let T in l)k.includes(T.toUpperCase())&&(w[T]=l[T]);return{times:c,nodeVoltages:w,elementCurrents:u}}return{times:c,nodeVoltages:l,elementCurrents:u}}function OQ(n){let e=c9t(n),t=f9t(e),i=b9t(e);return{circuit:e,ac:t,tran:i}}function LQ(n,e,t){if(!n||!e.analyses.tran)return[];let{dt:i,tstop:r}=e.analyses.tran,{times:s,nodeVoltages:o}=n,a=[];for(let c in o){let l=o[c];a.push({type:"simulation_transient_voltage_graph",simulation_transient_voltage_graph_id:`stvg_${t}_${c}`,simulation_experiment_id:t,timestamps_ms:s.map(u=>u*1e3),voltage_levels:l,time_per_step:i*1e3,start_time_ms:0,end_time_ms:r*1e3,name:`${c}`})}return a}ir();Ae();ir();Ae();Ae();St();Ae();Ae();si();Ae();ir();Ae();ir();Ae();Ae();ir();Ae();function FQ(n,e,t,i){return Math.sqrt((t-n)**2+(i-e)**2)}var v9t=n=>{let e=n.filter(s=>s.type==="pcb_port"),t=n.filter(s=>s.type==="pcb_smtpad"),i=n.filter(s=>s.type==="pcb_trace");function r(s,o={}){let a=o.traceWidth||0,c=e.find(l=>FQ(l.x,l.y,s.x,s.y)<.01);if(c)return c.pcb_port_id;if(o.isFirstOrLastPoint){let l=t.find(u=>{if(u.shape==="rect")return Math.abs(s.x-u.x)<u.width/2+a/2&&Math.abs(s.y-u.y)<u.height/2+a/2;if(u.shape==="circle")return FQ(s.x,s.y,u.x,u.y)<u.radius});if(l)return l.pcb_port_id??null}return null}for(let s of i)for(let o=0;o<s.route.length;o++){let a=s.route[o],c=o===0||o===s.route.length-1;if(a.route_type==="wire"){if(!a.start_pcb_port_id&&o===0){let l=r(a,{isFirstOrLastPoint:c,traceWidth:a.width});l&&(a.start_pcb_port_id=l)}if(!a.end_pcb_port_id&&o===s.route.length-1){let l=r(a,{isFirstOrLastPoint:c,traceWidth:a.width});l&&(a.end_pcb_port_id=l)}}}};function $Q(n){v9t(n);let e=n.filter(o=>o.type==="source_trace"),t=n.filter(o=>o.type==="pcb_port"),i=[],r=nr(n),s=new Map;for(let o of t)s.set(o.source_port_id,o);for(let o of e){let a=o.connected_source_port_ids;if(a.length<2)continue;let c=[],l=[];for(let g of a){let x=s.get(g);x?c.push(x):l.push(g)}if(c.length<2)continue;let u=c[0],p=r.getNetConnectedToId(u.pcb_port_id);r.getIdsConnectedToNet(p).filter(g=>n.some(x=>x.type==="pcb_trace"&&("pcb_trace_id"in x&&x.pcb_trace_id===g||"route_id"in x&&x.route_id===g))).length===0&&new Set(c.map(x=>x.pcb_component_id)).size>1&&i.push({type:"pcb_port_not_connected_error",message:`pcb_port_not_connected_error: Pcb ports [${c.map(x=>x.pcb_port_id).join(", ")}] are not connected together through the same net.`,error_type:"pcb_port_not_connected_error",pcb_port_ids:c.map(x=>x.pcb_port_id),pcb_component_ids:c.map(x=>x.pcb_component_id),pcb_port_not_connected_error_id:`pcb_port_not_connected_error_trace_${o.source_trace_id}`})}return i}var S9t=class{constructor({objects:n,getBounds:e,getId:t,CELL_SIZE:i}){d(this,"buckets");d(this,"objectsById");d(this,"getBounds");d(this,"getId");d(this,"CELL_SIZE",.4);d(this,"_idCounter",0);this.buckets=new Map,this.objectsById=new Map,this.getBounds=e,this.getId=t??(()=>this._getNextId()),this.CELL_SIZE=i??this.CELL_SIZE;for(let r of n)this.addObject(r)}_getNextId(){return`${this._idCounter++}`}addObject(n){let e=this.getBounds(n),t=this.getId(n),i={...n,spatialIndexId:t};this.objectsById.set(t,i);let r=Math.floor(e.minX/this.CELL_SIZE),s=Math.floor(e.minY/this.CELL_SIZE),o=Math.floor(e.maxX/this.CELL_SIZE),a=Math.floor(e.maxY/this.CELL_SIZE);for(let c=r;c<=o;c++)for(let l=s;l<=a;l++){let u=`${c}x${l}`,p=this.buckets.get(u);p?p.push(i):this.buckets.set(u,[i])}}removeObject(n){let e=this.objectsById.get(n);if(!e)return!1;this.objectsById.delete(n);let t=this.getBounds(e),i=Math.floor(t.minX/this.CELL_SIZE),r=Math.floor(t.minY/this.CELL_SIZE),s=Math.floor(t.maxX/this.CELL_SIZE),o=Math.floor(t.maxY/this.CELL_SIZE);for(let a=i;a<=s;a++)for(let c=r;c<=o;c++){let l=`${a}x${c}`,u=this.buckets.get(l);if(u){let p=u.findIndex(f=>f.spatialIndexId===n);p!==-1&&(u.splice(p,1),u.length===0&&this.buckets.delete(l))}}return!0}getBucketKey(n,e){return`${Math.floor(n/this.CELL_SIZE)}x${Math.floor(e/this.CELL_SIZE)}`}getObjectsInBounds(n,e=0){let t=[],i=new Set,r=Math.floor((n.minX-e)/this.CELL_SIZE),s=Math.floor((n.minY-e)/this.CELL_SIZE),o=Math.floor((n.maxX+e)/this.CELL_SIZE),a=Math.floor((n.maxY+e)/this.CELL_SIZE);for(let c=r;c<=o;c++)for(let l=s;l<=a;l++){let u=`${c}x${l}`,p=this.buckets.get(u)||[];for(let f of p){let y=f.spatialIndexId;i.has(y)||(i.add(y),t.push(f))}}return t}},k1=n=>n.type==="pcb_trace_segment"?{minX:Math.min(n.x1,n.x2),minY:Math.min(n.y1,n.y2),maxX:Math.max(n.x1,n.x2),maxY:Math.max(n.y1,n.y2)}:o_([n]),kA=.1,w9t=.15;var P9t=.2,k9t=.3,T1=.005;function T9t(n){let e=new Set;for(let t of n.route)t.route_type==="wire"&&(t.start_pcb_port_id&&e.add(t.start_pcb_port_id),t.end_pcb_port_id&&e.add(t.end_pcb_port_id));return Array.from(e)}function TA(n){let e=new Set;for(let t of n)for(let i of T9t(t))e.add(i);return Array.from(e)}var E9t=(n,e)=>{let t={x:n.x1,y:n.y1},i={x:n.x2,y:n.y2},r={x:e.x1,y:e.y1},s={x:e.x2,y:e.y2},o={x:i.x-t.x,y:i.y-t.y},a={x:s.x-r.x,y:s.y-r.y},c=o.x*o.x+o.y*o.y,l=a.x*a.x+a.y*a.y;if(c===0||l===0){if(c===0&&l===0)return{x:(t.x+r.x)/2,y:(t.y+r.y)/2};if(c===0){let j=Vo(((t.x-r.x)*a.x+(t.y-r.y)*a.y)/l,0,1),B={x:r.x+j*a.x,y:r.y+j*a.y};return{x:(t.x+B.x)/2,y:(t.y+B.y)/2}}let A=Vo(((r.x-t.x)*o.x+(r.y-t.y)*o.y)/c,0,1),R={x:t.x+A*o.x,y:t.y+A*o.y};return{x:(R.x+r.x)/2,y:(R.y+r.y)/2}}let u={x:t.x-r.x,y:t.y-r.y},p=o.x*o.x+o.y*o.y,f=o.x*a.x+o.y*a.y,y=o.x*u.x+o.y*u.y,g=a.x*a.x+a.y*a.y,x=a.x*u.x+a.y*u.y,v=p*g-f*f;if(v<1e-10)return M9t(t,i,r,s,o,a,c,l);let P=(f*x-g*y)/v,w=(p*x-f*y)/v;P=Vo(P,0,1),w=Vo(w,0,1),w=(P*f+x)/g,w=Vo(w,0,1),P=(w*f-y)/p,P=Vo(P,0,1);let k={x:t.x+P*o.x,y:t.y+P*o.y},T={x:r.x+w*a.x,y:r.y+w*a.y},I=k.x-T.x,E=k.y-T.y,N=Math.sqrt(I*I+E*E);return{x:(k.x+T.x)/2,y:(k.y+T.y)/2}},M9t=(n,e,t,i,r,s,o,a)=>{let c=((t.x-n.x)*r.x+(t.y-n.y)*r.y)/o;c=Vo(c,0,1);let l={x:n.x+c*r.x,y:n.y+c*r.y},u=((i.x-n.x)*r.x+(i.y-n.y)*r.y)/o;u=Vo(u,0,1);let p={x:n.x+u*r.x,y:n.y+u*r.y},f=((n.x-t.x)*s.x+(n.y-t.y)*s.y)/a;f=Vo(f,0,1);let y={x:t.x+f*s.x,y:t.y+f*s.y},g=((e.x-t.x)*s.x+(e.y-t.y)*s.y)/a;g=Vo(g,0,1);let x={x:t.x+g*s.x,y:t.y+g*s.y},P=[{pointA:l,pointB:t,distance:Math.sqrt((l.x-t.x)**2+(l.y-t.y)**2)},{pointA:p,pointB:i,distance:Math.sqrt((p.x-i.x)**2+(p.y-i.y)**2)},{pointA:n,pointB:y,distance:Math.sqrt((n.x-y.x)**2+(n.y-y.y)**2)},{pointA:e,pointB:x,distance:Math.sqrt((e.x-x.x)**2+(e.y-x.y)**2)}].reduce((w,k)=>k.distance<w.distance?k:w);return{x:(P.pointA.x+P.pointB.x)/2,y:(P.pointA.y+P.pointB.y)/2}},Vo=(n,e,t)=>Math.max(e,Math.min(t,n)),C9t=n=>{if(n.type==="pcb_via"||n.type==="pcb_plated_hole"&&n.shape==="circle")return n.outer_diameter/2;if(n.type==="pcb_hole"&&n.hole_shape==="circle")return n.hole_diameter/2;if(n.type==="pcb_smtpad"&&n.shape==="circle")return n.radius;throw new Error(`Could not determine radius of element: ${JSON.stringify(n)}`)},zQ=(n,e)=>{let t={x:n.x1,y:n.y1},i={x:n.x2,y:n.y2},r=e.minX,s=e.minY,o=e.maxX,a=e.maxY;if(t.x===i.x&&t.y===i.y){let M=Math.max(r,Math.min(o,t.x)),A=Math.max(s,Math.min(a,t.y));return M===t.x&&A===t.y?{x:t.x,y:t.y}:{x:M,y:A}}let c=i.x-t.x,l=i.y-t.y,u=c!==0?(r-t.x)/c:Number.NEGATIVE_INFINITY,p=c!==0?(o-t.x)/c:Number.POSITIVE_INFINITY,f=l!==0?(s-t.y)/l:Number.NEGATIVE_INFINITY,y=l!==0?(a-t.y)/l:Number.POSITIVE_INFINITY,g=Math.max(Math.min(u,p),Math.min(f,y)),x=Math.min(Math.max(u,p),Math.max(f,y));if(g<=x&&x>=0&&g<=1){let M=Math.max(0,Math.min(1,g));return{x:t.x+M*c,y:t.y+M*l}}let v={x:Math.max(r,Math.min(o,t.x)),y:Math.max(s,Math.min(a,t.y))},P={x:Math.max(r,Math.min(o,i.x)),y:Math.max(s,Math.min(a,i.y))},w=(v.x-t.x)**2+(v.y-t.y)**2,k=(P.x-i.x)**2+(P.y-i.y)**2,T=[{start:{x:r,y:s},end:{x:o,y:s}},{start:{x:o,y:s},end:{x:o,y:a}},{start:{x:o,y:a},end:{x:r,y:a}},{start:{x:r,y:a},end:{x:r,y:s}}],I=Math.min(w,k),E=w<=k?v:P,N=(M,A,R)=>Math.max(A,Math.min(R,M));for(let M of T){let A={x:i.x-t.x,y:i.y-t.y},R={x:M.end.x-M.start.x,y:M.end.y-M.start.y},j={x:t.x-M.start.x,y:t.y-M.start.y},B=A.x*A.x+A.y*A.y,G=A.x*R.x+A.y*R.y,U=A.x*j.x+A.y*j.y,H=R.x*R.x+R.y*R.y,tt=R.x*j.x+R.y*j.y,et=B*H-G*G;if(Math.abs(et)<1e-10)continue;let mt=(G*tt-H*U)/et,V=(B*tt-G*U)/et;mt=N(mt,0,1),V=N(V,0,1);let J={x:t.x+mt*A.x,y:t.y+mt*A.y},nt={x:M.start.x+V*R.x,y:M.start.y+V*R.y},ut=J.x-nt.x,ht=J.y-nt.y,kt=ut*ut+ht*ht;kt<I&&(I=kt,E={x:(J.x+nt.x)/2,y:(J.y+nt.y)/2})}return E};function I9t(n){return n.type==="pcb_trace_segment"?[n.layer]:n.type==="pcb_smtpad"?[n.layer]:n.type==="pcb_plated_hole"?Array.isArray(n.layers)?n.layers:[...Am]:n.type==="pcb_hole"?[...Am]:n.type==="pcb_via"?Array.isArray(n.layers)?n.layers:[...Am]:n.type==="pcb_keepout"?Array.isArray(n.layers)?n.layers:[]:[]}function DQ(n,{connMap:e}={}){let t=[];e??(e=nr(n));let r=Ke(n).pcb_trace.list().flatMap(g=>{let x=[];for(let v=0;v<g.route.length-1;v++){let P=g.route[v],w=g.route[v+1];P.route_type==="wire"&&w.route_type==="wire"&&P.layer===w.layer&&x.push({type:"pcb_trace_segment",pcb_trace_id:g.pcb_trace_id,_pcbTrace:g,thickness:"width"in P?P.width:"width"in w?w.width:w9t,layer:P.layer,x1:P.x,y1:P.y,x2:w.x,y2:w.y})}return x}),s=Ke(n).pcb_smtpad.list(),o=Ke(n).pcb_plated_hole.list(),a=Ke(n).pcb_hole.list(),c=Ke(n).pcb_via.list(),l=Ke(n).pcb_keepout.list(),u=[...r,...s,...o,...a,...c,...l],p=new S9t({objects:u,getBounds:k1}),f=g=>Ns(n,g),y=new Set;for(let g of r){let x=kA,v=k1(g),P=p.getObjectsInBounds(v,x+g.thickness/2);if(!(g.x1===g.x2&&g.y1===g.y2))for(let w of P){if(!I9t(w).includes(g.layer))continue;if(w.type==="pcb_trace_segment"){let E=w;if(g.layer!==E.layer||e.areIdsConnected(g.pcb_trace_id,E.pcb_trace_id))continue;let N=r_({x:g.x1,y:g.y1},{x:g.x2,y:g.y2},{x:E.x1,y:E.y1},{x:E.x2,y:E.y2})-g.thickness/2-E.thickness/2;if(N>kA-T1)continue;let M=`overlap_${g.pcb_trace_id}_${E.pcb_trace_id}`,A=`overlap_${E.pcb_trace_id}_${g.pcb_trace_id}`;if(y.has(M)||y.has(A))continue;y.add(M),t.push({type:"pcb_trace_error",error_type:"pcb_trace_error",message:`PCB trace ${f(g.pcb_trace_id)} overlaps with ${f(E.pcb_trace_id)} ${N<0?"(accidental contact)":`(gap: ${N.toFixed(3)}mm)`}`,pcb_trace_id:g.pcb_trace_id,source_trace_id:"",pcb_trace_error_id:M,pcb_component_ids:[],center:E9t(g,E),pcb_port_ids:TA([g._pcbTrace,E._pcbTrace])});continue}let k=Lo(w);if(e.areIdsConnected(g.pcb_trace_id,"pcb_trace_id"in w?w.pcb_trace_id:k))continue;if(w.type==="pcb_via"||w.type==="pcb_plated_hole"&&w.shape==="circle"||w.type==="pcb_hole"||w.type==="pcb_smtpad"&&w.shape==="circle"){let E=C9t(w),M=vS({x:g.x1,y:g.y1},{x:g.x2,y:g.y2},{x:w.x,y:w.y,radius:E})-g.thickness/2;if(M>kA-T1)continue;let A=`overlap_${g.pcb_trace_id}_${k}`;if(y.has(A))continue;y.add(A),t.push({type:"pcb_trace_error",error_type:"pcb_trace_error",message:`PCB trace ${f(g.pcb_trace_id)} overlaps with ${w.type} "${f(Lo(w))}" ${M<0?"(accidental contact)":`(gap: ${M.toFixed(3)}mm)`}`,pcb_trace_id:g.pcb_trace_id,center:zQ(g,k1(w)),source_trace_id:"",pcb_trace_error_id:A,pcb_component_ids:["pcb_component_id"in w?w.pcb_component_id:void 0].filter(Boolean),pcb_port_ids:[...TA([g._pcbTrace]),"pcb_port_id"in w?w.pcb_port_id:void 0].filter(Boolean)})}let I=Ng({x:g.x1,y:g.y1},{x:g.x2,y:g.y2},k1(w))-g.thickness/2;if(I+T1<x){let E=`overlap_${g.pcb_trace_id}_${k}`;if(y.has(E))continue;y.add(E),t.push({type:"pcb_trace_error",error_type:"pcb_trace_error",message:`PCB trace ${f(g.pcb_trace_id)} overlaps with ${w.type} "${f(Lo(w))}" ${I<0?"(accidental contact)":`(gap: ${I.toFixed(3)}mm)`}`,pcb_trace_id:g.pcb_trace_id,source_trace_id:"",pcb_trace_error_id:E,pcb_component_ids:["pcb_component_id"in w?w.pcb_component_id:void 0].filter(Boolean),center:zQ(g,k1(w)),pcb_port_ids:[...TA([g._pcbTrace]),"pcb_port_id"in w?w.pcb_port_id:void 0].filter(Boolean)})}}}return t}function jQ(n){return n.area()>=0}function BQ({center:n,size:e,rotationDeg:t=0}){let i=n.x,r=n.y,s=e.width/2,o=e.height/2,a=[new Uo(i-s,r-o),new Uo(i+s,r-o),new Uo(i+s,r+o),new Uo(i-s,r+o)],c=new y1(a);if(t){let l=sS(t,i,r),u=a.map(p=>{let f=oe(l,{x:p.x,y:p.y});return new Uo(f.x,f.y)});c=new y1(u)}return jQ(c)||c.reverse(),c}function N9t({board:n}){if(n.outline&&n.outline.length>0){let e=n.outline.map(i=>new Uo(i.x,i.y)),t=new y1(e);return jQ(t)||t.reverse(),t}return n.center&&typeof n.width=="number"&&typeof n.height=="number"?BQ({center:n.center,size:{width:n.width,height:n.height},rotationDeg:0}):null}function A9t({circuitJson:n,component:e}){if(e.source_component_id){let t=n.find(i=>i.type==="source_component"&&i.source_component_id===e.source_component_id);if(t&&"name"in t&&t.name)return t.name}return Ns(n,e.pcb_component_id)||"Unknown"}function R9t(n,e,t,i,r,s){let o=new Uo(t.x,t.y);if(!e.contains(o)){let x=e.distanceTo(o);return Array.isArray(x)?x[0]:Number(x)||0}let a=i/2,c=r/2,l=[{x:t.x-a,y:t.y-c},{x:t.x+a,y:t.y-c},{x:t.x+a,y:t.y+c},{x:t.x-a,y:t.y+c}],u=[];for(let x=0;x<4;x++){let v=(x+1)%4;u.push({x:(l[x].x+l[v].x)/2,y:(l[x].y+l[v].y)/2})}let p=sS(s,t.x,t.y),f=x=>{let v=oe(p,x);return new Uo(v.x,v.y)},y=l.concat(u).map(f),g=0;for(let x of y)if(!e.contains(x)){let v=e.distanceTo(x),P=Array.isArray(v)?v[0]:Number(v)||0;P>g&&(g=P)}if(g>0)return g;try{let x=JN.intersect(n,e),v=0;x?Array.isArray(x)?v=x.reduce((w,k)=>w+(typeof k.area=="function"?k.area():0),0):typeof x.area=="function"?v=x.area():v=0:v=0;let P=n.area();if(v>0&&v<P){let w=1-v/P,k=Math.abs(i),T=Math.abs(r);return Math.min(k,T)*w}else return .1}catch{return .1}}function YQ(n){let e=n.find(s=>s.type==="pcb_board");if(!e)return[];let t=N9t({board:e});if(!t)return[];let i=n.filter(s=>s.type==="pcb_component");if(i.length===0)return[];let r=[];for(let s of i){if(!s.center||typeof s.width!="number"||typeof s.height!="number"||s.width<=0||s.height<=0)continue;let o=BQ({center:s.center,size:{width:s.width,height:s.height},rotationDeg:s.rotation||0});if(o.area()===0||t.contains(o))continue;let c=R9t(o,t,s.center,s.width,s.height,s.rotation||0),l=A9t({circuitJson:n,component:s}),u=Math.round(c*100)/100;r.push({type:"pcb_component_outside_board_error",error_type:"pcb_component_outside_board_error",pcb_component_outside_board_error_id:`pcb_component_outside_board_${s.pcb_component_id}`,message:`Component ${l} (${s.pcb_component_id}) extends outside board boundaries by ${u}mm`,pcb_component_id:s.pcb_component_id,pcb_board_id:e.pcb_board_id,component_center:s.center,component_bounds:{min_x:o.box.xmin,max_x:o.box.xmax,min_y:o.box.ymin,max_y:o.box.ymax},subcircuit_id:s.subcircuit_id,source_component_id:s.source_component_id})}return r}function O9t(n,e){return Math.hypot(n.x-e.x,n.y-e.y)}function XQ(n,{connMap:e,minSpacing:t=P9t}={}){let i=n.filter(o=>o.type==="pcb_via");if(i.length<2)return[];e??(e=nr(n));let r=[],s=new Set;for(let o=0;o<i.length;o++)for(let a=o+1;a<i.length;a++){let c=i[o],l=i[a];if(!e.areIdsConnected(c.pcb_via_id,l.pcb_via_id))continue;let u=O9t(c,l)-c.outer_diameter/2-l.outer_diameter/2;if(u+T1>=t)continue;let p=[c.pcb_via_id,l.pcb_via_id].sort().join("_");s.has(p)||(s.add(p),r.push({type:"pcb_via_clearance_error",pcb_error_id:`same_net_vias_close_${p}`,message:`Vias ${Ns(n,c.pcb_via_id)} and ${Ns(n,l.pcb_via_id)} are too close together (gap: ${u.toFixed(3)}mm)`,error_type:"pcb_via_clearance_error",pcb_via_ids:[c.pcb_via_id,l.pcb_via_id],minimum_clearance:t,actual_clearance:u,pcb_center:{x:(c.x+l.x)/2,y:(c.y+l.y)/2}}))}return r}function L9t(n,e){return Math.hypot(n.x-e.x,n.y-e.y)}function UQ(n,{connMap:e,minSpacing:t=k9t}={}){let i=n.filter(o=>o.type==="pcb_via");if(i.length<2)return[];e??(e=nr(n));let r=[],s=new Set;for(let o=0;o<i.length;o++)for(let a=o+1;a<i.length;a++){let c=i[o],l=i[a];if(e.areIdsConnected(c.pcb_via_id,l.pcb_via_id))continue;let u=L9t(c,l)-c.outer_diameter/2-l.outer_diameter/2;if(u+T1>=t)continue;let p=[c.pcb_via_id,l.pcb_via_id].sort().join("_");s.has(p)||(s.add(p),r.push({type:"pcb_via_clearance_error",pcb_error_id:`different_net_vias_close_${p}`,message:`Vias ${Ns(n,c.pcb_via_id)} and ${Ns(n,l.pcb_via_id)} from different nets are too close together (gap: ${u.toFixed(3)}mm)`,error_type:"pcb_via_clearance_error",pcb_via_ids:[c.pcb_via_id,l.pcb_via_id],minimum_clearance:t,actual_clearance:u,pcb_center:{x:(c.x+l.x)/2,y:(c.y+l.y)/2}}))}return r}var F9t=.2;function z9t(n){if(n.outline&&n.outline.length>0)return n.outline.map(e=>({x:e.x,y:e.y}));if(n.center&&typeof n.width=="number"&&typeof n.height=="number"){let e=n.center.x,t=n.center.y,i=n.width/2,r=n.height/2;return[{x:e-i,y:t-r},{x:e+i,y:t-r},{x:e+i,y:t+r},{x:e-i,y:t+r}]}return null}function VQ(n,e={}){let t=[],i=e.margin??F9t,r=n.find(a=>a.type==="pcb_board");if(!r)return t;let s=z9t(r);if(!s)return t;let o=Ke(n).pcb_trace.list();for(let a of o)if(!(a.route.length<2))for(let c=0;c<a.route.length-1;c++){let l=a.route[c],u=a.route[c+1];if(l.route_type!=="wire"||u.route_type!=="wire")continue;let p="width"in l?l.width:"width"in u?u.width:.1,f={x:l.x,y:l.y},y={x:u.x,y:u.y},g=1/0;for(let v=0;v<s.length;v++){let P=s[v],w=s[(v+1)%s.length],k=r_(f,y,P,w);k<g&&(g=k)}let x=p/2+i;if(g<x){let v={type:"pcb_trace_error",error_type:"pcb_trace_error",pcb_trace_error_id:`trace_too_close_to_board_${a.pcb_trace_id}_segment_${c}`,message:`Trace too close to board edge (${g.toFixed(3)}mm < ${x.toFixed(3)}mm required, margin: ${i}mm)`,pcb_trace_id:a.pcb_trace_id,source_trace_id:a.source_trace_id||"",center:{x:(f.x+y.x)/2,y:(f.y+y.y)/2},pcb_component_ids:[],pcb_port_ids:[]};t.push(v)}}return t}function $9t(n,e){let t=o_([n]),i=o_([e]);return Hc(t,i)}function GQ(n){let e=[],t=nr(n),i=Ke(n).pcb_smtpad.list(),r=Ke(n).pcb_plated_hole.list(),s=Ke(n).pcb_hole.list(),o=new Map;for(let c of i){let l=c.pcb_component_id||`standalone_pad_${Lo(c)}`;o.has(l)||o.set(l,{component_id:l,elements:[],bounds:{minX:0,minY:0,maxX:0,maxY:0}}),o.get(l).elements.push(c)}for(let c of r){let l=c.pcb_component_id||`standalone_plated_hole_${Lo(c)}`;o.has(l)||o.set(l,{component_id:l,elements:[],bounds:{minX:0,minY:0,maxX:0,maxY:0}}),o.get(l).elements.push(c)}for(let c of s){let l=`standalone_hole_${Lo(c)}`;o.set(l,{component_id:l,elements:[c],bounds:{minX:0,minY:0,maxX:0,maxY:0}})}for(let[c,l]of o)l.elements.length>0&&(l.bounds=o_(l.elements));let a=Array.from(o.values());for(let c=0;c<a.length;c++)for(let l=c+1;l<a.length;l++){let u=a[c],p=a[l];if(Hc(u.bounds,p.bounds))for(let f of u.elements)for(let y of p.elements){let g=Lo(f),x=Lo(y);if(!(f.type==="pcb_smtpad"&&y.type==="pcb_smtpad"&&t.areIdsConnected(g,x))&&$9t(f,y)){let v={type:"pcb_footprint_overlap_error",pcb_error_id:`pcb_footprint_overlap_${g}_${x}`,error_type:"pcb_footprint_overlap_error",message:`PCB component ${f.type} "${g}" overlaps with ${y.type} "${x}"`};(f.type==="pcb_smtpad"||y.type==="pcb_smtpad")&&(v.pcb_smtpad_ids=[],f.type==="pcb_smtpad"&&v.pcb_smtpad_ids.push(g),y.type==="pcb_smtpad"&&v.pcb_smtpad_ids.push(x)),(f.type==="pcb_plated_hole"||y.type==="pcb_plated_hole")&&(v.pcb_plated_hole_ids=[],f.type==="pcb_plated_hole"&&v.pcb_plated_hole_ids.push(g),y.type==="pcb_plated_hole"&&v.pcb_plated_hole_ids.push(x)),(f.type==="pcb_hole"||y.type==="pcb_hole")&&(v.pcb_hole_ids=[],f.type==="pcb_hole"&&v.pcb_hole_ids.push(g),y.type==="pcb_hole"&&v.pcb_hole_ids.push(x)),e.push(v)}}}return e}St();var EA=[{value:1e12,symbol:"T"},{value:1e9,symbol:"G"},{value:1e6,symbol:"M"},{value:1e3,symbol:"k"},{value:1,symbol:""},{value:.001,symbol:"m"},{value:1e-6,symbol:"\xB5"},{value:1e-9,symbol:"n"},{value:1e-12,symbol:"p"}];function xi(n){if(n==null)return"";if(n===0)return"0";let e=Math.abs(n),t=EA.find(s=>{let o=e/s.value;return o>=1&&o<1e3})||EA[EA.length-1],r=(n/t.value).toPrecision(3);return r.includes(".")&&!/\.0+$/.test(r)&&(r=r.replace(/0+$/,"")),r=r.replace(/\.0+$/,""),`${r}${t.symbol}`}St();St();Q();Ae();Ag();var D9t=class{constructor(){d(this,"MAX_ITERATIONS",1e5);d(this,"solved",!1);d(this,"failed",!1);d(this,"iterations",0);d(this,"progress",0);d(this,"error",null);d(this,"activeSubSolver");d(this,"failedSubSolvers");d(this,"timeToSolve");d(this,"stats",{});d(this,"_setupDone",!1)}setup(){this._setupDone||(this._setup(),this._setupDone=!0)}_setup(){}step(){if(this._setupDone||this.setup(),!this.solved&&!this.failed){this.iterations++;try{this._step()}catch(n){throw this.error=`${this.constructor.name} error: ${n}`,console.error(this.error),this.failed=!0,n}!this.solved&&this.iterations>=this.MAX_ITERATIONS&&this.tryFinalAcceptance(),!this.solved&&this.iterations>=this.MAX_ITERATIONS&&(this.error=`${this.constructor.name} ran out of iterations`,console.error(this.error),this.failed=!0),"computeProgress"in this&&(this.progress=this.computeProgress())}}_step(){}getConstructorParams(){throw new Error("getConstructorParams not implemented")}getOutput(){return null}solve(){let n=Date.now();for(;!this.solved&&!this.failed;)this.step();let e=Date.now();this.timeToSolve=e-n}visualize(){return{lines:[],points:[],rects:[],circles:[]}}tryFinalAcceptance(){}preview(){return{lines:[],points:[],rects:[],circles:[]}}};var HQ=class extends D9t{constructor(e){super();d(this,"startTimeOfPhase",{});d(this,"endTimeOfPhase",{});d(this,"timeSpentOnPhase",{});d(this,"firstIterationOfPhase",{});d(this,"currentPipelineStepIndex",0);d(this,"inputProblem");d(this,"pipelineOutputs",{});this.inputProblem=e,this.MAX_ITERATIONS=1e6}_step(){let e=this.pipelineDef[this.currentPipelineStepIndex];if(!e){this.solved=!0;return}if(this.activeSubSolver){if(this.activeSubSolver.step(),this.activeSubSolver.solved){this.endTimeOfPhase[e.solverName]=performance.now(),this.timeSpentOnPhase[e.solverName]=this.endTimeOfPhase[e.solverName]-this.startTimeOfPhase[e.solverName];let i=this.activeSubSolver.getOutput();i!==null&&(this.pipelineOutputs[e.solverName]=i),e.onSolved?.(this),this.activeSubSolver=null,this.currentPipelineStepIndex++}else this.activeSubSolver.failed&&(this.error=this.activeSubSolver?.error,this.failed=!0,this.activeSubSolver=null);return}let t=e.getConstructorParams(this);this.activeSubSolver=new e.solverClass(...t),this[e.solverName]=this.activeSubSolver,this.timeSpentOnPhase[e.solverName]=0,this.startTimeOfPhase[e.solverName]=performance.now(),this.firstIterationOfPhase[e.solverName]=this.iterations}solveUntilPhase(e){for(;this.getCurrentPhase().toLowerCase()!==e.toLowerCase()&&(this.step(),!(this.failed||this.solved)););}getCurrentPhase(){return this.pipelineDef[this.currentPipelineStepIndex]?.solverName??"none"}getPhaseProgress(){let e=this.pipelineDef.length;if(e===0)return 1;let t=this.activeSubSolver?.progress??0;return(this.currentPipelineStepIndex+t)/e}getPhaseStats(){let e={};for(let t of this.pipelineDef){let i=this.timeSpentOnPhase[t.solverName]||0,r=this.firstIterationOfPhase[t.solverName]||0,s=this.iterations,o=t.solverName===this.getCurrentPhase()?s-r:0,a=this.currentPipelineStepIndex>this.pipelineDef.findIndex(c=>c.solverName===t.solverName);e[t.solverName]={timeSpent:i,iterations:o,completed:a}}return e}visualize(){if(!this.solved&&this.activeSubSolver)return this.activeSubSolver.visualize();let e=this.pipelineDef.map((t,i)=>{let s=this[t.solverName]?.visualize();if(!s)return null;for(let o of s.rects??[])o.step=i;for(let o of s.points??[])o.step=i;for(let o of s.circles??[])o.step=i;for(let o of s.texts??[])o.step=i;for(let o of s.lines??[])o.step=i;return s}).filter(Boolean);return e.length===0?{points:[],rects:[],lines:[],circles:[],texts:[]}:e.length===1?e[0]:{points:e.flatMap(t=>t.points||[]),rects:e.flatMap(t=>t.rects||[]),lines:e.flatMap(t=>t.lines||[]),circles:e.flatMap(t=>t.circles||[]),texts:e.flatMap(t=>t.texts||[])}}preview(){return this.activeSubSolver?this.activeSubSolver.preview():super.preview()}computeProgress(){return this.getPhaseProgress()}getStepOutput(e){return this.pipelineOutputs[e]}getAllOutputs(){return{...this.pipelineOutputs}}hasStepOutput(e){return e in this.pipelineOutputs}getSolver(e){return this[e]}};var j9t=n=>{let e=n.board_edge_margin??0;if(n.outline&&n.outline.length>0){let r=new L.Polygon(n.outline.map(s=>L.point(s.x,s.y)));return r.orientation()===L.ORIENTATION.CW&&r.reverse(),r}let{bounds:t}=n,i={minX:t.minX+e,minY:t.minY+e,maxX:t.maxX-e,maxY:t.maxY-e};return i.minX>=i.maxX||i.minY>=i.maxY?new L.Polygon:new L.Polygon(new L.Box(i.minX,i.minY,i.maxX,i.maxY).toPoints())},MA=(n,e=32)=>{let t=[];for(let i=0;i<e;i++){let r=i/e*2*Math.PI;t.push(new L.Point(n.center.x+n.r*Math.cos(r),n.center.y+n.r*Math.sin(r)))}return new L.Polygon(t)},B9t=n=>n.shape==="rect",Y9t=n=>n.shape==="trace",X9t=n=>n.shape==="circle",U9t=n=>n.shape==="polygon",V9t=(n,e,t,i)=>{let r=[],{padMargin:s,traceMargin:o,board_edge_margin:a,cutoutMargin:c}=t;if(i&&i.length>0&&a&&a>0){let l=new L.Polygon(i.map(p=>L.point(p.x,p.y)));l.area()<0&&l.reverse();let u=l.vertices;for(let p=0;p<u.length;p++){let f=u[p===0?u.length-1:p-1],y=u[p],g=u[(p+1)%u.length];if(!f||!y||!g)continue;let x=new L.Vector(f,y),v=new L.Vector(y,g),P=x.cross(v),w=new L.Circle(y,a);if(r.push(MA(w)),P<0){let k=new L.Box(y.x-a,y.y-a,y.x+a,y.y+a);r.push(new L.Polygon(k.toPoints()))}}for(let p=0;p<u.length;p++){let f=u[p],y=u[(p+1)%u.length];if(!f||!y)continue;let g=Math.hypot(f.x-y.x,f.y-y.y);if(g===0)continue;let x=a*2,v=(f.x+y.x)/2,P=(f.y+y.y)/2,w=Math.atan2(y.y-f.y,y.x-f.x)*180/Math.PI,k=g/2,T=x/2,I=w*Math.PI/180,E=Math.cos(I),N=Math.sin(I),A=[{x:-k,y:-T},{x:k,y:-T},{x:k,y:T},{x:-k,y:T}].map(R=>({x:v+R.x*E-R.y*N,y:P+R.x*N+R.y*E}));r.push(new L.Polygon(A.map(R=>L.point(R.x,R.y))))}}for(let l of n){if(l.connectivityKey===e)continue;let p=l.connectivityKey.startsWith("hole:")||l.connectivityKey.startsWith("cutout:");if(X9t(l)){let f=p?c??0:s,y=new L.Circle(new L.Point(l.x,l.y),l.radius+f);r.push(MA(y));continue}if(B9t(l)){let f=p?c??0:s,{bounds:y}=l,g=new L.Box(y.minX-f,y.minY-f,y.maxX+f,y.maxY+f);r.push(new L.Polygon(g.toPoints()));continue}if(U9t(l)){let f=p?c??0:0,y=new Set,g=l.points.filter(k=>{let T=`${k.x},${k.y}`;return y.has(T)?!1:(y.add(T),!0)});if(g.length<3)continue;let x=new L.Polygon(g.map(k=>L.point(k.x,k.y)));if(Math.abs(x.area())<1e-9)continue;if(f<=0){r.push(x);continue}x.area()>0&&x.reverse();let v=[],P=x.vertices;for(let k=0;k<P.length;k++){let T=P[k],I=P[(k+1)%P.length],E=L.segment(T,I);if(E.length===0)continue;let N=L.line(E.start,E.end),M=N.norm,A=N.translate(M.multiply(-f));v.push(A)}let w=[];for(let k=0;k<v.length;k++){let T=v[k],I=v[(k+1)%v.length],E=T.intersect(I);E.length>0&&w.push(E[0])}w.length>=3&&r.push(new L.Polygon(w));continue}if(Y9t(l)){for(let f of l.segments){let y=new L.Circle(new L.Point(f.x,f.y),l.width/2+o);r.push(MA(y))}for(let f=0;f<l.segments.length-1;f++){let y=l.segments[f],g=l.segments[f+1];if(!y||!g)continue;let x=Math.hypot(y.x-g.x,y.y-g.y);if(x===0)continue;let v=l.width+o*2,P=(y.x+g.x)/2,w=(y.y+g.y)/2,k=Math.atan2(g.y-y.y,g.x-y.x)*180/Math.PI,T=x/2,I=v/2,E=k*Math.PI/180,N=Math.cos(E),M=Math.sin(E),R=[{x:-T,y:-I},{x:T,y:-I},{x:T,y:I},{x:-T,y:I}].map(j=>({x:P+j.x*N-j.y*M,y:w+j.x*M+j.y*N}));r.push(new L.Polygon(R.map(j=>L.point(j.x,j.y))))}continue}}return{polygonsToSubtract:r}},WQ=n=>n.edges.map(e=>{let t={x:e.start.x,y:e.start.y};if(e.isArc){let i=Math.tan(e.shape.sweep/4);Math.abs(i)>1e-9&&(t.bulge=i)}return t}),G9t=n=>{let e=[],t=Array.isArray(n)?n:[n];for(let i of t){let r=i.splitToIslands();for(let s of r){if(s.isEmpty())continue;let o=[...s.faces],a=o.find(p=>p.orientation()===L.ORIENTATION.CCW),c=o.filter(p=>p.orientation()===L.ORIENTATION.CW);if(!a)continue;a.reverse();let l=WQ(a),u=c.map(p=>(p.reverse(),{vertices:WQ(p)}));e.push({outer_ring:{vertices:l},inner_rings:u})}}return e},qQ=class extends HQ{constructor(e){super(e);d(this,"pipelineDef",[]);this.input=e}getOutput(){let e=[];for(let t of this.input.regionsForPour){let i=j9t(t),r=this.input.pads.filter(c=>c.layer===t.layer),{polygonsToSubtract:s}=V9t(r,t.connectivityKey,{padMargin:t.padMargin,traceMargin:t.traceMargin,board_edge_margin:t.board_edge_margin,cutoutMargin:t.cutout_margin},t.outline),o=i;for(let c of s){let l=Array.isArray(o)?o:[o],u=[];for(let p of l){let f=L.BooleanOperations.subtract(p,c);f&&(Array.isArray(f)?u.push(...f.filter(y=>!y.isEmpty())):f.isEmpty()||u.push(f))}o=u}let a=G9t(o);e.push(...a)}return{brep_shapes:e}}},ZQ=(n,e)=>{let t=n.filter(k=>k.type==="source_port"),i=n.filter(k=>k.type==="pcb_port"),r=n.filter(k=>k.type==="source_trace"),s=n.filter(k=>k.type==="pcb_trace"),o=n.filter(k=>k.type==="source_net"),a=n.find(k=>k.type==="pcb_board");if(!a)throw new Error("No pcb_board found in circuit json");let c=Object.fromEntries(t.map(k=>[k.source_port_id,k.subcircuit_connectivity_map_key])),l=Object.fromEntries(i.map(k=>[k.pcb_port_id,c[k.source_port_id]])),u={};for(let k of i)k.pcb_port_id&&(u[k.pcb_port_id]=l[k.pcb_port_id]);let p=Object.fromEntries(r.map(k=>[k.source_trace_id,k.subcircuit_connectivity_map_key])),f=Object.fromEntries(o.map(k=>[k.source_net_id,k.subcircuit_connectivity_map_key])),y={...p,...f},g=Object.fromEntries(s.map(k=>[k.pcb_trace_id,k.source_trace_id?y[k.source_trace_id]:void 0]).filter(k=>!!k[1])),x=[];for(let k of n)if(k.type==="pcb_smtpad"){let T=k;if(T.layer!==e.layer)continue;let I;T.pcb_port_id&&(I=l[T.pcb_port_id]),I||(I=`unconnected:${T.pcb_smtpad_id}`),T.shape==="rect"?x.push({shape:"rect",padId:T.pcb_smtpad_id,layer:T.layer,connectivityKey:I,bounds:{minX:T.x-T.width/2,minY:T.y-T.height/2,maxX:T.x+T.width/2,maxY:T.y+T.height/2}}):T.shape==="circle"&&x.push({shape:"circle",padId:T.pcb_smtpad_id,layer:T.layer,connectivityKey:I,x:T.x,y:T.y,radius:T.radius})}else if(k.type==="pcb_plated_hole"){let T=k;if(T.shape!=="circle"||!T.layers.includes(e.layer))continue;let I=u[T.pcb_plated_hole_id];I||(I=`unconnected-plated-hole:${T.pcb_plated_hole_id}`),x.push({shape:"circle",padId:T.pcb_plated_hole_id,layer:e.layer,connectivityKey:I,x:T.x,y:T.y,radius:T.outer_diameter/2})}else if(k.type==="pcb_hole"){let T=k;if(T.hole_shape!=="circle")continue;x.push({shape:"circle",padId:T.pcb_hole_id,layer:e.layer,connectivityKey:`hole:${T.pcb_hole_id}`,x:T.x,y:T.y,radius:T.hole_diameter/2})}else if(k.type==="pcb_cutout"){let T=k;T.shape==="rect"?x.push({shape:"rect",padId:T.pcb_cutout_id,layer:e.layer,connectivityKey:`cutout:${T.pcb_cutout_id}`,bounds:{minX:T.center.x-T.width/2,minY:T.center.y-T.height/2,maxX:T.center.x+T.width/2,maxY:T.center.y+T.height/2}}):T.shape==="circle"?x.push({shape:"circle",padId:T.pcb_cutout_id,layer:e.layer,connectivityKey:`cutout:${T.pcb_cutout_id}`,x:T.center.x,y:T.center.y,radius:T.radius}):T.shape==="polygon"&&x.push({shape:"polygon",padId:T.pcb_cutout_id,layer:e.layer,connectivityKey:`cutout:${T.pcb_cutout_id}`,points:T.points})}else if(k.type==="pcb_via"){let T=k;if(!T.layers.includes(e.layer))continue;let I=T.subcircuit_connectivity_map_key??g[T.pcb_trace_id??""]??`unconnected-via:${T.pcb_via_id}`;x.push({shape:"circle",padId:T.pcb_via_id,layer:e.layer,connectivityKey:I,x:T.x,y:T.y,radius:T.outer_diameter/2})}else if(k.type==="pcb_trace"){let T=k;if(!T.source_trace_id)continue;let I=y[T.source_trace_id];if(!I)continue;let E=[],N=null,M=()=>{E.length>1&&x.push({shape:"trace",padId:`${T.pcb_trace_id}-${x.length}`,layer:e.layer,connectivityKey:I,segments:E,width:N}),E=[],N=null};for(let A of T.route){let R=A;R.route_type==="wire"&&R.layer===e.layer?(N===null&&(N=R.width),E.push({x:R.x,y:R.y})):M()}M()}let{width:v,height:P}=a,w=[{shape:"rect",layer:e.layer,bounds:{minX:-v/2,minY:-P/2,maxX:v/2,maxY:P/2},outline:a.outline,connectivityKey:e.pour_connectivity_key,padMargin:e.pad_margin,traceMargin:e.trace_margin,board_edge_margin:e.board_edge_margin??0,cutout_margin:e.cutout_margin}];return{pads:x,regionsForPour:w}};Ta();St();Ae();var cit=Gt(qs(),1);var c9=Gt(Mn(),1),V_=Gt(qs(),1),c1e=Gt(qs(),1);var Nd=Gt(kd(),1);var lit=Gt(kd(),1),uit=Gt(kd(),1);var pit=Gt(kd(),1);var hit=Gt(kd(),1);var dit=Gt(kd(),1),fit=Gt(qs(),1);var H8t=Object.defineProperty,W8t=(n,e)=>{for(var t in e)H8t(n,t,{get:e[t],enumerable:!0})},zet={};W8t(zet,{AnalogSimulation:()=>oit,Battery:()=>Bnt,Board:()=>y9,Breakout:()=>Rnt,BreakoutPoint:()=>Ont,CadAssembly:()=>Qet,CadModel:()=>Jet,Capacitor:()=>g9,Chip:()=>U1,Constraint:()=>Snt,CopperPour:()=>jnt,Crystal:()=>Gnt,Cutout:()=>B1,Diode:()=>x9,FabricationNoteDimension:()=>Tnt,FabricationNotePath:()=>Pnt,FabricationNoteRect:()=>wnt,FabricationNoteText:()=>knt,Footprint:()=>qet,Fuse:()=>_nt,Group:()=>_l,Hole:()=>G_,Inductor:()=>v9,Jumper:()=>ynt,Keepout:()=>Jw,Led:()=>xnt,Mosfet:()=>Hnt,Net:()=>p9,NetLabel:()=>Lnt,NormalComponent:()=>Hn,Panel:()=>fnt,PcbNoteDimension:()=>Nnt,PcbNoteLine:()=>Ent,PcbNotePath:()=>Int,PcbNoteRect:()=>Mnt,PcbNoteText:()=>Cnt,PcbTrace:()=>d9,PinHeader:()=>Ynt,Pinout:()=>mnt,PlatedHole:()=>Id,Port:()=>Gi,Potentiometer:()=>Unt,PowerSource:()=>bnt,PrimitiveComponent:()=>Ee,PushButton:()=>Vnt,Renderable:()=>l9,Resistor:()=>b9,Resonator:()=>Xnt,SchematicArc:()=>Qnt,SchematicBox:()=>eit,SchematicCell:()=>rit,SchematicCircle:()=>tit,SchematicLine:()=>Knt,SchematicRect:()=>Jnt,SchematicRow:()=>iit,SchematicTable:()=>nit,SchematicText:()=>Znt,SilkscreenCircle:()=>Fnt,SilkscreenLine:()=>$nt,SilkscreenPath:()=>h9,SilkscreenRect:()=>znt,SilkscreenText:()=>iP,SmtPad:()=>j1,SolderJumper:()=>gnt,Subcircuit:()=>Ant,Switch:()=>Wnt,Symbol:()=>sit,TestPoint:()=>qnt,Trace:()=>Fs,TraceHint:()=>m9,Transistor:()=>S9,Via:()=>Dnt,VoltageProbe:()=>ait,VoltageSource:()=>vnt});var q8t=(0,jet.default)("tscircuit:renderable"),Xa=["ReactSubtreesRender","InflateSubcircuitCircuitJson","SourceNameDuplicateComponentRemoval","PcbFootprintStringRender","InitializePortsFromChildren","CreateNetsFromProps","AssignFallbackProps","CreateTracesFromProps","CreateTracesFromNetLabels","CreateTraceHintsFromProps","SourceGroupRender","AssignNameToUnnamedComponents","SourceRender","SourceParentAttachment","PortMatching","OptimizeSelectorCache","SourceTraceRender","SourceAddConnectivityMapKey","SourceDesignRuleChecks","SimulationRender","SchematicComponentRender","SchematicPortRender","SchematicPrimitiveRender","SchematicComponentSizeCalculation","SchematicLayout","SchematicTraceRender","SchematicReplaceNetLabelsWithSymbols","PcbComponentRender","PcbPrimitiveRender","PcbFootprintLayout","PcbPortRender","PcbPortAttachment","PcbComponentSizeCalculation","PcbComponentAnchorAlignment","PcbLayout","PcbBoardAutoSize","PcbTraceHintRender","PcbManualTraceRender","PcbTraceRender","PcbRouteNetIslands","PcbCopperPourRender","PcbDesignRuleChecks","SilkscreenOverlapAdjustment","CadModelRender","PartsEngineRender","SimulationSpiceEngineRender"],Z8t={PcbFootprintLayout:["PcbFootprintStringRender"],PcbComponentSizeCalculation:["PcbFootprintStringRender"],PcbLayout:["PcbFootprintStringRender"],PcbBoardAutoSize:["PcbFootprintStringRender"],PcbTraceHintRender:["PcbFootprintStringRender"],PcbManualTraceRender:["PcbFootprintStringRender"],PcbCopperPourRender:["PcbFootprintStringRender","PcbTraceRender","PcbRouteNetIslands"],PcbTraceRender:["PcbFootprintStringRender"],PcbRouteNetIslands:["PcbFootprintStringRender"],PcbDesignRuleChecks:["PcbFootprintStringRender"],SilkscreenOverlapAdjustment:["PcbFootprintStringRender"],CadModelRender:["PcbFootprintStringRender"],PartsEngineRender:["PcbFootprintStringRender"],PcbComponentAnchorAlignment:["PcbFootprintStringRender"]},K8t=0,l9=class Bet{constructor(e){d(this,"renderPhaseStates");d(this,"shouldBeRemoved",!1);d(this,"children");d(this,"isPcbPrimitive",!1);d(this,"isSchematicPrimitive",!1);d(this,"_renderId");d(this,"_currentRenderPhase",null);d(this,"_asyncEffects",[]);d(this,"parent",null);this._renderId=`${K8t++}`,this.children=[],this.renderPhaseStates={};for(let t of Xa)this.renderPhaseStates[t]={initialized:!1,dirty:!1}}_markDirty(e){this.renderPhaseStates[e].dirty=!0;let t=Xa.indexOf(e);for(let i=t+1;i<Xa.length;i++)this.renderPhaseStates[Xa[i]].dirty=!0;this.parent?._markDirty&&this.parent._markDirty(e)}_queueAsyncEffect(e,t){let i={promise:t(),phase:this._currentRenderPhase,effectName:e,complete:!1};this._asyncEffects.push(i),"root"in this&&this.root&&this.root.emit("asyncEffect:start",{effectName:e,componentDisplayName:this.getString(),phase:i.phase}),i.promise.then(()=>{i.complete=!0,"root"in this&&this.root&&this.root.emit("asyncEffect:end",{effectName:e,componentDisplayName:this.getString(),phase:i.phase})}).catch(r=>{console.error(`Async effect error in ${i.phase} "${e}":
${r.stack}`),i.complete=!0,"root"in this&&this.root&&this.root.emit("asyncEffect:end",{effectName:e,componentDisplayName:this.getString(),phase:i.phase,error:r.toString()})})}_emitRenderLifecycleEvent(e,t){q8t(`${e}:${t} ${this.getString()}`);let i=`renderable:renderLifecycle:${e}:${t}`,r={renderId:this._renderId,componentDisplayName:this.getString(),type:i};"root"in this&&this.root&&(this.root.emit(i,r),this.root.emit("renderable:renderLifecycle:anyEvent",{...r,type:i}))}getString(){return this.constructor.name}_hasIncompleteAsyncEffects(){return this._asyncEffects.some(e=>!e.complete)}_hasIncompleteAsyncEffectsInSubtreeForPhase(e){for(let t of this._asyncEffects)if(!t.complete&&t.phase===e)return!0;for(let t of this.children)if(t._hasIncompleteAsyncEffectsInSubtreeForPhase(e))return!0;return!1}getCurrentRenderPhase(){return this._currentRenderPhase}getRenderGraph(){return{id:this._renderId,currentPhase:this._currentRenderPhase,renderPhaseStates:this.renderPhaseStates,shouldBeRemoved:this.shouldBeRemoved,children:this.children.map(e=>e.getRenderGraph())}}getTopLevelRenderable(){let e=this;for(;e.parent&&e.parent instanceof Bet;)e=e.parent;return e}runRenderCycle(){for(let e of Xa)this.runRenderPhaseForChildren(e),this.runRenderPhase(e)}runRenderPhase(e){this._currentRenderPhase=e;let t=this.renderPhaseStates[e],i=t.initialized,r=t.dirty;if(!i&&this.shouldBeRemoved)return;if(this.shouldBeRemoved&&i){this._emitRenderLifecycleEvent(e,"start"),this?.[`remove${e}`]?.(),t.initialized=!1,t.dirty=!1,this._emitRenderLifecycleEvent(e,"end");return}let s=Xa.indexOf(e)-1;if(s>=0){let a=Xa[s];if(this._asyncEffects.filter(l=>l.phase===a).some(l=>!l.complete))return}let o=Z8t[e]||[];if(o.length>0){let a=this.getTopLevelRenderable();for(let c of o)if(a._hasIncompleteAsyncEffectsInSubtreeForPhase(c))return}if(this._emitRenderLifecycleEvent(e,"start"),i){r&&(this?.[`update${e}`]?.(),t.dirty=!1),this._emitRenderLifecycleEvent(e,"end");return}t.dirty=!1,this?.[`doInitial${e}`]?.(),t.initialized=!0,this._emitRenderLifecycleEvent(e,"end")}runRenderPhaseForChildren(e){for(let t of this.children)t.runRenderPhaseForChildren(e),t.runRenderPhase(e)}renderError(e){throw typeof e=="string"?new Error(e):new Error(JSON.stringify(e,null,2))}},Kw={},Yet=n=>{let e=Object.fromEntries(Object.entries(n).map(([t,i])=>[t.toLowerCase(),i]));Object.assign(Kw,n),Object.assign(Kw,e)},J8t=class extends Error{constructor(n,e,t){let i,r=Object.keys(t).filter(c=>c!=="_errors"),s=[],o=e.pinLabels;if(o)for(let[c,l]of Object.entries(o)){let u=Array.isArray(l)?l:[l];for(let p of u)typeof p=="string"&&(p.startsWith(" ")||p.endsWith(" "))&&s.push(`pinLabels.${c} ("${p}" has leading or trailing spaces)`)}let a=r.map(c=>c==="pinLabels"&&s.length>0?s.join(", "):t[c]._errors[0]?`${c} (${t[c]._errors[0]})`:`${c} (${JSON.stringify(t[c])})`).join(", ");"name"in e?i=`Invalid props for ${n} "${e.name}": ${a}`:"footprint"in e&&typeof e.footprint=="string"?i=`Invalid props for ${n} (unnamed ${e.footprint} component): ${a}`:i=`Invalid props for ${n} (unnamed): ${a}`,super(i),this.componentName=n,this.originalProps=e,this.formattedError=t}};function HA(n,e){let t=e.match(/^#(\w+)/);if(t)return n.props.id===t[1];let i=e.match(/^\.(\w+)/);if(i)return n.isMatchingNameOrAlias(i[1]);let[r,...s]=e.split(/(?=[#.[])/);return r==="pin"&&(r="port"),r&&r!=="*"&&n.lowercaseComponentName!==r.toLowerCase()?!1:s.every(o=>{if(o.startsWith("#"))return n.props.id===o.slice(1);if(o.startsWith("."))return n.isMatchingNameOrAlias(o.slice(1));let a=o.match(/\[(\w+)=['"]?(.+?)['"]?\]/);if(!a)return!0;let[,c,l]=a;return n.props[c].toString()===l})}var u9={isTag:n=>!0,getParent:n=>n.parent,getChildren:n=>n.children,getName:n=>n.lowercaseComponentName,getAttributeValue:(n,e)=>{if(e==="class"&&"getNameAndAliases"in n)return n.getNameAndAliases().join(" ");if(e==="name"&&n._parsedProps?.name)return n._parsedProps.name;if(n._parsedProps&&e in n._parsedProps){let i=n._parsedProps[e];return typeof i=="string"?i:i!=null?String(i):null}if(e in n){let i=n[e];return typeof i=="string"?i:i!=null?String(i):null}let t=n._attributeLowerToCamelNameMap;if(t){let i=t[e];if(i&&i in n){let r=n[i];return typeof r=="string"?r:r!=null?String(r):null}}return null},hasAttrib:(n,e)=>{if(e==="class")return!!n._parsedProps?.name;if(n._parsedProps&&e in n._parsedProps||e in n)return!0;let t=n._attributeLowerToCamelNameMap;if(t){let i=t[e];if(i&&i in n)return!0}return!1},getSiblings:n=>n.parent?n.parent.children:[],prevElementSibling:n=>{if(!n.parent)return null;let e=n.parent.children,t=e.indexOf(n);return t>0?e[t-1]:null},getText:()=>"",removeSubsets:n=>n.filter((e,t)=>!n.some((i,r)=>t!==r&&i!==e&&i.getDescendants().includes(e))),existsOne:(n,e)=>e.some(n),findAll:(n,e)=>{let t=[],i=r=>{n(r)&&t.push(r);for(let s of r.children)i(s)};for(let r of e)i(r);return t},findOne:(n,e)=>{for(let t of e){if(n(t))return t;let i=t.children;if(i.length>0){let r=u9.findOne(n,i);if(r)return r}}return null},equals:(n,e)=>n._renderId===e._renderId,isHovered:n=>!1,isVisited:n=>!1,isActive:n=>!1},Q8t={...u9,getChildren:n=>n.children.filter(e=>!e.isSubcircuit)},uet={...u9,getChildren:n=>n.children.filter(e=>e.isSubcircuit)},tOt=(n,e)=>{let t=n.split("net.")[1]?.split(/[ >]/)[0]??n;return`Net names cannot contain "+" or "-" (component "${e?.componentName??"Unknown component"}" received "${t}" via "${n}"). Try using underscores instead, e.g. VCC_P`},pet=(n,e)=>{if(/net\.[^\s>]*\./.test(n))throw new Error('Net names cannot contain a period, try using "sel.net..." to autocomplete with conventional net names, e.g. V3_3');if(/net\.[^\s>]*[+-]/.test(n))throw new Error(tOt(n,e));if(/net\.[0-9]/.test(n)){let t=n.match(/net\.([^ >]+)/),i=t?t[1]:"";throw new Error(`Net name "${i}" cannot start with a number, try using a prefix like "VBUS1"`)}return n.replace(/ pin(?=[\d.])/g," port").replace(/ subcircuit\./g," group[isSubcircuit=true]").replace(/([^ ])\>([^ ])/g,"$1 > $2").replace(/(^|[ >])(?!pin\.)(?!port\.)(?!net\.)([A-Z][A-Za-z0-9_-]*)\.([A-Za-z0-9_-]+)/g,(t,i,r,s)=>{let o=/^\d+$/.test(s)?`pin${s}`:s;return`${i}.${r} > .${o}`}).trim()},WA={adapter:Q8t,cacheResults:!0},Ee=class extends l9{constructor(e){super(e);d(this,"parent",null);d(this,"children");d(this,"childrenPendingRemoval");d(this,"props");d(this,"_parsedProps");d(this,"externallyAddedAliases");d(this,"isPrimitiveContainer",!1);d(this,"canHaveTextChildren",!1);d(this,"source_group_id",null);d(this,"source_component_id",null);d(this,"schematic_component_id",null);d(this,"pcb_component_id",null);d(this,"cad_component_id",null);d(this,"fallbackUnassignedName");d(this,"_cachedSelectAllQueries",new Map);d(this,"_cachedSelectOneQueries",new Map);this.children=[],this.childrenPendingRemoval=[],this.props=e??{},this.externallyAddedAliases=[];let i=("partial"in this.config.zodProps?this.config.zodProps.partial({name:!0}):this.config.zodProps).safeParse(e??{});if(i.success)this._parsedProps=i.data;else throw new J8t(this.lowercaseComponentName,this.props,i.error.format())}get config(){return{componentName:"",zodProps:h.object({}).passthrough()}}get componentName(){return this.config.componentName}getInheritedProperty(e){let t=this;for(;t;){if(t._parsedProps&&e in t._parsedProps)return t._parsedProps[e];t=t.parent}if(this.root?.platform&&e in this.root.platform)return this.root.platform[e]}getInheritedMergedProperty(e){let t=this.parent?.getInheritedMergedProperty?.(e),i=this._parsedProps?.[e];return{...t,...i}}get lowercaseComponentName(){return this.componentName.toLowerCase()}get isSubcircuit(){return!!this.props.subcircuit||this.lowercaseComponentName==="group"&&this?.parent?.isRoot}get isGroup(){return this.lowercaseComponentName==="group"}get name(){return this._parsedProps.name??this.fallbackUnassignedName}setProps(e){let t=this.config.zodProps.parse({...this.props,...e}),i=this.props;this.props=t,this._parsedProps=this.config.zodProps.parse(e),this.onPropsChange({oldProps:i,newProps:t,changedProps:Object.keys(e)}),this.parent?.onChildChanged?.(this)}_getPcbRotationBeforeLayout(){let{pcbRotation:e}=this.props;return typeof e=="string"?parseFloat(e):e??null}computePcbPropsTransform(){let{_parsedProps:e}=this,t=this._getPcbRotationBeforeLayout()??0;return _i(Rn(e.pcbX??0,e.pcbY??0),$c(t*Math.PI/180))}_computePcbGlobalTransformBeforeLayout(){let e=this.getSubcircuit()._getPcbManualPlacementForComponent(this);if(e&&this.props.pcbX===void 0&&this.props.pcbY===void 0){let t=this._getPcbRotationBeforeLayout()??0;return _i(this.parent?._computePcbGlobalTransformBeforeLayout()??tr(),_i(Rn(e.x,e.y),$c(t*Math.PI/180)))}if(this.isPcbPrimitive){let t=this.getPrimitiveContainer();if(t&&t._parsedProps.layer==="bottom")return _i(this.parent?._computePcbGlobalTransformBeforeLayout()??tr(),EB(),this.computePcbPropsTransform())}return _i(this.parent?._computePcbGlobalTransformBeforeLayout()??tr(),this.computePcbPropsTransform())}getPrimitiveContainer(){return this.isPrimitiveContainer?this:this.parent?.getPrimitiveContainer?.()??null}getParentNormalComponent(){let e=this.parent;for(;e;){if(e.isPrimitiveContainer&&e.doInitialPcbComponentRender)return e;e=e.parent}return null}_getPcbCircuitJsonBounds(){return{center:{x:0,y:0},bounds:{left:0,top:0,right:0,bottom:0},width:0,height:0}}_getPcbPrimitiveFlippedHelpers(){let e=this.getPrimitiveContainer(),t=e?e._parsedProps.layer==="bottom":!1;return{isFlipped:t,maybeFlipLayer:r=>t?r==="top"?"bottom":"top":r}}_setPositionFromLayout(e){throw new Error(`_setPositionFromLayout not implemented for ${this.componentName}`)}computeSchematicPropsTransform(){let{_parsedProps:e}=this;return _i(Rn(e.schX??0,e.schY??0))}computeSchematicGlobalTransform(){let e=this._getSchematicGlobalManualPlacementTransform(this);return e||_i(this.parent?.computeSchematicGlobalTransform?.()??tr(),this.computeSchematicPropsTransform())}_getSchematicSymbolName(){let{_parsedProps:e}=this,t=this.config.schematicSymbolName,i={horizontal:0,pos_left:0,neg_right:0,pos_right:180,neg_left:180,pos_top:270,neg_bottom:90,vertical:270,pos_bottom:90,neg_top:90},r=e.schOrientation!==void 0?i[e.schOrientation]:e.schRotation;if(r===void 0&&(r=0),r=r%360,r<0&&(r+=360),e.schRotation!==void 0&&r%90!==0)throw new Error(`Schematic rotation ${e.schRotation} is not supported for ${this.componentName}`);let s=`${t}_horz`,o=`${t}_vert`,a=`${t}_up`,c=`${t}_down`,l=`${t}_left`,u=`${t}_right`;if(u in yi&&r===0)return u;if(a in yi&&r===90)return a;if(l in yi&&r===180)return l;if(c in yi&&r===270)return c;if(s in yi&&(r===0||r===180))return s;if(o in yi&&(r===90||r===270))return o;if(t in yi)return t}_getSchematicSymbolNameOrThrow(){let e=this._getSchematicSymbolName();if(!e)throw new Error(`No schematic symbol found (given: "${this.config.schematicSymbolName}")`);return e}getSchematicSymbol(){let e=this._getSchematicSymbolName();return e?yi[e]??null:null}_getPcbManualPlacementForComponent(e){if(!this.isSubcircuit)return null;let t=this.props.manualEdits;if(!t)return null;let i=t?.pcb_placements;if(!i)return null;for(let r of i)if(HA(e,r.selector)||e.props.name===r.selector)return $e(this._computePcbGlobalTransformBeforeLayout(),r.center);return null}_getSchematicManualPlacementForComponent(e){if(!this.isSubcircuit)return null;let t=this.props.manualEdits;if(!t)return null;let i=t.schematic_placements;if(!i)return null;for(let r of i)if(HA(e,r.selector)||e.props.name===r.selector)return $e(this.computeSchematicGlobalTransform(),r.center);return null}_getSchematicGlobalManualPlacementTransform(e){let t=this.getSubcircuit()?._parsedProps.manualEdits;if(!t)return null;for(let i of t.schematic_placements??[])if((HA(e,i.selector)||e.props.name===i.selector)&&i.relative_to==="group_center")return _i(this.parent?._computePcbGlobalTransformBeforeLayout()??tr(),Rn(i.center.x,i.center.y));return null}_getGlobalPcbPositionBeforeLayout(){return $e(this._computePcbGlobalTransformBeforeLayout(),{x:0,y:0})}_getGlobalSchematicPositionBeforeLayout(){return $e(this.computeSchematicGlobalTransform(),{x:0,y:0})}get root(){return this.parent?.root??null}onAddToParent(e){this.parent=e}onPropsChange(e){}onChildChanged(e){this.parent?.onChildChanged?.(e)}add(e){let t=e.__text;if(typeof t=="string"){if(this.canHaveTextChildren||t.trim()==="")return;throw new Error(`Invalid JSX Element: Expected a React component but received text "${t}"`)}if(Object.keys(e).length!==0){if(this.lowercaseComponentName==="board"&&e.lowercaseComponentName==="board")throw new Error("Nested boards are not supported");if(e.lowercaseComponentName==="panel")throw new Error("<panel> must be a root-level element");if(!e.onAddToParent)throw new Error(`Invalid JSX Element: Expected a React component but received "${JSON.stringify(e)}"`);e.onAddToParent(this),e.parent=this,this.children.push(e)}}addAll(e){for(let t of e)this.add(t)}remove(e){this.children=this.children.filter(t=>t!==e),this.childrenPendingRemoval.push(e),e.shouldBeRemoved=!0}getSubcircuitSelector(){let e=this.name,t=e?`${this.lowercaseComponentName}.${e}`:this.lowercaseComponentName;return!this.parent||this.parent.isSubcircuit?t:`${this.parent.getSubcircuitSelector()} > ${t}`}getFullPathSelector(){let e=this.name,t=e?`${this.lowercaseComponentName}.${e}`:this.lowercaseComponentName,i=this.parent?.getFullPathSelector?.();return i?`${i} > ${t}`:t}getNameAndAliases(){return[this.name,...this._parsedProps.portHints??[]].filter(Boolean)}isMatchingNameOrAlias(e){return this.getNameAndAliases().includes(e)}isMatchingAnyOf(e){return this.getNameAndAliases().some(t=>e.map(i=>i.toString()).includes(t))}getPcbSize(){throw new Error(`getPcbSize not implemented for ${this.componentName}`)}doesSelectorMatch(e){let t=[this.componentName,this.lowercaseComponentName],i=[this.name].filter(Boolean),r=e.trim().split(/\> /)[0],s=r[0];return r.length>1?!1:!!(e==="*"||e[0]==="#"&&e.slice(1)===this.props.id||e[0]==="."&&i.includes(e.slice(1))||/^[a-zA-Z0-9_]/.test(s)&&t.includes(s))}getSubcircuit(){if(this.isSubcircuit)return this;let e=this.parent?.getSubcircuit?.();if(!e)throw new Error("Component is not inside an opaque group (no board?)");return e}getGroup(){return this.isGroup?this:this.parent?.getGroup?.()??null}doInitialAssignNameToUnnamedComponents(){this._parsedProps.name||(this.fallbackUnassignedName=this.getSubcircuit().getNextAvailableName(this))}doInitialOptimizeSelectorCache(){if(!this.isSubcircuit)return;let e=this.selectAll("port");for(let t of e){let r=(t.getParentNormalComponent?.()??t.parent)?.getNameAndAliases(),s=t.getNameAndAliases();if(r)for(let o of r)for(let a of s){let c=[`.${o} > .${a}`,`.${o} .${a}`];for(let l of c){let u=this._cachedSelectAllQueries.get(l);u?u.push(t):this._cachedSelectAllQueries.set(l,[t])}}}for(let[t,i]of this._cachedSelectAllQueries.entries())i.length===1&&this._cachedSelectOneQueries.set(t,i[0])}selectAll(e){if(this._cachedSelectAllQueries.has(e))return this._cachedSelectAllQueries.get(e);let t=pet(e,this),i=j5(t,this,WA);if(i.length>0)return this._cachedSelectAllQueries.set(e,i),i;let[r,...s]=t.split(" "),o=iS(r,this,{adapter:uet});if(!o)return[];let a=o.selectAll(s.join(" "));return this._cachedSelectAllQueries.set(e,a),a}selectOne(e,t){if(this._cachedSelectOneQueries.has(e))return this._cachedSelectOneQueries.get(e);let i=pet(e,this);t?.port&&(t.type="port");let r=null;if(t?.type&&(r=j5(i,this,WA).find(l=>l.lowercaseComponentName===t.type)),r??(r=iS(i,this,WA)),r)return this._cachedSelectOneQueries.set(e,r),r;let[s,...o]=i.split(" "),a=iS(s,this,{adapter:uet});return a?(r=a.selectOne(o.join(" "),t),this._cachedSelectOneQueries.set(e,r),r):null}getAvailablePcbLayers(){if(this.isPcbPrimitive){let{maybeFlipLayer:e}=this._getPcbPrimitiveFlippedHelpers();return"layer"in this._parsedProps||this.componentName==="SmtPad"?[e(this._parsedProps.layer??"top")]:"layers"in this._parsedProps?this._parsedProps.layers:this.componentName==="PlatedHole"?this.root?._getBoard()?.allLayers??["top","bottom"]:[]}return[]}getDescendants(){let e=[];for(let t of this.children)e.push(t),e.push(...t.getDescendants());return e}getSelectableDescendants(){let e=[];for(let t of this.children)t.isSubcircuit?e.push(t):(e.push(t),e.push(...t.getSelectableDescendants()));return e}_getPinCount(){return 0}_getSchematicBoxDimensions(){return null}_getSchematicBoxComponentDimensions(){if(this.getSchematicSymbol()||!this.config.shouldRenderAsSchematicBox)return null;let{_parsedProps:e}=this;return{schWidth:e.schWidth,schHeight:e.schHeight}}renderError(e){if(typeof e=="string")return super.renderError(e);switch(e.type){case"pcb_placement_error":this.root?.db.pcb_placement_error.insert(e);break;case"pcb_via_clearance_error":this.root?.db.pcb_via_clearance_error.insert(e);break;case"pcb_trace_error":this.root?.db.pcb_trace_error.insert(e);break;case"pcb_manual_edit_conflict_warning":this.root?.db.pcb_manual_edit_conflict_warning.insert(e);break;default:this.root?.db.pcb_placement_error.insert(e)}}getString(){let{lowercaseComponentName:e,_parsedProps:t,parent:i}=this;return t?.pinNumber!==void 0&&i?.props?.name&&t?.name?`<${e}#${this._renderId}(pin:${t.pinNumber} .${i?.props.name}>.${t.name}) />`:i?.props?.name&&t?.name?`<${e}#${this._renderId}(.${i?.props.name}>.${t?.name}) />`:t?.from&&t?.to?`<${e}#${this._renderId}(from:${t.from} to:${t?.to}) />`:t?.name?`<${e}#${this._renderId} name=".${t?.name}" />`:t?.portHints?`<${e}#${this._renderId}(${t.portHints.map(r=>`.${r}`).join(", ")}) />`:`<${e}#${this._renderId} />`}get[Symbol.toStringTag](){return this.getString()}[Symbol.for("nodejs.util.inspect.custom")](){return this.getString()}},eOt=class extends Ee{constructor(n,e){super(n),this._parsedProps={...n,error:e,type:n.type||"unknown",component_name:n.name,error_type:"source_failed_to_create_component_error",message:e instanceof Error?e.message:String(e),pcbX:n.pcbX,pcbY:n.pcbY,schX:n.schX,schY:n.schY}}get config(){return{componentName:"ErrorPlaceholder",zodProps:h.object({}).passthrough()}}doInitialSourceRender(){if(this.root?.db){let n=this._getGlobalPcbPositionBeforeLayout(),e=this._getGlobalSchematicPositionBeforeLayout();this.root.db.source_failed_to_create_component_error.insert({component_name:this._parsedProps.component_name,error_type:"source_failed_to_create_component_error",message:`Could not create ${this._parsedProps.componentType??"component"}${this._parsedProps.name?` "${this._parsedProps.name}"`:""}. ${this._parsedProps.error?.formattedError?._errors?.join("; ")||this._parsedProps.message}`,pcb_center:n,schematic_center:e})}}};function nOt(n,e){return new eOt(n,e)}function iOt(n,e){let t=n;return t.__tsci={...e},n}var rOt={supportsMutation:!0,createInstance(n,e){let t=Kw[n];if(!t)throw Object.keys(Kw).length===0?new Error("No components registered in catalogue, did you forget to import lib/register-catalogue in your test file?"):new Error(`Unsupported component type "${n}". No element with this name is registered in the @tscircuit/core catalogue. Check for typos or see https://docs.tscircuit.com/category/built-in-elements for a list of valid components. To add your own component, see docs/CREATING_NEW_COMPONENTS.md`);try{return iOt(new t(e),{})}catch(i){return nOt({...e,componentType:n},i)}},createTextInstance(n){return{__text:n}},appendInitialChild(n,e){n.add(e)},appendChild(n,e){n.add(e)},appendChildToContainer(n,e){n.add(e)},finalizeInitialChildren(){return!1},prepareUpdate(){return null},shouldSetTextContent(){return!1},getRootHostContext(){return{}},getChildHostContext(){return{}},prepareForCommit(){return null},resetAfterCommit(){},commitMount(){},commitUpdate(){},removeChild(){},clearContainer(){},supportsPersistence:!1,getPublicInstance(n){return n},preparePortalMount(n){throw new Error("Function not implemented.")},scheduleTimeout(n,e){throw new Error("Function not implemented.")},cancelTimeout(n){throw new Error("Function not implemented.")},noTimeout:void 0,isPrimaryRenderer:!1,getInstanceFromNode(n){throw new Error("Function not implemented.")},beforeActiveInstanceBlur(){throw new Error("Function not implemented.")},afterActiveInstanceBlur(){throw new Error("Function not implemented.")},prepareScopeUpdate:(n,e)=>{throw new Error("Function not implemented.")},getInstanceFromScope:n=>{throw new Error("Function not implemented.")},detachDeletedInstance:n=>{throw new Error("Function not implemented.")},getCurrentEventPriority:()=>Hw.DefaultEventPriority,getCurrentUpdatePriority:()=>Hw.DefaultEventPriority,resolveUpdatePriority:()=>Hw.DefaultEventPriority,setCurrentUpdatePriority:()=>{},maySuspendCommit:()=>!1,supportsHydration:!1},Xw=(0,Det.default)(rOt),Xet=n=>{let e={children:[],props:{name:"$root"},add(s){s.parent=this,this.children.push(s)},computePcbGlobalTransform(){return tr()}},t=[],i=Xw.createContainer(e,0,null,!1,null,"tsci",s=>{console.log("Error in createContainer"),console.error(s),t.push(s)},null);if(Xw.updateContainerSync(n,i,null,()=>{}),Xw.flushSyncWork(),t.length>0)throw t[0];let r=Xw.getPublicRootInstance(i);return r||e.children[0]},Y1=(n,e)=>{if(typeof n=="number")return n;if(n.startsWith("pin"))return Number(n.slice(3));if(!e)throw new Error(`No pin labels provided and pin number or label is not a number: "${n}"`);for(let t in e)if((Array.isArray(e[t])?e[t]:[e[t]]).includes(n))return Number(t.replace("pin",""));throw new Error(`No pin labels provided and pin number or label is not a number: "${n}"`)},sOt=(n,e)=>{if(!n)return;let t={},i={};for(let[r,s]of Object.entries(n)){let o=Y1(r,e);i[o]={...i[o],...s}}for(let[r,s]of Object.entries(i)){let o=`pin${r}`;t[o]={bottom_margin:s.bottomMargin,left_margin:s.leftMargin,right_margin:s.rightMargin,top_margin:s.topMargin}}return t},oOt=n=>{if(n){if("leftSide"in n||"rightSide"in n||"topSide"in n||"bottomSide"in n)return{left_side:n.leftSide,right_side:n.rightSide,top_side:n.topSide,bottom_side:n.bottomSide};if("leftPinCount"in n||"rightPinCount"in n||"topPinCount"in n||"bottomPinCount"in n)return{left_size:n.leftPinCount,right_size:n.rightPinCount,top_size:n.topPinCount,bottom_size:n.bottomPinCount};if("leftSize"in n||"rightSize"in n||"topSize"in n||"bottomSize"in n)return{left_size:n.leftSize,right_size:n.rightSize,top_size:n.topSize,bottom_size:n.bottomSize}}};function Uet(n){let e=[];for(let t=0;t<n.length-1;t++)e.push([n[t],n[t+1]]);return e}var aOt=h.object({name:h.string().refine(n=>!/[+-]/.test(n),n=>({message:`Net names cannot contain "+" or "-" (component "Net" received "${n}"). Try using underscores instead, e.g. VCC_P`}))}),p9=class extends Ee{constructor(){super(...arguments);d(this,"source_net_id");d(this,"subcircuit_connectivity_map_key",null)}get config(){return{componentName:"Net",zodProps:aOt}}getPortSelector(){return`net.${this.props.name}`}doInitialSourceRender(){let{db:e}=this.root,{_parsedProps:t}=this,i=t.name.startsWith("GND"),r=t.name.startsWith("V"),s=e.source_net.insert({name:t.name,member_source_group_ids:[],is_ground:i,is_power:r,is_positive_voltage_source:r});this.source_net_id=s.source_net_id}doInitialSourceParentAttachment(){let e=this.getSubcircuit();if(!e)return;let{db:t}=this.root;t.source_net.update(this.source_net_id,{subcircuit_id:e.subcircuit_id})}getAllConnectedPorts(){let e=this.getSubcircuit().selectAll("port"),t=[];for(let i of e){let r=i._getDirectlyConnectedTraces();for(let s of r)if(s._isExplicitlyConnectedToNet(this)){t.push(i);break}}return t}_getAllDirectlyConnectedTraces(){let e=this.getSubcircuit().selectAll("trace"),t=[];for(let i of e)i._isExplicitlyConnectedToNet(this)&&t.push(i);return t}doInitialPcbRouteNetIslands(){if(this.root?.pcbDisabled||this.getSubcircuit()._parsedProps.routingDisabled||this.getSubcircuit()._getAutorouterConfig().groupMode!=="sequential-trace")return;let{db:e}=this.root,{_parsedProps:t}=this,i=this._getAllDirectlyConnectedTraces().filter(o=>(o._portsRoutedOnPcb?.length??0)>0),r=[];for(let o of i){let a=o._portsRoutedOnPcb,c=r.find(l=>a.some(u=>l.ports.includes(u)));if(!c){r.push({ports:[...a],traces:[o]});continue}c.traces.push(o),c.ports.push(...a)}if(r.length===0)return;let s=Uet(r);for(let[o,a]of s){let c=o.ports.map(P=>P._getGlobalPcbPositionBeforeLayout()),l=a.ports.map(P=>P._getGlobalPcbPositionBeforeLayout()),u=1/0,p=[-1,-1];for(let P=0;P<c.length;P++){let w=c[P];for(let k=0;k<l.length;k++){let T=l[k],I=Math.sqrt((w.x-T.x)**2+(w.y-T.y)**2);I<u&&(u=I,p=[P,k])}}let f=o.ports[p[0]],y=a.ports[p[1]],g=e.toArray().filter(P=>P.type==="pcb_smtpad"||P.type==="pcb_trace"||P.type==="pcb_plated_hole"||P.type==="pcb_hole"||P.type==="source_port"||P.type==="pcb_port"),{solution:x}=mH(g.concat([{type:"source_trace",source_trace_id:"__net_trace_tmp",connected_source_port_ids:[f.source_port_id,y.source_port_id]}])),v=x[0];if(!v){this.renderError({pcb_trace_error_id:"",pcb_trace_id:"__net_trace_tmp",pcb_component_ids:[f.pcb_component_id,y.pcb_component_id].filter(Boolean),pcb_port_ids:[f.pcb_port_id,y.pcb_port_id].filter(Boolean),type:"pcb_trace_error",error_type:"pcb_trace_error",message:`Failed to route net islands for "${this.getString()}"`,source_trace_id:"__net_trace_tmp"});return}e.pcb_trace.insert(v)}}renderError(e){if(typeof e=="string")return super.renderError(e);this.root?.db.pcb_trace_error.insert(e)}},nP=(n,e)=>{for(let t of e)if(typeof t=="string"&&t.startsWith("net.")){if(/net\.[^\s>]*\./.test(t))throw new Error('Net names cannot contain a period, try using "sel.net..." to autocomplete with conventional net names, e.g. V3_3');if(/net\.[^\s>]*[+-]/.test(t)){let r=t.split("net.")[1],s=`Net names cannot contain "+" or "-" (component "${n.componentName}" received "${r}" via "${t}"). Try using underscores instead, e.g. VCC_P`;throw new Error(s)}if(/net\.[0-9]/.test(t)){let r=t.split("net.")[1];throw new Error(`Net name "${r}" cannot start with a number, try using a prefix like "VBUS1"`)}let i=n.getSubcircuit();if(!i.selectOne(t)){let r=new p9({name:t.split("net.")[1]});i.add(r)}}},j1=class extends Ee{constructor(){super(...arguments);d(this,"pcb_smtpad_id",null);d(this,"matchedPort",null);d(this,"isPcbPrimitive",!0)}get config(){return{componentName:"SmtPad",zodProps:BH}}getPcbSize(){let{_parsedProps:e}=this;if(e.shape==="circle")return{width:e.radius*2,height:e.radius*2};if(e.shape==="rect")return{width:e.width,height:e.height};if(e.shape==="rotated_rect"){let i=(e.ccwRotation??0)*Math.PI/180,r=Math.cos(i),s=Math.sin(i),o=Math.abs(e.width*r)+Math.abs(e.height*s),a=Math.abs(e.width*s)+Math.abs(e.height*r);return{width:o,height:a}}if(e.shape==="polygon"){let t=e.points,i=t.map(l=>l.x),r=t.map(l=>l.y),s=Math.min(...i),o=Math.max(...i),a=Math.min(...r),c=Math.max(...r);return{width:o-s,height:c-a}}if(e.shape==="pill")return{width:e.width,height:e.height};throw new Error(`getPcbSize for shape "${e.shape}" not implemented for ${this.componentName}`)}doInitialPortMatching(){let e=this.getPrimitiveContainer()?.selectAll("port");if(this.props.portHints){for(let t of e)if(t.isMatchingAnyOf(this.props.portHints)){this.matchedPort=t,t.registerMatch(this);return}}}doInitialPcbPrimitiveRender(){if(this.root?.pcbDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,i=t.coveredWithSolderMask??!1,r=!i,s=this.getSubcircuit(),o=this._getGlobalPcbPositionBeforeLayout(),a=this._computePcbGlobalTransformBeforeLayout(),u=(to(this._computePcbGlobalTransformBeforeLayout()).rotation.angle*180/Math.PI%360+360)%360,p=.01,f=Math.abs(u)<p||Math.abs(u-180)<p||Math.abs(u-360)<p,y=Math.abs(u-90)<p||Math.abs(u-270)<p,g=Math.abs(u-360)<p?0:u,x=g,{maybeFlipLayer:v,isFlipped:P}=this._getPcbPrimitiveFlippedHelpers();P&&(g=(360-g+360)%360);let w=t.portHints?.map(I=>I.toString())??[],k=null,T=this.parent?.pcb_component_id??this.getPrimitiveContainer()?.pcb_component_id;if(t.shape==="circle")k=e.pcb_smtpad.insert({pcb_component_id:T,pcb_port_id:this.matchedPort?.pcb_port_id,layer:v(t.layer??"top"),shape:"circle",radius:t.radius,port_hints:w,is_covered_with_solder_mask:i,x:o.x,y:o.y,subcircuit_id:s?.subcircuit_id??void 0}),r&&e.pcb_solder_paste.insert({layer:k.layer,shape:"circle",radius:k.radius*.7,x:k.x,y:k.y,pcb_component_id:k.pcb_component_id,pcb_smtpad_id:k.pcb_smtpad_id,subcircuit_id:s?.subcircuit_id??void 0,pcb_group_id:this.getGroup()?.pcb_group_id??void 0});else if(t.shape==="rect")!f&&!y?k=e.pcb_smtpad.insert({pcb_component_id:T,pcb_port_id:this.matchedPort?.pcb_port_id,layer:v(t.layer??"top"),shape:"rotated_rect",width:t.width,height:t.height,corner_radius:t.cornerRadius??void 0,x:o.x,y:o.y,ccw_rotation:g,port_hints:w,is_covered_with_solder_mask:i,subcircuit_id:s?.subcircuit_id??void 0,pcb_group_id:this.getGroup()?.pcb_group_id??void 0}):k=e.pcb_smtpad.insert({pcb_component_id:T,pcb_port_id:this.matchedPort?.pcb_port_id,layer:v(t.layer??"top"),shape:"rect",width:y?t.height:t.width,height:y?t.width:t.height,corner_radius:t.cornerRadius??void 0,port_hints:w,is_covered_with_solder_mask:i,x:o.x,y:o.y,subcircuit_id:s?.subcircuit_id??void 0,pcb_group_id:this.getGroup()?.pcb_group_id??void 0}),r&&(k.shape==="rect"?e.pcb_solder_paste.insert({layer:v(t.layer??"top"),shape:"rect",width:k.width*.7,height:k.height*.7,x:k.x,y:k.y,pcb_component_id:k.pcb_component_id,pcb_smtpad_id:k.pcb_smtpad_id,subcircuit_id:s?.subcircuit_id??void 0,pcb_group_id:this.getGroup()?.pcb_group_id??void 0}):k.shape==="rotated_rect"&&e.pcb_solder_paste.insert({layer:v(t.layer??"top"),shape:"rotated_rect",width:k.width*.7,height:k.height*.7,x:k.x,y:k.y,ccw_rotation:k.ccw_rotation,pcb_component_id:k.pcb_component_id,pcb_smtpad_id:k.pcb_smtpad_id,subcircuit_id:s?.subcircuit_id??void 0,pcb_group_id:this.getGroup()?.pcb_group_id??void 0}));else if(t.shape==="rotated_rect"){let I=t.ccwRotation??0,E=(x+I+360)%360,N=P?(360-E+360)%360:E;k=e.pcb_smtpad.insert({pcb_component_id:T,pcb_port_id:this.matchedPort?.pcb_port_id,layer:v(t.layer??"top"),shape:"rotated_rect",width:t.width,height:t.height,corner_radius:t.cornerRadius??void 0,x:o.x,y:o.y,ccw_rotation:N,port_hints:w,is_covered_with_solder_mask:i,subcircuit_id:s?.subcircuit_id??void 0,pcb_group_id:this.getGroup()?.pcb_group_id??void 0}),r&&e.pcb_solder_paste.insert({layer:v(t.layer??"top"),shape:"rotated_rect",width:k.width*.7,height:k.height*.7,x:o.x,y:o.y,ccw_rotation:N,pcb_component_id:T,pcb_smtpad_id:k.pcb_smtpad_id,subcircuit_id:s?.subcircuit_id??void 0,pcb_group_id:this.getGroup()?.pcb_group_id??void 0})}else if(t.shape==="polygon"){let I=t.points.map(E=>{let N=$e(a,{x:Y.parse(E.x),y:Y.parse(E.y)});return{x:N.x,y:N.y}});k=e.pcb_smtpad.insert({pcb_component_id:T,pcb_port_id:this.matchedPort?.pcb_port_id,layer:v(t.layer??"top"),shape:"polygon",points:I,port_hints:w,is_covered_with_solder_mask:i,subcircuit_id:s?.subcircuit_id??void 0,pcb_group_id:this.getGroup()?.pcb_group_id??void 0})}else t.shape==="pill"&&(k=e.pcb_smtpad.insert({pcb_component_id:T,pcb_port_id:this.matchedPort?.pcb_port_id,layer:v(t.layer??"top"),shape:"pill",x:o.x,y:o.y,radius:t.radius,height:t.height,width:t.width,port_hints:w,is_covered_with_solder_mask:i,subcircuit_id:s?.subcircuit_id??void 0,pcb_group_id:this.getGroup()?.pcb_group_id??void 0}));k&&(this.pcb_smtpad_id=k.pcb_smtpad_id)}doInitialPcbPortAttachment(){if(this.root?.pcbDisabled)return;let{db:e}=this.root;e.pcb_smtpad.update(this.pcb_smtpad_id,{pcb_port_id:this.matchedPort?.pcb_port_id})}_getPcbCircuitJsonBounds(){let{db:e}=this.root,t=e.pcb_smtpad.get(this.pcb_smtpad_id);if(t.shape==="rect")return{center:{x:t.x,y:t.y},bounds:{left:t.x-t.width/2,top:t.y+t.height/2,right:t.x+t.width/2,bottom:t.y-t.height/2},width:t.width,height:t.height};if(t.shape==="rotated_rect"){let i=t.ccw_rotation*Math.PI/180,r=Math.cos(i),s=Math.sin(i),o=t.width/2,a=t.height/2,c=Math.abs(o*r)+Math.abs(a*s),l=Math.abs(o*s)+Math.abs(a*r);return{center:{x:t.x,y:t.y},bounds:{left:t.x-c,right:t.x+c,top:t.y-l,bottom:t.y+l},width:c*2,height:l*2}}if(t.shape==="circle")return{center:{x:t.x,y:t.y},bounds:{left:t.x-t.radius,top:t.y-t.radius,right:t.x+t.radius,bottom:t.y+t.radius},width:t.radius*2,height:t.radius*2};if(t.shape==="polygon"){let i=t.points,r=i.map(u=>u.x),s=i.map(u=>u.y),o=Math.min(...r),a=Math.max(...r),c=Math.min(...s),l=Math.max(...s);return{center:{x:(o+a)/2,y:(c+l)/2},bounds:{left:o,top:l,right:a,bottom:c},width:a-o,height:l-c}}if(t.shape==="pill"){let i=t.width/2,r=t.height/2;return{center:{x:t.x,y:t.y},bounds:{left:t.x-i,top:t.y-r,right:t.x+i,bottom:t.y+r},width:t.width,height:t.height}}throw new Error(`circuitJson bounds calculation not implemented for shape "${t.shape}"`)}_setPositionFromLayout(e){let{db:t}=this.root;t.pcb_smtpad.update(this.pcb_smtpad_id,{x:e.x,y:e.y});let i=t.pcb_solder_paste.list().find(r=>r.pcb_smtpad_id===this.pcb_smtpad_id);i&&t.pcb_solder_paste.update(i.pcb_solder_paste_id,{x:e.x,y:e.y}),this.matchedPort?._setPositionFromLayout(e)}},h9=class extends Ee{constructor(){super(...arguments);d(this,"pcb_silkscreen_path_id",null);d(this,"isPcbPrimitive",!0)}get config(){return{componentName:"SilkscreenPath",zodProps:MW}}doInitialPcbPrimitiveRender(){if(this.root?.pcbDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,{maybeFlipLayer:i}=this._getPcbPrimitiveFlippedHelpers(),r=i(t.layer??"top");if(r!=="top"&&r!=="bottom")throw new Error(`Invalid layer "${r}" for SilkscreenPath. Must be "top" or "bottom".`);let s=this._computePcbGlobalTransformBeforeLayout(),o=this.getSubcircuit(),a=this.parent?.pcb_component_id??this.getPrimitiveContainer()?.pcb_component_id,c=e.pcb_silkscreen_path.insert({pcb_component_id:a,layer:r,route:t.route.map(l=>{let u=$e(s,{x:l.x,y:l.y});return{...l,x:u.x,y:u.y}}),stroke_width:t.strokeWidth??.1,subcircuit_id:o?.subcircuit_id??void 0,pcb_group_id:this.getGroup()?.pcb_group_id??void 0});this.pcb_silkscreen_path_id=c.pcb_silkscreen_path_id}_setPositionFromLayout(e){let{db:t}=this.root,{_parsedProps:i}=this,r=t.pcb_silkscreen_path.get(this.pcb_silkscreen_path_id);if(!r)return;let s=0,o=0;for(let u of r.route)s+=u.x,o+=u.y;s/=r.route.length,o/=r.route.length;let a=e.x-s,c=e.y-o,l=r.route.map(u=>({...u,x:u.x+a,y:u.y+c}));t.pcb_silkscreen_path.update(this.pcb_silkscreen_path_id,{route:l})}getPcbSize(){let{_parsedProps:e}=this;if(!e.route||e.route.length===0)return{width:0,height:0};let t=1/0,i=-1/0,r=1/0,s=-1/0;for(let o of e.route)t=Math.min(t,o.x),i=Math.max(i,o.x),r=Math.min(r,o.y),s=Math.max(s,o.y);return{width:i-t,height:s-r}}},cOt=h.object({route:h.array(Gx),source_trace_id:h.string().optional()}),d9=class extends Ee{constructor(){super(...arguments);d(this,"pcb_trace_id",null);d(this,"isPcbPrimitive",!0)}get config(){return{componentName:"PcbTrace",zodProps:cOt}}doInitialPcbPrimitiveRender(){if(this.root?.pcbDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,i=this.getPrimitiveContainer(),r=this.getSubcircuit(),{maybeFlipLayer:s}=this._getPcbPrimitiveFlippedHelpers(),o=this._computePcbGlobalTransformBeforeLayout(),a=t.route.map(l=>{let{x:u,y:p,...f}=l,y=$e(o,{x:u,y:p});return l.route_type==="wire"&&l.layer?{...y,...f,layer:s(l.layer)}:{...y,...f}}),c=e.pcb_trace.insert({pcb_component_id:i.pcb_component_id,source_trace_id:t.source_trace_id,route:a,subcircuit_id:r?.subcircuit_id??void 0,pcb_group_id:this.getGroup()?.pcb_group_id??void 0});this.pcb_trace_id=c.pcb_trace_id}getPcbSize(){let{_parsedProps:e}=this;if(!e.route||e.route.length===0)return{width:0,height:0};let t=1/0,i=-1/0,r=1/0,s=-1/0;for(let o of e.route)t=Math.min(t,o.x),i=Math.max(i,o.x),r=Math.min(r,o.y),s=Math.max(s,o.y),o.route_type==="wire"&&(t=Math.min(t,o.x-o.width/2),i=Math.max(i,o.x+o.width/2),r=Math.min(r,o.y-o.width/2),s=Math.max(s,o.y+o.width/2));return t===1/0||i===-1/0||r===1/0||s===-1/0?{width:0,height:0}:{width:i-t,height:s-r}}},Id=class extends Ee{constructor(){super(...arguments);d(this,"pcb_plated_hole_id",null);d(this,"matchedPort",null);d(this,"isPcbPrimitive",!0)}get config(){return{componentName:"PlatedHole",zodProps:NH}}getAvailablePcbLayers(){return["top","inner1","inner2","bottom"]}getPcbSize(){let{_parsedProps:e}=this;if(e.shape==="circle")return{width:e.outerDiameter,height:e.outerDiameter};if(e.shape==="oval"||e.shape==="pill")return{width:e.outerWidth,height:e.outerHeight};if(e.shape==="circular_hole_with_rect_pad")return{width:e.rectPadWidth,height:e.rectPadHeight};if(e.shape==="pill_hole_with_rect_pad")return{width:e.rectPadWidth,height:e.rectPadHeight};if(e.shape==="hole_with_polygon_pad"){if(!e.padOutline||e.padOutline.length===0)throw new Error("padOutline is required for hole_with_polygon_pad shape");let t=e.padOutline.map(c=>typeof c.x=="number"?c.x:parseFloat(String(c.x))),i=e.padOutline.map(c=>typeof c.y=="number"?c.y:parseFloat(String(c.y))),r=Math.min(...t),s=Math.max(...t),o=Math.min(...i),a=Math.max(...i);return{width:s-r,height:a-o}}throw new Error(`getPcbSize for shape "${e.shape}" not implemented for ${this.componentName}`)}_getPcbCircuitJsonBounds(){let{db:e}=this.root,t=e.pcb_plated_hole.get(this.pcb_plated_hole_id),i=this.getPcbSize();return{center:{x:t.x,y:t.y},bounds:{left:t.x-i.width/2,top:t.y+i.height/2,right:t.x+i.width/2,bottom:t.y-i.height/2},width:i.width,height:i.height}}_setPositionFromLayout(e){let{db:t}=this.root;t.pcb_plated_hole.update(this.pcb_plated_hole_id,{x:e.x,y:e.y}),this.matchedPort?._setPositionFromLayout(e)}doInitialPortMatching(){let e=this.getPrimitiveContainer()?.selectAll("port");if(this.props.portHints){for(let t of e)if(t.isMatchingAnyOf(this.props.portHints)){this.matchedPort=t,t.registerMatch(this);return}}}doInitialPcbPrimitiveRender(){if(this.root?.pcbDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,i=this._getGlobalPcbPositionBeforeLayout(),r=this.parent?.pcb_component_id??this.getPrimitiveContainer()?.pcb_component_id,s=this.getSubcircuit();if(t.shape==="circle"){let o=e.pcb_plated_hole.insert({pcb_component_id:r,pcb_port_id:this.matchedPort?.pcb_port_id,outer_diameter:t.outerDiameter,hole_diameter:t.holeDiameter,shape:"circle",port_hints:this.getNameAndAliases(),x:i.x,y:i.y,layers:["top","bottom"],subcircuit_id:s?.subcircuit_id??void 0,pcb_group_id:this.getGroup()?.pcb_group_id??void 0});this.pcb_plated_hole_id=o.pcb_plated_hole_id,e.pcb_solder_paste.insert({layer:"top",shape:"circle",radius:t.outerDiameter/2,x:i.x,y:i.y,subcircuit_id:s?.subcircuit_id??void 0,pcb_group_id:this.getGroup()?.pcb_group_id??void 0}),e.pcb_solder_paste.insert({layer:"bottom",shape:"circle",radius:t.outerDiameter/2,x:i.x,y:i.y,subcircuit_id:s?.subcircuit_id??void 0,pcb_group_id:this.getGroup()?.pcb_group_id??void 0})}else if(t.shape==="pill"&&t.rectPad){let o=e.pcb_plated_hole.insert({pcb_component_id:r,pcb_port_id:this.matchedPort?.pcb_port_id,outer_width:t.outerWidth,outer_height:t.outerHeight,hole_width:t.holeWidth,hole_height:t.holeHeight,shape:"rotated_pill_hole_with_rect_pad",type:"pcb_plated_hole",port_hints:this.getNameAndAliases(),pcb_plated_hole_id:this.pcb_plated_hole_id,x:i.x,y:i.y,layers:["top","bottom"],subcircuit_id:s?.subcircuit_id??void 0,pcb_group_id:this.getGroup()?.pcb_group_id??void 0,hole_shape:"rotated_pill",pad_shape:"rect",hole_ccw_rotation:t.pcbRotation??0,rect_ccw_rotation:t.pcbRotation??0,rect_pad_width:t.outerWidth,rect_pad_height:t.outerHeight,hole_offset_x:t.holeOffsetX,hole_offset_y:t.holeOffsetY});this.pcb_plated_hole_id=o.pcb_plated_hole_id}else if(t.shape==="pill"||t.shape==="oval"){let o=e.pcb_plated_hole.insert({pcb_component_id:r,pcb_port_id:this.matchedPort?.pcb_port_id,outer_width:t.outerWidth,outer_height:t.outerHeight,hole_width:t.holeWidth,hole_height:t.holeHeight,shape:t.shape,port_hints:this.getNameAndAliases(),x:i.x,y:i.y,layers:["top","bottom"],subcircuit_id:s?.subcircuit_id??void 0,pcb_group_id:this.getGroup()?.pcb_group_id??void 0,ccw_rotation:t.pcbRotation??0});this.pcb_plated_hole_id=o.pcb_plated_hole_id,e.pcb_solder_paste.insert({layer:"top",shape:t.shape,width:t.outerWidth,height:t.outerHeight,x:i.x,y:i.y,subcircuit_id:s?.subcircuit_id??void 0,pcb_group_id:this.getGroup()?.pcb_group_id??void 0}),e.pcb_solder_paste.insert({layer:"bottom",shape:t.shape,width:t.outerWidth,height:t.outerHeight,x:i.x,y:i.y,subcircuit_id:s?.subcircuit_id??void 0,pcb_group_id:this.getGroup()?.pcb_group_id??void 0})}else if(t.shape==="circular_hole_with_rect_pad"){let o=e.pcb_plated_hole.insert({pcb_component_id:r,pcb_port_id:this.matchedPort?.pcb_port_id,hole_diameter:t.holeDiameter,rect_pad_width:t.rectPadWidth,rect_pad_height:t.rectPadHeight,shape:"circular_hole_with_rect_pad",port_hints:this.getNameAndAliases(),x:i.x,y:i.y,layers:["top","bottom"],subcircuit_id:s?.subcircuit_id??void 0,pcb_group_id:this.getGroup()?.pcb_group_id??void 0,hole_offset_x:t.holeOffsetX,hole_offset_y:t.holeOffsetY,rect_border_radius:t.rectBorderRadius??0});this.pcb_plated_hole_id=o.pcb_plated_hole_id}else if(t.shape==="pill_hole_with_rect_pad"){let o=e.pcb_plated_hole.insert({pcb_component_id:r,pcb_port_id:this.matchedPort?.pcb_port_id,hole_width:t.holeWidth,hole_height:t.holeHeight,rect_pad_width:t.rectPadWidth,rect_pad_height:t.rectPadHeight,hole_offset_x:t.holeOffsetX,hole_offset_y:t.holeOffsetY,shape:"pill_hole_with_rect_pad",port_hints:this.getNameAndAliases(),x:i.x,y:i.y,layers:["top","bottom"],subcircuit_id:s?.subcircuit_id??void 0,pcb_group_id:this.getGroup()?.pcb_group_id??void 0});this.pcb_plated_hole_id=o.pcb_plated_hole_id}else if(t.shape==="hole_with_polygon_pad"){let o=(t.padOutline||[]).map(c=>{let l=typeof c.x=="number"?c.x:parseFloat(String(c.x)),u=typeof c.y=="number"?c.y:parseFloat(String(c.y));return{x:l,y:u}}),a=e.pcb_plated_hole.insert({pcb_component_id:r,pcb_port_id:this.matchedPort?.pcb_port_id,shape:"hole_with_polygon_pad",hole_shape:t.holeShape||"circle",hole_diameter:t.holeDiameter,hole_width:t.holeWidth,hole_height:t.holeHeight,pad_outline:o,hole_offset_x:typeof t.holeOffsetX=="number"?t.holeOffsetX:parseFloat(String(t.holeOffsetX||0)),hole_offset_y:typeof t.holeOffsetY=="number"?t.holeOffsetY:parseFloat(String(t.holeOffsetY||0)),port_hints:this.getNameAndAliases(),x:i.x,y:i.y,layers:["top","bottom"],subcircuit_id:s?.subcircuit_id??void 0,pcb_group_id:this.getGroup()?.pcb_group_id??void 0});this.pcb_plated_hole_id=a.pcb_plated_hole_id}}doInitialPcbPortAttachment(){if(this.root?.pcbDisabled)return;let{db:e}=this.root;e.pcb_plated_hole.update(this.pcb_plated_hole_id,{pcb_port_id:this.matchedPort?.pcb_port_id})}},Jw=class extends Ee{constructor(){super(...arguments);d(this,"pcb_keepout_id",null);d(this,"isPcbPrimitive",!0)}get config(){return{componentName:"Keepout",zodProps:hW}}doInitialPcbPrimitiveRender(){if(this.root?.pcbDisabled)return;let e=this.getSubcircuit(),{db:t}=this.root,{_parsedProps:i}=this,r=this._getGlobalPcbPositionBeforeLayout(),s=to(this._computePcbGlobalTransformBeforeLayout()),o=Math.abs(s.rotation.angle*(180/Math.PI)-90)%180<.01,a=null;i.shape==="circle"?a=t.pcb_keepout.insert({layers:["top"],shape:"circle",radius:i.radius,center:{x:r.x,y:r.y},subcircuit_id:e?.subcircuit_id??void 0,pcb_group_id:e?.getGroup()?.pcb_group_id??void 0}):i.shape==="rect"&&(a=t.pcb_keepout.insert({layers:["top"],shape:"rect",...o?{width:i.height,height:i.width}:{width:i.width,height:i.height},center:{x:r.x,y:r.y},subcircuit_id:e?.subcircuit_id??void 0,pcb_group_id:e?.getGroup()?.pcb_group_id??void 0})),a&&(this.pcb_keepout_id=a.pcb_keepout_id)}},G_=class extends Ee{constructor(){super(...arguments);d(this,"pcb_hole_id",null);d(this,"isPcbPrimitive",!0)}get config(){return{componentName:"Hole",zodProps:YH}}getPcbSize(){let{_parsedProps:e}=this,t=e.shape==="pill",i=e.shape==="rect";return t?{width:e.width,height:e.height}:i?{width:e.width,height:e.height}:{width:e.diameter,height:e.diameter}}doInitialPcbPrimitiveRender(){if(this.root?.pcbDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,i=this.getSubcircuit(),r=this._getGlobalPcbPositionBeforeLayout();if(t.shape==="pill")if(t.pcbRotation&&t.pcbRotation!==0){let s=e.pcb_hole.insert({type:"pcb_hole",hole_shape:"rotated_pill",hole_width:t.width,hole_height:t.height,x:r.x,y:r.y,ccw_rotation:t.pcbRotation,subcircuit_id:i?.subcircuit_id??void 0,pcb_group_id:i?.getGroup()?.pcb_group_id??void 0});this.pcb_hole_id=s.pcb_hole_id}else{let s=e.pcb_hole.insert({type:"pcb_hole",hole_shape:"pill",hole_width:t.width,hole_height:t.height,x:r.x,y:r.y,subcircuit_id:i?.subcircuit_id??void 0,pcb_group_id:i?.getGroup()?.pcb_group_id??void 0});this.pcb_hole_id=s.pcb_hole_id}else if(t.shape==="rect"){let s=e.pcb_hole.insert({type:"pcb_hole",hole_shape:"rect",hole_width:t.width,hole_height:t.height,x:r.x,y:r.y,subcircuit_id:i?.subcircuit_id??void 0,pcb_group_id:i?.getGroup()?.pcb_group_id??void 0});this.pcb_hole_id=s.pcb_hole_id}else{let s=e.pcb_hole.insert({type:"pcb_hole",hole_shape:"circle",hole_diameter:t.diameter,x:r.x,y:r.y,subcircuit_id:i?.subcircuit_id??void 0,pcb_group_id:i?.getGroup()?.pcb_group_id??void 0});this.pcb_hole_id=s.pcb_hole_id}}_getPcbCircuitJsonBounds(){let{db:e}=this.root,t=e.pcb_hole.get(this.pcb_hole_id),i=this.getPcbSize();return{center:{x:t.x,y:t.y},bounds:{left:t.x-i.width/2,top:t.y-i.height/2,right:t.x+i.width/2,bottom:t.y+i.height/2},width:i.width,height:i.height}}_setPositionFromLayout(e){let{db:t}=this.root;t.pcb_hole.update(this.pcb_hole_id,{x:e.x,y:e.y})}},iP=class extends Ee{constructor(){super(...arguments);d(this,"isPcbPrimitive",!0)}get config(){return{componentName:"SilkscreenText",zodProps:EW}}doInitialPcbPrimitiveRender(){if(this.root?.pcbDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,i=this.getPrimitiveContainer(),r=this._getGlobalPcbPositionBeforeLayout(),{maybeFlipLayer:s,isFlipped:o}=this._getPcbPrimitiveFlippedHelpers(),a=this.getSubcircuit(),c=0;if(t.pcbRotation!==void 0&&t.pcbRotation!==0)c=t.pcbRotation;else{let f=this._computePcbGlobalTransformBeforeLayout();c=to(f).rotation.angle*180/Math.PI}o&&(c=(c+180)%360);let l=new Set(t.layers);t.layer&&l.add(t.layer);let u=l.size>0?Array.from(l):["top"],p=t.fontSize??this.getInheritedProperty("pcbStyle")?.silkscreenFontSize??1;for(let f of u)e.pcb_silkscreen_text.insert({anchor_alignment:t.anchorAlignment,anchor_position:{x:r.x,y:r.y},font:t.font??"tscircuit2024",font_size:p,layer:s(f),text:t.text??"",ccw_rotation:c,pcb_component_id:i.pcb_component_id,subcircuit_id:a?.subcircuit_id??void 0,pcb_group_id:this.getGroup()?.pcb_group_id??void 0})}getPcbSize(){let{_parsedProps:e}=this,t=e.fontSize??this.getInheritedProperty("pcbStyle")?.silkscreenFontSize??1,r=(e.text??"").length*t,s=t;return{width:r*t,height:s*t}}},B1=class extends Ee{constructor(){super(...arguments);d(this,"pcb_cutout_id",null);d(this,"isPcbPrimitive",!0)}get config(){return{componentName:"Cutout",zodProps:jH}}doInitialPcbPrimitiveRender(){if(this.root?.pcbDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,i=this.getSubcircuit(),r=this.getGroup()?.pcb_group_id??void 0,s=this._getGlobalPcbPositionBeforeLayout(),a=this.getPrimitiveContainer()?._parsedProps.pcbRotation??0,c;if(t.shape==="rect"){let l=typeof a=="string"?parseInt(a.replace("deg",""),10):a,u=Math.abs(l%180)===90,p={shape:"rect",center:s,width:u?t.height:t.width,height:u?t.width:t.height,subcircuit_id:i?.subcircuit_id??void 0,pcb_group_id:r};c=e.pcb_cutout.insert(p)}else if(t.shape==="circle"){let l={shape:"circle",center:s,radius:t.radius,subcircuit_id:i?.subcircuit_id??void 0,pcb_group_id:r};c=e.pcb_cutout.insert(l)}else if(t.shape==="polygon"){let l=this._computePcbGlobalTransformBeforeLayout(),p={shape:"polygon",points:t.points.map(f=>$e(l,f)),subcircuit_id:i?.subcircuit_id??void 0,pcb_group_id:r};c=e.pcb_cutout.insert(p)}c&&(this.pcb_cutout_id=c.pcb_cutout_id)}getPcbSize(){let{_parsedProps:e}=this;if(e.shape==="rect")return{width:e.width,height:e.height};if(e.shape==="circle")return{width:e.radius*2,height:e.radius*2};if(e.shape==="polygon"){if(e.points.length===0)return{width:0,height:0};let t=1/0,i=-1/0,r=1/0,s=-1/0;for(let o of e.points)t=Math.min(t,o.x),i=Math.max(i,o.x),r=Math.min(r,o.y),s=Math.max(s,o.y);return{width:i-t,height:s-r}}return{width:0,height:0}}_getPcbCircuitJsonBounds(){if(!this.pcb_cutout_id)return super._getPcbCircuitJsonBounds();let{db:e}=this.root,t=e.pcb_cutout.get(this.pcb_cutout_id);if(!t)return super._getPcbCircuitJsonBounds();if(t.shape==="rect")return{center:t.center,bounds:{left:t.center.x-t.width/2,top:t.center.y+t.height/2,right:t.center.x+t.width/2,bottom:t.center.y-t.height/2},width:t.width,height:t.height};if(t.shape==="circle")return{center:t.center,bounds:{left:t.center.x-t.radius,top:t.center.y+t.radius,right:t.center.x+t.radius,bottom:t.center.y-t.radius},width:t.radius*2,height:t.radius*2};if(t.shape==="polygon"){if(t.points.length===0)return super._getPcbCircuitJsonBounds();let i=1/0,r=-1/0,s=1/0,o=-1/0;for(let a of t.points)i=Math.min(i,a.x),r=Math.max(r,a.x),s=Math.min(s,a.y),o=Math.max(o,a.y);return{center:{x:(i+r)/2,y:(s+o)/2},bounds:{left:i,top:o,right:r,bottom:s},width:r-i,height:o-s}}return super._getPcbCircuitJsonBounds()}_setPositionFromLayout(e){if(!this.pcb_cutout_id)return;let{db:t}=this.root,i=t.pcb_cutout.get(this.pcb_cutout_id);if(i){if(i.shape==="rect"||i.shape==="circle")t.pcb_cutout.update(this.pcb_cutout_id,{...i,center:e});else if(i.shape==="polygon"){let r=this._getPcbCircuitJsonBounds().center,s=e.x-r.x,o=e.y-r.y,a=i.points.map(c=>({x:c.x+s,y:c.y+o}));t.pcb_cutout.update(this.pcb_cutout_id,{...i,points:a})}}}},lOt=({elm:n,pinLabels:e,layer:t,readableRotation:i,anchorAlignment:r})=>{let s=n.text.replace(/[{}]/g,"").toLowerCase(),o=s;if(Array.isArray(e)){let a=parseInt(s.replace(/[^\d]/g,""),10)-1;o=String(e[a]??s)}else typeof e=="object"&&(o=String(e[s]??s));return new iP({anchorAlignment:r||"center",text:o??s,layer:t||"top",fontSize:n.font_size+.2,pcbX:isNaN(n.anchor_position.x)?0:n.anchor_position.x,pcbY:n.anchor_position.y,pcbRotation:i??0})},uOt=(n,e)=>{let t=parseInt(n||"0",10),i;return e!=null?i=e-t:i=t,(i%360+360)%360},H_=({componentName:n,componentRotation:e,footprinterString:t,pinLabels:i,pcbPinLabels:r},s)=>{let o=[];for(let a of s)if(a.type==="pcb_smtpad"&&a.shape==="rect")o.push(new j1({pcbX:a.x,pcbY:a.y,layer:a.layer,shape:"rect",height:a.height,width:a.width,portHints:a.port_hints,rectBorderRadius:a.rect_border_radius}));else if(a.type==="pcb_smtpad"&&a.shape==="circle")o.push(new j1({pcbX:a.x,pcbY:a.y,layer:a.layer,shape:"circle",radius:a.radius,portHints:a.port_hints}));else if(a.type==="pcb_smtpad"&&a.shape==="pill")o.push(new j1({shape:"pill",height:a.height,width:a.width,radius:a.radius,portHints:a.port_hints,pcbX:a.x,pcbY:a.y,layer:a.layer}));else if(a.type==="pcb_silkscreen_path")o.push(new h9({layer:a.layer,route:a.route,strokeWidth:a.stroke_width}));else if(a.type==="pcb_plated_hole")a.shape==="circle"?o.push(new Id({pcbX:a.x,pcbY:a.y,shape:"circle",holeDiameter:a.hole_diameter,outerDiameter:a.outer_diameter,portHints:a.port_hints})):a.shape==="circular_hole_with_rect_pad"?o.push(new Id({pcbX:a.x,pcbY:a.y,shape:"circular_hole_with_rect_pad",holeDiameter:a.hole_diameter,rectPadHeight:a.rect_pad_height,rectPadWidth:a.rect_pad_width,portHints:a.port_hints,rectBorderRadius:a.rect_border_radius,holeOffsetX:a.hole_offset_x,holeOffsetY:a.hole_offset_y})):a.shape==="pill"||a.shape==="oval"?o.push(new Id({pcbX:a.x,pcbY:a.y,shape:a.shape,holeWidth:a.hole_width,holeHeight:a.hole_height,outerWidth:a.outer_width,outerHeight:a.outer_height,portHints:a.port_hints})):a.shape==="pill_hole_with_rect_pad"?o.push(new Id({pcbX:a.x,pcbY:a.y,shape:"pill_hole_with_rect_pad",holeShape:"pill",padShape:"rect",holeWidth:a.hole_width,holeHeight:a.hole_height,rectPadWidth:a.rect_pad_width,rectPadHeight:a.rect_pad_height,portHints:a.port_hints,holeOffsetX:a.hole_offset_x,holeOffsetY:a.hole_offset_y})):a.shape==="hole_with_polygon_pad"&&o.push(new Id({pcbX:a.x,pcbY:a.y,shape:"hole_with_polygon_pad",holeShape:a.hole_shape||"circle",holeDiameter:a.hole_diameter,holeWidth:a.hole_width,holeHeight:a.hole_height,padOutline:a.pad_outline||[],holeOffsetX:a.hole_offset_x,holeOffsetY:a.hole_offset_y,portHints:a.port_hints}));else if(a.type==="pcb_keepout"&&a.shape==="circle")o.push(new Jw({pcbX:a.center.x,pcbY:a.center.y,shape:"circle",radius:a.radius}));else if(a.type==="pcb_keepout"&&a.shape==="rect")o.push(new Jw({pcbX:a.center.x,pcbY:a.center.y,shape:"rect",width:a.width,height:a.height}));else if(a.type==="pcb_hole"&&a.hole_shape==="circle")o.push(new G_({pcbX:a.x,pcbY:a.y,diameter:a.hole_diameter}));else if(a.type==="pcb_hole"&&a.hole_shape==="rect")o.push(new G_({pcbX:a.x,pcbY:a.y,shape:"rect",width:a.hole_width,height:a.hole_height}));else if(a.type==="pcb_hole"&&a.hole_shape==="pill")o.push(new G_({pcbX:a.x,pcbY:a.y,shape:"pill",width:a.hole_width,height:a.hole_height}));else if(a.type==="pcb_hole"&&a.hole_shape==="rotated_pill")o.push(new G_({pcbX:a.x,pcbY:a.y,shape:"pill",width:a.hole_width,height:a.hole_height,pcbRotation:a.ccw_rotation}));else if(a.type==="pcb_cutout")a.shape==="rect"?o.push(new B1({pcbX:a.center.x,pcbY:a.center.y,shape:"rect",width:a.width,height:a.height})):a.shape==="circle"?o.push(new B1({pcbX:a.center.x,pcbY:a.center.y,shape:"circle",radius:a.radius})):a.shape==="polygon"&&o.push(new B1({shape:"polygon",points:a.points}));else if(a.type==="pcb_silkscreen_text"){let c=uOt(e,a.ccw_rotation);t?.includes("pinrow")&&a.text.includes("PIN")?o.push(lOt({elm:a,pinLabels:r??i??{},layer:a.layer,readableRotation:c,anchorAlignment:a.anchor_alignment})):o.push(new iP({anchorAlignment:a.anchor_alignment||"center",text:n,fontSize:a.font_size+.2,pcbX:Number.isNaN(a.anchor_position.x)?0:a.anchor_position.x,pcbY:a.anchor_position.y,pcbRotation:c??0}))}else a.type==="pcb_trace"&&o.push(new d9({route:a.route}));return o};function rP(n){let e=1/0,t=1/0,i=-1/0,r=-1/0,s=!1;for(let c of n)if(c.isPcbPrimitive&&!c.componentName.startsWith("Silkscreen")){let{x:l,y:u}=c._getGlobalPcbPositionBeforeLayout(),{width:p,height:f}=c.getPcbSize();e=Math.min(e,l-p/2),t=Math.min(t,u-f/2),i=Math.max(i,l+p/2),r=Math.max(r,u+f/2),s=!0}else if(c.children.length>0){let l=rP(c.children);(l.width>0||l.height>0)&&(e=Math.min(e,l.minX),t=Math.min(t,l.minY),i=Math.max(i,l.maxX),r=Math.max(r,l.maxY),s=!0)}if(!s)return{minX:0,minY:0,maxX:0,maxY:0,width:0,height:0};let o=i-e,a=r-t;return o<0&&(o=0),a<0&&(a=0),{minX:e,minY:t,maxX:i,maxY:r,width:o,height:a}}function het(n){let e=n%360;return e<0?e+360:e}function pOt(n,e,t,i){return i==="counterclockwise"?t>=e?n>=e&&n<=t:n>=e||n<=t:t<=e?n<=e&&n>=t:n<=e||n>=t}function hOt(n){let e=n.center,t=n.radius,i=n.start_angle_degrees,r=n.end_angle_degrees,s=n.direction??"counterclockwise";if(!e||typeof e.x!="number"||typeof e.y!="number"||typeof t!="number"||typeof i!="number"||typeof r!="number")return null;let o=het(i),a=het(r),c=new Set([o,a]),l=[0,90,180,270];for(let g of l)pOt(g,o,a,s)&&c.add(g);let u=1/0,p=1/0,f=-1/0,y=-1/0;for(let g of c){let x=g*Math.PI/180,v=e.x+t*Math.cos(x),P=e.y+t*Math.sin(x);u=Math.min(u,v),f=Math.max(f,v),p=Math.min(p,P),y=Math.max(y,P)}return!Number.isFinite(u)||!Number.isFinite(p)?null:{minX:u,maxX:f,minY:p,maxY:y}}function Vet(n){let e=1/0,t=1/0,i=-1/0,r=-1/0;for(let s of n){let o,a,c,l;if(s.type==="schematic_component")o=s.center?.x,a=s.center?.y,c=s.size?.width,l=s.size?.height;else if(s.type==="schematic_box")o=s.x,a=s.y,c=s.width,l=s.height;else if(s.type==="schematic_port")o=s.center?.x,a=s.center?.y,c=.2,l=.2;else if(s.type==="schematic_text")o=s.position?.x,a=s.position?.y,c=(s.text?.length??0)*.1,l=.2;else if(s.type==="schematic_line"){let u=s.x1??0,p=s.y1??0,f=s.x2??0,y=s.y2??0;o=(u+f)/2,a=(p+y)/2,c=Math.abs(f-u),l=Math.abs(y-p)}else if(s.type==="schematic_rect")o=s.center?.x,a=s.center?.y,c=s.width,l=s.height;else if(s.type==="schematic_circle"){o=s.center?.x,a=s.center?.y;let u=s.radius;typeof u=="number"&&(c=u*2,l=u*2)}else if(s.type==="schematic_arc"){let u=hOt(s);u&&(e=Math.min(e,u.minX),i=Math.max(i,u.maxX),t=Math.min(t,u.minY),r=Math.max(r,u.maxY));continue}typeof o=="number"&&typeof a=="number"&&typeof c=="number"&&typeof l=="number"&&(e=Math.min(e,o-c/2),i=Math.max(i,o+c/2),t=Math.min(t,a-l/2),r=Math.max(r,a+l/2))}return{minX:e,maxX:i,minY:t,maxY:r}}function dOt(n,e){let t=e.x-n.x,i=e.y-n.y;return Math.abs(t)>Math.abs(i)?t>=0?"right":"left":i>=0?"up":"down"}var det=n=>{if(n.length<=1)return!0;let e=n.map(s=>{let o=s._getPcbCircuitJsonBounds();return{left:o.bounds.left,right:o.bounds.right,top:o.bounds.top,bottom:o.bounds.bottom}}),t=Array(e.length).fill(!1).map(()=>Array(e.length).fill(!1));for(let s=0;s<e.length;s++)for(let o=s+1;o<e.length;o++){let a=e[s],c=e[o];t[s][o]=t[o][s]=!(a.right<c.left||a.left>c.right||a.bottom>c.top||a.top<c.bottom)}let i=new Set,r=s=>{i.add(s);for(let o=0;o<e.length;o++)t[s][o]&&!i.has(o)&&r(o)};return r(0),i.size===e.length},fet=n=>{if(n.length===0)throw new Error("Cannot get center of empty PCB primitives array");let e=n.map(r=>r._getPcbCircuitJsonBounds().center).filter(Boolean),t=e.reduce((r,s)=>r+s.x,0),i=e.reduce((r,s)=>r+s.y,0);return{x:t/e.length,y:i/e.length}},fOt=h.object({name:h.string().optional(),pinNumber:h.number().optional(),aliases:h.array(h.string()).optional(),layer:h.string().optional(),layers:h.array(h.string()).optional(),schX:h.number().optional(),schY:h.number().optional(),direction:h.enum(["up","down","left","right"]).optional(),connectsTo:h.union([h.string(),h.array(h.string())]).optional()}),Gi=class extends Ee{constructor(e,t={}){if(!e.name&&e.pinNumber!==void 0&&(e.name=`pin${e.pinNumber}`),!e.name)throw new Error("Port must have a name or a pinNumber");super(e);d(this,"source_port_id",null);d(this,"pcb_port_id",null);d(this,"schematic_port_id",null);d(this,"schematicSymbolPortDef",null);d(this,"matchedComponents");d(this,"facingDirection",null);d(this,"originDescription",null);t.originDescription&&(this.originDescription=t.originDescription),this.matchedComponents=[]}get config(){return{componentName:"Port",zodProps:fOt}}isGroupPort(){return this.parent?.componentName==="Group"}isComponentPort(){return!this.isGroupPort()}_getConnectedPortsFromConnectsTo(){let{_parsedProps:e}=this,t=e.connectsTo;if(!t)return[];let i=[],r=Array.isArray(t)?t:[t];for(let s of r){let o=this.getSubcircuit().selectOne(s,{type:"port"});o&&i.push(o)}return i}_isBoardPinoutFromAttributes(){let e=this.parent;if(e?._parsedProps?.pinAttributes){let t=e._parsedProps.pinAttributes;for(let i of this.getNameAndAliases())if(t[i]?.includeInBoardPinout)return!0}}_getGlobalPcbPositionBeforeLayout(){let e=this.matchedComponents.find(i=>i.isPcbPrimitive),t=this.parent;if(t&&!t.props.footprint)throw new Error(`${t.componentName} "${t.props.name}" does not have a footprint. Add a footprint prop, e.g. <${t.componentName.toLowerCase()} footprint="..." />`);if(!e)throw new Error(`Port ${this} has no matching PCB primitives. This often means the footprint's pads lack matching port hints.`);return e?._getGlobalPcbPositionBeforeLayout()??{x:0,y:0}}_getPcbCircuitJsonBounds(){if(!this.pcb_port_id)return super._getPcbCircuitJsonBounds();let{db:e}=this.root,t=e.pcb_port.get(this.pcb_port_id);return{center:{x:t.x,y:t.y},bounds:{left:0,top:0,right:0,bottom:0},width:0,height:0}}_getGlobalPcbPositionAfterLayout(){return this._getPcbCircuitJsonBounds().center}_getPortsInternallyConnectedToThisPort(){let e=this.parent;if(!e||!e._getInternallyConnectedPins)return[];let t=e._getInternallyConnectedPins();for(let i of t)if(i.some(r=>r===this))return i;return[]}_hasSchematicPort(){let{schX:e,schY:t}=this._parsedProps;if(e!==void 0&&t!==void 0)return!0;let i=this.getParentNormalComponent();if(i?.getSchematicSymbol())return!!(this.schematicSymbolPortDef||this._getPortsInternallyConnectedToThisPort().some(a=>a.schematicSymbolPortDef));let s=i?._getSchematicBoxDimensions();return!!(s&&this.props.pinNumber!==void 0&&s.getPortPositionByPinNumber(this.props.pinNumber))}_getGlobalSchematicPositionBeforeLayout(){let{schX:e,schY:t}=this._parsedProps;if(e!==void 0&&t!==void 0)return{x:e,y:t};let i=this.getParentNormalComponent(),r=i?.getSchematicSymbol();if(r){let o=this.schematicSymbolPortDef;if(!o&&(o=this._getPortsInternallyConnectedToThisPort().find(c=>c.schematicSymbolPortDef)?.schematicSymbolPortDef??null,!o))throw new Error(`Couldn't find schematicSymbolPortDef for port ${this.getString()}, searched internally connected ports and none had a schematicSymbolPortDef. Why are we trying to get the schematic position of this port?`);let a=_i(i.computeSchematicGlobalTransform(),Rn(-r.center.x,-r.center.y));return $e(a,o)}let s=i?._getSchematicBoxDimensions();if(s&&this.props.pinNumber!==void 0){let o=s.getPortPositionByPinNumber(this.props.pinNumber);if(!o)throw new Error(`Couldn't find position for schematic_port for port ${this.getString()} inside of the schematic box`);return $e(i.computeSchematicGlobalTransform(),o)}throw new Error(`Couldn't find position for schematic_port for port ${this.getString()}`)}_getGlobalSchematicPositionAfterLayout(){let{db:e}=this.root;if(!this.schematic_port_id)throw new Error(`Can't get schematic port position after layout for "${this.getString()}", no schematic_port_id`);let t=e.schematic_port.get(this.schematic_port_id);if(!t)throw new Error(`Schematic port not found when trying to get post-layout position: ${this.schematic_port_id}`);return t.center}registerMatch(e){this.matchedComponents.push(e)}getNameAndAliases(){let{_parsedProps:e}=this;return Array.from(new Set([...e.name?[e.name]:[],...e.aliases??[],...typeof e.pinNumber=="number"?[`pin${e.pinNumber}`,e.pinNumber.toString()]:[],...this.externallyAddedAliases??[]]))}_getMatchingPinAttributes(){let e=this.parent?._parsedProps?.pinAttributes;if(!e)return[];let t=[];for(let i of this.getNameAndAliases()){let r=e[i];r&&t.push(r)}return t}_shouldIncludeInBoardPinout(){return this._getMatchingPinAttributes().some(e=>e.includeInBoardPinout===!0)}isMatchingPort(e){return this.isMatchingAnyOf(e.getNameAndAliases())}getPortSelector(){return`.${(this.getParentNormalComponent()??this.parent)?.props.name} > port.${this.props.name}`}getAvailablePcbLayers(){let{layer:e,layers:t}=this._parsedProps;return t||(e?[e]:Array.from(new Set(this.matchedComponents.flatMap(i=>i.getAvailablePcbLayers()))))}_getDirectlyConnectedTraces(){return this.getSubcircuit().selectAll("trace").filter(i=>!i._couldNotFindPort).filter(i=>i._isExplicitlyConnectedToPort(this))}doInitialSourceRender(){let{db:e}=this.root,{_parsedProps:t}=this,i=this.getNameAndAliases(),r=this.getParentNormalComponent(),o=(this.parent?.source_component_id?this.parent:r)?.source_component_id??null,a=e.source_port.insert({name:t.name,pin_number:t.pinNumber,port_hints:i,source_component_id:o,subcircuit_id:this.getSubcircuit()?.subcircuit_id});this.source_port_id=a.source_port_id}doInitialSourceParentAttachment(){let{db:e}=this.root,t=this.getParentNormalComponent(),i=this.parent?.source_component_id?this.parent:t;if(this.isGroupPort()){e.source_port.update(this.source_port_id,{source_component_id:null,subcircuit_id:this.getSubcircuit()?.subcircuit_id});return}if(!i?.source_component_id)throw new Error(`${this.getString()} has no parent source component (parent: ${this.parent?.getString()})`);e.source_port.update(this.source_port_id,{source_component_id:i.source_component_id,subcircuit_id:this.getSubcircuit()?.subcircuit_id}),this.source_component_id=i.source_component_id}doInitialPcbPortRender(){if(this.root?.pcbDisabled)return;let{db:e}=this.root,{matchedComponents:t}=this;if(this.isGroupPort()){let a=this._getConnectedPortsFromConnectsTo();if(a.length===0)return;let c=a[0];if(!c.pcb_port_id)return;let l=e.pcb_port.get(c.pcb_port_id),u={x:l.x,y:l.y},p=this.getSubcircuit(),f=e.pcb_port.insert({pcb_component_id:void 0,layers:c.getAvailablePcbLayers(),subcircuit_id:p?.subcircuit_id??void 0,pcb_group_id:this.getGroup()?.pcb_group_id??void 0,...u,source_port_id:this.source_port_id,is_board_pinout:!1});this.pcb_port_id=f.pcb_port_id;return}let i=this.getParentNormalComponent(),r=this.parent?.pcb_component_id?this.parent:i;if(!r?.pcb_component_id)throw new Error(`${this.getString()} has no parent pcb component, cannot render pcb_port (parent: ${this.parent?.getString()}, parentNormalComponent: ${i?.getString()})`);let s=t.filter(a=>a.isPcbPrimitive);if(s.length===0)return;let o=null;if(s.length===1&&(o=s[0]._getPcbCircuitJsonBounds().center),s.length>1){if(!det(s))throw new Error(`${this.getString()} has multiple non-overlapping pcb matches, unclear how to place pcb_port: ${s.map(a=>a.getString()).join(", ")}. (Note: tscircuit core does not currently allow you to specify internally connected pcb primitives with the same port hints, try giving them different port hints and specifying they are connected externally- or file an issue)`);o=fet(s)}if(o){let a=this.getSubcircuit(),c=this._shouldIncludeInBoardPinout(),l=e.pcb_port.insert({pcb_component_id:r.pcb_component_id,layers:this.getAvailablePcbLayers(),subcircuit_id:a?.subcircuit_id??void 0,pcb_group_id:this.getGroup()?.pcb_group_id??void 0,...c?{is_board_pinout:!0}:{},...o,source_port_id:this.source_port_id,is_board_pinout:this._isBoardPinoutFromAttributes()});this.pcb_port_id=l.pcb_port_id}else{let a=s[0];throw new Error(`${a.getString()} does not have a center or _getGlobalPcbPositionBeforeLayout method (needed for pcb_port placement)`)}}updatePcbPortRender(){if(this.root?.pcbDisabled)return;let{db:e}=this.root;if(this.pcb_port_id)return;if(this.isGroupPort()){let l=this._getConnectedPortsFromConnectsTo();if(l.length===0)return;let u=l[0];if(!u.pcb_port_id)return;let p=e.pcb_port.get(u.pcb_port_id),f={x:p.x,y:p.y},y=this.getSubcircuit(),g=e.pcb_port.insert({pcb_component_id:void 0,layers:u.getAvailablePcbLayers(),subcircuit_id:y?.subcircuit_id??void 0,pcb_group_id:this.getGroup()?.pcb_group_id??void 0,...f,source_port_id:this.source_port_id,is_board_pinout:!1});this.pcb_port_id=g.pcb_port_id;return}let t=this.matchedComponents.filter(l=>l.isPcbPrimitive);if(t.length===0)return;let i=null;if(t.length===1&&(i=t[0]._getPcbCircuitJsonBounds().center),t.length>1)try{det(t)&&(i=fet(t))}catch{}if(!i)return;let r=this.getParentNormalComponent(),s=this.parent?.pcb_component_id?this.parent:r,o=this.getSubcircuit(),a=this._shouldIncludeInBoardPinout(),c=e.pcb_port.insert({pcb_component_id:s?.pcb_component_id,layers:this.getAvailablePcbLayers(),subcircuit_id:o?.subcircuit_id??void 0,pcb_group_id:this.getGroup()?.pcb_group_id??void 0,...a?{is_board_pinout:!0}:{},...i,source_port_id:this.source_port_id,is_board_pinout:this._isBoardPinoutFromAttributes()});this.pcb_port_id=c.pcb_port_id}_getBestDisplayPinLabel(){let{db:e}=this.root,t=e.source_port.get(this.source_port_id),i=[];for(let o of t?.port_hints??[])o.match(/^(pin)?\d+$/)||o.match(/^(left|right)/)&&!t?.name.match(/^(left|right)/)||i.push(o);if(this.getParentNormalComponent()?.props?.showPinAliases&&i.length>0)return i.join("/");if(i.length>0)return i[0]}doInitialSchematicPortRender(){let{db:e}=this.root,{_parsedProps:t}=this,{schX:i,schY:r}=t,s=i!==void 0&&r!==void 0?this.getParentNormalComponent():this.getPrimitiveContainer();if(!s||!this._hasSchematicPort())return;let o=s._getGlobalSchematicPositionBeforeLayout(),a=this._getGlobalSchematicPositionBeforeLayout(),c=null,l=s._getSchematicBoxDimensions();l&&t.pinNumber!==void 0&&(c=l.getPortPositionByPinNumber(t.pinNumber)),this.getSubcircuit().props._schDebugObjectsEnabled&&e.schematic_debug_object.insert({shape:"rect",center:a,size:{width:.1,height:.1},label:"obstacle"}),c?.side?this.facingDirection={left:"left",right:"right",top:"up",bottom:"down"}[c.side]:this.facingDirection=dOt(o,a);let u=this._getBestDisplayPinLabel(),f={type:"schematic_port",schematic_component_id:this.getParentNormalComponent()?.schematic_component_id,center:a,source_port_id:this.source_port_id,facing_direction:this.facingDirection,distance_from_component_edge:.4,side_of_component:c?.side,pin_number:t.pinNumber,true_ccw_index:c?.trueIndex,display_pin_label:u,is_connected:!1};for(let g of this._getMatchingPinAttributes())g.requiresPower&&(f.has_input_arrow=!0),g.providesPower&&(f.has_output_arrow=!0);let y=e.schematic_port.insert(f);this.schematic_port_id=y.schematic_port_id}_getSubcircuitConnectivityKey(){return this.root?.db.source_port.get(this.source_port_id)?.subcircuit_connectivity_map_key}_setPositionFromLayout(e){let{db:t}=this.root;this.pcb_port_id&&t.pcb_port.update(this.pcb_port_id,{x:e.x,y:e.y})}_hasMatchedPcbPrimitive(){return this.matchedComponents.some(e=>e.isPcbPrimitive)}_getNetLabelText(){return`${this.parent?.props.name}_${this.props.name}`}},Get=n=>{let e=n.find(t=>/^(pin)?\d+$/.test(t));return e?Number.parseInt(e.replace(/^pin/,"")):null};function F1(n,e){let t=Get(n);if(!t)return null;let r=[...n.filter(s=>s.toString()!==t.toString()&&s!==`pin${t}`),...e?.additionalAliases?.[`pin${t}`]??[]];return new Gi({pinNumber:t,aliases:r})}var mOt=n=>{for(let e of["leftSide","rightSide","topSide","bottomSide"])if(e in n&&typeof n[e]=="number")throw new Error(`A number was specified for "${e}", you probably meant to use "size" not "side"`);return"leftSide"in n||"rightSide"in n||"topSide"in n||"bottomSide"in n},_Ot=n=>{if(mOt(n))return{leftSize:n.leftSide?.pins.length??0,rightSize:n.rightSide?.pins.length??0,topSize:n.topSide?.pins.length??0,bottomSize:n.bottomSide?.pins.length??0};let{leftSize:e=0,rightSize:t=0,topSize:i=0,bottomSize:r=0}=n;return{leftSize:e,rightSize:t,topSize:i,bottomSize:r}},Uw=.4;function Het(n){let e=n;return e.leftSide!==void 0||e.rightSide!==void 0||e.topSide!==void 0||e.bottomSide!==void 0}var yOt=n=>{let e=n.portDistanceFromEdge??.4,t=n.schPortArrangement?_Ot(n.schPortArrangement):null,i={left:0,right:0,top:0,bottom:0},r=n.pinCount??null;if(r===null)if(t)r=t.leftSize+t.rightSize+t.topSize;else throw new Error("Could not determine pin count for the schematic box");if(r&&!t){let g=Math.floor(r/2);t={leftSize:r-g,rightSize:g,topSize:0,bottomSize:0}}t||(t={leftSize:0,rightSize:0,topSize:0,bottomSize:0});let s=({side:g,sideIndex:x,truePinIndex:v})=>{if(!n.schPortArrangement||!Het(n.schPortArrangement))return v+1;let P={left:"top-to-bottom",bottom:"left-to-right",right:"bottom-to-top",top:"right-to-left"}[g],w=n.schPortArrangement?.[`${g}Side`]?.direction??P,k=n.schPortArrangement?.[`${g}Side`]?.pins,T=x;return w!==P&&(T=k.length-x-1),Y1(k[T],n.pinLabels)},o=[],a=0,c=0;for(let g=0;g<t.leftSize;g++){let x=s({side:"left",sideIndex:g,truePinIndex:c}),v=n.numericSchPinStyle?.[`pin${x}`]??n.numericSchPinStyle?.[x];v?.topMargin&&(a+=v.topMargin),o.push({trueIndex:c,pinNumber:x,side:"left",distanceFromOrthogonalEdge:a}),v?.bottomMargin&&(a+=v.bottomMargin),g===t.leftSize-1?i.left=a:a+=n.schPinSpacing,c++}a=0;for(let g=0;g<t.bottomSize;g++){let x=s({side:"bottom",sideIndex:g,truePinIndex:c}),v=n.numericSchPinStyle?.[`pin${x}`]??n.numericSchPinStyle?.[x];v?.leftMargin&&(a+=v.leftMargin),o.push({trueIndex:c,pinNumber:x,side:"bottom",distanceFromOrthogonalEdge:a}),v?.rightMargin&&(a+=v.rightMargin),g===t.bottomSize-1?i.bottom=a:a+=n.schPinSpacing,c++}a=0;for(let g=0;g<t.rightSize;g++){let x=s({side:"right",sideIndex:g,truePinIndex:c}),v=n.numericSchPinStyle?.[`pin${x}`]??n.numericSchPinStyle?.[x];v?.bottomMargin&&(a+=v.bottomMargin),o.push({trueIndex:c,pinNumber:x,side:"right",distanceFromOrthogonalEdge:a}),v?.topMargin&&(a+=v.topMargin),g===t.rightSize-1?i.right=a:a+=n.schPinSpacing,c++}a=0;for(let g=0;g<t.topSize;g++){let x=s({side:"top",sideIndex:g,truePinIndex:c}),v=n.numericSchPinStyle?.[`pin${x}`]??n.numericSchPinStyle?.[x];v?.rightMargin&&(a+=v.rightMargin),o.push({trueIndex:c,pinNumber:x,side:"top",distanceFromOrthogonalEdge:a}),v?.leftMargin&&(a+=v.leftMargin),g===t.topSize-1?i.top=a:a+=n.schPinSpacing,c++}let l=n.schWidth;if(l===void 0){l=Math.max(i.top+Uw,i.bottom+Uw),n.pinLabels&&o.filter(w=>w.side==="left"||w.side==="right").some(w=>n.pinLabels?.[`pin${w.pinNumber}`]||n.pinLabels?.[w.pinNumber])&&(l=Math.max(l,.5));let g=n.pinLabels?Math.max(...Object.values(n.pinLabels).map(v=>v.length*.1)):0,x=g>0?1.1:0;l=Math.max(l,g+x)}let u=n.schHeight;u||(u=Math.max(i.left+Uw,i.right+Uw));let p={left:{x:-l/2-e,y:i.left/2},bottom:{x:-i.bottom/2,y:-u/2-e},right:{x:l/2+e,y:-i.right/2},top:{x:i.top/2,y:u/2+e}},f={left:{x:0,y:-1},right:{x:0,y:1},top:{x:-1,y:0},bottom:{x:1,y:0}},y=o.map(g=>{let{distanceFromOrthogonalEdge:x,side:v}=g,P=p[v],w=f[v];return{x:P.x+x*w.x,y:P.y+x*w.y,...g}});return{getPortPositionByPinNumber(g){let x=y.find(v=>v.pinNumber.toString()===g.toString());return x||null},getSize(){return{width:l,height:u}},getSizeIncludingPins(){return{width:l+(t.leftSize||t.rightSize?.4:0),height:u+(t.topSize||t.bottomSize?.4:0)}},pinCount:r}},gOt=(0,Wet.default)("tscircuit:core:footprint"),qet=class extends Ee{get config(){return{componentName:"Footprint",zodProps:UH}}doInitialPcbFootprintLayout(){if(this.root?.pcbDisabled)return;let n=this.children.filter(p=>p.componentName==="Constraint");if(n.length===0)return;let{isFlipped:e}=this._getPcbPrimitiveFlippedHelpers(),t=p=>e&&"left"in p&&"right"in p?{...p,left:p.right,right:p.left}:p,i=n.flatMap(p=>p._getAllReferencedComponents().componentsWithSelectors).map(({component:p,selector:f,componentSelector:y,edge:g})=>({component:p,selector:f,componentSelector:y,edge:g,bounds:p._getPcbCircuitJsonBounds()}));if(i.some(p=>p.edge))throw new Error("edge constraints not implemented yet for footprint layout, contributions welcome!");function r(p){return i.find(({selector:f})=>f===p)}let s=new i_,o={};function a(p){return p in o||(o[p]=new Ia(p),s.addEditVariable(o[p],On.weak)),o[p]}for(let{selector:p,bounds:f}of i){let y=a(`${p}_x`),g=a(`${p}_y`);s.suggestValue(y,f.center.x),s.suggestValue(g,f.center.y)}for(let p of n){let f=p._parsedProps;if("xDist"in f){let{xDist:y,left:g,right:x,edgeToEdge:v,centerToCenter:P}=t(f),w=a(`${g}_x`),k=a(`${x}_x`),T=r(g)?.bounds,I=r(x)?.bounds;if(P){let E=new Dn(k,[-1,w]);s.addConstraint(new ki(E,oi.Eq,f.xDist,On.required))}else if(v){let E=new Dn(k,-I.width/2,[-1,w],-T.width/2);s.addConstraint(new ki(E,oi.Eq,f.xDist,On.required))}}else if("yDist"in f){let{yDist:y,top:g,bottom:x,edgeToEdge:v,centerToCenter:P}=f,w=a(`${g}_y`),k=a(`${x}_y`),T=r(g)?.bounds,I=r(x)?.bounds;if(P){let E=new Dn(w,[-1,k]);s.addConstraint(new ki(E,oi.Eq,f.yDist,On.required))}else if(v){let E=new Dn(w,T.height/2,[-1,k],-I.height/2);s.addConstraint(new ki(E,oi.Eq,f.yDist,On.required))}}else if("sameY"in f){let{for:y}=f;if(y.length<2)continue;let g=y.map(v=>a(`${v}_y`)),x=new Dn(...g.slice(1));s.addConstraint(new ki(x,oi.Eq,g[0],On.required))}else if("sameX"in f){let{for:y}=f;if(y.length<2)continue;let g=y.map(v=>a(`${v}_x`)),x=new Dn(...g.slice(1));s.addConstraint(new ki(x,oi.Eq,g[0],On.required))}}s.updateVariables(),gOt.enabled&&(console.log("Solution to layout constraints:"),console.table(Object.entries(o).map(([p,f])=>({var:p,val:f.value()}))));let c={left:1/0,right:-1/0,top:-1/0,bottom:1/0};for(let{selector:p,bounds:{width:f,height:y}}of i){let g=a(`${p}_x`),x=a(`${p}_y`),v=g.value()-f/2,P=g.value()+f/2,w=x.value()+y/2,k=x.value()-y/2;c.left=Math.min(c.left,v),c.right=Math.max(c.right,P),c.top=Math.max(c.top,w),c.bottom=Math.min(c.bottom,k)}let l={x:-(c.right+c.left)/2,y:-(c.top+c.bottom)/2},u=this.getPrimitiveContainer()._getGlobalPcbPositionBeforeLayout();l.x+=u.x,l.y+=u.y;for(let{component:p,selector:f}of i){let y=a(`${f}_x`),g=a(`${f}_y`);p._setPositionFromLayout({x:y.value()+l.x,y:g.value()+l.y})}}},Zet=n=>{if(!n)return null;let t=n.split("?")[0].split("#")[0],i=t.split("/").pop()??t;return i.includes(".")?i.split(".").pop()?.toLowerCase()??null:null},xOt=(n,e)=>{let t=n.replace(/\/+$/,""),i=e.replace(/^\/+/,"");return`${t}/${i}`},Ket=(n,e)=>{if(!e||!n.startsWith("/"))return n;try{let t=new URL(e);return t.pathname!=="/"&&n.startsWith(t.pathname)?new URL(n,t.origin).toString():xOt(e,n)}catch{return n}},qA=h.union([h.number(),h.string()]),met=h.object({x:qA,y:qA,z:qA}),Jet=class extends Ee{get config(){return{componentName:"CadModel",zodProps:mW}}doInitialCadModelRender(){let n=this._findParentWithPcbComponent();if(!n||!n.pcb_component_id)return;let{db:e}=this.root,{boardThickness:t=0}=this.root?._getBoard()??{},i=n._getPcbCircuitJsonBounds(),r=e.pcb_component.get(n.pcb_component_id),s=this._parsedProps;if(!s||typeof s.modelUrl!="string"&&typeof s.stepUrl!="string")return;let o=n._computePcbGlobalTransformBeforeLayout(),c=to(o).rotation.angle*180/Math.PI,l=met.parse({x:0,y:0,z:0});if(typeof s.rotationOffset=="number")l.z=Number(s.rotationOffset);else if(typeof s.rotationOffset=="object"){let v=met.parse(s.rotationOffset);l.x=Number(v.x),l.y=Number(v.y),l.z=Number(v.z)}let u=dS.parse({x:s.pcbX??0,y:s.pcbY??0,z:s.pcbZ??0,...typeof s.positionOffset=="object"?s.positionOffset:{}}),p=s.zOffsetFromSurface!==void 0?Y.parse(s.zOffsetFromSurface):0,f=n.props.layer==="bottom"?"bottom":"top",y=s.modelUrl?Zet(s.modelUrl):void 0,g={};if(y==="stl"?g.model_stl_url=this._addCachebustToModelUrl(s.modelUrl):y==="obj"?g.model_obj_url=this._addCachebustToModelUrl(s.modelUrl):y==="gltf"?g.model_gltf_url=this._addCachebustToModelUrl(s.modelUrl):y==="glb"?g.model_glb_url=this._addCachebustToModelUrl(s.modelUrl):y==="step"||y==="stp"?g.model_step_url=this._addCachebustToModelUrl(s.modelUrl):y==="wrl"||y==="vrml"?g.model_wrl_url=this._addCachebustToModelUrl(s.modelUrl):g.model_stl_url=this._addCachebustToModelUrl(s.modelUrl),s.stepUrl){let v=this._addCachebustToModelUrl(s.stepUrl);v&&(g.model_step_url=v)}let x=e.cad_component.insert({position:{x:i.center.x+Number(u.x),y:i.center.y+Number(u.y),z:(f==="bottom"?-t/2:t/2)+(f==="bottom"?-p:p)+Number(u.z)},rotation:{x:Number(l.x),y:(f==="top"?0:180)+Number(l.y),z:f==="bottom"?-(c+Number(l.z))+180:c+Number(l.z)},pcb_component_id:n.pcb_component_id,source_component_id:n.source_component_id,model_unit_to_mm_scale_factor:typeof s.modelUnitToMmScale=="number"?s.modelUnitToMmScale:void 0,...g});this.cad_component_id=x.cad_component_id}_findParentWithPcbComponent(){let n=this.parent;for(;n&&!n.pcb_component_id;)n=n.parent;return n}_addCachebustToModelUrl(n){if(!n)return n;let e=this.root?.platform?.projectBaseUrl,t=Ket(n,e);if(!t.includes("modelcdn.tscircuit.com"))return t;let i=this.root?.getClientOrigin()??"";return`${t}${t.includes("?")?"&":"?"}cachebust_origin=${encodeURIComponent(i)}`}},Qet=class extends Ee{constructor(){super(...arguments);d(this,"isPrimitiveContainer",!0)}get config(){return{componentName:"CadAssembly",zodProps:fW}}},bOt=(n,e)=>{if(!n)return;let t={};for(let[i,r]of Object.entries(n)){let s=Y1(i,e),o={leftMargin:r.marginLeft??r.leftMargin,rightMargin:r.marginRight??r.rightMargin,topMargin:r.marginTop??r.topMargin,bottomMargin:r.marginBottom??r.bottomMargin};t[`pin${s}`]={...t[`pin${s}`],...o}}return t},_et=class{constructor({input:n}){d(this,"input");this.input=n}solveAndMapToTraces(){let n=[];for(let e of this.input.connections){if(e.pointsToConnect.length!==2)continue;let[t,i]=e.pointsToConnect,r={type:"pcb_trace",pcb_trace_id:"",connection_name:e.name,route:[{route_type:"wire",x:t.x,y:t.y,layer:"top",width:.1},{route_type:"wire",x:i.x,y:i.y,layer:"top",width:.1}]};n.push(r)}return n}},vOt=n=>{let e=Math.min(...n.map(s=>s.center.x)),t=Math.max(...n.map(s=>s.center.x)),i=Math.min(...n.map(s=>s.center.y)),r=Math.max(...n.map(s=>s.center.y));return{minX:e,maxX:t,minY:i,maxY:r}},yet=["top","bottom","inner1","inner2"],Ww=(n,e=[])=>{let t=[];if(e.length===0){let a=n[0].layers;for(let c of a)t.push(...Ww(n.slice(1),[c]));return t}if(n.length===0)return[];let i=n[0],r=i.via||i.optional_via,s=e[e.length-1];if(n.length===1){let a=i;return a.layers&&r?a.layers.map(c=>({layer_path:[...e,c]})):a.layers?.includes(s)?[{layer_path:[...e,s]}]:[]}if(!r)return i.layers&&!i.layers.includes(s)?[]:Ww(n.slice(1),e.concat([s]));let o=(i.optional_via?yet:yet.filter(a=>a!==s)).filter(a=>!i.layers||i.layers?.includes(a));for(let a of o)t.push(...Ww(n.slice(1),e.concat(a)));return t};function get(n){let e={x:n.to.x-n.from.x,y:n.to.y-n.from.y},t=Math.abs(e.x),i=Math.abs(e.y);return t>i?e.x>0?"right":"left":e.y>0?"down":"up"}function B_(n,e){return Math.hypot(n.x-e.x,n.y-e.y)}var SOt=n=>{if(n.length===1)return n[0];if(n.some(c=>c.length===0))throw new Error("Cannot merge routes with zero length");let e=[],t=n[0][0],i=n[0][n[0].length-1],r=n[1][0],s=n[1][n[1].length-1],o=Math.min(B_(t,r),B_(t,s)),a=Math.min(B_(i,r),B_(i,s));o<a?e.push(...n[0].reverse()):e.push(...n[0]);for(let c=1;c<n.length;c++){let l=e[e.length-1],u=n[c],p=u[0],f=u[u.length-1],y=B_(l,p),g=B_(l,f);y<g?e.push(...u):e.push(...u.reverse())}for(let c=1;c<e.length-1;c++){let l=e[c-1],u=e[c];l.route_type==="wire"&&u.route_type==="wire"&&l.layer!==u.layer&&e.splice(c,0,{x:l.x,y:l.y,from_layer:l.layer,to_layer:u.layer,route_type:"via"})}return e},wOt=(n,e)=>{let t="_getGlobalPcbPositionBeforeLayout"in n?n._getGlobalPcbPositionBeforeLayout():n,i="_getGlobalPcbPositionBeforeLayout"in e?e._getGlobalPcbPositionBeforeLayout():e;return Math.sqrt((t.x-i.x)**2+(t.y-i.y)**2)};function POt(n,e){if(e.length===0)throw new Error("No candidates given to getClosest method");let t=e[0],i=1/0;for(let r of e){let s=wOt(n,r);s<i&&(t=r,i=s)}return t}var kOt=(n,e)=>{let t=0;t+=n.length??0,t+=e.filter(i=>i.is_crossing).length;for(let i=1;i<e.length;i++){let r=e[i-1],s=e[i],o=Math.abs(r.from.x-r.to.x)<.01,a=Math.abs(s.from.x-s.to.x)<.01;o!==a&&t++}return t},X1=n=>({up:"bottom",down:"top",left:"right",right:"left"})[n]??null,e9=({firstEdge:n,firstEdgePort:e,firstDominantDirection:t,lastEdge:i,lastEdgePort:r,lastDominantDirection:s})=>{if(n&&e)return e9({lastEdge:{from:n.to,to:n.from},lastEdgePort:e,lastDominantDirection:t}).reverse().map(a=>({from:a.to,to:a.from}));let o=[];if(i&&r){let a={x:i.to.x,y:i.to.y};s==="left"||s==="right"?(a.x=r.position.x,o.push({from:i.to,to:{...a}}),o.push({from:a,to:{...r.position}})):(a.y=r.position.y,o.push({from:i.to,to:{...a}}),o.push({from:a,to:{...r.position}}))}return o=o.filter(a=>zi(a.from,a.to)>.01),o};function TOt(n){try{return[n(),null]}catch(e){return[null,e]}}var EOt=(n,{db:e})=>{let t=n.map(i=>{let r=e.source_port.get(i.source_port_id);if(!r?.source_component_id)return null;let s=e.source_component.get(r.source_component_id);return s?.ftype==="simple_capacitor"?s.max_decoupling_trace_length:null}).filter(i=>i!==null);if(t.length!==0)return Math.min(...t)};function MOt({ports:n,nets:e}){if(n.length>=2)return`${n[0]?.selector} to ${n[1]?.selector}`;if(n.length===1&&e.length===1)return`${n[0]?.selector} to net.${e[0]._parsedProps.name}`}var COt=(n,{db:e})=>{let t=e.pcb_board.list()[0];if(t.outline){let c=t.outline,l=(u,p)=>{let f=!1;for(let y=0,g=p.length-1;y<p.length;g=y++){let x=p[y].x,v=p[y].y,P=p[g].x,w=p[g].y;v>u.y!=w>u.y&&u.x<(P-x)*(u.y-v)/(w-v)+x&&(f=!f)}return f};return n.some(u=>!l(u,c))}let i=t.width,r=t.height,s=t.center.x,o=t.center.y;return n.some(c=>c.x<s-i/2||c.y<o-r/2||c.x>s+i/2||c.y>o+r/2)},xet=(n,e)=>Math.abs(n-e)<1e-4,IOt=(n,e,{viaDiameter:t=.5}={})=>{let i=[];for(let r=0;r<n.length-1;r++){let[s,o]=[n[r],n[r+1]],a=r-1>=0?n[r-1]:null,c=xet(s.y,o.y),l=xet(s.x,o.x);if(!c&&!l)throw new Error(`getObstaclesFromTrace currently only supports horizontal and vertical traces (not diagonals) Conflicting trace: ${e}, start: (${s.x}, ${s.y}), end: (${o.x}, ${o.y})`);let u={type:"rect",layers:[s.layer],center:{x:(s.x+o.x)/2,y:(s.y+o.y)/2},width:c?Math.abs(s.x-o.x):.1,height:l?Math.abs(s.y-o.y):.1,connectedTo:[e]};if(i.push(u),a&&a.layer===s.layer&&s.layer!==o.layer){let p={type:"rect",layers:[s.layer,o.layer],center:{x:s.x,y:s.y},connectedTo:[e],width:t,height:t};i.push(p)}}return i};function NOt(n,e=4){let{center:t,width:i,height:r,rotation:s}=n,o=[],a=s*Math.PI/180,c=Math.cos(a),l=Math.sin(a),u=(s%360+360)%360;if(r<=i?u>=45&&u<135||u>=225&&u<315:u>=135&&u<225||u>=315||u<45){let f=i/e;for(let y=0;y<e;y++){let g=(y-e/2+.5)*f,x=-g*c,v=-g*l,P=f*1.1,w=Math.abs(r*c)+Math.abs(f*l);o.push({center:{x:t.x+x,y:t.y+v},width:P,height:w})}}else{let f=r/e;for(let y=0;y<e;y++){let g=(y-e/2+.5)*f,x=-g*l,v=g*c,P=Math.abs(i*c)+Math.abs(f*l),w=f*1.1;o.push({center:{x:t.x+x,y:t.y+v},width:P,height:w})}}return o}function AOt(n,e={}){if(n.length<3)return[];let{rectHeight:t=.1}=e,i=[],r=n.map(a=>a.y),s=Math.min(...r),o=Math.max(...r);for(let a=s;a<o;a+=t){let c=a+t/2,l=[];for(let u=0;u<n.length;u++){let p=n[u],f=n[(u+1)%n.length];if(p.y<=c&&f.y>c||f.y<=c&&p.y>c){let y=(c-p.y)*(f.x-p.x)/(f.y-p.y)+p.x;l.push(y)}}l.sort((u,p)=>u-p);for(let u=0;u<l.length;u+=2)if(u+1<l.length){let p=l[u],y=l[u+1]-p;y>1e-6&&i.push({center:{x:p+y/2,y:c},width:y,height:t})}}return i}function ROt(n,e={}){let{center:t,radius:i}=n,{rectHeight:r=.1}=e,s=[],o=Math.ceil(i*2/r);for(let a=0;a<o;a++){let c=t.y-i+(a+.5)*r,l=c-t.y,u=Math.sqrt(i*i-l*l);u>0&&s.push({center:{x:t.x,y:c},width:u*2,height:r})}return s}var Go=["top","inner1","inner2","bottom"],tnt=(n,e)=>{let t=r=>e?r.concat(r.map(s=>e?.getNetConnectedToId(s)).filter(Boolean)):r,i=[];for(let r of n)if(r.type==="pcb_smtpad"){if(r.shape==="circle")i.push({type:"oval",layers:[r.layer],center:{x:r.x,y:r.y},width:r.radius*2,height:r.radius*2,connectedTo:t([r.pcb_smtpad_id])});else if(r.shape==="rect")i.push({type:"rect",layers:[r.layer],center:{x:r.x,y:r.y},width:r.width,height:r.height,connectedTo:t([r.pcb_smtpad_id])});else if(r.shape==="rotated_rect"){let s={center:{x:r.x,y:r.y},width:r.width,height:r.height,rotation:r.ccw_rotation},o=NOt(s);for(let a of o)i.push({type:"rect",layers:[r.layer],center:a.center,width:a.width,height:a.height,connectedTo:t([r.pcb_smtpad_id])})}}else if(r.type==="pcb_keepout")r.shape==="circle"?i.push({type:"oval",layers:r.layers,center:{x:r.center.x,y:r.center.y},width:r.radius*2,height:r.radius*2,connectedTo:[]}):r.shape==="rect"&&i.push({type:"rect",layers:r.layers,center:{x:r.center.x,y:r.center.y},width:r.width,height:r.height,connectedTo:[]});else if(r.type==="pcb_cutout"){if(r.shape==="rect")i.push({type:"rect",layers:Go,center:{x:r.center.x,y:r.center.y},width:r.width,height:r.height,connectedTo:[]});else if(r.shape==="circle"){let s=ROt({center:r.center,radius:r.radius},{rectHeight:.6});for(let o of s)i.push({type:"rect",layers:Go,center:o.center,width:o.width,height:o.height,connectedTo:[]})}else if(r.shape==="polygon"){let s=AOt(r.points,{rectHeight:.6});for(let o of s)i.push({type:"rect",layers:Go,center:o.center,width:o.width,height:o.height,connectedTo:[]})}}else if(r.type==="pcb_hole")r.hole_shape==="oval"?i.push({type:"oval",center:{x:r.x,y:r.y},width:r.hole_width,height:r.hole_height,connectedTo:[]}):r.hole_shape==="rect"?i.push({type:"rect",layers:Go,center:{x:r.x,y:r.y},width:r.hole_width,height:r.hole_height,connectedTo:[]}):r.hole_shape==="square"?i.push({type:"rect",layers:Go,center:{x:r.x,y:r.y},width:r.hole_diameter,height:r.hole_diameter,connectedTo:[]}):(r.hole_shape==="round"||r.hole_shape==="circle")&&i.push({type:"rect",layers:Go,center:{x:r.x,y:r.y},width:r.hole_diameter,height:r.hole_diameter,connectedTo:[]});else if(r.type==="pcb_plated_hole"){if(r.shape==="circle")i.push({type:"oval",layers:Go,center:{x:r.x,y:r.y},width:r.outer_diameter,height:r.outer_diameter,connectedTo:t([r.pcb_plated_hole_id])});else if(r.shape==="circular_hole_with_rect_pad")i.push({type:"rect",layers:Go,center:{x:r.x,y:r.y},width:r.rect_pad_width,height:r.rect_pad_height,connectedTo:t([r.pcb_plated_hole_id])});else if(r.shape==="oval"||r.shape==="pill")i.push({type:"oval",layers:Go,center:{x:r.x,y:r.y},width:r.outer_width,height:r.outer_height,connectedTo:t([r.pcb_plated_hole_id])});else if(r.shape==="hole_with_polygon_pad"&&"pad_outline"in r&&r.pad_outline&&r.pad_outline.length>0){let s=r.pad_outline.map(y=>r.x+y.x),o=r.pad_outline.map(y=>r.y+y.y),a=Math.min(...s),c=Math.max(...s),l=Math.min(...o),u=Math.max(...o),p=(a+c)/2,f=(l+u)/2;i.push({type:"rect",layers:Go,center:{x:p,y:f},width:c-a,height:u-l,connectedTo:t([r.pcb_plated_hole_id])})}}else if(r.type==="pcb_trace"){let s=IOt(r.route.map(o=>({x:o.x,y:o.y,layer:"layer"in o?o.layer:o.from_layer})),r.source_trace_id);i.push(...s)}else if(r.type==="pcb_via"){let s=!!(r.net_is_assignable??r.netIsAssignable);i.push({type:"rect",layers:r.layers,center:{x:r.x,y:r.y},connectedTo:[],width:r.outer_diameter,height:r.outer_diameter,netIsAssignable:s||void 0})}return i},ml=({anchor_position:n,anchor_side:e,text:t,font_size:i=.18})=>{let r=.1*(i/.18),s=t.length*r,o=i,a={...n};switch(e){case"right":a.x-=s/2;break;case"left":a.x+=s/2;break;case"top":a.y-=o/2;break;case"bottom":a.y+=o/2;break}return a},f9=({db:n,source_trace_id:e,sameNetOnly:t,differentNetOnly:i})=>{!t&&!i&&(i=!0);let r=n.source_trace.get(e),s=[];for(let o of n.schematic_trace.list()){if(o.source_trace_id===e)continue;let c=n.source_trace.get(o.source_trace_id)?.subcircuit_connectivity_map_key===r.subcircuit_connectivity_map_key;i&&c||t&&!c||s.push(o)}return s},OOt=({edges:n,otherEdges:e})=>{let t=[...n];for(let i=0;i<t.length;i++){if(i>2e3)throw new Error("Over 2000 iterations spent inside createSchematicTraceCrossingSegments, you have triggered an infinite loop, please report this!");let r=t[i],s=Math.abs(r.from.x-r.to.x)<.01?"vertical":r.from.y===r.to.y?"horizontal":"not-orthogonal";if(s==="not-orthogonal")continue;let o=[];for(let x of e){let v=x.from.x===x.to.x?"vertical":x.from.y===x.to.y?"horizontal":"not-orthogonal";if(v==="not-orthogonal"||s===v)continue;if(Na([r.from,r.to],[x.from,x.to],{lineThickness:.01})){let w=s==="vertical"?r.from.x:x.from.x,k=s==="vertical"?x.from.y:r.from.y,T={x:w,y:k};o.push({otherEdge:x,crossingPoint:T,distanceFromEdgeFrom:zi(r.from,T)})}}if(o.length===0)continue;let a=o[0];for(let x of o)x.distanceFromEdgeFrom<a.distanceFromEdgeFrom&&(a=x);let c=a.crossingPoint,l=.075;if(c.x===r.from.x&&c.y===r.from.y)continue;let u=wS(r.from,c),p={x:c.x-u.x*l/2,y:c.y-u.y*l/2},f={x:c.x+u.x*l/2,y:c.y+u.y*l/2},y=zi(f,r.to)<l,g=[{from:r.from,to:p},{from:p,to:f,is_crossing:!0},{from:f,to:r.to}];t.splice(i,1,...g),i+=g.length-2,y&&i++}return t},n9=.001,Y_=(n,e)=>{let t=Math.min(e.from.x,e.to.x),i=Math.max(e.from.x,e.to.x),r=Math.min(e.from.y,e.to.y),s=Math.max(e.from.y,e.to.y);return n.x>=t&&n.x<=i&&n.y>=r&&n.y<=s},bet=n=>{let e=Math.abs(n.from.x-n.to.x)<n9,t=Math.abs(n.from.y-n.to.y)<n9;return e?"vertical":t?"horizontal":"diagonal"},LOt=(n,e)=>{let t=bet(n),i=bet(e);if(t===i)return null;if(t==="vertical"&&i==="horizontal"||t==="horizontal"&&i==="vertical"){let p=t==="vertical"?n:e,f=t==="horizontal"?n:e,y=p.from.x,g=f.from.y,x={x:y,y:g};return Y_(x,n)&&Y_(x,e)?x:null}if(t==="vertical"||i==="vertical"){let p=t==="vertical"?n:e,f=t==="vertical"?e:n,y=p.from.x,g=(f.to.y-f.from.y)/(f.to.x-f.from.x),x=f.from.y-g*f.from.x,v=g*y+x,P={x:y,y:v};return Y_(P,n)&&Y_(P,e)?P:null}let r=(n.to.y-n.from.y)/(n.to.x-n.from.x),s=n.from.y-r*n.from.x,o=(e.to.y-e.from.y)/(e.to.x-e.from.x),a=e.from.y-o*e.from.x;if(Math.abs(r-o)<n9)return null;let c=(a-s)/(r-o),l=r*c+s,u={x:c,y:l};return Y_(u,n)&&Y_(u,e)?u:null},FOt=({edges:n,db:e,source_trace_id:t})=>{let i=f9({db:e,source_trace_id:t,sameNetOnly:!0}).flatMap(s=>s.edges),r=new Map;for(let s of n)for(let o of i){let a=LOt(s,o);if(a){let c=`${a.x.toFixed(6)},${a.y.toFixed(6)}`;r.has(c)||r.set(c,a)}}return Array.from(r.values())};function zOt(n,e={}){let{minX:t,maxX:i,minY:r,maxY:s}=n,o=e.padding??1;if(!isFinite(t)||!isFinite(i)||!isFinite(r)||!isFinite(s))return[];let a=t-o,c=i+o,l=s+o,u=r-o,p=.01;return[{type:"rect",layers:["top"],center:{x:(a+c)/2,y:l},width:c-a,height:p,connectedTo:[]},{type:"rect",layers:["top"],center:{x:(a+c)/2,y:u},width:c-a,height:p,connectedTo:[]},{type:"rect",layers:["top"],center:{x:a,y:(l+u)/2},width:p,height:l-u,connectedTo:[]},{type:"rect",layers:["top"],center:{x:c,y:(l+u)/2},width:p,height:l-u,connectedTo:[]}]}var $Ot=n=>{let e=n.root.db,t=n._findConnectedPorts().ports??[],i=new Set(t.map(o=>o.schematic_port_id)),r=[];for(let o of e.toArray()){if(o.type==="schematic_component"){let a=!!o.symbol_name,c=o.size.width>o.size.height?"horz":"vert";r.push({type:"rect",layers:["top"],center:o.center,width:o.size.width+(a&&c==="horz"?-.5:0),height:o.size.height+(a&&c==="vert"?-.5:0),connectedTo:[]})}if(o.type==="schematic_port"){if(i.has(o.schematic_port_id))continue;let a=o.facing_direction?PS(o.facing_direction):{x:0,y:0};r.push({type:"rect",layers:["top"],center:{x:o.center.x-a.x*.1,y:o.center.y-a.y*.1},width:.1+Math.abs(a.x)*.3,height:.1+Math.abs(a.y)*.3,connectedTo:[]})}o.type==="schematic_text"&&r.push({type:"rect",layers:["top"],center:o.position,width:(o.text?.length??0)*.1,height:.2,connectedTo:[]}),o.type==="schematic_box"&&r.push({type:"rect",layers:["top"],center:{x:o.x,y:o.y},width:o.width,height:o.height,connectedTo:[]})}let s=Vet(e.toArray());return r.push(...zOt(s,{padding:1})),r},DOt=({edges:n,db:e,source_trace_id:t})=>{let i=e.source_trace.get(t),r=f9({db:e,source_trace_id:t,differentNetOnly:!0}).flatMap(o=>o.edges),s=o=>{let{from:a,to:c}=o;return a.x===c.x?"vertical":"horizontal"};for(let o of n){let a=s(o),c=()=>r.find(u=>s(u)===a&&Na([o.from,o.to],[u.from,u.to],{lineThickness:.05})),l=c();for(;l;)a==="horizontal"?(o.from.y+=.1,o.to.y+=.1):(o.from.x+=.1,o.to.x+=.1),l=c()}},i9=n=>{switch(n){case"up":return"y+";case"down":return"y-";case"left":return"x-";case"right":return"x+";default:}},jOt=eq.version??"unknown",z1=class extends Error{constructor(n){super(`${n} (capacity-autorouter@${jOt})`),this.name="AutorouterError"}},Qw=class extends Error{constructor(n){super(n.message),this.errorData=n,this.name="TraceConnectionError"}},BOt=n=>{if(n.root?._featureMspSchematicTraceRouting||n._couldNotFindPort||n.root?.schematicDisabled)return;let{db:e}=n.root,{_parsedProps:t,parent:i}=n;if(!i)throw new Error("Trace has no parent");let r,s;try{let U=n._findConnectedPorts();r=U.allPortsFound,s=U.portsWithSelectors??[]}catch(U){if(U instanceof Qw){e.source_trace_not_connected_error.insert({...U.errorData,error_type:"source_trace_not_connected_error"});return}throw U}let{netsWithSelectors:o}=n._findConnectedNets();if(!r)return;let c=s.map(U=>U.port.schematic_port_id).sort().join(","),l=n.root?._getBoard();if(l?._connectedSchematicPortPairs&&l._connectedSchematicPortPairs.has(c))return;let u={name:n.source_trace_id,pointsToConnect:[]},p=$Ot(n),f=s.filter(({port:U})=>U.schematic_port_id!==null).map(({port:U})=>({port:U,position:U._getGlobalSchematicPositionAfterLayout(),schematic_port_id:U.schematic_port_id??void 0,facingDirection:U.facingDirection}));if(f.length===1&&o.length===1){let U=o[0].net,{port:H,position:tt}=f[0],et=n.getSubcircuit().selectAll("netlabel").find(J=>{let nt=J._parsedProps.connection??J._parsedProps.connectsTo;return nt?Array.isArray(nt)?nt.some(ht=>n.getSubcircuit().selectOne(ht,{port:!0})===H):n.getSubcircuit().selectOne(nt,{port:!0})===H:!1});if(!et){let J=e.schematic_net_label.getWhere({source_trace_id:n.source_trace_id});J&&(et=J)}if(et){let J="_getGlobalSchematicPositionBeforeLayout"in et?et._getGlobalSchematicPositionBeforeLayout():et.anchor_position,nt=[];tt.x===J.x||tt.y===J.y?nt.push({from:tt,to:J}):(nt.push({from:tt,to:{x:J.x,y:tt.y}}),nt.push({from:{x:J.x,y:tt.y},to:J}));let ut=e.schematic_trace.insert({source_trace_id:n.source_trace_id,edges:nt,junctions:[],subcircuit_connectivity_map_key:n.subcircuit_connectivity_map_key??void 0});n.schematic_trace_id=ut.schematic_trace_id;return}if(n.props.schDisplayLabel){let J=X1(H.facingDirection)??"bottom";e.schematic_net_label.insert({text:n.props.schDisplayLabel,source_net_id:U.source_net_id,anchor_position:tt,center:ml({anchor_position:tt,anchor_side:J,text:n.props.schDisplayLabel}),anchor_side:J});return}let mt=X1(H.facingDirection)??"bottom",V=e.schematic_net_label.insert({text:U._parsedProps.name,source_net_id:U.source_net_id,anchor_position:tt,center:ml({anchor_position:tt,anchor_side:mt,text:U._parsedProps.name}),anchor_side:mt});return}if(n.props.schDisplayLabel&&("from"in n.props&&"to"in n.props||"path"in n.props)){n._doInitialSchematicTraceRenderWithDisplayLabel();return}if(f.length<2)return;let x=(()=>{let U=[];for(let tt=0;tt<f.length-1;tt++){let et=f[tt],mt=f[tt+1],V=Wc({x:et.position.x,y:et.position.y,facingDirection:i9(et.facingDirection)},{x:mt.position.x,y:mt.position.y,facingDirection:i9(mt.facingDirection)});for(let J=0;J<V.length-1;J++)U.push({from:V[J],to:V[J+1]})}let H=(tt,et)=>{let mt=et.width/2,V=et.height/2,J=et.center.x-mt,nt=et.center.x+mt,ut=et.center.y-V,ht=et.center.y+V,kt=ot=>ot.x>=J&&ot.x<=nt&&ot.y>=ut&&ot.y<=ht;return kt(tt.from)||kt(tt.to)?!0:[[{x:J,y:ut},{x:nt,y:ut}],[{x:nt,y:ut},{x:nt,y:ht}],[{x:nt,y:ht},{x:J,y:ht}],[{x:J,y:ht},{x:J,y:ut}]].some(ot=>Na([tt.from,tt.to],ot,{lineThickness:0}))};for(let tt of U)for(let et of p)if(H(tt,et))return null;return U})();x&&x.length===0&&(x=null),u.pointsToConnect=f.map(({position:U})=>({...U,layer:"top"}));let v=vOt(p),P=2,w={minTraceWidth:.1,obstacles:p,connections:[u],bounds:{minX:v.minX-P,maxX:v.maxX+P,minY:v.minY-P,maxY:v.maxY+P},layerCount:1},k=uS,T=!1;if(n.getSubcircuit().props._schDirectLineRoutingEnabled&&(k=_et,T=!0),!x){let H=new k({input:w,MAX_ITERATIONS:100,OBSTACLE_MARGIN:.1,isRemovePathLoopsEnabled:!0,isShortenPathWithShortcutsEnabled:!0,marginsWithCosts:[{margin:1,enterCost:0,travelCostFactor:1},{margin:.3,enterCost:0,travelCostFactor:1},{margin:.2,enterCost:0,travelCostFactor:2},{margin:.1,enterCost:0,travelCostFactor:3}]}).solveAndMapToTraces();if(H.length===0){if(n._isSymbolToChipConnection()||n._isSymbolToSymbolConnection()||n._isChipToChipConnection()){n._doInitialSchematicTraceRenderWithDisplayLabel();return}H=new _et({input:w}).solveAndMapToTraces(),T=!0}let[{route:tt}]=H;x=[];for(let et=0;et<tt.length-1;et++)x.push({from:tt[et],to:tt[et+1]})}let I=n.source_trace_id,E=[];if(!T){DOt({edges:x,db:e,source_trace_id:I});let U=f9({db:e,source_trace_id:I,differentNetOnly:!0}).flatMap(H=>H.edges);x=OOt({edges:x,otherEdges:U}),E=FOt({edges:x,db:e,source_trace_id:n.source_trace_id})}if(!x||x.length===0)return;let N=x[x.length-1],M=f[f.length-1],A=get(N);x.push(...e9({lastEdge:N,lastEdgePort:M,lastDominantDirection:A}));let R=x[0],j=f[0],B=get(R);if(x.unshift(...e9({firstEdge:R,firstEdgePort:j,firstDominantDirection:B})),!n.source_trace_id)throw new Error("Missing source_trace_id for schematic trace insertion.");if(n.getSubcircuit()._parsedProps.schTraceAutoLabelEnabled&&kOt(E,x)>=5&&(n._isSymbolToChipConnection()||n._isSymbolToSymbolConnection()||n._isChipToChipConnection())){n._doInitialSchematicTraceRenderWithDisplayLabel();return}let G=e.schematic_trace.insert({source_trace_id:n.source_trace_id,edges:x,junctions:E,subcircuit_connectivity_map_key:n.subcircuit_connectivity_map_key??void 0});n.schematic_trace_id=G.schematic_trace_id;for(let{port:U}of s)U.schematic_port_id&&e.schematic_port.update(U.schematic_port_id,{is_connected:!0});l?._connectedSchematicPortPairs&&l._connectedSchematicPortPairs.add(c)};function ent(n){let e=0;for(let t=0;t<n.length;t++){let i=n[t];if(i.route_type==="wire"){let r=n[t+1];if(r){let s=r.x-i.x,o=r.y-i.y;e+=Math.sqrt(s*s+o*o)}}else i.route_type==="via"&&(e+=1.6)}return e}var Vw=n=>({...n._getGlobalPcbPositionAfterLayout(),layers:n.getAvailablePcbLayers()}),YOt=!1;function XOt(n){if(n.root?.pcbDisabled)return;let{db:e}=n.root,{_parsedProps:t,parent:i}=n,r=n.getSubcircuit();if(!i)throw new Error("Trace has no parent");if(r._parsedProps.routingDisabled)return;let s=r._parsedProps.pcbRouteCache?.pcbTraces;if(s){let A=e.pcb_trace.insert({route:s.flatMap(R=>R.route),source_trace_id:n.source_trace_id,subcircuit_id:r?.subcircuit_id??void 0,pcb_group_id:n.getGroup()?.pcb_group_id??void 0});n.pcb_trace_id=A.pcb_trace_id;return}if(t.pcbPath&&t.pcbPath.length>0||!r._shouldUseTraceByTraceRouting())return;let{allPortsFound:o,ports:a}=n._findConnectedPorts(),c=[];if(!o)return;let l=[];for(let A of a)A._hasMatchedPcbPrimitive()||l.push(A);if(l.length>0){e.pcb_trace_error.insert({error_type:"pcb_trace_error",source_trace_id:n.source_trace_id,message:`Some ports did not have a matching PCB primitive (e.g. a pad or plated hole), this can happen if a footprint is missing. As a result, ${n} wasn't routed. Missing ports: ${l.map(A=>A.getString()).join(", ")}`,pcb_trace_id:n.pcb_trace_id,pcb_component_ids:[],pcb_port_ids:l.map(A=>A.pcb_port_id).filter(Boolean)});return}let u=n._findConnectedNets().netsWithSelectors;if(a.length===0&&u.length===2){n.renderError("Trace connects two nets, we haven't implemented a way to route this yet");return}else if(a.length===1&&u.length===1){let A=a[0],j=u[0].net.getAllConnectedPorts().filter(G=>G!==A);if(j.length===0){console.log("Nothing to connect this port to, the net is empty. TODO should emit a warning!");return}let B=POt(A,j);c.push(B),a.push(B)}else if(a.length>1&&u.length>=1){n.renderError("Trace has more than one port and one or more nets, we don't currently support this type of complex trace routing");return}let p=a.flatMap(A=>A.matchedComponents.filter(R=>R.componentName==="TraceHint")),f=(n._parsedProps.pcbRouteHints??[]).concat(p.flatMap(A=>A.getPcbRouteHints()));if(a.length>2){n.renderError(`Trace has more than two ports (${a.map(A=>A.getString()).join(", ")}), routing between more than two ports for a single trace is not implemented`);return}if(n.getSubcircuit().selectAll("trace").filter(A=>A.renderPhaseStates.PcbTraceRender.initialized).some(A=>A._portsRoutedOnPcb.length===a.length&&A._portsRoutedOnPcb.every(R=>a.includes(R))))return;let x=[];f.length===0?x=[Vw(a[0]),Vw(a[1])]:x=[Vw(a[0]),...f,Vw(a[1])];let v=Ww(x);if(YOt&&v.length===0){n.renderError(`Could not find a common layer (using hints) for trace ${n.getString()}`);return}let P=nr(n.root.db.toArray()),[w,k]=TOt(()=>tnt(n.root.db.toArray()));if(k){n.renderError({type:"pcb_trace_error",error_type:"pcb_trace_error",pcb_trace_error_id:n.pcb_trace_id,message:`Error getting obstacles for autorouting: ${k.message}`,source_trace_id:n.source_trace_id,center:{x:0,y:0},pcb_port_ids:a.map(A=>A.pcb_port_id),pcb_trace_id:n.pcb_trace_id,pcb_component_ids:[]});return}for(let A of w)if(A.connectedTo.length>0){let j=P.getNetConnectedToId(A.connectedTo[0]);j&&A.connectedTo.push(j)}let T=[];if(v.length===0)T=x;else{let A=v[0].layer_path;T=x.map((R,j)=>R.via?{...R,via_to_layer:A[j]}:{...R,layers:[A[j]]})}T[0].pcb_port_id=a[0].pcb_port_id,T[T.length-1].pcb_port_id=a[1].pcb_port_id;let I=[];for(let[A,R]of Uet(T)){let j="via_to_layer"in A?A.via_to_layer:null,B=2,G="layers"in A&&A.layers.length===1?A.layers[0]:j??"top",U="layers"in R&&R.layers.length===1?R.layers[0]:j??"top",H="pcb_port_id"in A?A.pcb_port_id:null,tt="pcb_port_id"in R?R.pcb_port_id:null,et=n._getExplicitTraceThickness()??n.getSubcircuit()._parsedProps.minTraceWidth??.16,mt=new uS({OBSTACLE_MARGIN:et*2,isRemovePathLoopsEnabled:!0,optimizeWithGoalBoxes:!!(H&&tt),connMap:P,input:{obstacles:w,minTraceWidth:et,connections:[{name:n.source_trace_id,pointsToConnect:[{...A,layer:G,pcb_port_id:H},{...R,layer:U,pcb_port_id:tt}]}],layerCount:n.getSubcircuit()._getSubcircuitLayerCount(),bounds:{minX:Math.min(A.x,R.x)-B,maxX:Math.max(A.x,R.x)+B,minY:Math.min(A.y,R.y)-B,maxY:Math.max(A.y,R.y)+B}}}),V=null;try{V=mt.solveAndMapToTraces()}catch(ut){n.renderError({type:"pcb_trace_error",pcb_trace_error_id:n.source_trace_id,error_type:"pcb_trace_error",message:`error solving route: ${ut.message}`,source_trace_id:n.pcb_trace_id,center:{x:(A.x+R.x)/2,y:(A.y+R.y)/2},pcb_port_ids:a.map(ht=>ht.pcb_port_id),pcb_trace_id:n.pcb_trace_id,pcb_component_ids:a.map(ht=>ht.pcb_component_id)})}if(!V)return;if(V.length===0){n.renderError({type:"pcb_trace_error",error_type:"pcb_trace_error",pcb_trace_error_id:n.pcb_trace_id,message:`Could not find a route for ${n}`,source_trace_id:n.source_trace_id,center:{x:(A.x+R.x)/2,y:(A.y+R.y)/2},pcb_port_ids:a.map(ut=>ut.pcb_port_id),pcb_trace_id:n.pcb_trace_id,pcb_component_ids:a.map(ut=>ut.pcb_component_id)});return}let[J]=V;j&&(J.route=J.route.map(ut=>(ut.route_type==="wire"&&!ut.layer&&(ut.layer=j),ut))),H&&J.route[0].route_type==="wire"&&(J.route[0].start_pcb_port_id=H);let nt=J.route[J.route.length-1];tt&&nt.route_type==="wire"&&(nt.end_pcb_port_id=tt),I.push(J.route)}let E=SOt(I),N=ent(E),M=e.pcb_trace.insert({route:E,source_trace_id:n.source_trace_id,subcircuit_id:n.getSubcircuit()?.subcircuit_id,trace_length:N});n._portsRoutedOnPcb=a,n.pcb_trace_id=M.pcb_trace_id;for(let A of E)A.route_type==="via"&&e.pcb_via.insert({pcb_trace_id:M.pcb_trace_id,x:A.x,y:A.y,hole_diameter:.3,outer_diameter:.6,layers:[A.from_layer,A.to_layer],from_layer:A.from_layer,to_layer:A.to_layer});n._insertErrorIfTraceIsOutsideBoard(E,a)}function UOt(n){if(n.root?.pcbDisabled)return;let{db:e}=n.root,{_parsedProps:t}=n,i=n.getSubcircuit();if(!t.pcbPath)return;let{allPortsFound:r,ports:s,portsWithSelectors:o}=n._findConnectedPorts();if(!r)return;let a=[];for(let w of s)w._hasMatchedPcbPrimitive()||a.push(w);if(a.length>0){e.pcb_trace_error.insert({error_type:"pcb_trace_error",source_trace_id:n.source_trace_id,message:`Some ports did not have a matching PCB primitive (e.g. a pad or plated hole), this can happen if a footprint is missing. As a result, ${n} wasn't routed. Missing ports: ${a.map(w=>w.getString()).join(", ")}`,pcb_trace_id:n.pcb_trace_id,pcb_component_ids:[],pcb_port_ids:a.map(w=>w.pcb_port_id).filter(Boolean)});return}let c;t.pcbPathRelativeTo&&(c=o.find(w=>w.selector===t.pcbPathRelativeTo)?.port,c||(c=n.getSubcircuit().selectOne(t.pcbPathRelativeTo))),c||(c=s[0]);let l=s.find(w=>w!==c)??s[1],u=c.getAvailablePcbLayers()[0]||"top",p=n._getExplicitTraceThickness()??n.getSubcircuit()._parsedProps.minTraceWidth??.16,f=c._getGlobalPcbPositionAfterLayout(),y=l._getGlobalPcbPositionAfterLayout(),g=[];g.push({route_type:"wire",x:f.x,y:f.y,width:p,layer:u,start_pcb_port_id:c.pcb_port_id});let x=c?._computePcbGlobalTransformBeforeLayout?.()||tr();for(let w of t.pcbPath){let k,T=!1;if(typeof w=="string"){let E=n.getSubcircuit().selectOne(w,{type:"port"});if(!E){e.pcb_trace_error.insert({error_type:"pcb_trace_error",source_trace_id:n.source_trace_id,message:`Could not resolve pcbPath selector "${w}" for ${n}`,pcb_trace_id:n.pcb_trace_id,pcb_component_ids:[],pcb_port_ids:[]});continue}let N=E._getGlobalPcbPositionAfterLayout();k={x:N.x,y:N.y},T=!0}else k={x:w.x,y:w.y},T=!1;let I=T?k:$e(x,k);g.push({route_type:"wire",x:I.x,y:I.y,width:p,layer:u})}g.push({route_type:"wire",x:y.x,y:y.y,width:p,layer:u,end_pcb_port_id:l.pcb_port_id});let v=ent(g),P=e.pcb_trace.insert({route:g,source_trace_id:n.source_trace_id,subcircuit_id:i?.subcircuit_id??void 0,pcb_group_id:n.getGroup()?.pcb_group_id??void 0,trace_length:v});n._portsRoutedOnPcb=s,n.pcb_trace_id=P.pcb_trace_id,n._insertErrorIfTraceIsOutsideBoard(g,s)}function VOt(n){if(n.root?.schematicDisabled)return;let{db:e}=n.root,{_parsedProps:t,parent:i}=n;if(!i)throw new Error("Trace has no parent");let{allPortsFound:r,portsWithSelectors:s}=n._findConnectedPorts();if(!r)return;let o=s.map(({port:T})=>({port:T,position:T._getGlobalSchematicPositionAfterLayout(),schematic_port_id:T.schematic_port_id,facingDirection:T.facingDirection}));if(o.length<2)throw new Error("Expected at least two ports in portsWithPosition.");let a,c,l=o[0].position,u=o[0].port;if("path"in n.props){if(n.props.path.length!==2)throw new Error("Invalid 'path': Must contain exactly two elements.");[a,c]=n.props.path}else{if(!("from"in n.props&&"to"in n.props))throw new Error("Missing 'from' or 'to' properties in props.");a=n.props.from,c=n.props.to}if(!u.source_port_id)throw new Error(`Missing source_port_id for the 'from' port (${a}).`);let p=o[1].position,f=o[1].port;if(!f.source_port_id)throw new Error(`Missing source_port_id for the 'to' port (${c}).`);let y=e.schematic_net_label.list().find(T=>T.source_net_id===u.source_port_id),g=e.schematic_net_label.list().find(T=>T.source_net_id===f.source_port_id),[x,v]=s.map(({port:T})=>T),w=x.parent?.config.shouldRenderAsSchematicBox?`${x?.parent?.props.name}_${x?.props.name}`:`${v?.parent?.props.name}_${v?.props.name}`,k=n.props.schDisplayLabel??w;if(y&&y.text!==k&&(y.text=`${k} / ${y.text}`),g&&g?.text!==k&&(g.text=`${k} / ${g.text}`),!g){let T=X1(f.facingDirection)??"bottom";e.schematic_net_label.insert({text:n.props.schDisplayLabel??w,source_net_id:f.source_port_id,anchor_position:p,center:ml({anchor_position:p,anchor_side:T,text:n.props.schDisplayLabel??w}),anchor_side:T})}if(!y){let T=X1(u.facingDirection)??"bottom";e.schematic_net_label.insert({text:n.props.schDisplayLabel??w,source_net_id:u.source_port_id,anchor_position:l,center:ml({anchor_position:l,anchor_side:T,text:n.props.schDisplayLabel??w}),anchor_side:T})}}function GOt(n){let{_parsedProps:e,parent:t}=n;if(!t)throw new Error("Trace has no parent");let r=n.getTracePortPathSelectors().map(s=>({selector:s,port:n.getSubcircuit().selectOne(s,{type:"port"})??null}));for(let{selector:s,port:o}of r)if(!o){let a,c,l=s.lastIndexOf(".");if(l!==-1&&l>s.lastIndexOf(" "))a=s.slice(0,l),c=s.slice(l+1);else{let T=s.match(/^(.*[ >])?([^ >]+)$/);a=T?.[1]?.trim()??"",c=T?.[2]??s}let u=a?n.getSubcircuit().selectOne(a):null;if(!u&&a&&!/[.#\[]/.test(a)&&(u=n.getSubcircuit().selectOne(`.${a}`)),!u){let T=a?`Could not find port for selector "${s}". Component "${a}" not found`:`Could not find port for selector "${s}"`,I=n.getSubcircuit(),E=I.getGroup();throw new Qw({error_type:"source_trace_not_connected_error",message:T,subcircuit_id:I.subcircuit_id??void 0,source_group_id:E?.source_group_id??void 0,source_trace_id:n.source_trace_id??void 0,selectors_not_found:[s]})}let p=u.children.filter(T=>T.componentName==="Port"),f=c.includes(".")?c.split(".").pop()??"":c,y=p.flatMap(T=>T.getNameAndAliases()),g=y.some(T=>!/^(pin\d+|\d+)$/.test(T)),x=Array.from(new Set(y)).join(", "),v;p.length===0?v="It has no ports":g?v=`It has [${x}]`:v=`It has ${p.length} pins and no pinLabels (consider adding pinLabels)`;let P=`Could not find port for selector "${s}". Component "${u.props.name??a}" found, but does not have pin "${f}". ${v}`,w=n.getSubcircuit(),k=w.getGroup();throw new Qw({error_type:"source_trace_not_connected_error",message:P,subcircuit_id:w.subcircuit_id??void 0,source_group_id:k?.source_group_id??void 0,source_trace_id:n.source_trace_id??void 0,selectors_not_found:[s]})}return r.some(s=>!s.port)?{allPortsFound:!1}:{allPortsFound:!0,portsWithSelectors:r,ports:r.map(({port:s})=>s)}}var Fs=class extends Ee{constructor(e){super(e);d(this,"source_trace_id",null);d(this,"pcb_trace_id",null);d(this,"schematic_trace_id",null);d(this,"_portsRoutedOnPcb");d(this,"subcircuit_connectivity_map_key",null);d(this,"_traceConnectionHash",null);d(this,"_couldNotFindPort");this._portsRoutedOnPcb=[]}_getExplicitTraceThickness(){return this._parsedProps.thickness??this._parsedProps.width}get config(){return{zodProps:XH,componentName:"Trace"}}_getTracePortOrNetSelectorListFromProps(){return"from"in this.props&&"to"in this.props?[typeof this.props.from=="string"?this.props.from:this.props.from.getPortSelector(),typeof this.props.to=="string"?this.props.to:this.props.to.getPortSelector()]:"path"in this.props?this.props.path.map(e=>typeof e=="string"?e:e.getPortSelector()):[]}getTracePortPathSelectors(){return this._getTracePortOrNetSelectorListFromProps().filter(e=>!e.includes("net."))}getTracePathNetSelectors(){return this._getTracePortOrNetSelectorListFromProps().filter(e=>e.includes("net."))}_findConnectedPorts(){return GOt(this)}_resolveNet(e){let t=this.getSubcircuit().selectOne(e,{type:"net"});if(t)return t;let i=e.match(/^net\.(.+)$/),r=i?i[1]:null;if(!r)return null;let s=this.root?._getBoard();return s?s.getDescendants().find(a=>a.componentName==="Net"&&a._parsedProps.name===r)||null:(this.renderError(`Could not find a <board> ancestor for ${this}, so net "${e}" cannot be resolved`),null)}_findConnectedNets(){let e=this.getTracePathNetSelectors().map(i=>({selector:i,net:this._resolveNet(i)})),t=e.filter(i=>!i.net);return t.length>0&&this.renderError(`Could not find net for selector "${t[0].selector}" inside ${this}`),{netsWithSelectors:e,nets:e.map(i=>i.net)}}_getAllTracesConnectedToSameNet(){let e=this.getSubcircuit().selectAll("trace"),t=this._findConnectedNets().nets,i=this._findConnectedPorts().ports??[];return e.filter(r=>{if(r===this)return!1;let s=r._findConnectedNets().nets,o=r._findConnectedPorts().ports??[];return s.some(a=>t.includes(a))||o.some(a=>i.includes(a))})}_isExplicitlyConnectedToPort(e){let{allPortsFound:t,portsWithSelectors:i}=this._findConnectedPorts();return t?i.map(s=>s.port).includes(e):!1}_isExplicitlyConnectedToNet(e){return this._findConnectedNets().nets.includes(e)}doInitialCreateNetsFromProps(){nP(this,this.getTracePathNetSelectors())}_computeTraceConnectionHash(){let{allPortsFound:e,ports:t}=this._findConnectedPorts();return!e||!t?null:[...t].sort((s,o)=>(s.pcb_port_id||"").localeCompare(o.pcb_port_id||"")).map(s=>s.pcb_port_id).join(",")}doInitialSourceTraceRender(){let{db:e}=this.root,{_parsedProps:t,parent:i}=this;if(!i){this.renderError("Trace has no parent");return}let r,s;try{let p=this._findConnectedPorts();r=p.allPortsFound,s=p.portsWithSelectors??[]}catch(p){if(p instanceof Qw){e.source_trace_not_connected_error.insert({...p.errorData,error_type:"source_trace_not_connected_error"}),this._couldNotFindPort=!0;return}throw p}if(!r)return;this._traceConnectionHash=this._computeTraceConnectionHash();let a=e.source_trace.list().find(p=>p.subcircuit_connectivity_map_key===this.subcircuit_connectivity_map_key&&p.connected_source_port_ids.sort().join(",")===this._traceConnectionHash);if(a){this.source_trace_id=a.source_trace_id;return}let c=this._findConnectedNets().nets,l=MOt({ports:s,nets:c}),u=e.source_trace.insert({connected_source_port_ids:s.map(p=>p.port.source_port_id),connected_source_net_ids:c.map(p=>p.source_net_id),subcircuit_id:this.getSubcircuit()?.subcircuit_id,max_length:EOt(s.map(p=>p.port),{db:e})??t.maxLength,display_name:l,min_trace_thickness:this._getExplicitTraceThickness()});this.source_trace_id=u.source_trace_id}_insertErrorIfTraceIsOutsideBoard(e,t){let{db:i}=this.root;COt(e,{db:i})&&i.pcb_trace_error.insert({error_type:"pcb_trace_error",source_trace_id:this.source_trace_id,message:`Trace ${this.getString()} routed outside the board boundaries.`,pcb_trace_id:this.pcb_trace_id,pcb_component_ids:[],pcb_port_ids:t.map(s=>s.pcb_port_id)})}doInitialPcbManualTraceRender(){UOt(this)}doInitialPcbTraceRender(){XOt(this)}_doInitialSchematicTraceRenderWithDisplayLabel(){VOt(this)}_isSymbolToChipConnection(){let{allPortsFound:e,ports:t}=this._findConnectedPorts();if(!e||t.length!==2)return!1;let[i,r]=t;if(!i?.parent||!r?.parent)return!1;let s=i.parent.config.shouldRenderAsSchematicBox,o=r.parent.config.shouldRenderAsSchematicBox;return s&&!o||!s&&o}_isSymbolToSymbolConnection(){let{allPortsFound:e,ports:t}=this._findConnectedPorts();if(!e||t.length!==2)return!1;let[i,r]=t;if(!i?.parent||!r?.parent)return!1;let s=!i.parent.config.shouldRenderAsSchematicBox,o=!r.parent.config.shouldRenderAsSchematicBox;return s&&o}_isChipToChipConnection(){let{allPortsFound:e,ports:t}=this._findConnectedPorts();if(!e||t.length!==2)return!1;let[i,r]=t;if(!i?.parent||!r?.parent)return!1;let s=i.parent.config.shouldRenderAsSchematicBox,o=r.parent.config.shouldRenderAsSchematicBox;return s&&o}doInitialSchematicTraceRender(){BOt(this)}},HOt=n=>{let{db:e}=n.root;if(n.pcb_component_id){let t=e.pcb_component.get(n.pcb_component_id);return t?{width:t.width,height:t.height}:null}if(n.pcb_group_id){let t=e.pcb_group.get(n.pcb_group_id);if(!t)return null;if(t.outline&&t.outline.length>0){let i=Oo(t.outline);return i?{width:i.maxX-i.minX,height:i.maxY-i.minY}:null}return{width:t.width??0,height:t.height??0}}return null},WOt=(n,e)=>{let{db:t}=n.root,i=t.toArray();if(n.pcb_component_id){kS(i,n.pcb_component_id,e);return}if(n.source_group_id){TS(i,n.source_group_id,e);return}throw new Error(`Cannot reposition component ${n.getString()}: no pcb_component_id or source_group_id`)},qOt=n=>{let{db:e}=n.root;if(!n.source_component_id)return;let t=n.selectAll("port"),i=e.source_trace.list(),r=new Set;for(let o of i)for(let a of o.connected_source_port_ids)r.add(a);let s=n._getInternallyConnectedPins();for(let o of s)if(o.some(a=>a.source_port_id&&r.has(a.source_port_id)))for(let a of o)a.source_port_id&&r.add(a.source_port_id);for(let o of t)o.source_port_id&&ZOt(n,o)&&(r.has(o.source_port_id)||e.source_pin_missing_trace_warning.insert({message:`Port ${o.getNameAndAliases()[0]} on ${n.props.name} is missing a trace`,source_component_id:n.source_component_id,source_port_id:o.source_port_id,subcircuit_id:n.getSubcircuit().subcircuit_id??void 0,warning_type:"source_pin_missing_trace_warning"}))},ZOt=(n,e)=>{if(n.config.componentName==="Chip"){let t=n.props.pinAttributes;if(!t)return!1;for(let i of e.getNameAndAliases()){let r=t[i];if(r?.requiresPower||r?.requiresGround||r?.requiresVoltage!==void 0)return!0}return!1}return!0};function KOt(n){let e=n.font_size,t=n.text.length*e*.6,i=e,r=n.anchor_alignment||"center",s=n.anchor_position.x,o=n.anchor_position.y;switch(r){case"top_left":s=n.anchor_position.x+t/2,o=n.anchor_position.y+i/2;break;case"top_center":s=n.anchor_position.x,o=n.anchor_position.y+i/2;break;case"top_right":s=n.anchor_position.x-t/2,o=n.anchor_position.y+i/2;break;case"center_left":s=n.anchor_position.x+t/2,o=n.anchor_position.y;break;case"center":s=n.anchor_position.x,o=n.anchor_position.y;break;case"center_right":s=n.anchor_position.x-t/2,o=n.anchor_position.y;break;case"bottom_left":s=n.anchor_position.x+t/2,o=n.anchor_position.y-i/2;break;case"bottom_center":s=n.anchor_position.x,o=n.anchor_position.y-i/2;break;case"bottom_right":s=n.anchor_position.x-t/2,o=n.anchor_position.y-i/2;break;default:s=n.anchor_position.x,o=n.anchor_position.y;break}return{x:s-t/2,y:o-i/2,width:t,height:i}}function JOt(n){if(!n._adjustSilkscreenTextAutomatically||n.root?.pcbDisabled||!n.pcb_component_id)return;let{db:e}=n.root,i=n._getPcbCircuitJsonBounds().center,r=e.pcb_silkscreen_text.list({pcb_component_id:n.pcb_component_id}).filter(c=>c.text===n.name);if(r.length===0)return;let a=n.getSubcircuit().selectAll("[_isNormalComponent=true]").filter(c=>c!==n&&c.pcb_component_id).map(c=>{let l=c._getPcbCircuitJsonBounds(),u={center:l.center,width:l.width,height:l.height};return no(u)});for(let c of r){let l=c.anchor_position,u=KOt(c),p={center:{x:u.x+u.width/2,y:u.y+u.height/2},width:u.width,height:u.height},f=no(p);if(!a.some(k=>Hc(f,k)))continue;let g=2*i.x-l.x,x=2*i.y-l.y,v={center:{x:g,y:x},width:u.width,height:u.height},P=no(v);a.some(k=>Hc(P,k))||e.pcb_silkscreen_text.update(c.pcb_silkscreen_text_id,{anchor_position:{x:g,y:x}})}}function QOt(n){if(!n)return{validPinLabels:n,invalidPinLabelsMessages:[]};let e={},t=[];for(let[i,r]of Object.entries(n)){let s=Array.isArray(r)?r.slice():[r],o=[];for(let a of s)tLt(i,a)?o.push(a):t.push(`Invalid pin label: ${i} = '${a}' - excluding from component. Please use a valid pin label.`);o.length>0&&(e[i]=Array.isArray(r)?o:o[0])}return{validPinLabels:Object.keys(e).length>0?e:void 0,invalidPinLabelsMessages:t}}function tLt(n,e){try{let t={name:"test",footprint:"test",pinLabels:{[n]:e}};return n_.safeParse(t).success}catch{return!1}}var W_=n=>n.startsWith("http://")||n.startsWith("https://"),s9=n=>{if(W_(n))return null;let e=n.indexOf(":");if(e<=0)return null;let t=n.slice(0,e),i=n.slice(e+1);return!t||!i?null:{footprintLib:t,footprintName:i}},o9=n=>n.startsWith("/"),eLt=(0,nnt.default)("tscircuit:core:resolveStaticFileImport");async function int(n,e){if(!n)return n;let t=e?.resolveProjectStaticFileImportUrl;if(t&&n.startsWith("/"))try{let i=await t(n);if(i)return i}catch(i){eLt("failed to resolve static file via platform resolver",i)}return Ket(n,e?.projectBaseUrl)}function nLt(n,e){let{footprint:t}=n.props;if(t??(t=n._getImpliedFootprintString?.()),!t)return;let{pcbRotation:i,pinLabels:r,pcbPinLabels:s}=n.props,o=Zet(String(t)),a=o?n.root?.platform?.footprintFileParserMap?.[o]:null;if(typeof t=="string"&&(W_(t)||o9(t))&&a){if(n._hasStartedFootprintUrlLoad)return;n._hasStartedFootprintUrlLoad=!0,e("load-footprint-from-platform-file-parser",async()=>{let c=W_(t)?t:await int(t,n.root?.platform);try{let l=await a.loadFromUrl(c),u=H_({componentName:n.name,componentRotation:i,footprinterString:c,pinLabels:r,pcbPinLabels:s},l.footprintCircuitJson);n.addAll(u),n._markDirty("InitializePortsFromChildren")}catch(l){let u=n.root?.db;if(u&&n.source_component_id&&n.pcb_component_id){let p=n.getSubcircuit(),f=`${n.getString()} failed to load footprint "${c}": `+(l instanceof Error?l.message:String(l)),y=Rm.parse({type:"external_footprint_load_error",message:f,pcb_component_id:n.pcb_component_id,source_component_id:n.source_component_id,subcircuit_id:p.subcircuit_id??void 0,pcb_group_id:n.getGroup()?.pcb_group_id??void 0,footprinter_string:c});u.external_footprint_load_error.insert(y)}throw l}});return}if(typeof t=="string"&&W_(t)){if(n._hasStartedFootprintUrlLoad)return;n._hasStartedFootprintUrlLoad=!0;let c=t;e("load-footprint-url",async()=>{try{let l=await fetch(c);if(!l.ok)throw new Error(`Failed to fetch footprint: ${l.status}`);let u=await l.json(),p=H_({componentName:n.name,componentRotation:i,footprinterString:c,pinLabels:r,pcbPinLabels:s},u);n.addAll(p),n._markDirty("InitializePortsFromChildren")}catch(l){let u=n.root?.db;if(u&&n.source_component_id&&n.pcb_component_id){let p=n.getSubcircuit(),f=`${n.getString()} failed to load external footprint "${c}": `+(l instanceof Error?l.message:String(l)),y=Rm.parse({type:"external_footprint_load_error",message:f,pcb_component_id:n.pcb_component_id,source_component_id:n.source_component_id,subcircuit_id:p.subcircuit_id??void 0,pcb_group_id:n.getGroup()?.pcb_group_id??void 0,footprinter_string:c});u.external_footprint_load_error.insert(y)}throw l}});return}if(typeof t=="string"){let c=s9(t);if(!c||n._hasStartedFootprintUrlLoad)return;n._hasStartedFootprintUrlLoad=!0;let u=n.root?.platform?.footprintLibraryMap?.[c.footprintLib],p;if(typeof u=="function"&&(p=u),!p)return;let f=n.getInheritedMergedProperty("pcbStyle");e("load-lib-footprint",async()=>{try{let y=await p(c.footprintName,{resolvedPcbStyle:f}),g=null;if(Array.isArray(y)?g=y:Array.isArray(y.footprintCircuitJson)&&(g=y.footprintCircuitJson),!g)return;let x=H_({componentName:n.name,componentRotation:i,footprinterString:t,pinLabels:r,pcbPinLabels:s},g);n.addAll(x),!Array.isArray(y)&&y.cadModel&&(n._asyncFootprintCadModel=y.cadModel);for(let v of n.children)v.componentName==="Port"&&v._markDirty?.("PcbPortRender");n._markDirty("InitializePortsFromChildren")}catch(y){let g=n.root?.db;if(g&&n.source_component_id&&n.pcb_component_id){let x=n.getSubcircuit(),v=`${n.getString()} failed to load external footprint "${t}": `+(y instanceof Error?y.message:String(y)),P=Rm.parse({type:"external_footprint_load_error",message:v,pcb_component_id:n.pcb_component_id,source_component_id:n.source_component_id,subcircuit_id:x.subcircuit_id??void 0,pcb_group_id:n.getGroup()?.pcb_group_id??void 0,footprinter_string:t});g.external_footprint_load_error.insert(P)}throw y}});return}if(!(0,r9.isValidElement)(t)&&t.componentName==="Footprint"&&n.add(t),Array.isArray(t)&&!(0,r9.isValidElement)(t)&&t.length>0){try{let c=H_({componentName:n.name,componentRotation:i,footprinterString:"",pinLabels:r,pcbPinLabels:s},t);n.addAll(c)}catch(c){let l=n.root?.db;if(l&&n.source_component_id&&n.pcb_component_id){let u=n.getSubcircuit(),p=`${n.getString()} failed to load json footprint: `+(c instanceof Error?c.message:String(c)),f=Wx.parse({type:"circuit_json_footprint_load_error",message:p,pcb_component_id:n.pcb_component_id,source_component_id:n.source_component_id,subcircuit_id:u.subcircuit_id??void 0,pcb_group_id:n.getGroup()?.pcb_group_id??void 0});l.circuit_json_footprint_load_error.insert(f)}throw c}return}}function iLt(n){if(n.root?.pcbDisabled||!n.pcb_component_id)return;let{pcbX:e,pcbY:t}=n._parsedProps,i=n.props?.pcbPositionAnchor;if(!i||e===void 0&&t===void 0)return;let r=rP(n.children);if(r.width===0||r.height===0)return;let o={...{x:(r.minX+r.maxX)/2,y:(r.minY+r.maxY)/2}},a=null;if(new Set(["center","top_left","top_center","top_right","center_left","center_right","bottom_left","bottom_center","bottom_right"]).has(i)){let u={left:r.minX,right:r.maxX,top:r.minY,bottom:r.maxY};switch(i){case"center":a=o;break;case"top_left":a={x:u.left,y:u.top};break;case"top_center":a={x:o.x,y:u.top};break;case"top_right":a={x:u.right,y:u.top};break;case"center_left":a={x:u.left,y:o.y};break;case"center_right":a={x:u.right,y:o.y};break;case"bottom_left":a={x:u.left,y:u.bottom};break;case"bottom_center":a={x:o.x,y:u.bottom};break;case"bottom_right":a={x:u.right,y:u.bottom};break}}else try{let u=n.portMap[i];u&&(a=u._getGlobalPcbPositionBeforeLayout())}catch{}if(!a)return;let l={...o};e!==void 0&&(l.x+=e-a.x),t!==void 0&&(l.y+=t-a.y),(Math.abs(l.x-o.x)>1e-6||Math.abs(l.y-o.y)>1e-6)&&n._repositionOnPcb(l)}var rLt=(0,$et.default)("tscircuit:core"),sLt=h.object({x:He,y:He,z:He}),Hn=class extends Ee{constructor(e){let t={...e},i=[];if(t.pinLabels&&!Array.isArray(t.pinLabels)){let{validPinLabels:r,invalidPinLabelsMessages:s}=QOt(t.pinLabels);t.pinLabels=r,i=s}super(t);d(this,"reactSubtrees",[]);d(this,"_impliedFootprint");d(this,"isPrimitiveContainer",!0);d(this,"_isNormalComponent",!0);d(this,"_attributeLowerToCamelNameMap",{_isnormalcomponent:"_isNormalComponent"});d(this,"_asyncSupplierPartNumbers");d(this,"_asyncFootprintCadModel");d(this,"_isCadModelChild");d(this,"pcb_missing_footprint_error_id");d(this,"_hasStartedFootprintUrlLoad",!1);d(this,"_invalidPinLabelMessages",[]);d(this,"_adjustSilkscreenTextAutomatically",!1);this._invalidPinLabelMessages=i,this._addChildrenFromStringFootprint(),this.initPorts()}get defaultInternallyConnectedPinNames(){return[]}get internallyConnectedPinNames(){return(this._parsedProps.internallyConnectedPins??this.defaultInternallyConnectedPinNames).map(t=>t.map(i=>typeof i=="number"?`pin${i}`:i))}doInitialSourceNameDuplicateComponentRemoval(){if(!this.name)return;let e=this.root;if(this.getSubcircuit().selectAll(`.${this.name}`).filter(r=>r!==this&&r._isNormalComponent&&r.renderPhaseStates?.SourceNameDuplicateComponentRemoval?.initialized).length>0){let r=this._getGlobalPcbPositionBeforeLayout(),s=this._getGlobalSchematicPositionBeforeLayout();e.db.source_failed_to_create_component_error.insert({component_name:this.name,error_type:"source_failed_to_create_component_error",message:`Cannot create component "${this.name}": A component with the same name already exists`,pcb_center:r,schematic_center:s}),this.shouldBeRemoved=!0;let o=[...this.children];for(let a of o)this.remove(a)}}initPorts(e={}){if(this.root?.schematicDisabled)return;let{config:t}=this,i=[],r=this._getSchematicPortArrangement();if(r&&!this._parsedProps.pinLabels){for(let l in r){let u=r[l].pins;if(Array.isArray(u))for(let p of u){let f=Y1(p,this._parsedProps.pinLabels);i.push(new Gi({pinNumber:f,aliases:e.additionalAliases?.[`pin${f}`]??[]},{originDescription:`schPortArrangement:${l}`}))}}let a=["left","right","top","bottom"],c=1;for(let l of a){let u=r[`${l}Size`];for(let p=0;p<u;p++)i.push(new Gi({pinNumber:c++,aliases:e.additionalAliases?.[`pin${c}`]??[]},{originDescription:`schPortArrangement:${l}`}))}}let s=this._parsedProps.pinLabels;if(s)for(let[a,c]of Object.entries(s)){a=a.replace("pin","");let l=i.find(f=>f._parsedProps.pinNumber===Number(a)),u=Array.isArray(c)?c[0]:c,p=Array.isArray(c)?c.slice(1):[];l?(l.externallyAddedAliases.push(u,...p),l.props.name=u):(l=new Gi({pinNumber:parseInt(a),name:u,aliases:[...p,...e.additionalAliases?.[`pin${parseInt(a)}`]??[]]},{originDescription:`pinLabels:pin${a}`}),i.push(l))}if(t.schematicSymbolName&&!e.ignoreSymbolPorts){let a=yi[this._getSchematicSymbolNameOrThrow()];if(!a)return;for(let c of a.ports){let l=Get(c.labels);if(!l)continue;let u=i.find(p=>p._parsedProps.pinNumber===Number(l));if(u)u.schematicSymbolPortDef=c;else{let p=F1(c.labels.concat(e.additionalAliases?.[`pin${l}`]??[]));p&&(p.originDescription=`schematicSymbol:labels[0]:${c.labels[0]}`,p.schematicSymbolPortDef=c,i.push(p))}}this.addAll(i)}if(!this._getSchematicPortArrangement()){let a=this.getPortsFromFootprint(e);for(let c of a)i.some(l=>l.isMatchingAnyOf(c.getNameAndAliases()))||i.push(c)}let o=e.pinCount??this._getPinCount()??0;for(let a=1;a<=o;a++){if(i.find(l=>l._parsedProps.pinNumber===a))continue;if(!r){i.push(new Gi({pinNumber:a,aliases:e.additionalAliases?.[`pin${a}`]??[]}));continue}let c=[...r.leftSide?.pins??[],...r.rightSide?.pins??[],...r.topSide?.pins??[],...r.bottomSide?.pins??[]].map(l=>Y1(l,this._parsedProps.pinLabels));["leftSize","rightSize","topSize","bottomSize","leftPinCount","rightPinCount","topPinCount","bottomPinCount"].some(l=>l in r)&&(c=Array.from({length:this._getPinCount()},(l,u)=>u+1)),c.includes(a)&&i.push(new Gi({pinNumber:a,aliases:e.additionalAliases?.[`pin${a}`]??[]},{originDescription:`notOtherwiseAddedButDeducedFromPinCount:${a}`}))}i.length>0&&this.addAll(i)}_getImpliedFootprintString(){return null}_addChildrenFromStringFootprint(){let{pcbRotation:e,pinLabels:t,pcbPinLabels:i}=this.props,{footprint:r}=this.props;if(r??(r=this._getImpliedFootprintString?.()),!!r&&typeof r=="string"){if(W_(r)||o9(r)||s9(r))return;let s=bE.string(r).soup(),o=H_({componentName:this.name??this.componentName,componentRotation:e,footprinterString:r,pinLabels:t,pcbPinLabels:i},s);this.addAll(o)}}get portMap(){return new Proxy({},{get:(e,t)=>{let i=this.children.find(r=>r.componentName==="Port"&&r.isMatchingNameOrAlias(t));if(!i)throw new Error(`There was an issue finding the port "${t.toString()}" inside of a ${this.componentName} component with name: "${this.props.name}". This is a bug in @tscircuit/core`);return i}})}getInstanceForReactElement(e){for(let t of this.reactSubtrees)if(t.element===e)return t.component;return null}doInitialSourceRender(){let e=this.config.sourceFtype;if(!e)return;let{db:t}=this.root,{_parsedProps:i}=this,r=t.source_component.insert({ftype:e,name:this.name,manufacturer_part_number:i.manufacturerPartNumber??i.mfn,supplier_part_numbers:i.supplierPartNumbers});this.source_component_id=r.source_component_id}doInitialSchematicComponentRender(){if(this.root?.schematicDisabled)return;let{db:e}=this.root;if(this._invalidPinLabelMessages?.length&&this.root?.db)for(let s of this._invalidPinLabelMessages){let o="pinLabels",a=s.match(/^Invalid pin label:\s*([^=]+)=\s*'([^']+)'/);a&&(o=`pinLabels['${a[2]}']`),this.root.db.source_property_ignored_warning.insert({source_component_id:this.source_component_id,property_name:o,message:s,error_type:"source_property_ignored_warning"})}let{schematicSymbolName:t}=this.config,{_parsedProps:i}=this;i.symbol&&(0,Ua.isValidElement)(i.symbol)?this._doInitialSchematicComponentRenderWithReactSymbol(i.symbol):t?this._doInitialSchematicComponentRenderWithSymbol():this._getSchematicBoxDimensions()&&this._doInitialSchematicComponentRenderWithSchematicBoxDimensions();let r=this.getSubcircuit()?._getSchematicManualPlacementForComponent(this);if(this.schematic_component_id&&(this.props.schX!==void 0||this.props.schY!==void 0)&&r){if(!this.schematic_component_id)return;let s=Vx.parse({type:"schematic_manual_edit_conflict_warning",schematic_manual_edit_conflict_warning_id:`schematic_manual_edit_conflict_${this.source_component_id}`,message:`${this.getString()} has both manual placement and prop coordinates. schX and schY will be used. Remove schX/schY or clear the manual placement.`,schematic_component_id:this.schematic_component_id,source_component_id:this.source_component_id,subcircuit_id:this.getSubcircuit()?.subcircuit_id});e.schematic_manual_edit_conflict_warning.insert(s)}}_getSchematicSymbolDisplayValue(){}_getInternallyConnectedPins(){if(this.internallyConnectedPinNames.length===0)return[];let e=[];for(let t of this.internallyConnectedPinNames){let i=[];for(let r of t)i.push(this.portMap[r]);e.push(i)}return e}_doInitialSchematicComponentRenderWithSymbol(){if(this.root?.schematicDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,i=this._getSchematicSymbolNameOrThrow(),r=yi[i],s=this._getGlobalSchematicPositionBeforeLayout();if(r){let o=e.schematic_component.insert({center:s,size:r.size,source_component_id:this.source_component_id,is_box_with_pins:!0,symbol_name:i,symbol_display_value:this._getSchematicSymbolDisplayValue()});this.schematic_component_id=o.schematic_component_id}}_doInitialSchematicComponentRenderWithReactSymbol(e){if(this.root?.schematicDisabled)return;let{db:t}=this.root,i=this._getGlobalSchematicPositionBeforeLayout(),r=t.schematic_component.insert({center:i,size:{width:0,height:0},source_component_id:this.source_component_id,symbol_display_value:this._getSchematicSymbolDisplayValue(),is_box_with_pins:!1});this.schematic_component_id=r.schematic_component_id}_doInitialSchematicComponentRenderWithSchematicBoxDimensions(){if(this.root?.schematicDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,i=this._getSchematicBoxDimensions(),r={};if(Array.isArray(t.pinLabels))t.pinLabels.forEach((y,g)=>{r[String(g+1)]=y});else for(let[y,g]of Object.entries(t.pinLabels??{}))r[y]=Array.isArray(g)?g[0]:g;let s=this._getGlobalSchematicPositionBeforeLayout(),o=this._getSchematicPortArrangement(),a=e.schematic_component.insert({center:s,rotation:t.schRotation??0,size:i.getSize(),port_arrangement:oOt(o),pin_spacing:t.schPinSpacing??.2,pin_styles:sOt(t.schPinStyle,t.pinLabels),port_labels:r,source_component_id:this.source_component_id}),c=o?.topSide!==void 0||o?.bottomSide!==void 0,l=i?.getSize().width,u=i?.getSize().height,p=e.schematic_text.insert({text:t.manufacturerPartNumber??"",schematic_component_id:a.schematic_component_id,anchor:"left",rotation:0,position:{x:c?s.x+(l??0)/2+.1:s.x-(l??0)/2,y:c?s.y+(u??0)/2+.35:s.y-(u??0)/2-.13},color:"#006464",font_size:.18}),f=e.schematic_text.insert({text:t.name??"",schematic_component_id:a.schematic_component_id,anchor:"left",rotation:0,position:{x:c?s.x+(l??0)/2+.1:s.x-(l??0)/2,y:c?s.y+(u??0)/2+.55:s.y+(u??0)/2+.13},color:"#006464",font_size:.18});this.schematic_component_id=a.schematic_component_id}doInitialPcbComponentRender(){if(this.root?.pcbDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,i=this.getSubcircuit(),r=t.layer??"top";if(r!=="top"&&r!=="bottom"){let p=Om.parse({type:"pcb_component_invalid_layer_error",message:`Component cannot be placed on layer '${r}'. Components can only be placed on 'top' or 'bottom' layers.`,source_component_id:this.source_component_id,layer:r,subcircuit_id:i.subcircuit_id??void 0});e.pcb_component_invalid_layer_error.insert(p)}let s=this._computePcbGlobalTransformBeforeLayout(),a=to(s).rotation.angle*180/Math.PI,c=e.pcb_component.insert({center:this._getGlobalPcbPositionBeforeLayout(),width:0,height:0,layer:r==="top"||r==="bottom"?r:"top",rotation:t.pcbRotation??a,source_component_id:this.source_component_id,subcircuit_id:i.subcircuit_id??void 0,do_not_place:t.doNotPlace??!1,obstructs_within_bounds:t.obstructsWithinBounds??!0});if(!(t.footprint??this._getImpliedFootprintString())&&!this.isGroup){let p=e.pcb_missing_footprint_error.insert({message:`No footprint found for component: ${this.getString()}`,source_component_id:`${this.source_component_id}`,error_type:"pcb_missing_footprint_error"});this.pcb_missing_footprint_error_id=p.pcb_missing_footprint_error_id}this.pcb_component_id=c.pcb_component_id;let u=this.getSubcircuit()._getPcbManualPlacementForComponent(this);if((this.props.pcbX!==void 0||this.props.pcbY!==void 0)&&u){let p=qx.parse({type:"pcb_manual_edit_conflict_warning",pcb_manual_edit_conflict_warning_id:`pcb_manual_edit_conflict_${this.source_component_id}`,message:`${this.getString()} has both manual placement and prop coordinates. pcbX and pcbY will be used. Remove pcbX/pcbY or clear the manual placement.`,pcb_component_id:this.pcb_component_id,source_component_id:this.source_component_id,subcircuit_id:i.subcircuit_id??void 0});e.pcb_manual_edit_conflict_warning.insert(p)}}doInitialPcbComponentSizeCalculation(){if(this.root?.pcbDisabled||!this.pcb_component_id)return;let{db:e}=this.root,{_parsedProps:t}=this,i=rP(this.children);if(i.width===0||i.height===0)return;let r={x:(i.minX+i.maxX)/2,y:(i.minY+i.maxY)/2};e.pcb_component.update(this.pcb_component_id,{center:r,width:i.width,height:i.height})}updatePcbComponentSizeCalculation(){this.doInitialPcbComponentSizeCalculation()}doInitialSchematicComponentSizeCalculation(){if(this.root?.schematicDisabled||!this.schematic_component_id)return;let{db:e}=this.root;if(!e.schematic_component.get(this.schematic_component_id))return;let i=[],r=u=>{for(let p of u){if(p.isSchematicPrimitive&&p.componentName==="SchematicLine"){let f=e.schematic_line.get(p.schematic_line_id);f&&i.push(f)}if(p.isSchematicPrimitive&&p.componentName==="SchematicRect"){let f=e.schematic_rect.get(p.schematic_rect_id);f&&i.push(f)}if(p.isSchematicPrimitive&&p.componentName==="SchematicCircle"){let f=e.schematic_circle.get(p.schematic_circle_id);f&&i.push(f)}if(p.isSchematicPrimitive&&p.componentName==="SchematicArc"){let f=e.schematic_arc.get(p.schematic_arc_id);f&&i.push(f)}if(p.isSchematicPrimitive&&p.componentName==="SchematicText"){let f=e.schematic_text.get(p.schematic_text_id);f&&i.push(f)}p.children&&p.children.length>0&&r(p.children)}};if(r(this.children),i.length===0)return;let s=Vet(i),o=Math.abs(s.maxX-s.minX),a=Math.abs(s.maxY-s.minY);if(o===0&&a===0)return;let c=(s.minX+s.maxX)/2,l=(s.minY+s.maxY)/2;e.schematic_component.update(this.schematic_component_id,{center:{x:c,y:l},size:{width:o,height:a}})}updateSchematicComponentSizeCalculation(){this.doInitialSchematicComponentSizeCalculation()}doInitialPcbComponentAnchorAlignment(){iLt(this)}updatePcbComponentAnchorAlignment(){this.doInitialPcbComponentAnchorAlignment()}_renderReactSubtree(e){let t=Xet(e);return{element:e,component:t}}doInitialInitializePortsFromChildren(){this.initPorts()}doInitialReactSubtreesRender(){let e=this.props.footprint;(0,Ua.isValidElement)(e)&&(this.children.some(s=>s.componentName==="Footprint")||this.add(e));let t=this.props.symbol;(0,Ua.isValidElement)(t)&&(this.children.some(s=>s.componentName==="Symbol")||this.add(t));let i=this.props.cadModel;if((0,Ua.isValidElement)(i)){this._isCadModelChild=!0;let r=this.children.some(o=>o.componentName==="CadAssembly"),s=this.children.some(o=>o.componentName==="CadModel");!r&&!s&&this.add(i)}}doInitialPcbFootprintStringRender(){nLt(this,(e,t)=>this._queueAsyncEffect(e,t))}_hasExistingPortExactly(e){return this.children.filter(i=>i.componentName==="Port").some(i=>{let r=e.getNameAndAliases(),s=i.getNameAndAliases();return r.length===s.length&&r.every(o=>s.includes(o))})}add(e){let t;if((0,Ua.isValidElement)(e)){let i=this._renderReactSubtree(e);this.reactSubtrees.push(i),t=i.component}else t=e;if(t.componentName==="Port"){if(this._hasExistingPortExactly(t))return;let r=this.children.filter(s=>s.componentName==="Port").find(s=>s.isMatchingAnyOf(t.getNameAndAliases()));r&&rLt(`Similar ports added. Port 1: ${r}, Port 2: ${t}`)}super.add(t)}getPortsFromFootprint(e){let{footprint:t}=this.props;if((!t||(0,Ua.isValidElement)(t))&&(t=this.children.find(r=>r.componentName==="Footprint")),typeof t=="string"){if(W_(t))return[];if(o9(t))return[];if(s9(t))return[];let r=bE.string(t).soup(),s=[];for(let o of r)if("port_hints"in o&&o.port_hints){let a=F1(o.port_hints,e);if(!a)continue;a.originDescription=`footprint:string:${t}:port_hints[0]:${o.port_hints[0]}`,s.push(a)}return s}if(!(0,Ua.isValidElement)(t)&&t&&t.componentName==="Footprint"){let r=t,s=1,o=[];for(let a of r.children){if(!a.props.portHints)continue;let c=a.props.portHints;c.some(p=>p.startsWith("pin"))||(c=[...c,`pin${s}`]),s++;let u=F1(c);u&&(u.originDescription=`footprint:${t}`,o.push(u))}return o}let i=[];if(!t){for(let r of this.children)if(r.props.portHints&&r.isPcbPrimitive){let s=F1(r.props.portHints);s&&i.push(s)}}return i}getPortsFromSchematicSymbol(){if(this.root?.schematicDisabled)return[];let{config:e}=this;if(!e.schematicSymbolName)return[];let t=yi[e.schematicSymbolName];if(!t)return[];let i=[];for(let r of t.ports){let s=F1(r.labels);s&&(s.schematicSymbolPortDef=r,i.push(s))}return i}doInitialCreateNetsFromProps(){this._createNetsFromProps(this._getNetsFromConnectionsProp())}_getNetsFromConnectionsProp(){let{_parsedProps:e}=this,t=[];if(e.connections)for(let[i,r]of Object.entries(e.connections)){let s=Array.isArray(r)?r:[r];for(let o of s)t.push(String(o))}return t}_createNetsFromProps(e){nP(this,e)}_getPcbCircuitJsonBounds(){let{db:e}=this.root;if(!this.pcb_component_id)return super._getPcbCircuitJsonBounds();let t=e.pcb_component.get(this.pcb_component_id);return{center:{x:t.center.x,y:t.center.y},bounds:{left:t.center.x-t.width/2,top:t.center.y-t.height/2,right:t.center.x+t.width/2,bottom:t.center.y+t.height/2},width:t.width,height:t.height}}_getPinCountFromSchematicPortArrangement(){let e=this._getSchematicPortArrangement();if(!e)return 0;if(!Het(e))return(e.leftSize??e.leftPinCount??0)+(e.rightSize??e.rightPinCount??0)+(e.topSize??e.topPinCount??0)+(e.bottomSize??e.bottomPinCount??0);let{leftSide:i,rightSide:r,topSide:s,bottomSide:o}=e;return Math.max(...i?.pins??[],...r?.pins??[],...s?.pins??[],...o?.pins??[])}_getPinCount(){if(this._getSchematicPortArrangement())return this._getPinCountFromSchematicPortArrangement();let t=this.getPortsFromFootprint();if(t.length>0)return t.length;let{pinLabels:i}=this._parsedProps;if(i){if(Array.isArray(i))return i.length;let r=Object.keys(i).map(s=>s.startsWith("pin")?parseInt(s.slice(3)):parseInt(s)).filter(s=>!Number.isNaN(s));return r.length>0?Math.max(...r):Object.keys(i).length}return 0}_getSchematicPortArrangement(){return this._parsedProps.schPinArrangement??this._parsedProps.schPortArrangement}_getPinLabelsFromPorts(){let e=this.selectAll("port"),t={};for(let i of e){let r=i.props.pinNumber;if(r!==void 0){let s=i._getBestDisplayPinLabel();s&&(t[`pin${r}`]=s)}}return t}_getSchematicBoxDimensions(){if(this.getSchematicSymbol()||!this.config.shouldRenderAsSchematicBox)return null;let{_parsedProps:e}=this,t=this._getPinCount(),i=e.schPinSpacing??.2,s={...this._getPinLabelsFromPorts(),...e.pinLabels};return yOt({schWidth:e.schWidth,schHeight:e.schHeight,schPinSpacing:i,numericSchPinStyle:bOt(e.schPinStyle,s),pinCount:t,schPortArrangement:this._getSchematicPortArrangement(),pinLabels:s})}getFootprinterString(){return typeof this._parsedProps.footprint=="string"?this._parsedProps.footprint:null}doInitialCadModelRender(){if(this._isCadModelChild||this.props.doNotPlace)return;let{db:e}=this.root,{boardThickness:t=0}=this.root?._getBoard()??{},i=this._parsedProps.cadModel,r=i===void 0?this._asyncFootprintCadModel:i,s=this.getFootprinterString()??this._getImpliedFootprintString();if(!this.pcb_component_id||!r&&!s||r===null)return;let o=this._getPcbCircuitJsonBounds();if(typeof r=="string")throw new Error("String cadModel not yet implemented");let a=sLt.parse({x:0,y:0,z:typeof r?.rotationOffset=="number"?r.rotationOffset:0,...typeof r?.rotationOffset=="object"?r.rotationOffset??{}:{}}),c=zh.parse({x:0,y:0,z:0,...typeof r?.positionOffset=="object"?r.positionOffset:{}}),l=r&&typeof r=="object"&&"zOffsetFromSurface"in r&&r.zOffsetFromSurface!==void 0?Y.parse(r.zOffsetFromSurface):0,u=this.props.layer==="bottom"?"bottom":"top",p=this._computePcbGlobalTransformBeforeLayout(),y=to(p).rotation.angle*180/Math.PI,g=u==="bottom",x=y+(a.z??0),v=sd(x),P=e.cad_component.insert({position:{x:o.center.x+c.x,y:o.center.y+c.y,z:(u==="bottom"?-t/2:t/2)+(u==="bottom"?-l:l)+c.z},rotation:{x:a.x,y:a.y+(g?180:0),z:sd(g?-v:v)},pcb_component_id:this.pcb_component_id,source_component_id:this.source_component_id,model_stl_url:"stlUrl"in(r??{})?this._addCachebustToModelUrl(r.stlUrl):void 0,model_obj_url:"objUrl"in(r??{})?this._addCachebustToModelUrl(r.objUrl):void 0,model_mtl_url:"mtlUrl"in(r??{})?this._addCachebustToModelUrl(r.mtlUrl):void 0,model_gltf_url:"gltfUrl"in(r??{})?this._addCachebustToModelUrl(r.gltfUrl):void 0,model_glb_url:"glbUrl"in(r??{})?this._addCachebustToModelUrl(r.glbUrl):void 0,model_step_url:"stepUrl"in(r??{})?this._addCachebustToModelUrl(r.stepUrl):void 0,model_wrl_url:"wrlUrl"in(r??{})?this._addCachebustToModelUrl(r.wrlUrl):void 0,model_jscad:"jscad"in(r??{})?r.jscad:void 0,model_unit_to_mm_scale_factor:typeof r?.modelUnitToMmScale=="number"?r.modelUnitToMmScale:void 0,footprinter_string:typeof s=="string"&&!r?s:void 0});this.cad_component_id=P.cad_component_id}_addCachebustToModelUrl(e){if(!e||!e.includes("modelcdn.tscircuit.com"))return e;let t=this.root?.getClientOrigin()??"";return`${e}${e.includes("?")?"&":"?"}cachebust_origin=${encodeURIComponent(t)}`}_getPartsEngineCacheKey(e,t){return JSON.stringify({ftype:e.ftype,name:e.name,manufacturer_part_number:e.manufacturer_part_number,footprinterString:t})}async _getSupplierPartNumbers(e,t,i){if(this.props.doNotPlace)return{};let r=this.root?.platform?.localCacheEngine,s=this._getPartsEngineCacheKey(t,i);if(r){let c=await r.getItem(s);if(c)try{return JSON.parse(c)}catch{}}let o=await Promise.resolve(e.findPart({sourceComponent:t,footprinterString:i}));if(typeof o=="string"){if(o.includes("<!DOCTYPE")||o.includes("<html"))throw new Error(`Failed to fetch supplier part numbers: Received HTML response instead of JSON. Response starts with: ${o.substring(0,100)}`);if(o==="Not found")return{};throw new Error(`Invalid supplier part numbers format: Expected object but got string: "${o}"`)}if(!o||Array.isArray(o)||typeof o!="object"){let c=o===null?"null":Array.isArray(o)?"array":typeof o;throw new Error(`Invalid supplier part numbers format: Expected object but got ${c}`)}let a=o;if(r)try{await r.setItem(s,JSON.stringify(a))}catch{}return a}doInitialPartsEngineRender(){if(this.props.doNotPlace)return;let e=this.getInheritedProperty("partsEngine");if(!e)return;let{db:t}=this.root,i=t.source_component.get(this.source_component_id);if(!i||i.supplier_part_numbers)return;let r;this.props.footprint&&typeof this.props.footprint=="string"&&(r=this.props.footprint);let s=this._getSupplierPartNumbers(e,i,r);if(!(s instanceof Promise)){t.source_component.update(this.source_component_id,{supplier_part_numbers:s});return}this._queueAsyncEffect("get-supplier-part-numbers",async()=>{await s.then(o=>{this._asyncSupplierPartNumbers=o,this._markDirty("PartsEngineRender")}).catch(o=>{this._asyncSupplierPartNumbers={};let a=Xx.parse({type:"unknown_error_finding_part",message:`Failed to fetch supplier part numbers for ${this.getString()}: ${o.message}`,source_component_id:this.source_component_id,subcircuit_id:this.getSubcircuit()?.subcircuit_id});t.unknown_error_finding_part.insert(a),this._markDirty("PartsEngineRender")})})}updatePartsEngineRender(){if(this.props.doNotPlace)return;let{db:e}=this.root,t=e.source_component.get(this.source_component_id);if(t&&!t.supplier_part_numbers&&this._asyncSupplierPartNumbers){e.source_component.update(this.source_component_id,{supplier_part_numbers:this._asyncSupplierPartNumbers});return}}doInitialAssignFallbackProps(){let{_parsedProps:e}=this;e.connections&&!this.name&&(this.fallbackUnassignedName=this.getSubcircuit().getNextAvailableName(this))}doInitialCreateTracesFromProps(){this._createTracesFromConnectionsProp()}_createTracesFromConnectionsProp(){let{_parsedProps:e}=this;if(e.connections)for(let[t,i]of Object.entries(e.connections)){let r=Array.isArray(i)?i:[i];for(let s of r)this.add(new Fs({from:`.${this.name} > .${t}`,to:String(s)}))}}doInitialSourceDesignRuleChecks(){qOt(this)}_getMinimumFlexContainerSize(){return HOt(this)}_repositionOnPcb(e){return WOt(this,e)}doInitialSilkscreenOverlapAdjustment(){return JOt(this)}isRelativelyPositioned(){return this._parsedProps.pcbX!==void 0||this._parsedProps.pcbY!==void 0}},oLt=({boardAnchorPosition:n,boardAnchorAlignment:e,width:t,height:i})=>{let{x:r,y:s}=n,o=r,a=s;switch(e){case"top_left":o=r+t/2,a=s-i/2;break;case"top_right":o=r-t/2,a=s-i/2;break;case"bottom_left":o=r+t/2,a=s+i/2;break;case"bottom_right":o=r-t/2,a=s+i/2;break;case"top":o=r,a=s-i/2;break;case"bottom":o=r,a=s+i/2;break;case"left":o=r+t/2,a=s;break;case"right":o=r-t/2,a=s;break;case"center":default:break}return{x:o,y:a}},aLt=class{constructor(n,e={}){d(this,"input");d(this,"isRouting",!1);d(this,"solver");d(this,"eventHandlers",{complete:[],error:[],progress:[]});d(this,"cycleCount",0);d(this,"stepDelay");d(this,"timeoutId");this.input=n;let{capacityDepth:t,targetMinCapacity:i,stepDelay:r=0,useAssignableViaSolver:s=!1}=e,{AutoroutingPipelineSolver:o,AssignableViaAutoroutingPipelineSolver:a}=H4,c=s?a:o;this.solver=new c(n,{capacityDepth:t,targetMinCapacity:i,cacheProvider:null}),this.stepDelay=r}start(){this.isRouting||(this.isRouting=!0,this.cycleCount=0,this.runCycleAndQueueNextCycle())}runCycleAndQueueNextCycle(){if(this.isRouting)try{if(this.solver.solved||this.solver.failed){this.solver.failed?this.emitEvent({type:"error",error:new z1(this.solver.error||"Routing failed")}):this.emitEvent({type:"complete",traces:this.solver.getOutputSimpleRouteJson().traces||[]}),this.isRouting=!1;return}let n=Date.now(),e=this.solver.iterations;for(;Date.now()-n<250&&!this.solver.failed&&!this.solver.solved;)this.solver.step();let t=(this.solver.iterations-e)/(Date.now()-n)*1e3;this.cycleCount++;let i=this.solver?.preview()||void 0,r=this.solver.progress;this.emitEvent({type:"progress",steps:this.cycleCount,iterationsPerSecond:t,progress:r,phase:this.solver.getCurrentPhase(),debugGraphics:i}),this.stepDelay>0?this.timeoutId=setTimeout(()=>this.runCycleAndQueueNextCycle(),this.stepDelay):this.timeoutId=setTimeout(()=>this.runCycleAndQueueNextCycle(),0)}catch(n){this.emitEvent({type:"error",error:n instanceof Error?new z1(n.message):new z1(String(n))}),this.isRouting=!1}}stop(){this.isRouting&&(this.isRouting=!1,this.timeoutId!==void 0&&(clearTimeout(this.timeoutId),this.timeoutId=void 0))}on(n,e){n==="complete"?this.eventHandlers.complete.push(e):n==="error"?this.eventHandlers.error.push(e):n==="progress"&&this.eventHandlers.progress.push(e)}emitEvent(n){if(n.type==="complete")for(let e of this.eventHandlers.complete)e(n);else if(n.type==="error")for(let e of this.eventHandlers.error)e(n);else if(n.type==="progress")for(let e of this.eventHandlers.progress)e(n)}solveSync(){if(this.solver.solve(),this.solver.failed)throw new z1(this.solver.error||"Routing failed");return this.solver.getOutputSimpleRouteJson().traces||[]}},m9=class extends Ee{constructor(){super(...arguments);d(this,"matchedPort",null)}get config(){return{componentName:"TraceHint",zodProps:AW}}doInitialPortMatching(){let{db:e}=this.root,{_parsedProps:t,parent:i}=this;if(!i)return;if(i.componentName==="Trace"){this.renderError(`Port inference inside trace is not yet supported (${this})`);return}if(!i)throw new Error("TraceHint has no parent");if(!t.for){this.renderError(`TraceHint has no for property (${this})`);return}let r=i.selectOne(t.for,{type:"port"});r||this.renderError(`${this} could not find port for selector "${t.for}"`),this.matchedPort=r,r.registerMatch(this)}getPcbRouteHints(){let{_parsedProps:e}=this,t=e.offset?[e.offset]:e.offsets;if(!t)return[];let i=this._computePcbGlobalTransformBeforeLayout();return t.map(r=>({...$e(i,r),via:r.via,to_layer:r.to_layer,trace_width:r.trace_width}))}doInitialPcbTraceHintRender(){if(this.root?.pcbDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this;e.pcb_trace_hint.insert({pcb_component_id:this.matchedPort?.pcb_component_id,pcb_port_id:this.matchedPort?.pcb_port_id,route:this.getPcbRouteHints()})}},rnt=({circuitJson:n,editEvents:e,manualEditsFile:t})=>{let i={...t,pcb_placements:[...t.pcb_placements??[]]};for(let r of e)if(r.edit_event_type==="edit_pcb_component_location"){let{pcb_component_id:s,new_center:o}=r,a=Me(n).pcb_component.get(s);if(!a)continue;let c=Me(n).source_component.get(a.source_component_id);if(!c)continue;let l=i.pcb_placements?.findIndex(p=>p.selector===c.name),u={selector:c.name,center:o,relative_to:"group_center"};l>=0?i.pcb_placements[l]=u:i.pcb_placements.push(u)}return i},snt=({circuitJson:n,editEvents:e,manualEditsFile:t})=>{let i={...t,schematic_placements:[...t.schematic_placements??[]]};for(let r of e)if(r.edit_event_type==="edit_schematic_component_location"){let{schematic_component_id:s,new_center:o}=r,a=Me(n).schematic_component.get(s);if(!a||!a.source_component_id)continue;let c=Me(n).source_component.get(a.source_component_id);if(!c)continue;let l=i.schematic_placements?.findIndex(p=>p.selector===c.name),u={selector:c.name,center:o,relative_to:"group_center"};l>=0?i.schematic_placements[l]=u:i.schematic_placements.push(u)}return i},cLt=({circuitJson:n,editEvents:e,manualEditsFile:t})=>{let i=e.filter(o=>o.edit_event_type==="edit_schematic_component_location"),r=e.filter(o=>o.edit_event_type==="edit_pcb_component_location"),s=t;return i.length>0&&(s=snt({circuitJson:n,editEvents:i,manualEditsFile:s})),r.length>0&&(s=rnt({circuitJson:n,editEvents:r,manualEditsFile:s})),s},lLt=(n,e)=>{if(Me(n).pcb_trace_hint.get(e.pcb_trace_hint_id))n=n.map(i=>i.pcb_trace_hint_id===e.pcb_trace_hint_id?{...i,route:e.route}:i);else{let i=Me(n).pcb_port.get(e.pcb_port_id);n=n.filter(r=>!(r.type==="pcb_trace_hint"&&r.pcb_port_id===e.pcb_port_id)).concat([{type:"pcb_trace_hint",pcb_trace_hint_id:e.pcb_trace_hint_id,route:e.route,pcb_port_id:e.pcb_port_id,pcb_component_id:i?.pcb_component_id}])}return n},uLt=({circuitJson:n,editEvents:e})=>{n=JSON.parse(JSON.stringify(n));for(let t of e)if(t.edit_event_type==="edit_pcb_component_location"){let i=n.find(s=>s.type==="pcb_component"&&s.pcb_component_id===t.pcb_component_id);if((!i||i.center.x!==t.new_center.x||i.center.y!==t.new_center.y)&&t.original_center){let s=Rn(t.new_center.x-t.original_center.x,t.new_center.y-t.original_center.y);n=n.map(o=>o.pcb_component_id!==t.pcb_component_id?o:g4(o,s))}}else t.edit_event_type==="edit_schematic_component_location"?n=n.map(i=>i.type==="schematic_component"&&i.schematic_component_id===t.schematic_component_id?{...i,center:t.new_center}:i):t.edit_event_type==="edit_pcb_trace_hint"&&(n=lLt(n,t));return n},ont=(n,e)=>{let t=n.source_group.list(),i=[],r=s=>{let o=t.filter(a=>a.parent_subcircuit_id===s);for(let a of o)a.subcircuit_id&&(i.push(a.subcircuit_id),r(a.subcircuit_id))};return r(e),i},a9=({db:n,circuitJson:e,subcircuit_id:t,minTraceWidth:i=.1})=>{if(!n&&e&&(n=Me(e)),!n)throw new Error("db or circuitJson is required");let r=n.pcb_trace_hint.list(),s=t?new Set([t]):null;if(t){let N=ont(n,t);for(let M of N)s.add(M)}let o=(e??n.toArray()).filter(N=>!t||"subcircuit_id"in N&&s.has(N.subcircuit_id)),a=n.pcb_board.list()[0];n=Me(o);let c=nr(o),l=tnt([...n.pcb_component.list(),...n.pcb_smtpad.list(),...n.pcb_plated_hole.list(),...n.pcb_hole.list(),...n.pcb_via.list(),...n.pcb_cutout.list()].filter(N=>!t||s?.has(N.subcircuit_id)),c);for(let N of l){let M=N.connectedTo.flatMap(A=>c.getIdsConnectedToNet(A));N.connectedTo.push(...M)}let u=l.flatMap(N=>[{x:N.center.x-N.width/2,y:N.center.y-N.height/2},{x:N.center.x+N.width/2,y:N.center.y+N.height/2}]).concat(a?.outline??[]),p;if(a&&!a.outline?p={minX:a.center.x-a.width/2,maxX:a.center.x+a.width/2,minY:a.center.y-a.height/2,maxY:a.center.y+a.height/2}:p={minX:Math.min(...u.map(N=>N.x))-1,maxX:Math.max(...u.map(N=>N.x))+1,minY:Math.min(...u.map(N=>N.y))-1,maxY:Math.max(...u.map(N=>N.y))+1},t){let N=n.pcb_group.getWhere({subcircuit_id:t});if(N?.width&&N.height){let M={minX:N.center.x-N.width/2,maxX:N.center.x+N.width/2,minY:N.center.y-N.height/2,maxY:N.center.y+N.height/2};p={minX:Math.min(p.minX,M.minX),maxX:Math.max(p.maxX,M.maxX),minY:Math.min(p.minY,M.minY),maxY:Math.max(p.maxY,M.maxY)}}}let f=new Set(n.pcb_trace.list().map(N=>N.source_trace_id).filter(N=>!!N)),y=n.source_trace.list().filter(N=>!f.has(N.source_trace_id)).map(N=>{let M=N.connected_source_port_ids.map(H=>{let tt=n.source_port.get(H),et=n.pcb_port.getWhere({source_port_id:H});return{...tt,...et}});if(M.length<2)return null;let[A,R]=M,j=A.layers?.[0]??"top",B=R.layers?.[0]??"top",G=r.filter(H=>H.pcb_port_id===A.pcb_port_id||H.pcb_port_id===R.pcb_port_id),U=[];for(let H of G){let et=n.pcb_port.get(H.pcb_port_id)?.layers?.[0]??"top";for(let mt of H.route)U.push({x:mt.x,y:mt.y,layer:et})}return{name:N.source_trace_id??c.getNetConnectedToId(N.source_trace_id)??"",source_trace_id:N.source_trace_id,width:N.min_trace_thickness,pointsToConnect:[{x:A.x,y:A.y,layer:j,pointId:A.pcb_port_id,pcb_port_id:A.pcb_port_id},...U,{x:R.x,y:R.y,layer:B,pointId:R.pcb_port_id,pcb_port_id:R.pcb_port_id}]}}).filter(N=>N!==null),g=new Map(y.map(N=>[N.source_trace_id,N])),x=n.source_net.list().filter(N=>!t||s?.has(N.subcircuit_id)),v=[];for(let N of x){let M=n.source_trace.list().filter(A=>A.connected_source_net_ids?.includes(N.source_net_id));v.push({name:N.source_net_id??c.getNetConnectedToId(N.source_net_id),pointsToConnect:M.flatMap(A=>n.pcb_port.list().filter(j=>A.connected_source_port_ids.includes(j.source_port_id)).map(j=>({x:j.x,y:j.y,layer:j.layers?.[0]??"top",pointId:j.pcb_port_id,pcb_port_id:j.pcb_port_id})))})}let P=n.pcb_breakout_point.list().filter(N=>!t||s?.has(N.subcircuit_id)),w=[],k=new Map;for(let N of P){let M={x:N.x,y:N.y,layer:"top"};if(N.source_trace_id){let A=g.get(N.source_trace_id)??k.get(N.source_trace_id);if(A)A.pointsToConnect.push(M);else{let R={name:N.source_trace_id,source_trace_id:N.source_trace_id,pointsToConnect:[M]};w.push(R),k.set(N.source_trace_id,R)}}else if(N.source_net_id){let A=v.find(R=>R.name===N.source_net_id);A?A.pointsToConnect.push(M):w.push({name:N.source_net_id,pointsToConnect:[M]})}else if(N.source_port_id){let A=n.pcb_port.getWhere({source_port_id:N.source_port_id});A&&w.push({name:N.source_port_id,source_trace_id:void 0,pointsToConnect:[{x:A.x,y:A.y,layer:A.layers?.[0]??"top",pointId:A.pcb_port_id,pcb_port_id:A.pcb_port_id},M]})}}let T=[...y,...v,...w],I=new Map;for(let N of T)for(let M of N.pointsToConnect)M.pointId&&I.set(M.pointId,N);let E=n.pcb_trace.list().filter(N=>!t||s?.has(N.subcircuit_id));for(let N of E){let M=new Set;for(let j of N.route)j.start_pcb_port_id&&M.add(j.start_pcb_port_id),j.end_pcb_port_id&&M.add(j.end_pcb_port_id);if(M.size<2)continue;let A=M.values().next().value;if(!A)continue;let R=I.get(A);R&&[...M].every(j=>I.get(j)===R)&&(R.externallyConnectedPointIds??(R.externallyConnectedPointIds=[]),R.externallyConnectedPointIds.push([...M]))}return{simpleRouteJson:{bounds:p,obstacles:l,connections:T,layerCount:a?.num_layers??2,minTraceWidth:i,outline:a?.outline?.map(N=>({...N}))},connMap:c}},pLt=n=>{let e={};if(!n)return e;for(let i of Xa)e[i]=0;let t=new Map;for(let i of n){let[,,r,s]=i.type.split(":");if(s==="start"){t.set(`${r}:${i.renderId}`,i);continue}if(s==="end"){let o=t.get(`${r}:${i.renderId}`);if(o){let a=i.createdAt-o.createdAt;e[r]=(e[r]||0)+a}}}return e},hLt=n=>{let e=n.map(c=>[...new Set(c)]),t=e.map(()=>[]),i=e.map(()=>null);for(let c=0;c<e.length;c++)for(let l of e[c])if(/^\d+$/.test(l)){i[c]=Number.parseInt(l);break}let r=0,s=new Set;for(let c=0;c<i.length;c++){let l=i[c];if(l===null||l<1)continue;if(!s.has(l)){s.add(l),t[c].push(`pin${l}`),r=Math.max(r,l);continue}let u=0;for(let p of t[c])p.startsWith(`pin${l}_alt`)&&u++;t[c].push(`pin${l}_alt${u+1}`)}for(let c=0;c<t.length;c++)t[c][0]?.includes("_alt")&&(r++,t[c].unshift(`pin${r}`));for(let c=0;c<t.length;c++)t[c].length===0&&(r++,t[c].push(`pin${r}`));let o={};for(let c of e)for(let l of c)/^\d+$/.test(l)||(o[l]=(o[l]??0)+1);let a={};for(let c=0;c<e.length;c++){let l=e[c];for(let u of l)/^\d+$/.test(u)||(o[u]===1?t[c].push(u):(a[u]=(a[u]??0)+1,t[c].push(`${u}${a[u]}`)))}return t};function _9({db:n,schematicComponentId:e,deltaX:t,deltaY:i}){let r=n.schematic_rect.list({schematic_component_id:e});for(let c of r)c.center.x+=t,c.center.y+=i;let s=n.schematic_line.list({schematic_component_id:e});for(let c of s)c.x1+=t,c.y1+=i,c.x2+=t,c.y2+=i;let o=n.schematic_circle.list({schematic_component_id:e});for(let c of o)c.center.x+=t,c.center.y+=i;let a=n.schematic_arc.list({schematic_component_id:e});for(let c of a)c.center.x+=t,c.center.y+=i}var vet=(0,ant.default)("Group_doInitialSchematicLayoutMatchAdapt");function dLt(n){let{db:e}=n.root,t=Rg(e.toArray(),{source_group_id:n.source_group_id}),i=W4(t);vet.enabled&&global?.debugGraphics&&global.debugGraphics?.push(il(i,{title:`floatingBpcGraph-${n.name}`}));let r=W4(t),s={boxes:r.boxes,pins:r.pins.map(c=>({...c,color:c.color.replace("not_connected","normal")}))},{result:o}=QK([{variantName:"default",floatingGraph:r},{variantName:"noNotConnected",floatingGraph:s}],{singletonKeys:["vcc/2","gnd/2"],centerPinColors:["netlabel_center","component_center"],floatingBoxIdsWithMutablePinOffsets:new Set(r.boxes.filter(c=>r.pins.filter(p=>p.boxId===c.boxId).filter(p=>!p.color.includes("center")).length<=2).map(c=>c.boxId)),corpus:{}});vet.enabled&&global?.debugGraphics&&global.debugGraphics?.push(il(o,{title:`laidOutBpcGraph-${n.name}`}));let a=n._getGlobalSchematicPositionBeforeLayout();for(let c of o.boxes){if(!c.center)continue;let l=e.schematic_component.get(c.boxId);if(l){let p={x:c.center.x+a.x,y:c.center.y+a.y},f=e.schematic_port.list({schematic_component_id:l.schematic_component_id}),y=e.schematic_text.list({schematic_component_id:l.schematic_component_id}),g={x:p.x-l.center.x,y:p.y-l.center.y};for(let x of f)x.center.x+=g.x,x.center.y+=g.y;for(let x of y)x.position.x+=g.x,x.position.y+=g.y;_9({db:e,schematicComponentId:l.schematic_component_id,deltaX:g.x,deltaY:g.y}),l.center=p;continue}let u=e.schematic_net_label.get(c.boxId);if(u){let p=o.pins.find(y=>y.boxId===c.boxId&&y.color==="netlabel_center");if(!p)throw new Error(`No pin found for net label: ${c.boxId}`);let f={x:c.center.x+a.x,y:c.center.y+a.y};u.center=f,u.anchor_position={x:f.x+p.offset.x,y:f.y+p.offset.y};continue}console.error(`No schematic element found for box: ${c.boxId}. This is a bug in the matchAdapt binding with @tscircuit/core`)}}var xe=(0,cnt.default)("Group_doInitialSchematicLayoutMatchpack");function wet(n){switch(n){case"up":return"y+";case"down":return"y-";case"left":return"x-";case"right":return"x+";default:return"y+"}}function Pet(n,e){let t=["right","up","left","down"],i=t.indexOf(n);if(i===-1)return n;let r=Math.round(e/90),s=(i+r)%4;return t[s<0?s+4:s]}function fLt(n,e,t){let i={chipMap:{},chipPinMap:{},netMap:{},pinStrongConnMap:{},netConnMap:{},chipGap:.6,decouplingCapsGap:.4,partitionGap:1.2};xe(`[${t.name}] Processing ${n.childNodes.length} child nodes for input problem`),n.childNodes.forEach((s,o)=>{if(xe(`[${t.name}] Processing child ${o}: nodeType=${s.nodeType}`),s.nodeType==="component"?xe(`[${t.name}] - Component: ${s.sourceComponent?.name}`):s.nodeType==="group"&&xe(`[${t.name}] - Group: ${s.sourceGroup?.name}`),s.nodeType==="component"&&s.sourceComponent){let a=s.sourceComponent.name||`chip_${o}`,c=e.schematic_component.getWhere({source_component_id:s.sourceComponent.source_component_id});if(!c)return;let l=t.children.find(w=>w.source_component_id===s.sourceComponent?.source_component_id),u=[0,90,180,270];l?._parsedProps?.schOrientation&&(u=[0]),l?._parsedProps?.schRotation!==void 0&&(u=[0]),l?._parsedProps?.facingDirection&&(u=[0]),l?._parsedProps?.schFacingDirection&&(u=[0]),l?.componentName==="Chip"&&(u=[0]);let p=l?._parsedProps?.schMarginLeft??l?._parsedProps?.schMarginX??0,f=l?._parsedProps?.schMarginRight??l?._parsedProps?.schMarginX??0,y=l?._parsedProps?.schMarginTop??l?._parsedProps?.schMarginY??0,g=l?._parsedProps?.schMarginBottom??l?._parsedProps?.schMarginY??0;l?.config.shouldRenderAsSchematicBox&&(y+=.4,g+=.4);let x=(f-p)/2,v=(y-g)/2;i.chipMap[a]={chipId:a,pins:[],size:{x:(c.size?.width||1)+p+f,y:(c.size?.height||1)+y+g},availableRotations:u};let P=e.schematic_port.list({schematic_component_id:c.schematic_component_id});for(let w of P){let k=e.source_port.get(w.source_port_id);if(!k)continue;let T=`${a}.${k.pin_number||k.name||w.schematic_port_id}`;i.chipMap[a].pins.push(T);let I=wet(w.facing_direction);i.chipPinMap[T]={pinId:T,offset:{x:(w.center?.x||0)-(c.center.x||0)+x,y:(w.center?.y||0)-(c.center.y||0)+v},side:I}}}else if(s.nodeType==="group"&&s.sourceGroup){let a=s.sourceGroup.name||`group_${o}`;xe(`[${t.name}] Processing nested group: ${a}`);let c=e.schematic_group?.getWhere?.({source_group_id:s.sourceGroup.source_group_id}),l=t.children.find(u=>u.source_group_id===s.sourceGroup?.source_group_id);if(xe(`[${t.name}] Found schematic_group for ${a}:`,c),c){xe(`[${t.name}] Treating group ${a} as composite chip`);let u=e.schematic_component.list({schematic_group_id:c.schematic_group_id});xe(`[${t.name}] Group ${a} has ${u.length} components:`,u.map(A=>A.source_component_id));let p=1/0,f=-1/0,y=1/0,g=-1/0,x=!1;for(let A of u)if(A.center&&A.size){x=!0;let R=A.size.width/2,j=A.size.height/2;p=Math.min(p,A.center.x-R),f=Math.max(f,A.center.x+R),y=Math.min(y,A.center.y-j),g=Math.max(g,A.center.y+j)}let v=l?._parsedProps?.schMarginLeft??l?._parsedProps?.schMarginX??0,P=l?._parsedProps?.schMarginRight??l?._parsedProps?.schMarginX??0,w=l?._parsedProps?.schMarginTop??l?._parsedProps?.schMarginY??0,k=l?._parsedProps?.schMarginBottom??l?._parsedProps?.schMarginY??0,T=(P-v)/2,I=(w-k)/2,E=(x?f-p:2)+v+P,N=(x?g-y:2)+w+k;xe(`[${t.name}] Group ${a} computed size: ${E} x ${N}`);let M=[];for(let A of u){let R=e.schematic_port.list({schematic_component_id:A.schematic_component_id});for(let j of R){let B=e.source_port.get(j.source_port_id);if(!B)continue;let G=`${a}.${B.pin_number||B.name||j.schematic_port_id}`;M.push(G);let U=c.center||{x:0,y:0},H=wet(j.facing_direction);i.chipPinMap[G]={pinId:G,offset:{x:(j.center?.x||0)-U.x+T,y:(j.center?.y||0)-U.y+I},side:H}}}xe(`[${t.name}] Group ${a} has ${M.length} pins:`,M),i.chipMap[a]={chipId:a,pins:M,size:{x:E,y:N}},xe(`[${t.name}] Added group ${a} to chipMap`)}else xe(`[${t.name}] Warning: No schematic_group found for group ${a}`)}}),xe(`[${t.name}] Creating connections using connectivity keys`);let r=new Map;for(let[s,o]of Object.entries(i.chipMap))for(let a of o.pins){let c=a.split(".").pop(),l=n.childNodes.find(u=>u.nodeType==="component"&&u.sourceComponent?u.sourceComponent.name===s:u.nodeType==="group"&&u.sourceGroup?`group_${n.childNodes.indexOf(u)}`===s:!1);if(l?.nodeType==="group"&&l.sourceGroup){let u=e.schematic_group?.getWhere?.({source_group_id:l.sourceGroup.source_group_id});if(u){let p=e.schematic_component.list({schematic_group_id:u.schematic_group_id});for(let f of p){let y=e.source_port.list({source_component_id:f.source_component_id});for(let g of y){let x=g.pin_number||g.name;if(String(x)===String(c))if(g.subcircuit_connectivity_map_key){let v=g.subcircuit_connectivity_map_key;r.has(v)||r.set(v,[]),r.get(v).push(a),xe(`[${t.name}] \u2713 Pin ${a} has connectivity key: ${v}`)}else xe(`[${t.name}] Pin ${a} has no connectivity key`)}}}}else if(l?.nodeType==="component"&&l.sourceComponent){let u=e.source_port.list({source_component_id:l.sourceComponent.source_component_id});for(let p of u){let f=p.pin_number||p.name;if(String(f)===String(c)&&p.subcircuit_connectivity_map_key){let y=p.subcircuit_connectivity_map_key;r.has(y)||r.set(y,[]),r.get(y).push(a),xe(`[${t.name}] Pin ${a} has connectivity key: ${y}`)}}}}xe(`[${t.name}] Found ${r.size} connectivity groups:`,Array.from(r.entries()).map(([s,o])=>({key:s,pins:o})));for(let[s,o]of r)if(o.length>=2){let a=e.source_trace.list().filter(u=>u.subcircuit_connectivity_map_key===s),c=a.some(u=>u.connected_source_net_ids&&u.connected_source_net_ids.length>0),l=a.some(u=>u.connected_source_port_ids&&u.connected_source_port_ids.length>=2);if(xe(`[${t.name}] Connectivity ${s}: hasNetConnections=${c}, hasDirectConnections=${l}`),l){for(let u of a)if(u.connected_source_port_ids&&u.connected_source_port_ids.length>=2){let p=[];for(let f of u.connected_source_port_ids)for(let y of o){let g=y.split(".").pop(),x=e.source_port.get(f);if(x&&String(x.pin_number||x.name)===String(g)){let v=y.split(".")[0],P=n.childNodes.find(w=>w.nodeType==="component"&&w.sourceComponent?w.sourceComponent.name===v:w.nodeType==="group"&&w.sourceGroup?`group_${n.childNodes.indexOf(w)}`===v:!1);P?.nodeType==="component"&&P.sourceComponent&&e.source_port.list({source_component_id:P.sourceComponent.source_component_id}).some(k=>k.source_port_id===f)&&p.push(y)}}for(let f=0;f<p.length;f++)for(let y=f+1;y<p.length;y++){let g=p[f],x=p[y];i.pinStrongConnMap[`${g}-${x}`]=!0,i.pinStrongConnMap[`${x}-${g}`]=!0,xe(`[${t.name}] Created strong connection: ${g} <-> ${x}`)}}}if(c){let u=e.source_net.getWhere({subcircuit_connectivity_map_key:s}),p=u?.is_ground??!1,f=u?.is_power??!1;i.netMap[s]={netId:s,isGround:p,isPositiveVoltageSource:f};for(let y of o)i.netConnMap[`${y}-${s}`]=!0;xe(`[${t.name}] Created net ${s} with ${o.length} pins:`,o)}}return i}function mLt(n){let{db:e}=n.root,t=a_(e.toArray(),{source_group_id:n.source_group_id});if(xe(`[${n.name}] Starting matchpack layout with ${t.childNodes.length} children`),xe(`[${n.name}] Tree structure:`,JSON.stringify(t,null,2)),t.childNodes.length<=1){xe(`[${n.name}] Only ${t.childNodes.length} children, skipping layout`);return}xe("Converting circuit tree to InputProblem...");let i=fLt(t,e,n);xe.enabled&&n.root?.emit("debug:logOutput",{type:"debug:logOutput",name:`matchpack-input-problem-${n.name}`,content:JSON.stringify(i,null,2)});let r=new iQ(i);if(xe("Starting LayoutPipelineSolver..."),xe.enabled&&global?.debugGraphics){let c=r.visualize();global.debugGraphics.push({...c,title:`matchpack-initial-${n.name}`})}if(r.solve(),xe(`Solver completed in ${r.iterations} iterations`),xe(`Solved: ${r.solved}, Failed: ${r.failed}`),r.failed)throw xe(`Solver failed with error: ${r.error}`),new Error(`Matchpack layout solver failed: ${r.error}`);let s=r.getOutputLayout();if(xe("OutputLayout:",JSON.stringify(s,null,2)),xe("Solver completed successfully:",!r.failed),xe.enabled&&global?.debugGraphics){let c=r.visualize();global.debugGraphics.push({...c,title:`matchpack-final-${n.name}`})}let o=r.checkForOverlaps(s);if(o.length>0){xe(`Warning: Found ${o.length} overlapping components:`);for(let c of o)xe(`  ${c.chip1} overlaps ${c.chip2} (area: ${c.overlapArea})`)}let a=n._getGlobalSchematicPositionBeforeLayout();xe(`Group offset: x=${a.x}, y=${a.y}`),xe(`Applying layout results for ${Object.keys(s.chipPlacements).length} chip placements`);for(let[c,l]of Object.entries(s.chipPlacements)){xe(`Processing placement for chip: ${c} at (${l.x}, ${l.y})`);let u=t.childNodes.find(f=>{if(f.nodeType==="component"&&f.sourceComponent){let y=f.sourceComponent.name===c;return xe(`  Checking component ${f.sourceComponent.name}: matches=${y}`),y}if(f.nodeType==="group"&&f.sourceGroup){let y=f.sourceGroup.name,g=`group_${t.childNodes.indexOf(f)}`,x=g===c;return xe(`  Checking group ${y} (expected chipId: ${g}): matches=${x}`),x}return!1});if(!u){xe(`Warning: No tree node found for chip: ${c}`),xe("Available tree nodes:",t.childNodes.map((f,y)=>({type:f.nodeType,name:f.nodeType==="component"?f.sourceComponent?.name:f.sourceGroup?.name,expectedChipId:f.nodeType==="group"?`group_${y}`:f.sourceComponent?.name})));continue}let p={x:l.x+a.x,y:l.y+a.y};if(u.nodeType==="component"&&u.sourceComponent){let f=e.schematic_component.getWhere({source_component_id:u.sourceComponent.source_component_id});if(f){xe(`Moving component ${c} to (${p.x}, ${p.y})`);let y=e.schematic_port.list({schematic_component_id:f.schematic_component_id}),g=e.schematic_text.list({schematic_component_id:f.schematic_component_id}),x={x:p.x-f.center.x,y:p.y-f.center.y};for(let v of y)v.center.x+=x.x,v.center.y+=x.y;for(let v of g)v.position.x+=x.x,v.position.y+=x.y;if(_9({db:e,schematicComponentId:f.schematic_component_id,deltaX:x.x,deltaY:x.y}),f.center=p,l.ccwRotationDegrees!==0){xe(`Component ${c} has rotation: ${l.ccwRotationDegrees}\xB0`);let v=l.ccwRotationDegrees*Math.PI/180,P=Math.cos(v),w=Math.sin(v);for(let k of y){let T=k.center.x-p.x,I=k.center.y-p.y,E=T*P-I*w,N=T*w+I*P;k.center.x=p.x+E,k.center.y=p.y+N;let M=k.facing_direction||"right";k.facing_direction=Pet(M,l.ccwRotationDegrees),k.side_of_component=(k.facing_direction==="up"?"top":k.facing_direction==="down"?"bottom":k.facing_direction)||k.side_of_component}for(let k of g){let T=k.position.x-p.x,I=k.position.y-p.y,E=T*P-I*w,N=T*w+I*P;k.position.x=p.x+E,k.position.y=p.y+N}if(f.symbol_name){let k=f.symbol_name.match(/_(right|left|up|down)$/);k&&(f.symbol_name=f.symbol_name.replace(k[0],`_${Pet(k[1],l.ccwRotationDegrees)}`))}}}}else if(u.nodeType==="group"&&u.sourceGroup){let f=e.schematic_group?.getWhere?.({source_group_id:u.sourceGroup.source_group_id});if(f){xe(`Moving group ${c} to (${p.x}, ${p.y}) from (${f.center?.x}, ${f.center?.y})`);let y=e.schematic_component.list({schematic_group_id:f.schematic_group_id});xe(`Group ${c} has ${y.length} components to move`);let g=f.center||{x:0,y:0},x={x:p.x-g.x,y:p.y-g.y};xe(`Position delta for group ${c}: (${x.x}, ${x.y})`);for(let v of y)if(v.center){let P={...v.center};v.center.x+=x.x,v.center.y+=x.y,xe(`Moved component ${v.source_component_id} from (${P.x}, ${P.y}) to (${v.center.x}, ${v.center.y})`);let w=e.schematic_port.list({schematic_component_id:v.schematic_component_id}),k=e.schematic_text.list({schematic_component_id:v.schematic_component_id});for(let T of w)T.center&&(T.center.x+=x.x,T.center.y+=x.y);for(let T of k)T.position&&(T.position.x+=x.x,T.position.y+=x.y)}f.center=p,xe(`Updated group ${c} center to (${p.x}, ${p.y})`)}}}xe("Matchpack layout completed successfully")}function _Lt(n){if(!n.isSubcircuit)return;let{db:e}=n.root,t=n.selectAll("trace"),i=n.selectAll("via"),r=n.selectAll("net"),s=new Jm({});s.addConnections(t.map(u=>{let p=e.source_trace.get(u.source_trace_id);return p?[p.source_trace_id,...p.connected_source_port_ids,...p.connected_source_net_ids]:null}).filter(u=>u!==null));let o=e.source_net.list().filter(u=>u.subcircuit_id===n.subcircuit_id);for(let u of o)s.addConnections([[u.source_net_id]]);let{name:a}=n._parsedProps;for(let u of t){if(!u.source_trace_id)continue;let p=s.getNetConnectedToId(u.source_trace_id);p&&(u.subcircuit_connectivity_map_key=`${a??`unnamedsubcircuit${n._renderId}`}_${p}`,e.source_trace.update(u.source_trace_id,{subcircuit_connectivity_map_key:u.subcircuit_connectivity_map_key}))}let c=new Set;for(let u of t){if(!u.source_trace_id)continue;let p=e.source_trace.get(u.source_trace_id);if(p)for(let f of p.connected_source_port_ids)c.add(f)}for(let u of c){let p=s.getNetConnectedToId(u);if(!p)continue;let f=`${a??`unnamedsubcircuit${n._renderId}`}_${p}`;e.source_port.update(u,{subcircuit_connectivity_map_key:f})}let l=new Set;for(let u of t){if(!u.source_trace_id)continue;let p=e.source_trace.get(u.source_trace_id);if(p)for(let f of p.connected_source_net_ids)l.add(f)}for(let u of o)l.add(u.source_net_id);for(let u of l){let p=s.getNetConnectedToId(u);if(!p)continue;let f=`${a??`unnamedsubcircuit${n._renderId}`}_${p}`;e.source_net.update(u,{subcircuit_connectivity_map_key:f});let y=r.find(g=>g.source_net_id===u);y&&(y.subcircuit_connectivity_map_key=f)}for(let u of i){let p=u._getConnectedNetOrTrace();p&&p.subcircuit_connectivity_map_key&&(u.subcircuit_connectivity_map_key=p.subcircuit_connectivity_map_key)}}function yLt(n){let{db:e}=n.root,t=n._parsedProps,i=n.children.filter(I=>{let E=I._parsedProps?.schX!==void 0||I._parsedProps?.schY!==void 0;return I.schematic_component_id&&!E});if(i.length===0)return;let r=0,s=0;for(let I of i){let E=e.schematic_component.get(I.schematic_component_id);E?.size&&(r=Math.max(r,E.size.width),s=Math.max(s,E.size.height))}r===0&&i.length>0&&(r=1),s===0&&i.length>0&&(s=1);let o=t.gridCols,a,c=t.gridGap,l=t.gridRowGap,u=t.gridColumnGap;t.schLayout?.grid&&(o=t.schLayout.grid.cols??o,a=t.schLayout.grid.rows,c=t.schLayout.gridGap??c,l=t.schLayout.gridRowGap??l,u=t.schLayout.gridColumnGap??u);let p,f;o!==void 0&&a!==void 0?(p=o,f=a):o!==void 0?(p=o,f=Math.ceil(i.length/p)):a!==void 0?(f=a,p=Math.ceil(i.length/f)):(p=Math.ceil(Math.sqrt(i.length)),f=Math.ceil(i.length/p)),p===0&&i.length>0&&(p=1),f===0&&i.length>0&&(f=i.length);let y,g,x=I=>{if(I!==void 0)return typeof I=="number"?I:D.parse(I)};if(l!==void 0||u!==void 0){let I=typeof c=="object"&&c!==null?c.x:c,E=typeof c=="object"&&c!==null?c.y:c;y=x(u??I)??1,g=x(l??E)??1}else if(typeof c=="number")y=c,g=c;else if(typeof c=="string"){let I=D.parse(c);y=I,g=I}else if(typeof c=="object"&&c!==null){let I=c.x,E=c.y;y=typeof I=="number"?I:D.parse(I??"0mm"),g=typeof E=="number"?E:D.parse(E??"0mm")}else y=1,g=1;let v=p*r+Math.max(0,p-1)*y,P=f*s+Math.max(0,f-1)*g,w=n._getGlobalSchematicPositionBeforeLayout(),k=w.x-v/2+r/2,T=w.y+P/2-s/2;for(let I=0;I<i.length;I++){let E=i[I];if(!E.schematic_component_id)continue;let N=Math.floor(I/p),M=I%p;if(N>=f||M>=p){console.warn(`Schematic grid layout: Child ${E.getString()} at index ${I} (row ${N}, col ${M}) exceeds specified grid dimensions (${f}x${p}). Skipping placement.`);continue}let A=k+M*(r+y),R=T-N*(s+g),j=e.schematic_component.get(E.schematic_component_id);if(j){let B=j.center,G={x:A,y:R};e.schematic_component.update(E.schematic_component_id,{center:G});let U=G.x-B.x,H=G.y-B.y,tt=e.schematic_port.list({schematic_component_id:E.schematic_component_id});for(let mt of tt)e.schematic_port.update(mt.schematic_port_id,{center:{x:mt.center.x+U,y:mt.center.y+H}});let et=e.schematic_text.list({schematic_component_id:E.schematic_component_id});for(let mt of et)e.schematic_text.update(mt.schematic_text_id,{position:{x:mt.position.x+U,y:mt.position.y+H}});_9({db:e,schematicComponentId:E.schematic_component_id,deltaX:U,deltaY:H})}}n.schematic_group_id&&e.schematic_group.update(n.schematic_group_id,{width:v,height:P,center:w})}var ket=(n,e)=>{let{sourceComponent:t,sourceGroup:i}=e;if(e.nodeType==="component"){let r=n.schematic_component.getWhere({source_component_id:t?.source_component_id});return r?.size?{width:r.size.width,height:r.size.height}:null}if(e.nodeType==="group"){let r=n.schematic_group.getWhere({source_group_id:i?.source_group_id});if(r?.width&&r?.height)return{width:r.width,height:r.height};let s=n.schematic_component.list({schematic_group_id:r?.schematic_group_id}),o=1/0,a=-1/0,c=1/0,l=-1/0;for(let f of s)if(f.center&&f.size){let y=f.size.width/2,g=f.size.height/2;o=Math.min(o,f.center.x-y),a=Math.max(a,f.center.x+y),c=Math.min(c,f.center.y-g),l=Math.max(l,f.center.y+g)}let u=a-o,p=l-c;return{width:u,height:p}}return null},gLt=n=>{let{db:e}=n.root,t=n._parsedProps,i=a_(e.toArray(),{source_group_id:n.source_group_id}),r=t.schJustifyContent??t.justifyContent,s=t.schAlignItems??t.alignItems,o=t.schFlexGap??t.schGap??t.gap,a=t.schFlexDirection??"row",c={start:"flex-start",end:"flex-end","flex-start":"flex-start","flex-end":"flex-end",stretch:"space-between","space-between":"space-between","space-around":"space-around","space-evenly":"space-evenly",center:"center"}[r??"space-between"],l={start:"flex-start",end:"flex-end","flex-start":"flex-start","flex-end":"flex-end",stretch:"stretch",center:"center"}[s??"center"];if(!c)throw new Error(`Invalid justifyContent value: "${r}"`);if(!l)throw new Error(`Invalid alignItems value: "${s}"`);let u=0,p=0;typeof o=="object"?(u=o.y??0,p=o.x??0):typeof o=="number"?(u=o,p=o):typeof o=="string"&&(u=D.parse(o),p=D.parse(o));let f,y=t.width??t.schWidth??void 0,g=t.height??t.schHeight??void 0;(y===void 0||g===void 0)&&(f=ES(i.childNodes.map(T=>ket(e,T)).filter(T=>T!==null),{alignItems:l,justifyContent:c,direction:a,rowGap:u,columnGap:p}),y=f.width,g=f.height);let v=new Iw(y,g,{alignItems:l,justifyContent:c,direction:a,rowGap:u,columnGap:p});for(let T of i.childNodes){let I=ket(e,T);v.addChild({metadata:T,width:I?.width??0,height:I?.height??0,flexBasis:I?a==="row"?I.width:I.height:void 0})}v.build();let P={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0,width:0,height:0};for(let T of v.children)P.minX=Math.min(P.minX,T.position.x),P.minY=Math.min(P.minY,T.position.y),P.maxX=Math.max(P.maxX,T.position.x+T.size.width),P.maxY=Math.max(P.maxY,T.position.y+T.size.height);P.width=P.maxX-P.minX,P.height=P.maxY-P.minY;let w={x:-(P.maxX+P.minX)/2,y:-(P.maxY+P.minY)/2},k=e.toArray();for(let T of v.children){let{sourceComponent:I,sourceGroup:E}=T.metadata;if(I){let N=e.schematic_component.getWhere({source_component_id:I.source_component_id});if(!N)continue;uq(k,N.schematic_component_id,{x:T.position.x+T.size.width/2+w.x,y:T.position.y+T.size.height/2+w.y})}if(E){if(!e.schematic_group.getWhere({source_group_id:E.source_group_id}))continue;hq(k,E.source_group_id,{x:T.position.x+T.size.width/2+w.x,y:T.position.y+T.size.height/2+w.y})}}n.schematic_group_id&&e.schematic_group.update(n.schematic_group_id,{width:P.width,height:P.height})},ZA=1;function xLt(n){let{db:e}=n.root,t=n._parsedProps,i=bLt(n);if(i.length===0)return;let r=vLt({db:e,pcbChildren:i}),s=SLt(t),o=wLt({props:t,pcbChildren:i,childDimensions:r,gridConfig:s}),a=TLt({pcbChildren:i,childDimensions:r,gridLayout:o,gridConfig:s}),{itemCoordinates:c}=a.layout();ELt({db:e,group:n,pcbChildren:i,itemCoordinates:c,gridLayout:o}),MLt({db:e,group:n,props:t,gridLayout:o})}function bLt(n){return n.children.filter(e=>e.pcb_component_id||e.pcb_group_id)}function vLt(n){let{db:e,pcbChildren:t}=n,i=0,r=0;for(let s of t){let o=0,a=0;if(s.pcb_group_id){let c=e.pcb_group.get(s.pcb_group_id);o=c?.width??0,a=c?.height??0}else if(s.pcb_component_id){let c=e.pcb_component.get(s.pcb_component_id);o=c?.width??0,a=c?.height??0}i=Math.max(i,o),r=Math.max(r,a)}return{width:i,height:r}}function SLt(n){let e=n.pcbGridCols??n.gridCols??n.pcbLayout?.grid?.cols,t=n.pcbGridRows??n.pcbLayout?.grid?.rows,i=n.pcbGridTemplateColumns,r=n.pcbGridTemplateRows,s=p=>p===void 0?ZA:typeof p=="number"?p:D.parse(p),o=n.pcbGridGap??n.gridGap??n.pcbLayout?.gridGap,a=n.pcbGridRowGap??n.gridRowGap??n.pcbLayout?.gridRowGap,c=n.pcbGridColumnGap??n.gridColumnGap??n.pcbLayout?.gridColumnGap,l=ZA,u=ZA;if(a!==void 0||c!==void 0){let p=typeof o=="object"?o?.x:o,f=typeof o=="object"?o?.y:o;l=s(c??p),u=s(a??f)}else if(typeof o=="object"&&o!==null)l=s(o.x),u=s(o.y);else{let p=s(o);l=p,u=p}return{cols:e,rows:t,gapX:l,gapY:u,templateColumns:i,templateRows:r}}function wLt(n){let{props:e,pcbChildren:t,childDimensions:i,gridConfig:r}=n;return e.pcbGridTemplateColumns||e.pcbGridTemplateRows?PLt({props:e,gridConfig:r,pcbChildren:t,childDimensions:i}):kLt({gridConfig:r,pcbChildren:t,childDimensions:i})}function PLt(n){let{props:e,gridConfig:t,pcbChildren:i,childDimensions:r}=n,s=e.pcbGridTemplateColumns??"",o=e.pcbGridTemplateRows??"",a=f=>{let y=f.match(/repeat\((\d+),/);return y?parseInt(y[1]):Math.ceil(Math.sqrt(i.length))},c=e.pcbGridTemplateColumns?a(s):Math.ceil(Math.sqrt(i.length)),l=e.pcbGridTemplateRows?a(o):Math.ceil(i.length/c),u=c*r.width+Math.max(0,c-1)*t.gapX,p=l*r.height+Math.max(0,l-1)*t.gapY;return{gridTemplateColumns:s,gridTemplateRows:o,containerWidth:u,containerHeight:p}}function kLt(n){let{gridConfig:e,pcbChildren:t,childDimensions:i}=n,r,s;e.cols!==void 0&&e.rows!==void 0?(r=e.cols,s=e.rows):e.cols!==void 0?(r=e.cols,s=Math.ceil(t.length/r)):e.rows!==void 0?(s=e.rows,r=Math.ceil(t.length/s)):(r=Math.ceil(Math.sqrt(t.length)),s=Math.ceil(t.length/r)),r=Math.max(1,r),s=Math.max(1,s);let o=r*i.width+Math.max(0,r-1)*e.gapX,a=s*i.height+Math.max(0,s-1)*e.gapY,c=`repeat(${r}, ${i.width}px)`,l=`repeat(${s}, ${i.height}px)`;return{gridTemplateColumns:c,gridTemplateRows:l,containerWidth:o,containerHeight:a}}function TLt(n){let{pcbChildren:e,childDimensions:t,gridLayout:i,gridConfig:r}=n,s=e.map((o,a)=>({key:o.getString()||`child-${a}`,contentWidth:t.width,contentHeight:t.height}));return new hQ({containerWidth:i.containerWidth,containerHeight:i.containerHeight,gridTemplateColumns:i.gridTemplateColumns,gridTemplateRows:i.gridTemplateRows,gap:[r.gapY,r.gapX],children:s})}function ELt(n){let{db:e,group:t,pcbChildren:i,itemCoordinates:r,gridLayout:s}=n,o=t._getGlobalPcbPositionBeforeLayout(),a=e.toArray();for(let c=0;c<i.length;c++){let l=i[c],u=l.getString()||`child-${c}`,p=r[u];if(!p){console.warn(`PCB grid layout: No coordinates found for child ${u}`);continue}let f=o.x-s.containerWidth/2+p.x+p.width/2,y=o.y+s.containerHeight/2-p.y-p.height/2;if(l.pcb_component_id)kS(a,l.pcb_component_id,{x:f,y});else{let g=l;g.pcb_group_id&&g.source_group_id&&TS(a,g.source_group_id,{x:f,y})}}}function MLt(n){let{db:e,group:t,props:i,gridLayout:r}=n;if(t.pcb_group_id){let s=t._getGlobalPcbPositionBeforeLayout();e.pcb_group.update(t.pcb_group_id,{width:i.width??r.containerWidth,height:i.height??r.containerHeight,center:s})}}function CLt(n){let e={serverUrl:"https://registry-api.tscircuit.com",serverMode:"job",serverCacheEnabled:!0};if(typeof n=="object"&&!n.preset)return{local:!(n.serverUrl||n.serverMode||n.serverCacheEnabled),...e,...n};let t=typeof n=="object"?n.preset:n,i=typeof n=="object"?n:{};switch(typeof t=="string"?t.replace(/_/g,"-"):t){case"auto-local":return{local:!0,groupMode:"subcircuit"};case"sequential-trace":return{local:!0,groupMode:"sequential-trace"};case"subcircuit":return{local:!0,groupMode:"subcircuit"};case"auto-cloud":{let{preset:s,local:o,groupMode:a,...c}=i;return{local:!1,groupMode:"subcircuit",...e,...c}}case"laser-prefab":{let{preset:s,local:o,groupMode:a,...c}=i;return{local:!0,groupMode:"subcircuit",preset:"laser_prefab",...c}}default:return{local:!0,groupMode:"subcircuit"}}}var ILt=(n,e)=>{let t=n.children.filter(p=>p.componentName==="Constraint"&&p._parsedProps.pcb),i=new Map,r={},s=p=>(r[p]!==p&&(r[p]=s(r[p])),r[p]),o=(p,f)=>{let y=s(p),g=s(f);y!==g&&(r[g]=y)},a=p=>{p in r||(r[p]=p)},c=p=>{let f=p.startsWith(".")?p.slice(1):p;return n.children.find(g=>g.name===f)?.pcb_component_id??void 0};for(let p of t){let f=p._parsedProps;if("left"in f&&"right"in f){let y=c(f.left),g=c(f.right);y&&g&&(a(y),a(g),o(y,g))}else if("top"in f&&"bottom"in f){let y=c(f.top),g=c(f.bottom);y&&g&&(a(y),a(g),o(y,g))}else if("for"in f&&Array.isArray(f.for)){let y=f.for.map(g=>c(g)).filter(g=>!!g);for(let g of y)a(g);for(let g=1;g<y.length;g++)o(y[0],y[g])}}for(let p of Object.keys(r)){let f=s(p);i.has(f)||i.set(f,{componentIds:[],constraints:[]}),i.get(f).componentIds.push(p)}for(let p of t){let f=p._parsedProps,y;if("left"in f?y=c(f.left):"top"in f?y=c(f.top):"for"in f&&(y=c(f.for[0])),!y)continue;let g=s(y);i.get(g)?.constraints.push(p)}let l={},u=Object.fromEntries(e.components.map(p=>[p.componentId,p]));for(let[p,f]of i.entries()){if(f.componentIds.length<=1)continue;let y=new i_,g={},x=(A,R)=>{let j=`${A}_${R}`;return g[j]||(g[j]=new Ia(j)),g[j]},v=f.componentIds[0];y.addConstraint(new ki(x(v,"x"),oi.Eq,0,On.required)),y.addConstraint(new ki(x(v,"y"),oi.Eq,0,On.required));for(let A of f.constraints){let R=A._parsedProps;if("xDist"in R){let j=c(R.left),B=c(R.right);j&&B&&y.addConstraint(new ki(new Dn(x(B,"x"),[-1,x(j,"x")]),oi.Eq,R.xDist,On.required))}else if("yDist"in R){let j=c(R.top),B=c(R.bottom);j&&B&&y.addConstraint(new ki(new Dn(x(j,"y"),[-1,x(B,"y")]),oi.Eq,R.yDist,On.required))}else if("sameX"in R&&Array.isArray(R.for)){let j=R.for.map(B=>c(B)).filter(B=>!!B);if(j.length>1){let B=x(j[0],"x");for(let G=1;G<j.length;G++)y.addConstraint(new ki(new Dn(x(j[G],"x"),[-1,B]),oi.Eq,0,On.required))}}else if("sameY"in R&&Array.isArray(R.for)){let j=R.for.map(B=>c(B)).filter(B=>!!B);if(j.length>1){let B=x(j[0],"y");for(let G=1;G<j.length;G++)y.addConstraint(new ki(new Dn(x(j[G],"y"),[-1,B]),oi.Eq,0,On.required))}}}y.updateVariables();let P={};for(let A of f.componentIds)P[A]={x:x(A,"x").value(),y:x(A,"y").value()};let w=1/0,k=1/0,T=-1/0,I=-1/0;for(let A of f.componentIds){let R=u[A],j=P[A];if(R)for(let B of R.pads){let G=j.x+B.offset.x,U=j.y+B.offset.y;w=Math.min(w,G-B.size.x/2),T=Math.max(T,G+B.size.x/2),k=Math.min(k,U-B.size.y/2),I=Math.max(I,U+B.size.y/2)}}let E={x:(w+T)/2,y:(k+I)/2},N=[],M={};for(let A of f.componentIds){let R=u[A],j=P[A];if(R){M[A]={x:j.x-E.x,y:j.y-E.y};for(let B of R.pads)N.push({padId:B.padId,networkId:B.networkId,type:B.type,size:B.size,offset:{x:j.x+B.offset.x-E.x,y:j.y+B.offset.y-E.y}})}}e.components=e.components.filter(A=>!f.componentIds.includes(A.componentId)),e.components.push({componentId:f.componentIds[0],pads:N,availableRotationDegrees:[0]}),f.relativeCenters=M,l[f.componentIds[0]]=f}return l},Tet=({db:n,pcbComponentId:e,rotationDegrees:t,layer:i})=>{if(t==null||!n?.cad_component?.list)return;let r=n.cad_component.getWhere({pcb_component_id:e});if(!r)return;let s=i?.toLowerCase?.()==="bottom"?-t:t,o=r.rotation?.z??0,a={...r.rotation??{x:0,y:0,z:0},z:sd(o+s)};n.cad_component.update(r.cad_component_id,{rotation:a}),r.rotation=a},$1=(n,e,t)=>{if(e===t)return!0;let i=n.source_group.get(e);return!i||!i.parent_source_group_id?!1:$1(n,i.parent_source_group_id,t)},NLt=(n,e,t)=>{let{db:i}=n.root;for(let r of e.components){let{center:s,componentId:o,ccwRotationOffset:a,ccwRotationDegrees:c}=r,l=t[o];if(l){let v=c??a??0,P=v*Math.PI/180;for(let w of l.componentIds){let k=l.relativeCenters[w];if(!k)continue;let T={x:k.x*Math.cos(P)-k.y*Math.sin(P),y:k.x*Math.sin(P)+k.y*Math.cos(P)},I=i.pcb_component.get(w);if(!I)continue;let E=I.center,N=_i(n._computePcbGlobalTransformBeforeLayout(),Rn(s.x+T.x,s.y+T.y),$c(P),Rn(-E.x,-E.y)),M=i.toArray().filter(A=>"pcb_component_id"in A&&A.pcb_component_id===w);s_(M,N),Tet({db:i,pcbComponentId:w,rotationDegrees:v,layer:I.layer})}continue}let u=i.pcb_component.get(o);if(u){let v=n.source_group_id,w=i.source_component.get(u.source_component_id)?.source_group_id;if(w!==void 0&&!$1(i,w,v))continue;let k=u.center,T=c??a??0,I=_i(n._computePcbGlobalTransformBeforeLayout(),Rn(s.x,s.y),$c(T*Math.PI/180),Rn(-k.x,-k.y)),E=i.toArray().filter(N=>"pcb_component_id"in N&&N.pcb_component_id===o);s_(E,I),Tet({db:i,pcbComponentId:o,rotationDegrees:T,layer:u.layer});continue}let p=i.pcb_group.list().find(v=>v.source_group_id===o);if(!p)continue;let f=p.center,y=c??a??0,g=_i(n._computePcbGlobalTransformBeforeLayout(),Rn(s.x,s.y),$c(y*Math.PI/180),Rn(-f.x,-f.y)),x=i.toArray().filter(v=>{if("source_group_id"in v&&v.source_group_id&&(v.source_group_id===o||$1(i,v.source_group_id,o)))return!0;if("source_component_id"in v&&v.source_component_id){let P=i.source_component.get(v.source_component_id);if(P?.source_group_id&&(P.source_group_id===o||$1(i,P.source_group_id,o)))return!0}if("pcb_component_id"in v&&v.pcb_component_id){let P=i.pcb_component.get(v.pcb_component_id);if(P?.source_component_id){let w=i.source_component.get(P.source_component_id);if(w?.source_group_id&&(w.source_group_id===o||$1(i,w.source_group_id,o)))return!0}}return!1});s_(x,g),i.pcb_group.update(p.pcb_group_id,{center:s})}};function ALt(n){switch(n.shape){case"rect":case"rotated_rect":case"pill":case"rotated_pill":return{width:n.width,height:n.height};case"circle":return{width:n.radius*2,height:n.radius*2};case"polygon":if(!n.points||n.points.length===0)return null;let e=n.points.map(a=>a.x),t=n.points.map(a=>a.y),i=Math.min(...e),r=Math.max(...e),s=Math.min(...t),o=Math.max(...t);return{width:r-i,height:o-s};default:return null}}function RLt(n){switch(n.shape){case"circular_hole_with_rect_pad":case"pill_hole_with_rect_pad":case"rotated_pill_hole_with_rect_pad":return{width:n.rect_pad_width,height:n.rect_pad_height};case"circle":return{width:n.outer_diameter,height:n.outer_diameter};case"oval":return{width:n.outer_width,height:n.outer_height};case"pill":return{width:n.outer_width,height:n.outer_height};case"hole_with_polygon_pad":if(!("pad_outline"in n)||!n.pad_outline||n.pad_outline.length===0)return null;let e=n.pad_outline.map(a=>a.x),t=n.pad_outline.map(a=>a.y),i=Math.min(...e),r=Math.max(...e),s=Math.min(...t),o=Math.max(...t);return{width:r-i,height:o-s};default:return null}}var OLt="1mm",Eet=(0,lnt.default)("Group_doInitialPcbLayoutPack"),LLt=n=>{let{db:e}=n.root,{_parsedProps:t}=n,{packOrderStrategy:i,packPlacementStrategy:r,gap:s,pcbGap:o,pcbPackGap:a}=t,c=a??o??s,l=D.parse(c??OLt),u={},p=new Set,f=T=>{if(T?.pcb_component_id&&T?._parsedProps){let I=T._parsedProps,E=D.parse(I.pcbMarginLeft??I.pcbMarginX??0),N=D.parse(I.pcbMarginRight??I.pcbMarginX??0),M=D.parse(I.pcbMarginTop??I.pcbMarginY??0),A=D.parse(I.pcbMarginBottom??I.pcbMarginY??0);(E||N||M||A)&&(u[T.pcb_component_id]={left:E,right:N,top:M,bottom:A})}T?.children&&T.children.forEach(f)};f(n);let y=new Set;for(let T of n.children){let I=T;I._isNormalComponent&&I.isRelativelyPositioned?.()&&(I.pcb_component_id&&p.add(I.pcb_component_id),I.pcb_group_id&&y.add(I.pcb_group_id))}let g=e.toArray().filter(T=>T.type==="pcb_component"?!p.has(T.pcb_component_id):T.type==="pcb_group"?!y.has(T.pcb_group_id):!0),x=[];for(let T of p){let I=e.toArray().find(R=>R.type==="pcb_component"&&R.pcb_component_id===T);if(!I)continue;let E=I.center.x,N=I.center.y,M=e.toArray().filter(R=>R.type==="pcb_smtpad"&&R.pcb_component_id===T);for(let R of M){let j=ALt(R);if(!j||j.width===0||j.height===0)continue;let B,G;if(R.shape==="polygon"){let U=R.points.map(tt=>tt.x),H=R.points.map(tt=>tt.y);B=E+(Math.min(...U)+Math.max(...U))/2,G=N+(Math.min(...H)+Math.max(...H))/2}else B=E+R.x,G=N+R.y;x.push({obstacleId:R.pcb_smtpad_id,absoluteCenter:{x:B,y:G},width:j.width,height:j.height})}let A=e.toArray().filter(R=>R.type==="pcb_plated_hole"&&R.pcb_component_id===T);for(let R of A){let j=RLt(R);if(!j||j.width===0||j.height===0)continue;let B=E+R.x,G=N+R.y;x.push({obstacleId:R.pcb_plated_hole_id,absoluteCenter:{x:B,y:G},width:j.width,height:j.height})}}let v;if(t.width!==void 0&&t.height!==void 0){let T=D.parse(t.width),I=D.parse(t.height);v={minX:-T/2,maxX:T/2,minY:-I/2,maxY:I/2}}let P={...eQ(tQ(g,{source_group_id:n.source_group_id,shouldAddInnerObstacles:!0,chipMarginsMap:u})),orderStrategy:i??"largest_to_smallest",placementStrategy:r??"minimum_sum_squared_distance_to_network",minGap:l,obstacles:x,bounds:v},w=ILt(n,P);Eet.enabled&&(n.root?.emit("debug:logOutput",{type:"debug:logOutput",name:`packInput-circuitjson-${n.name}`,content:JSON.stringify(e.toArray())}),n.root?.emit("debug:logOutput",{type:"debug:logOutput",name:`packInput-${n.name}`,content:P}));let k=Ew(P);if(Eet.enabled&&global?.debugGraphics){let T=sA(k);T.title=`packOutput-${n.name}`,global.debugGraphics?.push(T)}NLt(n,k,w)},FLt=n=>{let{db:e}=n.root,{_parsedProps:t}=n,i=n.children.filter(I=>I.pcb_component_id||I.pcb_group_id);if(i.some(I=>{let E=I._parsedProps;return E?.pcbX!==void 0||E?.pcbY!==void 0}))return;let s=t.pcbJustifyContent??t.justifyContent,o=t.pcbAlignItems??t.alignItems,a=t.pcbFlexGap??t.pcbGap??t.gap,c=t.pcbFlexDirection??"row",l={start:"flex-start",end:"flex-end","flex-start":"flex-start","flex-end":"flex-end",stretch:"space-between","space-between":"space-between","space-around":"space-around","space-evenly":"space-evenly",center:"center"}[s??"space-between"],u={start:"flex-start",end:"flex-end","flex-start":"flex-start","flex-end":"flex-end",stretch:"stretch",center:"center"}[o??"center"];if(!l)throw new Error(`Invalid justifyContent value: "${s}"`);if(!u)throw new Error(`Invalid alignItems value: "${o}"`);let p=0,f=0;typeof a=="object"?(p=a.y??0,f=a.x??0):typeof a=="number"?(p=a,f=a):typeof a=="string"&&(p=D.parse(a),f=D.parse(a));let y,g=t.width??t.pcbWidth??void 0,x=t.height??t.pcbHeight??void 0;(g===void 0||x===void 0)&&(y=ES(i.map(I=>I._getMinimumFlexContainerSize()).filter(I=>I!==null),{alignItems:u,justifyContent:l,direction:c,rowGap:p,columnGap:f}),g=y.width,x=y.height);let P=new Iw(g,x,{alignItems:u,justifyContent:l,direction:c,rowGap:p,columnGap:f});for(let I of i){let E=I._getMinimumFlexContainerSize();P.addChild({metadata:I,width:E?.width??0,height:E?.height??0,flexBasis:E?c==="row"?E.width:E.height:void 0})}P.build();let w={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0,width:0,height:0};for(let I of P.children)w.minX=Math.min(w.minX,I.position.x),w.minY=Math.min(w.minY,I.position.y),w.maxX=Math.max(w.maxX,I.position.x+I.size.width),w.maxY=Math.max(w.maxY,I.position.y+I.size.height);w.width=w.maxX-w.minX,w.height=w.maxY-w.minY;let k=n._getGlobalPcbPositionBeforeLayout(),T={x:k.x-(w.maxX+w.minX)/2,y:k.y-(w.maxY+w.minY)/2};for(let I of P.children)I.metadata._repositionOnPcb({x:I.position.x+I.size.width/2+T.x,y:I.position.y+I.size.height/2+T.y});e.pcb_group.update(n.pcb_group_id,{width:w.width,height:w.height,center:k})};function zLt(n){let{db:e}=n.root,t=new Map,i=new Map,r=new Set,o=n.selectAll("trace").filter(R=>R._parsedProps?.schDisplayLabel),a=n.selectAll("group"),c=[n.schematic_group_id,...a.map(R=>R.schematic_group_id)],l=e.schematic_component.list().filter(R=>c.includes(R.schematic_group_id)),u=[],p=new Map,f=new Map;for(let R of l){let j=R.schematic_component_id,B=[],G=e.source_component.getWhere({source_component_id:R.source_component_id}),U=e.schematic_port.list({schematic_component_id:R.schematic_component_id});for(let H of U){let tt=`${G?.name??R.schematic_component_id}.${H.pin_number}`;p.set(tt,H.schematic_port_id),f.set(H.schematic_port_id,tt)}for(let H of U){let tt=f.get(H.schematic_port_id);B.push({pinId:tt,x:H.center.x,y:H.center.y})}u.push({chipId:j,center:R.center,width:R.size.width,height:R.size.height,pins:B})}let y=new Set,g=new Map,x=new Map,v=new Map;for(let R of l){let j=e.schematic_port.list({schematic_component_id:R.schematic_component_id});for(let B of j)y.add(B.schematic_port_id),B.source_port_id&&(g.set(B.schematic_port_id,B.source_port_id),x.set(B.source_port_id,B.schematic_port_id))}let P=new Set;n.subcircuit_id&&P.add(n.subcircuit_id);for(let R of a)R.subcircuit_id&&P.add(R.subcircuit_id);let k=e.source_trace.list().filter(R=>{if(R.subcircuit_id===n.subcircuit_id)return!0;for(let j of R.connected_source_port_ids)if(x.has(j))return!0;return!1}).flatMap(R=>R.connected_source_net_ids);for(let R of k){let j=e.source_net.get(R);j?.subcircuit_id&&P.add(j.subcircuit_id)}let T=[],I=new Map;for(let R of e.source_trace.list()){if(R.subcircuit_id&&!P.has(R.subcircuit_id))continue;let j=(R.connected_source_port_ids??[]).map(B=>x.get(B)).filter(B=>!!B&&y.has(B));if(j.length>=2){let[B,G]=j.slice(0,2),U=[B,G].sort().join("::");if(!I.has(U)){I.set(U,R.source_trace_id);let H=R.display_name??R.source_trace_id;R.subcircuit_connectivity_map_key&&(r.add(R.subcircuit_connectivity_map_key),v.set(H,R.subcircuit_connectivity_map_key),i.set(R.subcircuit_connectivity_map_key,H)),T.push({pinIds:[B,G].map(tt=>f.get(tt)),netId:H})}}}let E=[];for(let R of e.source_net.list().filter(j=>!j.subcircuit_id||P.has(j.subcircuit_id)))R.subcircuit_connectivity_map_key&&(r.add(R.subcircuit_connectivity_map_key),t.set(R.subcircuit_connectivity_map_key,R));let N=new Map;for(let[R,j]of g){let B=e.source_port.get(j);if(!B?.subcircuit_connectivity_map_key)continue;let G=B.subcircuit_connectivity_map_key;r.add(G),N.has(G)||N.set(G,[]),N.get(G).push(R)}for(let[R,j]of N){let B=t.get(R);if(B&&j.length>=2){let G=String(B.name||B.source_net_id||R);v.set(G,R),i.set(R,G);let H=.1*(.18/.18),tt=Number((String(G).length*H).toFixed(2));E.push({netId:G,pinIds:j.map(et=>f.get(et)),netLabelWidth:tt})}}let M=(()=>{let R={},j=new Set(E.map(B=>B.netId));for(let B of e.source_net.list().filter(G=>!G.subcircuit_id||P.has(G.subcircuit_id)))B.name&&j.has(B.name)&&(B.is_ground||B.name.toLowerCase().startsWith("gnd")?R[B.name]=["y-"]:B.is_power||B.name.toLowerCase().startsWith("v")?R[B.name]=["y+"]:R[B.name]=["x-","x+"]);return R})();return{inputProblem:{chips:u,directConnections:T,netConnections:E,availableNetLabelOrientations:M,maxMspPairDistance:n._parsedProps.schMaxTraceDistance??2.4},pinIdToSchematicPortId:p,pairKeyToSourceTraceId:I,sckToSourceNet:t,sckToUserNetId:i,userNetIdToSck:v,allSourceAndSchematicPortIdsInScope:y,schPortIdToSourcePortId:g,displayLabelTraces:o,allScks:r}}var xr=1e-6;function Met(n){let e=Math.abs(n.to.x-n.from.x),t=Math.abs(n.to.y-n.from.y);return e>=t}function tP(n,e){return Math.hypot(e.x-n.x,e.y-n.y)}function Cet(n,e,t){return{x:n.x+(e.x-n.x)*t,y:n.y+(e.y-n.y)*t}}function Iet(n,e,t){let i=tP(n,e);if(i<xr)return 0;let r=((t.x-n.x)*(e.x-n.x)+(t.y-n.y)*(e.y-n.y))/((e.x-n.x)*(e.x-n.x)+(e.y-n.y)*(e.y-n.y));return Math.max(0,Math.min(1,r))*i}function Gw(n,e,t,i){return n*i-e*t}function $Lt(n,e,t,i){let r={x:e.x-n.x,y:e.y-n.y},s={x:i.x-t.x,y:i.y-t.y},o=Gw(r.x,r.y,s.x,s.y),a={x:t.x-n.x,y:t.y-n.y},c=Gw(a.x,a.y,r.x,r.y);if(Math.abs(o)<xr&&Math.abs(c)<xr||Math.abs(o)<xr&&Math.abs(c)>=xr)return null;let l=Gw(a.x,a.y,s.x,s.y)/o,u=Gw(a.x,a.y,r.x,r.y)/o;return l<-xr||l>1+xr||u<-xr||u>1+xr?null:{x:n.x+l*r.x,y:n.y+l*r.y}}function DLt(n,e=xr){if(n.length===0)return n;n.sort((r,s)=>r.start-s.start);let t=[],i={...n[0]};for(let r=1;r<n.length;r++){let s=n[r];s.start<=i.end+e?i.end=Math.max(i.end,s.end):(t.push(i),i={...s})}return t.push(i),t}function jLt(n,e,t){let i=tP(n.from,n.to);if(i<xr||e.length===0)return[n];let r=t/2,s=e.map(p=>({start:Math.max(0,p-r),end:Math.min(i,p+r)})).filter(p=>p.end-p.start>xr),o=DLt(s),a=[],c=0,l={x:n.to.x-n.from.x,y:n.to.y-n.from.y},u=(p,f,y)=>{if(f-p<=xr)return;let g=p/i,x=f/i;a.push({from:Cet(n.from,n.to,g),to:Cet(n.from,n.to,x),...y?{is_crossing:!0}:{}})};for(let p of o)p.start-c>xr&&u(c,p.start,!1),u(p.start,p.end,!0),c=p.end;return i-c>xr&&u(c,i,!1),a.length>0?a:[n]}function BLt(n,e={}){let t=e.crossSegmentLength??.075,i=e.tolerance??xr,r=new Map,s=c=>`${c.traceIdx}:${c.edgeIdx}`,o=c=>n[c.traceIdx].edges[c.edgeIdx];for(let c=0;c<n.length;c++){let l=n[c];for(let u=0;u<l.edges.length;u++){let p=l.edges[u];for(let f=c;f<n.length;f++){let y=n[f];for(let g=f===c?u+1:0;g<y.edges.length;g++){let x=y.edges[g],v=$Lt(p.from,p.to,x.from,x.to);if(!v)continue;let P=tP(p.from,p.to),w=tP(x.from,x.to);if(P<i||w<i)continue;let k=Iet(p.from,p.to,v),T=Iet(x.from,x.to,v),I=k<=i||Math.abs(P-k)<=i||Number.isNaN(k),E=T<=i||Math.abs(w-T)<=i||Number.isNaN(T);if(!I&&!E){let N=Met(p),M=Met(x),A;if(N!==M)A=N;else{let B=Math.abs(p.to.x-p.from.x),G=Math.abs(p.to.y-p.from.y),U=Math.abs(x.to.x-x.from.x),H=Math.abs(x.to.y-x.from.y),tt=B-G,et=U-H;A=tt===et?!0:tt>et}let R=s({traceIdx:A?c:f,edgeIdx:A?u:g}),j=r.get(R)??[];j.push(A?k:T),r.set(R,j)}}}}}let a=n.map(c=>({source_trace_id:c.source_trace_id,edges:[]}));for(let c=0;c<n.length;c++){let l=n[c];for(let u=0;u<l.edges.length;u++){let p=s({traceIdx:c,edgeIdx:u}),f=r.get(p)??[];if(f.length===0){a[c].edges.push(l.edges[u]);continue}let y=Array.from(new Set(f.map(x=>Number(x.toFixed(6))))).sort((x,v)=>x-v),g=jLt(l.edges[u],y,t);a[c].edges.push(...g)}}return a}var Ho=1e-6;function eP(n,e,t=Ho){return Math.abs(n-e)<=t}function q_(n,e,t=Ho){return eP(n.x,e.x,t)&&eP(n.y,e.y,t)}function Net(n,e,t,i=Ho){let r=Math.min(e.x,t.x)-i,s=Math.max(e.x,t.x)+i,o=Math.min(e.y,t.y)-i,a=Math.max(e.y,t.y)+i;return n.x<r||n.x>s||n.y<o||n.y>a?!1:Math.abs((t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x))<=i}function Aet(n,e=Ho){let t=new Map;for(let i of n){let r=`${i.x.toFixed(6)},${i.y.toFixed(6)}`;t.has(r)||t.set(r,i)}return Array.from(t.values())}function Ret(n){return{x:n.to.x-n.from.x,y:n.to.y-n.from.y}}function KA(n,e,t=Ho){let i=Ret(n),r=Ret(e),s=Math.hypot(i.x,i.y),o=Math.hypot(r.x,r.y);if(s<t||o<t)return!0;let a=i.x*r.y-i.y*r.x;return Math.abs(a)<=t*s*o}function D1(n,e,t=Ho){return n.edges.filter(i=>q_(i.from,e,t)||q_(i.to,e,t))}function Oet(n,e,t=Ho){for(let i of n.edges){if(q_(i.from,e,t))return i.from;if(q_(i.to,e,t))return i.to}return null}function YLt(n,e,t=Ho){let i=q_(n.from,e,t)||eP(n.from.x,e.x,t)&&eP(n.from.y,e.y,t)?n.to:n.from,r=i.x-e.x,s=i.y-e.y;return Math.abs(r)<t&&Math.abs(s)<t?null:Math.abs(r)>=Math.abs(s)?r>=0?"right":"left":s>=0?"up":"down"}function X_(n,e,t=Ho){let i=D1(n,e,t);if(i.length<2)return null;let r=i.map(p=>YLt(p,e,t)),s=r.includes("up"),o=r.includes("down"),a=r.includes("left"),c=r.includes("right"),l=s?"up":o?"down":null,u=c?"right":a?"left":null;return l&&u?`${l}-${u}`:null}function XLt(n,e={}){let t=e.tolerance??Ho,i={};for(let s of n)i[s.source_trace_id]=[];let r=n.map(s=>{let o=[];for(let a of s.edges)o.push(a.from,a.to);return Aet(o,t)});for(let s=0;s<n.length;s++){let o=n[s],a=r[s];for(let c=s+1;c<n.length;c++){let l=n[c],u=r[c];for(let p of a)for(let f of u)if(q_(p,f,t)){let y=D1(o,p,t),g=D1(l,f,t),x=y.some(k=>g.some(T=>!KA(k,T,t))),v=X_(o,p,t),P=X_(l,f,t);x&&!(v!==null&&P!==null&&v===P)&&(i[o.source_trace_id].push(p),o.source_trace_id!==l.source_trace_id&&i[l.source_trace_id].push(f))}for(let p of a)for(let f of l.edges)if(Net(p,f.from,f.to,t)){let g=D1(o,p,t).some(k=>!KA(k,f,t)),x=X_(o,p,t),v=Oet(l,p,t*1e3),P=v?X_(l,v,t):null;g&&!(x!==null&&P!==null&&x===P)&&(i[o.source_trace_id].push(p),o.source_trace_id!==l.source_trace_id&&i[l.source_trace_id].push(p))}for(let p of u)for(let f of o.edges)if(Net(p,f.from,f.to,t)){let g=D1(l,p,t).some(k=>!KA(f,k,t)),x=X_(l,p,t),v=Oet(o,p,t*1e3),P=v?X_(o,v,t):null;g&&!(P!==null&&x!==null&&P===x)&&(i[l.source_trace_id].push(p),o.source_trace_id!==l.source_trace_id&&i[o.source_trace_id].push(p))}}}for(let s of Object.keys(i))i[s]=Aet(i[s],t);return i}var JA=(0,pnt.default)("Group_doInitialSchematicTraceRender");function ULt(n){let{group:e,solver:t,pinIdToSchematicPortId:i,userNetIdToSck:r}=n,{db:s}=e.root,o=t.traceCleanupSolver?.getOutput().traces??t.traceLabelOverlapAvoidanceSolver?.getOutput().traces??t.schematicTraceLinesSolver?.solvedTracePaths,a=[];JA(`Traces inside SchematicTraceSolver output: ${(o??[]).length}`);for(let u of o??[]){let p=u?.tracePath;if(!Array.isArray(p)||p.length<2){JA(`Skipping trace ${u?.pinIds.join(",")} because it has less than 2 points`);continue}let f=[];for(let x=0;x<p.length-1;x++)f.push({from:{x:p[x].x,y:p[x].y},to:{x:p[x+1].x,y:p[x+1].y}});let y=null,g;if(Array.isArray(u?.pins)&&u.pins.length===2){let x=i.get(u.pins[0]?.pinId),v=i.get(u.pins[1]?.pinId);if(x&&v){for(let P of[x,v])s.schematic_port.get(P)&&s.schematic_port.update(P,{is_connected:!0});g=r.get(String(u.userNetId))}}y||(y=`solver_${u?.mspPairId}`,g=r.get(String(u.userNetId))),a.push({source_trace_id:y,edges:f,subcircuit_connectivity_map_key:g})}JA(`Applying ${a.length} traces from SchematicTraceSolver output`);let c=BLt(a.map(u=>({source_trace_id:u.source_trace_id,edges:u.edges}))),l=XLt(c);for(let u of c)s.schematic_trace.insert({source_trace_id:u.source_trace_id,edges:u.edges,junctions:l[u.source_trace_id]??[],subcircuit_connectivity_map_key:a.find(p=>p.source_trace_id===u.source_trace_id)?.subcircuit_connectivity_map_key})}var VLt=n=>{switch(n){case"x+":return"left";case"x-":return"right";case"y+":return"bottom";case"y-":return"top";case"left":return"right";case"top":return"bottom";case"right":return"left";case"bottom":return"top"}},GLt=n=>{for(let t of n){let i=t._getDirectlyConnectedTraces();for(let r of i){let s=r._parsedProps.schDisplayLabel;if(s)return{name:s,wasAssignedDisplayLabel:!0}}}return{name:n.map(t=>t._getNetLabelText()).join("/"),wasAssignedDisplayLabel:!1}},QA=(0,hnt.default)("Group_doInitialSchematicTraceRender");function HLt(n){let{group:e,solver:t,sckToSourceNet:i,allScks:r,allSourceAndSchematicPortIdsInScope:s,schPortIdToSourcePortId:o,userNetIdToSck:a,pinIdToSchematicPortId:c,schematicPortIdsWithPreExistingNetLabels:l,schematicPortIdsWithRoutedTraces:u}=n,{db:p}=e.root,f=t.netLabelPlacementSolver?.netLabelPlacements??t.traceLabelOverlapAvoidanceSolver?.getOutput().netLabelPlacements??[],y=t.mspConnectionPairSolver.globalConnMap;for(let g of f){QA(`processing placement: ${g.netId}`);let x=y.getIdsConnectedToNet(g.globalConnNetId).find(R=>a.get(R)),v=a.get(x),P=g.anchorPoint,w=g.orientation,k=VLt(w),T=v?i.get(v):void 0,I=g.pinIds.map(R=>c.get(R));if(I.some(R=>l.has(R))){QA(`skipping net label placement for "${g.netId}" REASON:schematic port has pre-existing net label`);continue}if(T){let R=T.name,j=ml({anchor_position:P,anchor_side:k,text:R});p.schematic_net_label.insert({text:R,anchor_position:P,center:j,anchor_side:k,...T?.source_net_id?{source_net_id:T.source_net_id}:{}});continue}let E=e.selectAll("port").filter(R=>R._getSubcircuitConnectivityKey()===v),{name:N,wasAssignedDisplayLabel:M}=GLt(E);if(!M&&I.some(R=>u.has(R))){QA(`skipping net label placement for "${g.netId}" REASON:schematic port has routed traces and no display label`);continue}let A=ml({anchor_position:P,anchor_side:k,text:N});p.schematic_net_label.insert({text:N,anchor_position:P,center:A,anchor_side:k})}}var WLt=({allSourceAndSchematicPortIdsInScope:n,group:e,schPortIdToSourcePortId:t,sckToSourceNet:i,pinIdToSchematicPortId:r,schematicPortIdsWithPreExistingNetLabels:s})=>{let{db:o}=e.root;for(let a of Array.from(n)){let c=o.schematic_port.get(a);if(!c||c.is_connected)continue;let l=t.get(a);if(!l)continue;let p=o.source_port.get(l)?.subcircuit_connectivity_map_key;if(!p)continue;let f=i.get(p);if(!f||o.schematic_net_label.list().some(P=>Math.abs(P.anchor_position.x-c.center.x)<.1&&Math.abs(P.anchor_position.y-c.center.y)<.1?f.source_net_id&&P.source_net_id?P.source_net_id===f.source_net_id:P.text===(f.name||p):!1))continue;let g=f.name||f.source_net_id||p,x=X1(c.facing_direction||"right")||"right",v=ml({anchor_position:c.center,anchor_side:x,text:g});o.schematic_net_label.insert({text:g,anchor_position:c.center,center:v,anchor_side:x,...f.source_net_id?{source_net_id:f.source_net_id}:{}})}},qLt=n=>{let e=new Set,t=n.selectAll("netlabel");for(let i of t){let r=i._getConnectedPorts();for(let s of r)s.schematic_port_id&&e.add(s.schematic_port_id)}return e},ZLt=({solver:n,pinIdToSchematicPortId:e})=>{let t=n.schematicTraceLinesSolver.solvedTracePaths,i=new Set;for(let r of t)for(let s of r.pinIds){let o=e.get(s);o&&i.add(o)}return i},KLt=(0,unt.default)("Group_doInitialSchematicTraceRender"),JLt=n=>{if(!n.root?._featureMspSchematicTraceRouting||!n.isSubcircuit||n.root?.schematicDisabled)return;let{inputProblem:e,pinIdToSchematicPortId:t,pairKeyToSourceTraceId:i,sckToSourceNet:r,allSourceAndSchematicPortIdsInScope:s,schPortIdToSourcePortId:o,displayLabelTraces:a,allScks:c,userNetIdToSck:l}=zLt(n),u=qLt(n);KLt.enabled&&n.root?.emit("debug:logOutput",{type:"debug:logOutput",name:"group-trace-render-input-problem",content:JSON.stringify(e,null,2)});let p=new IQ(e);p.solve();let f=ZLt({solver:p,pinIdToSchematicPortId:t});ULt({group:n,solver:p,pinIdToSchematicPortId:t,userNetIdToSck:l}),HLt({group:n,solver:p,sckToSourceNet:r,allSourceAndSchematicPortIdsInScope:s,schPortIdToSourcePortId:o,pinIdToSchematicPortId:t,allScks:c,userNetIdToSck:l,schematicPortIdsWithPreExistingNetLabels:u,schematicPortIdsWithRoutedTraces:f}),WLt({group:n,allSourceAndSchematicPortIdsInScope:s,schPortIdToSourcePortId:o,sckToSourceNet:r,pinIdToSchematicPortId:t,schematicPortIdsWithPreExistingNetLabels:u})},QLt=()=>({async simulate(n){let e="spice-experiment-1",{circuit:t,tran:i}=OQ(n);return{simulationResultCircuitJson:LQ(i,t,e)}}}),Let=["rgb(132, 0, 0)","rgb(194, 194, 0)","rgb(194, 0, 194)","rgb(194, 0, 0)","rgb(0, 132, 132)","rgb(0, 132, 0)","rgb(0, 0, 132)","rgb(132, 132, 132)","rgb(132, 0, 132)","rgb(194, 194, 194)","rgb(132, 0, 132)","rgb(132, 0, 0)","rgb(132, 132, 0)","rgb(194, 194, 194)","rgb(0, 0, 132)","rgb(0, 132, 0)"],qw=new Map,Zw=0;function t7t(n){if(qw.has(n))return qw.get(n);let e=Let[Zw];return Zw=(Zw+1)%Let.length,qw.set(n,e),e}function e7t(){qw.clear(),Zw=0}var Ya=(0,dnt.default)("tscircuit:core:Group_doInitialSimulationSpiceEngineRender");function n7t(n){if(!n.isSubcircuit)return;let{root:e}=n;if(!e)return;let t=n.selectAll("analogsimulation");if(t.length===0)return;let i=n.selectAll("voltageprobe");e7t();let r={...e.platform?.spiceEngineMap};r.spicey||(r.spicey=QLt());let s=e.db.toArray(),o,a;try{a=AQ(s),o=a.toSpiceString(),Ya(`Generated SPICE string:
${o}`)}catch(c){Ya(`Failed to convert circuit JSON to SPICE: ${c}`);return}for(let c of t){let l=c._parsedProps.spiceEngine??"spicey",u=r[l];if(!u)throw new Error(`SPICE engine "${l}" not found in platform config. Available engines: ${JSON.stringify(Object.keys(r).filter(f=>f!=="spicey"))}`);let p=`spice-simulation-${l}-${c.source_component_id}`;Ya(`Queueing simulation for spice engine: ${l} (id: ${p})`),n._queueAsyncEffect(p,async()=>{try{Ya(`Running simulation with engine: ${l}`);let f=await u.simulate(o);Ya(`Simulation completed, received ${f.simulationResultCircuitJson.length} elements`);let y=e.db.simulation_experiment.list()[0];if(!y){Ya("No simulation experiment found, skipping result insertion");return}for(let g of f.simulationResultCircuitJson){if(g.type==="simulation_transient_voltage_graph"){g.simulation_experiment_id=y.simulation_experiment_id;let v=i.find(P=>P.finalProbeName===g.name);v&&(g.color=v.color)}let x=g.type;x&&e.db[x]?(e.db[x].insert(g),Ya(`Inserted ${x} into database`)):(Ya(`Warning: Unknown element type ${x}, adding to raw db`),e.db._addElement(g))}n._markDirty("SimulationSpiceEngineRender")}catch(f){Ya(`Simulation failed for engine ${l}: ${f}`);let y=e.db.simulation_experiment.list()[0];e.db.simulation_unknown_experiment_error.insert({simulation_experiment_id:y?.simulation_experiment_id,error_type:"simulation_unknown_experiment_error",message:f instanceof Error?f.message:String(f)})}})}}function i7t(n){if(n.root?.pcbDisabled||!n.pcb_group_id)return;let e=n._parsedProps?.pcbPositionAnchor;if(!e)return;let t=n._getGlobalPcbPositionBeforeLayout(),{pcbX:i,pcbY:r}=n._parsedProps;if(i===void 0&&r===void 0)return;let{db:s}=n.root,o=s.pcb_group.get(n.pcb_group_id);if(!o)return;let a=o.width,c=o.height,{center:l}=o;if(o.outline&&o.outline.length>0){let x=Oo(o.outline);x&&(a=x.maxX-x.minX,c=x.maxY-x.minY)}if(!a||!c)return;let u={left:l.x-a/2,right:l.x+a/2,top:l.y+c/2,bottom:l.y-c/2},p={...l},f=null;if(new Set(["center","top_left","top_center","top_right","center_left","center_right","bottom_left","bottom_center","bottom_right"]).has(e))switch(e){case"center":f=p;break;case"top_left":f={x:u.left,y:u.top};break;case"top_center":f={x:p.x,y:u.top};break;case"top_right":f={x:u.right,y:u.top};break;case"center_left":f={x:u.left,y:p.y};break;case"center_right":f={x:u.right,y:p.y};break;case"bottom_left":f={x:u.left,y:u.bottom};break;case"bottom_center":f={x:p.x,y:u.bottom};break;case"bottom_right":f={x:u.right,y:u.bottom};break}if(!f)return;let g={...p};t.x!==void 0&&(g.x+=t.x-f.x),t.y!==void 0&&(g.y+=t.y-f.y),(Math.abs(g.x-p.x)>1e-6||Math.abs(g.y-p.y)>1e-6)&&(n._repositionOnPcb(g),s.pcb_group.update(n.pcb_group_id,{center:g})),s.pcb_group.update(n.pcb_group_id,{anchor_position:t,anchor_alignment:e})}var _l=class extends Hn{constructor(){super(...arguments);d(this,"pcb_group_id",null);d(this,"schematic_group_id",null);d(this,"subcircuit_id",null);d(this,"_hasStartedAsyncAutorouting",!1);d(this,"_asyncAutoroutingResult",null);d(this,"unnamedElementCounter",{})}get config(){return{zodProps:TH,componentName:"Group"}}doInitialSourceGroupRender(){let{db:e}=this.root,t=typeof this._parsedProps.name=="string"&&this._parsedProps.name.length>0,i=e.source_group.insert({name:this.name,is_subcircuit:this.isSubcircuit,was_automatically_named:!t});this.source_group_id=i.source_group_id,this.isSubcircuit&&(this.subcircuit_id=`subcircuit_${i.source_group_id}`,e.source_group.update(i.source_group_id,{subcircuit_id:this.subcircuit_id}))}doInitialSourceRender(){let{db:e}=this.root;for(let t of this.children)e.source_component.update(t.source_component_id,{source_group_id:this.source_group_id})}doInitialSourceParentAttachment(){let{db:e}=this.root,t=this.parent?.getGroup?.();if(t?.source_group_id&&e.source_group.update(this.source_group_id,{parent_source_group_id:t.source_group_id}),!this.isSubcircuit)return;let i=this.parent?.getSubcircuit?.()?.subcircuit_id;i&&e.source_group.update(this.source_group_id,{parent_subcircuit_id:i})}doInitialPcbComponentRender(){if(this.root?.pcbDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,i=t,r=i.outline&&i.outline.length>0,s=r?i.outline.map(a=>({x:Y.parse(a.x),y:Y.parse(a.y)})):void 0,o=e.pcb_group.insert({is_subcircuit:this.isSubcircuit,subcircuit_id:this.subcircuit_id??this.getSubcircuit()?.subcircuit_id,name:this.name,center:this._getGlobalPcbPositionBeforeLayout(),...r?{outline:s}:{width:0,height:0},pcb_component_ids:[],source_group_id:this.source_group_id,autorouter_configuration:t.autorouter?{trace_clearance:t.autorouter.traceClearance}:void 0});this.pcb_group_id=o.pcb_group_id;for(let a of this.children)e.pcb_component.update(a.pcb_component_id,{pcb_group_id:o.pcb_group_id})}doInitialPcbPrimitiveRender(){if(this.root?.pcbDisabled)return;let{db:e}=this.root,t=this._parsedProps,i=t.outline&&t.outline.length>0;if(this.pcb_group_id){let r=this._parsedProps.pcbX!==void 0||this._parsedProps.pcbY!==void 0;if(i){let p=t.outline.map(v=>({x:Y.parse(v.x),y:Y.parse(v.y)})),f=Oo(p);if(!f)return;let y=(f.minX+f.maxX)/2,g=(f.minY+f.maxY)/2,x=r?e.pcb_group.get(this.pcb_group_id)?.center??{x:y,y:g}:{x:y,y:g};e.pcb_group.update(this.pcb_group_id,{center:x});return}let s=rP(this.children),o=s.width,a=s.height,c=(s.minX+s.maxX)/2,l=(s.minY+s.maxY)/2;if(this.isSubcircuit){let{padLeft:p,padRight:f,padTop:y,padBottom:g}=this._resolvePcbPadding();o+=p+f,a+=y+g,c+=(f-p)/2,l+=(y-g)/2}let u=r?e.pcb_group.get(this.pcb_group_id)?.center??{x:c,y:l}:{x:c,y:l};e.pcb_group.update(this.pcb_group_id,{width:Number(t.width??o),height:Number(t.height??a),center:u})}}getNextAvailableName(e){var t,i;return(t=this.unnamedElementCounter)[i=e.lowercaseComponentName]??(t[i]=1),`unnamed_${e.lowercaseComponentName}${this.unnamedElementCounter[e.lowercaseComponentName]++}`}_resolvePcbPadding(){let e=this._parsedProps,t=e.pcbLayout,i=p=>{let f=t?.[p],y=e[p];if(typeof f=="number")return f;if(typeof y=="number")return y},r=i("padding")??0,s=i("paddingX"),o=i("paddingY"),a=i("paddingLeft")??s??r,c=i("paddingRight")??s??r,l=i("paddingTop")??o??r,u=i("paddingBottom")??o??r;return{padLeft:a,padRight:c,padTop:l,padBottom:u}}doInitialCreateTraceHintsFromProps(){let{_parsedProps:e}=this,{db:t}=this.root,i=e;if(!this.isSubcircuit)return;let r=i.manualEdits?.manual_trace_hints;if(r)for(let s of r)this.add(new m9({for:s.pcb_port_selector,offsets:s.offsets}))}doInitialSourceAddConnectivityMapKey(){_Lt(this)}_areChildSubcircuitsRouted(){let e=this.selectAll("group").filter(t=>t.isSubcircuit);for(let t of e)if(t._shouldRouteAsync()&&!t._asyncAutoroutingResult)return!1;return!0}_shouldRouteAsync(){let e=this._getAutorouterConfig();return e.groupMode==="sequential-trace"?!1:!!(e.local&&e.groupMode==="subcircuit"||!e.local)}_hasTracesToRoute(){let e=(0,U_.default)("tscircuit:core:_hasTracesToRoute"),t=this.selectAll("trace");return e(`[${this.getString()}] has ${t.length} traces to route`),t.length>0}async _runEffectMakeHttpAutoroutingRequest(){let{db:e}=this.root,t=(0,U_.default)("tscircuit:core:_runEffectMakeHttpAutoroutingRequest"),i=this._parsedProps,r=this._getAutorouterConfig(),s=r.serverUrl,o=r.serverMode,a=(u,p)=>(t("fetching",u),p.headers&&(p.headers["Tscircuit-Core-Version"]=this.root?.getCoreVersion()),fetch(u,p)),c=this.root.db.toArray().filter(u=>u.type.startsWith("source_")||u.type.startsWith("pcb_"));if(o==="solve-endpoint"){if(this.props.autorouter?.inputFormat==="simplified"){let{autorouting_result:p}=await a(`${s}/autorouting/solve`,{method:"POST",body:JSON.stringify({input_simple_route_json:a9({db:e,minTraceWidth:this.props.autorouter?.minTraceWidth??.15,subcircuit_id:this.subcircuit_id}).simpleRouteJson,subcircuit_id:this.subcircuit_id}),headers:{"Content-Type":"application/json"}}).then(f=>f.json());this._asyncAutoroutingResult=p,this._markDirty("PcbTraceRender");return}let{autorouting_result:u}=await a(`${s}/autorouting/solve`,{method:"POST",body:JSON.stringify({input_circuit_json:c,subcircuit_id:this.subcircuit_id}),headers:{"Content-Type":"application/json"}}).then(p=>p.json());this._asyncAutoroutingResult=u,this._markDirty("PcbTraceRender");return}let{autorouting_job:l}=await a(`${s}/autorouting/jobs/create`,{method:"POST",body:JSON.stringify({input_circuit_json:c,provider:"freerouting",autostart:!0,display_name:this.root?.name,subcircuit_id:this.subcircuit_id,server_cache_enabled:r.serverCacheEnabled}),headers:{"Content-Type":"application/json"}}).then(u=>u.json());for(;;){let{autorouting_job:u}=await a(`${s}/autorouting/jobs/get`,{method:"POST",body:JSON.stringify({autorouting_job_id:l.autorouting_job_id}),headers:{"Content-Type":"application/json"}}).then(p=>p.json());if(u.is_finished){let{autorouting_job_output:p}=await a(`${s}/autorouting/jobs/get_output`,{method:"POST",body:JSON.stringify({autorouting_job_id:l.autorouting_job_id}),headers:{"Content-Type":"application/json"}}).then(f=>f.json());this._asyncAutoroutingResult={output_pcb_traces:p.output_pcb_traces},this._markDirty("PcbTraceRender");break}if(u.has_error){let p=new z1(`Autorouting job failed: ${JSON.stringify(u.error)}`);throw e.pcb_autorouting_error.insert({pcb_error_id:l.autorouting_job_id,error_type:"pcb_autorouting_error",message:p.message}),p}await new Promise(p=>setTimeout(p,100))}}async _runLocalAutorouting(){let{db:e}=this.root,t=this._parsedProps,i=(0,U_.default)("tscircuit:core:_runLocalAutorouting");i(`[${this.getString()}] starting local autorouting`);let r=this._getAutorouterConfig(),s=this._isLaserPrefabAutorouter(r),{simpleRouteJson:o}=a9({db:e,minTraceWidth:this.props.autorouter?.minTraceWidth??.15,subcircuit_id:this.subcircuit_id});if(i.enabled&&global.debugOutputArray?.push({name:`simpleroutejson-${this.props.name}.json`,obj:o}),i.enabled){let l=Vg(o);l.title=`autorouting-${this.props.name}`,global.debugGraphics?.push(l)}this.root?.emit("autorouting:start",{subcircuit_id:this.subcircuit_id,componentDisplayName:this.getString(),simpleRouteJson:o});let a;r.algorithmFn?a=await r.algorithmFn(o):a=new aLt(o,{capacityDepth:this.props.autorouter?.capacityDepth,targetMinCapacity:this.props.autorouter?.targetMinCapacity,useAssignableViaSolver:s});let c=new Promise((l,u)=>{a.on("complete",p=>{i(`[${this.getString()}] local autorouting complete`),l(p.traces)}),a.on("error",p=>{i(`[${this.getString()}] local autorouting error: ${p.error.message}`),u(p.error)})});a.on("progress",l=>{this.root?.emit("autorouting:progress",{subcircuit_id:this.subcircuit_id,componentDisplayName:this.getString(),...l})}),a.start();try{let l=await c;this._asyncAutoroutingResult={output_pcb_traces:l},this._markDirty("PcbTraceRender")}catch(l){let{db:u}=this.root;throw u.pcb_autorouting_error.insert({pcb_error_id:`pcb_autorouter_error_subcircuit_${this.subcircuit_id}`,error_type:"pcb_autorouting_error",message:l instanceof Error?l.message:String(l)}),this.root?.emit("autorouting:error",{subcircuit_id:this.subcircuit_id,componentDisplayName:this.getString(),error:{message:l instanceof Error?l.message:String(l)},simpleRouteJson:o}),l}finally{a.stop()}}_startAsyncAutorouting(){this._hasStartedAsyncAutorouting||(this._hasStartedAsyncAutorouting=!0,this._getAutorouterConfig().local?this._queueAsyncEffect("capacity-mesh-autorouting",async()=>this._runLocalAutorouting()):this._queueAsyncEffect("make-http-autorouting-request",async()=>this._runEffectMakeHttpAutoroutingRequest()))}doInitialPcbTraceRender(){let e=(0,U_.default)("tscircuit:core:doInitialPcbTraceRender");if(this.isSubcircuit&&!this.root?.pcbDisabled&&!this.getInheritedProperty("routingDisabled")&&!this._shouldUseTraceByTraceRouting()){if(!this._areChildSubcircuitsRouted()){e(`[${this.getString()}] child subcircuits are not routed, skipping async autorouting until subcircuits routed`);return}e(`[${this.getString()}] no child subcircuits to wait for, initiating async routing`),this._hasTracesToRoute()&&this._startAsyncAutorouting()}}doInitialSchematicTraceRender(){JLt(this)}updatePcbTraceRender(){let e=(0,U_.default)("tscircuit:core:updatePcbTraceRender");if(e(`[${this.getString()}] updating...`),!this.isSubcircuit)return;if(this._shouldRouteAsync()&&this._hasTracesToRoute()&&!this._hasStartedAsyncAutorouting){this._areChildSubcircuitsRouted()&&(e(`[${this.getString()}] child subcircuits are now routed, starting async autorouting`),this._startAsyncAutorouting());return}if(!this._asyncAutoroutingResult||this._shouldUseTraceByTraceRouting())return;let{db:t}=this.root;if(this._asyncAutoroutingResult.output_simple_route_json){e(`[${this.getString()}] updating PCB traces from simple route json (${this._asyncAutoroutingResult.output_simple_route_json.traces?.length} traces)`),this._updatePcbTraceRenderFromSimpleRouteJson();return}if(this._asyncAutoroutingResult.output_pcb_traces){e(`[${this.getString()}] updating PCB traces from ${this._asyncAutoroutingResult.output_pcb_traces.length} traces`),this._updatePcbTraceRenderFromPcbTraces();return}}_updatePcbTraceRenderFromSimpleRouteJson(){let{db:e}=this.root,{traces:t}=this._asyncAutoroutingResult.output_simple_route_json;if(t)for(let i of t){let r=e.pcb_trace.insert({subcircuit_id:this.subcircuit_id,route:i.route})}}_updatePcbTraceRenderFromPcbTraces(){let{output_pcb_traces:e}=this._asyncAutoroutingResult;if(!e)return;let{db:t}=this.root;for(let i of e)if(i.type==="pcb_trace"){if(i.subcircuit_id=this.subcircuit_id,i.connection_name){let r=i.connection_name;i.source_trace_id=r}t.pcb_trace.insert(i)}for(let i of e)if(i.type!=="pcb_via"&&i.type==="pcb_trace")for(let r of i.route)r.route_type==="via"&&t.pcb_via.insert({pcb_trace_id:i.pcb_trace_id,x:r.x,y:r.y,hole_diameter:.3,outer_diameter:.6,layers:[r.from_layer,r.to_layer],from_layer:r.from_layer,to_layer:r.to_layer})}doInitialSchematicComponentRender(){if(this.root?.schematicDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,i=e.schematic_group.insert({is_subcircuit:this.isSubcircuit,subcircuit_id:this.subcircuit_id,name:this.name,center:this._getGlobalSchematicPositionBeforeLayout(),width:0,height:0,schematic_component_ids:[],source_group_id:this.source_group_id});this.schematic_group_id=i.schematic_group_id;for(let r of this.children)r.schematic_component_id&&e.schematic_component.update(r.schematic_component_id,{schematic_group_id:i.schematic_group_id})}_getSchematicLayoutMode(){let e=this._parsedProps;if(e.schLayout?.layoutMode==="none"||e.schLayout?.layoutMode==="relative")return"relative";if(e.schLayout?.matchAdapt)return"match-adapt";if(e.schLayout?.flex)return"flex";if(e.schLayout?.grid)return"grid";if(e.schMatchAdapt)return"match-adapt";if(e.schFlex)return"flex";if(e.schGrid)return"grid";if(e.matchAdapt)return"match-adapt";if(e.flex)return"flex";if(e.grid)return"grid";if(e.relative||e.schRelative)return"relative";let t=this.children.some(r=>{let s=r._parsedProps;return s?.schX!==void 0||s?.schY!==void 0}),i=(e.manualEdits?.schematic_placements?.length??0)>0;return!t&&!i?"match-adapt":"relative"}doInitialSchematicLayout(){let e=this._getSchematicLayoutMode();e==="match-adapt"&&this._doInitialSchematicLayoutMatchpack(),e==="grid"&&this._doInitialSchematicLayoutGrid(),e==="flex"&&this._doInitialSchematicLayoutFlex(),this._insertSchematicBorder()}_doInitialSchematicLayoutMatchAdapt(){dLt(this)}_doInitialSchematicLayoutMatchpack(){mLt(this)}_doInitialSchematicLayoutGrid(){yLt(this)}_doInitialSchematicLayoutFlex(){gLt(this)}_getPcbLayoutMode(){let e=this._parsedProps;if(e.pcbRelative)return"none";if(e.pcbLayout?.matchAdapt)return"match-adapt";if(e.pcbLayout?.flex)return"flex";if(e.pcbLayout?.grid)return"grid";if(e.pcbLayout?.pack)return"pack";if(e.pcbFlex)return"flex";if(e.pcbGrid)return"grid";if(e.pcbPack||e.pack)return"pack";if(e.matchAdapt)return"match-adapt";if(e.flex)return"flex";if(e.grid)return"grid";let t=e.pcbX!==void 0||e.pcbY!==void 0,i=(e.manualEdits?.pcb_placements?.length??0)>0,r=this.children.reduce((s,o)=>{if(!o.pcb_component_id&&!o.pcb_group_id)return s;let a=o._parsedProps,c=a?.pcbX!==void 0||a?.pcbY!==void 0;return s+(c?0:1)},0);return!t&&!i&&r>1?"pack":"none"}doInitialPcbLayout(){let e=this._getPcbLayoutMode();e==="grid"?this._doInitialPcbLayoutGrid():e==="pack"?this._doInitialPcbLayoutPack():e==="flex"&&this._doInitialPcbLayoutFlex()}_doInitialPcbLayoutGrid(){xLt(this)}_doInitialPcbLayoutPack(){LLt(this)}_doInitialPcbLayoutFlex(){FLt(this)}_insertSchematicBorder(){if(this.root?.schematicDisabled)return;let{db:e}=this.root,t=this._parsedProps;if(!t.border)return;let i=typeof t.schWidth=="number"?t.schWidth:void 0,r=typeof t.schHeight=="number"?t.schHeight:void 0,s=typeof t.schPadding=="number"?t.schPadding:0,o=typeof t.schPaddingLeft=="number"?t.schPaddingLeft:s,a=typeof t.schPaddingRight=="number"?t.schPaddingRight:s,c=typeof t.schPaddingTop=="number"?t.schPaddingTop:s,l=typeof t.schPaddingBottom=="number"?t.schPaddingBottom:s,u=this.schematic_group_id?e.schematic_group.get(this.schematic_group_id):null;if(u&&(i===void 0&&typeof u.width=="number"&&(i=u.width),r===void 0&&typeof u.height=="number"&&(r=u.height)),i===void 0||r===void 0)return;let p=u?.center??this._getGlobalSchematicPositionBeforeLayout(),f=p.x-i/2-o,y=p.y-r/2-l,g=i+o+a,x=r+c+l;e.schematic_box.insert({width:g,height:x,x:f,y,is_dashed:t.border?.dashed??!1})}_determineSideFromPosition(e,t){if(!e.center||!t.center)return"left";let i=e.center.x-t.center.x,r=e.center.y-t.center.y;return Math.abs(i)>Math.abs(r)?i>0?"right":"left":r>0?"bottom":"top"}_calculateSchematicBounds(e){if(e.length===0)return{minX:0,maxX:0,minY:0,maxY:0};let t=1/0,i=-1/0,r=1/0,s=-1/0;for(let a of e)t=Math.min(t,a.centerX),i=Math.max(i,a.centerX),r=Math.min(r,a.centerY),s=Math.max(s,a.centerY);let o=2;return{minX:t-o,maxX:i+o,minY:r-o,maxY:s+o}}_getAutorouterConfig(){let e=this._parsedProps.autorouter||this.getInheritedProperty("autorouter");return CLt(e)}_isLaserPrefabAutorouter(e=this._getAutorouterConfig()){let t=this.props.autorouter,i=r=>r?.replace(/-/g,"_")??r;return e.preset==="laser_prefab"?!0:typeof t=="string"?i(t)==="laser_prefab":typeof t=="object"&&t?i(t.preset)==="laser_prefab":!1}_getSubcircuitLayerCount(){let e=this.getInheritedProperty("layers");return typeof e=="number"?e:2}_shouldUseTraceByTraceRouting(){return this._getAutorouterConfig().groupMode==="sequential-trace"}doInitialPcbDesignRuleChecks(){if(this.root?.pcbDisabled||this.getInheritedProperty("routingDisabled"))return;let{db:e}=this.root;if(this.isSubcircuit){let t=new Map;for(let i of this.children)if(!i.isSubcircuit&&i._parsedProps.name){let r=t.get(i._parsedProps.name)||[];r.push(i),t.set(i._parsedProps.name,r)}for(let[i,r]of t.entries())r.length>1&&e.pcb_trace_error.insert({error_type:"pcb_trace_error",message:`Multiple components found with name "${i}" in subcircuit "${this.name||"unnamed"}". Component names must be unique within a subcircuit.`,source_trace_id:"",pcb_trace_id:"",pcb_component_ids:r.map(s=>s.pcb_component_id).filter(Boolean),pcb_port_ids:[]})}}doInitialSchematicReplaceNetLabelsWithSymbols(){if(this.root?.schematicDisabled||!this.isSubcircuit)return;let{db:e}=this.root,t=e;for(let i of t.schematic_net_label.list()){let r=t.source_net.get(i.source_net_id),s=i.text||r?.name||"";if(i.anchor_side==="top"&&/^gnd/i.test(s)){t.schematic_net_label.update(i.schematic_net_label_id,{symbol_name:"rail_down"});continue}i.anchor_side==="bottom"&&/^v/i.test(s)&&t.schematic_net_label.update(i.schematic_net_label_id,{symbol_name:"rail_up"})}}doInitialSimulationSpiceEngineRender(){n7t(this)}doInitialPcbComponentAnchorAlignment(){i7t(this)}updatePcbComponentAnchorAlignment(){this.doInitialPcbComponentAnchorAlignment()}_getMinimumFlexContainerSize(){return super._getMinimumFlexContainerSize()}_repositionOnPcb(e){return super._repositionOnPcb(e)}},r7t=.01,Fet=(n,e,t)=>{let i=n/2,r=e/2,s=Math.min(t,i,r);if(s<r7t)return[{x:-i,y:-r},{x:i,y:-r},{x:i,y:r},{x:-i,y:r}];let a=Math.max(1,Math.ceil(Math.PI/2*s/.1)),c=Math.PI/2/a,l=[];l.push({x:-i+s,y:-r}),l.push({x:i-s,y:-r});for(let u=1;u<=a;u++){let p=-Math.PI/2+u*c;l.push({x:i-s+s*Math.cos(p),y:-r+s+s*Math.sin(p)})}l.push({x:i,y:r-s});for(let u=1;u<=a;u++){let p=0+u*c;l.push({x:i-s+s*Math.cos(p),y:r-s+s*Math.sin(p)})}l.push({x:-i+s,y:r});for(let u=1;u<=a;u++){let p=Math.PI/2+u*c;l.push({x:-i+s+s*Math.cos(p),y:r-s+s*Math.sin(p)})}l.push({x:-i,y:-r+s});for(let u=1;u<=a;u++){let p=Math.PI+u*c;l.push({x:-i+s+s*Math.cos(p),y:-r+s+s*Math.sin(p)})}return l},y9=class extends _l{constructor(){super(...arguments);d(this,"pcb_board_id",null);d(this,"source_board_id",null);d(this,"_drcChecksComplete",!1);d(this,"_connectedSchematicPortPairs",new Set)}get isSubcircuit(){return!0}get isGroup(){return!0}get config(){return{componentName:"Board",zodProps:l4}}get boardThickness(){let{_parsedProps:e}=this;return e.thickness??1.4}get allLayers(){return(this._parsedProps.layers??2)===4?["top","bottom","inner1","inner2"]:["top","bottom"]}_getSubcircuitLayerCount(){return this._parsedProps.layers??2}doInitialPcbBoardAutoSize(){if(this.root?.pcbDisabled||!this.pcb_board_id)return;let{db:e}=this.root,{_parsedProps:t}=this;if(t.width&&t.height||t.outline)return;let i=1/0,r=1/0,s=-1/0,o=-1/0,a=ont(e,this.subcircuit_id),c=new Set([this.subcircuit_id,...a]),l=e.pcb_component.list().filter(I=>I.subcircuit_id&&c.has(I.subcircuit_id)),u=e.pcb_group.list().filter(I=>I.subcircuit_id&&c.has(I.subcircuit_id)),p=!1,f=(I,E,N)=>{E===0||N===0||(p=!0,i=Math.min(i,I.x-E/2),r=Math.min(r,I.y-N/2),s=Math.max(s,I.x+E/2),o=Math.max(o,I.y+N/2))};for(let I of l)f(I.center,I.width,I.height);for(let I of u){let E=I.width??0,N=I.height??0;if(I.outline&&I.outline.length>0){let M=Oo(I.outline);M&&(E=M.maxX-M.minX,N=M.maxY-M.minY)}f(I.center,E,N)}if(t.boardAnchorPosition){let{x:I,y:E}=t.boardAnchorPosition;i=Math.min(i,I),r=Math.min(r,E),s=Math.max(s,I),o=Math.max(o,E)}let y=2,g=p?s-i+y*2:0,x=p?o-r+y*2:0,v={x:p?(i+s)/2+(t.outlineOffsetX??0):t.outlineOffsetX??0,y:p?(r+o)/2+(t.outlineOffsetY??0):t.outlineOffsetY??0},P=t.width??g,w=t.height??x,k=t.outline;!k&&t.borderRadius!=null&&P>0&&w>0&&(k=Fet(P,w,t.borderRadius));let T={width:P,height:w,center:v};k&&(T.outline=k.map(I=>({x:I.x+(t.outlineOffsetX??0),y:I.y+(t.outlineOffsetY??0)}))),e.pcb_board.update(this.pcb_board_id,T)}updatePcbBoardAutoSize(){this.doInitialPcbBoardAutoSize()}_addBoardInformationToSilkscreen(){let e=this.root?.platform;if(!e?.printBoardInformationToSilkscreen)return;let t=this.root.db.pcb_board.get(this.pcb_board_id);if(!t)return;let i=[];if(e.projectName&&i.push(e.projectName),e.version&&i.push(`v${e.version}`),e.url&&i.push(e.url),i.length===0)return;let r=i.join(`
`),a={x:t.center.x+t.width/2-.25,y:t.center.y-t.height/2+1};this.root.db.pcb_silkscreen_text.insert({pcb_component_id:this.pcb_board_id,layer:"top",font:"tscircuit2024",font_size:.45,text:r,ccw_rotation:0,anchor_alignment:"bottom_right",anchor_position:a})}doInitialSourceRender(){super.doInitialSourceRender();let{db:e}=this.root,t=e.source_board.insert({source_group_id:this.source_group_id,title:this.props.title||this.props.name});this.source_board_id=t.source_board_id}doInitialPcbComponentRender(){if(this.root?.pcbDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,i=t.width??0,r=t.height??0,s={x:(t.pcbX??0)+(t.outlineOffsetX??0),y:(t.pcbY??0)+(t.outlineOffsetY??0)},{boardAnchorPosition:o,boardAnchorAlignment:a}=t;if(o&&(s=oLt({boardAnchorPosition:o,boardAnchorAlignment:a??"center",width:i,height:r})),t.outline){let u=t.outline.map(v=>v.x),p=t.outline.map(v=>v.y),f=Math.min(...u),y=Math.max(...u),g=Math.min(...p),x=Math.max(...p);i=y-f,r=x-g,s={x:(f+y)/2+(t.outlineOffsetX??0),y:(g+x)/2+(t.outlineOffsetY??0)}}let c=t.outline;!c&&t.borderRadius!=null&&i>0&&r>0&&(c=Fet(i,r,t.borderRadius));let l=e.pcb_board.insert({center:s,thickness:this.boardThickness,num_layers:this.allLayers.length,width:i,height:r,outline:c?.map(u=>({x:u.x+(t.outlineOffsetX??0),y:u.y+(t.outlineOffsetY??0)})),material:t.material});this.pcb_board_id=l.pcb_board_id,this._addBoardInformationToSilkscreen()}removePcbComponentRender(){let{db:e}=this.root;this.pcb_board_id&&(e.pcb_board.delete(this.pcb_board_id),this.pcb_board_id=null)}_computePcbGlobalTransformBeforeLayout(){return tr()}doInitialPcbDesignRuleChecks(){this.root?.pcbDisabled||this.getInheritedProperty("routingDisabled")||super.doInitialPcbDesignRuleChecks()}updatePcbDesignRuleChecks(){if(this.root?.pcbDisabled||this.getInheritedProperty("routingDisabled"))return;let{db:e}=this.root;if(!this._areChildSubcircuitsRouted()||this._drcChecksComplete)return;this._drcChecksComplete=!0;let t=DQ(e.toArray());for(let l of t)e.pcb_trace_error.insert(l);let i=$Q(e.toArray());for(let l of i)e.pcb_port_not_connected_error.insert(l);let r=YQ(e.toArray());for(let l of r)e.pcb_component_outside_board_error.insert(l);let s=VQ(e.toArray());for(let l of s)e.pcb_trace_error.insert(l);let o=UQ(e.toArray());for(let l of o)e.pcb_via_clearance_error.insert(l);let a=XQ(e.toArray());for(let l of a)e.pcb_via_clearance_error.insert(l);let c=GQ(e.toArray());for(let l of c)e.pcb_footprint_overlap_error.insert(l)}_emitRenderLifecycleEvent(e,t){super._emitRenderLifecycleEvent(e,t),t==="start"&&this.root?.emit("board:renderPhaseStarted",{renderId:this._renderId,phase:e})}},Nn={TAB_WIDTH:4,TAB_DEPTH:.5,TAB_TO_SPACE_RATIO:5,MOUSE_BITE_DIAMETER:.2,MOUSE_BITE_SPACING:.1,MOUSE_BITES_PER_GAP:5};function s7t(n,e){let t=n.center.x-n.width/2,i=n.center.x+n.width/2,r=n.center.y-n.height/2,s=n.center.y+n.height/2,o=e.center.x-e.width/2,a=e.center.x+e.width/2,c=e.center.y-e.height/2,l=e.center.y+e.height/2;return!(i<=o||t>=a||s<=c||r>=l)}function o7t(n,e,t){let i=t.center.x-t.width/2,r=t.center.x+t.width/2,s=t.center.y-t.height/2,o=t.center.y+t.height/2,a=Math.max(i,Math.min(n.x,r)),c=Math.max(s,Math.min(n.y,o)),l=n.x-a,u=n.y-c;return l*l+u*u<=e*e}function a7t(n,e,t,i){let r=[];if(!n.width||!n.height)return r;let s=n.center.x-n.width/2,o=n.center.x+n.width/2,a=n.center.y-n.height/2,c=n.center.y+n.height/2,l,u,p;e==="top"||e==="bottom"?(l=n.width,u=!0,p=e==="top"?c:a):(l=n.height,u=!1,p=e==="right"?o:s);let f=Nn.TAB_WIDTH,g=(Nn.MOUSE_BITES_PER_GAP*Nn.MOUSE_BITE_DIAMETER+(Nn.MOUSE_BITES_PER_GAP-1)*Nn.MOUSE_BITE_SPACING)*1.1,x=Math.floor((l-g)/(f+g));if(x<1&&l>=f&&(x=1),x===0)return r;let v=g,P=-l/2,w=l/2;for(let k=0;k<x;k++){let T=P+v+k*(f+v)+f/2,I=k===0,E=k===x-1,N=I||E,M=T-f/2,A=T+f/2;if(N&&(I&&(M=P),E&&(A=w)),M=Math.max(M,P),A=Math.min(A,w),N&&(I&&(M-=Nn.TAB_DEPTH),E&&(A+=Nn.TAB_DEPTH)),A<=M)continue;let R=(M+A)/2,j=A-M,B=e==="top"||e==="right"?Nn.TAB_DEPTH/2:-Nn.TAB_DEPTH/2,G=u?{x:n.center.x+R,y:p+B}:{x:p+B,y:n.center.y+R},U=u?j:Nn.TAB_DEPTH,H=u?Nn.TAB_DEPTH:j,tt={center:G,width:U,height:H,boardId:`${n.center.x}_${n.center.y}`},et=!1;for(let mt of i){if(!mt.width||!mt.height)continue;let V={center:mt.center,width:mt.width,height:mt.height};if(s7t(tt,V)){et=!0;break}}et&&!N||r.push(tt)}return r}function c7t(n,e,t,i,r,s){let o=[];if(t.length===0||!n.width||!n.height)return o;let a=n.center.x-n.width/2,c=n.center.x+n.width/2,l=n.center.y-n.height/2,u=n.center.y+n.height/2,p=e==="top"||e==="bottom",f,y=Nn.MOUSE_BITE_DIAMETER/2;e==="top"?f=u:e==="bottom"?f=l:e==="right"?f=c:f=a;let g=[...t].sort((x,v)=>p?x.center.x-v.center.x:x.center.y-v.center.y);for(let x=0;x<g.length-1;x++){let v=g[x],P=g[x+1],w,k;p?(w=v.center.x+v.width/2,k=P.center.x-P.width/2):(w=v.center.y+v.height/2,k=P.center.y-P.height/2);let T=k-w,I=Nn.MOUSE_BITES_PER_GAP*Nn.MOUSE_BITE_DIAMETER,E=(Nn.MOUSE_BITES_PER_GAP-1)*Nn.MOUSE_BITE_SPACING;if(T<I+E)continue;let N=(w+k)/2;for(let M=0;M<Nn.MOUSE_BITES_PER_GAP;M++){let A=(M-(Nn.MOUSE_BITES_PER_GAP-1)/2)*(Nn.MOUSE_BITE_DIAMETER+Nn.MOUSE_BITE_SPACING),R=p?{x:N+A,y:f}:{x:f,y:N+A},j=Nn.MOUSE_BITE_DIAMETER/2,B=!1;for(let G of r){if(!G.width||!G.height)continue;let U={center:G.center,width:G.width,height:G.height};if(o7t(R,j,U)){B=!0;break}}B||o.push(R)}}return o}function l7t(n){let e=[],t=[];for(let s=0;s<n.length;s++){let o=n[s],a=n.filter((c,l)=>l!==s);for(let c of["top","bottom","left","right"]){let l=a7t(o,c,e,a);e.push(...l);let u=c7t(o,c,l,e,a,t);t.push(...u)}}let i=e.map((s,o)=>({type:"pcb_cutout",pcb_cutout_id:`panel_tab_${o}`,shape:"rect",center:s.center,width:s.width,height:s.height,corner_radius:.25})),r=t.map((s,o)=>({type:"pcb_hole",pcb_hole_id:`panel_mouse_bite_${o}`,hole_shape:"circle",hole_diameter:Nn.MOUSE_BITE_DIAMETER,x:s.x,y:s.y}));return{tabCutouts:i,mouseBiteHoles:r}}var fnt=class extends _l{constructor(){super(...arguments);d(this,"pcb_panel_id",null);d(this,"_tabsAndMouseBitesGenerated",!1)}get config(){return{componentName:"Panel",zodProps:EH}}get isGroup(){return!0}get isSubcircuit(){return!0}add(e){if(e.lowercaseComponentName!=="board")throw new Error("<panel> can only contain <board> elements");super.add(e)}doInitialPcbComponentAnchorAlignment(){if(this.root?.pcbDisabled)return;super.doInitialPcbComponentAnchorAlignment();let{db:e}=this.root,t=this.children.filter(c=>c instanceof y9),i=t.filter(c=>c.props.pcbX===void 0&&c.props.pcbY===void 0);if(i.length>0){let c=Math.ceil(Math.sqrt(i.length)),l=Math.ceil(i.length/c),u=Array(c).fill(0),p=Array(l).fill(0);i.forEach((M,A)=>{let R=A%c,j=Math.floor(A/c),B=e.pcb_board.get(M.pcb_board_id);!B||B.width===void 0||B.height===void 0||(u[R]=Math.max(u[R],B.width),p[j]=Math.max(p[j],B.height))});let f=u.reduce((M,A)=>M+A,0)+(c>1?(c-1)*Nn.TAB_DEPTH:0),y=p.reduce((M,A)=>M+A,0)+(l>1?(l-1)*Nn.TAB_DEPTH:0),g=-f/2,v=[-y/2];for(let M=0;M<l-1;M++)v.push(v[M]+p[M]+Nn.TAB_DEPTH);let P=[g];for(let M=0;M<c-1;M++)P.push(P[M]+u[M]+Nn.TAB_DEPTH);i.forEach((M,A)=>{let R=A%c,j=Math.floor(A/c),B=e.pcb_board.get(M.pcb_board_id);if(!B||!B.width||!B.height)return;let G=P[R]+u[R]/2,U=v[j]+p[j]/2;e.pcb_board.update(M.pcb_board_id,{center:{x:G,y:U}})});let w=t.map(M=>M.pcb_board_id).filter(M=>!!M),k=e.pcb_board.list().filter(M=>w.includes(M.pcb_board_id)),T=1/0,I=1/0,E=-1/0,N=-1/0;for(let M of k){if(M.width===void 0||M.height===void 0||!isFinite(M.width)||!isFinite(M.height))continue;let A=M.center.x-M.width/2,R=M.center.x+M.width/2,j=M.center.y-M.height/2,B=M.center.y+M.height/2;T=Math.min(T,A),E=Math.max(E,R),I=Math.min(I,j),N=Math.max(N,B)}if(isFinite(T)){let M=E-T,A=N-I,R=Nn.TAB_DEPTH*3,j=M+2*R,B=A+2*R;e.pcb_panel.update(this.pcb_panel_id,{width:j,height:B})}}if(this._tabsAndMouseBitesGenerated)return;let r=t.map(c=>c.pcb_board_id).filter(c=>!!c),s=e.pcb_board.list().filter(c=>r.includes(c.pcb_board_id));if(s.length===0)return;let{tabCutouts:o,mouseBiteHoles:a}=l7t(s);for(let c of o)e.pcb_cutout.insert(c);for(let c of a)e.pcb_hole.insert(c);this._tabsAndMouseBitesGenerated=!0}runRenderCycle(){if(!this.children.some(e=>e.componentName==="Board"))throw new Error("<panel> must contain at least one <board>");super.runRenderCycle()}doInitialPcbComponentRender(){if(super.doInitialPcbComponentRender(),this.root?.pcbDisabled)return;let{db:e}=this.root,t=this._parsedProps,i=e.pcb_panel.insert({width:Y.parse(t.width),height:Y.parse(t.height),center:this._getGlobalPcbPositionBeforeLayout(),covered_with_solder_mask:!(t.noSolderMask??!1)});this.pcb_panel_id=i.pcb_panel_id}updatePcbComponentRender(){if(this.root?.pcbDisabled||!this.pcb_panel_id)return;let{db:e}=this.root,t=this._parsedProps;e.pcb_panel.update(this.pcb_panel_id,{width:Y.parse(t.width),height:Y.parse(t.height),center:this._getGlobalPcbPositionBeforeLayout(),covered_with_solder_mask:!(t.noSolderMask??!1)})}removePcbComponentRender(){this.pcb_panel_id&&(this.root?.db.pcb_panel.delete(this.pcb_panel_id),this.pcb_panel_id=null)}},u7t=new Proxy({},{get:(n,e)=>e}),Va=u7t,sP="rgba(132, 0, 0)",oP=.12,g9=class extends Hn{constructor(){super(...arguments);d(this,"_adjustSilkscreenTextAutomatically",!0)}get config(){return{componentName:"Capacitor",schematicSymbolName:this.props.polarized?"capacitor_polarized":this.props.symbolName??"capacitor",zodProps:zH,sourceFtype:Va.simple_capacitor}}initPorts(){typeof this.props.footprint=="string"?super.initPorts({additionalAliases:{pin1:["anode","pos"],pin2:["cathode","neg"]}}):super.initPorts()}_getSchematicSymbolDisplayValue(){let e=this.props.capacitance,t=typeof e=="string"?e:`${xi(this._parsedProps.capacitance)}F`;return this._parsedProps.schShowRatings&&this._parsedProps.maxVoltageRating?`${t}/${xi(this._parsedProps.maxVoltageRating)}V`:t}doInitialCreateNetsFromProps(){this._createNetsFromProps([this.props.decouplingFor,this.props.decouplingTo,...this._getNetsFromConnectionsProp()])}doInitialCreateTracesFromProps(){this.props.decouplingFor&&this.props.decouplingTo&&(this.add(new Fs({from:`${this.getSubcircuitSelector()} > port.1`,to:this.props.decouplingFor})),this.add(new Fs({from:`${this.getSubcircuitSelector()} > port.2`,to:this.props.decouplingTo}))),this._createTracesFromConnectionsProp()}doInitialSourceRender(){let{db:e}=this.root,{_parsedProps:t}=this,i=e.source_component.insert({ftype:"simple_capacitor",name:this.name,manufacturer_part_number:t.manufacturerPartNumber??t.mfn,supplier_part_numbers:t.supplierPartNumbers,capacitance:t.capacitance,max_voltage_rating:t.maxVoltageRating,max_decoupling_trace_length:t.maxDecouplingTraceLength,display_capacitance:this._getSchematicSymbolDisplayValue(),are_pins_interchangeable:!t.polarized});this.source_component_id=i.source_component_id}},U1=class extends Hn{constructor(e){super(e);d(this,"schematicBoxDimensions",null)}get config(){return{componentName:"Chip",zodProps:n_,shouldRenderAsSchematicBox:!0}}initPorts(e={}){super.initPorts(e);let{_parsedProps:t}=this;if(t.externallyConnectedPins){let i=new Set;for(let[r,s]of t.externallyConnectedPins)i.add(r),i.add(s);for(let r of i)if(!this.children.find(o=>o instanceof Gi&&o.isMatchingAnyOf([r]))){let o=r.match(/^pin(\d+)$/);if(o){let a=parseInt(o[1]);this.add(new Gi({pinNumber:a,aliases:[r]}))}else this.add(new Gi({name:r,aliases:[r]}))}}}doInitialSchematicComponentRender(){let{_parsedProps:e}=this;e?.noSchematicRepresentation!==!0&&super.doInitialSchematicComponentRender()}doInitialSourceRender(){let{db:e}=this.root,{_parsedProps:t}=this,i=e.source_component.insert({ftype:"simple_chip",name:this.name,manufacturer_part_number:t.manufacturerPartNumber,supplier_part_numbers:t.supplierPartNumbers});this.source_component_id=i.source_component_id}doInitialPcbComponentRender(){if(this.root?.pcbDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,i=t.layer??"top";if(i!=="top"&&i!=="bottom"){let s=this.getSubcircuit(),o=Om.parse({type:"pcb_component_invalid_layer_error",message:`Component cannot be placed on layer '${i}'. Components can only be placed on 'top' or 'bottom' layers.`,source_component_id:this.source_component_id,layer:i,subcircuit_id:s.subcircuit_id??void 0});e.pcb_component_invalid_layer_error.insert(o)}let r=e.pcb_component.insert({center:{x:t.pcbX??0,y:t.pcbY??0},width:2,height:3,layer:i==="top"||i==="bottom"?i:"top",rotation:t.pcbRotation??0,source_component_id:this.source_component_id,subcircuit_id:this.getSubcircuit().subcircuit_id??void 0,do_not_place:t.doNotPlace??!1,obstructs_within_bounds:t.obstructsWithinBounds??!0});this.pcb_component_id=r.pcb_component_id}doInitialCreateTracesFromProps(){let{_parsedProps:e}=this;if(e.externallyConnectedPins)for(let[t,i]of e.externallyConnectedPins)this.add(new Fs({from:`${this.getSubcircuitSelector()} > port.${t}`,to:`${this.getSubcircuitSelector()} > port.${i}`}));this._createTracesFromConnectionsProp()}doInitialSimulationRender(){let{db:e}=this.root,{pinAttributes:t}=this.props;if(!t)return;let i=null,r=null,s,o=this.selectAll("port");for(let p of o)for(let f of p.getNameAndAliases())if(t[f]){let y=t[f];y.providesPower&&(i=p,s=y.providesVoltage),y.providesGround&&(r=p)}if(!i||!r||s===void 0)return;let a=e.source_port.get(i.source_port_id);if(!a?.subcircuit_connectivity_map_key)return;let c=e.source_port.get(r.source_port_id);if(!c?.subcircuit_connectivity_map_key)return;let l=e.source_net.getWhere({subcircuit_connectivity_map_key:a.subcircuit_connectivity_map_key}),u=e.source_net.getWhere({subcircuit_connectivity_map_key:c.subcircuit_connectivity_map_key});!l||!u||e.simulation_voltage_source.insert({type:"simulation_voltage_source",positive_source_port_id:i.source_port_id,positive_source_net_id:l.source_net_id,negative_source_port_id:r.source_port_id,negative_source_net_id:u.source_net_id,voltage:s})}},mnt=class extends U1{constructor(n){super(n)}get config(){return{...super.config,componentName:"Pinout",zodProps:MH}}doInitialSourceRender(){let{db:n}=this.root,{_parsedProps:e}=this,t=n.source_component.insert({ftype:"simple_pinout",name:this.name,manufacturer_part_number:e.manufacturerPartNumber,supplier_part_numbers:e.supplierPartNumbers});this.source_component_id=t.source_component_id}},x9=class extends Hn{constructor(){super(...arguments);d(this,"pos",this.portMap.pin1);d(this,"anode",this.portMap.pin1);d(this,"neg",this.portMap.pin2);d(this,"cathode",this.portMap.pin2)}get config(){let e={schottky:"schottky_diode",avalanche:"avalanche_diode",zener:"zener_diode",photodiode:"photodiode"},t=this.props.schottky?"schottky":this.props.avalanche?"avalanche":this.props.zener?"zener":this.props.photo?"photodiode":null;return{schematicSymbolName:t?e[t]:this.props.symbolName??"diode",componentName:"Diode",zodProps:tW,sourceFtype:"simple_diode"}}initPorts(){super.initPorts({additionalAliases:{pin1:["anode","pos","left"],pin2:["cathode","neg","right"]}})}doInitialSourceRender(){let{db:e}=this.root,{_parsedProps:t}=this,i=e.source_component.insert({ftype:"simple_diode",name:this.name,manufacturer_part_number:t.manufacturerPartNumber??t.mfn,supplier_part_numbers:t.supplierPartNumbers,are_pins_interchangeable:!1});this.source_component_id=i.source_component_id}},_nt=class extends Hn{get config(){return{componentName:"fuse",schematicSymbolName:this.props.symbolName??"fuse",zodProps:IH,sourceFtype:Va.simple_fuse}}_getSchematicSymbolDisplayValue(){let n=this._parsedProps.currentRating,e=this._parsedProps.voltageRating,t=typeof n=="string"?parseFloat(n):n,i=typeof e=="string"?parseFloat(e):e;return`${xi(t)}A / ${xi(i)}V`}doInitialSourceRender(){let{db:n}=this.root,{_parsedProps:e}=this,t=typeof e.currentRating=="string"?parseFloat(e.currentRating):e.currentRating,i=typeof e.voltageRating=="string"?parseFloat(e.voltageRating):e.voltageRating,r=n.source_component.insert({name:this.name,ftype:Va.simple_fuse,current_rating_amps:t,voltage_rating_volts:i,display_current_rating:`${xi(t)}A`,display_voltage_rating:`${xi(i)}V`});this.source_component_id=r.source_component_id}},ynt=class extends Hn{constructor(){super(...arguments);d(this,"schematicDimensions",null)}get config(){return{schematicSymbolName:void 0,componentName:"Jumper",zodProps:u4,shouldRenderAsSchematicBox:!0}}_getSchematicPortArrangement(){let e=super._getSchematicPortArrangement();if(e&&Object.keys(e).length>0)return e;let t=this._parsedProps.pinCount??(Array.isArray(this._parsedProps.pinLabels)?this._parsedProps.pinLabels.length:this._parsedProps.pinLabels?Object.keys(this._parsedProps.pinLabels).length:this.getPortsFromFootprint().length),i=this._parsedProps.schDirection??"right";return{leftSize:i==="left"?t:0,rightSize:i==="right"?t:0}}doInitialSourceRender(){let{db:e}=this.root,{_parsedProps:t}=this,i=e.source_component.insert({ftype:"simple_chip",name:this.name,manufacturer_part_number:t.manufacturerPartNumber,supplier_part_numbers:t.supplierPartNumbers,are_pins_interchangeable:!0});this.source_component_id=i.source_component_id}doInitialPcbComponentRender(){if(this.root?.pcbDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,i=e.pcb_component.insert({center:{x:t.pcbX??0,y:t.pcbY??0},width:2,height:3,layer:t.layer??"top",rotation:t.pcbRotation??0,source_component_id:this.source_component_id,subcircuit_id:this.getSubcircuit().subcircuit_id??void 0,do_not_place:t.doNotPlace??!1,obstructs_within_bounds:t.obstructsWithinBounds??!0});this.pcb_component_id=i.pcb_component_id}doInitialPcbTraceRender(){let{db:e}=this.root,t=e.pcb_port.list({pcb_component_id:this.pcb_component_id}),i={};for(let o=0;o<t.length;o++){let a=t[o],c=e.source_port.get(a.source_port_id),l="";if(typeof c?.pin_number=="number")l=c.pin_number.toString();else if(Array.isArray(c?.port_hints)){let u=c.port_hints.find(p=>/^(pin)?\d+$/.test(p));u&&(/^pin\d+$/.test(u)?l=u.replace(/^pin/,""):l=u)}i[l]=a.pcb_port_id}let r=e.pcb_trace.list({pcb_component_id:this.pcb_component_id}),s=o=>{if(o&&typeof o=="string"&&o.startsWith("{PIN")){let a=o.replace("{PIN","").replace("}","");return i[a]||o}return o};for(let o of r)if(o.route)for(let a of o.route)a.route_type==="wire"&&(a.start_pcb_port_id=s(a.start_pcb_port_id),a.end_pcb_port_id=s(a.end_pcb_port_id))}},gnt=class extends Hn{constructor(){super(...arguments);d(this,"schematicDimensions",null)}_getPinNumberFromBridgedPinName(e){return this.selectOne(`port.${e}`,{type:"port"})?._parsedProps.pinNumber??null}get defaultInternallyConnectedPinNames(){if(this._parsedProps.bridged){let e=this.children.filter(t=>t.componentName==="Port").map(t=>t.name);return e.length>0?[e]:[]}return this._parsedProps.bridgedPins??[]}get config(){let e=this._parsedProps??this.props,t=e.pinCount;if(e.pinCount==null&&!e.footprint&&(t=2),e.pinCount==null){let s=(e.bridgedPins??[]).flat().map(l=>this._getPinNumberFromBridgedPinName(l)).filter(l=>l!==null),o=s.length>0?Math.max(...s):0,a=e.pinLabels?Object.keys(e.pinLabels).length:0,c=Math.max(o,a);(c===2||c===3)&&(t=c),t==null&&e.footprint&&[2,3].includes(this.getPortsFromFootprint().length)&&(t=this.getPortsFromFootprint().length)}let i="";t?i+=`solderjumper${t}`:i="solderjumper";let r=[];return Array.isArray(e.bridgedPins)&&e.bridgedPins.length>0?r=Array.from(new Set(e.bridgedPins.flat().map(s=>this._getPinNumberFromBridgedPinName(s)).filter(s=>s!==null))).sort((s,o)=>s-o):e.bridged&&t&&(r=Array.from({length:t},(s,o)=>o+1)),r.length>0&&(i+=`_bridged${r.join("")}`),{schematicSymbolName:e.symbolName??i,componentName:"SolderJumper",zodProps:CH,shouldRenderAsSchematicBox:!0}}_getSchematicPortArrangement(){let e=super._getSchematicPortArrangement();if(e&&Object.keys(e).length>0)return e;let t=this._parsedProps.pinCount??(Array.isArray(this._parsedProps.pinLabels)?this._parsedProps.pinLabels.length:this._parsedProps.pinLabels?Object.keys(this._parsedProps.pinLabels).length:this.getPortsFromFootprint().length);t==null&&!this._parsedProps.footprint&&(t=2);let i=this._parsedProps.schDirection??"right";return{leftSize:i==="left"?t:0,rightSize:i==="right"?t:0}}doInitialSourceRender(){let{db:e}=this.root,{_parsedProps:t}=this,i=e.source_component.insert({ftype:"simple_chip",name:this.name,manufacturer_part_number:t.manufacturerPartNumber,supplier_part_numbers:t.supplierPartNumbers,are_pins_interchangeable:!0});this.source_component_id=i.source_component_id}doInitialPcbComponentRender(){if(this.root?.pcbDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,i=e.pcb_component.insert({center:{x:t.pcbX??0,y:t.pcbY??0},width:2,height:3,layer:t.layer??"top",rotation:t.pcbRotation??0,source_component_id:this.source_component_id,subcircuit_id:this.getSubcircuit().subcircuit_id??void 0,do_not_place:t.doNotPlace??!1,obstructs_within_bounds:t.obstructsWithinBounds??!0});this.pcb_component_id=i.pcb_component_id}doInitialPcbTraceRender(){let{db:e}=this.root,t=e.pcb_port.list({pcb_component_id:this.pcb_component_id}),i={};for(let o=0;o<t.length;o++){let a=t[o],c=e.source_port.get(a.source_port_id),l="";if(typeof c?.pin_number=="number")l=c.pin_number.toString();else if(Array.isArray(c?.port_hints)){let u=c.port_hints.find(p=>/^(pin)?\d+$/.test(p));u&&(/^pin\d+$/.test(u)?l=u.replace(/^pin/,""):l=u)}i[l]=a.pcb_port_id}let r=e.pcb_trace.list({pcb_component_id:this.pcb_component_id}),s=o=>{if(o&&typeof o=="string"&&o.startsWith("{PIN")){let a=o.replace("{PIN","").replace("}","");return i[a]||o}return o};for(let o of r)if(o.route)for(let a of o.route)a.route_type==="wire"&&(a.start_pcb_port_id=s(a.start_pcb_port_id),a.end_pcb_port_id=s(a.end_pcb_port_id))}},xnt=class extends Hn{constructor(){super(...arguments);d(this,"pos",this.portMap.pin1);d(this,"anode",this.portMap.pin1);d(this,"neg",this.portMap.pin2);d(this,"cathode",this.portMap.pin2)}get config(){let e={laser:"laser_diode"},t=this.props.laser?"laser":null;return{schematicSymbolName:t?e[t]:this.props.symbolName??"led",componentName:"Led",zodProps:nW,sourceFtype:"simple_led"}}initPorts(){super.initPorts({additionalAliases:{pin1:["anode","pos","left"],pin2:["cathode","neg","right"]}})}_getSchematicSymbolDisplayValue(){return this._parsedProps.schDisplayValue||this._parsedProps.color||void 0}getFootprinterString(){let e=super.getFootprinterString();return e&&this.props.color?`${e}_color(${this.props.color})`:e}doInitialSourceRender(){let{db:e}=this.root,{_parsedProps:t}=this,i=e.source_component.insert({ftype:"simple_led",name:this.name,wave_length:t.wavelength,color:t.color,symbol_display_value:this._getSchematicSymbolDisplayValue(),manufacturer_part_number:t.manufacturerPartNumber??t.mfn,supplier_part_numbers:t.supplierPartNumbers,are_pins_interchangeable:!1});this.source_component_id=i.source_component_id}},bnt=class extends Hn{constructor(){super(...arguments);d(this,"pos",this.portMap.pin1);d(this,"positive",this.portMap.pin1);d(this,"neg",this.portMap.pin2);d(this,"negative",this.portMap.pin2)}get config(){return{schematicSymbolName:this.props.symbolName??"power_factor_meter_horz",componentName:"PowerSource",zodProps:_W,sourceFtype:"simple_power_source"}}initPorts(){this.add(new Gi({name:"pin1",pinNumber:1,aliases:["positive","pos"]})),this.add(new Gi({name:"pin2",pinNumber:2,aliases:["negative","neg"]}))}doInitialSourceRender(){let{db:e}=this.root,{_parsedProps:t}=this,i=e.source_component.insert({ftype:"simple_power_source",name:this.name,voltage:t.voltage,supplier_part_numbers:t.supplierPartNumbers,are_pins_interchangeable:!1});this.source_component_id=i.source_component_id}},p7t=Jn.extend({voltage:Pi.optional(),frequency:hr.optional(),peakToPeakVoltage:Pi.optional(),waveShape:h.enum(["sinewave","square","triangle","sawtooth"]).optional(),phase:He.optional(),dutyCycle:h.number().optional()}),vnt=class extends Hn{constructor(){super(...arguments);d(this,"terminal1",this.portMap.terminal1);d(this,"terminal2",this.portMap.terminal2)}get config(){return{componentName:"VoltageSource",schematicSymbolName:this.props.waveShape==="square"?"square_wave":"ac_voltmeter",zodProps:p7t,sourceFtype:"simple_voltage_source"}}runRenderPhaseForChildren(e){if(!e.startsWith("Pcb"))for(let t of this.children)t.runRenderPhaseForChildren(e),t.runRenderPhase(e)}doInitialPcbComponentRender(){}initPorts(){super.initPorts({additionalAliases:{pin1:["terminal1"],pin2:["terminal2"]}})}doInitialSourceRender(){let{db:e}=this.root,{_parsedProps:t}=this,i=e.source_component.insert({ftype:"simple_voltage_source",name:this.name,voltage:t.voltage,frequency:t.frequency,peak_to_peak_voltage:t.peakToPeakVoltage,wave_shape:t.waveShape,phase:t.phase,duty_cycle:t.dutyCycle,supplier_part_numbers:t.supplierPartNumbers,are_pins_interchangeable:!0});this.source_component_id=i.source_component_id}doInitialSimulationRender(){let{db:e}=this.root,{_parsedProps:t}=this,i=this.portMap.terminal1,r=this.portMap.terminal2;e.simulation_voltage_source.insert({type:"simulation_voltage_source",is_dc_source:!1,terminal1_source_port_id:i.source_port_id,terminal2_source_port_id:r.source_port_id,voltage:t.voltage,frequency:t.frequency,peak_to_peak_voltage:t.peakToPeakVoltage,wave_shape:t.waveShape,phase:t.phase,duty_cycle:t.dutyCycle})}},b9=class extends Hn{constructor(){super(...arguments);d(this,"_adjustSilkscreenTextAutomatically",!0)}get config(){return{componentName:"Resistor",schematicSymbolName:this.props.symbolName??"boxresistor",zodProps:AH,sourceFtype:"simple_resistor"}}initPorts(){super.initPorts({additionalAliases:{pin1:["anode","pos","left"],pin2:["cathode","neg","right"]}})}_getSchematicSymbolDisplayValue(){return`${xi(this._parsedProps.resistance)}\u03A9`}doInitialCreateNetsFromProps(){this._createNetsFromProps([this.props.pullupFor,this.props.pullupTo,this.props.pulldownFor,this.props.pulldownTo,...this._getNetsFromConnectionsProp()])}doInitialCreateTracesFromProps(){this.props.pullupFor&&this.props.pullupTo&&(this.add(new Fs({from:`${this.getSubcircuitSelector()} > port.1`,to:this.props.pullupFor})),this.add(new Fs({from:`${this.getSubcircuitSelector()} > port.2`,to:this.props.pullupTo}))),this.props.pulldownFor&&this.props.pulldownTo&&(this.add(new Fs({from:`${this.getSubcircuitSelector()} > port.1`,to:this.props.pulldownFor})),this.add(new Fs({from:`${this.getSubcircuitSelector()} > port.2`,to:this.props.pulldownTo}))),this._createTracesFromConnectionsProp()}doInitialSourceRender(){let{db:e}=this.root,{_parsedProps:t}=this,i=e.source_component.insert({ftype:"simple_resistor",name:this.name,manufacturer_part_number:t.manufacturerPartNumber??t.mfn,supplier_part_numbers:t.supplierPartNumbers,resistance:t.resistance,display_resistance:this._getSchematicSymbolDisplayValue(),are_pins_interchangeable:!0});this.source_component_id=i.source_component_id}},h7t=["leftedge","rightedge","topedge","bottomedge","center"],Snt=class extends Ee{get config(){return{componentName:"Constraint",zodProps:DH}}constructor(n){if(super(n),("xdist"in n||"ydist"in n)&&!("edgeToEdge"in n)&&!("centerToCenter"in n))throw new Error(`edgeToEdge, centerToCenter must be set for xDist or yDist for ${this}`);if("for"in n&&n.for.length<2)throw new Error(`"for" must have at least two selectors for ${this}`)}_getAllReferencedComponents(){let n=[],e=this.getPrimitiveContainer();function t(i){let r=i.split(" ").pop(),s=h7t.includes(r)?r:void 0,o=s?i.replace(` ${s}`,""):i,a=e.selectOne(o,{pcbPrimitive:!0});a&&n.push({selector:i,component:a,componentSelector:o,edge:s})}for(let i of["left","right","top","bottom"])i in this._parsedProps&&t(this._parsedProps[i]);if("for"in this._parsedProps)for(let i of this._parsedProps.for)t(i);return{componentsWithSelectors:n}}},wnt=class extends Ee{constructor(){super(...arguments);d(this,"fabrication_note_rect_id",null)}get config(){return{componentName:"FabricationNoteRect",zodProps:oW}}doInitialPcbPrimitiveRender(){if(this.root?.pcbDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,{maybeFlipLayer:i}=this._getPcbPrimitiveFlippedHelpers(),r=i(t.layer??"top");if(r!=="top"&&r!=="bottom")throw new Error(`Invalid layer "${r}" for FabricationNoteRect. Must be "top" or "bottom".`);let s=this.parent?.pcb_component_id??this.getPrimitiveContainer()?.pcb_component_id,o=this.getSubcircuit(),a=t.hasStroke??(t.strokeWidth!==void 0&&t.strokeWidth!==null),c=e.pcb_fabrication_note_rect.insert({pcb_component_id:s,layer:r,color:t.color,center:{x:t.pcbX??0,y:t.pcbY??0},width:t.width,height:t.height,stroke_width:t.strokeWidth??1,is_filled:t.isFilled??!1,has_stroke:a,is_stroke_dashed:t.isStrokeDashed??!1,subcircuit_id:o?.subcircuit_id??void 0,pcb_group_id:this.getGroup()?.pcb_group_id??void 0,corner_radius:t.cornerRadius??void 0});this.fabrication_note_rect_id=c.pcb_fabrication_note_rect_id}getPcbSize(){let{_parsedProps:e}=this;return{width:e.width,height:e.height}}},Pnt=class extends Ee{constructor(){super(...arguments);d(this,"fabrication_note_path_id",null)}get config(){return{componentName:"FabricationNotePath",zodProps:aW}}doInitialPcbPrimitiveRender(){if(this.root?.pcbDisabled)return;let{db:e}=this.root,t=this.getSubcircuit(),{_parsedProps:i}=this,r=i.layer??"top";if(r!=="top"&&r!=="bottom")throw new Error(`Invalid layer "${r}" for SilkscreenPath. Must be "top" or "bottom".`);let s=this._computePcbGlobalTransformBeforeLayout(),o=this.parent?.pcb_component_id??this.getPrimitiveContainer()?.pcb_component_id,a=e.pcb_fabrication_note_path.insert({pcb_component_id:o,layer:r,color:i.color,route:i.route.map(c=>{let l=$e(s,{x:c.x,y:c.y});return{...c,x:l.x,y:l.y}}),stroke_width:i.strokeWidth??.1,subcircuit_id:t?.subcircuit_id??void 0});this.fabrication_note_path_id=a.pcb_fabrication_note_path_id}},knt=class extends Ee{get config(){return{componentName:"FabricationNoteText",zodProps:sW}}doInitialPcbPrimitiveRender(){if(this.root?.pcbDisabled)return;let{db:n}=this.root,{_parsedProps:e}=this,t=this.getPrimitiveContainer(),i=this.getSubcircuit();n.pcb_fabrication_note_text.insert({anchor_alignment:e.anchorAlignment,anchor_position:{x:e.pcbX??0,y:e.pcbY??0},font:e.font??"tscircuit2024",font_size:e.fontSize??1,layer:"top",color:e.color,text:e.text??"",pcb_component_id:t.pcb_component_id,subcircuit_id:i?.subcircuit_id??void 0,pcb_group_id:this.getGroup()?.pcb_group_id??void 0})}},Tnt=class extends Ee{constructor(){super(...arguments);d(this,"fabrication_note_dimension_id",null);d(this,"isPcbPrimitive",!0)}get config(){return{componentName:"FabricationNoteDimension",zodProps:cW}}_resolvePoint(e,t){if(typeof e=="string"){let s=this.getSubcircuit().selectOne(e);return s?s._getGlobalPcbPositionBeforeLayout():(this.renderError(`FabricationNoteDimension could not find selector "${e}"`),$e(t,{x:0,y:0}))}let i=typeof e.x=="string"?parseFloat(e.x):e.x,r=typeof e.y=="string"?parseFloat(e.y):e.y;return $e(t,{x:i,y:r})}doInitialPcbPrimitiveRender(){if(this.root?.pcbDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,i=this._computePcbGlobalTransformBeforeLayout(),r=this._resolvePoint(t.from,i),s=this._resolvePoint(t.to,i),o=this.getSubcircuit(),a=this.getGroup(),{maybeFlipLayer:c}=this._getPcbPrimitiveFlippedHelpers(),l=c(t.layer??"top");if(l!=="top"&&l!=="bottom")throw new Error(`Invalid layer "${l}" for FabricationNoteDimension. Must be "top" or "bottom".`);let u=this.parent?.pcb_component_id??this.getPrimitiveContainer()?.pcb_component_id,p=t.text??this._formatDistanceText({from:r,to:s,units:t.units??"mm"}),f=e.pcb_fabrication_note_dimension.insert({pcb_component_id:u,subcircuit_id:o?.subcircuit_id??void 0,pcb_group_id:a?.pcb_group_id??void 0,layer:l,from:r,to:s,text:p,offset:t.offset,font:t.font??"tscircuit2024",font_size:t.fontSize??1,color:t.color,arrow_size:t.arrowSize??1});this.fabrication_note_dimension_id=f.pcb_fabrication_note_dimension_id}getPcbSize(){let e=this._computePcbGlobalTransformBeforeLayout(),t=this._resolvePoint(this._parsedProps.from,e),i=this._resolvePoint(this._parsedProps.to,e);return{width:Math.abs(i.x-t.x),height:Math.abs(i.y-t.y)}}_formatDistanceText({from:e,to:t,units:i}){let r=t.x-e.x,s=t.y-e.y,o=Math.sqrt(r*r+s*s),a=i==="in"?o/25.4:o,c=Math.round(a);if(Math.abs(a-c)<1e-9)return`${c}${i}`;let u=i==="in"?3:2;return`${i==="in"?Number(a.toFixed(u)).toString():a.toFixed(u)}${i}`}},Ent=class extends Ee{constructor(){super(...arguments);d(this,"pcb_note_line_id",null);d(this,"isPcbPrimitive",!0)}get config(){return{componentName:"PcbNoteLine",zodProps:FW}}doInitialPcbPrimitiveRender(){if(this.root?.pcbDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,i=this.getSubcircuit(),r=this.getGroup(),s=this._computePcbGlobalTransformBeforeLayout(),o=$e(s,{x:t.x1,y:t.y1}),a=$e(s,{x:t.x2,y:t.y2}),c=this.parent?.pcb_component_id??this.getPrimitiveContainer()?.pcb_component_id??void 0,l=e.pcb_note_line.insert({pcb_component_id:c,subcircuit_id:i?.subcircuit_id??void 0,pcb_group_id:r?.pcb_group_id??void 0,x1:o.x,y1:o.y,x2:a.x,y2:a.y,stroke_width:t.strokeWidth??.1,color:t.color,is_dashed:t.isDashed});this.pcb_note_line_id=l.pcb_note_line_id}getPcbSize(){let{_parsedProps:e}=this;return{width:Math.abs(e.x2-e.x1),height:Math.abs(e.y2-e.y1)}}},Mnt=class extends Ee{constructor(){super(...arguments);d(this,"pcb_note_rect_id",null);d(this,"isPcbPrimitive",!0)}get config(){return{componentName:"PcbNoteRect",zodProps:OW}}doInitialPcbPrimitiveRender(){if(this.root?.pcbDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,i=this._computePcbGlobalTransformBeforeLayout(),r=$e(i,{x:0,y:0}),s=this.getSubcircuit(),o=this.getGroup(),a=this.parent?.pcb_component_id??this.getPrimitiveContainer()?.pcb_component_id??void 0,c=e.pcb_note_rect.insert({pcb_component_id:a,subcircuit_id:s?.subcircuit_id??void 0,pcb_group_id:o?.pcb_group_id??void 0,center:r,width:t.width,height:t.height,stroke_width:t.strokeWidth??.1,is_filled:t.isFilled??!1,has_stroke:t.hasStroke??!0,is_stroke_dashed:t.isStrokeDashed??!1,color:t.color,corner_radius:t.cornerRadius??void 0});this.pcb_note_rect_id=c.pcb_note_rect_id}getPcbSize(){let{_parsedProps:e}=this,t=typeof e.width=="string"?parseFloat(e.width):e.width,i=typeof e.height=="string"?parseFloat(e.height):e.height;return{width:t,height:i}}},Cnt=class extends Ee{constructor(){super(...arguments);d(this,"pcb_note_text_id",null);d(this,"isPcbPrimitive",!0)}get config(){return{componentName:"PcbNoteText",zodProps:RW}}doInitialPcbPrimitiveRender(){if(this.root?.pcbDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,i=this._computePcbGlobalTransformBeforeLayout(),r=$e(i,{x:0,y:0}),s=this.getSubcircuit(),o=this.getGroup(),a=this.parent?.pcb_component_id??this.getPrimitiveContainer()?.pcb_component_id??void 0,c=e.pcb_note_text.insert({pcb_component_id:a,subcircuit_id:s?.subcircuit_id??void 0,pcb_group_id:o?.pcb_group_id??void 0,font:t.font??"tscircuit2024",font_size:t.fontSize??1,text:t.text,anchor_position:r,anchor_alignment:t.anchorAlignment??"center",color:t.color});this.pcb_note_text_id=c.pcb_note_text_id}getPcbSize(){let{_parsedProps:e}=this,t=typeof e.fontSize=="string"?parseFloat(e.fontSize):e.fontSize??1,i=t*.6;return{width:e.text.length*i,height:t}}},Int=class extends Ee{constructor(){super(...arguments);d(this,"pcb_note_path_id",null);d(this,"isPcbPrimitive",!0)}get config(){return{componentName:"PcbNotePath",zodProps:LW}}doInitialPcbPrimitiveRender(){if(this.root?.pcbDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,i=this._computePcbGlobalTransformBeforeLayout(),r=this.getSubcircuit(),s=this.getGroup(),o=this.parent?.pcb_component_id??this.getPrimitiveContainer()?.pcb_component_id??void 0,a=t.route.map(l=>{let{x:u,y:p,...f}=l,y=typeof u=="string"?parseFloat(u):u,g=typeof p=="string"?parseFloat(p):p,x=$e(i,{x:y,y:g});return{...f,x:x.x,y:x.y}}),c=e.pcb_note_path.insert({pcb_component_id:o,subcircuit_id:r?.subcircuit_id??void 0,pcb_group_id:s?.pcb_group_id??void 0,route:a,stroke_width:t.strokeWidth??.1,color:t.color});this.pcb_note_path_id=c.pcb_note_path_id}getPcbSize(){let{_parsedProps:e}=this;if(e.route.length===0)return{width:0,height:0};let t=e.route.map(c=>typeof c.x=="string"?parseFloat(c.x):c.x),i=e.route.map(c=>typeof c.y=="string"?parseFloat(c.y):c.y),r=Math.min(...t),s=Math.max(...t),o=Math.min(...i),a=Math.max(...i);return{width:s-r,height:a-o}}},Nnt=class extends Ee{constructor(){super(...arguments);d(this,"pcb_note_dimension_id",null);d(this,"isPcbPrimitive",!0)}get config(){return{componentName:"PcbNoteDimension",zodProps:zW}}_resolvePoint(e,t){if(typeof e=="string"){let s=this.getSubcircuit().selectOne(`.${e}`);return s?s._getGlobalPcbPositionBeforeLayout():(this.renderError(`PcbNoteDimension could not find selector "${e}"`),$e(t,{x:0,y:0}))}let i=typeof e.x=="string"?parseFloat(e.x):e.x,r=typeof e.y=="string"?parseFloat(e.y):e.y;return $e(t,{x:i,y:r})}doInitialPcbPrimitiveRender(){if(this.root?.pcbDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,i=this._computePcbGlobalTransformBeforeLayout(),r=this._resolvePoint(t.from,i),s=this._resolvePoint(t.to,i),o=this.getSubcircuit(),a=this.getGroup(),c=this.parent?.pcb_component_id??this.getPrimitiveContainer()?.pcb_component_id??void 0,l=t.text??this._formatDistanceText({from:r,to:s,units:t.units??"mm"}),u=e.pcb_note_dimension.insert({pcb_component_id:c,subcircuit_id:o?.subcircuit_id??void 0,pcb_group_id:a?.pcb_group_id??void 0,from:r,to:s,text:l,font:t.font??"tscircuit2024",font_size:t.fontSize??1,color:t.color,arrow_size:t.arrowSize??1});this.pcb_note_dimension_id=u.pcb_note_dimension_id}getPcbSize(){let e=this._computePcbGlobalTransformBeforeLayout(),t=this._resolvePoint(this._parsedProps.from,e),i=this._resolvePoint(this._parsedProps.to,e);return{width:Math.abs(i.x-t.x),height:Math.abs(i.y-t.y)}}_formatDistanceText({from:e,to:t,units:i}){let r=t.x-e.x,s=t.y-e.y,o=Math.sqrt(r*r+s*s),a=i==="in"?o/25.4:o,c=Math.round(a);if(Math.abs(a-c)<1e-9)return`${c}${i}`;let u=i==="in"?3:2;return`${i==="in"?Number(a.toFixed(u)).toString():a.toFixed(u)}${i}`}},Z_=(n,e)=>{let{injectionDb:t,normalComponent:i}=e;if(!i)return;let r=H_({componentName:i.name,componentRotation:"0deg"},t.toArray().filter(s=>"pcb_component_id"in s&&s.pcb_component_id===n.pcb_component_id));i.addAll(r)};function d7t(n,e){let{injectionDb:t,subcircuit:i,groupsMap:r}=e,s=t.pcb_component.getWhere({source_component_id:n.source_component_id}),o=t.cad_component.getWhere({source_component_id:n.source_component_id}),a=new b9({name:n.name,resistance:n.resistance});s&&Z_(s,{...e,normalComponent:a}),n.source_group_id&&r?.has(n.source_group_id)?r.get(n.source_group_id).add(a):i.add(a)}function f7t(n,e){let{injectionDb:t,subcircuit:i}=e;if(n.source_component_id!==null)return;let r=t.pcb_port.getWhere({source_port_id:n.source_port_id}),s=new Gi({name:n.name,pinNumber:n.pin_number});i.add(s),s.source_port_id=n.source_port_id;let o=i.root;if(o&&r){let{db:a}=o,c=a.pcb_port.insert({pcb_component_id:void 0,layers:r.layers,subcircuit_id:i.subcircuit_id??void 0,pcb_group_id:i.getGroup()?.pcb_group_id??void 0,x:r.x,y:r.y,source_port_id:n.source_port_id,is_board_pinout:!1});s.pcb_port_id=c.pcb_port_id}}function m7t(n,e){let{subcircuit:t,groupsMap:i}=e,r=new _l({name:n.name});return r.source_group_id=n.source_group_id,t.add(r),i&&i.set(n.source_group_id,r),r}var _7t=(n,e)=>{if(!n||n.length===0)return;let{injectionDb:t}=e,i=n.map(r=>r.map(s=>{let o=t.source_port.get(s);return o?o.pin_number!==void 0&&o.pin_number!==null?`pin${o.pin_number}`:o.name:null}).filter(s=>s!==null)).filter(r=>r.length>0);return i.length>0?i:void 0},y7t=(n,e)=>{let{injectionDb:t,subcircuit:i,groupsMap:r}=e,s=t.pcb_component.getWhere({source_component_id:n.source_component_id}),o=t.schematic_component.getWhere({source_component_id:n.source_component_id}),a=t.cad_component.getWhere({source_component_id:n.source_component_id}),c=_7t(n.internally_connected_source_port_ids,e),l=new U1({name:n.name,manufacturerPartNumber:n.manufacturer_part_number,supplierPartNumbers:n.supplier_part_numbers??void 0,pinLabels:o?.port_labels??void 0,schWidth:o?.size?.width,schHeight:o?.size?.height,schPinSpacing:o?.pin_spacing,schX:o?.center?.x,schY:o?.center?.y,layer:s?.layer,pcbX:s?.center?.x,pcbY:s?.center?.y,pcbRotation:s?.rotation,doNotPlace:s?.do_not_place,obstructsWithinBounds:s?.obstructs_within_bounds,internallyConnectedPins:c}),u=a?.footprinter_string??"soic8";u&&(Object.assign(l.props,{footprint:u}),Object.assign(l._parsedProps,{footprint:u}),a||l._addChildrenFromStringFootprint?.()),s&&Z_(s,{...e,normalComponent:l}),n.source_group_id&&r?.has(n.source_group_id)?r.get(n.source_group_id).add(l):i.add(l)};function g7t(n,e){let{injectionDb:t,subcircuit:i,groupsMap:r}=e,s=t.pcb_component.getWhere({source_component_id:n.source_component_id}),o=t.cad_component.getWhere({source_component_id:n.source_component_id}),a=new g9({name:n.name,capacitance:n.capacitance});s&&Z_(s,{...e,normalComponent:a}),n.source_group_id&&r?.has(n.source_group_id)?r.get(n.source_group_id).add(a):i.add(a)}var v9=class extends Hn{constructor(){super(...arguments);d(this,"_adjustSilkscreenTextAutomatically",!0)}get config(){return{componentName:"Inductor",schematicSymbolName:this.props.symbolName??"inductor",zodProps:QH,sourceFtype:Va.simple_inductor}}_getSchematicSymbolDisplayValue(){return`${xi(this._parsedProps.inductance)}H`}initPorts(){super.initPorts({additionalAliases:{pin1:["anode","pos","left"],pin2:["cathode","neg","right"]}})}doInitialSourceRender(){let{db:e}=this.root,{_parsedProps:t}=this,i=e.source_component.insert({name:this.name,ftype:Va.simple_inductor,inductance:t.inductance,supplier_part_numbers:t.supplierPartNumbers,are_pins_interchangeable:!0});this.source_component_id=i.source_component_id}};function x7t(n,e){let{injectionDb:t,subcircuit:i,groupsMap:r}=e,s=t.pcb_component.getWhere({source_component_id:n.source_component_id}),o=t.cad_component.getWhere({source_component_id:n.source_component_id}),a=new v9({name:n.name,inductance:n.inductance});s&&Z_(s,{...e,normalComponent:a}),n.source_group_id&&r?.has(n.source_group_id)?r.get(n.source_group_id).add(a):i.add(a)}function b7t(n,e){let{injectionDb:t,subcircuit:i,groupsMap:r}=e,s=t.pcb_component.getWhere({source_component_id:n.source_component_id}),o=t.cad_component.getWhere({source_component_id:n.source_component_id}),a=new x9({name:n.name});s&&Z_(s,{...e,normalComponent:a}),n.source_group_id&&r?.has(n.source_group_id)?r.get(n.source_group_id).add(a):i.add(a)}var v7t=(n,e)=>{let t=[],i=n.source_group_id;for(;i;){let r=e.source_group.get(i);if(!r)break;t.unshift(`.${r.name}`),i=r.parent_source_group_id}return t.push(`.${n.name}`),t.join(" > ")};function S7t(n,e){let{injectionDb:t,subcircuit:i}=e,r=[];for(let o of n.connected_source_port_ids){let a=t.source_port.get(o);if(!a)continue;let c;if(a.source_component_id){let l=t.source_component.get(a.source_component_id);l&&(c=`${v7t({name:l.name,source_group_id:l.source_group_id},t)} > .${a.name}`)}else c=`.${a.name}`;c&&r.push(c)}for(let o of n.connected_source_net_ids){let a=t.source_net.get(o);a&&r.push(`net.${a.name}`)}if(r.length<2)return;let s=new Fs({path:r});s.source_trace_id=n.source_trace_id,i.add(s)}var S9=class extends Hn{constructor(){super(...arguments);d(this,"emitter",this.portMap.pin1);d(this,"collector",this.portMap.pin2);d(this,"base",this.portMap.pin3)}get config(){let e=this.props.type==="npn"?"npn_bipolar_transistor":"pnp_bipolar_transistor";return{componentName:"Transistor",schematicSymbolName:this.props.symbolName??e,zodProps:KH,sourceFtype:"simple_transistor",shouldRenderAsSchematicBox:!1}}initPorts(){let e={pin1:["collector","c"],pin2:["emitter","e"],pin3:["base","b"]};super.initPorts({pinCount:3,additionalAliases:e})}doInitialCreateNetsFromProps(){this._createNetsFromProps([...this._getNetsFromConnectionsProp()])}doInitialCreateTracesFromProps(){this._createTracesFromConnectionsProp()}doInitialSourceRender(){let{db:e}=this.root,{_parsedProps:t}=this,i=e.source_component.insert({ftype:"simple_transistor",name:this.name,transistor_type:t.type});this.source_component_id=i.source_component_id}};function w7t(n,e){let{injectionDb:t,subcircuit:i,groupsMap:r}=e,s=t.pcb_component.getWhere({source_component_id:n.source_component_id}),o=t.cad_component.getWhere({source_component_id:n.source_component_id}),a=new S9({name:n.name,type:n.transistor_type});s&&Z_(s,{...e,normalComponent:a}),n.source_group_id&&r?.has(n.source_group_id)?r.get(n.source_group_id).add(a):i.add(a)}var Ant=class extends _l{constructor(n){super({...n,subcircuit:!0})}doInitialInflateSubcircuitCircuitJson(){let{circuitJson:n,children:e}=this._parsedProps;if(!n)return;let t=Ke(n);if(n&&e?.length>0)throw new Error("Subcircuit cannot have both circuitJson and children");let r={injectionDb:t,subcircuit:this,groupsMap:new Map},s=t.source_group.list();for(let l of s)m7t(l,r);let o=t.source_component.list();for(let l of o)switch(l.ftype){case"simple_resistor":d7t(l,r);break;case"simple_capacitor":g7t(l,r);break;case"simple_inductor":x7t(l,r);break;case"simple_diode":b7t(l,r);break;case"simple_chip":y7t(l,r);break;case"simple_transistor":w7t(l,r);break;default:throw new Error(`No inflator implemented for source component ftype: "${l.ftype}"`)}let a=t.source_port.list();for(let l of a)f7t(l,r);let c=t.source_trace.list();for(let l of c)S7t(l,r)}},Rnt=class extends _l{constructor(n){super({...n,subcircuit:!0})}doInitialPcbPrimitiveRender(){if(super.doInitialPcbPrimitiveRender(),this.root?.pcbDisabled)return;let{db:n}=this.root,e=this._parsedProps;if(!this.pcb_group_id)return;let t=n.pcb_group.get(this.pcb_group_id),i=e.paddingLeft??e.padding??0,r=e.paddingRight??e.padding??0,s=e.paddingTop??e.padding??0,o=e.paddingBottom??e.padding??0;n.pcb_group.update(this.pcb_group_id,{width:(t.width??0)+i+r,height:(t.height??0)+s+o,center:{x:t.center.x+(r-i)/2,y:t.center.y+(s-o)/2}})}},Ont=class extends Ee{constructor(){super(...arguments);d(this,"pcb_breakout_point_id",null);d(this,"matchedPort",null);d(this,"matchedNet",null);d(this,"isPcbPrimitive",!0)}get config(){return{componentName:"BreakoutPoint",zodProps:pW}}_matchConnection(){let{connection:e}=this._parsedProps,t=this.getSubcircuit();t&&(this.matchedPort=t.selectOne(e,{type:"port"}),this.matchedPort||(this.matchedNet=t.selectOne(e,{type:"net"})),!this.matchedPort&&!this.matchedNet&&this.renderError(`Could not find connection target "${e}"`))}_getSourceTraceIdForPort(e){let{db:t}=this.root;return t.source_trace.list().find(r=>r.connected_source_port_ids.includes(e.source_port_id))?.source_trace_id}_getSourceNetIdForPort(e){let{db:t}=this.root;return t.source_trace.list().find(r=>r.connected_source_port_ids.includes(e.source_port_id))?.connected_source_net_ids[0]}doInitialPcbPrimitiveRender(){if(this.root?.pcbDisabled)return;let{db:e}=this.root;this._matchConnection();let{pcbX:t=0,pcbY:i=0}=this._parsedProps,r=this.parent?.getGroup(),s=this.getSubcircuit();if(!r||!r.pcb_group_id)return;let o=e.pcb_breakout_point.insert({pcb_group_id:r.pcb_group_id,subcircuit_id:s?.subcircuit_id??void 0,source_port_id:this.matchedPort?.source_port_id??void 0,source_trace_id:this.matchedPort?this._getSourceTraceIdForPort(this.matchedPort):void 0,source_net_id:this.matchedNet?this.matchedNet.source_net_id:this.matchedPort?this._getSourceNetIdForPort(this.matchedPort):void 0,x:t,y:i});this.pcb_breakout_point_id=o.pcb_breakout_point_id}_getPcbCircuitJsonBounds(){let{pcbX:e=0,pcbY:t=0}=this._parsedProps;return{center:{x:e,y:t},bounds:{left:e,top:t,right:e,bottom:t},width:0,height:0}}_setPositionFromLayout(e){let{db:t}=this.root;this.pcb_breakout_point_id&&t.pcb_breakout_point.update(this.pcb_breakout_point_id,{x:e.x,y:e.y})}getPcbSize(){return{width:0,height:0}}},Lnt=class extends Ee{constructor(){super(...arguments);d(this,"source_net_label_id")}get config(){return{componentName:"NetLabel",zodProps:WH}}_getAnchorSide(){let{_parsedProps:e}=this;if(e.anchorSide)return e.anchorSide;if(!this._resolveConnectsTo())return"right";let i=this._getGlobalSchematicPositionBeforeLayout(),r=this._getConnectedPorts();if(r.length===0)return"right";let s=r[0]._getGlobalSchematicPositionBeforeLayout(),o=s.x-i.x,a=s.y-i.y;if(Math.abs(o)>Math.abs(a)){if(o>0)return"right";if(o<0)return"left"}else{if(a>0)return"top";if(a<0)return"bottom"}return"right"}_getConnectedPorts(){let e=this._resolveConnectsTo();if(!e)return[];let t=[];for(let i of e){let r=this.getSubcircuit().selectOne(i);r&&t.push(r)}return t}computeSchematicPropsTransform(){let{_parsedProps:e}=this;if(e.schX===void 0&&e.schY===void 0){let t=this._getConnectedPorts();if(t.length>0){let i=t[0]._getGlobalSchematicPositionBeforeLayout(),r=$e(this.parent?.computeSchematicGlobalTransform?.()??tr(),{x:0,y:0});return Rn(i.x-r.x,i.y-r.y)}}return super.computeSchematicPropsTransform()}doInitialSchematicPrimitiveRender(){if(this.root?.schematicDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,i=this._getGlobalSchematicPositionBeforeLayout(),r=this.getSubcircuit().selectOne(`net.${this._getNetName()}`),s=t.anchorSide??"right",o=ml({anchor_position:i,anchor_side:s,text:t.net}),a=e.schematic_net_label.insert({text:t.net,source_net_id:r.source_net_id,anchor_position:i,center:o,anchor_side:this._getAnchorSide()});this.source_net_label_id=a.source_net_id}_resolveConnectsTo(){let{_parsedProps:e}=this,t=e.connectsTo??e.connection;if(Array.isArray(t))return t;if(typeof t=="string")return[t]}_getNetName(){let{_parsedProps:e}=this;return e.net}doInitialCreateNetsFromProps(){let{_parsedProps:e}=this;e.net&&nP(this,[`net.${e.net}`])}doInitialCreateTracesFromNetLabels(){if(this.root?.schematicDisabled)return;let e=this._resolveConnectsTo();if(e)for(let t of e)this.add(new Fs({from:t,to:`net.${this._getNetName()}`}))}doInitialSchematicTraceRender(){if(!this.root?._featureMspSchematicTraceRouting||this.root?.schematicDisabled)return;let{db:e}=this.root,t=this._resolveConnectsTo();if(!t||t.length===0)return;let i=this._getGlobalSchematicPositionBeforeLayout(),r=this._getAnchorSide(),o={left:"x-",right:"x+",top:"y+",bottom:"y-"}[r],a=this.getSubcircuit().selectOne(`net.${this._getNetName()}`);for(let c of t){let l=this.getSubcircuit().selectOne(c,{type:"port"});if(!l||!l.schematic_port_id)continue;let u=!1;if(a?.source_net_id){let P=e.source_trace.list().find(w=>w.connected_source_net_ids?.includes(a.source_net_id)&&w.connected_source_port_ids?.includes(l.source_port_id??""));if(P&&(u=e.schematic_trace.list().some(w=>w.source_trace_id===P.source_trace_id)),u)continue}let p=l._getGlobalSchematicPositionAfterLayout(),f=i9(l.facingDirection??"right")??"x+",y=Wc({x:p.x,y:p.y,facingDirection:f},{x:i.x,y:i.y,facingDirection:o});if(!Array.isArray(y)||y.length<2)continue;let g=[];for(let P=0;P<y.length-1;P++)g.push({from:{x:y[P].x,y:y[P].y},to:{x:y[P+1].x,y:y[P+1].y}});let x,v;if(a?.source_net_id&&l.source_port_id){let P=e.source_trace.list().find(w=>w.connected_source_net_ids?.includes(a.source_net_id)&&w.connected_source_port_ids?.includes(l.source_port_id));x=P?.source_trace_id,v=P?.subcircuit_connectivity_map_key||e.source_net.get(a.source_net_id)?.subcircuit_connectivity_map_key}e.schematic_trace.insert({source_trace_id:x,edges:g,junctions:[],subcircuit_connectivity_map_key:v}),e.schematic_port.update(l.schematic_port_id,{is_connected:!0})}}},Fnt=class extends Ee{constructor(){super(...arguments);d(this,"pcb_silkscreen_circle_id",null);d(this,"isPcbPrimitive",!0)}get config(){return{componentName:"SilkscreenCircle",zodProps:NW}}doInitialPcbPrimitiveRender(){if(this.root?.pcbDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,{maybeFlipLayer:i}=this._getPcbPrimitiveFlippedHelpers(),r=i(t.layer??"top");if(r!=="top"&&r!=="bottom")throw new Error(`Invalid layer "${r}" for SilkscreenCircle. Must be "top" or "bottom".`);let s=this._computePcbGlobalTransformBeforeLayout(),o=this.getSubcircuit(),a=this.parent?.pcb_component_id??this.getPrimitiveContainer()?.pcb_component_id,c=e.pcb_silkscreen_circle.insert({pcb_component_id:a,layer:r,center:{x:t.pcbX??0,y:t.pcbY??0},radius:t.radius,subcircuit_id:o?.subcircuit_id??void 0,pcb_group_id:this.getGroup()?.pcb_group_id??void 0,stroke_width:t.strokeWidth??.1});this.pcb_silkscreen_circle_id=c.pcb_silkscreen_circle_id}getPcbSize(){let{_parsedProps:e}=this,t=e.radius*2;return{width:t,height:t}}},znt=class extends Ee{constructor(){super(...arguments);d(this,"pcb_silkscreen_rect_id",null);d(this,"isPcbPrimitive",!0)}get config(){return{componentName:"SilkscreenRect",zodProps:IW}}doInitialPcbPrimitiveRender(){if(this.root?.pcbDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,{maybeFlipLayer:i}=this._getPcbPrimitiveFlippedHelpers(),r=i(t.layer??"top");if(r!=="top"&&r!=="bottom")throw new Error(`Invalid layer "${r}" for SilkscreenRect. Must be "top" or "bottom".`);let s=this.getSubcircuit(),o=this.parent?.pcb_component_id??this.getPrimitiveContainer()?.pcb_component_id,a=e.pcb_silkscreen_rect.insert({pcb_component_id:o,layer:r,center:{x:t.pcbX??0,y:t.pcbY??0},width:t.width,height:t.height,subcircuit_id:s?.subcircuit_id??void 0,pcb_group_id:this?.getGroup()?.pcb_group_id??void 0,stroke_width:t.strokeWidth??.1,is_filled:t.filled??!1,corner_radius:t.cornerRadius??void 0});this.pcb_silkscreen_rect_id=a.pcb_silkscreen_rect_id}getPcbSize(){let{_parsedProps:e}=this;return{width:e.width,height:e.height}}},$nt=class extends Ee{constructor(){super(...arguments);d(this,"pcb_silkscreen_line_id",null);d(this,"isPcbPrimitive",!0)}get config(){return{componentName:"SilkscreenLine",zodProps:CW}}doInitialPcbPrimitiveRender(){if(this.root?.pcbDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,{maybeFlipLayer:i}=this._getPcbPrimitiveFlippedHelpers(),r=i(t.layer??"top");if(r!=="top"&&r!=="bottom")throw new Error(`Invalid layer "${r}" for SilkscreenLine. Must be "top" or "bottom".`);let s=this.getSubcircuit(),o=this.parent?.pcb_component_id??this.getPrimitiveContainer()?.pcb_component_id,a=e.pcb_silkscreen_line.insert({pcb_component_id:o,layer:r,x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,stroke_width:t.strokeWidth??.1,subcircuit_id:s?.subcircuit_id??void 0,pcb_group_id:s?.getGroup()?.pcb_group_id??void 0});this.pcb_silkscreen_line_id=a.pcb_silkscreen_line_id}getPcbSize(){let{_parsedProps:e}=this,t=Math.abs(e.x2-e.x1),i=Math.abs(e.y2-e.y1);return{width:t,height:i}}},Dnt=class extends Ee{constructor(e){super(e);d(this,"pcb_via_id",null);d(this,"matchedPort",null);d(this,"isPcbPrimitive",!0);d(this,"source_manually_placed_via_id",null);d(this,"subcircuit_connectivity_map_key",null);let t=this._getLayers();this._parsedProps.layers=t,this.initPorts()}get config(){return{componentName:"Via",zodProps:lW}}getAvailablePcbLayers(){return["top","inner1","inner2","bottom"]}getPcbSize(){let{_parsedProps:e}=this;return{width:e.outerDiameter,height:e.outerDiameter}}_getPcbCircuitJsonBounds(){let{db:e}=this.root,t=e.pcb_via.get(this.pcb_via_id),i=this.getPcbSize();return{center:{x:t.x,y:t.y},bounds:{left:t.x-i.width/2,top:t.y-i.height/2,right:t.x+i.width/2,bottom:t.y+i.height/2},width:i.width,height:i.height}}_setPositionFromLayout(e){let{db:t}=this.root;t.pcb_via.update(this.pcb_via_id,{x:e.x,y:e.y})}_getLayers(){let{fromLayer:e="top",toLayer:t="bottom"}=this._parsedProps;return e===t?[e]:[e,t]}initPorts(){let e=this._parsedProps.layers;for(let i of e){let r=new Gi({name:i,layer:i});r.registerMatch(this),this.add(r)}let t=new Gi({name:"pin1"});t.registerMatch(this),this.add(t)}_getConnectedNetOrTrace(){let e=this._parsedProps.connectsTo;if(!e)return null;let t=this.getSubcircuit(),i=Array.isArray(e)?e:[e];for(let r of i)if(r.startsWith("net.")){let s=t.selectOne(r,{type:"net"});if(s)return s}return null}doInitialPcbComponentRender(){if(this.root?.pcbDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,i=this._getGlobalPcbPositionBeforeLayout(),r=this.getSubcircuit(),s=e.pcb_component.insert({center:i,width:t.outerDiameter,height:t.outerDiameter,layer:t.fromLayer??"top",rotation:0,source_component_id:this.source_component_id,subcircuit_id:r?.subcircuit_id??void 0,obstructs_within_bounds:!0});this.pcb_component_id=s.pcb_component_id}doInitialSourceRender(){let{db:e}=this.root,{_parsedProps:t}=this,i=this.getGroup(),r=this.getSubcircuit(),s=e.source_manually_placed_via.insert({source_group_id:i?.source_group_id,source_net_id:t.net??"",subcircuit_id:r?.subcircuit_id??void 0});this.source_component_id=s.source_manually_placed_via_id}doInitialPcbPrimitiveRender(){if(this.root?.pcbDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,i=this._getGlobalPcbPositionBeforeLayout(),r=this.getSubcircuit(),s=e.pcb_via.insert({x:i.x,y:i.y,hole_diameter:t.holeDiameter,outer_diameter:t.outerDiameter,layers:["bottom","top"],from_layer:t.fromLayer||"bottom",to_layer:t.toLayer||"top",subcircuit_id:r?.subcircuit_id??void 0,subcircuit_connectivity_map_key:this.subcircuit_connectivity_map_key??void 0,pcb_group_id:this.getGroup()?.pcb_group_id??void 0,net_is_assignable:t.netIsAssignable??void 0});this.pcb_via_id=s.pcb_via_id}},jnt=class extends Ee{constructor(){super(...arguments);d(this,"isPcbPrimitive",!0)}get config(){return{componentName:"CopperPour",zodProps:dW}}getPcbSize(){return{width:0,height:0}}doInitialCreateNetsFromProps(){let{_parsedProps:e}=this;nP(this,[e.connectsTo])}doInitialPcbCopperPourRender(){this.root?.pcbDisabled||this._queueAsyncEffect("PcbCopperPourRender",async()=>{let{db:e}=this.root,{_parsedProps:t}=this,i=this.getSubcircuit().selectOne(t.connectsTo);if(!i||!i.source_net_id){this.renderError(`Net "${t.connectsTo}" not found for copper pour`);return}let r=this.getSubcircuit(),s=e.toArray().filter(p=>p.type==="source_net"&&p.name===i.name)[0]||"",o=t.clearance??.2,a=ZQ(e.toArray(),{layer:t.layer,pour_connectivity_key:s.subcircuit_connectivity_map_key||"",pad_margin:t.padMargin??o,trace_margin:t.traceMargin??o,board_edge_margin:t.boardEdgeMargin??o,cutout_margin:t.cutoutMargin??o}),c=new qQ(a),{brep_shapes:l}=c.getOutput(),u=t.coveredWithSolderMask??!1;for(let p of l)e.pcb_copper_pour.insert({shape:"brep",layer:t.layer,brep_shape:p,source_net_id:i.source_net_id,subcircuit_id:r?.subcircuit_id??void 0,covered_with_solder_mask:u})})}},Bnt=class extends Hn{get config(){return{componentName:"Battery",schematicSymbolName:this.props.symbolName??"battery",zodProps:GH,sourceFtype:"simple_power_source"}}initPorts(){super.initPorts({additionalAliases:{pin1:["anode","pos","left"],pin2:["cathode","neg","right"]}})}doInitialSourceRender(){let{db:n}=this.root,{_parsedProps:e}=this,t=n.source_component.insert({name:this.name,ftype:"simple_power_source",capacity:e.capacity,supplier_part_numbers:e.supplierPartNumbers,are_pins_interchangeable:!1});this.source_component_id=t.source_component_id}},Ynt=class extends Hn{_getPcbRotationBeforeLayout(){let n=this.props.pcbOrientation==="vertical"?-90:0;return(super._getPcbRotationBeforeLayout()??0)+n}get config(){return{componentName:"PinHeader",zodProps:HH,shouldRenderAsSchematicBox:!0}}_getImpliedFootprintString(){let n=this._parsedProps.pinCount??(Array.isArray(this._parsedProps.pinLabels)?this._parsedProps.pinLabels.length:this._parsedProps.pinLabels?Object.keys(this._parsedProps.pinLabels).length:0),e=this._parsedProps.holeDiameter,t=this._parsedProps.platedDiameter,i=this._parsedProps.pitch,r=this._parsedProps.showSilkscreenPinLabels;if(n>0){let s;if(i)!e&&!t?s=`pinrow${n}_p${i}`:s=`pinrow${n}_p${i}_id${e}_od${t}`;else if(!e&&!t)s=`pinrow${n}`;else return null;return r!==!0&&(s+="_nopinlabels"),s}return null}initPorts(){let n=this._parsedProps.pinCount??(Array.isArray(this._parsedProps.pinLabels)?this._parsedProps.pinLabels.length:this._parsedProps.pinLabels?Object.keys(this._parsedProps.pinLabels).length:1);for(let e=1;e<=n;e++){let t=Array.isArray(this._parsedProps.pinLabels)?this._parsedProps.pinLabels[e-1]:this._parsedProps.pinLabels?.[`pin${e}`];if(t){let i=Array.isArray(t)?t[0]:t,r=Array.isArray(t)?t.slice(1):[];this.add(new Gi({pinNumber:e,name:i,aliases:[`pin${e}`,...r]}))}else this.add(new Gi({pinNumber:e,name:`pin${e}`}))}}_getSchematicPortArrangement(){let n=this._parsedProps.pinCount??1,e=this._parsedProps.schFacingDirection??this._parsedProps.facingDirection??"right",t=this._parsedProps.schPinArrangement;return e==="left"?{leftSide:{direction:t?.leftSide?.direction??"top-to-bottom",pins:t?.leftSide?.pins??Array.from({length:n},(i,r)=>`pin${r+1}`)}}:{rightSide:{direction:t?.rightSide?.direction??"top-to-bottom",pins:t?.rightSide?.pins??Array.from({length:n},(i,r)=>`pin${r+1}`)}}}doInitialSourceRender(){let{db:n}=this.root,{_parsedProps:e}=this,t=n.source_component.insert({ftype:"simple_pin_header",name:this.name,supplier_part_numbers:e.supplierPartNumbers,pin_count:e.pinCount,gender:e.gender,are_pins_interchangeable:!0});this.source_component_id=t.source_component_id}};function P7t(n){switch(n){case"two_ground_pins":return"crystal_4pin";case"ground_pin":return"resonator";case"no_ground":return"crystal";default:return"crystal"}}var Xnt=class extends Hn{get config(){return{componentName:"Resonator",schematicSymbolName:this.props.symbolName??P7t(this.props.pinVariant),zodProps:FH,shouldRenderAsSchematicBox:!1}}doInitialSourceRender(){let{db:n}=this.root,{_parsedProps:e}=this,t=e.pinVariant||"no_ground",i=n.source_component.insert({ftype:"simple_resonator",name:this.name,frequency:e.frequency,load_capacitance:e.loadCapacitance,supplier_part_numbers:e.supplierPartNumbers,pin_variant:t,are_pins_interchangeable:t==="no_ground"||t==="ground_pin"});this.source_component_id=i.source_component_id}_getSchematicSymbolDisplayValue(){let n=`${xi(this._parsedProps.frequency)}Hz`;return this._parsedProps.loadCapacitance?`${n} / ${xi(this._parsedProps.loadCapacitance)}F`:n}};function k7t(n){switch(n){case"three_pin":return"potentiometer3";case"two_pin":return"potentiometer2";default:return"potentiometer2"}}var Unt=class extends Hn{get config(){return{componentName:"Potentiometer",schematicSymbolName:this.props.symbolName??k7t(this.props.pinVariant),zodProps:OH,shouldRenderAsSchematicBox:!1}}_getSchematicSymbolDisplayValue(){return`${xi(this._parsedProps.maxResistance)}\u03A9`}doInitialSourceRender(){let{db:n}=this.root,{_parsedProps:e}=this,t=e.pinVariant||"two_pin",i=n.source_component.insert({ftype:"simple_potentiometer",name:this.name,max_resistance:e.maxResistance,pin_variant:t,are_pins_interchangeable:t==="two_pin"});this.source_component_id=i.source_component_id}},Vnt=class extends Hn{get config(){return{componentName:"PushButton",schematicSymbolName:this.props.symbolName??"push_button_normally_open_momentary",zodProps:qH,sourceFtype:Va.simple_push_button}}get defaultInternallyConnectedPinNames(){return[]}initPorts(){super.initPorts({pinCount:2,ignoreSymbolPorts:!0});let n=yi[this._getSchematicSymbolNameOrThrow()],e=n.ports.find(l=>l.labels.includes("1")),t=n.ports.find(l=>l.labels.includes("2")),i=this.selectAll("port"),r=i.find(l=>l.props.pinNumber===1),s=i.find(l=>l.props.pinNumber===2),o=i.find(l=>l.props.pinNumber===3),a=i.find(l=>l.props.pinNumber===4),{internallyConnectedPins:c}=this._parsedProps;r.schematicSymbolPortDef=e,(!c||c.length===0)&&(s.schematicSymbolPortDef=t);for(let[l,u]of[[2,s],[3,o],[4,a]]){let p=c?.find(([y,g])=>y===`pin${l}`||g===`pin${l}`);if(!p){u.schematicSymbolPortDef=t;break}(p?.[0]===`pin${l}`?p[1]:p?.[0])!=="pin1"&&(u.schematicSymbolPortDef=t)}}doInitialSourceRender(){let{db:n}=this.root,{_parsedProps:e}=this,t=n.source_component.insert({name:this.name,ftype:Va.simple_push_button,supplier_part_numbers:e.supplierPartNumbers,are_pins_interchangeable:!0});this.source_component_id=t.source_component_id}},Gnt=class extends Hn{get config(){return{schematicSymbolName:this.props.symbolName??(this.props.pinVariant==="four_pin"?"crystal_4pin":"crystal"),componentName:"Crystal",zodProps:LH,sourceFtype:"simple_crystal"}}initPorts(){let n=this.props.pinVariant==="four_pin"?{pin1:["left1","1"],pin2:["top1","2","gnd1"],pin3:["right1","3"],pin4:["bottom1","4","gnd2"]}:{pin1:["pos","left"],pin2:["neg","right"]};super.initPorts({additionalAliases:n})}_getSchematicSymbolDisplayValue(){let n=`${xi(this._parsedProps.frequency)}Hz`;return this._parsedProps.loadCapacitance?`${n} / ${xi(this._parsedProps.loadCapacitance)}F`:n}doInitialSourceRender(){let{db:n}=this.root,{_parsedProps:e}=this,t=n.source_component.insert({name:this.name,ftype:"simple_crystal",frequency:e.frequency,load_capacitance:e.loadCapacitance,pin_variant:e.pinVariant||"two_pin",are_pins_interchangeable:(e.pinVariant||"two_pin")==="two_pin"});this.source_component_id=t.source_component_id}},Hnt=class extends Hn{get config(){let n=this.props.mosfetMode==="depletion"?"d":"e",t=`${this.props.channelType}_channel_${n}_mosfet_transistor`;return{componentName:"Mosfet",schematicSymbolName:this.props.symbolName??t,zodProps:JH,shouldRenderAsSchematicBox:!1}}doInitialSourceRender(){let{db:n}=this.root,{_parsedProps:e}=this,t=n.source_component.insert({ftype:"simple_mosfet",name:this.name,mosfet_mode:e.mosfetMode,channel_type:e.channelType});this.source_component_id=t.source_component_id}};function T7t(n){return n.simSwitchFrequency!==void 0||n.simCloseAt!==void 0||n.simOpenAt!==void 0||n.simStartClosed!==void 0||n.simStartOpen!==void 0}var Wnt=class extends Hn{_getSwitchType(){let n=this._parsedProps;return n?n.dpdt?"dpdt":n.spst?"spst":n.spdt?"spdt":n.dpst?"dpst":n.type??"spst":"spst"}get config(){let n=this._getSwitchType(),e=this._parsedProps?.isNormallyClosed??!1,t={spst:e?"spst_normally_closed_switch":"spst_switch",spdt:e?"spdt_normally_closed_switch":"spdt_switch",dpst:e?"dpst_normally_closed_switch":"dpst_switch",dpdt:e?"dpdt_normally_closed_switch":"dpdt_switch"};return{componentName:"Switch",schematicSymbolName:this.props.symbolName??t[n],zodProps:rW,shouldRenderAsSchematicBox:!1}}doInitialSourceRender(){let{db:n}=this.root,e=this._parsedProps??{},t=n.source_component.insert({ftype:"simple_switch",name:this.name,are_pins_interchangeable:this._getSwitchType()==="spst"});this.source_component_id=t.source_component_id}doInitialSimulationRender(){let{_parsedProps:n}=this;if(!T7t(n))return;let{db:e}=this.root,t={type:"simulation_switch",source_component_id:this.source_component_id||""};n.simSwitchFrequency!==void 0&&(t.switching_frequency=hr.parse(n.simSwitchFrequency)),n.simCloseAt!==void 0&&(t.closes_at=pr.parse(n.simCloseAt)),n.simOpenAt!==void 0&&(t.opens_at=pr.parse(n.simOpenAt)),n.simStartOpen!==void 0&&(t.starts_closed=!n.simStartOpen),n.simStartClosed!==void 0&&(t.starts_closed=n.simStartClosed),e.simulation_switch.insert(t)}},t9={HOLE_DIAMETER:.5,SMT_CIRCLE_DIAMETER:1.2,SMT_RECT_SIZE:2},qnt=class extends Hn{get config(){return{componentName:"TestPoint",schematicSymbolName:this.props.symbolName??"testpoint",zodProps:uW,sourceFtype:Va.simple_test_point}}_getPropsWithDefaults(){let{padShape:n,holeDiameter:e,footprintVariant:t,padDiameter:i,width:r,height:s}=this._parsedProps;return!t&&e&&(t="through_hole"),t??(t="through_hole"),n??(n="circle"),t==="pad"?n==="circle"?i??(i=t9.SMT_CIRCLE_DIAMETER):n==="rect"&&(r??(r=t9.SMT_RECT_SIZE),s??(s=r)):t==="through_hole"&&(e??(e=t9.HOLE_DIAMETER)),{padShape:n,holeDiameter:e,footprintVariant:t,padDiameter:i,width:r,height:s}}_getImpliedFootprintString(){let{padShape:n,holeDiameter:e,footprintVariant:t,padDiameter:i,width:r,height:s}=this._getPropsWithDefaults();if(t==="through_hole")return`platedhole_d${e}`;if(t==="pad"){if(n==="circle")return`smtpad_circle_d${i}`;if(n==="rect")return`smtpad_rect_w${r}_h${s}`}throw new Error(`Footprint variant "${t}" with pad shape "${n}" not implemented`)}doInitialSourceRender(){let{db:n}=this.root,{_parsedProps:e}=this,{padShape:t,holeDiameter:i,footprintVariant:r,padDiameter:s,width:o,height:a}=this._getPropsWithDefaults(),c=n.source_component.insert({ftype:Va.simple_test_point,name:this.name,supplier_part_numbers:e.supplierPartNumbers,footprint_variant:r,pad_shape:t,pad_diameter:s,hole_diameter:i,width:o,height:a,are_pins_interchangeable:!0});this.source_component_id=c.source_component_id}},Znt=class extends Ee{constructor(){super(...arguments);d(this,"isSchematicPrimitive",!0)}get config(){return{componentName:"SchematicText",zodProps:wW}}doInitialSchematicPrimitiveRender(){if(this.root?.schematicDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,i=this._getGlobalSchematicPositionBeforeLayout();e.schematic_text.insert({anchor:t.anchor??"center",text:t.text,font_size:t.fontSize,color:t.color||"#000000",position:{x:i.x,y:i.y},rotation:t.schRotation??0})}},Knt=class extends Ee{constructor(){super(...arguments);d(this,"isSchematicPrimitive",!0);d(this,"schematic_line_id")}get config(){return{componentName:"SchematicLine",zodProps:SW}}doInitialSchematicPrimitiveRender(){if(this.root?.schematicDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,i=this._getGlobalSchematicPositionBeforeLayout(),r=this.getPrimitiveContainer()?.parent?.schematic_component_id,s=e.schematic_line.insert({schematic_component_id:r,x1:t.x1+i.x,y1:t.y1+i.y,x2:t.x2+i.x,y2:t.y2+i.y,stroke_width:t.strokeWidth??oP,color:t.color??sP,is_dashed:!1,subcircuit_id:this.getSubcircuit().subcircuit_id??void 0});this.schematic_line_id=s.schematic_line_id}},Jnt=class extends Ee{constructor(){super(...arguments);d(this,"isSchematicPrimitive",!0);d(this,"schematic_rect_id")}get config(){return{componentName:"SchematicRect",zodProps:vW}}doInitialSchematicPrimitiveRender(){if(this.root?.schematicDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,i=this._getGlobalSchematicPositionBeforeLayout(),r=this.getPrimitiveContainer()?.parent?.schematic_component_id,s=e.schematic_rect.insert({center:{x:i.x,y:i.y},width:t.width,height:t.height,stroke_width:t.strokeWidth??oP,color:t.color??sP,is_filled:t.isFilled,schematic_component_id:r,is_dashed:t.isDashed,rotation:t.rotation??0,subcircuit_id:this.getSubcircuit().subcircuit_id??void 0});this.schematic_rect_id=s.schematic_rect_id}},Qnt=class extends Ee{constructor(){super(...arguments);d(this,"isSchematicPrimitive",!0);d(this,"schematic_arc_id")}get config(){return{componentName:"SchematicArc",zodProps:gW}}doInitialSchematicPrimitiveRender(){if(this.root?.schematicDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,i=this._getGlobalSchematicPositionBeforeLayout(),r=this.getPrimitiveContainer()?.parent?.schematic_component_id,s=e.schematic_arc.insert({schematic_component_id:r,center:{x:t.center.x+i.x,y:t.center.y+i.y},radius:t.radius,start_angle_degrees:t.startAngleDegrees,end_angle_degrees:t.endAngleDegrees,direction:t.direction,stroke_width:t.strokeWidth??oP,color:t.color??sP,is_dashed:t.isDashed,subcircuit_id:this.getSubcircuit().subcircuit_id??void 0});this.schematic_arc_id=s.schematic_arc_id}},tit=class extends Ee{constructor(){super(...arguments);d(this,"isSchematicPrimitive",!0);d(this,"schematic_circle_id")}get config(){return{componentName:"SchematicCircle",zodProps:bW}}doInitialSchematicPrimitiveRender(){if(this.root?.schematicDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,i=this._getGlobalSchematicPositionBeforeLayout(),r=this.getPrimitiveContainer()?.parent?.schematic_component_id,s=e.schematic_circle.insert({schematic_component_id:r,center:{x:t.center.x+i.x,y:t.center.y+i.y},radius:t.radius,stroke_width:t.strokeWidth??oP,color:t.color??sP,is_filled:t.isFilled,fill_color:t.fillColor,is_dashed:t.isDashed,subcircuit_id:this.getSubcircuit().subcircuit_id??void 0});this.schematic_circle_id=s.schematic_circle_id}};function E7t({anchor:n,x:e,y:t,width:i,height:r,isInside:s}){switch(n){case"top_left":return{x:e,y:t+r,textAnchor:s?"top_left":"bottom_left"};case"top_center":return{x:e+i/2,y:t+r,textAnchor:s?"top_center":"bottom_center"};case"top_right":return{x:e+i,y:t+r,textAnchor:s?"top_right":"bottom_right"};case"center_left":return{x:e,y:t+r/2,textAnchor:s?"center_left":"center_right"};case"center":return{x:e+i/2,y:t+r/2,textAnchor:"center"};case"center_right":return{x:e+i,y:t+r/2,textAnchor:s?"center_right":"center_left"};case"bottom_left":return{x:e,y:t,textAnchor:s?"bottom_left":"top_left"};case"bottom_center":return{x:e+i/2,y:t,textAnchor:s?"bottom_center":"top_center"};case"bottom_right":return{x:e+i,y:t,textAnchor:s?"bottom_right":"top_right"};default:return{x:e+i/2,y:t+r,textAnchor:"center"}}}var eit=class extends Ee{constructor(){super(...arguments);d(this,"isSchematicPrimitive",!0)}get config(){return{componentName:"SchematicBox",zodProps:xW,shouldRenderAsSchematicBox:!0}}doInitialSchematicPrimitiveRender(){if(this.root?.schematicDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,i=.6,r=typeof t.padding=="number"?t.padding:0,s=typeof t.paddingTop=="number"?t.paddingTop:r,o=typeof t.paddingBottom=="number"?t.paddingBottom:r,a=typeof t.paddingLeft=="number"?t.paddingLeft:r,c=typeof t.paddingRight=="number"?t.paddingRight:r,l=t.overlay&&t.overlay.length>0,u=typeof t.width=="number"&&typeof t.height=="number",p,f,y,g,x,v;if(l){let w=t.overlay.map(nt=>({selector:nt,port:this.getSubcircuit().selectOne(nt,{type:"port"})})).filter(({port:nt})=>nt!=null).map(({port:nt})=>({position:nt._getGlobalSchematicPositionAfterLayout()}));if(w.length===0)return;let k=w.map(nt=>nt.position.x),T=w.map(nt=>nt.position.y),I=Math.min(...k),E=Math.max(...k),N=Math.min(...T),M=Math.max(...T),A=E-I,R=M-N,j=A===0?i:0,B=R===0?i:0,G=a+j/2,U=c+j/2,H=s+B/2,tt=o+B/2,et=I-G,mt=E+U,V=N-tt,J=M+H;p=mt-et,f=J-V,y=et+(t.schX??0),g=V+(t.schY??0),x=y+p/2,v=g+f/2}else if(u){p=t.width,f=t.height;let P=this._getGlobalSchematicPositionBeforeLayout();x=P.x,v=P.y,y=x-p/2,g=v-f/2}else return;if(e.schematic_box.insert({height:f,width:p,x:y,y:g,is_dashed:t.strokeStyle==="dashed"}),t.title){let P=t.titleInside,w=.1,k=t.titleAlignment,T=E7t({anchor:k,x:y,y:g,width:p,height:f,isInside:P}),I,E,N=T.textAnchor;P?(I=k.includes("top")?-w:k.includes("bottom")?w:0,E=k.includes("left")?w:k.includes("right")?-w:0):(I=k.includes("top")?w:k.includes("bottom")?-w:0,E=k.includes("center_left")?-w:k.includes("center_right")?w:0);let M=T.x+E,A=T.y+I;e.schematic_text.insert({anchor:N,text:t.title,font_size:t.titleFontSize??.18,color:t.titleColor??"#000000",position:{x:M,y:A},rotation:0})}}},nit=class extends Ee{constructor(){super(...arguments);d(this,"isSchematicPrimitive",!0);d(this,"schematic_table_id",null)}get config(){return{componentName:"SchematicTable",zodProps:PW}}doInitialSchematicPrimitiveRender(){if(this.root?.schematicDisabled)return;let{db:e}=this.root,{_parsedProps:t}=this,i=this.children.filter(f=>f.componentName==="SchematicRow");if(i.length===0)return;let r=[],s=0;for(let f of i){let y=f.children.filter(g=>g.componentName==="SchematicCell");s=Math.max(s,y.length)}for(let f=0;f<i.length;f++)r[f]=[];for(let f=0;f<i.length;f++){let g=i[f].children.filter(v=>v.componentName==="SchematicCell"),x=0;for(let v=0;v<g.length;v++){for(;r[f][x];)x++;let P=g[v],w=P._parsedProps.colSpan??1,k=P._parsedProps.rowSpan??1;for(let T=0;T<k;T++)for(let I=0;I<w;I++)r[f+T]||(r[f+T]=[]),r[f+T][x+I]=P;x+=w}}s=Math.max(0,...r.map(f=>f.length));let o=i.map((f,y)=>f._parsedProps.height??1),a=Array.from({length:s},(f,y)=>{let g=0;for(let x=0;x<i.length;x++){let v=r[x]?.[y];if(v){let P=v._parsedProps.text??v._parsedProps.children,w=v._parsedProps.width??(P?.length??2)*.5;w>g&&(g=w)}}return g||10}),c=this._getGlobalSchematicPositionBeforeLayout(),l=e.schematic_table.insert({anchor_position:c,column_widths:a,row_heights:o,cell_padding:t.cellPadding,border_width:t.borderWidth,anchor:t.anchor,subcircuit_id:this.getSubcircuit()?.subcircuit_id||"",schematic_component_id:this.parent?.schematic_component_id||""});this.schematic_table_id=l.schematic_table_id;let u=new Set,p=0;for(let f=0;f<i.length;f++){let y=0;for(let g=0;g<s;g++){let x=r[f]?.[g];if(x&&!u.has(x)){u.add(x);let v=x._parsedProps,P=v.rowSpan??1,w=v.colSpan??1,k=0;for(let I=0;I<w;I++)k+=a[g+I];let T=0;for(let I=0;I<P;I++)T+=o[f+I];e.schematic_table_cell.insert({schematic_table_id:this.schematic_table_id,start_row_index:f,end_row_index:f+P-1,start_column_index:g,end_column_index:g+w-1,text:v.text??v.children,center:{x:c.x+y+k/2,y:c.y-p-T/2},width:k,height:T,horizontal_align:v.horizontalAlign,vertical_align:v.verticalAlign,font_size:v.fontSize??t.fontSize,subcircuit_id:this.getSubcircuit()?.subcircuit_id||""})}a[g]&&(y+=a[g])}p+=o[f]}}},iit=class extends Ee{constructor(){super(...arguments);d(this,"isSchematicPrimitive",!0)}get config(){return{componentName:"SchematicRow",zodProps:kW}}},rit=class extends Ee{constructor(){super(...arguments);d(this,"isSchematicPrimitive",!0);d(this,"canHaveTextChildren",!0)}get config(){return{componentName:"SchematicCell",zodProps:TW}}},sit=class extends Ee{constructor(){super(...arguments);d(this,"isPrimitiveContainer",!0)}get config(){return{componentName:"Symbol",zodProps:VH}}},oit=class extends Ee{get config(){return{componentName:"AnalogSimulation",zodProps:ZH}}doInitialSimulationRender(){let{db:n}=this.root,{duration:e,timePerStep:t}=this._parsedProps,i=e||10,r=t||.01;n.simulation_experiment.insert({name:"spice_transient_analysis",experiment_type:"spice_transient_analysis",end_time_ms:i,time_per_step:r})}},ait=class extends Ee{constructor(){super(...arguments);d(this,"simulation_voltage_probe_id",null);d(this,"schematic_voltage_probe_id",null);d(this,"finalProbeName",null);d(this,"color",null)}get config(){return{componentName:"VoltageProbe",zodProps:yW}}doInitialSimulationRender(){let{db:e}=this.root,{connectsTo:t,name:i}=this._parsedProps,r=this.getSubcircuit();if(!r){this.renderError("VoltageProbe must be inside a subcircuit");return}let s=Array.isArray(t)?t:[t];if(s.length!==1){this.renderError("VoltageProbe must connect to exactly one port or net");return}let o=s[0],a=r.selectOne(o,{type:"port"}),c=a?null:r.selectOne(o,{type:"net"});if(c&&c.componentName!=="Net"){this.renderError(`VoltageProbe connection target "${o}" resolved to a non-net component "${c.componentName}".`);return}if(!a&&!c){this.renderError(`VoltageProbe could not find connection target "${o}"`);return}let l=a?.source_port_id??c?.source_net_id;if(!l){this.renderError("Could not identify connected source for VoltageProbe");return}this.color=t7t(l);let u=i;u||(u=s[0].split(" > ").map(f=>f.replace(/^\./,"")).join(".")),this.finalProbeName=u;let{simulation_voltage_probe_id:p}=e.simulation_voltage_probe.insert({name:u,source_port_id:a?.source_port_id??void 0,source_net_id:c?.source_net_id??void 0,subcircuit_id:r.subcircuit_id||void 0,color:this.color});this.simulation_voltage_probe_id=p}doInitialSchematicReplaceNetLabelsWithSymbols(){if(this.root?.schematicDisabled)return;let{db:e}=this.root,{connectsTo:t,name:i}=this._parsedProps,r=this.getSubcircuit();if(!r)return;let s=Array.isArray(t)?t:[t];if(s.length!==1)return;let o=s[0],a=r.selectOne(o,{type:"port"});if(!a||!a.schematic_port_id)return;let c=a._getGlobalSchematicPositionAfterLayout(),l=null;for(let f of e.schematic_trace.list()){for(let y of f.edges)if(Math.abs(y.from.x-c.x)<1e-6&&Math.abs(y.from.y-c.y)<1e-6||Math.abs(y.to.x-c.x)<1e-6&&Math.abs(y.to.y-c.y)<1e-6){l=f.schematic_trace_id;break}if(l)break}if(!l)return;let u=this.finalProbeName,p=e.schematic_voltage_probe.insert({name:u,position:c,schematic_trace_id:l,subcircuit_id:r.subcircuit_id||void 0,color:this.color??void 0});this.schematic_voltage_probe_id=p.schematic_voltage_probe_id}},M7t={name:"@tscircuit/core",type:"module",version:"0.0.869",types:"dist/index.d.ts",main:"dist/index.js",module:"dist/index.js",exports:{".":{import:"./dist/index.js",types:"./dist/index.d.ts"}},files:["dist"],repository:{type:"git",url:"https://github.com/tscircuit/core"},scripts:{build:"tsup-node index.ts --format esm --dts",format:"biome format . --write","measure-bundle":"howfat -r table .","pkg-pr-new-release":"bunx pkg-pr-new publish --comment=off --peerDeps","smoke-test:dist":"bun run scripts/smoke-tests/test-dist-simple-circuit.tsx","build:benchmarking":"bun build --experimental-html ./benchmarking/website/index.html --outdir ./benchmarking-dist","build:benchmarking:watch":`chokidar "./{benchmarking,lib}/**/*.{ts,tsx}" -c 'bun build --experimental-html ./benchmarking/website/index.html --outdir ./benchmarking-dist'`,"start:benchmarking":'concurrently "bun run build:benchmarking:watch" "live-server ./benchmarking-dist"',"generate-test-plan":"bun run scripts/generate-test-plan.ts"},devDependencies:{"@biomejs/biome":"^1.8.3","@resvg/resvg-js":"^2.6.2","@tscircuit/capacity-autorouter":"^0.0.140","@tscircuit/checks":"^0.0.85","@tscircuit/circuit-json-util":"^0.0.72","@tscircuit/common":"^0.0.20","@tscircuit/copper-pour-solver":"^0.0.14","@tscircuit/footprinter":"^0.0.236","@tscircuit/import-snippet":"^0.0.4","@tscircuit/infgrid-ijump-astar":"^0.0.33","@tscircuit/log-soup":"^1.0.2","@tscircuit/matchpack":"^0.0.16","@tscircuit/math-utils":"^0.0.29","@tscircuit/miniflex":"^0.0.4","@tscircuit/ngspice-spice-engine":"^0.0.3","@tscircuit/props":"^0.0.403","@tscircuit/schematic-autolayout":"^0.0.6","@tscircuit/schematic-match-adapt":"^0.0.16","@tscircuit/schematic-trace-solver":"^v0.0.45","@tscircuit/solver-utils":"^0.0.3","@types/bun":"^1.2.16","@types/debug":"^4.1.12","@types/react":"^19.1.8","@types/react-dom":"^19.1.6","@types/react-reconciler":"^0.28.9","bpc-graph":"^0.0.57","bun-match-svg":"0.0.12","calculate-elbow":"^0.0.12","chokidar-cli":"^3.0.0","circuit-json":"^0.0.317","circuit-json-to-bpc":"^0.0.13","circuit-json-to-connectivity-map":"^0.0.22","circuit-json-to-gltf":"^0.0.31","circuit-json-to-simple-3d":"^0.0.9","circuit-json-to-spice":"^0.0.24","circuit-to-svg":"^0.0.274",concurrently:"^9.1.2","connectivity-map":"^1.0.0",debug:"^4.3.6","eecircuit-engine":"^1.5.6",flatbush:"^4.5.0","graphics-debug":"^0.0.60",howfat:"^0.3.8","live-server":"^1.2.2","looks-same":"^9.0.1",minicssgrid:"^0.0.9","pkg-pr-new":"^0.0.37",poppygl:"^0.0.16",react:"^19.1.0","react-dom":"^19.1.0","schematic-symbols":"^0.0.202",spicey:"^0.0.14","ts-expect":"^1.3.0",tsup:"^8.2.4"},peerDependencies:{"@tscircuit/capacity-autorouter":"*","@tscircuit/checks":"*","@tscircuit/circuit-json-util":"*","@tscircuit/footprinter":"*","@tscircuit/infgrid-ijump-astar":"*","@tscircuit/math-utils":"*","@tscircuit/props":"*","@tscircuit/schematic-autolayout":"*","@tscircuit/schematic-match-adapt":"*","circuit-json-to-bpc":"*","bpc-graph":"*","@tscircuit/matchpack":"*","circuit-json":"*","circuit-json-to-connectivity-map":"*","schematic-symbols":"*",typescript:"^5.0.0"},dependencies:{"@flatten-js/core":"^1.6.2","@lume/kiwi":"^0.4.3","calculate-packing":"0.0.50","css-select":"5.1.0","format-si-unit":"^0.0.3",nanoid:"^5.0.7","performance-now":"^2.1.0","react-reconciler":"^0.32.0","transformation-matrix":"^2.16.1",zod:"^3.25.67"}},K_=class{constructor({platform:n,projectUrl:e}={}){d(this,"firstChild",null);d(this,"children");d(this,"db");d(this,"root",null);d(this,"isRoot",!0);d(this,"_schematicDisabledOverride");d(this,"pcbDisabled",!1);d(this,"pcbRoutingDisabled",!1);d(this,"_featureMspSchematicTraceRouting",!0);d(this,"name");d(this,"platform");d(this,"projectUrl");d(this,"_hasRenderedAtleastOnce",!1);d(this,"_eventListeners",{});this.children=[],this.db=Me([]),this.root=this,this.platform=n,this.projectUrl=e,this.pcbDisabled=n?.pcbDisabled??!1}get schematicDisabled(){return this._schematicDisabledOverride!==void 0?this._schematicDisabledOverride:this._getBoard()?._parsedProps?.schematicDisabled??!1}set schematicDisabled(n){this._schematicDisabledOverride=n}add(n){let e;(0,cit.isValidElement)(n)?e=Xet(n):e=n,this.children.push(e)}setPlatform(n){this.platform={...this.platform,...n}}_getBoard(){let n=this.children.find(e=>e.componentName==="Board");if(n)return n}_guessRootComponent(){if(this.firstChild)return;if(this.children.length===0)throw new Error("Not able to guess root component: RootCircuit has no children (use circuit.add(...))");let n=this.children.filter(t=>t.lowercaseComponentName==="panel");if(n.length>1)throw new Error("Only one <panel> is allowed per circuit");if(n.length===1){if(this.children.length!==1)throw new Error("<panel> must be the root element of the circuit");this.firstChild=n[0];return}if(this.children.length===1&&this.children[0].isGroup){this.firstChild=this.children[0];return}let e=new _l({subcircuit:!0});e.parent=this,e.addAll(this.children),this.children=[e],this.firstChild=e}render(){this.firstChild||this._guessRootComponent();let{firstChild:n,db:e}=this;if(!n)throw new Error("RootCircuit has no root component");n.parent=this,n.runRenderCycle(),this._hasRenderedAtleastOnce=!0}async renderUntilSettled(){for(this.db.source_project_metadata.list()?.[0]||this.db.source_project_metadata.insert({software_used_string:`@tscircuit/core@${this.getCoreVersion()}`,...this.projectUrl?{project_url:this.projectUrl}:{}}),this.render();this._hasIncompleteAsyncEffects();)await new Promise(e=>setTimeout(e,100)),this.render();this.emit("renderComplete")}_hasIncompleteAsyncEffects(){return this.children.some(n=>n._hasIncompleteAsyncEffects()?!0:n.children.some(e=>e._hasIncompleteAsyncEffects()))}getCircuitJson(){return this._hasRenderedAtleastOnce||this.render(),this.db.toArray()}toJson(){return this.getCircuitJson()}async getSvg(n){let e=await Promise.resolve().then(()=>(cet(),aet)).catch(t=>{throw new Error(`To use circuit.getSvg, you must install the "circuit-to-svg" package.

"${t.message}"`)});if(n.view==="pcb")return e.convertCircuitJsonToPcbSvg(this.getCircuitJson());if(n.view==="schematic")return e.convertCircuitJsonToSchematicSvg(this.getCircuitJson());throw new Error(`Invalid view: ${n.view}`)}getCoreVersion(){let[n,e,t]=M7t.version.split(".").map(Number);return`${n}.${e}.${t+1}`}async preview(n){let e=typeof n=="object"?n:{previewName:n};throw new Error("project.preview is not yet implemented")}computeSchematicGlobalTransform(){return tr()}_computePcbGlobalTransformBeforeLayout(){return tr()}selectAll(n){return this._guessRootComponent(),this.firstChild?.selectAll(n)??[]}selectOne(n,e){return this._guessRootComponent(),this.firstChild?.selectOne(n,e)??null}emit(n,...e){if(this._eventListeners[n])for(let t of this._eventListeners[n])t(...e)}on(n,e){this._eventListeners[n]||(this._eventListeners[n]=[]),this._eventListeners[n].push(e)}removeListener(n,e){this._eventListeners[n]&&(this._eventListeners[n]=this._eventListeners[n].filter(t=>t!==e))}enableDebug(n){typeof n=="string"?c9.default.enable(n):(n===null||n===!1)&&c9.default.disable()}getClientOrigin(){return typeof window<"u"&&window.location?window.location.origin:typeof self<"u"&&self.location?self.location.origin:""}},C7t=K_,I7t=K_,N7t=n=>{let[e,t]=V_.default.useState(!0),[i,r]=V_.default.useState(null),[s,o]=V_.default.useState(),[a,c]=V_.default.useState();return V_.default.useEffect(()=>{t(!0),r(null),n&&setTimeout(()=>{try{let l=new K_;l.add(n),o(l),c(l.toJson())}catch(l){r(l)}t(!1)},1)},[n]),{isLoading:e,error:i,circuit:s,circuitJson:a}},J_=(n,e)=>(t,i)=>{let r=[];Array.isArray(e)?r.push(...e.flat()):typeof e=="object"&&r.push(...Object.values(e).flat(),...Object.keys(e));let s=o=>{if(o?.name&&o.name!==t)throw new Error(`Component name mismatch. Hook name: ${t}, Component prop name: ${o.name}`);let a={...i,...o,name:t},c=[];for(let l of r)if(a[l]){let u=`.${t} > .${l}`,p=a[l];c.push({from:u,to:p}),delete a[l]}return(0,Nd.jsxs)(Nd.Fragment,{children:[(0,Nd.jsx)(n,{...a}),c.map((l,u)=>(0,Nd.jsx)("trace",{...l},u))]})};for(let o of r)s[o]=`.${t} > .${o}`;return s},A7t=J_(n=>(0,lit.jsx)("capacitor",{...n}),$H),R7t=n=>J_(e=>(0,uit.jsx)("chip",{pinLabels:n,...e}),n),O7t=J_(n=>(0,pit.jsx)("diode",{...n}),eW),L7t=J_(n=>(0,hit.jsx)("led",{...n}),iW),F7t=J_(n=>(0,dit.jsx)("resistor",{...n}),RH),z7t=new Proxy(n=>new Proxy({},{get:(e,t)=>`.${n} > .${t}`}),{get:(n,e)=>{let t=(...i)=>{let r=i[0];return new Proxy({},{get:(s,o)=>`.${e} > .${o}`})};return new Proxy(t,{get:(i,r)=>e==="net"?`net.${r}`:e==="subcircuit"?new Proxy({},{get:(s,o)=>new Proxy({},{get:(a,c)=>`subcircuit.${r} > .${o} > .${c}`})}):`.${e} > .${r}`,apply:(i,r,s)=>e==="net"?new Proxy({},{get:(o,a)=>`net.${a}`}):new Proxy({},{get:(o,a)=>{let c=`.${e} > .${a}`;return["U","J","CN"].some(u=>e.startsWith(u))?c:new Proxy(new String(c),{get:(u,p)=>typeof p=="symbol"||p==="toString"?()=>c:`.${e} > .${a} > .${p}`})}})})}});Yet(zet);Yet({Bug:U1});var Oit=Gt(qs(),1);var mit=n=>{let e=n.match(/:[RC]_(\d{4})_/);if(e||(e=n.match(/:(SOIC-\d+|SOT-\d+|SOD-\d+|SSOP-\d+|TSSOP-\d+|QFP-\d+|QFN-\d+)/),e))return e[1]};var w9=n=>n.includes("cap")?n.replace(/cap/g,""):n;var _it=n=>{if(n){if(n.startsWith("kicad:")){let e=mit(n);return e?w9(e):n}return w9(n)}};var P9=new Map,Er=async(n,e)=>{let t=new URLSearchParams({...e,json:"true"}).toString();if(P9.has(t))return P9.get(t);let r=await(await fetch(`https://jlcsearch.tscircuit.com/${n}/list?${t}`)).json();return P9.set(t,r),r},Mr=n=>n?[...n].sort((e,t)=>Number(t.is_basic??!1)-Number(e.is_basic??!1)):[],yit={findPart:async({sourceComponent:n,footprinterString:e})=>{let t=_it(e);if(n.type==="source_component"&&n.ftype==="simple_resistor"){let{resistors:i}=await Er("resistors",{resistance:n.resistance,package:t});return{jlcpcb:Mr(i).map(r=>`C${r.lcsc}`).slice(0,3)}}else if(n.type==="source_component"&&n.ftype==="simple_capacitor"){let{capacitors:i}=await Er("capacitors",{capacitance:n.capacitance,package:t});return{jlcpcb:Mr(i).map(r=>`C${r.lcsc}`).slice(0,3)}}else if(n.type==="source_component"&&n.ftype==="simple_pin_header"){let i;e?.includes("_p")&&(i=Number(e.split("_p")[1]));let{headers:r}=await Er("headers",i?{pitch:i,num_pins:n.pin_count,gender:n.gender}:{num_pins:n.pin_count,gender:n.gender});return{jlcpcb:Mr(r).map(s=>`C${s.lcsc}`).slice(0,3)}}else if(n.type==="source_component"&&n.ftype==="simple_potentiometer"){let{potentiometers:i}=await Er("potentiometers",{resistance:n.max_resistance,package:t});return{jlcpcb:Mr(i).map(r=>`C${r.lcsc}`).slice(0,3)}}else if(n.type==="source_component"&&n.ftype==="simple_diode"){let{diodes:i}=await Er("diodes",{package:t});return{jlcpcb:Mr(i).map(r=>`C${r.lcsc}`).slice(0,3)}}else if(n.type==="source_component"&&n.ftype==="simple_chip"){let{chips:i}=await Er("chips",{package:t});return{jlcpcb:Mr(i).map(r=>`C${r.lcsc}`).slice(0,3)}}else if(n.type==="source_component"&&n.ftype==="simple_transistor"){let{transistors:i}=await Er("transistors",{package:t,transistor_type:n.transistor_type});return{jlcpcb:Mr(i).map(r=>`C${r.lcsc}`).slice(0,3)}}else if(n.type==="source_component"&&n.ftype==="simple_power_source"){let{power_sources:i}=await Er("power_sources",{voltage:n.voltage,package:t});return{jlcpcb:Mr(i).map(r=>`C${r.lcsc}`).slice(0,3)}}else if(n.type==="source_component"&&n.ftype==="simple_inductor"){let{inductors:i}=await Er("inductors",{inductance:n.inductance,package:t});return{jlcpcb:Mr(i).map(r=>`C${r.lcsc}`).slice(0,3)}}else if(n.type==="source_component"&&n.ftype==="simple_crystal"){let{crystals:i}=await Er("crystals",{frequency:n.frequency,load_capacitance:n.load_capacitance,package:t});return{jlcpcb:Mr(i).map(r=>`C${r.lcsc}`).slice(0,3)}}else if(n.type==="source_component"&&n.ftype==="simple_mosfet"){let{mosfets:i}=await Er("mosfets",{package:t,mosfet_mode:n.mosfet_mode,channel_type:n.channel_type});return{jlcpcb:Mr(i).map(r=>`C${r.lcsc}`).slice(0,3)}}else if(n.type==="source_component"&&n.ftype==="simple_resonator"){let{resonators:i}=await Er("resonators",{frequency:n.frequency,package:t});return{jlcpcb:Mr(i).map(r=>`C${r.lcsc}`).slice(0,3)}}else if(n.type==="source_component"&&n.ftype==="simple_switch"){let{switches:i}=await Er("switches",{switch_type:n.type,package:t});return{jlcpcb:Mr(i).map(r=>`C${r.lcsc}`).slice(0,3)}}else if(n.type==="source_component"&&n.ftype==="simple_led"){let{leds:i}=await Er("leds",{package:t});return{jlcpcb:Mr(i).map(r=>`C${r.lcsc}`).slice(0,3)}}else if(n.type==="source_component"&&n.ftype==="simple_fuse"){let{fuses:i}=await Er("fuses",{package:t});return{jlcpcb:Mr(i).map(r=>`C${r.lcsc}`).slice(0,3)}}return{}}};var Sit=Gt(git(),1);Q();var Eit=Gt(Mn(),1),Mit=Gt(Mn(),1),bi=h.tuple([h.coerce.number(),h.coerce.number()]),H7t=h.tuple([h.number(),h.number(),h.number()]),hP=h.union([bi,H7t]),W7t=h.object({kind:h.literal("arc"),start:bi,mid:bi,end:bi}),q7t=h.union([bi,W7t]),wit=h.object({at:hP,size:bi,layer:h.string(),layers:h.array(h.string()),roundrect_rratio:h.number(),uuid:h.string()}).partial(),Z7t=h.object({key:h.string(),val:h.string(),attributes:wit}),lP=h.object({oval:h.boolean().default(!1),width:h.number().optional(),height:h.number().optional(),offset:bi.optional()}),Pit=h.object({name:h.string(),pad_type:h.enum(["thru_hole","smd","np_thru_hole","connect"]),pad_shape:h.enum(["roundrect","circle","rect","oval","trapezoid","custom"]),at:hP,drill:h.union([h.number(),h.array(h.any()),lP]).transform(n=>typeof n=="number"?{oval:!1,width:n,height:n}:"oval"in n?n:n.length===2?{oval:!1,width:Number.parseFloat(n[0]),height:Number.parseFloat(n[0]),offset:bi.parse(n[1].slice(1))}:n.length===3||n.length===4?{oval:n[0]==="oval",width:Number.parseFloat(n[1]),height:Number.parseFloat(n[2]),offset:n[3]?bi.parse(n[3].slice(1)):void 0}:n).pipe(lP),size:h.union([h.array(h.number()).length(2).transform(([n,e])=>({width:n,height:e})),h.object({width:h.number(),height:h.number()})]),layers:h.array(h.string()).optional(),roundrect_rratio:h.number().optional(),uuid:h.string().optional()}),kit=h.object({name:h.string(),pad_type:h.enum(["thru_hole","smd","np_thru_hole","connect"]),pad_shape:h.enum(["roundrect","circle","rect","oval","trapezoid","custom"]),at:hP,size:bi,drill:h.union([h.number(),h.array(h.any()),lP]).transform(n=>typeof n=="number"?{oval:!1,width:n,height:n}:"oval"in n?n:n.length===2?{oval:!1,width:Number.parseFloat(n[0]),height:Number.parseFloat(n[0]),offset:bi.parse(n[1].slice(1))}:n.length===3||n.length===4?{oval:n[0]==="oval",width:Number.parseFloat(n[1]),height:Number.parseFloat(n[2]),offset:n[3]?bi.parse(n[3].slice(1)):void 0}:n).pipe(lP).optional(),layers:h.array(h.string()).optional(),roundrect_rratio:h.number().optional(),chamfer_ratio:h.number().optional(),solder_paste_margin:h.number().optional(),solder_paste_margin_ratio:h.number().optional(),clearance:h.number().optional(),zone_connection:h.union([h.literal(0).describe("Pad is not connect to zone"),h.literal(1).describe("Pad is connected to zone using thermal relief"),h.literal(2).describe("Pad is connected to zone using solid fill")]).optional(),thermal_width:h.number().optional(),thermal_gap:h.number().optional(),uuid:h.string().optional()}),Tit=h.object({font:h.object({size:bi,thickness:h.number().optional()})}).partial(),K7t=h.object({fp_text_type:h.literal("user"),text:h.string(),at:hP,layer:h.string(),uuid:h.string().optional(),effects:Tit.partial()}),J7t=h.object({start:bi,mid:bi,end:bi,stroke:h.object({width:h.number(),type:h.string()}),layer:h.string(),uuid:h.string().optional()}),Q7t=h.object({center:bi,end:bi,stroke:h.object({width:h.number(),type:h.string()}),fill:h.string().optional(),layer:h.string(),uuid:h.string().optional()}),tFt=h.object({pts:h.array(q7t),stroke:h.object({width:h.number(),type:h.string()}).optional(),width:h.number().optional(),layer:h.string(),uuid:h.string().optional(),fill:h.string().optional()}).transform(n=>({...n,width:void 0,stroke:n.stroke??{width:n.width}})),eFt=h.object({start:bi,end:bi,stroke:h.object({width:h.number(),type:h.string()}).optional(),width:h.number().optional(),layer:h.string(),uuid:h.string().optional()}).transform(n=>({...n,width:void 0,stroke:n.stroke??{width:n.width}})),xit=h.object({footprint_name:h.string(),version:h.string().optional(),generator:h.string().optional(),generator_version:h.string().optional(),layer:h.string(),descr:h.string().default(""),tags:h.array(h.string()).optional(),properties:h.array(Z7t),fp_lines:h.array(eFt),fp_texts:h.array(K7t),fp_arcs:h.array(J7t),fp_circles:h.array(Q7t).optional(),fp_polys:h.array(tFt).optional(),pads:h.array(kit),holes:h.array(Pit).optional()}),uP=(n,e)=>{if(e==="effects"&&Array.isArray(n)){let t={};for(let i of n)if(i[0]==="font"){let r={};for(let s of i.slice(1))s.length===2?r[s[0].valueOf()]=Number.parseFloat(s[1].valueOf()):r[s[0].valueOf()]=s.slice(1).map(o=>Number.parseFloat(o.valueOf()));t.font=r}return Tit.parse(t)}if(e==="pts")return n.map(t=>{let i=t[0]?.valueOf?.()??t[0];if(i==="xy")return t.slice(1).map(r=>Number.parseFloat(r.valueOf()));if(i==="arc"){let r={kind:"arc"};for(let s of t.slice(1)){let o=s[0].valueOf();r[o]=s.slice(1).map(a=>Number.parseFloat(a.valueOf()))}return r}return t});if(e==="stroke"){let t={};for(let i of n){let r=i[0].valueOf();t[r]=uP(i.slice(1),r)}return t}return e==="at"||e==="size"||e==="start"||e==="mid"||e==="end"?(Array.isArray(n)?n:[n]).map(i=>i?.valueOf?.()??i).filter(i=>typeof i=="number"||typeof i=="string"&&/^[-+]?\d*\.?\d+(e[-+]?\d+)?$/i.test(i)).map(i=>typeof i=="number"?i:Number.parseFloat(i)):e==="tags"?n.map(t=>t.valueOf()):e==="generator_version"||e==="version"?n[0].valueOf():n.length===2?n.valueOf():e==="uuid"?Array.isArray(n)?n[0].valueOf():n.valueOf():/^[\d\.]+$/.test(n)&&!Number.isNaN(Number.parseFloat(n))?Number.parseFloat(n):Array.isArray(n)&&n.length===1?n[0].valueOf():Array.isArray(n)?n.map(t=>t.valueOf()):n},Be=(n,e)=>{for(let t of n)if(Array.isArray(t)&&t[0]===e)return uP(t.slice(1),e)},k9=(0,Eit.default)("kicad-mod-converter"),nFt=n=>{let e=(0,Sit.default)(n),t=e[1].valueOf(),i={},r=Object.entries(xit.shape).filter(([k,T])=>T._def.typeName==="ZodString"||k==="tags").map(([k])=>k);for(let k of e.slice(2)){if(!r.includes(k[0]))continue;let T=k[0].valueOf(),I=uP(k.slice(1),T);i[T]=I}let s=e.slice(2).filter(k=>k[0]==="property").map(k=>{let T=k[1].valueOf(),I=k[2].valueOf(),E=wit.parse(k.slice(3).reduce((N,M)=>{let A=M[0].valueOf();return N[A]=uP(M.slice(1),A),N},{}));return{key:T,val:I,attributes:E}}),o=e.slice(2).filter(k=>k[0]==="pad"),a=[];for(let k of o){let T=Be(k,"at"),I=Be(k,"size"),E=Be(k,"drill"),N=Be(k,"layers");if(Array.isArray(N)?N=N.map(j=>j.valueOf()):typeof N=="string"?N=[N]:N||(N=[]),!N.includes("F.Cu")){k9(`Skipping pad without F.Cu layer: layers=${N.join(", ")}`);continue}let M=Be(k,"roundrect_rratio"),A=Be(k,"uuid"),R={name:k[1].valueOf(),pad_type:k[2].valueOf(),pad_shape:k[3].valueOf(),at:T,drill:E,size:I,layers:N,roundrect_rratio:M,uuid:A};k9(`attempting to parse pad: ${JSON.stringify(R,null,"  ")}`),a.push(kit.parse(R))}let c=e.slice(2).filter(k=>k[0]==="fp_text"),l=[];for(let k of c){let T=k[2].valueOf(),I=Be(k,"at"),E=Be(k,"layer"),N=Be(k,"uuid"),M=Be(k,"effects");l.push({fp_text_type:"user",text:T,at:I,layer:E,uuid:N,effects:M})}let u=[],p=e.slice(2).filter(k=>k[0]==="fp_line");for(let k of p){let T=Be(k,"start"),I=Be(k,"end"),E=Be(k,"stroke"),N=Be(k,"layer"),M=Be(k,"uuid");u.push({start:T,end:I,stroke:E,layer:N,uuid:M})}let f=[],y=e.slice(2).filter(k=>k[0]==="fp_arc");for(let k of y){let T=Be(k,"start"),I=Be(k,"mid"),E=Be(k,"end"),N=Be(k,"stroke"),M=Be(k,"layer"),A=Be(k,"uuid");!T||!E||!I||!N||!M||f.push({start:T,mid:I,end:E,stroke:N,layer:M,uuid:A})}let g=[],x=e.slice(2).filter(k=>k[0]==="fp_circle");for(let k of x){let T=Be(k,"center"),I=Be(k,"end"),E=Be(k,"stroke"),N=Be(k,"fill"),M=Be(k,"layer"),A=Be(k,"uuid");!T||!I||!E||!M||g.push({center:T,end:I,stroke:E,fill:N,layer:M,uuid:A})}let v=[],P=e.slice(2).filter(k=>k[0]==="fp_poly");for(let k of P){let T=Be(k,"pts"),I=Be(k,"stroke"),E=Be(k,"width"),N=Be(k,"layer"),M=Be(k,"uuid"),A=Be(k,"fill"),R=I;!R&&typeof E=="number"?R={width:E,type:"solid"}:R&&typeof R=="object"&&typeof E=="number"&&R.width===void 0&&(R={...R,width:E}),v.push({pts:T,stroke:R,layer:N,uuid:M,fill:A})}let w=[];for(let k of e.slice(2)){if(k[0]!=="pad"||k[2]?.valueOf?.()!=="thru_hole")continue;let T=k[1]?.valueOf?.(),I=k[2]?.valueOf?.(),E=k[3]?.valueOf?.(),N=Be(k,"at"),M=Be(k,"drill"),A=Be(k,"size");Array.isArray(A)&&(A[0]==="size"&&(A=A.slice(1)),A={width:Number(A[0]),height:Number(A[1])});let R=Be(k,"uuid"),j=Be(k,"roundrect_rratio"),B=Be(k,"layers");Array.isArray(B)?B=B.map(U=>U.valueOf()):typeof B=="string"?B=[B]:B||(B=[]);let G={name:T,pad_type:I,pad_shape:E,at:N,drill:M,size:A,layers:B,roundrect_rratio:j,uuid:R};k9(`attempting to parse holes: ${JSON.stringify(G,null,2)}`),w.push(Pit.parse(G))}return xit.parse({footprint_name:t,...i,properties:s,fp_lines:u,fp_texts:l,fp_arcs:f,fp_circles:g,pads:a,holes:w,fp_polys:v})},V1=Math.PI*2,bit=n=>{let e=n%V1;return e<0&&(e+=V1),e},pP=(n,e)=>{let t=bit(n),r=bit(e)-t;return r<0&&(r+=V1),r};function Cit(n,e,t){let i={x:(n.x+e.x)/2,y:(n.y+e.y)/2},r={x:(e.x+t.x)/2,y:(e.y+t.y)/2},s=-(n.x-e.x)/(n.y-e.y),o=-(e.x-t.x)/(e.y-t.y),a=(i.y-r.y+o*r.x-s*i.x)/(o-s),c=i.y+s*(a-i.x);return{x:a,y:c}}function Iit(n,e){return Math.sqrt((n.x-e.x)**2+(n.y-e.y)**2)}function ty(n,e){return Math.atan2(e.y-n.y,e.x-n.x)}var C9=(n,e,t)=>{let i=Cit(n,e,t),r=Iit(i,n),s=ty(i,n),o=ty(i,e),a=ty(i,t),c=pP(s,o),l=pP(s,a),u=l;return c>l&&(u=l-V1),Math.abs(r*u)};function I9(n,e,t,i){let r=Cit(n,e,t),s=Iit(r,n),o=ty(r,n),a=ty(r,e),c=ty(r,t),l=pP(o,a),u=pP(o,c),p=u;l>u&&(p=u-V1);let f=[];for(let y=0;y<=i;y++){let g=o+y/i*p,x=r.x+s*Math.cos(g),v=r.y+s*Math.sin(g);f.push({x,y:v})}return f}var yl=n=>Array.isArray(n)?{x:n[0],y:n[1]}:n,T9=(n,e,t=1e-4)=>Math.abs(n.x-e.x)<t&&Math.abs(n.y-e.y)<t,iFt=n=>{let e=[],t=new Set;for(let i=0;i<n.length;i++){if(t.has(i))continue;let r=[n[i]];t.add(i);let s=n[i].end,o=!0;for(;o;){if(o=!1,r.length>1&&T9(s,r[0].start)){e.push(r);break}for(let a=0;a<n.length;a++)if(!t.has(a)){if(T9(s,n[a].start)){r.push(n[a]),t.add(a),s=n[a].end,o=!0;break}else if(T9(s,n[a].end)){n[a].type==="arc"?r.push({...n[a],reversed:!0}):r.push({...n[a],start:n[a].end,end:n[a].start}),t.add(a),s=n[a].start,o=!0;break}}if(!o){for(let a=r.length-1;a>=0;a--){let c=n.indexOf(r[a]);c!==-1&&t.delete(c)}break}}}return e},rFt=n=>{let e=[];for(let t of n)if(t.type==="line")e.push(t.start);else if(t.type==="arc"&&t.mid){let i=C9(t.start,t.mid,t.end),r=Math.max(3,Math.ceil(i)),s=I9(t.start,t.mid,t.end,r);t.reversed&&(s=s.reverse()),e.push(...s.slice(0,-1))}return e};function sFt(n){if(!Array.isArray(n))return null;let e=n.find(o=>o.layer?.toLowerCase()==="f.silks"&&(o.text?.includes("${REFERENCE}")||o.fp_text_type?.toLowerCase()==="reference"||o.text?.match(/^R\d+|C\d+|U\d+/))),t=e||n.find(o=>o.layer?.toLowerCase()==="f.fab"&&(o.text?.includes("${REFERENCE}")||o.fp_text_type?.toLowerCase()==="reference")),i=e||t;if(!i?.effects?.font?.size)return null;let[r,s]=i.effects.font.size;return s??r??1}var oFt=n=>n*Math.PI/180,E9=(n,e,t)=>{let i=oFt(t),r=Math.cos(i),s=Math.sin(i);return{x:n*r-e*s,y:n*s+e*r}},aFt=n=>{let e=[...new Map(n.map(u=>[`${u.x},${u.y}`,u])).values()];if(e.length!==4)return null;let t=e.map(u=>u.x),i=e.map(u=>u.y),r=[...new Set(t)],s=[...new Set(i)];if(r.length!==2||s.length!==2)return null;let[o,a]=r.sort((u,p)=>u-p),[c,l]=s.sort((u,p)=>u-p);return o===void 0||a===void 0||c===void 0||l===void 0?null:{x:(o+a)/2,y:(c+l)/2,width:a-o,height:l-c}},cFt=n=>{if(!n)return!1;let e=n.toLowerCase();return e!=="no"&&e!=="none"&&e!=="outline"},M9=n=>n&&Array.isArray(n)&&n.length>=3&&typeof n[2]=="number"?n[2]:0,Vr=n=>{let e=(n%360+360)%360;return e===90||e===270},Ad=n=>{if(n!=null)return`${n}`},vit=n=>{let e=Ad(n),t=e!==void 0?Number(e):NaN;return Number.isFinite(t)?t:void 0},Q_=(0,Mit.default)("kicad-mod-converter"),zs=n=>{switch(n.toLowerCase()){case"f.cu":case"f.fab":case"f.silks":case"edge.cuts":return"top";case"b.cu":case"b.fab":case"b.silks":return"bottom"}},lFt=async n=>{let{fp_lines:e,fp_texts:t,fp_arcs:i,fp_circles:r,pads:s,properties:o,holes:a,fp_polys:c}=n,l=[];l.push({type:"source_component",source_component_id:"source_component_0",supplier_part_numbers:{}}),l.push({type:"schematic_component",schematic_component_id:"schematic_component_0",source_component_id:"source_component_0",center:{x:0,y:0},rotation:0,size:{width:0,height:0}});let u=new Set,p=new Map;for(let V of s){let J=Ad(V.name);if(J){u.add(J);let nt=vit(V.name);nt!==void 0&&p.set(J,nt)}}if(a)for(let V of a){let J=Ad(V.name);if(J){u.add(J);let nt=vit(V.name);nt!==void 0&&p.set(J,nt)}}let f=0,y=new Map;for(let V of u){let J=`source_port_${f++}`;y.set(V,J),l.push({type:"source_port",source_port_id:J,source_component_id:"source_component_0",name:V,port_hints:[V],pin_number:p.get(V)}),l.push({type:"schematic_port",schematic_port_id:`schematic_port_${f++}`,source_port_id:J,schematic_component_id:"schematic_component_0",center:{x:0,y:0}})}let g=Number.POSITIVE_INFINITY,x=Number.NEGATIVE_INFINITY,v=Number.POSITIVE_INFINITY,P=Number.NEGATIVE_INFINITY;for(let V of s){let J=V.at[0],nt=-V.at[1],ut=V.size[0],ht=V.size[1];g=Math.min(g,J-ut/2),x=Math.max(x,J+ut/2),v=Math.min(v,nt-ht/2),P=Math.max(P,nt+ht/2)}let w="pcb_component_0";l.push({type:"pcb_component",source_component_id:"source_component_0",pcb_component_id:w,layer:"top",center:{x:0,y:0},rotation:0,width:Number.isFinite(g)?x-g:0,height:Number.isFinite(v)?P-v:0});let k=0,T=new Map;for(let V of u){let J=`pcb_port_${k++}`,nt=y.get(V);T.set(V,J);let ut=0,ht=0,kt=["top","bottom"],Mt=s.find(ot=>Ad(ot.name)===V);if(Mt)ut=Mt.at[0],ht=-Mt.at[1],kt=Mt.layers?Mt.layers.map(ot=>zs(ot)).filter(Boolean):["top","bottom"];else if(a){let ot=a.find(X=>Ad(X.name)===V);ot&&(ut=ot.at[0],ht=-ot.at[1],kt=ot.layers?ot.layers.map(X=>zs(X)).filter(Boolean):["top","bottom"])}l.push({type:"pcb_port",pcb_port_id:J,source_port_id:nt,pcb_component_id:w,x:ut,y:ht,layers:kt})}let I=0,E=0,N=0;for(let V of s){let J=Ad(V.name),nt=J?p.get(J):void 0;if(V.pad_type==="smd"){let ut=M9(V.at),ht=Vr(ut)?V.size[1]:V.size[0],kt=Vr(ut)?V.size[0]:V.size[1],Mt=J?T.get(J):void 0;l.push({type:"pcb_smtpad",pcb_smtpad_id:`pcb_smtpad_${I++}`,shape:"rect",x:V.at[0],y:-V.at[1],width:ht,height:kt,layer:zs(V.layers?.[0]??"F.Cu"),pcb_component_id:w,port_hints:J?[J]:[],pcb_port_id:Mt,pin_number:nt})}else if(V.pad_type==="thru_hole"){if(V.pad_shape==="rect"){let ut=M9(V.at),ht=Vr(ut)?V.size[1]:V.size[0],kt=Vr(ut)?V.size[0]:V.size[1],Mt=V.drill?.offset?.[0]??0,ot=V.drill?.offset?.[1]??0,X=E9(Mt,ot,ut),W=J?T.get(J):void 0;l.push({type:"pcb_plated_hole",pcb_plated_hole_id:`pcb_plated_hole_${E++}`,shape:"circular_hole_with_rect_pad",hole_shape:"circle",pad_shape:"rect",x:V.at[0],y:-V.at[1],hole_offset_x:-X.x,hole_offset_y:-X.y,hole_diameter:V.drill?.width,rect_pad_width:ht,rect_pad_height:kt,layers:["top","bottom"],pcb_component_id:w,port_hints:J?[J]:[],pcb_port_id:W,pin_number:nt})}else if(V.pad_shape==="circle"){let ut=J?T.get(J):void 0;l.push({type:"pcb_plated_hole",pcb_plated_hole_id:`pcb_plated_hole_${E++}`,shape:"circle",x:V.at[0],y:-V.at[1],outer_diameter:V.size[0],hole_diameter:V.drill?.width,layers:["top","bottom"],pcb_component_id:w,port_hints:J?[J]:[],pcb_port_id:ut,pin_number:nt})}else if(V.pad_shape==="oval"){let ut=J?T.get(J):void 0;l.push({type:"pcb_plated_hole",pcb_plated_hole_id:`pcb_plated_hole_${E++}`,shape:"pill",x:V.at[0],y:-V.at[1],outer_width:V.size[0],outer_height:V.size[1],hole_width:V.drill?.width,hole_height:V.drill?.height,layers:["top","bottom"],pcb_component_id:w,port_hints:J?[J]:[],pcb_port_id:ut,pin_number:nt})}}else V.pad_type==="np_thru_hole"&&l.push({type:"pcb_hole",pcb_hole_id:`pcb_hole_${N++}`,x:V.at[0],y:-V.at[1],hole_diameter:V.drill?.width,pcb_component_id:w})}if(a)for(let V of a){let J=Ad(V.name),nt=J?p.get(J):void 0,ut=V.layers?.some(at=>at.endsWith(".Cu")||at==="*.Cu"),ht=M9(V.at),kt=V.drill?.offset?.[0]??0,Mt=V.drill?.offset?.[1]??0,ot=E9(kt,Mt,ht),X=V.at[0]+ot.x,W=-(V.at[1]+ot.y),rt=V.drill?.width??0,pt=V.size?.width??rt,yt=V.roundrect_rratio??0,Z=yt>0?Math.min(Vr(ht)?V.size?.height??pt:V.size?.width??pt,Vr(ht)?V.size?.width??pt:V.size?.height??pt)/2*yt:0;if(ut)if(V.pad_shape==="rect"){let at=J?T.get(J):void 0;l.push({type:"pcb_plated_hole",pcb_plated_hole_id:`pcb_plated_hole_${E++}`,shape:"circular_hole_with_rect_pad",hole_shape:"circle",pad_shape:"rect",x:V.at[0],y:-V.at[1],hole_offset_x:-ot.x,hole_offset_y:-ot.y,hole_diameter:rt,rect_pad_width:Vr(ht)?V.size?.height??pt:V.size?.width??pt,rect_pad_height:Vr(ht)?V.size?.width??pt:V.size?.height??pt,rect_border_radius:Z,port_hints:J?[J]:[],layers:["top","bottom"],pcb_component_id:w,pcb_port_id:at,pin_number:nt})}else if(V.pad_shape==="oval"){let at=J?T.get(J):void 0;l.push({type:"pcb_plated_hole",pcb_plated_hole_id:`pcb_plated_hole_${E++}`,shape:"pill",x:X,y:W,outer_width:Vr(ht)?V.size?.height??pt:V.size?.width??pt,outer_height:Vr(ht)?V.size?.width??pt:V.size?.height??pt,hole_width:Vr(ht)?V.drill?.height??rt:V.drill?.width??rt,hole_height:Vr(ht)?V.drill?.width??rt:V.drill?.height??rt,port_hints:J?[J]:[],layers:["top","bottom"],pcb_component_id:w,pcb_port_id:at,pin_number:nt})}else if(V.pad_shape==="roundrect"){let at=J?T.get(J):void 0,Et=V.drill?.offset?.[0]??0,Ft=V.drill?.offset?.[1]??0,Ot=E9(Et,Ft,ht),Ce=Vr(ht)?V.size?.height??pt:V.size?.width??pt,Se=Vr(ht)?V.size?.width??pt:V.size?.height??pt;l.push({type:"pcb_plated_hole",pcb_plated_hole_id:`pcb_plated_hole_${E++}`,shape:"circular_hole_with_rect_pad",hole_shape:"circle",pad_shape:"rect",x:X,y:W,hole_offset_x:-Ot.x,hole_offset_y:Ot.y,hole_diameter:rt,rect_pad_width:Ce,rect_pad_height:Se,rect_border_radius:Z,port_hints:J?[J]:[],layers:["top","bottom"],pcb_component_id:w,pcb_port_id:at,pin_number:nt})}else{let at=J?T.get(J):void 0;l.push({type:"pcb_plated_hole",pcb_plated_hole_id:`pcb_plated_hole_${E++}`,shape:"circle",x:X,y:W,outer_diameter:pt,hole_diameter:rt,port_hints:J?[J]:[],layers:["top","bottom"],pcb_component_id:w,pcb_port_id:at,pin_number:nt})}else l.push({type:"pcb_hole",pcb_hole_id:`pcb_hole_${N++}`,x:X,y:W,hole_diameter:pt,hole_shape:"circle",pcb_component_id:w})}let M=[];for(let V of e)V.layer.toLowerCase()==="edge.cuts"&&M.push({type:"line",start:{x:V.start[0],y:V.start[1]},end:{x:V.end[0],y:V.end[1]},strokeWidth:V.stroke.width});for(let V of i)V.layer.toLowerCase()==="edge.cuts"&&M.push({type:"arc",start:{x:V.start[0],y:V.start[1]},mid:{x:V.mid[0],y:V.mid[1]},end:{x:V.end[0],y:V.end[1]},strokeWidth:V.stroke.width});let A=iFt(M),R=0;for(let V of A){let J=rFt(V);J.length>=3&&l.push({type:"pcb_cutout",pcb_cutout_id:`pcb_cutout_${R++}`,shape:"polygon",points:J.map(nt=>({x:nt.x,y:-nt.y})),pcb_component_id:w})}let j=0,B=0,G=0,U=0;for(let V of e){let J=[{x:V.start[0],y:-V.start[1]},{x:V.end[0],y:-V.end[1]}],nt=V.layer.toLowerCase();nt==="f.cu"?l.push({type:"pcb_trace",pcb_trace_id:`pcb_trace_${j++}`,pcb_component_id:w,layer:zs(V.layer),route:J,thickness:V.stroke.width}):nt==="f.silks"?l.push({type:"pcb_silkscreen_path",pcb_silkscreen_path_id:`pcb_silkscreen_path_${B++}`,pcb_component_id:w,layer:"top",route:J,stroke_width:V.stroke.width}):nt==="edge.cuts"?Q_("Skipping Edge.Cuts fp_line (converted to pcb_cutout)",V.layer):nt==="f.fab"?l.push({type:"pcb_fabrication_note_path",fabrication_note_path_id:`fabrication_note_path_${G++}`,pcb_component_id:w,layer:"top",route:J,stroke_width:V.stroke.width,port_hints:[]}):nt.startsWith("user.")?l.push({type:"pcb_note_line",pcb_note_line_id:`pcb_note_line_${U++}`,pcb_component_id:w,x1:V.start[0],y1:-V.start[1],x2:V.end[0],y2:-V.end[1],stroke_width:V.stroke.width}):Q_("Unhandled layer for fp_line",V.layer)}if(c)for(let V of c){let J=[],nt=ot=>{!Number.isFinite(ot.x)||!Number.isFinite(ot.y)||J.push(ot)};for(let ot of V.pts){if(Array.isArray(ot)){nt({x:ot[0],y:-ot[1]});continue}if(ot&&typeof ot=="object"&&"kind"in ot){if(ot.kind==="arc"){let X=yl(ot.start),W=yl(ot.mid),rt=yl(ot.end),pt=C9(X,W,rt),yt=Math.max(8,Math.ceil(pt)),Z=Math.max(2,Math.ceil(pt/.1)),at=I9(X,W,rt,Z).map(Et=>({x:Et.x,y:-Et.y}));for(let Et of at)nt(Et)}continue}}let ut=J,kt=ut.length>2&&ut[0].x===ut[ut.length-1].x&&ut[0].y===ut[ut.length-1].y?ut.slice(0,-1):ut;if(ut.length===0)continue;let Mt=V.stroke?.width??0;if(V.layer.endsWith(".Cu")){let ot=aFt(kt);ot?l.push({type:"pcb_smtpad",pcb_smtpad_id:`pcb_smtpad_${I++}`,shape:"rect",x:ot.x,y:ot.y,width:ot.width,height:ot.height,layer:zs(V.layer),pcb_component_id:w}):cFt(V.fill)?kt.length>=3?l.push({type:"pcb_smtpad",pcb_smtpad_id:`pcb_smtpad_${I++}`,shape:"polygon",points:kt,layer:zs(V.layer),pcb_component_id:w}):kt.length>=2&&l.push({type:"pcb_trace",pcb_trace_id:`pcb_trace_${j++}`,pcb_component_id:w,layer:zs(V.layer),route:kt,thickness:Mt}):kt.length>=2&&l.push({type:"pcb_trace",pcb_trace_id:`pcb_trace_${j++}`,pcb_component_id:w,layer:zs(V.layer),route:kt,thickness:Mt})}else V.layer.endsWith(".SilkS")?l.push({type:"pcb_silkscreen_path",pcb_silkscreen_path_id:`pcb_silkscreen_path_${B++}`,pcb_component_id:w,layer:zs(V.layer),route:ut,stroke_width:Mt}):V.layer.endsWith(".Fab")?l.push({type:"pcb_fabrication_note_path",fabrication_note_path_id:`fabrication_note_path_${G++}`,pcb_component_id:w,layer:zs(V.layer),route:kt,stroke_width:Mt,port_hints:[]}):Q_("Unhandled layer for fp_poly",V.layer)}let H=0;for(let V of i){let J=V.layer.toLowerCase();if(J==="edge.cuts"){Q_("Skipping Edge.Cuts fp_arc (converted to pcb_cutout)",V.layer);continue}let nt=yl(V.start),ut=yl(V.mid),ht=yl(V.end),kt=C9(nt,ut,ht),Mt=I9(nt,ut,ht,Math.ceil(kt));if(J.startsWith("user.")){l.push({type:"pcb_note_path",pcb_note_path_id:`pcb_note_path_${H++}`,pcb_component_id:w,route:Mt.map(X=>({x:X.x,y:-X.y})),stroke_width:V.stroke.width});continue}let ot=zs(V.layer);if(!ot){Q_("Unable to convert layer for fp_arc",V.layer);continue}l.push({type:"pcb_silkscreen_path",pcb_silkscreen_path_id:`pcb_silkscreen_path_${B++}`,layer:ot,pcb_component_id:w,route:Mt.map(X=>({x:X.x,y:-X.y})),stroke_width:V.stroke.width})}if(r)for(let V of r){let J=V.layer.toLowerCase(),nt=yl(V.center),ut=yl(V.end),ht=Math.sqrt((ut.x-nt.x)**2+(ut.y-nt.y)**2),kt=Math.max(16,Math.ceil(2*Math.PI*ht)),Mt=[];for(let ot=0;ot<=kt;ot++){let X=ot/kt*2*Math.PI;Mt.push({x:nt.x+ht*Math.cos(X),y:nt.y+ht*Math.sin(X)})}J.startsWith("user.")&&l.push({type:"pcb_note_path",pcb_note_path_id:`pcb_note_path_${H++}`,pcb_component_id:w,route:Mt.map(ot=>({x:ot.x,y:-ot.y})),stroke_width:V.stroke.width})}for(let V of t){let J=zs(V.layer);V.layer.endsWith(".SilkS")?l.push({type:"pcb_silkscreen_text",layer:J,font:"tscircuit2024",font_size:V.effects?.font?.size[0]??1,pcb_component_id:w,anchor_position:{x:V.at[0],y:-V.at[1]},anchor_alignment:"center",text:V.text}):V.layer.endsWith(".Fab")?l.push({type:"pcb_fabrication_note_text",layer:J,font:"tscircuit2024",font_size:V.effects?.font?.size[0]??1,pcb_component_id:w,anchor_position:{x:V.at[0],y:-V.at[1]},anchor_alignment:"center",text:V.text}):Q_("Unhandled layer for fp_text",V.layer)}let tt=o.find(V=>V.key==="Reference"),et=o.find(V=>V.key==="Value"),mt=[tt,et].filter(V=>V&&!!V.val);for(let V of mt){let J=V.attributes.at;if(!J)continue;let ut=V.attributes.layer?.toLowerCase()?.endsWith(".fab"),ht=sFt(t);l.push({type:ut?"pcb_fabrication_note_text":"pcb_silkscreen_text",layer:"top",font:"tscircuit2024",font_size:ht,pcb_component_id:w,anchor_position:{x:J[0],y:-J[1]},anchor_alignment:"center",text:V.val})}return l},Nit=async n=>{let e=nFt(n);return await lFt(e)};var Ait=async n=>{try{return(await import(n)).default}catch{console.log(`Failed to load ${n} locally, trying CDN fallback...`);try{let t=await fetch(`https://cdn.jsdelivr.net/npm/${n}/+esm`);if(!t.ok)throw new Error(`Failed to fetch ${n} from CDN: ${t.statusText}`);let i=await t.text(),r=new Blob([i],{type:"application/javascript"}),s=URL.createObjectURL(r);try{let{default:o}=await import(s);return o}finally{URL.revokeObjectURL(s)}}catch(t){throw console.error(`CDN fallback for ${n} also failed:`,t),t}}};var uFt="https://kicad-mod-cache.tscircuit.com",dP=null,Rit=()=>({partsEngine:yit,spiceEngineMap:{ngspice:{simulate:async n=>{if(!dP){let e=await Ait("@tscircuit/ngspice-spice-engine").catch(t=>{throw new Error("Could not load ngspice engine from local node_modules or CDN fallback.",{cause:t})});e&&(dP=await e())}if(!dP)throw new Error("Could not load ngspice engine from local node_modules or CDN fallback.");return dP.simulate(n)}}},footprintLibraryMap:{kicad:async n=>{let e=`${uFt}/${n}`,t=`${e}.circuit.json`,r=await(await fetch(t)).json(),s=Array.isArray(r)?r.filter(a=>a?.type==="pcb_silkscreen_text"?a?.text==="REF**":!0):r,o=`${e}.wrl`;return{footprintCircuitJson:s,cadModel:{wrlUrl:o,modelUnitToMmScale:2.54}}}},footprintFileParserMap:{kicad_mod:{loadFromUrl:async n=>{let e=await fetch(n).then(i=>i.text()),t=await Nit(e);return{footprintCircuitJson:Array.isArray(t)?t:[t]}}}}});var N9=Gt(Mn(),1),oxe=(0,N9.default)("tsci:eval:execution-context");function fP(n,e={}){globalThis.React=Oit;let t=e.platform||Rit(),i=e.projectConfig?{...t,...e.projectConfig}:t;i.partsEngineDisabled&&(i.partsEngine=void 0);let r=new K_({platform:i});e.name&&(r.name=e.name),e.debugNamespace&&r.enableDebug(e.debugNamespace);let s=[];return{fsMap:{},entrypoint:"",logger:{info:o=>{s.push({msg:o})},getLogs:()=>s,stringifyLogs:()=>s.map(o=>o.msg).join(`
`)},preSuppliedImports:{"@tscircuit/core":aP,tscircuit:aP,"@tscircuit/math-utils":_4,react:Oit,debug:N9.default,"@tscircuit/props":{}},circuit:r,tsConfig:null,importStack:[],currentlyImporting:new Set,...n}}function gl(n){let e=n;return e=e.replace(/\\/g,"/"),e=e.trim(),e.startsWith("./")&&(e=e.slice(2)),e.startsWith("/")&&(e=e.slice(1)),e}function Lit(n){let e={};for(let[t,i]of Object.entries(n))e[gl(t)]=i;return e}function co(n){if(!n)return".";let t=n.replace(/\\/g,"/").replace(/\/+$/,"");return t.indexOf("/")===-1?".":t.substring(0,t.lastIndexOf("/"))||"/"}function mP(n,e){if(n.startsWith("../")){let t=co(e);return mP(n.slice(3),t)}return n.startsWith("./")?mP(n.slice(2),e):n.startsWith("/")?n.slice(1):`${e}/${n}`}function G1(n){if(Array.isArray(n))return null;let e=n["tsconfig.json"];if(!e)return null;try{let t=e.replace(/\/\*[\s\S]*?\*\/|\/\/.*/g,"");return JSON.parse(t)}catch(t){throw new Error(`Failed to parse tsconfig.json: ${t.message}`)}}function Fit(n){let{importPath:e,normalizedFilePathMap:t,extensions:i,tsConfig:r}=n,s=r?.compilerOptions?.paths;if(!s)return null;let o=r?.compilerOptions?.baseUrl||".",a=l=>{let u=gl(l);if(t.has(u))return t.get(u);for(let p of i){let f=`${u}.${p}`;if(t.has(f))return t.get(f)}return null};for(let[l,u]of Object.entries(s))if(l.includes("*")){let[f,y]=l.split("*");if(!e.startsWith(f)||!e.endsWith(y||""))continue;let g=e.slice(f.length,e.length-(y?y.length:0));for(let x of u){let v=x.replace("*",g),P=o&&!v.startsWith("./")&&!v.startsWith("/")?`${o}/${v}`:v,w=a(P);if(w)return w}}else{if(e!==l)continue;for(let f of u){let y=o&&!f.startsWith("./")&&!f.startsWith("/")?`${o}/${f}`:f,g=a(y);if(g)return g}}let c=A9({importPath:e,normalizedFilePathMap:t,extensions:i,tsConfig:r});return c||null}function A9(n){let{importPath:e,normalizedFilePathMap:t,extensions:i,tsConfig:r}=n,s=r?.compilerOptions?.baseUrl;if(!s)return null;let o=`${s}/${e}`,a=gl(o);if(t.has(a))return t.get(a);for(let c of i){let l=`${a}.${c}`;if(t.has(l))return t.get(l)}return null}function zit(n,e){let t=e?.compilerOptions?.paths;if(!t)return!1;for(let[i]of Object.entries(t))if(i.includes("*")){let[s,o]=i.split("*");if(n.startsWith(s)&&n.endsWith(o||""))return!0}else if(n===i)return!0;return!1}var H1=(n,e,t,i={})=>{let r=t?mP(n,t):n,s=new Set(Array.isArray(e)?e:Object.keys(e));if(s.has(r))return r;let o=new Map;for(let u of s)o.set(gl(u),u);let a=gl(r);if(o.has(a))return o.get(a);let c=["tsx","ts","json","js","jsx","obj","gltf","glb"];for(let u of c){let p=`${a}.${u}`;if(o.has(p))return o.get(p)}let l=i.tsConfig??null;if(!n.startsWith("./")&&!n.startsWith("../")){let u=Fit({importPath:n,normalizedFilePathMap:o,extensions:c,tsConfig:l});if(u)return u;let p=A9({importPath:n,normalizedFilePathMap:o,extensions:c,tsConfig:l});if(p)return p}if(!n.startsWith("./")&&!n.startsWith("../")){let u=gl(n);if(o.has(u))return o.get(u);for(let p of c){let f=`${u}.${p}`;if(o.has(f))return o.get(f)}}return null},_P=(n,e,t,i={})=>{let r=H1(n,e,t,i);if(!r)throw new Error(`File not found "${n}", available paths:

${Object.keys(e).join(", ")}`);return r};var yP=n=>{let e=/^\s*import\s+(?:(?:[\w\s]+,\s*)?(?:\*\s+as\s+[\w\s]+|\{[\s\w,]+\}|\w+)\s+from\s*)?['"](.+?)['"]/gm,t=[],i;for(;(i=e.exec(n))!==null;){let o=i[0];/^\s*import\s+type\b/.test(o)||t.push(i[1])}let r=/^\s*export\s+(?:type\s+)?(?:\*\s+as\s+[\w$]+|\*|\{[^}]+\})\s+from\s*['"](.+?)['"]/gm,s;for(;(s=r.exec(n))!==null;){let o=s[0];/^\s*export\s+type\b/.test(o)||t.push(s[1])}return t};function Rd(n,e,t){globalThis.__tscircuit_require=r=>{let s=H1(r,e,t),o=s&&e[s];if(!e[r]&&!o)throw new Error(`Import "${r}" not found ${t?`in "${t}"`:""}`);let a=e[r]||e[s];return new Proxy(a,{get(c,l){if(!(l in c)){if(l==="default")return c.default!==void 0?c.default:c.__esModule?void 0:typeof c=="function"||typeof c=="object"?c:void 0;if(l==="__esModule")return!0;throw new Error(`Component "${String(l)}" is not exported by "${r}"`)}return c[l]}})};let i=`
  var exports = {};
  var require = globalThis.__tscircuit_require;
  var module = { exports };
  var circuit = globalThis.__tscircuit_circuit;
  ${n};
  return module;`.trim();return Function(i).call(globalThis)}var Elt=Gt(Mn(),1);var pFt=[".glb",".kicad_mod",".gltf",".obj",".stl"],$it=n=>pFt.some(e=>n.endsWith(e));var it;(function(n){n[n.NONE=0]="NONE";let t=1;n[n._abstract=t]="_abstract";let i=t+1;n[n._accessor=i]="_accessor";let r=i+1;n[n._as=r]="_as";let s=r+1;n[n._assert=s]="_assert";let o=s+1;n[n._asserts=o]="_asserts";let a=o+1;n[n._async=a]="_async";let c=a+1;n[n._await=c]="_await";let l=c+1;n[n._checks=l]="_checks";let u=l+1;n[n._constructor=u]="_constructor";let p=u+1;n[n._declare=p]="_declare";let f=p+1;n[n._enum=f]="_enum";let y=f+1;n[n._exports=y]="_exports";let g=y+1;n[n._from=g]="_from";let x=g+1;n[n._get=x]="_get";let v=x+1;n[n._global=v]="_global";let P=v+1;n[n._implements=P]="_implements";let w=P+1;n[n._infer=w]="_infer";let k=w+1;n[n._interface=k]="_interface";let T=k+1;n[n._is=T]="_is";let I=T+1;n[n._keyof=I]="_keyof";let E=I+1;n[n._mixins=E]="_mixins";let N=E+1;n[n._module=N]="_module";let M=N+1;n[n._namespace=M]="_namespace";let A=M+1;n[n._of=A]="_of";let R=A+1;n[n._opaque=R]="_opaque";let j=R+1;n[n._out=j]="_out";let B=j+1;n[n._override=B]="_override";let G=B+1;n[n._private=G]="_private";let U=G+1;n[n._protected=U]="_protected";let H=U+1;n[n._proto=H]="_proto";let tt=H+1;n[n._public=tt]="_public";let et=tt+1;n[n._readonly=et]="_readonly";let mt=et+1;n[n._require=mt]="_require";let V=mt+1;n[n._satisfies=V]="_satisfies";let J=V+1;n[n._set=J]="_set";let nt=J+1;n[n._static=nt]="_static";let ut=nt+1;n[n._symbol=ut]="_symbol";let ht=ut+1;n[n._type=ht]="_type";let kt=ht+1;n[n._unique=kt]="_unique";let Mt=kt+1;n[n._using=Mt]="_using"})(it||(it={}));var b;(function(n){n[n.PRECEDENCE_MASK=15]="PRECEDENCE_MASK";let t=16;n[n.IS_KEYWORD=t]="IS_KEYWORD";let i=32;n[n.IS_ASSIGN=i]="IS_ASSIGN";let r=64;n[n.IS_RIGHT_ASSOCIATIVE=r]="IS_RIGHT_ASSOCIATIVE";let s=128;n[n.IS_PREFIX=s]="IS_PREFIX";let o=256;n[n.IS_POSTFIX=o]="IS_POSTFIX";let a=512;n[n.IS_EXPRESSION_START=a]="IS_EXPRESSION_START";let c=512;n[n.num=c]="num";let l=1536;n[n.bigint=l]="bigint";let u=2560;n[n.decimal=u]="decimal";let p=3584;n[n.regexp=p]="regexp";let f=4608;n[n.string=f]="string";let y=5632;n[n.name=y]="name";let g=6144;n[n.eof=g]="eof";let x=7680;n[n.bracketL=x]="bracketL";let v=8192;n[n.bracketR=v]="bracketR";let P=9728;n[n.braceL=P]="braceL";let w=10752;n[n.braceBarL=w]="braceBarL";let k=11264;n[n.braceR=k]="braceR";let T=12288;n[n.braceBarR=T]="braceBarR";let I=13824;n[n.parenL=I]="parenL";let E=14336;n[n.parenR=E]="parenR";let N=15360;n[n.comma=N]="comma";let M=16384;n[n.semi=M]="semi";let A=17408;n[n.colon=A]="colon";let R=18432;n[n.doubleColon=R]="doubleColon";let j=19456;n[n.dot=j]="dot";let B=20480;n[n.question=B]="question";let G=21504;n[n.questionDot=G]="questionDot";let U=22528;n[n.arrow=U]="arrow";let H=23552;n[n.template=H]="template";let tt=24576;n[n.ellipsis=tt]="ellipsis";let et=25600;n[n.backQuote=et]="backQuote";let mt=27136;n[n.dollarBraceL=mt]="dollarBraceL";let V=27648;n[n.at=V]="at";let J=29184;n[n.hash=J]="hash";let nt=29728;n[n.eq=nt]="eq";let ut=30752;n[n.assign=ut]="assign";let ht=32640;n[n.preIncDec=ht]="preIncDec";let kt=33664;n[n.postIncDec=kt]="postIncDec";let Mt=34432;n[n.bang=Mt]="bang";let ot=35456;n[n.tilde=ot]="tilde";let X=35841;n[n.pipeline=X]="pipeline";let W=36866;n[n.nullishCoalescing=W]="nullishCoalescing";let rt=37890;n[n.logicalOR=rt]="logicalOR";let pt=38915;n[n.logicalAND=pt]="logicalAND";let yt=39940;n[n.bitwiseOR=yt]="bitwiseOR";let Z=40965;n[n.bitwiseXOR=Z]="bitwiseXOR";let at=41990;n[n.bitwiseAND=at]="bitwiseAND";let Et=43015;n[n.equality=Et]="equality";let Ft=44040;n[n.lessThan=Ft]="lessThan";let Ot=45064;n[n.greaterThan=Ot]="greaterThan";let Ce=46088;n[n.relationalOrEqual=Ce]="relationalOrEqual";let Se=47113;n[n.bitShiftL=Se]="bitShiftL";let Kt=48137;n[n.bitShiftR=Kt]="bitShiftR";let le=49802;n[n.plus=le]="plus";let Jt=50826;n[n.minus=Jt]="minus";let qn=51723;n[n.modulo=qn]="modulo";let Ii=52235;n[n.star=Ii]="star";let Nr=53259;n[n.slash=Nr]="slash";let Xs=54348;n[n.exponent=Xs]="exponent";let Ar=55296;n[n.jsxName=Ar]="jsxName";let So=56320;n[n.jsxText=So]="jsxText";let Mf=57344;n[n.jsxEmptyText=Mf]="jsxEmptyText";let Cf=58880;n[n.jsxTagStart=Cf]="jsxTagStart";let If=59392;n[n.jsxTagEnd=If]="jsxTagEnd";let Nf=60928;n[n.typeParameterStart=Nf]="typeParameterStart";let Af=61440;n[n.nonNullAssertion=Af]="nonNullAssertion";let xy=62480;n[n._break=xy]="_break";let qp=63504;n[n._case=qp]="_case";let by=64528;n[n._catch=by]="_catch";let Rf=65552;n[n._continue=Rf]="_continue";let vy=66576;n[n._debugger=vy]="_debugger";let Zp=67600;n[n._default=Zp]="_default";let lc=68624;n[n._do=lc]="_do";let Of=69648;n[n._else=Of]="_else";let uc=70672;n[n._finally=uc]="_finally";let Lf=71696;n[n._for=Lf]="_for";let pc=73232;n[n._function=pc]="_function";let Ff=73744;n[n._if=Ff]="_if";let zf=74768;n[n._return=zf]="_return";let $f=75792;n[n._switch=$f]="_switch";let hc=77456;n[n._throw=hc]="_throw";let dc=77840;n[n._try=dc]="_try";let Kp=78864;n[n._var=Kp]="_var";let wo=79888;n[n._let=wo]="_let";let Df=80912;n[n._const=Df]="_const";let fc=81936;n[n._while=fc]="_while";let Jp=82960;n[n._with=Jp]="_with";let Qp=84496;n[n._new=Qp]="_new";let fs=85520;n[n._this=fs]="_this";let ms=86544;n[n._super=ms]="_super";let ra=87568;n[n._class=ra]="_class";let th=88080;n[n._extends=th]="_extends";let sa=89104;n[n._export=sa]="_export";let oa=90640;n[n._import=oa]="_import";let jf=91664;n[n._yield=jf]="_yield";let Bf=92688;n[n._null=Bf]="_null";let Yf=93712;n[n._true=Yf]="_true";let eh=94736;n[n._false=eh]="_false";let nh=95256;n[n._in=nh]="_in";let Fn=96280;n[n._instanceof=Fn]="_instanceof";let ih=97936;n[n._typeof=ih]="_typeof";let rh=98960;n[n._void=rh]="_void";let j0=99984;n[n._delete=j0]="_delete";let B0=100880;n[n._async=B0]="_async";let fT=101904;n[n._get=fT]="_get";let Sy=102928;n[n._set=Sy]="_set";let wy=103952;n[n._declare=wy]="_declare";let Py=104976;n[n._readonly=Py]="_readonly";let cr=106e3;n[n._abstract=cr]="_abstract";let ei=107024;n[n._static=ei]="_static";let ky=107536;n[n._public=ky]="_public";let sh=108560;n[n._private=sh]="_private";let Xf=109584;n[n._protected=Xf]="_protected";let Ty=110608;n[n._override=Ty]="_override";let Us=112144;n[n._as=Us]="_as";let Uf=113168;n[n._enum=Uf]="_enum";let Ey=114192;n[n._type=Ey]="_type";let My=115216;n[n._implements=My]="_implements"})(b||(b={}));function R9(n){switch(n){case b.num:return"num";case b.bigint:return"bigint";case b.decimal:return"decimal";case b.regexp:return"regexp";case b.string:return"string";case b.name:return"name";case b.eof:return"eof";case b.bracketL:return"[";case b.bracketR:return"]";case b.braceL:return"{";case b.braceBarL:return"{|";case b.braceR:return"}";case b.braceBarR:return"|}";case b.parenL:return"(";case b.parenR:return")";case b.comma:return",";case b.semi:return";";case b.colon:return":";case b.doubleColon:return"::";case b.dot:return".";case b.question:return"?";case b.questionDot:return"?.";case b.arrow:return"=>";case b.template:return"template";case b.ellipsis:return"...";case b.backQuote:return"`";case b.dollarBraceL:return"${";case b.at:return"@";case b.hash:return"#";case b.eq:return"=";case b.assign:return"_=";case b.preIncDec:return"++/--";case b.postIncDec:return"++/--";case b.bang:return"!";case b.tilde:return"~";case b.pipeline:return"|>";case b.nullishCoalescing:return"??";case b.logicalOR:return"||";case b.logicalAND:return"&&";case b.bitwiseOR:return"|";case b.bitwiseXOR:return"^";case b.bitwiseAND:return"&";case b.equality:return"==/!=";case b.lessThan:return"<";case b.greaterThan:return">";case b.relationalOrEqual:return"<=/>=";case b.bitShiftL:return"<<";case b.bitShiftR:return">>/>>>";case b.plus:return"+";case b.minus:return"-";case b.modulo:return"%";case b.star:return"*";case b.slash:return"/";case b.exponent:return"**";case b.jsxName:return"jsxName";case b.jsxText:return"jsxText";case b.jsxEmptyText:return"jsxEmptyText";case b.jsxTagStart:return"jsxTagStart";case b.jsxTagEnd:return"jsxTagEnd";case b.typeParameterStart:return"typeParameterStart";case b.nonNullAssertion:return"nonNullAssertion";case b._break:return"break";case b._case:return"case";case b._catch:return"catch";case b._continue:return"continue";case b._debugger:return"debugger";case b._default:return"default";case b._do:return"do";case b._else:return"else";case b._finally:return"finally";case b._for:return"for";case b._function:return"function";case b._if:return"if";case b._return:return"return";case b._switch:return"switch";case b._throw:return"throw";case b._try:return"try";case b._var:return"var";case b._let:return"let";case b._const:return"const";case b._while:return"while";case b._with:return"with";case b._new:return"new";case b._this:return"this";case b._super:return"super";case b._class:return"class";case b._extends:return"extends";case b._export:return"export";case b._import:return"import";case b._yield:return"yield";case b._null:return"null";case b._true:return"true";case b._false:return"false";case b._in:return"in";case b._instanceof:return"instanceof";case b._typeof:return"typeof";case b._void:return"void";case b._delete:return"delete";case b._async:return"async";case b._get:return"get";case b._set:return"set";case b._declare:return"declare";case b._readonly:return"readonly";case b._abstract:return"abstract";case b._static:return"static";case b._public:return"public";case b._private:return"private";case b._protected:return"protected";case b._override:return"override";case b._as:return"as";case b._enum:return"enum";case b._type:return"type";case b._implements:return"implements";default:return""}}var Gr=class{constructor(e,t,i){this.startTokenIndex=e,this.endTokenIndex=t,this.isFunctionScope=i}},O9=class{constructor(e,t,i,r,s,o,a,c,l,u,p,f,y){this.potentialArrowAt=e,this.noAnonFunctionType=t,this.inDisallowConditionalTypesContext=i,this.tokensLength=r,this.scopesLength=s,this.pos=o,this.type=a,this.contextualKeyword=c,this.start=l,this.end=u,this.isType=p,this.scopeDepth=f,this.error=y}},W1=class n{constructor(){n.prototype.__init.call(this),n.prototype.__init2.call(this),n.prototype.__init3.call(this),n.prototype.__init4.call(this),n.prototype.__init5.call(this),n.prototype.__init6.call(this),n.prototype.__init7.call(this),n.prototype.__init8.call(this),n.prototype.__init9.call(this),n.prototype.__init10.call(this),n.prototype.__init11.call(this),n.prototype.__init12.call(this),n.prototype.__init13.call(this)}__init(){this.potentialArrowAt=-1}__init2(){this.noAnonFunctionType=!1}__init3(){this.inDisallowConditionalTypesContext=!1}__init4(){this.tokens=[]}__init5(){this.scopes=[]}__init6(){this.pos=0}__init7(){this.type=b.eof}__init8(){this.contextualKeyword=it.NONE}__init9(){this.start=0}__init10(){this.end=0}__init11(){this.isType=!1}__init12(){this.scopeDepth=0}__init13(){this.error=null}snapshot(){return new O9(this.potentialArrowAt,this.noAnonFunctionType,this.inDisallowConditionalTypesContext,this.tokens.length,this.scopes.length,this.pos,this.type,this.contextualKeyword,this.start,this.end,this.isType,this.scopeDepth,this.error)}restoreFromSnapshot(e){this.potentialArrowAt=e.potentialArrowAt,this.noAnonFunctionType=e.noAnonFunctionType,this.inDisallowConditionalTypesContext=e.inDisallowConditionalTypesContext,this.tokens.length=e.tokensLength,this.scopes.length=e.scopesLength,this.pos=e.pos,this.type=e.type,this.contextualKeyword=e.contextualKeyword,this.start=e.start,this.end=e.end,this.isType=e.isType,this.scopeDepth=e.scopeDepth,this.error=e.error}};var lt;(function(n){n[n.backSpace=8]="backSpace";let t=10;n[n.lineFeed=t]="lineFeed";let i=9;n[n.tab=i]="tab";let r=13;n[n.carriageReturn=r]="carriageReturn";let s=14;n[n.shiftOut=s]="shiftOut";let o=32;n[n.space=o]="space";let a=33;n[n.exclamationMark=a]="exclamationMark";let c=34;n[n.quotationMark=c]="quotationMark";let l=35;n[n.numberSign=l]="numberSign";let u=36;n[n.dollarSign=u]="dollarSign";let p=37;n[n.percentSign=p]="percentSign";let f=38;n[n.ampersand=f]="ampersand";let y=39;n[n.apostrophe=y]="apostrophe";let g=40;n[n.leftParenthesis=g]="leftParenthesis";let x=41;n[n.rightParenthesis=x]="rightParenthesis";let v=42;n[n.asterisk=v]="asterisk";let P=43;n[n.plusSign=P]="plusSign";let w=44;n[n.comma=w]="comma";let k=45;n[n.dash=k]="dash";let T=46;n[n.dot=T]="dot";let I=47;n[n.slash=I]="slash";let E=48;n[n.digit0=E]="digit0";let N=49;n[n.digit1=N]="digit1";let M=50;n[n.digit2=M]="digit2";let A=51;n[n.digit3=A]="digit3";let R=52;n[n.digit4=R]="digit4";let j=53;n[n.digit5=j]="digit5";let B=54;n[n.digit6=B]="digit6";let G=55;n[n.digit7=G]="digit7";let U=56;n[n.digit8=U]="digit8";let H=57;n[n.digit9=H]="digit9";let tt=58;n[n.colon=tt]="colon";let et=59;n[n.semicolon=et]="semicolon";let mt=60;n[n.lessThan=mt]="lessThan";let V=61;n[n.equalsTo=V]="equalsTo";let J=62;n[n.greaterThan=J]="greaterThan";let nt=63;n[n.questionMark=nt]="questionMark";let ut=64;n[n.atSign=ut]="atSign";let ht=65;n[n.uppercaseA=ht]="uppercaseA";let kt=66;n[n.uppercaseB=kt]="uppercaseB";let Mt=67;n[n.uppercaseC=Mt]="uppercaseC";let ot=68;n[n.uppercaseD=ot]="uppercaseD";let X=69;n[n.uppercaseE=X]="uppercaseE";let W=70;n[n.uppercaseF=W]="uppercaseF";let rt=71;n[n.uppercaseG=rt]="uppercaseG";let pt=72;n[n.uppercaseH=pt]="uppercaseH";let yt=73;n[n.uppercaseI=yt]="uppercaseI";let Z=74;n[n.uppercaseJ=Z]="uppercaseJ";let at=75;n[n.uppercaseK=at]="uppercaseK";let Et=76;n[n.uppercaseL=Et]="uppercaseL";let Ft=77;n[n.uppercaseM=Ft]="uppercaseM";let Ot=78;n[n.uppercaseN=Ot]="uppercaseN";let Ce=79;n[n.uppercaseO=Ce]="uppercaseO";let Se=80;n[n.uppercaseP=Se]="uppercaseP";let Kt=81;n[n.uppercaseQ=Kt]="uppercaseQ";let le=82;n[n.uppercaseR=le]="uppercaseR";let Jt=83;n[n.uppercaseS=Jt]="uppercaseS";let qn=84;n[n.uppercaseT=qn]="uppercaseT";let Ii=85;n[n.uppercaseU=Ii]="uppercaseU";let Nr=86;n[n.uppercaseV=Nr]="uppercaseV";let Xs=87;n[n.uppercaseW=Xs]="uppercaseW";let Ar=88;n[n.uppercaseX=Ar]="uppercaseX";let So=89;n[n.uppercaseY=So]="uppercaseY";let Mf=90;n[n.uppercaseZ=Mf]="uppercaseZ";let Cf=91;n[n.leftSquareBracket=Cf]="leftSquareBracket";let If=92;n[n.backslash=If]="backslash";let Nf=93;n[n.rightSquareBracket=Nf]="rightSquareBracket";let Af=94;n[n.caret=Af]="caret";let xy=95;n[n.underscore=xy]="underscore";let qp=96;n[n.graveAccent=qp]="graveAccent";let by=97;n[n.lowercaseA=by]="lowercaseA";let Rf=98;n[n.lowercaseB=Rf]="lowercaseB";let vy=99;n[n.lowercaseC=vy]="lowercaseC";let Zp=100;n[n.lowercaseD=Zp]="lowercaseD";let lc=101;n[n.lowercaseE=lc]="lowercaseE";let Of=102;n[n.lowercaseF=Of]="lowercaseF";let uc=103;n[n.lowercaseG=uc]="lowercaseG";let Lf=104;n[n.lowercaseH=Lf]="lowercaseH";let pc=105;n[n.lowercaseI=pc]="lowercaseI";let Ff=106;n[n.lowercaseJ=Ff]="lowercaseJ";let zf=107;n[n.lowercaseK=zf]="lowercaseK";let $f=108;n[n.lowercaseL=$f]="lowercaseL";let hc=109;n[n.lowercaseM=hc]="lowercaseM";let dc=110;n[n.lowercaseN=dc]="lowercaseN";let Kp=111;n[n.lowercaseO=Kp]="lowercaseO";let wo=112;n[n.lowercaseP=wo]="lowercaseP";let Df=113;n[n.lowercaseQ=Df]="lowercaseQ";let fc=114;n[n.lowercaseR=fc]="lowercaseR";let Jp=115;n[n.lowercaseS=Jp]="lowercaseS";let Qp=116;n[n.lowercaseT=Qp]="lowercaseT";let fs=117;n[n.lowercaseU=fs]="lowercaseU";let ms=118;n[n.lowercaseV=ms]="lowercaseV";let ra=119;n[n.lowercaseW=ra]="lowercaseW";let th=120;n[n.lowercaseX=th]="lowercaseX";let sa=121;n[n.lowercaseY=sa]="lowercaseY";let oa=122;n[n.lowercaseZ=oa]="lowercaseZ";let jf=123;n[n.leftCurlyBrace=jf]="leftCurlyBrace";let Bf=124;n[n.verticalBar=Bf]="verticalBar";let Yf=125;n[n.rightCurlyBrace=Yf]="rightCurlyBrace";let eh=126;n[n.tilde=eh]="tilde";let nh=160;n[n.nonBreakingSpace=nh]="nonBreakingSpace";let Fn=5760;n[n.oghamSpaceMark=Fn]="oghamSpaceMark";let ih=8232;n[n.lineSeparator=ih]="lineSeparator";let rh=8233;n[n.paragraphSeparator=rh]="paragraphSeparator"})(lt||(lt={}));var ey,Oe,Ye,F,Rt,Dit;function Od(){return Dit++}function jit(n){if("pos"in n){let e=hFt(n.pos);n.message+=` (${e.line}:${e.column})`,n.loc=e}return n}var L9=class{constructor(e,t){this.line=e,this.column=t}};function hFt(n){let e=1,t=1;for(let i=0;i<n;i++)Rt.charCodeAt(i)===lt.lineFeed?(e++,t=1):t++;return new L9(e,t)}function Bit(n,e,t,i){Rt=n,F=new W1,Dit=1,ey=e,Oe=t,Ye=i}function te(n){return F.contextualKeyword===n}function ny(n){let e=Ga();return e.type===b.name&&e.contextualKeyword===n}function Wn(n){return F.contextualKeyword===n&&bt(b.name)}function Ln(n){Wn(n)||he()}function ar(){return q(b.eof)||q(b.braceR)||Hi()}function Hi(){let n=F.tokens[F.tokens.length-1],e=n?n.end:0;for(let t=e;t<F.start;t++){let i=Rt.charCodeAt(t);if(i===lt.lineFeed||i===lt.carriageReturn||i===8232||i===8233)return!0}return!1}function gP(){let n=q1();for(let e=F.end;e<n;e++){let t=Rt.charCodeAt(e);if(t===lt.lineFeed||t===lt.carriageReturn||t===8232||t===8233)return!0}return!1}function $s(){return bt(b.semi)||ar()}function vn(){$s()||he('Unexpected token, expected ";"')}function wt(n){bt(n)||he(`Unexpected token, expected "${R9(n)}"`)}function he(n="Unexpected token",e=F.start){if(F.error)return;let t=new SyntaxError(n);t.pos=e,F.error=t,F.pos=Rt.length,be(b.eof)}var F9=[9,11,12,lt.space,lt.nonBreakingSpace,lt.oghamSpaceMark,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279],z9=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,$9=new Uint8Array(65536);for(let n of F9)$9[n]=1;function dFt(n){if(n<48)return n===36;if(n<58)return!0;if(n<65)return!1;if(n<91)return!0;if(n<97)return n===95;if(n<123)return!0;if(n<128)return!1;throw new Error("Should not be called with non-ASCII char code.")}var Cr=new Uint8Array(65536);for(let n=0;n<128;n++)Cr[n]=dFt(n)?1:0;for(let n=128;n<65536;n++)Cr[n]=1;for(let n of F9)Cr[n]=0;Cr[8232]=0;Cr[8233]=0;var Ha=Cr.slice();for(let n=lt.digit0;n<=lt.digit9;n++)Ha[n]=0;var D9=new Int32Array([-1,27,783,918,1755,2376,2862,3483,-1,3699,-1,4617,4752,4833,5130,5508,5940,-1,6480,6939,7749,8181,8451,8613,-1,8829,-1,-1,-1,54,243,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,432,-1,-1,-1,675,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,81,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,108,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,135,-1,-1,-1,-1,-1,-1,-1,-1,-1,162,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,189,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,216,-1,-1,-1,-1,-1,-1,it._abstract<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,270,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,297,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,324,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,351,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,378,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,405,-1,-1,-1,-1,-1,-1,-1,-1,it._accessor<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,it._as<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,459,-1,-1,-1,-1,-1,594,-1,-1,-1,-1,-1,-1,486,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,513,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,540,-1,-1,-1,-1,-1,-1,it._assert<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,567,-1,-1,-1,-1,-1,-1,-1,it._asserts<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,621,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,648,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,it._async<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,702,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,729,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,756,-1,-1,-1,-1,-1,-1,it._await<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,810,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,837,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,864,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,891,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,(b._break<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,945,-1,-1,-1,-1,-1,-1,1107,-1,-1,-1,1242,-1,-1,1350,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,972,1026,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,999,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,(b._case<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1053,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1080,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,(b._catch<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1134,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1161,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1188,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1215,-1,-1,-1,-1,-1,-1,-1,it._checks<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1269,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1296,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1323,-1,-1,-1,-1,-1,-1,-1,(b._class<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1377,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1404,1620,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1431,-1,-1,-1,-1,-1,-1,(b._const<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1458,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1485,-1,-1,-1,-1,-1,-1,-1,-1,1512,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1539,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1566,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1593,-1,-1,-1,-1,-1,-1,-1,-1,it._constructor<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1647,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1674,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1701,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1728,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,(b._continue<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1782,-1,-1,-1,-1,-1,-1,-1,-1,-1,2349,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1809,1971,-1,-1,2106,-1,-1,-1,-1,-1,2241,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1836,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1863,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1890,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1917,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1944,-1,-1,-1,-1,-1,-1,-1,-1,(b._debugger<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1998,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2025,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2052,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2079,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,it._declare<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2133,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2160,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2187,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2214,-1,-1,-1,-1,-1,-1,(b._default<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2268,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2295,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2322,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,(b._delete<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,(b._do<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2403,-1,2484,-1,-1,-1,-1,-1,-1,-1,-1,-1,2565,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2430,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2457,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,(b._else<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2511,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2538,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,it._enum<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2592,-1,-1,-1,2727,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2619,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2646,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2673,-1,-1,-1,-1,-1,-1,(b._export<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2700,-1,-1,-1,-1,-1,-1,-1,it._exports<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2754,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2781,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2808,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2835,-1,-1,-1,-1,-1,-1,-1,(b._extends<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2889,-1,-1,-1,-1,-1,-1,-1,2997,-1,-1,-1,-1,-1,3159,-1,-1,3213,-1,-1,3294,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2916,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2943,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2970,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,(b._false<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3024,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3051,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3078,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3105,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3132,-1,(b._finally<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3186,-1,-1,-1,-1,-1,-1,-1,-1,(b._for<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3240,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3267,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,it._from<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3321,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3348,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3375,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3402,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3429,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3456,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,(b._function<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3510,-1,-1,-1,-1,-1,-1,3564,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3537,-1,-1,-1,-1,-1,-1,it._get<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3591,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3618,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3645,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3672,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,it._global<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3726,-1,-1,-1,-1,-1,-1,3753,4077,-1,-1,-1,-1,4590,-1,-1,-1,-1,-1,-1,-1,(b._if<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3780,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3807,-1,-1,3996,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3834,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3861,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3888,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3915,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3942,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3969,-1,-1,-1,-1,-1,-1,-1,it._implements<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4023,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4050,-1,-1,-1,-1,-1,-1,(b._import<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,(b._in<<1)+1,-1,-1,-1,-1,-1,4104,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4185,4401,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4131,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4158,-1,-1,-1,-1,-1,-1,-1,-1,it._infer<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4212,-1,-1,-1,-1,-1,-1,-1,4239,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4266,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4293,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4320,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4347,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4374,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,(b._instanceof<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4428,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4455,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4482,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4509,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4536,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4563,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,it._interface<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,it._is<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4644,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4671,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4698,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4725,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,it._keyof<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4779,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4806,-1,-1,-1,-1,-1,-1,(b._let<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4860,-1,-1,-1,-1,-1,4995,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4887,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4914,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4941,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4968,-1,-1,-1,-1,-1,-1,-1,it._mixins<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5022,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5049,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5076,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5103,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,it._module<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5157,-1,-1,-1,5373,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5427,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5184,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5211,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5238,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5265,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5292,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5319,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5346,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,it._namespace<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5400,-1,-1,-1,(b._new<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5454,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5481,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,(b._null<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5535,-1,-1,-1,-1,-1,-1,-1,-1,-1,5562,-1,-1,-1,-1,5697,5751,-1,-1,-1,-1,it._of<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5589,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5616,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5643,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5670,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,it._opaque<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5724,-1,-1,-1,-1,-1,-1,it._out<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5778,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5805,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5832,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5859,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5886,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5913,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,it._override<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5967,-1,-1,6345,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5994,-1,-1,-1,-1,-1,6129,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6021,-1,-1,-1,-1,-1,6048,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6075,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6102,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,it._private<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6156,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6183,-1,-1,-1,-1,-1,-1,-1,-1,-1,6318,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6210,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6237,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6264,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6291,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,it._protected<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,it._proto<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6372,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6399,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6426,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6453,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,it._public<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6507,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6534,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6696,-1,-1,6831,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6561,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6588,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6615,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6642,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6669,-1,it._readonly<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6723,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6750,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6777,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6804,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,it._require<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6858,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6885,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6912,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,(b._return<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6966,-1,-1,-1,7182,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7236,7371,-1,7479,-1,7614,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6993,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7020,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7047,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7074,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7101,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7128,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7155,-1,-1,-1,-1,-1,-1,-1,it._satisfies<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7209,-1,-1,-1,-1,-1,-1,it._set<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7263,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7290,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7317,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7344,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,it._static<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7398,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7425,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7452,-1,-1,-1,-1,-1,-1,-1,-1,(b._super<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7506,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7533,-1,-1,-1,-1,-1,-1,-1,-1,-1,7560,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7587,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,(b._switch<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7641,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7668,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7695,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7722,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,it._symbol<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7776,-1,-1,-1,-1,-1,-1,-1,-1,-1,7938,-1,-1,-1,-1,-1,-1,8046,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7803,-1,-1,-1,-1,-1,-1,-1,-1,7857,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7830,-1,-1,-1,-1,-1,-1,-1,(b._this<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7884,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7911,-1,-1,-1,(b._throw<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7965,-1,-1,-1,8019,-1,-1,-1,-1,-1,-1,7992,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,(b._true<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,(b._try<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8073,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8100,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,it._type<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8127,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8154,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,(b._typeof<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8208,-1,-1,-1,-1,8343,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8235,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8262,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8289,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8316,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,it._unique<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8370,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8397,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8424,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,it._using<<1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8478,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8532,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8505,-1,-1,-1,-1,-1,-1,-1,-1,(b._var<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8559,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8586,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,(b._void<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8640,8748,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8667,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8694,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8721,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,(b._while<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8775,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8802,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,(b._with<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8856,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8883,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8910,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8937,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,(b._yield<<1)+1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]);function j9(){let n=0,e=0,t=F.pos;for(;t<Rt.length&&(e=Rt.charCodeAt(t),!(e<lt.lowercaseA||e>lt.lowercaseZ));){let r=D9[n+(e-lt.lowercaseA)+1];if(r===-1)break;n=r,t++}let i=D9[n];if(i>-1&&!Cr[e]){F.pos=t,i&1?be(i>>>1):be(b.name,i>>>1);return}for(;t<Rt.length;){let r=Rt.charCodeAt(t);if(Cr[r])t++;else if(r===lt.backslash){if(t+=2,Rt.charCodeAt(t)===lt.leftCurlyBrace){for(;t<Rt.length&&Rt.charCodeAt(t)!==lt.rightCurlyBrace;)t++;t++}}else if(r===lt.atSign&&Rt.charCodeAt(t+1)===lt.atSign)t+=2;else break}F.pos=t,be(b.name)}var ee;(function(n){n[n.Access=0]="Access";let t=1;n[n.ExportAccess=t]="ExportAccess";let i=t+1;n[n.TopLevelDeclaration=i]="TopLevelDeclaration";let r=i+1;n[n.FunctionScopedDeclaration=r]="FunctionScopedDeclaration";let s=r+1;n[n.BlockScopedDeclaration=s]="BlockScopedDeclaration";let o=s+1;n[n.ObjectShorthandTopLevelDeclaration=o]="ObjectShorthandTopLevelDeclaration";let a=o+1;n[n.ObjectShorthandFunctionScopedDeclaration=a]="ObjectShorthandFunctionScopedDeclaration";let c=a+1;n[n.ObjectShorthandBlockScopedDeclaration=c]="ObjectShorthandBlockScopedDeclaration";let l=c+1;n[n.ObjectShorthand=l]="ObjectShorthand";let u=l+1;n[n.ImportDeclaration=u]="ImportDeclaration";let p=u+1;n[n.ObjectKey=p]="ObjectKey";let f=p+1;n[n.ImportAccess=f]="ImportAccess"})(ee||(ee={}));var ps;(function(n){n[n.NoChildren=0]="NoChildren";let t=1;n[n.OneChild=t]="OneChild";let i=t+1;n[n.StaticChildren=i]="StaticChildren";let r=i+1;n[n.KeyAfterPropSpread=r]="KeyAfterPropSpread"})(ps||(ps={}));function xP(n){let e=n.identifierRole;return e===ee.TopLevelDeclaration||e===ee.FunctionScopedDeclaration||e===ee.BlockScopedDeclaration||e===ee.ObjectShorthandTopLevelDeclaration||e===ee.ObjectShorthandFunctionScopedDeclaration||e===ee.ObjectShorthandBlockScopedDeclaration}function Yit(n){let e=n.identifierRole;return e===ee.FunctionScopedDeclaration||e===ee.BlockScopedDeclaration||e===ee.ObjectShorthandFunctionScopedDeclaration||e===ee.ObjectShorthandBlockScopedDeclaration}function bP(n){let e=n.identifierRole;return e===ee.TopLevelDeclaration||e===ee.ObjectShorthandTopLevelDeclaration||e===ee.ImportDeclaration}function Xit(n){let e=n.identifierRole;return e===ee.TopLevelDeclaration||e===ee.BlockScopedDeclaration||e===ee.ObjectShorthandTopLevelDeclaration||e===ee.ObjectShorthandBlockScopedDeclaration}function Uit(n){let e=n.identifierRole;return e===ee.FunctionScopedDeclaration||e===ee.ObjectShorthandFunctionScopedDeclaration}function Vit(n){return n.identifierRole===ee.ObjectShorthandTopLevelDeclaration||n.identifierRole===ee.ObjectShorthandBlockScopedDeclaration||n.identifierRole===ee.ObjectShorthandFunctionScopedDeclaration}var Ld=class{constructor(){this.type=F.type,this.contextualKeyword=F.contextualKeyword,this.start=F.start,this.end=F.end,this.scopeDepth=F.scopeDepth,this.isType=F.isType,this.identifierRole=null,this.jsxRole=null,this.shadowsGlobal=!1,this.isAsyncOperation=!1,this.contextId=null,this.rhsEndIndex=null,this.isExpression=!1,this.numNullishCoalesceStarts=0,this.numNullishCoalesceEnds=0,this.isOptionalChainStart=!1,this.isOptionalChainEnd=!1,this.subscriptStartIndex=null,this.nullishStartIndex=null}};function Pt(){F.tokens.push(new Ld),V9()}function Wo(){F.tokens.push(new Ld),F.start=F.pos,MFt()}function Git(){F.type===b.assign&&--F.pos,kFt()}function Pe(n){for(let t=F.tokens.length-n;t<F.tokens.length;t++)F.tokens[t].isType=!0;let e=F.isType;return F.isType=!0,e}function ve(n){F.isType=n}function bt(n){return q(n)?(Pt(),!0):!1}function vP(n){let e=F.isType;F.isType=!0,bt(n),F.isType=e}function q(n){return F.type===n}function Sn(){let n=F.snapshot();Pt();let e=F.type;return F.restoreFromSnapshot(n),e}var Y9=class{constructor(e,t){this.type=e,this.contextualKeyword=t}};function Ga(){let n=F.snapshot();Pt();let e=F.type,t=F.contextualKeyword;return F.restoreFromSnapshot(n),new Y9(e,t)}function q1(){return X9(F.pos)}function X9(n){z9.lastIndex=n;let e=z9.exec(Rt);return n+e[0].length}function U9(){return Rt.charCodeAt(q1())}function V9(){if(H9(),F.start=F.pos,F.pos>=Rt.length){let n=F.tokens;n.length>=2&&n[n.length-1].start>=Rt.length&&n[n.length-2].start>=Rt.length&&he("Unexpectedly reached the end of input."),be(b.eof);return}fFt(Rt.charCodeAt(F.pos))}function fFt(n){Ha[n]||n===lt.backslash||n===lt.atSign&&Rt.charCodeAt(F.pos+1)===lt.atSign?j9():W9(n)}function mFt(){for(;Rt.charCodeAt(F.pos)!==lt.asterisk||Rt.charCodeAt(F.pos+1)!==lt.slash;)if(F.pos++,F.pos>Rt.length){he("Unterminated comment",F.pos-2);return}F.pos+=2}function G9(n){let e=Rt.charCodeAt(F.pos+=n);if(F.pos<Rt.length)for(;e!==lt.lineFeed&&e!==lt.carriageReturn&&e!==lt.lineSeparator&&e!==lt.paragraphSeparator&&++F.pos<Rt.length;)e=Rt.charCodeAt(F.pos)}function H9(){for(;F.pos<Rt.length;){let n=Rt.charCodeAt(F.pos);switch(n){case lt.carriageReturn:Rt.charCodeAt(F.pos+1)===lt.lineFeed&&++F.pos;case lt.lineFeed:case lt.lineSeparator:case lt.paragraphSeparator:++F.pos;break;case lt.slash:switch(Rt.charCodeAt(F.pos+1)){case lt.asterisk:F.pos+=2,mFt();break;case lt.slash:G9(2);break;default:return}break;default:if($9[n])++F.pos;else return}}}function be(n,e=it.NONE){F.end=F.pos,F.type=n,F.contextualKeyword=e}function _Ft(){let n=Rt.charCodeAt(F.pos+1);if(n>=lt.digit0&&n<=lt.digit9){Wit(!0);return}n===lt.dot&&Rt.charCodeAt(F.pos+2)===lt.dot?(F.pos+=3,be(b.ellipsis)):(++F.pos,be(b.dot))}function yFt(){Rt.charCodeAt(F.pos+1)===lt.equalsTo?hn(b.assign,2):hn(b.slash,1)}function gFt(n){let e=n===lt.asterisk?b.star:b.modulo,t=1,i=Rt.charCodeAt(F.pos+1);n===lt.asterisk&&i===lt.asterisk&&(t++,i=Rt.charCodeAt(F.pos+2),e=b.exponent),i===lt.equalsTo&&Rt.charCodeAt(F.pos+2)!==lt.greaterThan&&(t++,e=b.assign),hn(e,t)}function xFt(n){let e=Rt.charCodeAt(F.pos+1);if(e===n){Rt.charCodeAt(F.pos+2)===lt.equalsTo?hn(b.assign,3):hn(n===lt.verticalBar?b.logicalOR:b.logicalAND,2);return}if(n===lt.verticalBar){if(e===lt.greaterThan){hn(b.pipeline,2);return}else if(e===lt.rightCurlyBrace&&Ye){hn(b.braceBarR,2);return}}if(e===lt.equalsTo){hn(b.assign,2);return}hn(n===lt.verticalBar?b.bitwiseOR:b.bitwiseAND,1)}function bFt(){Rt.charCodeAt(F.pos+1)===lt.equalsTo?hn(b.assign,2):hn(b.bitwiseXOR,1)}function vFt(n){let e=Rt.charCodeAt(F.pos+1);if(e===n){hn(b.preIncDec,2);return}e===lt.equalsTo?hn(b.assign,2):n===lt.plusSign?hn(b.plus,1):hn(b.minus,1)}function SFt(){let n=Rt.charCodeAt(F.pos+1);if(n===lt.lessThan){if(Rt.charCodeAt(F.pos+2)===lt.equalsTo){hn(b.assign,3);return}F.isType?hn(b.lessThan,1):hn(b.bitShiftL,2);return}n===lt.equalsTo?hn(b.relationalOrEqual,2):hn(b.lessThan,1)}function Hit(){if(F.isType){hn(b.greaterThan,1);return}let n=Rt.charCodeAt(F.pos+1);if(n===lt.greaterThan){let e=Rt.charCodeAt(F.pos+2)===lt.greaterThan?3:2;if(Rt.charCodeAt(F.pos+e)===lt.equalsTo){hn(b.assign,e+1);return}hn(b.bitShiftR,e);return}n===lt.equalsTo?hn(b.relationalOrEqual,2):hn(b.greaterThan,1)}function SP(){F.type===b.greaterThan&&(F.pos-=1,Hit())}function wFt(n){let e=Rt.charCodeAt(F.pos+1);if(e===lt.equalsTo){hn(b.equality,Rt.charCodeAt(F.pos+2)===lt.equalsTo?3:2);return}if(n===lt.equalsTo&&e===lt.greaterThan){F.pos+=2,be(b.arrow);return}hn(n===lt.equalsTo?b.eq:b.bang,1)}function PFt(){let n=Rt.charCodeAt(F.pos+1),e=Rt.charCodeAt(F.pos+2);n===lt.questionMark&&!(Ye&&F.isType)?e===lt.equalsTo?hn(b.assign,3):hn(b.nullishCoalescing,2):n===lt.dot&&!(e>=lt.digit0&&e<=lt.digit9)?(F.pos+=2,be(b.questionDot)):(++F.pos,be(b.question))}function W9(n){switch(n){case lt.numberSign:++F.pos,be(b.hash);return;case lt.dot:_Ft();return;case lt.leftParenthesis:++F.pos,be(b.parenL);return;case lt.rightParenthesis:++F.pos,be(b.parenR);return;case lt.semicolon:++F.pos,be(b.semi);return;case lt.comma:++F.pos,be(b.comma);return;case lt.leftSquareBracket:++F.pos,be(b.bracketL);return;case lt.rightSquareBracket:++F.pos,be(b.bracketR);return;case lt.leftCurlyBrace:Ye&&Rt.charCodeAt(F.pos+1)===lt.verticalBar?hn(b.braceBarL,2):(++F.pos,be(b.braceL));return;case lt.rightCurlyBrace:++F.pos,be(b.braceR);return;case lt.colon:Rt.charCodeAt(F.pos+1)===lt.colon?hn(b.doubleColon,2):(++F.pos,be(b.colon));return;case lt.questionMark:PFt();return;case lt.atSign:++F.pos,be(b.at);return;case lt.graveAccent:++F.pos,be(b.backQuote);return;case lt.digit0:{let e=Rt.charCodeAt(F.pos+1);if(e===lt.lowercaseX||e===lt.uppercaseX||e===lt.lowercaseO||e===lt.uppercaseO||e===lt.lowercaseB||e===lt.uppercaseB){TFt();return}}case lt.digit1:case lt.digit2:case lt.digit3:case lt.digit4:case lt.digit5:case lt.digit6:case lt.digit7:case lt.digit8:case lt.digit9:Wit(!1);return;case lt.quotationMark:case lt.apostrophe:EFt(n);return;case lt.slash:yFt();return;case lt.percentSign:case lt.asterisk:gFt(n);return;case lt.verticalBar:case lt.ampersand:xFt(n);return;case lt.caret:bFt();return;case lt.plusSign:case lt.dash:vFt(n);return;case lt.lessThan:SFt();return;case lt.greaterThan:Hit();return;case lt.equalsTo:case lt.exclamationMark:wFt(n);return;case lt.tilde:hn(b.tilde,1);return;default:break}he(`Unexpected character '${String.fromCharCode(n)}'`,F.pos)}function hn(n,e){F.pos+=e,be(n)}function kFt(){let n=F.pos,e=!1,t=!1;for(;;){if(F.pos>=Rt.length){he("Unterminated regular expression",n);return}let i=Rt.charCodeAt(F.pos);if(e)e=!1;else{if(i===lt.leftSquareBracket)t=!0;else if(i===lt.rightSquareBracket&&t)t=!1;else if(i===lt.slash&&!t)break;e=i===lt.backslash}++F.pos}++F.pos,CFt(),be(b.regexp)}function B9(){for(;;){let n=Rt.charCodeAt(F.pos);if(n>=lt.digit0&&n<=lt.digit9||n===lt.underscore)F.pos++;else break}}function TFt(){for(F.pos+=2;;){let e=Rt.charCodeAt(F.pos);if(e>=lt.digit0&&e<=lt.digit9||e>=lt.lowercaseA&&e<=lt.lowercaseF||e>=lt.uppercaseA&&e<=lt.uppercaseF||e===lt.underscore)F.pos++;else break}Rt.charCodeAt(F.pos)===lt.lowercaseN?(++F.pos,be(b.bigint)):be(b.num)}function Wit(n){let e=!1,t=!1;n||B9();let i=Rt.charCodeAt(F.pos);if(i===lt.dot&&(++F.pos,B9(),i=Rt.charCodeAt(F.pos)),(i===lt.uppercaseE||i===lt.lowercaseE)&&(i=Rt.charCodeAt(++F.pos),(i===lt.plusSign||i===lt.dash)&&++F.pos,B9(),i=Rt.charCodeAt(F.pos)),i===lt.lowercaseN?(++F.pos,e=!0):i===lt.lowercaseM&&(++F.pos,t=!0),e){be(b.bigint);return}if(t){be(b.decimal);return}be(b.num)}function EFt(n){for(F.pos++;;){if(F.pos>=Rt.length){he("Unterminated string constant");return}let e=Rt.charCodeAt(F.pos);if(e===lt.backslash)F.pos++;else if(e===n)break;F.pos++}F.pos++,be(b.string)}function MFt(){for(;;){if(F.pos>=Rt.length){he("Unterminated template");return}let n=Rt.charCodeAt(F.pos);if(n===lt.graveAccent||n===lt.dollarSign&&Rt.charCodeAt(F.pos+1)===lt.leftCurlyBrace){if(F.pos===F.start&&q(b.template))if(n===lt.dollarSign){F.pos+=2,be(b.dollarBraceL);return}else{++F.pos,be(b.backQuote);return}be(b.template);return}n===lt.backslash&&F.pos++,F.pos++}}function CFt(){for(;F.pos<Rt.length;){let n=Rt.charCodeAt(F.pos);if(Cr[n])F.pos++;else if(n===lt.backslash){if(F.pos+=2,Rt.charCodeAt(F.pos)===lt.leftCurlyBrace){for(;F.pos<Rt.length&&Rt.charCodeAt(F.pos)!==lt.rightCurlyBrace;)F.pos++;F.pos++}}else break}}function qo(n,e=n.currentIndex()){let t=e+1;if(wP(n,t)){let i=n.identifierNameAtIndex(e);return{isType:!1,leftName:i,rightName:i,endIndex:t}}if(t++,wP(n,t))return{isType:!0,leftName:null,rightName:null,endIndex:t};if(t++,wP(n,t))return{isType:!1,leftName:n.identifierNameAtIndex(e),rightName:n.identifierNameAtIndex(e+2),endIndex:t};if(t++,wP(n,t))return{isType:!0,leftName:null,rightName:null,endIndex:t};throw new Error(`Unexpected import/export specifier at ${e}`)}function wP(n,e){let t=n.tokens[e];return t.type===b.braceR||t.type===b.comma}var qit=new Map([["quot",'"'],["amp","&"],["apos","'"],["lt","<"],["gt",">"],["nbsp","\xA0"],["iexcl","\xA1"],["cent","\xA2"],["pound","\xA3"],["curren","\xA4"],["yen","\xA5"],["brvbar","\xA6"],["sect","\xA7"],["uml","\xA8"],["copy","\xA9"],["ordf","\xAA"],["laquo","\xAB"],["not","\xAC"],["shy","\xAD"],["reg","\xAE"],["macr","\xAF"],["deg","\xB0"],["plusmn","\xB1"],["sup2","\xB2"],["sup3","\xB3"],["acute","\xB4"],["micro","\xB5"],["para","\xB6"],["middot","\xB7"],["cedil","\xB8"],["sup1","\xB9"],["ordm","\xBA"],["raquo","\xBB"],["frac14","\xBC"],["frac12","\xBD"],["frac34","\xBE"],["iquest","\xBF"],["Agrave","\xC0"],["Aacute","\xC1"],["Acirc","\xC2"],["Atilde","\xC3"],["Auml","\xC4"],["Aring","\xC5"],["AElig","\xC6"],["Ccedil","\xC7"],["Egrave","\xC8"],["Eacute","\xC9"],["Ecirc","\xCA"],["Euml","\xCB"],["Igrave","\xCC"],["Iacute","\xCD"],["Icirc","\xCE"],["Iuml","\xCF"],["ETH","\xD0"],["Ntilde","\xD1"],["Ograve","\xD2"],["Oacute","\xD3"],["Ocirc","\xD4"],["Otilde","\xD5"],["Ouml","\xD6"],["times","\xD7"],["Oslash","\xD8"],["Ugrave","\xD9"],["Uacute","\xDA"],["Ucirc","\xDB"],["Uuml","\xDC"],["Yacute","\xDD"],["THORN","\xDE"],["szlig","\xDF"],["agrave","\xE0"],["aacute","\xE1"],["acirc","\xE2"],["atilde","\xE3"],["auml","\xE4"],["aring","\xE5"],["aelig","\xE6"],["ccedil","\xE7"],["egrave","\xE8"],["eacute","\xE9"],["ecirc","\xEA"],["euml","\xEB"],["igrave","\xEC"],["iacute","\xED"],["icirc","\xEE"],["iuml","\xEF"],["eth","\xF0"],["ntilde","\xF1"],["ograve","\xF2"],["oacute","\xF3"],["ocirc","\xF4"],["otilde","\xF5"],["ouml","\xF6"],["divide","\xF7"],["oslash","\xF8"],["ugrave","\xF9"],["uacute","\xFA"],["ucirc","\xFB"],["uuml","\xFC"],["yacute","\xFD"],["thorn","\xFE"],["yuml","\xFF"],["OElig","\u0152"],["oelig","\u0153"],["Scaron","\u0160"],["scaron","\u0161"],["Yuml","\u0178"],["fnof","\u0192"],["circ","\u02C6"],["tilde","\u02DC"],["Alpha","\u0391"],["Beta","\u0392"],["Gamma","\u0393"],["Delta","\u0394"],["Epsilon","\u0395"],["Zeta","\u0396"],["Eta","\u0397"],["Theta","\u0398"],["Iota","\u0399"],["Kappa","\u039A"],["Lambda","\u039B"],["Mu","\u039C"],["Nu","\u039D"],["Xi","\u039E"],["Omicron","\u039F"],["Pi","\u03A0"],["Rho","\u03A1"],["Sigma","\u03A3"],["Tau","\u03A4"],["Upsilon","\u03A5"],["Phi","\u03A6"],["Chi","\u03A7"],["Psi","\u03A8"],["Omega","\u03A9"],["alpha","\u03B1"],["beta","\u03B2"],["gamma","\u03B3"],["delta","\u03B4"],["epsilon","\u03B5"],["zeta","\u03B6"],["eta","\u03B7"],["theta","\u03B8"],["iota","\u03B9"],["kappa","\u03BA"],["lambda","\u03BB"],["mu","\u03BC"],["nu","\u03BD"],["xi","\u03BE"],["omicron","\u03BF"],["pi","\u03C0"],["rho","\u03C1"],["sigmaf","\u03C2"],["sigma","\u03C3"],["tau","\u03C4"],["upsilon","\u03C5"],["phi","\u03C6"],["chi","\u03C7"],["psi","\u03C8"],["omega","\u03C9"],["thetasym","\u03D1"],["upsih","\u03D2"],["piv","\u03D6"],["ensp","\u2002"],["emsp","\u2003"],["thinsp","\u2009"],["zwnj","\u200C"],["zwj","\u200D"],["lrm","\u200E"],["rlm","\u200F"],["ndash","\u2013"],["mdash","\u2014"],["lsquo","\u2018"],["rsquo","\u2019"],["sbquo","\u201A"],["ldquo","\u201C"],["rdquo","\u201D"],["bdquo","\u201E"],["dagger","\u2020"],["Dagger","\u2021"],["bull","\u2022"],["hellip","\u2026"],["permil","\u2030"],["prime","\u2032"],["Prime","\u2033"],["lsaquo","\u2039"],["rsaquo","\u203A"],["oline","\u203E"],["frasl","\u2044"],["euro","\u20AC"],["image","\u2111"],["weierp","\u2118"],["real","\u211C"],["trade","\u2122"],["alefsym","\u2135"],["larr","\u2190"],["uarr","\u2191"],["rarr","\u2192"],["darr","\u2193"],["harr","\u2194"],["crarr","\u21B5"],["lArr","\u21D0"],["uArr","\u21D1"],["rArr","\u21D2"],["dArr","\u21D3"],["hArr","\u21D4"],["forall","\u2200"],["part","\u2202"],["exist","\u2203"],["empty","\u2205"],["nabla","\u2207"],["isin","\u2208"],["notin","\u2209"],["ni","\u220B"],["prod","\u220F"],["sum","\u2211"],["minus","\u2212"],["lowast","\u2217"],["radic","\u221A"],["prop","\u221D"],["infin","\u221E"],["ang","\u2220"],["and","\u2227"],["or","\u2228"],["cap","\u2229"],["cup","\u222A"],["int","\u222B"],["there4","\u2234"],["sim","\u223C"],["cong","\u2245"],["asymp","\u2248"],["ne","\u2260"],["equiv","\u2261"],["le","\u2264"],["ge","\u2265"],["sub","\u2282"],["sup","\u2283"],["nsub","\u2284"],["sube","\u2286"],["supe","\u2287"],["oplus","\u2295"],["otimes","\u2297"],["perp","\u22A5"],["sdot","\u22C5"],["lceil","\u2308"],["rceil","\u2309"],["lfloor","\u230A"],["rfloor","\u230B"],["lang","\u2329"],["rang","\u232A"],["loz","\u25CA"],["spades","\u2660"],["clubs","\u2663"],["hearts","\u2665"],["diams","\u2666"]]);function Z1(n){let[e,t]=Zit(n.jsxPragma||"React.createElement"),[i,r]=Zit(n.jsxFragmentPragma||"React.Fragment");return{base:e,suffix:t,fragmentBase:i,fragmentSuffix:r}}function Zit(n){let e=n.indexOf(".");return e===-1&&(e=n.length),[n.slice(0,e),n.slice(e)]}var Bn=class{getPrefixCode(){return""}getHoistedCode(){return""}getSuffixCode(){return""}};var K1=class n extends Bn{__init(){this.lastLineNumber=1}__init2(){this.lastIndex=0}__init3(){this.filenameVarName=null}__init4(){this.esmAutomaticImportNameResolutions={}}__init5(){this.cjsAutomaticModuleNameResolutions={}}constructor(e,t,i,r,s){super(),this.rootTransformer=e,this.tokens=t,this.importProcessor=i,this.nameManager=r,this.options=s,n.prototype.__init.call(this),n.prototype.__init2.call(this),n.prototype.__init3.call(this),n.prototype.__init4.call(this),n.prototype.__init5.call(this),this.jsxPragmaInfo=Z1(s),this.isAutomaticRuntime=s.jsxRuntime==="automatic",this.jsxImportSource=s.jsxImportSource||"react"}process(){return this.tokens.matches1(b.jsxTagStart)?(this.processJSXTag(),!0):!1}getPrefixCode(){let e="";if(this.filenameVarName&&(e+=`const ${this.filenameVarName} = ${JSON.stringify(this.options.filePath||"")};`),this.isAutomaticRuntime)if(this.importProcessor)for(let[t,i]of Object.entries(this.cjsAutomaticModuleNameResolutions))e+=`var ${i} = require("${t}");`;else{let{createElement:t,...i}=this.esmAutomaticImportNameResolutions;t&&(e+=`import {createElement as ${t}} from "${this.jsxImportSource}";`);let r=Object.entries(i).map(([s,o])=>`${s} as ${o}`).join(", ");if(r){let s=this.jsxImportSource+(this.options.production?"/jsx-runtime":"/jsx-dev-runtime");e+=`import {${r}} from "${s}";`}}return e}processJSXTag(){let{jsxRole:e,start:t}=this.tokens.currentToken(),i=this.options.production?null:this.getElementLocationCode(t);this.isAutomaticRuntime&&e!==ps.KeyAfterPropSpread?this.transformTagToJSXFunc(i,e):this.transformTagToCreateElement(i)}getElementLocationCode(e){return`lineNumber: ${this.getLineNumberForIndex(e)}`}getLineNumberForIndex(e){let t=this.tokens.code;for(;this.lastIndex<e&&this.lastIndex<t.length;)t[this.lastIndex]===`
`&&this.lastLineNumber++,this.lastIndex++;return this.lastLineNumber}transformTagToJSXFunc(e,t){let i=t===ps.StaticChildren;this.tokens.replaceToken(this.getJSXFuncInvocationCode(i));let r=null;if(this.tokens.matches1(b.jsxTagEnd))this.tokens.replaceToken(`${this.getFragmentCode()}, {`),this.processAutomaticChildrenAndEndProps(t);else{if(this.processTagIntro(),this.tokens.appendCode(", {"),r=this.processProps(!0),this.tokens.matches2(b.slash,b.jsxTagEnd))this.tokens.appendCode("}");else if(this.tokens.matches1(b.jsxTagEnd))this.tokens.removeToken(),this.processAutomaticChildrenAndEndProps(t);else throw new Error("Expected either /> or > at the end of the tag.");r&&this.tokens.appendCode(`, ${r}`)}for(this.options.production||(r===null&&this.tokens.appendCode(", void 0"),this.tokens.appendCode(`, ${i}, ${this.getDevSource(e)}, this`)),this.tokens.removeInitialToken();!this.tokens.matches1(b.jsxTagEnd);)this.tokens.removeToken();this.tokens.replaceToken(")")}transformTagToCreateElement(e){if(this.tokens.replaceToken(this.getCreateElementInvocationCode()),this.tokens.matches1(b.jsxTagEnd))this.tokens.replaceToken(`${this.getFragmentCode()}, null`),this.processChildren(!0);else if(this.processTagIntro(),this.processPropsObjectWithDevInfo(e),!this.tokens.matches2(b.slash,b.jsxTagEnd))if(this.tokens.matches1(b.jsxTagEnd))this.tokens.removeToken(),this.processChildren(!0);else throw new Error("Expected either /> or > at the end of the tag.");for(this.tokens.removeInitialToken();!this.tokens.matches1(b.jsxTagEnd);)this.tokens.removeToken();this.tokens.replaceToken(")")}getJSXFuncInvocationCode(e){return this.options.production?e?this.claimAutoImportedFuncInvocation("jsxs","/jsx-runtime"):this.claimAutoImportedFuncInvocation("jsx","/jsx-runtime"):this.claimAutoImportedFuncInvocation("jsxDEV","/jsx-dev-runtime")}getCreateElementInvocationCode(){if(this.isAutomaticRuntime)return this.claimAutoImportedFuncInvocation("createElement","");{let{jsxPragmaInfo:e}=this;return`${this.importProcessor&&this.importProcessor.getIdentifierReplacement(e.base)||e.base}${e.suffix}(`}}getFragmentCode(){if(this.isAutomaticRuntime)return this.claimAutoImportedName("Fragment",this.options.production?"/jsx-runtime":"/jsx-dev-runtime");{let{jsxPragmaInfo:e}=this;return(this.importProcessor&&this.importProcessor.getIdentifierReplacement(e.fragmentBase)||e.fragmentBase)+e.fragmentSuffix}}claimAutoImportedFuncInvocation(e,t){let i=this.claimAutoImportedName(e,t);return this.importProcessor?`${i}.call(void 0, `:`${i}(`}claimAutoImportedName(e,t){if(this.importProcessor){let i=this.jsxImportSource+t;return this.cjsAutomaticModuleNameResolutions[i]||(this.cjsAutomaticModuleNameResolutions[i]=this.importProcessor.getFreeIdentifierForPath(i)),`${this.cjsAutomaticModuleNameResolutions[i]}.${e}`}else return this.esmAutomaticImportNameResolutions[e]||(this.esmAutomaticImportNameResolutions[e]=this.nameManager.claimFreeName(`_${e}`)),this.esmAutomaticImportNameResolutions[e]}processTagIntro(){let e=this.tokens.currentIndex()+1;for(;this.tokens.tokens[e].isType||!this.tokens.matches2AtIndex(e-1,b.jsxName,b.jsxName)&&!this.tokens.matches2AtIndex(e-1,b.greaterThan,b.jsxName)&&!this.tokens.matches1AtIndex(e,b.braceL)&&!this.tokens.matches1AtIndex(e,b.jsxTagEnd)&&!this.tokens.matches2AtIndex(e,b.slash,b.jsxTagEnd);)e++;if(e===this.tokens.currentIndex()+1){let t=this.tokens.identifierName();q9(t)&&this.tokens.replaceToken(`'${t}'`)}for(;this.tokens.currentIndex()<e;)this.rootTransformer.processToken()}processPropsObjectWithDevInfo(e){let t=this.options.production?"":`__self: this, __source: ${this.getDevSource(e)}`;if(!this.tokens.matches1(b.jsxName)&&!this.tokens.matches1(b.braceL)){t?this.tokens.appendCode(`, {${t}}`):this.tokens.appendCode(", null");return}this.tokens.appendCode(", {"),this.processProps(!1),t?this.tokens.appendCode(` ${t}}`):this.tokens.appendCode("}")}processProps(e){let t=null;for(;;){if(this.tokens.matches2(b.jsxName,b.eq)){let i=this.tokens.identifierName();if(e&&i==="key"){t!==null&&this.tokens.appendCode(t.replace(/[^\n]/g,"")),this.tokens.removeToken(),this.tokens.removeToken();let r=this.tokens.snapshot();this.processPropValue(),t=this.tokens.dangerouslyGetAndRemoveCodeSinceSnapshot(r);continue}else this.processPropName(i),this.tokens.replaceToken(": "),this.processPropValue()}else if(this.tokens.matches1(b.jsxName)){let i=this.tokens.identifierName();this.processPropName(i),this.tokens.appendCode(": true")}else if(this.tokens.matches1(b.braceL))this.tokens.replaceToken(""),this.rootTransformer.processBalancedCode(),this.tokens.replaceToken("");else break;this.tokens.appendCode(",")}return t}processPropName(e){e.includes("-")?this.tokens.replaceToken(`'${e}'`):this.tokens.copyToken()}processPropValue(){this.tokens.matches1(b.braceL)?(this.tokens.replaceToken(""),this.rootTransformer.processBalancedCode(),this.tokens.replaceToken("")):this.tokens.matches1(b.jsxTagStart)?this.processJSXTag():this.processStringPropValue()}processStringPropValue(){let e=this.tokens.currentToken(),t=this.tokens.code.slice(e.start+1,e.end-1),i=Kit(t),r=NFt(t);this.tokens.replaceToken(r+i)}processAutomaticChildrenAndEndProps(e){e===ps.StaticChildren?(this.tokens.appendCode(" children: ["),this.processChildren(!1),this.tokens.appendCode("]}")):(e===ps.OneChild&&this.tokens.appendCode(" children: "),this.processChildren(!1),this.tokens.appendCode("}"))}processChildren(e){let t=e;for(;;){if(this.tokens.matches2(b.jsxTagStart,b.slash))return;let i=!1;if(this.tokens.matches1(b.braceL))this.tokens.matches2(b.braceL,b.braceR)?(this.tokens.replaceToken(""),this.tokens.replaceToken("")):(this.tokens.replaceToken(t?", ":""),this.rootTransformer.processBalancedCode(),this.tokens.replaceToken(""),i=!0);else if(this.tokens.matches1(b.jsxTagStart))this.tokens.appendCode(t?", ":""),this.processJSXTag(),i=!0;else if(this.tokens.matches1(b.jsxText)||this.tokens.matches1(b.jsxEmptyText))i=this.processChildTextElement(t);else throw new Error("Unexpected token when processing JSX children.");i&&(t=!0)}}processChildTextElement(e){let t=this.tokens.currentToken(),i=this.tokens.code.slice(t.start,t.end),r=Kit(i),s=IFt(i);return s==='""'?(this.tokens.replaceToken(r),!1):(this.tokens.replaceToken(`${e?", ":""}${s}${r}`),!0)}getDevSource(e){return`{fileName: ${this.getFilenameVarName()}, ${e}}`}getFilenameVarName(){return this.filenameVarName||(this.filenameVarName=this.nameManager.claimFreeName("_jsxFileName")),this.filenameVarName}};function q9(n){let e=n.charCodeAt(0);return e>=lt.lowercaseA&&e<=lt.lowercaseZ}function IFt(n){let e="",t="",i=!1,r=!1;for(let s=0;s<n.length;s++){let o=n[s];if(o===" "||o==="	"||o==="\r")i||(t+=o);else if(o===`
`)t="",i=!0;else{if(r&&i&&(e+=" "),e+=t,t="",o==="&"){let{entity:a,newI:c}=Jit(n,s+1);s=c-1,e+=a}else e+=o;r=!0,i=!1}}return i||(e+=t),JSON.stringify(e)}function Kit(n){let e=0,t=0;for(let i of n)i===`
`?(e++,t=0):i===" "&&t++;return`
`.repeat(e)+" ".repeat(t)}function NFt(n){let e="";for(let t=0;t<n.length;t++){let i=n[t];if(i===`
`)if(/\s/.test(n[t+1]))for(e+=" ";t<n.length&&/\s/.test(n[t+1]);)t++;else e+=`
`;else if(i==="&"){let{entity:r,newI:s}=Jit(n,t+1);e+=r,t=s-1}else e+=i}return JSON.stringify(e)}function Jit(n,e){let t="",i=0,r,s=e;if(n[s]==="#"){let o=10;s++;let a;if(n[s]==="x")for(o=16,s++,a=s;s<n.length&&RFt(n.charCodeAt(s));)s++;else for(a=s;s<n.length&&AFt(n.charCodeAt(s));)s++;if(n[s]===";"){let c=n.slice(a,s);c&&(s++,r=String.fromCodePoint(parseInt(c,o)))}}else for(;s<n.length&&i++<10;){let o=n[s];if(s++,o===";"){r=qit.get(t);break}t+=o}return r?{entity:r,newI:s}:{entity:"&",newI:e}}function AFt(n){return n>=lt.digit0&&n<=lt.digit9}function RFt(n){return n>=lt.digit0&&n<=lt.digit9||n>=lt.lowercaseA&&n<=lt.lowercaseF||n>=lt.uppercaseA&&n<=lt.uppercaseF}function PP(n,e){let t=Z1(e),i=new Set;for(let r=0;r<n.tokens.length;r++){let s=n.tokens[r];if(s.type===b.name&&!s.isType&&(s.identifierRole===ee.Access||s.identifierRole===ee.ObjectShorthand||s.identifierRole===ee.ExportAccess)&&!s.shadowsGlobal&&i.add(n.identifierNameForToken(s)),s.type===b.jsxTagStart&&i.add(t.base),s.type===b.jsxTagStart&&r+1<n.tokens.length&&n.tokens[r+1].type===b.jsxTagEnd&&(i.add(t.base),i.add(t.fragmentBase)),s.type===b.jsxName&&s.identifierRole===ee.Access){let o=n.identifierNameForToken(s);(!q9(o)||n.tokens[r+1].type===b.dot)&&i.add(n.identifierNameForToken(s))}}return i}var J1=class n{__init(){this.nonTypeIdentifiers=new Set}__init2(){this.importInfoByPath=new Map}__init3(){this.importsToReplace=new Map}__init4(){this.identifierReplacements=new Map}__init5(){this.exportBindingsByLocalName=new Map}constructor(e,t,i,r,s,o,a){this.nameManager=e,this.tokens=t,this.enableLegacyTypeScriptModuleInterop=i,this.options=r,this.isTypeScriptTransformEnabled=s,this.keepUnusedImports=o,this.helperManager=a,n.prototype.__init.call(this),n.prototype.__init2.call(this),n.prototype.__init3.call(this),n.prototype.__init4.call(this),n.prototype.__init5.call(this)}preprocessTokens(){for(let e=0;e<this.tokens.tokens.length;e++)this.tokens.matches1AtIndex(e,b._import)&&!this.tokens.matches3AtIndex(e,b._import,b.name,b.eq)&&this.preprocessImportAtIndex(e),this.tokens.matches1AtIndex(e,b._export)&&!this.tokens.matches2AtIndex(e,b._export,b.eq)&&this.preprocessExportAtIndex(e);this.generateImportReplacements()}pruneTypeOnlyImports(){this.nonTypeIdentifiers=PP(this.tokens,this.options);for(let[e,t]of this.importInfoByPath.entries()){if(t.hasBareImport||t.hasStarExport||t.exportStarNames.length>0||t.namedExports.length>0)continue;[...t.defaultNames,...t.wildcardNames,...t.namedImports.map(({localName:r})=>r)].every(r=>this.shouldAutomaticallyElideImportedName(r))&&this.importsToReplace.set(e,"")}}shouldAutomaticallyElideImportedName(e){return this.isTypeScriptTransformEnabled&&!this.keepUnusedImports&&!this.nonTypeIdentifiers.has(e)}generateImportReplacements(){for(let[e,t]of this.importInfoByPath.entries()){let{defaultNames:i,wildcardNames:r,namedImports:s,namedExports:o,exportStarNames:a,hasStarExport:c}=t;if(i.length===0&&r.length===0&&s.length===0&&o.length===0&&a.length===0&&!c){this.importsToReplace.set(e,`require('${e}');`);continue}let l=this.getFreeIdentifierForPath(e),u;this.enableLegacyTypeScriptModuleInterop?u=l:u=r.length>0?r[0]:this.getFreeIdentifierForPath(e);let p=`var ${l} = require('${e}');`;if(r.length>0)for(let f of r){let y=this.enableLegacyTypeScriptModuleInterop?l:`${this.helperManager.getHelperName("interopRequireWildcard")}(${l})`;p+=` var ${f} = ${y};`}else a.length>0&&u!==l?p+=` var ${u} = ${this.helperManager.getHelperName("interopRequireWildcard")}(${l});`:i.length>0&&u!==l&&(p+=` var ${u} = ${this.helperManager.getHelperName("interopRequireDefault")}(${l});`);for(let{importedName:f,localName:y}of o)p+=` ${this.helperManager.getHelperName("createNamedExportFrom")}(${l}, '${y}', '${f}');`;for(let f of a)p+=` exports.${f} = ${u};`;c&&(p+=` ${this.helperManager.getHelperName("createStarExport")}(${l});`),this.importsToReplace.set(e,p);for(let f of i)this.identifierReplacements.set(f,`${u}.default`);for(let{importedName:f,localName:y}of s)this.identifierReplacements.set(y,`${l}.${f}`)}}getFreeIdentifierForPath(e){let t=e.split("/"),r=t[t.length-1].replace(/\W/g,"");return this.nameManager.claimFreeName(`_${r}`)}preprocessImportAtIndex(e){let t=[],i=[],r=[];if(e++,(this.tokens.matchesContextualAtIndex(e,it._type)||this.tokens.matches1AtIndex(e,b._typeof))&&!this.tokens.matches1AtIndex(e+1,b.comma)&&!this.tokens.matchesContextualAtIndex(e+1,it._from)||this.tokens.matches1AtIndex(e,b.parenL))return;if(this.tokens.matches1AtIndex(e,b.name)&&(t.push(this.tokens.identifierNameAtIndex(e)),e++,this.tokens.matches1AtIndex(e,b.comma)&&e++),this.tokens.matches1AtIndex(e,b.star)&&(e+=2,i.push(this.tokens.identifierNameAtIndex(e)),e++),this.tokens.matches1AtIndex(e,b.braceL)){let a=this.getNamedImports(e+1);e=a.newIndex;for(let c of a.namedImports)c.importedName==="default"?t.push(c.localName):r.push(c)}if(this.tokens.matchesContextualAtIndex(e,it._from)&&e++,!this.tokens.matches1AtIndex(e,b.string))throw new Error("Expected string token at the end of import statement.");let s=this.tokens.stringValueAtIndex(e),o=this.getImportInfo(s);o.defaultNames.push(...t),o.wildcardNames.push(...i),o.namedImports.push(...r),t.length===0&&i.length===0&&r.length===0&&(o.hasBareImport=!0)}preprocessExportAtIndex(e){if(this.tokens.matches2AtIndex(e,b._export,b._var)||this.tokens.matches2AtIndex(e,b._export,b._let)||this.tokens.matches2AtIndex(e,b._export,b._const))this.preprocessVarExportAtIndex(e);else if(this.tokens.matches2AtIndex(e,b._export,b._function)||this.tokens.matches2AtIndex(e,b._export,b._class)){let t=this.tokens.identifierNameAtIndex(e+2);this.addExportBinding(t,t)}else if(this.tokens.matches3AtIndex(e,b._export,b.name,b._function)){let t=this.tokens.identifierNameAtIndex(e+3);this.addExportBinding(t,t)}else this.tokens.matches2AtIndex(e,b._export,b.braceL)?this.preprocessNamedExportAtIndex(e):this.tokens.matches2AtIndex(e,b._export,b.star)&&this.preprocessExportStarAtIndex(e)}preprocessVarExportAtIndex(e){let t=0;for(let i=e+2;;i++)if(this.tokens.matches1AtIndex(i,b.braceL)||this.tokens.matches1AtIndex(i,b.dollarBraceL)||this.tokens.matches1AtIndex(i,b.bracketL))t++;else if(this.tokens.matches1AtIndex(i,b.braceR)||this.tokens.matches1AtIndex(i,b.bracketR))t--;else{if(t===0&&!this.tokens.matches1AtIndex(i,b.name))break;if(this.tokens.matches1AtIndex(1,b.eq)){let r=this.tokens.currentToken().rhsEndIndex;if(r==null)throw new Error("Expected = token with an end index.");i=r-1}else{let r=this.tokens.tokens[i];if(xP(r)){let s=this.tokens.identifierNameAtIndex(i);this.identifierReplacements.set(s,`exports.${s}`)}}}}preprocessNamedExportAtIndex(e){e+=2;let{newIndex:t,namedImports:i}=this.getNamedImports(e);if(e=t,this.tokens.matchesContextualAtIndex(e,it._from))e++;else{for(let{importedName:o,localName:a}of i)this.addExportBinding(o,a);return}if(!this.tokens.matches1AtIndex(e,b.string))throw new Error("Expected string token at the end of import statement.");let r=this.tokens.stringValueAtIndex(e);this.getImportInfo(r).namedExports.push(...i)}preprocessExportStarAtIndex(e){let t=null;if(this.tokens.matches3AtIndex(e,b._export,b.star,b._as)?(e+=3,t=this.tokens.identifierNameAtIndex(e),e+=2):e+=3,!this.tokens.matches1AtIndex(e,b.string))throw new Error("Expected string token at the end of star export statement.");let i=this.tokens.stringValueAtIndex(e),r=this.getImportInfo(i);t!==null?r.exportStarNames.push(t):r.hasStarExport=!0}getNamedImports(e){let t=[];for(;;){if(this.tokens.matches1AtIndex(e,b.braceR)){e++;break}let i=qo(this.tokens,e);if(e=i.endIndex,i.isType||t.push({importedName:i.leftName,localName:i.rightName}),this.tokens.matches2AtIndex(e,b.comma,b.braceR)){e+=2;break}else if(this.tokens.matches1AtIndex(e,b.braceR)){e++;break}else if(this.tokens.matches1AtIndex(e,b.comma))e++;else throw new Error(`Unexpected token: ${JSON.stringify(this.tokens.tokens[e])}`)}return{newIndex:e,namedImports:t}}getImportInfo(e){let t=this.importInfoByPath.get(e);if(t)return t;let i={defaultNames:[],wildcardNames:[],namedImports:[],namedExports:[],hasBareImport:!1,exportStarNames:[],hasStarExport:!1};return this.importInfoByPath.set(e,i),i}addExportBinding(e,t){this.exportBindingsByLocalName.has(e)||this.exportBindingsByLocalName.set(e,[]),this.exportBindingsByLocalName.get(e).push(t)}claimImportCode(e){let t=this.importsToReplace.get(e);return this.importsToReplace.set(e,""),t||""}getIdentifierReplacement(e){return this.identifierReplacements.get(e)||null}resolveExportBinding(e){let t=this.exportBindingsByLocalName.get(e);return!t||t.length===0?null:t.map(i=>`exports.${i}`).join(" = ")}getGlobalNames(){return new Set([...this.identifierReplacements.keys(),...this.exportBindingsByLocalName.keys()])}};var OFt=44,LFt=59,Qit="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",nrt=new Uint8Array(64),FFt=new Uint8Array(128);for(let n=0;n<Qit.length;n++){let e=Qit.charCodeAt(n);nrt[n]=e,FFt[e]=n}function Q1(n,e,t){let i=e-t;i=i<0?-i<<1|1:i<<1;do{let r=i&31;i>>>=5,i>0&&(r|=32),n.write(nrt[r])}while(i>0);return e}var trt=1024*16,ert=typeof TextDecoder<"u"?new TextDecoder:typeof Buffer<"u"?{decode(n){return Buffer.from(n.buffer,n.byteOffset,n.byteLength).toString()}}:{decode(n){let e="";for(let t=0;t<n.length;t++)e+=String.fromCharCode(n[t]);return e}},zFt=class{constructor(){this.pos=0,this.out="",this.buffer=new Uint8Array(trt)}write(n){let{buffer:e}=this;e[this.pos++]=n,this.pos===trt&&(this.out+=ert.decode(e),this.pos=0)}flush(){let{buffer:n,out:e,pos:t}=this;return t>0?e+ert.decode(n.subarray(0,t)):e}};function Z9(n){let e=new zFt,t=0,i=0,r=0,s=0;for(let o=0;o<n.length;o++){let a=n[o];if(o>0&&e.write(LFt),a.length===0)continue;let c=0;for(let l=0;l<a.length;l++){let u=a[l];l>0&&e.write(OFt),c=Q1(e,u[0],c),u.length!==1&&(t=Q1(e,u[1],t),i=Q1(e,u[2],i),r=Q1(e,u[3],r),u.length!==4&&(s=Q1(e,u[4],s)))}}return e.flush()}var $Ft=Gt(irt(),1);var Q9=class{constructor(){this._indexes={__proto__:null},this.array=[]}};function DFt(n,e){return n._indexes[e]}function rrt(n,e){let t=DFt(n,e);if(t!==void 0)return t;let{array:i,_indexes:r}=n,s=i.push(e);return r[e]=s-1}var jFt=0,BFt=1,YFt=2,XFt=3,UFt=4,ort=-1,art=class{constructor({file:n,sourceRoot:e}={}){this._names=new Q9,this._sources=new Q9,this._sourcesContent=[],this._mappings=[],this.file=n,this.sourceRoot=e,this._ignoreList=new Q9}};var kP=(n,e,t,i,r,s,o,a)=>GFt(!0,n,e,t,i,r,s,o,a);function VFt(n){let{_mappings:e,_sources:t,_sourcesContent:i,_names:r,_ignoreList:s}=n;return qFt(e),{version:3,file:n.file||void 0,names:r.array,sourceRoot:n.sourceRoot||void 0,sources:t.array,sourcesContent:i,mappings:e,ignoreList:s.array}}function crt(n){let e=VFt(n);return Object.assign({},e,{mappings:Z9(e.mappings)})}function GFt(n,e,t,i,r,s,o,a,c){let{_mappings:l,_sources:u,_sourcesContent:p,_names:f}=e,y=HFt(l,t),g=WFt(y,i);if(!r)return n&&ZFt(y,g)?void 0:srt(y,g,[i]);let x=rrt(u,r),v=a?rrt(f,a):ort;if(x===p.length&&(p[x]=c??null),!(n&&KFt(y,g,x,s,o,v)))return srt(y,g,a?[i,x,s,o,v]:[i,x,s,o])}function HFt(n,e){for(let t=n.length;t<=e;t++)n[t]=[];return n[e]}function WFt(n,e){let t=n.length;for(let i=t-1;i>=0;t=i--){let r=n[i];if(e>=r[jFt])break}return t}function srt(n,e,t){for(let i=n.length;i>e;i--)n[i]=n[i-1];n[e]=t}function qFt(n){let{length:e}=n,t=e;for(let i=t-1;i>=0&&!(n[i].length>0);t=i,i--);t<e&&(n.length=t)}function ZFt(n,e){return e===0?!0:n[e-1].length===1}function KFt(n,e,t,i,r,s){if(e===0)return!1;let o=n[e-1];return o.length===1?!1:t===o[BFt]&&i===o[YFt]&&r===o[XFt]&&s===(o.length===5?o[UFt]:ort)}function t6({code:n,mappings:e},t,i,r,s){let o=JFt(r,s),a=new art({file:i.compiledFilename}),c=0,l=e[0];for(;l===void 0&&c<e.length-1;)c++,l=e[c];let u=0,p=0;l!==p&&kP(a,u,0,t,u,0);for(let x=0;x<n.length;x++){if(x===l){let v=l-p,P=o[c];for(kP(a,u,v,t,u,P);(l===x||l===void 0)&&c<e.length-1;)c++,l=e[c]}n.charCodeAt(x)===lt.lineFeed&&(u++,p=x+1,l!==p&&kP(a,u,0,t,u,0))}let{sourceRoot:f,sourcesContent:y,...g}=crt(a);return g}function JFt(n,e){let t=new Array(e.length),i=0,r=e[i].start,s=0;for(let o=0;o<n.length;o++)o===r&&(t[i]=r-s,i++,r=e[i].start),n.charCodeAt(o)===lt.lineFeed&&(s=o+1);return t}var QFt={require:`
    import {createRequire as CREATE_REQUIRE_NAME} from "module";
    const require = CREATE_REQUIRE_NAME(import.meta.url);
  `,interopRequireWildcard:`
    function interopRequireWildcard(obj) {
      if (obj && obj.__esModule) {
        return obj;
      } else {
        var newObj = {};
        if (obj != null) {
          for (var key in obj) {
            if (Object.prototype.hasOwnProperty.call(obj, key)) {
              newObj[key] = obj[key];
            }
          }
        }
        newObj.default = obj;
        return newObj;
      }
    }
  `,interopRequireDefault:`
    function interopRequireDefault(obj) {
      return obj && obj.__esModule ? obj : { default: obj };
    }
  `,createNamedExportFrom:`
    function createNamedExportFrom(obj, localName, importedName) {
      Object.defineProperty(exports, localName, {enumerable: true, configurable: true, get: () => obj[importedName]});
    }
  `,createStarExport:`
    function createStarExport(obj) {
      Object.keys(obj)
        .filter((key) => key !== "default" && key !== "__esModule")
        .forEach((key) => {
          if (exports.hasOwnProperty(key)) {
            return;
          }
          Object.defineProperty(exports, key, {enumerable: true, configurable: true, get: () => obj[key]});
        });
    }
  `,nullishCoalesce:`
    function nullishCoalesce(lhs, rhsFn) {
      if (lhs != null) {
        return lhs;
      } else {
        return rhsFn();
      }
    }
  `,asyncNullishCoalesce:`
    async function asyncNullishCoalesce(lhs, rhsFn) {
      if (lhs != null) {
        return lhs;
      } else {
        return await rhsFn();
      }
    }
  `,optionalChain:`
    function optionalChain(ops) {
      let lastAccessLHS = undefined;
      let value = ops[0];
      let i = 1;
      while (i < ops.length) {
        const op = ops[i];
        const fn = ops[i + 1];
        i += 2;
        if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) {
          return undefined;
        }
        if (op === 'access' || op === 'optionalAccess') {
          lastAccessLHS = value;
          value = fn(value);
        } else if (op === 'call' || op === 'optionalCall') {
          value = fn((...args) => value.call(lastAccessLHS, ...args));
          lastAccessLHS = undefined;
        }
      }
      return value;
    }
  `,asyncOptionalChain:`
    async function asyncOptionalChain(ops) {
      let lastAccessLHS = undefined;
      let value = ops[0];
      let i = 1;
      while (i < ops.length) {
        const op = ops[i];
        const fn = ops[i + 1];
        i += 2;
        if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) {
          return undefined;
        }
        if (op === 'access' || op === 'optionalAccess') {
          lastAccessLHS = value;
          value = await fn(value);
        } else if (op === 'call' || op === 'optionalCall') {
          value = await fn((...args) => value.call(lastAccessLHS, ...args));
          lastAccessLHS = undefined;
        }
      }
      return value;
    }
  `,optionalChainDelete:`
    function optionalChainDelete(ops) {
      const result = OPTIONAL_CHAIN_NAME(ops);
      return result == null ? true : result;
    }
  `,asyncOptionalChainDelete:`
    async function asyncOptionalChainDelete(ops) {
      const result = await ASYNC_OPTIONAL_CHAIN_NAME(ops);
      return result == null ? true : result;
    }
  `},TP=class n{__init(){this.helperNames={}}__init2(){this.createRequireName=null}constructor(e){this.nameManager=e,n.prototype.__init.call(this),n.prototype.__init2.call(this)}getHelperName(e){let t=this.helperNames[e];return t||(t=this.nameManager.claimFreeName(`_${e}`),this.helperNames[e]=t,t)}emitHelpers(){let e="";this.helperNames.optionalChainDelete&&this.getHelperName("optionalChain"),this.helperNames.asyncOptionalChainDelete&&this.getHelperName("asyncOptionalChain");for(let[t,i]of Object.entries(QFt)){let r=this.helperNames[t],s=i;t==="optionalChainDelete"?s=s.replace("OPTIONAL_CHAIN_NAME",this.helperNames.optionalChain):t==="asyncOptionalChainDelete"?s=s.replace("ASYNC_OPTIONAL_CHAIN_NAME",this.helperNames.asyncOptionalChain):t==="require"&&(this.createRequireName===null&&(this.createRequireName=this.nameManager.claimFreeName("_createRequire")),s=s.replace(/CREATE_REQUIRE_NAME/g,this.createRequireName)),r&&(e+=" ",e+=s.replace(t,r).replace(/\s+/g," ").trim())}return e}};function EP(n,e,t){tzt(n,t)&&ezt(n,e,t)}function tzt(n,e){for(let t of n.tokens)if(t.type===b.name&&!t.isType&&Yit(t)&&e.has(n.identifierNameForToken(t)))return!0;return!1}function ezt(n,e,t){let i=[],r=e.length-1;for(let s=n.tokens.length-1;;s--){for(;i.length>0&&i[i.length-1].startTokenIndex===s+1;)i.pop();for(;r>=0&&e[r].endTokenIndex===s+1;)i.push(e[r]),r--;if(s<0)break;let o=n.tokens[s],a=n.identifierNameForToken(o);if(i.length>1&&!o.isType&&o.type===b.name&&t.has(a)){if(Xit(o))lrt(i[i.length-1],n,a);else if(Uit(o)){let c=i.length-1;for(;c>0&&!i[c].isFunctionScope;)c--;if(c<0)throw new Error("Did not find parent function scope.");lrt(i[c],n,a)}}}if(i.length>0)throw new Error("Expected empty scope stack after processing file.")}function lrt(n,e,t){for(let i=n.startTokenIndex;i<n.endTokenIndex;i++){let r=e.tokens[i];(r.type===b.name||r.type===b.jsxName)&&e.identifierNameForToken(r)===t&&(r.shadowsGlobal=!0)}}function e6(n,e){let t=[];for(let i of e)i.type===b.name&&t.push(n.slice(i.start,i.end));return t}var t0=class n{__init(){this.usedNames=new Set}constructor(e,t){n.prototype.__init.call(this),this.usedNames=new Set(e6(e,t))}claimFreeName(e){let t=this.findFreeName(e);return this.usedNames.add(t),t}findFreeName(e){if(!this.usedNames.has(e))return e;let t=2;for(;this.usedNames.has(e+String(t));)t++;return e+String(t)}};var Ert=Gt(u6());var dn=Gt(u6()),wzt=dn.union(dn.lit("jsx"),dn.lit("typescript"),dn.lit("flow"),dn.lit("imports"),dn.lit("react-hot-loader"),dn.lit("jest")),Pzt=dn.iface([],{compiledFilename:"string"}),kzt=dn.iface([],{transforms:dn.array("Transform"),disableESTransforms:dn.opt("boolean"),jsxRuntime:dn.opt(dn.union(dn.lit("classic"),dn.lit("automatic"),dn.lit("preserve"))),production:dn.opt("boolean"),jsxImportSource:dn.opt("string"),jsxPragma:dn.opt("string"),jsxFragmentPragma:dn.opt("string"),keepUnusedImports:dn.opt("boolean"),preserveDynamicImport:dn.opt("boolean"),injectCreateRequireForImportRequire:dn.opt("boolean"),enableLegacyTypeScriptModuleInterop:dn.opt("boolean"),enableLegacyBabel5ModuleInterop:dn.opt("boolean"),sourceMapOptions:dn.opt("SourceMapOptions"),filePath:dn.opt("string")}),Tzt={Transform:wzt,SourceMapOptions:Pzt,Options:kzt},Trt=Tzt;var{Options:Ezt}=(0,Ert.createCheckers)(Trt);function Mrt(n){Ezt.strictCheck(n)}function p6(){Pt(),ci(!1)}function h6(n){Pt(),i0(n)}function lo(n){ae(),IP(n)}function ry(){ae(),F.tokens[F.tokens.length-1].identifierRole=ee.ImportDeclaration}function IP(n){let e;F.scopeDepth===0?e=ee.TopLevelDeclaration:n?e=ee.BlockScopedDeclaration:e=ee.FunctionScopedDeclaration,F.tokens[F.tokens.length-1].identifierRole=e}function i0(n){switch(F.type){case b._this:{let e=Pe(0);Pt(),ve(e);return}case b._yield:case b.name:{F.type=b.name,lo(n);return}case b.bracketL:{Pt(),r0(b.bracketR,n,!0);return}case b.braceL:o0(!0,n);return;default:he()}}function r0(n,e,t=!1,i=!1,r=0){let s=!0,o=!1,a=F.tokens.length;for(;!bt(n)&&!F.error;)if(s?s=!1:(wt(b.comma),F.tokens[F.tokens.length-1].contextId=r,!o&&F.tokens[a].isType&&(F.tokens[F.tokens.length-1].isType=!0,o=!0)),!(t&&q(b.comma))){if(bt(n))break;if(q(b.ellipsis)){h6(e),Crt(),bt(b.comma),wt(n);break}else Mzt(i,e)}}function Mzt(n,e){n&&s0([it._public,it._protected,it._private,it._readonly,it._override]),n0(e),Crt(),n0(e,!0)}function Crt(){Ye?Nrt():Oe&&Irt()}function n0(n,e=!1){if(e||i0(n),!bt(b.eq))return;let t=F.tokens.length-1;ci(),F.tokens[t].rhsEndIndex=F.tokens.length}function f6(){return q(b.name)}function Czt(){return q(b.name)||!!(F.type&b.IS_KEYWORD)||q(b.string)||q(b.num)||q(b.bigint)||q(b.decimal)}function zrt(){let n=F.snapshot();return Pt(),(q(b.bracketL)||q(b.braceL)||q(b.star)||q(b.ellipsis)||q(b.hash)||Czt())&&!Hi()?!0:(F.restoreFromSnapshot(n),!1)}function s0(n){for(;$rt(n)!==null;);}function $rt(n){if(!q(b.name))return null;let e=F.contextualKeyword;if(n.indexOf(e)!==-1&&zrt()){switch(e){case it._readonly:F.tokens[F.tokens.length-1].type=b._readonly;break;case it._abstract:F.tokens[F.tokens.length-1].type=b._abstract;break;case it._static:F.tokens[F.tokens.length-1].type=b._static;break;case it._public:F.tokens[F.tokens.length-1].type=b._public;break;case it._private:F.tokens[F.tokens.length-1].type=b._private;break;case it._protected:F.tokens[F.tokens.length-1].type=b._protected;break;case it._override:F.tokens[F.tokens.length-1].type=b._override;break;case it._declare:F.tokens[F.tokens.length-1].type=b._declare;break;default:break}return e}return null}function c0(){for(ae();bt(b.dot);)ae()}function Izt(){c0(),!Hi()&&q(b.lessThan)&&ay()}function Nzt(){Pt(),oy()}function Azt(){Pt()}function Rzt(){wt(b._typeof),q(b._import)?Drt():c0(),!Hi()&&q(b.lessThan)&&ay()}function Drt(){wt(b._import),wt(b.parenL),wt(b.string),wt(b.parenR),bt(b.dot)&&c0(),q(b.lessThan)&&ay()}function Ozt(){bt(b._const);let n=bt(b._in),e=Wn(it._out);bt(b._const),(n||e)&&!q(b.name)?F.tokens[F.tokens.length-1].type=b.name:ae(),bt(b._extends)&&Yn(),bt(b.eq)&&Yn()}function Sl(){q(b.lessThan)&&AP()}function AP(){let n=Pe(0);for(q(b.lessThan)||q(b.typeParameterStart)?Pt():he();!bt(b.greaterThan)&&!F.error;)Ozt(),bt(b.comma);ve(n)}function y6(n){let e=n===b.arrow;Sl(),wt(b.parenL),F.scopeDepth++,Lzt(!1),F.scopeDepth--,(e||q(n))&&a0(n)}function Lzt(n){r0(b.parenR,n)}function NP(){bt(b.comma)||vn()}function Art(){y6(b.colon),NP()}function Fzt(){let n=F.snapshot();Pt();let e=bt(b.name)&&q(b.colon);return F.restoreFromSnapshot(n),e}function jrt(){if(!(q(b.bracketL)&&Fzt()))return!1;let n=Pe(0);return wt(b.bracketL),ae(),oy(),wt(b.bracketR),Fd(),NP(),ve(n),!0}function Rrt(n){bt(b.question),!n&&(q(b.parenL)||q(b.lessThan))?(y6(b.colon),NP()):(Fd(),NP())}function zzt(){if(q(b.parenL)||q(b.lessThan)){Art();return}if(q(b._new)){Pt(),q(b.parenL)||q(b.lessThan)?Art():Rrt(!1);return}let n=!!$rt([it._readonly]);jrt()||((te(it._get)||te(it._set))&&zrt(),zd(-1),Rrt(n))}function $zt(){Brt()}function Brt(){for(wt(b.braceL);!bt(b.braceR)&&!F.error;)zzt()}function Dzt(){let n=F.snapshot(),e=jzt();return F.restoreFromSnapshot(n),e}function jzt(){return Pt(),bt(b.plus)||bt(b.minus)?te(it._readonly):(te(it._readonly)&&Pt(),!q(b.bracketL)||(Pt(),!f6())?!1:(Pt(),q(b._in)))}function Bzt(){ae(),wt(b._in),Yn()}function Yzt(){wt(b.braceL),q(b.plus)||q(b.minus)?(Pt(),Ln(it._readonly)):Wn(it._readonly),wt(b.bracketL),Bzt(),Wn(it._as)&&Yn(),wt(b.bracketR),q(b.plus)||q(b.minus)?(Pt(),wt(b.question)):bt(b.question),n$t(),vn(),wt(b.braceR)}function Xzt(){for(wt(b.bracketL);!bt(b.bracketR)&&!F.error;)Uzt(),bt(b.comma)}function Uzt(){bt(b.ellipsis)?Yn():(Yn(),bt(b.question)),bt(b.colon)&&Yn()}function Vzt(){wt(b.parenL),Yn(),wt(b.parenR)}function Gzt(){for(Wo(),Wo();!q(b.backQuote)&&!F.error;)wt(b.dollarBraceL),Yn(),Wo(),Wo();Pt()}var bl;(function(n){n[n.TSFunctionType=0]="TSFunctionType";let t=1;n[n.TSConstructorType=t]="TSConstructorType";let i=t+1;n[n.TSAbstractConstructorType=i]="TSAbstractConstructorType"})(bl||(bl={}));function d6(n){n===bl.TSAbstractConstructorType&&Ln(it._abstract),(n===bl.TSConstructorType||n===bl.TSAbstractConstructorType)&&wt(b._new);let e=F.inDisallowConditionalTypesContext;F.inDisallowConditionalTypesContext=!1,y6(b.arrow),F.inDisallowConditionalTypesContext=e}function Hzt(){switch(F.type){case b.name:Izt();return;case b._void:case b._null:Pt();return;case b.string:case b.num:case b.bigint:case b.decimal:case b._true:case b._false:vl();return;case b.minus:Pt(),vl();return;case b._this:{Azt(),te(it._is)&&!Hi()&&Nzt();return}case b._typeof:Rzt();return;case b._import:Drt();return;case b.braceL:Dzt()?Yzt():$zt();return;case b.bracketL:Xzt();return;case b.parenL:Vzt();return;case b.backQuote:Gzt();return;default:if(F.type&b.IS_KEYWORD){Pt(),F.tokens[F.tokens.length-1].type=b.name;return}break}he()}function Wzt(){for(Hzt();!Hi()&&bt(b.bracketL);)bt(b.bracketR)||(Yn(),wt(b.bracketR))}function qzt(){if(Ln(it._infer),ae(),q(b._extends)){let n=F.snapshot();wt(b._extends);let e=F.inDisallowConditionalTypesContext;F.inDisallowConditionalTypesContext=!0,Yn(),F.inDisallowConditionalTypesContext=e,(F.error||!F.inDisallowConditionalTypesContext&&q(b.question))&&F.restoreFromSnapshot(n)}}function m6(){if(te(it._keyof)||te(it._unique)||te(it._readonly))Pt(),m6();else if(te(it._infer))qzt();else{let n=F.inDisallowConditionalTypesContext;F.inDisallowConditionalTypesContext=!1,Wzt(),F.inDisallowConditionalTypesContext=n}}function Ort(){if(bt(b.bitwiseAND),m6(),q(b.bitwiseAND))for(;bt(b.bitwiseAND);)m6()}function Zzt(){if(bt(b.bitwiseOR),Ort(),q(b.bitwiseOR))for(;bt(b.bitwiseOR);)Ort()}function Kzt(){return q(b.lessThan)?!0:q(b.parenL)&&Qzt()}function Jzt(){if(q(b.name)||q(b._this))return Pt(),!0;if(q(b.braceL)||q(b.bracketL)){let n=1;for(Pt();n>0&&!F.error;)q(b.braceL)||q(b.bracketL)?n++:(q(b.braceR)||q(b.bracketR))&&n--,Pt();return!0}return!1}function Qzt(){let n=F.snapshot(),e=t$t();return F.restoreFromSnapshot(n),e}function t$t(){return Pt(),!!(q(b.parenR)||q(b.ellipsis)||Jzt()&&(q(b.colon)||q(b.comma)||q(b.question)||q(b.eq)||q(b.parenR)&&(Pt(),q(b.arrow))))}function a0(n){let e=Pe(0);wt(n),i$t()||Yn(),ve(e)}function e$t(){q(b.colon)&&a0(b.colon)}function Fd(){q(b.colon)&&oy()}function n$t(){bt(b.colon)&&Yn()}function i$t(){let n=F.snapshot();return te(it._asserts)?(Pt(),Wn(it._is)?(Yn(),!0):f6()||q(b._this)?(Pt(),Wn(it._is)&&Yn(),!0):(F.restoreFromSnapshot(n),!1)):f6()||q(b._this)?(Pt(),te(it._is)&&!Hi()?(Pt(),Yn(),!0):(F.restoreFromSnapshot(n),!1)):!1}function oy(){let n=Pe(0);wt(b.colon),Yn(),ve(n)}function Yn(){if(Lrt(),F.inDisallowConditionalTypesContext||Hi()||!bt(b._extends))return;let n=F.inDisallowConditionalTypesContext;F.inDisallowConditionalTypesContext=!0,Lrt(),F.inDisallowConditionalTypesContext=n,wt(b.question),Yn(),wt(b.colon),Yn()}function r$t(){return te(it._abstract)&&Sn()===b._new}function Lrt(){if(Kzt()){d6(bl.TSFunctionType);return}if(q(b._new)){d6(bl.TSConstructorType);return}else if(r$t()){d6(bl.TSAbstractConstructorType);return}Zzt()}function Yrt(){let n=Pe(1);Yn(),wt(b.greaterThan),ve(n),cy()}function Xrt(){if(bt(b.jsxTagStart)){F.tokens[F.tokens.length-1].type=b.typeParameterStart;let n=Pe(1);for(;!q(b.greaterThan)&&!F.error;)Yn(),bt(b.comma);ds(),ve(n)}}function Urt(){for(;!q(b.braceL)&&!F.error;)s$t(),bt(b.comma)}function s$t(){c0(),q(b.lessThan)&&ay()}function o$t(){lo(!1),Sl(),bt(b._extends)&&Urt(),Brt()}function a$t(){lo(!1),Sl(),wt(b.eq),Yn(),vn()}function c$t(){if(q(b.string)?vl():ae(),bt(b.eq)){let n=F.tokens.length-1;ci(),F.tokens[n].rhsEndIndex=F.tokens.length}}function g6(){for(lo(!1),wt(b.braceL);!bt(b.braceR)&&!F.error;)c$t(),bt(b.comma)}function x6(){wt(b.braceL),ly(b.braceR)}function _6(){lo(!1),bt(b.dot)?_6():x6()}function Vrt(){te(it._global)?ae():q(b.string)?js():he(),q(b.braceL)?x6():vn()}function RP(){ry(),wt(b.eq),u$t(),vn()}function l$t(){return te(it._require)&&Sn()===b.parenL}function u$t(){l$t()?p$t():c0()}function p$t(){Ln(it._require),wt(b.parenL),q(b.string)||he(),vl(),wt(b.parenR)}function h$t(){if($s())return!1;switch(F.type){case b._function:{let n=Pe(1);Pt();let e=F.start;return Wa(e,!0),ve(n),!0}case b._class:{let n=Pe(1);return Za(!0,!1),ve(n),!0}case b._const:if(q(b._const)&&ny(it._enum)){let n=Pe(1);return wt(b._const),Ln(it._enum),F.tokens[F.tokens.length-1].type=b._enum,g6(),ve(n),!0}case b._var:case b._let:{let n=Pe(1);return u0(F.type!==b._var),ve(n),!0}case b.name:{let n=Pe(1),e=F.contextualKeyword,t=!1;return e===it._global?(Vrt(),t=!0):t=OP(e,!0),ve(n),t}default:return!1}}function Frt(){return OP(F.contextualKeyword,!0)}function d$t(n){switch(n){case it._declare:{let e=F.tokens.length-1;if(h$t())return F.tokens[e].type=b._declare,!0;break}case it._global:if(q(b.braceL))return x6(),!0;break;default:return OP(n,!1)}return!1}function OP(n,e){switch(n){case it._abstract:if(sy(e)&&q(b._class))return F.tokens[F.tokens.length-1].type=b._abstract,Za(!0,!1),!0;break;case it._enum:if(sy(e)&&q(b.name))return F.tokens[F.tokens.length-1].type=b._enum,g6(),!0;break;case it._interface:if(sy(e)&&q(b.name)){let t=Pe(e?2:1);return o$t(),ve(t),!0}break;case it._module:if(sy(e)){if(q(b.string)){let t=Pe(e?2:1);return Vrt(),ve(t),!0}else if(q(b.name)){let t=Pe(e?2:1);return _6(),ve(t),!0}}break;case it._namespace:if(sy(e)&&q(b.name)){let t=Pe(e?2:1);return _6(),ve(t),!0}break;case it._type:if(sy(e)&&q(b.name)){let t=Pe(e?2:1);return a$t(),ve(t),!0}break;default:break}return!1}function sy(n){return n?(Pt(),!0):!$s()}function f$t(){let n=F.snapshot();return AP(),qa(),e$t(),wt(b.arrow),F.error?(F.restoreFromSnapshot(n),!1):($d(!0),!0)}function b6(){F.type===b.bitShiftL&&(F.pos-=1,be(b.lessThan)),ay()}function ay(){let n=Pe(0);for(wt(b.lessThan);!q(b.greaterThan)&&!F.error;)Yn(),bt(b.comma);n?(wt(b.greaterThan),ve(n)):(ve(n),SP(),wt(b.greaterThan),F.tokens[F.tokens.length-1].isType=!0)}function v6(){if(q(b.name))switch(F.contextualKeyword){case it._abstract:case it._declare:case it._enum:case it._interface:case it._module:case it._namespace:case it._type:return!0;default:break}return!1}function Grt(n,e){if(q(b.colon)&&a0(b.colon),!q(b.braceL)&&$s()){let t=F.tokens.length-1;for(;t>=0&&(F.tokens[t].start>=n||F.tokens[t].type===b._default||F.tokens[t].type===b._export);)F.tokens[t].isType=!0,t--;return}$d(!1,e)}function Hrt(n,e,t){if(!Hi()&&bt(b.bang)){F.tokens[F.tokens.length-1].type=b.nonNullAssertion;return}if(q(b.lessThan)||q(b.bitShiftL)){let i=F.snapshot();if(!e&&S6()&&f$t())return;if(b6(),!e&&bt(b.parenL)?(F.tokens[F.tokens.length-1].subscriptStartIndex=n,uo()):q(b.backQuote)?LP():(F.type===b.greaterThan||F.type!==b.parenL&&F.type&b.IS_EXPRESSION_START&&!Hi())&&he(),F.error)F.restoreFromSnapshot(i);else return}else!e&&q(b.questionDot)&&Sn()===b.lessThan&&(Pt(),F.tokens[n].isOptionalChainStart=!0,F.tokens[F.tokens.length-1].subscriptStartIndex=n,ay(),wt(b.parenL),uo());l0(n,e,t)}function Wrt(){if(bt(b._import))return te(it._type)&&Sn()!==b.eq&&Ln(it._type),RP(),!0;if(bt(b.eq))return li(),vn(),!0;if(Wn(it._as))return Ln(it._namespace),ae(),vn(),!0;if(te(it._type)){let n=Sn();(n===b.braceL||n===b.star)&&Pt()}return!1}function qrt(){if(ae(),q(b.comma)||q(b.braceR)){F.tokens[F.tokens.length-1].identifierRole=ee.ImportDeclaration;return}if(ae(),q(b.comma)||q(b.braceR)){F.tokens[F.tokens.length-1].identifierRole=ee.ImportDeclaration,F.tokens[F.tokens.length-2].isType=!0,F.tokens[F.tokens.length-1].isType=!0;return}if(ae(),q(b.comma)||q(b.braceR)){F.tokens[F.tokens.length-3].identifierRole=ee.ImportAccess,F.tokens[F.tokens.length-1].identifierRole=ee.ImportDeclaration;return}ae(),F.tokens[F.tokens.length-3].identifierRole=ee.ImportAccess,F.tokens[F.tokens.length-1].identifierRole=ee.ImportDeclaration,F.tokens[F.tokens.length-4].isType=!0,F.tokens[F.tokens.length-3].isType=!0,F.tokens[F.tokens.length-2].isType=!0,F.tokens[F.tokens.length-1].isType=!0}function Zrt(){if(ae(),q(b.comma)||q(b.braceR)){F.tokens[F.tokens.length-1].identifierRole=ee.ExportAccess;return}if(ae(),q(b.comma)||q(b.braceR)){F.tokens[F.tokens.length-1].identifierRole=ee.ExportAccess,F.tokens[F.tokens.length-2].isType=!0,F.tokens[F.tokens.length-1].isType=!0;return}if(ae(),q(b.comma)||q(b.braceR)){F.tokens[F.tokens.length-3].identifierRole=ee.ExportAccess;return}ae(),F.tokens[F.tokens.length-3].identifierRole=ee.ExportAccess,F.tokens[F.tokens.length-4].isType=!0,F.tokens[F.tokens.length-3].isType=!0,F.tokens[F.tokens.length-2].isType=!0,F.tokens[F.tokens.length-1].isType=!0}function Krt(){if(te(it._abstract)&&Sn()===b._class)return F.type=b._abstract,Pt(),Za(!0,!0),!0;if(te(it._interface)){let n=Pe(2);return OP(it._interface,!0),ve(n),!0}return!1}function Jrt(){if(F.type===b._const){let n=Ga();if(n.type===b.name&&n.contextualKeyword===it._enum)return wt(b._const),Ln(it._enum),F.tokens[F.tokens.length-1].type=b._enum,g6(),!0}return!1}function Qrt(n){let e=F.tokens.length;s0([it._abstract,it._readonly,it._declare,it._static,it._override]);let t=F.tokens.length;if(jrt()){let r=n?e-1:e;for(let s=r;s<t;s++)F.tokens[s].isType=!0;return!0}return!1}function tst(n){d$t(n)||vn()}function est(){let n=Wn(it._declare);n&&(F.tokens[F.tokens.length-1].type=b._declare);let e=!1;if(q(b.name))if(n){let t=Pe(2);e=Frt(),ve(t)}else e=Frt();if(!e)if(n){let t=Pe(2);Ir(!0),ve(t)}else Ir(!0)}function nst(n){if(n&&(q(b.lessThan)||q(b.bitShiftL))&&b6(),Wn(it._implements)){F.tokens[F.tokens.length-1].type=b._implements;let e=Pe(1);Urt(),ve(e)}}function ist(){Sl()}function rst(){Sl()}function sst(){let n=Pe(0);Hi()||bt(b.bang),Fd(),ve(n)}function ost(){q(b.colon)&&oy()}function ast(n,e){return ey?m$t(n,e):_$t(n,e)}function m$t(n,e){if(!q(b.lessThan))return Ds(n,e);let t=F.snapshot(),i=Ds(n,e);if(F.error)F.restoreFromSnapshot(t);else return i;return F.type=b.typeParameterStart,AP(),i=Ds(n,e),i||he(),i}function _$t(n,e){if(!q(b.lessThan))return Ds(n,e);let t=F.snapshot();AP();let i=Ds(n,e);if(i||he(),F.error)F.restoreFromSnapshot(t);else return i;return Ds(n,e)}function cst(){if(q(b.colon)){let n=F.snapshot();a0(b.colon),ar()&&he(),q(b.arrow)||he(),F.error&&F.restoreFromSnapshot(n)}return bt(b.arrow)}function Irt(){let n=Pe(0);bt(b.question),Fd(),ve(n)}function lst(){(q(b.lessThan)||q(b.bitShiftL))&&b6(),w6()}function y$t(){let n=!1,e=!1;for(;;){if(F.pos>=Rt.length){he("Unterminated JSX contents");return}let t=Rt.charCodeAt(F.pos);if(t===lt.lessThan||t===lt.leftCurlyBrace){if(F.pos===F.start){if(t===lt.lessThan){F.pos++,be(b.jsxTagStart);return}W9(t);return}n&&!e?be(b.jsxEmptyText):be(b.jsxText);return}t===lt.lineFeed?n=!0:t!==lt.space&&t!==lt.carriageReturn&&t!==lt.tab&&(e=!0),F.pos++}}function g$t(n){for(F.pos++;;){if(F.pos>=Rt.length){he("Unterminated string constant");return}if(Rt.charCodeAt(F.pos)===n){F.pos++;break}F.pos++}be(b.string)}function x$t(){let n;do{if(F.pos>Rt.length){he("Unexpectedly reached the end of input.");return}n=Rt.charCodeAt(++F.pos)}while(Cr[n]||n===lt.dash);be(b.jsxName)}function P6(){ds()}function ust(n){if(P6(),!bt(b.colon)){F.tokens[F.tokens.length-1].identifierRole=n;return}P6()}function pst(){let n=F.tokens.length;ust(ee.Access);let e=!1;for(;q(b.dot);)e=!0,ds(),P6();if(!e){let t=F.tokens[n],i=Rt.charCodeAt(t.start);i>=lt.lowercaseA&&i<=lt.lowercaseZ&&(t.identifierRole=null)}}function b$t(){switch(F.type){case b.braceL:Pt(),li(),ds();return;case b.jsxTagStart:k6(),ds();return;case b.string:ds();return;default:he("JSX value should be either an expression or a quoted JSX text")}}function v$t(){wt(b.ellipsis),li()}function S$t(n){if(q(b.jsxTagEnd))return!1;pst(),Oe&&Xrt();let e=!1;for(;!q(b.slash)&&!q(b.jsxTagEnd)&&!F.error;){if(bt(b.braceL)){e=!0,wt(b.ellipsis),ci(),ds();continue}e&&F.end-F.start===3&&Rt.charCodeAt(F.start)===lt.lowercaseK&&Rt.charCodeAt(F.start+1)===lt.lowercaseE&&Rt.charCodeAt(F.start+2)===lt.lowercaseY&&(F.tokens[n].jsxRole=ps.KeyAfterPropSpread),ust(ee.ObjectKey),q(b.eq)&&(ds(),b$t())}let t=q(b.slash);return t&&ds(),t}function w$t(){q(b.jsxTagEnd)||pst()}function hst(){let n=F.tokens.length-1;F.tokens[n].jsxRole=ps.NoChildren;let e=0;if(!S$t(n))for(uy();;)switch(F.type){case b.jsxTagStart:if(ds(),q(b.slash)){ds(),w$t(),F.tokens[n].jsxRole!==ps.KeyAfterPropSpread&&(e===1?F.tokens[n].jsxRole=ps.OneChild:e>1&&(F.tokens[n].jsxRole=ps.StaticChildren));return}e++,hst(),uy();break;case b.jsxText:e++,uy();break;case b.jsxEmptyText:uy();break;case b.braceL:Pt(),q(b.ellipsis)?(v$t(),uy(),e+=2):(q(b.braceR)||(e++,li()),uy());break;default:he();return}}function k6(){ds(),hst()}function ds(){F.tokens.push(new Ld),H9(),F.start=F.pos;let n=Rt.charCodeAt(F.pos);if(Ha[n])x$t();else if(n===lt.quotationMark||n===lt.apostrophe)g$t(n);else switch(++F.pos,n){case lt.greaterThan:be(b.jsxTagEnd);break;case lt.lessThan:be(b.jsxTagStart);break;case lt.slash:be(b.slash);break;case lt.equalsTo:be(b.eq);break;case lt.leftCurlyBrace:be(b.braceL);break;case lt.dot:be(b.dot);break;case lt.colon:be(b.colon);break;default:he()}}function uy(){F.tokens.push(new Ld),F.start=F.pos,y$t()}function dst(n){if(q(b.question)){let e=Sn();if(e===b.colon||e===b.comma||e===b.parenR)return}T6(n)}function fst(){vP(b.question),q(b.colon)&&(Oe?oy():Ye&&Ka())}var E6=class{constructor(e){this.stop=e}};function li(n=!1){if(ci(n),q(b.comma))for(;bt(b.comma);)ci(n)}function ci(n=!1,e=!1){return Oe?ast(n,e):Ye?wst(n,e):Ds(n,e)}function Ds(n,e){if(q(b._yield))return D$t(),!1;(q(b.parenL)||q(b.name)||q(b._yield))&&(F.potentialArrowAt=F.start);let t=P$t(n);return e&&A6(),F.type&b.IS_ASSIGN?(Pt(),ci(n),!1):t}function P$t(n){return T$t(n)?!0:(k$t(n),!1)}function k$t(n){Oe||Ye?dst(n):T6(n)}function T6(n){bt(b.question)&&(ci(),wt(b.colon),ci(n))}function T$t(n){let e=F.tokens.length;return cy()?!0:(FP(e,-1,n),!1)}function FP(n,e,t){if(Oe&&(b._in&b.PRECEDENCE_MASK)>e&&!Hi()&&(Wn(it._as)||Wn(it._satisfies))){let r=Pe(1);Yn(),ve(r),SP(),FP(n,e,t);return}let i=F.type&b.PRECEDENCE_MASK;if(i>0&&(!t||!q(b._in))&&i>e){let r=F.type;Pt(),r===b.nullishCoalescing&&(F.tokens[F.tokens.length-1].nullishStartIndex=n);let s=F.tokens.length;cy(),FP(s,r&b.IS_RIGHT_ASSOCIATIVE?i-1:i,t),r===b.nullishCoalescing&&(F.tokens[n].numNullishCoalesceStarts++,F.tokens[F.tokens.length-1].numNullishCoalesceEnds++),FP(n,e,t)}}function cy(){if(Oe&&!ey&&bt(b.lessThan))return Yrt(),!1;if(te(it._module)&&U9()===lt.leftCurlyBrace&&!gP())return j$t(),!1;if(F.type&b.IS_PREFIX)return Pt(),cy(),!1;if(M6())return!0;for(;F.type&b.IS_POSTFIX&&!ar();)F.type===b.preIncDec&&(F.type=b.postIncDec),Pt();return!1}function M6(){let n=F.tokens.length;return js()?!0:(C6(n),F.tokens.length>n&&F.tokens[n].isOptionalChainStart&&(F.tokens[F.tokens.length-1].isOptionalChainEnd=!0),!1)}function C6(n,e=!1){Ye?kst(n,e):I6(n,e)}function I6(n,e=!1){let t=new E6(!1);do E$t(n,e,t);while(!t.stop&&!F.error)}function E$t(n,e,t){Oe?Hrt(n,e,t):Ye?xst(n,e,t):l0(n,e,t)}function l0(n,e,t){if(!e&&bt(b.doubleColon))N6(),t.stop=!0,C6(n,e);else if(q(b.questionDot)){if(F.tokens[n].isOptionalChainStart=!0,e&&Sn()===b.parenL){t.stop=!0;return}Pt(),F.tokens[F.tokens.length-1].subscriptStartIndex=n,bt(b.bracketL)?(li(),wt(b.bracketR)):bt(b.parenL)?uo():zP()}else if(bt(b.dot))F.tokens[F.tokens.length-1].subscriptStartIndex=n,zP();else if(bt(b.bracketL))F.tokens[F.tokens.length-1].subscriptStartIndex=n,li(),wt(b.bracketR);else if(!e&&q(b.parenL))if(S6()){let i=F.snapshot(),r=F.tokens.length;Pt(),F.tokens[F.tokens.length-1].subscriptStartIndex=n;let s=Od();F.tokens[F.tokens.length-1].contextId=s,uo(),F.tokens[F.tokens.length-1].contextId=s,M$t()&&(F.restoreFromSnapshot(i),t.stop=!0,F.scopeDepth++,qa(),C$t(r))}else{Pt(),F.tokens[F.tokens.length-1].subscriptStartIndex=n;let i=Od();F.tokens[F.tokens.length-1].contextId=i,uo(),F.tokens[F.tokens.length-1].contextId=i}else q(b.backQuote)?LP():t.stop=!0}function S6(){return F.tokens[F.tokens.length-1].contextualKeyword===it._async&&!ar()}function uo(){let n=!0;for(;!bt(b.parenR)&&!F.error;){if(n)n=!1;else if(wt(b.comma),bt(b.parenR))break;yst(!1)}}function M$t(){return q(b.colon)||q(b.arrow)}function C$t(n){Oe?ost():Ye&&Sst(),wt(b.arrow),py(n)}function N6(){let n=F.tokens.length;js(),C6(n,!0)}function js(){if(bt(b.modulo))return ae(),!1;if(q(b.jsxText)||q(b.jsxEmptyText))return vl(),!1;if(q(b.lessThan)&&ey)return F.type=b.jsxTagStart,k6(),Pt(),!1;let n=F.potentialArrowAt===F.start;switch(F.type){case b.slash:case b.assign:Git();case b._super:case b._this:case b.regexp:case b.num:case b.bigint:case b.decimal:case b.string:case b._null:case b._true:case b._false:return Pt(),!1;case b._import:return Pt(),q(b.dot)&&(F.tokens[F.tokens.length-1].type=b.name,Pt(),ae()),!1;case b.name:{let e=F.tokens.length,t=F.start,i=F.contextualKeyword;return ae(),i===it._await?($$t(),!1):i===it._async&&q(b._function)&&!ar()?(Pt(),Wa(t,!1),!1):n&&i===it._async&&!ar()&&q(b.name)?(F.scopeDepth++,lo(!1),wt(b.arrow),py(e),!0):q(b._do)&&!ar()?(Pt(),Ja(),!1):n&&!ar()&&q(b.arrow)?(F.scopeDepth++,IP(!1),wt(b.arrow),py(e),!0):(F.tokens[F.tokens.length-1].identifierRole=ee.Access,!1)}case b._do:return Pt(),Ja(),!1;case b.parenL:return mst(n);case b.bracketL:return Pt(),_st(b.bracketR,!0),!1;case b.braceL:return o0(!1,!1),!1;case b._function:return I$t(),!1;case b.at:BP();case b._class:return Za(!1),!1;case b._new:return A$t(),!1;case b.backQuote:return LP(),!1;case b.doubleColon:return Pt(),N6(),!1;case b.hash:{let e=U9();return Ha[e]||e===lt.backslash?zP():Pt(),!1}default:return he(),!1}}function zP(){bt(b.hash),ae()}function I$t(){let n=F.start;ae(),bt(b.dot)&&ae(),Wa(n,!1)}function vl(){Pt()}function p0(){wt(b.parenL),li(),wt(b.parenR)}function mst(n){let e=F.snapshot(),t=F.tokens.length;wt(b.parenL);let i=!0;for(;!q(b.parenR)&&!F.error;){if(i)i=!1;else if(wt(b.comma),q(b.parenR))break;if(q(b.ellipsis)){h6(!1),A6();break}else ci(!1,!0)}return wt(b.parenR),n&&N$t()&&$P()?(F.restoreFromSnapshot(e),F.scopeDepth++,qa(),$P(),py(t),F.error?(F.restoreFromSnapshot(e),mst(!1),!1):!0):!1}function N$t(){return q(b.colon)||!ar()}function $P(){return Oe?cst():Ye?Pst():bt(b.arrow)}function A6(){(Oe||Ye)&&fst()}function A$t(){if(wt(b._new),bt(b.dot)){ae();return}R$t(),Ye&&bst(),bt(b.parenL)&&_st(b.parenR)}function R$t(){N6(),bt(b.questionDot)}function LP(){for(Wo(),Wo();!q(b.backQuote)&&!F.error;)wt(b.dollarBraceL),li(),Wo(),Wo();Pt()}function o0(n,e){let t=Od(),i=!0;for(Pt(),F.tokens[F.tokens.length-1].contextId=t;!bt(b.braceR)&&!F.error;){if(i)i=!1;else if(wt(b.comma),bt(b.braceR))break;let r=!1;if(q(b.ellipsis)){let s=F.tokens.length;if(p6(),n&&(F.tokens.length===s+2&&IP(e),bt(b.braceR)))break;continue}n||(r=bt(b.star)),!n&&te(it._async)?(r&&he(),ae(),q(b.colon)||q(b.parenL)||q(b.braceR)||q(b.eq)||q(b.comma)||(q(b.star)&&(Pt(),r=!0),zd(t))):zd(t),z$t(n,e,t)}F.tokens[F.tokens.length-1].contextId=t}function O$t(n){return!n&&(q(b.string)||q(b.num)||q(b.bracketL)||q(b.name)||!!(F.type&b.IS_KEYWORD))}function L$t(n,e){let t=F.start;return q(b.parenL)?(n&&he(),DP(t,!1),!0):O$t(n)?(zd(e),DP(t,!1),!0):!1}function F$t(n,e){if(bt(b.colon)){n?n0(e):ci(!1);return}let t;n?F.scopeDepth===0?t=ee.ObjectShorthandTopLevelDeclaration:e?t=ee.ObjectShorthandBlockScopedDeclaration:t=ee.ObjectShorthandFunctionScopedDeclaration:t=ee.ObjectShorthand,F.tokens[F.tokens.length-1].identifierRole=t,n0(e,!0)}function z$t(n,e,t){Oe?ist():Ye&&vst(),L$t(n,t)||F$t(n,e)}function zd(n){Ye&&jP(),bt(b.bracketL)?(F.tokens[F.tokens.length-1].contextId=n,ci(),wt(b.bracketR),F.tokens[F.tokens.length-1].contextId=n):(q(b.num)||q(b.string)||q(b.bigint)||q(b.decimal)?js():zP(),F.tokens[F.tokens.length-1].identifierRole=ee.ObjectKey,F.tokens[F.tokens.length-1].contextId=n)}function DP(n,e){let t=Od();F.scopeDepth++;let i=F.tokens.length;qa(e,t),R6(n,t);let s=F.tokens.length;F.scopes.push(new Gr(i,s,!0)),F.scopeDepth--}function py(n){$d(!0);let e=F.tokens.length;F.scopes.push(new Gr(n,e,!0)),F.scopeDepth--}function R6(n,e=0){Oe?Grt(n,e):Ye?gst(e):$d(!1,e)}function $d(n,e=0){n&&!q(b.braceL)?ci():Ja(!0,e)}function _st(n,e=!1){let t=!0;for(;!bt(n)&&!F.error;){if(t)t=!1;else if(wt(b.comma),bt(n))break;yst(e)}}function yst(n){n&&q(b.comma)||(q(b.ellipsis)?(p6(),A6()):q(b.question)?Pt():ci(!1,!0))}function ae(){Pt(),F.tokens[F.tokens.length-1].type=b.name}function $$t(){cy()}function D$t(){Pt(),!q(b.semi)&&!ar()&&(bt(b.star),ci())}function j$t(){Ln(it._module),wt(b.braceL),ly(b.braceR)}function B$t(n){return(n.type===b.name||!!(n.type&b.IS_KEYWORD))&&n.contextualKeyword!==it._from}function Ko(n){let e=Pe(0);wt(n||b.colon),Wr(),ve(e)}function Tst(){wt(b.modulo),Ln(it._checks),bt(b.parenL)&&(li(),wt(b.parenR))}function F6(){let n=Pe(0);wt(b.colon),q(b.modulo)?Tst():(Wr(),q(b.modulo)&&Tst()),ve(n)}function Y$t(){Pt(),z6(!0)}function X$t(){Pt(),ae(),q(b.lessThan)&&Bs(),wt(b.parenL),L6(),wt(b.parenR),F6(),vn()}function O6(){q(b._class)?Y$t():q(b._function)?X$t():q(b._var)?U$t():Wn(it._module)?bt(b.dot)?H$t():V$t():te(it._type)?W$t():te(it._opaque)?q$t():te(it._interface)?Z$t():q(b._export)?G$t():he()}function U$t(){Pt(),Ast(),vn()}function V$t(){for(q(b.string)?js():ae(),wt(b.braceL);!q(b.braceR)&&!F.error;)q(b._import)?(Pt(),U6()):he();wt(b.braceR)}function G$t(){wt(b._export),bt(b._default)?q(b._function)||q(b._class)?O6():(Wr(),vn()):q(b._var)||q(b._function)||q(b._class)||te(it._opaque)?O6():q(b.star)||q(b.braceL)||te(it._interface)||te(it._type)||te(it._opaque)?X6():he()}function H$t(){Ln(it._exports),Ka(),vn()}function W$t(){Pt(),D6()}function q$t(){Pt(),j6(!0)}function Z$t(){Pt(),z6()}function z6(n=!1){if(GP(),q(b.lessThan)&&Bs(),bt(b._extends))do YP();while(!n&&bt(b.comma));if(te(it._mixins)){Pt();do YP();while(bt(b.comma))}if(te(it._implements)){Pt();do YP();while(bt(b.comma))}XP(n,!1,n)}function YP(){Cst(!1),q(b.lessThan)&&Dd()}function $6(){z6()}function GP(){ae()}function D6(){GP(),q(b.lessThan)&&Bs(),Ko(b.eq),vn()}function j6(n){Ln(it._type),GP(),q(b.lessThan)&&Bs(),q(b.colon)&&Ko(b.colon),n||Ko(b.eq),vn()}function K$t(){jP(),Ast(),bt(b.eq)&&Wr()}function Bs(){let n=Pe(0);q(b.lessThan)||q(b.typeParameterStart)?Pt():he();do K$t(),q(b.greaterThan)||wt(b.comma);while(!q(b.greaterThan)&&!F.error);wt(b.greaterThan),ve(n)}function Dd(){let n=Pe(0);for(wt(b.lessThan);!q(b.greaterThan)&&!F.error;)Wr(),q(b.greaterThan)||wt(b.comma);wt(b.greaterThan),ve(n)}function J$t(){if(Ln(it._interface),bt(b._extends))do YP();while(bt(b.comma));XP(!1,!1,!1)}function B6(){q(b.num)||q(b.string)?js():ae()}function Q$t(){Sn()===b.colon?(B6(),Ko()):Wr(),wt(b.bracketR),Ko()}function tDt(){B6(),wt(b.bracketR),wt(b.bracketR),q(b.lessThan)||q(b.parenL)?Y6():(bt(b.question),Ko())}function Y6(){for(q(b.lessThan)&&Bs(),wt(b.parenL);!q(b.parenR)&&!q(b.ellipsis)&&!F.error;)UP(),q(b.parenR)||wt(b.comma);bt(b.ellipsis)&&UP(),wt(b.parenR),Ko()}function eDt(){Y6()}function XP(n,e,t){let i;for(e&&q(b.braceBarL)?(wt(b.braceBarL),i=b.braceBarR):(wt(b.braceL),i=b.braceR);!q(i)&&!F.error;){if(t&&te(it._proto)){let r=Sn();r!==b.colon&&r!==b.question&&(Pt(),n=!1)}if(n&&te(it._static)){let r=Sn();r!==b.colon&&r!==b.question&&Pt()}if(jP(),bt(b.bracketL))bt(b.bracketL)?tDt():Q$t();else if(q(b.parenL)||q(b.lessThan))eDt();else{if(te(it._get)||te(it._set)){let r=Sn();(r===b.name||r===b.string||r===b.num)&&Pt()}nDt()}iDt()}wt(i)}function nDt(){if(q(b.ellipsis)){if(wt(b.ellipsis),bt(b.comma)||bt(b.semi),q(b.braceR))return;Wr()}else B6(),q(b.lessThan)||q(b.parenL)?Y6():(bt(b.question),Ko())}function iDt(){!bt(b.semi)&&!bt(b.comma)&&!q(b.braceR)&&!q(b.braceBarR)&&he()}function Cst(n){for(n||ae();bt(b.dot);)ae()}function rDt(){Cst(!0),q(b.lessThan)&&Dd()}function sDt(){wt(b._typeof),Ist()}function oDt(){for(wt(b.bracketL);F.pos<Rt.length&&!q(b.bracketR)&&(Wr(),!q(b.bracketR));)wt(b.comma);wt(b.bracketR)}function UP(){let n=Sn();n===b.colon||n===b.question?(ae(),bt(b.question),Ko()):Wr()}function L6(){for(;!q(b.parenR)&&!q(b.ellipsis)&&!F.error;)UP(),q(b.parenR)||wt(b.comma);bt(b.ellipsis)&&UP()}function Ist(){let n=!1,e=F.noAnonFunctionType;switch(F.type){case b.name:{if(te(it._interface)){J$t();return}ae(),rDt();return}case b.braceL:XP(!1,!1,!1);return;case b.braceBarL:XP(!1,!0,!1);return;case b.bracketL:oDt();return;case b.lessThan:Bs(),wt(b.parenL),L6(),wt(b.parenR),wt(b.arrow),Wr();return;case b.parenL:if(Pt(),!q(b.parenR)&&!q(b.ellipsis))if(q(b.name)){let t=Sn();n=t!==b.question&&t!==b.colon}else n=!0;if(n)if(F.noAnonFunctionType=!1,Wr(),F.noAnonFunctionType=e,F.noAnonFunctionType||!(q(b.comma)||q(b.parenR)&&Sn()===b.arrow)){wt(b.parenR);return}else bt(b.comma);L6(),wt(b.parenR),wt(b.arrow),Wr();return;case b.minus:Pt(),vl();return;case b.string:case b.num:case b._true:case b._false:case b._null:case b._this:case b._void:case b.star:Pt();return;default:if(F.type===b._typeof){sDt();return}else if(F.type&b.IS_KEYWORD){Pt(),F.tokens[F.tokens.length-1].type=b.name;return}}he()}function aDt(){for(Ist();!ar()&&(q(b.bracketL)||q(b.questionDot));)bt(b.questionDot),wt(b.bracketL),bt(b.bracketR)||(Wr(),wt(b.bracketR))}function Nst(){bt(b.question)?Nst():aDt()}function Est(){Nst(),!F.noAnonFunctionType&&bt(b.arrow)&&Wr()}function Mst(){for(bt(b.bitwiseAND),Est();bt(b.bitwiseAND);)Est()}function cDt(){for(bt(b.bitwiseOR),Mst();bt(b.bitwiseOR);)Mst()}function Wr(){cDt()}function Ka(){Ko()}function Ast(){ae(),q(b.colon)&&Ka()}function jP(){(q(b.plus)||q(b.minus))&&(Pt(),F.tokens[F.tokens.length-1].isType=!0)}function gst(n){q(b.colon)&&F6(),$d(!1,n)}function xst(n,e,t){if(q(b.questionDot)&&Sn()===b.lessThan){if(e){t.stop=!0;return}Pt(),Dd(),wt(b.parenL),uo();return}else if(!e&&q(b.lessThan)){let i=F.snapshot();if(Dd(),wt(b.parenL),uo(),F.error)F.restoreFromSnapshot(i);else return}l0(n,e,t)}function bst(){if(q(b.lessThan)){let n=F.snapshot();Dd(),F.error&&F.restoreFromSnapshot(n)}}function Rst(){if(q(b.name)&&F.contextualKeyword===it._interface){let n=Pe(0);return Pt(),$6(),ve(n),!0}else if(te(it._enum))return Gst(),!0;return!1}function Ost(){return te(it._enum)?(Gst(),!0):!1}function Lst(n){if(n===it._declare){if(q(b._class)||q(b.name)||q(b._function)||q(b._var)||q(b._export)){let e=Pe(1);O6(),ve(e)}}else if(q(b.name)){if(n===it._interface){let e=Pe(1);$6(),ve(e)}else if(n===it._type){let e=Pe(1);D6(),ve(e)}else if(n===it._opaque){let e=Pe(1);j6(!1),ve(e)}}vn()}function Fst(){return te(it._type)||te(it._interface)||te(it._opaque)||te(it._enum)}function zst(){return q(b.name)&&(F.contextualKeyword===it._type||F.contextualKeyword===it._interface||F.contextualKeyword===it._opaque||F.contextualKeyword===it._enum)}function $st(){if(te(it._type)){let n=Pe(1);Pt(),q(b.braceL)?(HP(),hy()):D6(),ve(n)}else if(te(it._opaque)){let n=Pe(1);Pt(),j6(!1),ve(n)}else if(te(it._interface)){let n=Pe(1);Pt(),$6(),ve(n)}else Ir(!0)}function Dst(){return q(b.star)||te(it._type)&&Sn()===b.star}function jst(){if(Wn(it._type)){let n=Pe(2);VP(),ve(n)}else VP()}function Bst(n){if(n&&q(b.lessThan)&&Dd(),te(it._implements)){let e=Pe(0);Pt(),F.tokens[F.tokens.length-1].type=b._implements;do GP(),q(b.lessThan)&&Dd();while(bt(b.comma));ve(e)}}function vst(){q(b.lessThan)&&(Bs(),q(b.parenL)||he())}function Nrt(){let n=Pe(0);bt(b.question),q(b.colon)&&Ka(),ve(n)}function Yst(){if(q(b._typeof)||te(it._type)){let n=Ga();(B$t(n)||n.type===b.braceL||n.type===b.star)&&Pt()}}function Xst(){let n=F.contextualKeyword===it._type||F.type===b._typeof;n?Pt():ae(),te(it._as)&&!ny(it._as)?(ae(),n&&!q(b.name)&&!(F.type&b.IS_KEYWORD)||ae()):(n&&(q(b.name)||F.type&b.IS_KEYWORD)&&ae(),Wn(it._as)&&ae())}function Ust(){if(q(b.lessThan)){let n=Pe(0);Bs(),ve(n)}}function Vst(){q(b.colon)&&Ka()}function Sst(){if(q(b.colon)){let n=F.noAnonFunctionType;F.noAnonFunctionType=!0,Ka(),F.noAnonFunctionType=n}}function wst(n,e){if(q(b.lessThan)){let t=F.snapshot(),i=Ds(n,e);if(F.error)F.restoreFromSnapshot(t),F.type=b.typeParameterStart;else return i;let r=Pe(0);if(Bs(),ve(r),i=Ds(n,e),i)return!0;he()}return Ds(n,e)}function Pst(){if(q(b.colon)){let n=Pe(0),e=F.snapshot(),t=F.noAnonFunctionType;F.noAnonFunctionType=!0,F6(),F.noAnonFunctionType=t,ar()&&he(),q(b.arrow)||he(),F.error&&F.restoreFromSnapshot(e),ve(n)}return bt(b.arrow)}function kst(n,e=!1){if(F.tokens[F.tokens.length-1].contextualKeyword===it._async&&q(b.lessThan)){let t=F.snapshot();if(lDt()&&!F.error)return;F.restoreFromSnapshot(t)}I6(n,e)}function lDt(){F.scopeDepth++;let n=F.tokens.length;return qa(),$P()?(py(n),!0):!1}function Gst(){Ln(it._enum),F.tokens[F.tokens.length-1].type=b._enum,ae(),uDt()}function uDt(){Wn(it._of)&&Pt(),wt(b.braceL),pDt(),wt(b.braceR)}function pDt(){for(;!q(b.braceR)&&!F.error&&!bt(b.ellipsis);)hDt(),q(b.braceR)||wt(b.comma)}function hDt(){ae(),bt(b.eq)&&Pt()}function Zst(){if(ly(b.eof),F.scopes.push(new Gr(0,F.tokens.length,!0)),F.scopeDepth!==0)throw new Error(`Invalid scope depth at end of file: ${F.scopeDepth}`);return new qP(F.tokens,F.scopes)}function Ir(n){Ye&&Rst()||(q(b.at)&&BP(),dDt(n))}function dDt(n){if(Oe&&Jrt())return;let e=F.type;switch(e){case b._break:case b._continue:mDt();return;case b._debugger:_Dt();return;case b._do:yDt();return;case b._for:gDt();return;case b._function:if(Sn()===b.dot)break;n||he(),vDt();return;case b._class:n||he(),Za(!0);return;case b._if:SDt();return;case b._return:wDt();return;case b._switch:PDt();return;case b._throw:kDt();return;case b._try:EDt();return;case b._let:case b._const:n||he();case b._var:u0(e!==b._var);return;case b._while:MDt();return;case b.braceL:Ja();return;case b.semi:CDt();return;case b._export:case b._import:{let r=Sn();if(r===b.parenL||r===b.dot)break;Pt(),e===b._import?U6():X6();return}case b.name:if(F.contextualKeyword===it._async){let r=F.start,s=F.snapshot();if(Pt(),q(b._function)&&!ar()){wt(b._function),Wa(r,!0);return}else F.restoreFromSnapshot(s)}else if(F.contextualKeyword===it._using&&!gP()&&Sn()===b.name){u0(!0);return}else if(Kst()){Ln(it._await),u0(!0);return}default:break}let t=F.tokens.length;li();let i=null;if(F.tokens.length===t+1){let r=F.tokens[F.tokens.length-1];r.type===b.name&&(i=r.contextualKeyword)}if(i==null){vn();return}bt(b.colon)?IDt():NDt(i)}function Kst(){if(!te(it._await))return!1;let n=F.snapshot();return Pt(),!te(it._using)||Hi()?(F.restoreFromSnapshot(n),!1):(Pt(),!q(b.name)||Hi()?(F.restoreFromSnapshot(n),!1):(F.restoreFromSnapshot(n),!0))}function BP(){for(;q(b.at);)Jst()}function Jst(){if(Pt(),bt(b.parenL))li(),wt(b.parenR);else{for(ae();bt(b.dot);)ae();fDt()}}function fDt(){Oe?lst():w6()}function w6(){bt(b.parenL)&&uo()}function mDt(){Pt(),$s()||(ae(),vn())}function _Dt(){Pt(),vn()}function yDt(){Pt(),Ir(!1),wt(b._while),p0(),bt(b.semi)}function gDt(){F.scopeDepth++;let n=F.tokens.length;bDt();let e=F.tokens.length;F.scopes.push(new Gr(n,e,!1)),F.scopeDepth--}function xDt(){return!(!te(it._using)||ny(it._of))}function bDt(){Pt();let n=!1;if(te(it._await)&&(n=!0,Pt()),wt(b.parenL),q(b.semi)){n&&he(),V6();return}let e=Kst();if(e||q(b._var)||q(b._let)||q(b._const)||xDt()){if(e&&Ln(it._await),Pt(),Qst(!0,F.type!==b._var),q(b._in)||te(it._of)){Hst(n);return}V6();return}if(li(!0),q(b._in)||te(it._of)){Hst(n);return}n&&he(),V6()}function vDt(){let n=F.start;Pt(),Wa(n,!0)}function SDt(){Pt(),p0(),Ir(!1),bt(b._else)&&Ir(!1)}function wDt(){Pt(),$s()||(li(),vn())}function PDt(){Pt(),p0(),F.scopeDepth++;let n=F.tokens.length;for(wt(b.braceL);!q(b.braceR)&&!F.error;)if(q(b._case)||q(b._default)){let t=q(b._case);Pt(),t&&li(),wt(b.colon)}else Ir(!0);Pt();let e=F.tokens.length;F.scopes.push(new Gr(n,e,!1)),F.scopeDepth--}function kDt(){Pt(),li(),vn()}function TDt(){i0(!0),Oe&&Fd()}function EDt(){if(Pt(),Ja(),q(b._catch)){Pt();let n=null;if(q(b.parenL)&&(F.scopeDepth++,n=F.tokens.length,wt(b.parenL),TDt(),wt(b.parenR)),Ja(),n!=null){let e=F.tokens.length;F.scopes.push(new Gr(n,e,!1)),F.scopeDepth--}}bt(b._finally)&&Ja()}function u0(n){Pt(),Qst(!1,n),vn()}function MDt(){Pt(),p0(),Ir(!1)}function CDt(){Pt()}function IDt(){Ir(!0)}function NDt(n){Oe?tst(n):Ye?Lst(n):vn()}function Ja(n=!1,e=0){let t=F.tokens.length;F.scopeDepth++,wt(b.braceL),e&&(F.tokens[F.tokens.length-1].contextId=e),ly(b.braceR),e&&(F.tokens[F.tokens.length-1].contextId=e);let i=F.tokens.length;F.scopes.push(new Gr(t,i,n)),F.scopeDepth--}function ly(n){for(;!bt(n)&&!F.error;)Ir(!0)}function V6(){wt(b.semi),q(b.semi)||li(),wt(b.semi),q(b.parenR)||li(),wt(b.parenR),Ir(!1)}function Hst(n){n?Wn(it._of):Pt(),li(),wt(b.parenR),Ir(!1)}function Qst(n,e){for(;;){if(ADt(e),bt(b.eq)){let t=F.tokens.length-1;ci(n),F.tokens[t].rhsEndIndex=F.tokens.length}if(!bt(b.comma))break}}function ADt(n){i0(n),Oe?sst():Ye&&Vst()}function Wa(n,e,t=!1){q(b.star)&&Pt(),e&&!t&&!q(b.name)&&!q(b._yield)&&he();let i=null;q(b.name)&&(e||(i=F.tokens.length,F.scopeDepth++),lo(!1));let r=F.tokens.length;F.scopeDepth++,qa(),R6(n);let s=F.tokens.length;F.scopes.push(new Gr(r,s,!0)),F.scopeDepth--,i!==null&&(F.scopes.push(new Gr(i,s,!0)),F.scopeDepth--)}function qa(n=!1,e=0){Oe?rst():Ye&&Ust(),wt(b.parenL),e&&(F.tokens[F.tokens.length-1].contextId=e),r0(b.parenR,!1,!1,n,e),e&&(F.tokens[F.tokens.length-1].contextId=e)}function Za(n,e=!1){let t=Od();Pt(),F.tokens[F.tokens.length-1].contextId=t,F.tokens[F.tokens.length-1].isExpression=!n;let i=null;n||(i=F.tokens.length,F.scopeDepth++),FDt(n,e),zDt();let r=F.tokens.length;if(RDt(t),!F.error&&(F.tokens[r].contextId=t,F.tokens[F.tokens.length-1].contextId=t,i!==null)){let s=F.tokens.length;F.scopes.push(new Gr(i,s,!1)),F.scopeDepth--}}function tot(){return q(b.eq)||q(b.semi)||q(b.braceR)||q(b.bang)||q(b.colon)}function eot(){return q(b.parenL)||q(b.lessThan)}function RDt(n){for(wt(b.braceL);!bt(b.braceR)&&!F.error;){if(bt(b.semi))continue;if(q(b.at)){Jst();continue}let e=F.start;ODt(e,n)}}function ODt(n,e){Oe&&s0([it._declare,it._public,it._protected,it._private,it._override]);let t=!1;if(q(b.name)&&F.contextualKeyword===it._static){if(ae(),eot()){d0(n,!1);return}else if(tot()){WP();return}if(F.tokens[F.tokens.length-1].type=b._static,t=!0,q(b.braceL)){F.tokens[F.tokens.length-1].contextId=e,Ja();return}}LDt(n,t,e)}function LDt(n,e,t){if(Oe&&Qrt(e))return;if(bt(b.star)){h0(t),d0(n,!1);return}h0(t);let i=!1,r=F.tokens[F.tokens.length-1];r.contextualKeyword===it._constructor&&(i=!0),Wst(),eot()?d0(n,i):tot()?WP():r.contextualKeyword===it._async&&!$s()?(F.tokens[F.tokens.length-1].type=b._async,q(b.star)&&Pt(),h0(t),Wst(),d0(n,!1)):(r.contextualKeyword===it._get||r.contextualKeyword===it._set)&&!($s()&&q(b.star))?(r.contextualKeyword===it._get?F.tokens[F.tokens.length-1].type=b._get:F.tokens[F.tokens.length-1].type=b._set,h0(t),d0(n,!1)):r.contextualKeyword===it._accessor&&!$s()?(h0(t),WP()):$s()?WP():he()}function d0(n,e){Oe?Sl():Ye&&q(b.lessThan)&&Bs(),DP(n,e)}function h0(n){zd(n)}function Wst(){if(Oe){let n=Pe(0);bt(b.question),ve(n)}}function WP(){if(Oe?(vP(b.bang),Fd()):Ye&&q(b.colon)&&Ka(),q(b.eq)){let n=F.tokens.length;Pt(),ci(),F.tokens[n].rhsEndIndex=F.tokens.length}vn()}function FDt(n,e=!1){Oe&&(!n||e)&&te(it._implements)||(q(b.name)&&lo(!0),Oe?Sl():Ye&&q(b.lessThan)&&Bs())}function zDt(){let n=!1;bt(b._extends)?(M6(),n=!0):n=!1,Oe?nst(n):Ye&&Bst(n)}function X6(){let n=F.tokens.length-1;Oe&&Wrt()||(BDt()?YDt():jDt()?(ae(),q(b.comma)&&Sn()===b.star?(wt(b.comma),wt(b.star),Ln(it._as),ae()):not(),hy()):bt(b._default)?$Dt():UDt()?DDt():(HP(),hy()),F.tokens[n].rhsEndIndex=F.tokens.length)}function $Dt(){if(Oe&&Krt()||Ye&&Ost())return;let n=F.start;bt(b._function)?Wa(n,!0,!0):te(it._async)&&Sn()===b._function?(Wn(it._async),bt(b._function),Wa(n,!0,!0)):q(b._class)?Za(!0,!0):q(b.at)?(BP(),Za(!0,!0)):(ci(),vn())}function DDt(){Oe?est():Ye?$st():Ir(!0)}function jDt(){if(Oe&&v6())return!1;if(Ye&&zst())return!1;if(q(b.name))return F.contextualKeyword!==it._async;if(!q(b._default))return!1;let n=q1(),e=Ga(),t=e.type===b.name&&e.contextualKeyword===it._from;if(e.type===b.comma)return!0;if(t){let i=Rt.charCodeAt(X9(n+4));return i===lt.quotationMark||i===lt.apostrophe}return!1}function not(){bt(b.comma)&&HP()}function hy(){Wn(it._from)&&(js(),iot()),vn()}function BDt(){return Ye?Dst():q(b.star)}function YDt(){Ye?jst():VP()}function VP(){wt(b.star),te(it._as)?XDt():hy()}function XDt(){Pt(),F.tokens[F.tokens.length-1].type=b._as,ae(),not(),hy()}function UDt(){return Oe&&v6()||Ye&&Fst()||F.type===b._var||F.type===b._const||F.type===b._let||F.type===b._function||F.type===b._class||te(it._async)||q(b.at)}function HP(){let n=!0;for(wt(b.braceL);!bt(b.braceR)&&!F.error;){if(n)n=!1;else if(wt(b.comma),bt(b.braceR))break;VDt()}}function VDt(){if(Oe){Zrt();return}ae(),F.tokens[F.tokens.length-1].identifierRole=ee.ExportAccess,Wn(it._as)&&ae()}function GDt(){let n=F.snapshot();return Ln(it._module),Wn(it._from)?te(it._from)?(F.restoreFromSnapshot(n),!0):(F.restoreFromSnapshot(n),!1):q(b.comma)?(F.restoreFromSnapshot(n),!1):(F.restoreFromSnapshot(n),!0)}function HDt(){te(it._module)&&GDt()&&Pt()}function U6(){if(Oe&&q(b.name)&&Sn()===b.eq){RP();return}if(Oe&&te(it._type)){let n=Ga();if(n.type===b.name&&n.contextualKeyword!==it._from){if(Ln(it._type),Sn()===b.eq){RP();return}}else(n.type===b.star||n.type===b.braceL)&&Ln(it._type)}q(b.string)?js():(HDt(),qDt(),Ln(it._from),js()),iot(),vn()}function WDt(){return q(b.name)}function qst(){ry()}function qDt(){Ye&&Yst();let n=!0;if(!(WDt()&&(qst(),!bt(b.comma)))){if(q(b.star)){Pt(),Ln(it._as),qst();return}for(wt(b.braceL);!bt(b.braceR)&&!F.error;){if(n)n=!1;else if(bt(b.colon)&&he("ES2015 named imports do not destructure. Use another statement for destructuring after the import."),wt(b.comma),bt(b.braceR))break;ZDt()}}}function ZDt(){if(Oe){qrt();return}if(Ye){Xst();return}ry(),te(it._as)&&(F.tokens[F.tokens.length-1].identifierRole=ee.ImportAccess,Pt(),ry())}function iot(){(q(b._with)||te(it._assert)&&!Hi())&&(Pt(),o0(!1,!1))}function rot(){return F.pos===0&&Rt.charCodeAt(0)===lt.numberSign&&Rt.charCodeAt(1)===lt.exclamationMark&&G9(2),V9(),Zst()}var qP=class{constructor(e,t){this.tokens=e,this.scopes=t}};function sot(n,e,t,i){if(i&&t)throw new Error("Cannot combine flow and typescript plugins.");Bit(n,e,t,i);let r=rot();if(F.error)throw jit(F.error);return r}function G6(n){let e=n.currentIndex(),t=0,i=n.currentToken();do{let r=n.tokens[e];if(r.isOptionalChainStart&&t++,r.isOptionalChainEnd&&t--,t+=r.numNullishCoalesceStarts,t-=r.numNullishCoalesceEnds,r.contextualKeyword===it._await&&r.identifierRole==null&&r.scopeDepth===i.scopeDepth)return!0;e+=1}while(t>0&&e<n.tokens.length);return!1}var f0=class n{__init(){this.resultCode=""}__init2(){this.resultMappings=new Array(this.tokens.length)}__init3(){this.tokenIndex=0}constructor(e,t,i,r,s){this.code=e,this.tokens=t,this.isFlowEnabled=i,this.disableESTransforms=r,this.helperManager=s,n.prototype.__init.call(this),n.prototype.__init2.call(this),n.prototype.__init3.call(this)}snapshot(){return{resultCode:this.resultCode,tokenIndex:this.tokenIndex}}restoreToSnapshot(e){this.resultCode=e.resultCode,this.tokenIndex=e.tokenIndex}dangerouslyGetAndRemoveCodeSinceSnapshot(e){let t=this.resultCode.slice(e.resultCode.length);return this.resultCode=e.resultCode,t}reset(){this.resultCode="",this.resultMappings=new Array(this.tokens.length),this.tokenIndex=0}matchesContextualAtIndex(e,t){return this.matches1AtIndex(e,b.name)&&this.tokens[e].contextualKeyword===t}identifierNameAtIndex(e){return this.identifierNameForToken(this.tokens[e])}identifierNameAtRelativeIndex(e){return this.identifierNameForToken(this.tokenAtRelativeIndex(e))}identifierName(){return this.identifierNameForToken(this.currentToken())}identifierNameForToken(e){return this.code.slice(e.start,e.end)}rawCodeForToken(e){return this.code.slice(e.start,e.end)}stringValueAtIndex(e){return this.stringValueForToken(this.tokens[e])}stringValue(){return this.stringValueForToken(this.currentToken())}stringValueForToken(e){return this.code.slice(e.start+1,e.end-1)}matches1AtIndex(e,t){return this.tokens[e].type===t}matches2AtIndex(e,t,i){return this.tokens[e].type===t&&this.tokens[e+1].type===i}matches3AtIndex(e,t,i,r){return this.tokens[e].type===t&&this.tokens[e+1].type===i&&this.tokens[e+2].type===r}matches1(e){return this.tokens[this.tokenIndex].type===e}matches2(e,t){return this.tokens[this.tokenIndex].type===e&&this.tokens[this.tokenIndex+1].type===t}matches3(e,t,i){return this.tokens[this.tokenIndex].type===e&&this.tokens[this.tokenIndex+1].type===t&&this.tokens[this.tokenIndex+2].type===i}matches4(e,t,i,r){return this.tokens[this.tokenIndex].type===e&&this.tokens[this.tokenIndex+1].type===t&&this.tokens[this.tokenIndex+2].type===i&&this.tokens[this.tokenIndex+3].type===r}matches5(e,t,i,r,s){return this.tokens[this.tokenIndex].type===e&&this.tokens[this.tokenIndex+1].type===t&&this.tokens[this.tokenIndex+2].type===i&&this.tokens[this.tokenIndex+3].type===r&&this.tokens[this.tokenIndex+4].type===s}matchesContextual(e){return this.matchesContextualAtIndex(this.tokenIndex,e)}matchesContextIdAndLabel(e,t){return this.matches1(e)&&this.currentToken().contextId===t}previousWhitespaceAndComments(){let e=this.code.slice(this.tokenIndex>0?this.tokens[this.tokenIndex-1].end:0,this.tokenIndex<this.tokens.length?this.tokens[this.tokenIndex].start:this.code.length);return this.isFlowEnabled&&(e=e.replace(/@flow/g,"")),e}replaceToken(e){this.resultCode+=this.previousWhitespaceAndComments(),this.appendTokenPrefix(),this.resultMappings[this.tokenIndex]=this.resultCode.length,this.resultCode+=e,this.appendTokenSuffix(),this.tokenIndex++}replaceTokenTrimmingLeftWhitespace(e){this.resultCode+=this.previousWhitespaceAndComments().replace(/[^\r\n]/g,""),this.appendTokenPrefix(),this.resultMappings[this.tokenIndex]=this.resultCode.length,this.resultCode+=e,this.appendTokenSuffix(),this.tokenIndex++}removeInitialToken(){this.replaceToken("")}removeToken(){this.replaceTokenTrimmingLeftWhitespace("")}removeBalancedCode(){let e=0;for(;!this.isAtEnd();){if(this.matches1(b.braceL))e++;else if(this.matches1(b.braceR)){if(e===0)return;e--}this.removeToken()}}copyExpectedToken(e){if(this.tokens[this.tokenIndex].type!==e)throw new Error(`Expected token ${e}`);this.copyToken()}copyToken(){this.resultCode+=this.previousWhitespaceAndComments(),this.appendTokenPrefix(),this.resultMappings[this.tokenIndex]=this.resultCode.length,this.resultCode+=this.code.slice(this.tokens[this.tokenIndex].start,this.tokens[this.tokenIndex].end),this.appendTokenSuffix(),this.tokenIndex++}copyTokenWithPrefix(e){this.resultCode+=this.previousWhitespaceAndComments(),this.appendTokenPrefix(),this.resultCode+=e,this.resultMappings[this.tokenIndex]=this.resultCode.length,this.resultCode+=this.code.slice(this.tokens[this.tokenIndex].start,this.tokens[this.tokenIndex].end),this.appendTokenSuffix(),this.tokenIndex++}appendTokenPrefix(){let e=this.currentToken();if((e.numNullishCoalesceStarts||e.isOptionalChainStart)&&(e.isAsyncOperation=G6(this)),!this.disableESTransforms){if(e.numNullishCoalesceStarts)for(let t=0;t<e.numNullishCoalesceStarts;t++)e.isAsyncOperation?(this.resultCode+="await ",this.resultCode+=this.helperManager.getHelperName("asyncNullishCoalesce")):this.resultCode+=this.helperManager.getHelperName("nullishCoalesce"),this.resultCode+="(";e.isOptionalChainStart&&(e.isAsyncOperation&&(this.resultCode+="await "),this.tokenIndex>0&&this.tokenAtRelativeIndex(-1).type===b._delete?e.isAsyncOperation?this.resultCode+=this.helperManager.getHelperName("asyncOptionalChainDelete"):this.resultCode+=this.helperManager.getHelperName("optionalChainDelete"):e.isAsyncOperation?this.resultCode+=this.helperManager.getHelperName("asyncOptionalChain"):this.resultCode+=this.helperManager.getHelperName("optionalChain"),this.resultCode+="([")}}appendTokenSuffix(){let e=this.currentToken();if(e.isOptionalChainEnd&&!this.disableESTransforms&&(this.resultCode+="])"),e.numNullishCoalesceEnds&&!this.disableESTransforms)for(let t=0;t<e.numNullishCoalesceEnds;t++)this.resultCode+="))"}appendCode(e){this.resultCode+=e}currentToken(){return this.tokens[this.tokenIndex]}currentTokenCode(){let e=this.currentToken();return this.code.slice(e.start,e.end)}tokenAtRelativeIndex(e){return this.tokens[this.tokenIndex+e]}currentIndex(){return this.tokenIndex}nextToken(){if(this.tokenIndex===this.tokens.length)throw new Error("Unexpectedly reached end of input.");this.tokenIndex++}previousToken(){this.tokenIndex--}finish(){if(this.tokenIndex!==this.tokens.length)throw new Error("Tried to finish processing tokens before reaching the end.");return this.resultCode+=this.previousWhitespaceAndComments(),{code:this.resultCode,mappings:this.resultMappings}}isAtEnd(){return this.tokenIndex===this.tokens.length}};function W6(n,e,t,i){let r=e.snapshot(),s=KDt(e),o=[],a=[],c=[],l=null,u=[],p=[],f=e.currentToken().contextId;if(f==null)throw new Error("Expected non-null class context ID on class open-brace.");for(e.nextToken();!e.matchesContextIdAndLabel(b.braceR,f);)if(e.matchesContextual(it._constructor)&&!e.currentToken().isType)({constructorInitializerStatements:o,constructorInsertPos:l}=oot(e));else if(e.matches1(b.semi))i||p.push({start:e.currentIndex(),end:e.currentIndex()+1}),e.nextToken();else if(e.currentToken().isType)e.nextToken();else{let y=e.currentIndex(),g=!1,x=!1,v=!1;for(;ZP(e.currentToken());)e.matches1(b._static)&&(g=!0),e.matches1(b.hash)&&(x=!0),(e.matches1(b._declare)||e.matches1(b._abstract))&&(v=!0),e.nextToken();if(g&&e.matches1(b.braceL)){H6(e,f);continue}if(x){H6(e,f);continue}if(e.matchesContextual(it._constructor)&&!e.currentToken().isType){({constructorInitializerStatements:o,constructorInsertPos:l}=oot(e));continue}let P=e.currentIndex();if(JDt(e),e.matches1(b.lessThan)||e.matches1(b.parenL)){H6(e,f);continue}for(;e.currentToken().isType;)e.nextToken();if(e.matches1(b.eq)){let w=e.currentIndex(),k=e.currentToken().rhsEndIndex;if(k==null)throw new Error("Expected rhsEndIndex on class field assignment.");for(e.nextToken();e.currentIndex()<k;)n.processToken();let T;g?(T=t.claimFreeName("__initStatic"),c.push(T)):(T=t.claimFreeName("__init"),a.push(T)),u.push({initializerName:T,equalsIndex:w,start:P,end:e.currentIndex()})}else(!i||v)&&p.push({start:y,end:e.currentIndex()})}return e.restoreToSnapshot(r),i?{headerInfo:s,constructorInitializerStatements:o,instanceInitializerNames:[],staticInitializerNames:[],constructorInsertPos:l,fields:[],rangesToRemove:p}:{headerInfo:s,constructorInitializerStatements:o,instanceInitializerNames:a,staticInitializerNames:c,constructorInsertPos:l,fields:u,rangesToRemove:p}}function H6(n,e){for(n.nextToken();n.currentToken().contextId!==e;)n.nextToken();for(;ZP(n.tokenAtRelativeIndex(-1));)n.previousToken()}function KDt(n){let e=n.currentToken(),t=e.contextId;if(t==null)throw new Error("Expected context ID on class token.");let i=e.isExpression;if(i==null)throw new Error("Expected isExpression on class token.");let r=null,s=!1;for(n.nextToken(),n.matches1(b.name)&&(r=n.identifierName());!n.matchesContextIdAndLabel(b.braceL,t);)n.matches1(b._extends)&&!n.currentToken().isType&&(s=!0),n.nextToken();return{isExpression:i,className:r,hasSuperclass:s}}function oot(n){let e=[];n.nextToken();let t=n.currentToken().contextId;if(t==null)throw new Error("Expected context ID on open-paren starting constructor params.");for(;!n.matchesContextIdAndLabel(b.parenR,t);)if(n.currentToken().contextId===t){if(n.nextToken(),ZP(n.currentToken())){for(n.nextToken();ZP(n.currentToken());)n.nextToken();let s=n.currentToken();if(s.type!==b.name)throw new Error("Expected identifier after access modifiers in constructor arg.");let o=n.identifierNameForToken(s);e.push(`this.${o} = ${o}`)}}else n.nextToken();for(n.nextToken();n.currentToken().isType;)n.nextToken();let i=n.currentIndex(),r=!1;for(;!n.matchesContextIdAndLabel(b.braceR,t);){if(!r&&n.matches2(b._super,b.parenL)){n.nextToken();let s=n.currentToken().contextId;if(s==null)throw new Error("Expected a context ID on the super call");for(;!n.matchesContextIdAndLabel(b.parenR,s);)n.nextToken();i=n.currentIndex(),r=!0}n.nextToken()}return n.nextToken(),{constructorInitializerStatements:e,constructorInsertPos:i}}function ZP(n){return[b._async,b._get,b._set,b.plus,b.minus,b._readonly,b._static,b._public,b._private,b._protected,b._override,b._abstract,b.star,b._declare,b.hash].includes(n.type)}function JDt(n){if(n.matches1(b.bracketL)){let t=n.currentToken().contextId;if(t==null)throw new Error("Expected class context ID on computed name open bracket.");for(;!n.matchesContextIdAndLabel(b.bracketR,t);)n.nextToken();n.nextToken()}else n.nextToken()}function m0(n){if(n.removeInitialToken(),n.removeToken(),n.removeToken(),n.removeToken(),n.matches1(b.parenL))n.removeToken(),n.removeToken(),n.removeToken();else for(;n.matches1(b.dot);)n.removeToken(),n.removeToken()}var KP={typeDeclarations:new Set,valueDeclarations:new Set};function _0(n){let e=new Set,t=new Set;for(let i=0;i<n.tokens.length;i++){let r=n.tokens[i];r.type===b.name&&bP(r)&&(r.isType?e.add(n.identifierNameForToken(r)):t.add(n.identifierNameForToken(r)))}return{typeDeclarations:e,valueDeclarations:t}}function y0(n){let e=n.currentIndex();for(;!n.matches1AtIndex(e,b.braceR);)e++;return n.matchesContextualAtIndex(e+1,it._from)&&n.matches1AtIndex(e+2,b.string)}function Qa(n){(n.matches2(b._with,b.braceL)||n.matches2(b.name,b.braceL)&&n.matchesContextual(it._assert))&&(n.removeToken(),n.removeToken(),n.removeBalancedCode(),n.removeToken())}function g0(n,e,t,i){if(!n||e)return!1;let r=t.currentToken();if(r.rhsEndIndex==null)throw new Error("Expected non-null rhsEndIndex on export token.");let s=r.rhsEndIndex-t.currentIndex();if(s!==3&&!(s===4&&t.matches1AtIndex(r.rhsEndIndex-1,b.semi)))return!1;let o=t.tokenAtRelativeIndex(2);if(o.type!==b.name)return!1;let a=t.identifierNameForToken(o);return i.typeDeclarations.has(a)&&!i.valueDeclarations.has(a)}var x0=class n extends Bn{__init(){this.hadExport=!1}__init2(){this.hadNamedExport=!1}__init3(){this.hadDefaultExport=!1}constructor(e,t,i,r,s,o,a,c,l,u,p,f){super(),this.rootTransformer=e,this.tokens=t,this.importProcessor=i,this.nameManager=r,this.helperManager=s,this.reactHotLoaderTransformer=o,this.enableLegacyBabel5ModuleInterop=a,this.enableLegacyTypeScriptModuleInterop=c,this.isTypeScriptTransformEnabled=l,this.isFlowTransformEnabled=u,this.preserveDynamicImport=p,this.keepUnusedImports=f,n.prototype.__init.call(this),n.prototype.__init2.call(this),n.prototype.__init3.call(this),this.declarationInfo=l?_0(t):KP}getPrefixCode(){let e="";return this.hadExport&&(e+='Object.defineProperty(exports, "__esModule", {value: true});'),e}getSuffixCode(){return this.enableLegacyBabel5ModuleInterop&&this.hadDefaultExport&&!this.hadNamedExport?`
module.exports = exports.default;
`:""}process(){return this.tokens.matches3(b._import,b.name,b.eq)?this.processImportEquals():this.tokens.matches1(b._import)?(this.processImport(),!0):this.tokens.matches2(b._export,b.eq)?(this.tokens.replaceToken("module.exports"),!0):this.tokens.matches1(b._export)&&!this.tokens.currentToken().isType?(this.hadExport=!0,this.processExport()):this.tokens.matches2(b.name,b.postIncDec)&&this.processPostIncDec()?!0:this.tokens.matches1(b.name)||this.tokens.matches1(b.jsxName)?this.processIdentifier():this.tokens.matches1(b.eq)?this.processAssignment():this.tokens.matches1(b.assign)?this.processComplexAssignment():this.tokens.matches1(b.preIncDec)?this.processPreIncDec():!1}processImportEquals(){let e=this.tokens.identifierNameAtIndex(this.tokens.currentIndex()+1);return this.importProcessor.shouldAutomaticallyElideImportedName(e)?m0(this.tokens):this.tokens.replaceToken("const"),!0}processImport(){if(this.tokens.matches2(b._import,b.parenL)){if(this.preserveDynamicImport){this.tokens.copyToken();return}let t=this.enableLegacyTypeScriptModuleInterop?"":`${this.helperManager.getHelperName("interopRequireWildcard")}(`;this.tokens.replaceToken(`Promise.resolve().then(() => ${t}require`);let i=this.tokens.currentToken().contextId;if(i==null)throw new Error("Expected context ID on dynamic import invocation.");for(this.tokens.copyToken();!this.tokens.matchesContextIdAndLabel(b.parenR,i);)this.rootTransformer.processToken();this.tokens.replaceToken(t?")))":"))");return}if(this.removeImportAndDetectIfShouldElide())this.tokens.removeToken();else{let t=this.tokens.stringValue();this.tokens.replaceTokenTrimmingLeftWhitespace(this.importProcessor.claimImportCode(t)),this.tokens.appendCode(this.importProcessor.claimImportCode(t))}Qa(this.tokens),this.tokens.matches1(b.semi)&&this.tokens.removeToken()}removeImportAndDetectIfShouldElide(){if(this.tokens.removeInitialToken(),this.tokens.matchesContextual(it._type)&&!this.tokens.matches1AtIndex(this.tokens.currentIndex()+1,b.comma)&&!this.tokens.matchesContextualAtIndex(this.tokens.currentIndex()+1,it._from))return this.removeRemainingImport(),!0;if(this.tokens.matches1(b.name)||this.tokens.matches1(b.star))return this.removeRemainingImport(),!1;if(this.tokens.matches1(b.string))return!1;let e=!1,t=!1;for(;!this.tokens.matches1(b.string);)(!e&&this.tokens.matches1(b.braceL)||this.tokens.matches1(b.comma))&&(this.tokens.removeToken(),this.tokens.matches1(b.braceR)||(t=!0),(this.tokens.matches2(b.name,b.comma)||this.tokens.matches2(b.name,b.braceR)||this.tokens.matches4(b.name,b.name,b.name,b.comma)||this.tokens.matches4(b.name,b.name,b.name,b.braceR))&&(e=!0)),this.tokens.removeToken();return this.keepUnusedImports?!1:this.isTypeScriptTransformEnabled?!e:this.isFlowTransformEnabled?t&&!e:!1}removeRemainingImport(){for(;!this.tokens.matches1(b.string);)this.tokens.removeToken()}processIdentifier(){let e=this.tokens.currentToken();if(e.shadowsGlobal)return!1;if(e.identifierRole===ee.ObjectShorthand)return this.processObjectShorthand();if(e.identifierRole!==ee.Access)return!1;let t=this.importProcessor.getIdentifierReplacement(this.tokens.identifierNameForToken(e));if(!t)return!1;let i=this.tokens.currentIndex()+1;for(;i<this.tokens.tokens.length&&this.tokens.tokens[i].type===b.parenR;)i++;return this.tokens.tokens[i].type===b.parenL?this.tokens.tokenAtRelativeIndex(1).type===b.parenL&&this.tokens.tokenAtRelativeIndex(-1).type!==b._new?(this.tokens.replaceToken(`${t}.call(void 0, `),this.tokens.removeToken(),this.rootTransformer.processBalancedCode(),this.tokens.copyExpectedToken(b.parenR)):this.tokens.replaceToken(`(0, ${t})`):this.tokens.replaceToken(t),!0}processObjectShorthand(){let e=this.tokens.identifierName(),t=this.importProcessor.getIdentifierReplacement(e);return t?(this.tokens.replaceToken(`${e}: ${t}`),!0):!1}processExport(){if(this.tokens.matches2(b._export,b._enum)||this.tokens.matches3(b._export,b._const,b._enum))return this.hadNamedExport=!0,!1;if(this.tokens.matches2(b._export,b._default))return this.tokens.matches3(b._export,b._default,b._enum)?(this.hadDefaultExport=!0,!1):(this.processExportDefault(),!0);if(this.tokens.matches2(b._export,b.braceL))return this.processExportBindings(),!0;if(this.tokens.matches2(b._export,b.name)&&this.tokens.matchesContextualAtIndex(this.tokens.currentIndex()+1,it._type)){if(this.tokens.removeInitialToken(),this.tokens.removeToken(),this.tokens.matches1(b.braceL)){for(;!this.tokens.matches1(b.braceR);)this.tokens.removeToken();this.tokens.removeToken()}else this.tokens.removeToken(),this.tokens.matches1(b._as)&&(this.tokens.removeToken(),this.tokens.removeToken());return this.tokens.matchesContextual(it._from)&&this.tokens.matches1AtIndex(this.tokens.currentIndex()+1,b.string)&&(this.tokens.removeToken(),this.tokens.removeToken(),Qa(this.tokens)),!0}if(this.hadNamedExport=!0,this.tokens.matches2(b._export,b._var)||this.tokens.matches2(b._export,b._let)||this.tokens.matches2(b._export,b._const))return this.processExportVar(),!0;if(this.tokens.matches2(b._export,b._function)||this.tokens.matches3(b._export,b.name,b._function))return this.processExportFunction(),!0;if(this.tokens.matches2(b._export,b._class)||this.tokens.matches3(b._export,b._abstract,b._class)||this.tokens.matches2(b._export,b.at))return this.processExportClass(),!0;if(this.tokens.matches2(b._export,b.star))return this.processExportStar(),!0;throw new Error("Unrecognized export syntax.")}processAssignment(){let e=this.tokens.currentIndex(),t=this.tokens.tokens[e-1];if(t.isType||t.type!==b.name||t.shadowsGlobal||e>=2&&this.tokens.matches1AtIndex(e-2,b.dot)||e>=2&&[b._var,b._let,b._const].includes(this.tokens.tokens[e-2].type))return!1;let i=this.importProcessor.resolveExportBinding(this.tokens.identifierNameForToken(t));return i?(this.tokens.copyToken(),this.tokens.appendCode(` ${i} =`),!0):!1}processComplexAssignment(){let e=this.tokens.currentIndex(),t=this.tokens.tokens[e-1];if(t.type!==b.name||t.shadowsGlobal||e>=2&&this.tokens.matches1AtIndex(e-2,b.dot))return!1;let i=this.importProcessor.resolveExportBinding(this.tokens.identifierNameForToken(t));return i?(this.tokens.appendCode(` = ${i}`),this.tokens.copyToken(),!0):!1}processPreIncDec(){let e=this.tokens.currentIndex(),t=this.tokens.tokens[e+1];if(t.type!==b.name||t.shadowsGlobal||e+2<this.tokens.tokens.length&&(this.tokens.matches1AtIndex(e+2,b.dot)||this.tokens.matches1AtIndex(e+2,b.bracketL)||this.tokens.matches1AtIndex(e+2,b.parenL)))return!1;let i=this.tokens.identifierNameForToken(t),r=this.importProcessor.resolveExportBinding(i);return r?(this.tokens.appendCode(`${r} = `),this.tokens.copyToken(),!0):!1}processPostIncDec(){let e=this.tokens.currentIndex(),t=this.tokens.tokens[e],i=this.tokens.tokens[e+1];if(t.type!==b.name||t.shadowsGlobal||e>=1&&this.tokens.matches1AtIndex(e-1,b.dot))return!1;let r=this.tokens.identifierNameForToken(t),s=this.importProcessor.resolveExportBinding(r);if(!s)return!1;let o=this.tokens.rawCodeForToken(i),a=this.importProcessor.getIdentifierReplacement(r)||r;if(o==="++")this.tokens.replaceToken(`(${a} = ${s} = ${a} + 1, ${a} - 1)`);else if(o==="--")this.tokens.replaceToken(`(${a} = ${s} = ${a} - 1, ${a} + 1)`);else throw new Error(`Unexpected operator: ${o}`);return this.tokens.removeToken(),!0}processExportDefault(){let e=!0;if(this.tokens.matches4(b._export,b._default,b._function,b.name)||this.tokens.matches5(b._export,b._default,b.name,b._function,b.name)&&this.tokens.matchesContextualAtIndex(this.tokens.currentIndex()+2,it._async)){this.tokens.removeInitialToken(),this.tokens.removeToken();let t=this.processNamedFunction();this.tokens.appendCode(` exports.default = ${t};`)}else if(this.tokens.matches4(b._export,b._default,b._class,b.name)||this.tokens.matches5(b._export,b._default,b._abstract,b._class,b.name)||this.tokens.matches3(b._export,b._default,b.at)){this.tokens.removeInitialToken(),this.tokens.removeToken(),this.copyDecorators(),this.tokens.matches1(b._abstract)&&this.tokens.removeToken();let t=this.rootTransformer.processNamedClass();this.tokens.appendCode(` exports.default = ${t};`)}else if(g0(this.isTypeScriptTransformEnabled,this.keepUnusedImports,this.tokens,this.declarationInfo))e=!1,this.tokens.removeInitialToken(),this.tokens.removeToken(),this.tokens.removeToken();else if(this.reactHotLoaderTransformer){let t=this.nameManager.claimFreeName("_default");this.tokens.replaceToken(`let ${t}; exports.`),this.tokens.copyToken(),this.tokens.appendCode(` = ${t} =`),this.reactHotLoaderTransformer.setExtractedDefaultExportName(t)}else this.tokens.replaceToken("exports."),this.tokens.copyToken(),this.tokens.appendCode(" =");e&&(this.hadDefaultExport=!0)}copyDecorators(){for(;this.tokens.matches1(b.at);)if(this.tokens.copyToken(),this.tokens.matches1(b.parenL))this.tokens.copyExpectedToken(b.parenL),this.rootTransformer.processBalancedCode(),this.tokens.copyExpectedToken(b.parenR);else{for(this.tokens.copyExpectedToken(b.name);this.tokens.matches1(b.dot);)this.tokens.copyExpectedToken(b.dot),this.tokens.copyExpectedToken(b.name);this.tokens.matches1(b.parenL)&&(this.tokens.copyExpectedToken(b.parenL),this.rootTransformer.processBalancedCode(),this.tokens.copyExpectedToken(b.parenR))}}processExportVar(){this.isSimpleExportVar()?this.processSimpleExportVar():this.processComplexExportVar()}isSimpleExportVar(){let e=this.tokens.currentIndex();if(e++,e++,!this.tokens.matches1AtIndex(e,b.name))return!1;for(e++;e<this.tokens.tokens.length&&this.tokens.tokens[e].isType;)e++;return!!this.tokens.matches1AtIndex(e,b.eq)}processSimpleExportVar(){this.tokens.removeInitialToken(),this.tokens.copyToken();let e=this.tokens.identifierName();for(;!this.tokens.matches1(b.eq);)this.rootTransformer.processToken();let t=this.tokens.currentToken().rhsEndIndex;if(t==null)throw new Error("Expected = token with an end index.");for(;this.tokens.currentIndex()<t;)this.rootTransformer.processToken();this.tokens.appendCode(`; exports.${e} = ${e}`)}processComplexExportVar(){this.tokens.removeInitialToken(),this.tokens.removeToken();let e=this.tokens.matches1(b.braceL);e&&this.tokens.appendCode("(");let t=0;for(;;)if(this.tokens.matches1(b.braceL)||this.tokens.matches1(b.dollarBraceL)||this.tokens.matches1(b.bracketL))t++,this.tokens.copyToken();else if(this.tokens.matches1(b.braceR)||this.tokens.matches1(b.bracketR))t--,this.tokens.copyToken();else{if(t===0&&!this.tokens.matches1(b.name)&&!this.tokens.currentToken().isType)break;if(this.tokens.matches1(b.eq)){let i=this.tokens.currentToken().rhsEndIndex;if(i==null)throw new Error("Expected = token with an end index.");for(;this.tokens.currentIndex()<i;)this.rootTransformer.processToken()}else{let i=this.tokens.currentToken();if(xP(i)){let r=this.tokens.identifierName(),s=this.importProcessor.getIdentifierReplacement(r);if(s===null)throw new Error(`Expected a replacement for ${r} in \`export var\` syntax.`);Vit(i)&&(s=`${r}: ${s}`),this.tokens.replaceToken(s)}else this.rootTransformer.processToken()}}if(e){let i=this.tokens.currentToken().rhsEndIndex;if(i==null)throw new Error("Expected = token with an end index.");for(;this.tokens.currentIndex()<i;)this.rootTransformer.processToken();this.tokens.appendCode(")")}}processExportFunction(){this.tokens.replaceToken("");let e=this.processNamedFunction();this.tokens.appendCode(` exports.${e} = ${e};`)}processNamedFunction(){if(this.tokens.matches1(b._function))this.tokens.copyToken();else if(this.tokens.matches2(b.name,b._function)){if(!this.tokens.matchesContextual(it._async))throw new Error("Expected async keyword in function export.");this.tokens.copyToken(),this.tokens.copyToken()}if(this.tokens.matches1(b.star)&&this.tokens.copyToken(),!this.tokens.matches1(b.name))throw new Error("Expected identifier for exported function name.");let e=this.tokens.identifierName();if(this.tokens.copyToken(),this.tokens.currentToken().isType)for(this.tokens.removeInitialToken();this.tokens.currentToken().isType;)this.tokens.removeToken();return this.tokens.copyExpectedToken(b.parenL),this.rootTransformer.processBalancedCode(),this.tokens.copyExpectedToken(b.parenR),this.rootTransformer.processPossibleTypeRange(),this.tokens.copyExpectedToken(b.braceL),this.rootTransformer.processBalancedCode(),this.tokens.copyExpectedToken(b.braceR),e}processExportClass(){this.tokens.removeInitialToken(),this.copyDecorators(),this.tokens.matches1(b._abstract)&&this.tokens.removeToken();let e=this.rootTransformer.processNamedClass();this.tokens.appendCode(` exports.${e} = ${e};`)}processExportBindings(){this.tokens.removeInitialToken(),this.tokens.removeToken();let e=y0(this.tokens),t=[];for(;;){if(this.tokens.matches1(b.braceR)){this.tokens.removeToken();break}let i=qo(this.tokens);for(;this.tokens.currentIndex()<i.endIndex;)this.tokens.removeToken();if(!(i.isType||!e&&this.shouldElideExportedIdentifier(i.leftName))){let s=i.rightName;s==="default"?this.hadDefaultExport=!0:this.hadNamedExport=!0;let o=i.leftName,a=this.importProcessor.getIdentifierReplacement(o);t.push(`exports.${s} = ${a||o};`)}if(this.tokens.matches1(b.braceR)){this.tokens.removeToken();break}if(this.tokens.matches2(b.comma,b.braceR)){this.tokens.removeToken(),this.tokens.removeToken();break}else if(this.tokens.matches1(b.comma))this.tokens.removeToken();else throw new Error(`Unexpected token: ${JSON.stringify(this.tokens.currentToken())}`)}if(this.tokens.matchesContextual(it._from)){this.tokens.removeToken();let i=this.tokens.stringValue();this.tokens.replaceTokenTrimmingLeftWhitespace(this.importProcessor.claimImportCode(i)),Qa(this.tokens)}else this.tokens.appendCode(t.join(" "));this.tokens.matches1(b.semi)&&this.tokens.removeToken()}processExportStar(){for(this.tokens.removeInitialToken();!this.tokens.matches1(b.string);)this.tokens.removeToken();let e=this.tokens.stringValue();this.tokens.replaceTokenTrimmingLeftWhitespace(this.importProcessor.claimImportCode(e)),Qa(this.tokens),this.tokens.matches1(b.semi)&&this.tokens.removeToken()}shouldElideExportedIdentifier(e){return this.isTypeScriptTransformEnabled&&!this.keepUnusedImports&&!this.declarationInfo.valueDeclarations.has(e)}};var b0=class extends Bn{constructor(e,t,i,r,s,o,a,c){super(),this.tokens=e,this.nameManager=t,this.helperManager=i,this.reactHotLoaderTransformer=r,this.isTypeScriptTransformEnabled=s,this.isFlowTransformEnabled=o,this.keepUnusedImports=a,this.nonTypeIdentifiers=s&&!a?PP(e,c):new Set,this.declarationInfo=s&&!a?_0(e):KP,this.injectCreateRequireForImportRequire=!!c.injectCreateRequireForImportRequire}process(){if(this.tokens.matches3(b._import,b.name,b.eq))return this.processImportEquals();if(this.tokens.matches4(b._import,b.name,b.name,b.eq)&&this.tokens.matchesContextualAtIndex(this.tokens.currentIndex()+1,it._type)){this.tokens.removeInitialToken();for(let e=0;e<7;e++)this.tokens.removeToken();return!0}if(this.tokens.matches2(b._export,b.eq))return this.tokens.replaceToken("module.exports"),!0;if(this.tokens.matches5(b._export,b._import,b.name,b.name,b.eq)&&this.tokens.matchesContextualAtIndex(this.tokens.currentIndex()+2,it._type)){this.tokens.removeInitialToken();for(let e=0;e<8;e++)this.tokens.removeToken();return!0}if(this.tokens.matches1(b._import))return this.processImport();if(this.tokens.matches2(b._export,b._default))return this.processExportDefault();if(this.tokens.matches2(b._export,b.braceL))return this.processNamedExports();if(this.tokens.matches2(b._export,b.name)&&this.tokens.matchesContextualAtIndex(this.tokens.currentIndex()+1,it._type)){if(this.tokens.removeInitialToken(),this.tokens.removeToken(),this.tokens.matches1(b.braceL)){for(;!this.tokens.matches1(b.braceR);)this.tokens.removeToken();this.tokens.removeToken()}else this.tokens.removeToken(),this.tokens.matches1(b._as)&&(this.tokens.removeToken(),this.tokens.removeToken());return this.tokens.matchesContextual(it._from)&&this.tokens.matches1AtIndex(this.tokens.currentIndex()+1,b.string)&&(this.tokens.removeToken(),this.tokens.removeToken(),Qa(this.tokens)),!0}return!1}processImportEquals(){let e=this.tokens.identifierNameAtIndex(this.tokens.currentIndex()+1);return this.shouldAutomaticallyElideImportedName(e)?m0(this.tokens):this.injectCreateRequireForImportRequire?(this.tokens.replaceToken("const"),this.tokens.copyToken(),this.tokens.copyToken(),this.tokens.replaceToken(this.helperManager.getHelperName("require"))):this.tokens.replaceToken("const"),!0}processImport(){if(this.tokens.matches2(b._import,b.parenL))return!1;let e=this.tokens.snapshot();if(this.removeImportTypeBindings()){for(this.tokens.restoreToSnapshot(e);!this.tokens.matches1(b.string);)this.tokens.removeToken();this.tokens.removeToken(),Qa(this.tokens),this.tokens.matches1(b.semi)&&this.tokens.removeToken()}return!0}removeImportTypeBindings(){if(this.tokens.copyExpectedToken(b._import),this.tokens.matchesContextual(it._type)&&!this.tokens.matches1AtIndex(this.tokens.currentIndex()+1,b.comma)&&!this.tokens.matchesContextualAtIndex(this.tokens.currentIndex()+1,it._from))return!0;if(this.tokens.matches1(b.string))return this.tokens.copyToken(),!1;this.tokens.matchesContextual(it._module)&&this.tokens.matchesContextualAtIndex(this.tokens.currentIndex()+2,it._from)&&this.tokens.copyToken();let e=!1,t=!1,i=!1;if(this.tokens.matches1(b.name)&&(this.shouldAutomaticallyElideImportedName(this.tokens.identifierName())?(this.tokens.removeToken(),this.tokens.matches1(b.comma)&&this.tokens.removeToken()):(e=!0,this.tokens.copyToken(),this.tokens.matches1(b.comma)&&(i=!0,this.tokens.removeToken()))),this.tokens.matches1(b.star))this.shouldAutomaticallyElideImportedName(this.tokens.identifierNameAtRelativeIndex(2))?(this.tokens.removeToken(),this.tokens.removeToken(),this.tokens.removeToken()):(i&&this.tokens.appendCode(","),e=!0,this.tokens.copyExpectedToken(b.star),this.tokens.copyExpectedToken(b.name),this.tokens.copyExpectedToken(b.name));else if(this.tokens.matches1(b.braceL)){for(i&&this.tokens.appendCode(","),this.tokens.copyToken();!this.tokens.matches1(b.braceR);){t=!0;let r=qo(this.tokens);if(r.isType||this.shouldAutomaticallyElideImportedName(r.rightName)){for(;this.tokens.currentIndex()<r.endIndex;)this.tokens.removeToken();this.tokens.matches1(b.comma)&&this.tokens.removeToken()}else{for(e=!0;this.tokens.currentIndex()<r.endIndex;)this.tokens.copyToken();this.tokens.matches1(b.comma)&&this.tokens.copyToken()}}this.tokens.copyExpectedToken(b.braceR)}return this.keepUnusedImports?!1:this.isTypeScriptTransformEnabled?!e:this.isFlowTransformEnabled?t&&!e:!1}shouldAutomaticallyElideImportedName(e){return this.isTypeScriptTransformEnabled&&!this.keepUnusedImports&&!this.nonTypeIdentifiers.has(e)}processExportDefault(){if(g0(this.isTypeScriptTransformEnabled,this.keepUnusedImports,this.tokens,this.declarationInfo))return this.tokens.removeInitialToken(),this.tokens.removeToken(),this.tokens.removeToken(),!0;if(!(this.tokens.matches4(b._export,b._default,b._function,b.name)||this.tokens.matches5(b._export,b._default,b.name,b._function,b.name)&&this.tokens.matchesContextualAtIndex(this.tokens.currentIndex()+2,it._async)||this.tokens.matches4(b._export,b._default,b._class,b.name)||this.tokens.matches5(b._export,b._default,b._abstract,b._class,b.name))&&this.reactHotLoaderTransformer){let t=this.nameManager.claimFreeName("_default");return this.tokens.replaceToken(`let ${t}; export`),this.tokens.copyToken(),this.tokens.appendCode(` ${t} =`),this.reactHotLoaderTransformer.setExtractedDefaultExportName(t),!0}return!1}processNamedExports(){if(!this.isTypeScriptTransformEnabled)return!1;this.tokens.copyExpectedToken(b._export),this.tokens.copyExpectedToken(b.braceL);let e=y0(this.tokens),t=!1;for(;!this.tokens.matches1(b.braceR);){let i=qo(this.tokens);if(i.isType||!e&&this.shouldElideExportedName(i.leftName)){for(;this.tokens.currentIndex()<i.endIndex;)this.tokens.removeToken();this.tokens.matches1(b.comma)&&this.tokens.removeToken()}else{for(t=!0;this.tokens.currentIndex()<i.endIndex;)this.tokens.copyToken();this.tokens.matches1(b.comma)&&this.tokens.copyToken()}}return this.tokens.copyExpectedToken(b.braceR),!this.keepUnusedImports&&e&&!t&&(this.tokens.removeToken(),this.tokens.removeToken(),Qa(this.tokens)),!0}shouldElideExportedName(e){return this.isTypeScriptTransformEnabled&&!this.keepUnusedImports&&this.declarationInfo.typeDeclarations.has(e)&&!this.declarationInfo.valueDeclarations.has(e)}};var v0=class extends Bn{constructor(e,t,i){super(),this.rootTransformer=e,this.tokens=t,this.isImportsTransformEnabled=i}process(){return this.rootTransformer.processPossibleArrowParamEnd()||this.rootTransformer.processPossibleAsyncArrowWithTypeParams()||this.rootTransformer.processPossibleTypeRange()?!0:this.tokens.matches1(b._enum)?(this.processEnum(),!0):this.tokens.matches2(b._export,b._enum)?(this.processNamedExportEnum(),!0):this.tokens.matches3(b._export,b._default,b._enum)?(this.processDefaultExportEnum(),!0):!1}processNamedExportEnum(){if(this.isImportsTransformEnabled){this.tokens.removeInitialToken();let e=this.tokens.identifierNameAtRelativeIndex(1);this.processEnum(),this.tokens.appendCode(` exports.${e} = ${e};`)}else this.tokens.copyToken(),this.processEnum()}processDefaultExportEnum(){this.tokens.removeInitialToken(),this.tokens.removeToken();let e=this.tokens.identifierNameAtRelativeIndex(1);this.processEnum(),this.isImportsTransformEnabled?this.tokens.appendCode(` exports.default = ${e};`):this.tokens.appendCode(` export default ${e};`)}processEnum(){this.tokens.replaceToken("const"),this.tokens.copyExpectedToken(b.name);let e=!1;this.tokens.matchesContextual(it._of)&&(this.tokens.removeToken(),e=this.tokens.matchesContextual(it._symbol),this.tokens.removeToken());let t=this.tokens.matches3(b.braceL,b.name,b.eq);this.tokens.appendCode(' = require("flow-enums-runtime")');let i=!e&&!t;for(this.tokens.replaceTokenTrimmingLeftWhitespace(i?".Mirrored([":"({");!this.tokens.matches1(b.braceR);){if(this.tokens.matches1(b.ellipsis)){this.tokens.removeToken();break}this.processEnumElement(e,t),this.tokens.matches1(b.comma)&&this.tokens.copyToken()}this.tokens.replaceToken(i?"]);":"});")}processEnumElement(e,t){if(e){let i=this.tokens.identifierName();this.tokens.copyToken(),this.tokens.appendCode(`: Symbol("${i}")`)}else t?(this.tokens.copyToken(),this.tokens.replaceTokenTrimmingLeftWhitespace(":"),this.tokens.copyToken()):this.tokens.replaceToken(`"${this.tokens.identifierName()}"`)}};function QDt(n){let e,t=n[0],i=1;for(;i<n.length;){let r=n[i],s=n[i+1];if(i+=2,(r==="optionalAccess"||r==="optionalCall")&&t==null)return;r==="access"||r==="optionalAccess"?(e=t,t=s(t)):(r==="call"||r==="optionalCall")&&(t=s((...o)=>t.call(e,...o)),e=void 0)}return t}var JP="jest",tjt=["mock","unmock","enableAutomock","disableAutomock"],S0=class n extends Bn{__init(){this.hoistedFunctionNames=[]}constructor(e,t,i,r){super(),this.rootTransformer=e,this.tokens=t,this.nameManager=i,this.importProcessor=r,n.prototype.__init.call(this)}process(){return this.tokens.currentToken().scopeDepth===0&&this.tokens.matches4(b.name,b.dot,b.name,b.parenL)&&this.tokens.identifierName()===JP?QDt([this,"access",e=>e.importProcessor,"optionalAccess",e=>e.getGlobalNames,"call",e=>e(),"optionalAccess",e=>e.has,"call",e=>e(JP)])?!1:this.extractHoistedCalls():!1}getHoistedCode(){return this.hoistedFunctionNames.length>0?this.hoistedFunctionNames.map(e=>`${e}();`).join(""):""}extractHoistedCalls(){this.tokens.removeToken();let e=!1;for(;this.tokens.matches3(b.dot,b.name,b.parenL);){let t=this.tokens.identifierNameAtIndex(this.tokens.currentIndex()+1);if(tjt.includes(t)){let r=this.nameManager.claimFreeName("__jestHoist");this.hoistedFunctionNames.push(r),this.tokens.replaceToken(`function ${r}(){${JP}.`),this.tokens.copyToken(),this.tokens.copyToken(),this.rootTransformer.processBalancedCode(),this.tokens.copyExpectedToken(b.parenR),this.tokens.appendCode(";}"),e=!1}else e?this.tokens.copyToken():this.tokens.replaceToken(`${JP}.`),this.tokens.copyToken(),this.tokens.copyToken(),this.rootTransformer.processBalancedCode(),this.tokens.copyExpectedToken(b.parenR),e=!0}return!0}};var w0=class extends Bn{constructor(e){super(),this.tokens=e}process(){if(this.tokens.matches1(b.num)){let e=this.tokens.currentTokenCode();if(e.includes("_"))return this.tokens.replaceToken(e.replace(/_/g,"")),!0}return!1}};var P0=class extends Bn{constructor(e,t){super(),this.tokens=e,this.nameManager=t}process(){return this.tokens.matches2(b._catch,b.braceL)?(this.tokens.copyToken(),this.tokens.appendCode(` (${this.nameManager.claimFreeName("e")})`),!0):!1}};var k0=class extends Bn{constructor(e,t){super(),this.tokens=e,this.nameManager=t}process(){if(this.tokens.matches1(b.nullishCoalescing)){let i=this.tokens.currentToken();return this.tokens.tokens[i.nullishStartIndex].isAsyncOperation?this.tokens.replaceTokenTrimmingLeftWhitespace(", async () => ("):this.tokens.replaceTokenTrimmingLeftWhitespace(", () => ("),!0}if(this.tokens.matches1(b._delete)&&this.tokens.tokenAtRelativeIndex(1).isOptionalChainStart)return this.tokens.removeInitialToken(),!0;let t=this.tokens.currentToken().subscriptStartIndex;if(t!=null&&this.tokens.tokens[t].isOptionalChainStart&&this.tokens.tokenAtRelativeIndex(-1).type!==b._super){let i=this.nameManager.claimFreeName("_"),r;if(t>0&&this.tokens.matches1AtIndex(t-1,b._delete)&&this.isLastSubscriptInChain()?r=`${i} => delete ${i}`:r=`${i} => ${i}`,this.tokens.tokens[t].isAsyncOperation&&(r=`async ${r}`),this.tokens.matches2(b.questionDot,b.parenL)||this.tokens.matches2(b.questionDot,b.lessThan))this.justSkippedSuper()&&this.tokens.appendCode(".bind(this)"),this.tokens.replaceTokenTrimmingLeftWhitespace(`, 'optionalCall', ${r}`);else if(this.tokens.matches2(b.questionDot,b.bracketL))this.tokens.replaceTokenTrimmingLeftWhitespace(`, 'optionalAccess', ${r}`);else if(this.tokens.matches1(b.questionDot))this.tokens.replaceTokenTrimmingLeftWhitespace(`, 'optionalAccess', ${r}.`);else if(this.tokens.matches1(b.dot))this.tokens.replaceTokenTrimmingLeftWhitespace(`, 'access', ${r}.`);else if(this.tokens.matches1(b.bracketL))this.tokens.replaceTokenTrimmingLeftWhitespace(`, 'access', ${r}[`);else if(this.tokens.matches1(b.parenL))this.justSkippedSuper()&&this.tokens.appendCode(".bind(this)"),this.tokens.replaceTokenTrimmingLeftWhitespace(`, 'call', ${r}(`);else throw new Error("Unexpected subscript operator in optional chain.");return!0}return!1}isLastSubscriptInChain(){let e=0;for(let t=this.tokens.currentIndex()+1;;t++){if(t>=this.tokens.tokens.length)throw new Error("Reached the end of the code while finding the end of the access chain.");if(this.tokens.tokens[t].isOptionalChainStart?e++:this.tokens.tokens[t].isOptionalChainEnd&&e--,e<0)return!0;if(e===0&&this.tokens.tokens[t].subscriptStartIndex!=null)return!1}}justSkippedSuper(){let e=0,t=this.tokens.currentIndex()-1;for(;;){if(t<0)throw new Error("Reached the start of the code while finding the start of the access chain.");if(this.tokens.tokens[t].isOptionalChainStart?e--:this.tokens.tokens[t].isOptionalChainEnd&&e++,e<0)return!1;if(e===0&&this.tokens.tokens[t].subscriptStartIndex!=null)return this.tokens.tokens[t-1].type===b._super;t--}}};var T0=class extends Bn{constructor(e,t,i,r){super(),this.rootTransformer=e,this.tokens=t,this.importProcessor=i,this.options=r}process(){let e=this.tokens.currentIndex();if(this.tokens.identifierName()==="createReactClass"){let t=this.importProcessor&&this.importProcessor.getIdentifierReplacement("createReactClass");return t?this.tokens.replaceToken(`(0, ${t})`):this.tokens.copyToken(),this.tryProcessCreateClassCall(e),!0}if(this.tokens.matches3(b.name,b.dot,b.name)&&this.tokens.identifierName()==="React"&&this.tokens.identifierNameAtIndex(this.tokens.currentIndex()+2)==="createClass"){let t=this.importProcessor&&this.importProcessor.getIdentifierReplacement("React")||"React";return t?(this.tokens.replaceToken(t),this.tokens.copyToken(),this.tokens.copyToken()):(this.tokens.copyToken(),this.tokens.copyToken(),this.tokens.copyToken()),this.tryProcessCreateClassCall(e),!0}return!1}tryProcessCreateClassCall(e){let t=this.findDisplayName(e);t&&this.classNeedsDisplayName()&&(this.tokens.copyExpectedToken(b.parenL),this.tokens.copyExpectedToken(b.braceL),this.tokens.appendCode(`displayName: '${t}',`),this.rootTransformer.processBalancedCode(),this.tokens.copyExpectedToken(b.braceR),this.tokens.copyExpectedToken(b.parenR))}findDisplayName(e){return e<2?null:this.tokens.matches2AtIndex(e-2,b.name,b.eq)?this.tokens.identifierNameAtIndex(e-2):e>=2&&this.tokens.tokens[e-2].identifierRole===ee.ObjectKey?this.tokens.identifierNameAtIndex(e-2):this.tokens.matches2AtIndex(e-2,b._export,b._default)?this.getDisplayNameFromFilename():null}getDisplayNameFromFilename(){let t=(this.options.filePath||"unknown").split("/"),i=t[t.length-1],r=i.lastIndexOf("."),s=r===-1?i:i.slice(0,r);return s==="index"&&t[t.length-2]?t[t.length-2]:s}classNeedsDisplayName(){let e=this.tokens.currentIndex();if(!this.tokens.matches2(b.parenL,b.braceL))return!1;let t=e+1,i=this.tokens.tokens[t].contextId;if(i==null)throw new Error("Expected non-null context ID on object open-brace.");for(;e<this.tokens.tokens.length;e++){let r=this.tokens.tokens[e];if(r.type===b.braceR&&r.contextId===i){e++;break}if(this.tokens.identifierNameAtIndex(e)==="displayName"&&this.tokens.tokens[e].identifierRole===ee.ObjectKey&&r.contextId===i)return!1}if(e===this.tokens.tokens.length)throw new Error("Unexpected end of input when processing React class.");return this.tokens.matches1AtIndex(e,b.parenR)||this.tokens.matches2AtIndex(e,b.comma,b.parenR)}};var E0=class n extends Bn{__init(){this.extractedDefaultExportName=null}constructor(e,t){super(),this.tokens=e,this.filePath=t,n.prototype.__init.call(this)}setExtractedDefaultExportName(e){this.extractedDefaultExportName=e}getPrefixCode(){return`
      (function () {
        var enterModule = require('react-hot-loader').enterModule;
        enterModule && enterModule(module);
      })();`.replace(/\s+/g," ").trim()}getSuffixCode(){let e=new Set;for(let i of this.tokens.tokens)!i.isType&&bP(i)&&i.identifierRole!==ee.ImportDeclaration&&e.add(this.tokens.identifierNameForToken(i));let t=Array.from(e).map(i=>({variableName:i,uniqueLocalName:i}));return this.extractedDefaultExportName&&t.push({variableName:this.extractedDefaultExportName,uniqueLocalName:"default"}),`
;(function () {
  var reactHotLoader = require('react-hot-loader').default;
  var leaveModule = require('react-hot-loader').leaveModule;
  if (!reactHotLoader) {
    return;
  }
${t.map(({variableName:i,uniqueLocalName:r})=>`  reactHotLoader.register(${i}, "${r}", ${JSON.stringify(this.filePath||"")});`).join(`
`)}
  leaveModule(module);
})();`}process(){return!1}};var ejt=new Set(["break","case","catch","class","const","continue","debugger","default","delete","do","else","export","extends","finally","for","function","if","import","in","instanceof","new","return","super","switch","this","throw","try","typeof","var","void","while","with","yield","enum","implements","interface","let","package","private","protected","public","static","await","false","null","true"]);function QP(n){if(n.length===0||!Ha[n.charCodeAt(0)])return!1;for(let e=1;e<n.length;e++)if(!Cr[n.charCodeAt(e)])return!1;return!ejt.has(n)}var M0=class extends Bn{constructor(e,t,i){super(),this.rootTransformer=e,this.tokens=t,this.isImportsTransformEnabled=i}process(){return this.rootTransformer.processPossibleArrowParamEnd()||this.rootTransformer.processPossibleAsyncArrowWithTypeParams()||this.rootTransformer.processPossibleTypeRange()?!0:this.tokens.matches1(b._public)||this.tokens.matches1(b._protected)||this.tokens.matches1(b._private)||this.tokens.matches1(b._abstract)||this.tokens.matches1(b._readonly)||this.tokens.matches1(b._override)||this.tokens.matches1(b.nonNullAssertion)?(this.tokens.removeInitialToken(),!0):this.tokens.matches1(b._enum)||this.tokens.matches2(b._const,b._enum)?(this.processEnum(),!0):this.tokens.matches2(b._export,b._enum)||this.tokens.matches3(b._export,b._const,b._enum)?(this.processEnum(!0),!0):!1}processEnum(e=!1){for(this.tokens.removeInitialToken();this.tokens.matches1(b._const)||this.tokens.matches1(b._enum);)this.tokens.removeToken();let t=this.tokens.identifierName();this.tokens.removeToken(),e&&!this.isImportsTransformEnabled&&this.tokens.appendCode("export "),this.tokens.appendCode(`var ${t}; (function (${t})`),this.tokens.copyExpectedToken(b.braceL),this.processEnumBody(t),this.tokens.copyExpectedToken(b.braceR),e&&this.isImportsTransformEnabled?this.tokens.appendCode(`)(${t} || (exports.${t} = ${t} = {}));`):this.tokens.appendCode(`)(${t} || (${t} = {}));`)}processEnumBody(e){let t=null;for(;!this.tokens.matches1(b.braceR);){let{nameStringCode:i,variableName:r}=this.extractEnumKeyInfo(this.tokens.currentToken());this.tokens.removeInitialToken(),this.tokens.matches3(b.eq,b.string,b.comma)||this.tokens.matches3(b.eq,b.string,b.braceR)?this.processStringLiteralEnumMember(e,i,r):this.tokens.matches1(b.eq)?this.processExplicitValueEnumMember(e,i,r):this.processImplicitValueEnumMember(e,i,r,t),this.tokens.matches1(b.comma)&&this.tokens.removeToken(),r!=null?t=r:t=`${e}[${i}]`}}extractEnumKeyInfo(e){if(e.type===b.name){let t=this.tokens.identifierNameForToken(e);return{nameStringCode:`"${t}"`,variableName:QP(t)?t:null}}else if(e.type===b.string){let t=this.tokens.stringValueForToken(e);return{nameStringCode:this.tokens.code.slice(e.start,e.end),variableName:QP(t)?t:null}}else throw new Error("Expected name or string at beginning of enum element.")}processStringLiteralEnumMember(e,t,i){i!=null?(this.tokens.appendCode(`const ${i}`),this.tokens.copyToken(),this.tokens.copyToken(),this.tokens.appendCode(`; ${e}[${t}] = ${i};`)):(this.tokens.appendCode(`${e}[${t}]`),this.tokens.copyToken(),this.tokens.copyToken(),this.tokens.appendCode(";"))}processExplicitValueEnumMember(e,t,i){let r=this.tokens.currentToken().rhsEndIndex;if(r==null)throw new Error("Expected rhsEndIndex on enum assign.");if(i!=null){for(this.tokens.appendCode(`const ${i}`),this.tokens.copyToken();this.tokens.currentIndex()<r;)this.rootTransformer.processToken();this.tokens.appendCode(`; ${e}[${e}[${t}] = ${i}] = ${t};`)}else{for(this.tokens.appendCode(`${e}[${e}[${t}]`),this.tokens.copyToken();this.tokens.currentIndex()<r;)this.rootTransformer.processToken();this.tokens.appendCode(`] = ${t};`)}}processImplicitValueEnumMember(e,t,i,r){let s=r!=null?`${r} + 1`:"0";i!=null&&(this.tokens.appendCode(`const ${i} = ${s}; `),s=i),this.tokens.appendCode(`${e}[${e}[${t}] = ${s}] = ${t};`)}};var C0=class n{__init(){this.transformers=[]}__init2(){this.generatedVariables=[]}constructor(e,t,i,r){n.prototype.__init.call(this),n.prototype.__init2.call(this),this.nameManager=e.nameManager,this.helperManager=e.helperManager;let{tokenProcessor:s,importProcessor:o}=e;this.tokens=s,this.isImportsTransformEnabled=t.includes("imports"),this.isReactHotLoaderTransformEnabled=t.includes("react-hot-loader"),this.disableESTransforms=!!r.disableESTransforms,r.disableESTransforms||(this.transformers.push(new k0(s,this.nameManager)),this.transformers.push(new w0(s)),this.transformers.push(new P0(s,this.nameManager))),t.includes("jsx")&&(r.jsxRuntime!=="preserve"&&this.transformers.push(new K1(this,s,o,this.nameManager,r)),this.transformers.push(new T0(this,s,o,r)));let a=null;if(t.includes("react-hot-loader")){if(!r.filePath)throw new Error("filePath is required when using the react-hot-loader transform.");a=new E0(s,r.filePath),this.transformers.push(a)}if(t.includes("imports")){if(o===null)throw new Error("Expected non-null importProcessor with imports transform enabled.");this.transformers.push(new x0(this,s,o,this.nameManager,this.helperManager,a,i,!!r.enableLegacyTypeScriptModuleInterop,t.includes("typescript"),t.includes("flow"),!!r.preserveDynamicImport,!!r.keepUnusedImports))}else this.transformers.push(new b0(s,this.nameManager,this.helperManager,a,t.includes("typescript"),t.includes("flow"),!!r.keepUnusedImports,r));t.includes("flow")&&this.transformers.push(new v0(this,s,t.includes("imports"))),t.includes("typescript")&&this.transformers.push(new M0(this,s,t.includes("imports"))),t.includes("jest")&&this.transformers.push(new S0(this,s,this.nameManager,o))}transform(){this.tokens.reset(),this.processBalancedCode();let t=this.isImportsTransformEnabled?'"use strict";':"";for(let o of this.transformers)t+=o.getPrefixCode();t+=this.helperManager.emitHelpers(),t+=this.generatedVariables.map(o=>` var ${o};`).join("");for(let o of this.transformers)t+=o.getHoistedCode();let i="";for(let o of this.transformers)i+=o.getSuffixCode();let r=this.tokens.finish(),{code:s}=r;if(s.startsWith("#!")){let o=s.indexOf(`
`);return o===-1&&(o=s.length,s+=`
`),{code:s.slice(0,o+1)+t+s.slice(o+1)+i,mappings:this.shiftMappings(r.mappings,t.length)}}else return{code:t+s+i,mappings:this.shiftMappings(r.mappings,t.length)}}processBalancedCode(){let e=0,t=0;for(;!this.tokens.isAtEnd();){if(this.tokens.matches1(b.braceL)||this.tokens.matches1(b.dollarBraceL))e++;else if(this.tokens.matches1(b.braceR)){if(e===0)return;e--}if(this.tokens.matches1(b.parenL))t++;else if(this.tokens.matches1(b.parenR)){if(t===0)return;t--}this.processToken()}}processToken(){if(this.tokens.matches1(b._class)){this.processClass();return}for(let e of this.transformers)if(e.process())return;this.tokens.copyToken()}processNamedClass(){if(!this.tokens.matches2(b._class,b.name))throw new Error("Expected identifier for exported class name.");let e=this.tokens.identifierNameAtIndex(this.tokens.currentIndex()+1);return this.processClass(),e}processClass(){let e=W6(this,this.tokens,this.nameManager,this.disableESTransforms),t=(e.headerInfo.isExpression||!e.headerInfo.className)&&e.staticInitializerNames.length+e.instanceInitializerNames.length>0,i=e.headerInfo.className;t&&(i=this.nameManager.claimFreeName("_class"),this.generatedVariables.push(i),this.tokens.appendCode(` (${i} =`));let s=this.tokens.currentToken().contextId;if(s==null)throw new Error("Expected class to have a context ID.");for(this.tokens.copyExpectedToken(b._class);!this.tokens.matchesContextIdAndLabel(b.braceL,s);)this.processToken();this.processClassBody(e,i);let o=e.staticInitializerNames.map(a=>`${i}.${a}()`);t?this.tokens.appendCode(`, ${o.map(a=>`${a}, `).join("")}${i})`):e.staticInitializerNames.length>0&&this.tokens.appendCode(` ${o.map(a=>`${a};`).join(" ")}`)}processClassBody(e,t){let{headerInfo:i,constructorInsertPos:r,constructorInitializerStatements:s,fields:o,instanceInitializerNames:a,rangesToRemove:c}=e,l=0,u=0,p=this.tokens.currentToken().contextId;if(p==null)throw new Error("Expected non-null context ID on class.");this.tokens.copyExpectedToken(b.braceL),this.isReactHotLoaderTransformEnabled&&this.tokens.appendCode("__reactstandin__regenerateByEval(key, code) {this[key] = eval(code);}");let f=s.length+a.length>0;if(r===null&&f){let y=this.makeConstructorInitCode(s,a,t);if(i.hasSuperclass){let g=this.nameManager.claimFreeName("args");this.tokens.appendCode(`constructor(...${g}) { super(...${g}); ${y}; }`)}else this.tokens.appendCode(`constructor() { ${y}; }`)}for(;!this.tokens.matchesContextIdAndLabel(b.braceR,p);)if(l<o.length&&this.tokens.currentIndex()===o[l].start){let y=!1;for(this.tokens.matches1(b.bracketL)?this.tokens.copyTokenWithPrefix(`${o[l].initializerName}() {this`):this.tokens.matches1(b.string)||this.tokens.matches1(b.num)?(this.tokens.copyTokenWithPrefix(`${o[l].initializerName}() {this[`),y=!0):this.tokens.copyTokenWithPrefix(`${o[l].initializerName}() {this.`);this.tokens.currentIndex()<o[l].end;)y&&this.tokens.currentIndex()===o[l].equalsIndex&&this.tokens.appendCode("]"),this.processToken();this.tokens.appendCode("}"),l++}else if(u<c.length&&this.tokens.currentIndex()>=c[u].start){for(this.tokens.currentIndex()<c[u].end&&this.tokens.removeInitialToken();this.tokens.currentIndex()<c[u].end;)this.tokens.removeToken();u++}else this.tokens.currentIndex()===r?(this.tokens.copyToken(),f&&this.tokens.appendCode(`;${this.makeConstructorInitCode(s,a,t)};`),this.processToken()):this.processToken();this.tokens.copyExpectedToken(b.braceR)}makeConstructorInitCode(e,t,i){return[...e,...t.map(r=>`${i}.prototype.${r}.call(this)`)].join(";")}processPossibleArrowParamEnd(){if(this.tokens.matches2(b.parenR,b.colon)&&this.tokens.tokenAtRelativeIndex(1).isType){let e=this.tokens.currentIndex()+1;for(;this.tokens.tokens[e].isType;)e++;if(this.tokens.matches1AtIndex(e,b.arrow)){for(this.tokens.removeInitialToken();this.tokens.currentIndex()<e;)this.tokens.removeToken();return this.tokens.replaceTokenTrimmingLeftWhitespace(") =>"),!0}}return!1}processPossibleAsyncArrowWithTypeParams(){if(!this.tokens.matchesContextual(it._async)&&!this.tokens.matches1(b._async))return!1;let e=this.tokens.tokenAtRelativeIndex(1);if(e.type!==b.lessThan||!e.isType)return!1;let t=this.tokens.currentIndex()+1;for(;this.tokens.tokens[t].isType;)t++;if(this.tokens.matches1AtIndex(t,b.parenL)){for(this.tokens.replaceToken("async ("),this.tokens.removeInitialToken();this.tokens.currentIndex()<t;)this.tokens.removeToken();return this.tokens.removeToken(),this.processBalancedCode(),this.processToken(),!0}return!1}processPossibleTypeRange(){if(this.tokens.currentToken().isType){for(this.tokens.removeInitialToken();this.tokens.currentToken().isType;)this.tokens.removeToken();return!0}return!1}shiftMappings(e,t){for(let i=0;i<e.length;i++){let r=e[i];r!==void 0&&(e[i]=r+t)}return e}};var njt=Gt(lot());function q6(n){let e=new Set;for(let t=0;t<n.tokens.length;t++)n.matches1AtIndex(t,b._import)&&!n.matches3AtIndex(t,b._import,b.name,b.eq)&&ijt(n,t,e);return e}function ijt(n,e,t){e++,!n.matches1AtIndex(e,b.parenL)&&(n.matches1AtIndex(e,b.name)&&(t.add(n.identifierNameAtIndex(e)),e++,n.matches1AtIndex(e,b.comma)&&e++),n.matches1AtIndex(e,b.star)&&(e+=2,t.add(n.identifierNameAtIndex(e)),e++),n.matches1AtIndex(e,b.braceL)&&(e++,rjt(n,e,t)))}function rjt(n,e,t){for(;;){if(n.matches1AtIndex(e,b.braceR))return;let i=qo(n,e);if(e=i.endIndex,i.isType||t.add(i.rightName),n.matches2AtIndex(e,b.comma,b.braceR))return;if(n.matches1AtIndex(e,b.braceR))return;if(n.matches1AtIndex(e,b.comma))e++;else throw new Error(`Unexpected token: ${JSON.stringify(n.tokens[e])}`)}}function uot(n,e){Mrt(e);try{let t=sjt(n,e),r=new C0(t,e.transforms,!!e.enableLegacyBabel5ModuleInterop,e).transform(),s={code:r.code};if(e.sourceMapOptions){if(!e.filePath)throw new Error("filePath must be specified when generating a source map.");s={...s,sourceMap:t6(r,e.filePath,e.sourceMapOptions,n,t.tokenProcessor.tokens)}}return s}catch(t){throw e.filePath&&(t.message=`Error transforming ${e.filePath}: ${t.message}`),t}}function sjt(n,e){let t=e.transforms.includes("jsx"),i=e.transforms.includes("typescript"),r=e.transforms.includes("flow"),s=e.disableESTransforms===!0,o=sot(n,t,i,r),a=o.tokens,c=o.scopes,l=new t0(n,a),u=new TP(l),p=new f0(n,a,r,s,u),f=!!e.enableLegacyTypeScriptModuleInterop,y=null;return e.transforms.includes("imports")?(y=new J1(l,p,f,e,e.transforms.includes("typescript"),!!e.keepUnusedImports,u),y.preprocessTokens(),EP(p,c,y.getGlobalNames()),e.transforms.includes("typescript")&&!e.keepUnusedImports&&y.pruneTypeOnlyImports()):e.transforms.includes("typescript")&&!e.keepUnusedImports&&EP(p,c,q6(p)),{tokenProcessor:p,scopes:c,nameManager:l,importProcessor:y,helperManager:u}}var ojt=new Set([".ts",".tsx",".mts",".cts"]),ajt=new Set([".tsx",".jsx",".ts"]),cjt=/^\s*export\s+type\s+\*\s+(?:as\s+[\w$]+\s+)?from\s+['"][^'"]+['"]\s*;?\s*$/gim,ljt=n=>n.replace(cjt,""),ujt=n=>{let e=n.indexOf("?"),t=n.indexOf("#"),i=n.length;return e!==-1&&t!==-1?i=Math.min(e,t):e!==-1?i=e:t!==-1&&(i=t),n.slice(0,i)},pjt=n=>{let e=ujt(n),t=e.lastIndexOf(".");return t===-1||Math.max(e.lastIndexOf("/"),e.lastIndexOf("\\"))>t?"":e.slice(t).toLowerCase()},hjt=n=>{let e=pjt(n),t=["imports"];return ojt.has(e)&&t.unshift("typescript"),ajt.has(e)&&t.push("jsx"),t},N0=(n,e)=>{let t=hjt(e),i=ljt(n),{code:r}=uot(i,{filePath:e,production:!0,transforms:t});return r};Ae();function djt(n){let e=[],t=0,i=a=>/\s/.test(a),r=a=>/[^\s()"]/u.test(a),s=()=>t<n.length?n[t]:void 0,o=()=>{if(t>=n.length)throw new SyntaxError("Unexpected end of input");return n[t++]};for(;t<n.length;){let a=s();if(a===void 0)break;let c=a;if(i(c)){t++;continue}if(c===";"){for(;t<n.length&&n[t]!==`
`;)t++;continue}if(c==="("){e.push({type:"lparen"}),t++;continue}if(c===")"){e.push({type:"rparen"}),t++;continue}if(c==='"'){t++;let l="";for(;t<n.length;){let u=o();if(u==='"')break;if(u==="\\"){if(t>=n.length)throw new SyntaxError("Unterminated escape in string");let p=o();switch(p){case"n":l+=`
`;break;case"r":l+="\r";break;case"t":l+="	";break;case'"':l+='"';break;case"\\":l+="\\";break;default:l+=p;break}}else l+=u}if(n[t-1]!=='"')throw new SyntaxError("Unterminated string literal");e.push({type:"string",value:l});continue}if(r(c)||c==="-"||c==="+"||c==="."){let l=t;for(;t<n.length;){let p=n[t];if(i(p)||p==="("||p===")"||p==='"')break;t++}let u=n.slice(l,t);if(u==="#t"){e.push({type:"boolean",value:!0});continue}if(u==="#f"){e.push({type:"boolean",value:!1});continue}if(u==="nil"){e.push({type:"nil"});continue}/^[+-]?(?:\d+(?:\.\d*)?|\.\d+)(?:[eE][+-]?\d+)?$/u.test(u)?e.push({type:"number",value:Number(u)}):e.push({type:"symbol",value:u});continue}throw new SyntaxError(`Unexpected character: ${JSON.stringify(a)} at ${t}`)}return e}function fjt(n){let e=djt(n),t=0,i=()=>t<e.length?e[t]:void 0,r=()=>{if(t>=e.length)throw new SyntaxError("Unexpected end of input");return e[t++]};function s(){let a=r();switch(a.type){case"lparen":{let c=[];for(;;){let l=i();if(!l)throw new SyntaxError("Unmatched '('");if(l.type==="rparen")break;c.push(s())}return r(),c}case"rparen":throw new SyntaxError("Unmatched ')'");case"number":return a.value;case"string":return a.value;case"boolean":return a.value;case"nil":return null;case"symbol":return a.value}}let o=[];for(;i();)o.push(s());return o}function Wi(n){if(n===null)return"nil";if(typeof n=="boolean")return n?"#t":"#f";if(typeof n=="number")return Number.isFinite(n)?String(n):"nan";if(typeof n=="string")return/^[^\s()"]+$/u.test(n)&&n!=="nil"&&n!=="#t"&&n!=="#f"?n:`"${n.replace(/["\\\n\r\t]/g,e=>e==='"'?'\\"':e==="\\"?"\\\\":e===`
`?"\\n":e==="\r"?"\\r":"\\t")}"`;if(Array.isArray(n))return`(${n.map(Wi).join(" ")})`;throw new Error(`Unsupported S-expression value: ${JSON.stringify(n)}`)}var Z6="__default__",qr,z=(qr=class{constructor(){d(this,"isSxClass",!0)}getChildren(){return Object.keys(this).filter(e=>e.startsWith("_sx")).map(e=>this[e]).filter(e=>e&&typeof e=="object"&&e.isSxClass)}getStringIndented(){return this.getString().split(`
`).map(e=>`  ${e}`).join(`
`)}getString(){let e=this.getChildren();if(e.length===0)return`(${this.token})`;let t=[`(${this.token}`];for(let i of e)t.push(i.getStringIndented());return t.push(")"),t.join(`
`)}get[Symbol.toStringTag](){return this.getString()}[Symbol.for("nodejs.util.inspect.custom")](){return this.getString()}static register(e){if(!e.token)throw new Error("Class must have a static override token");let t=e.parentToken??Z6,i=qr.classes[e.token]??{};i[t]=e,qr.classes[e.token]=i}static parse(e){let t=fjt(e);return qr.parsePrimitiveSexpr(t)}static fromSexprPrimitives(e){throw new Error(`"${this.name}" class has not implemented fromSexprPrimitives`)}static parsePrimitiveSexpr(e,t={}){let i=t.parentToken;if(Array.isArray(e)&&e.length>=1&&typeof e[0]=="string"){let r=e[0],s=qr.classes[r];if(!s)throw new Error(`Class "${r}" not registered via SxClass.register`);let a=s[i??Z6]??s[Z6];if(!a)throw new Error(`Class "${r}" not registered for parent "${i??"<root>"}"`);let c=e.slice(1);if(!("fromSexprPrimitives"in a))throw new Error(`Class "${r}" does not have a fromSexprPrimitives method`);return a.fromSexprPrimitives(c)}if(Array.isArray(e))return e.map(r=>qr.parsePrimitiveSexpr(r,t));if(typeof e=="number"||typeof e=="string"||typeof e=="boolean"||e===null)return e;throw new Error(`Couldn't parse primitive S-expression: ${JSON.stringify(e)}`)}static parsePrimitivesToClassProperties(e,t){var s;let i={},r={};for(let o of e){let a=qr.parsePrimitiveSexpr(o,{parentToken:t});a.isSxClass&&(i[a.token]=a,r[s=a.token]??(r[s]=[]),r[a.token].push(a))}return{propertyMap:i,arrayPropertyMap:r}}},d(qr,"token"),d(qr,"parentToken"),d(qr,"classes",{}),qr),rn=class extends z{constructor(e){super();d(this,"value");this.value=e}set(e){this.value=e}static fromSexprPrimitives(e){return new this(e[0])}getString(){return`(${this.token} ${this.value})`}},iR,Je=(iR=class extends rn{constructor(){super(...arguments);d(this,"token","width")}},d(iR,"token","width"),iR);z.register(Je);var wl,Got=(wl=class extends z{constructor(t){super();d(this,"token","type");d(this,"type");this.type=t}static fromSexprPrimitives(t){return new wl(t[0])}getString(){return`(type ${this.type})`}},d(wl,"token","type"),d(wl,"parentToken","stroke"),wl);z.register(Got);var jd,y7=(jd=class extends z{constructor(t){super();d(this,"token","color");d(this,"color");this.color={r:t[0],g:t[1],b:t[2],a:t[3]}}static fromSexprPrimitives(t){return new jd(t)}getString(){return`(color ${this.color.r} ${this.color.g} ${this.color.b} ${this.color.a})`}},d(jd,"token","color"),jd);z.register(y7);var Bd,mjt=(Bd=class extends z{constructor(){super(...arguments);d(this,"token","stroke");d(this,"_sxWidth");d(this,"_sxType");d(this,"_sxColor")}static fromSexprPrimitives(t){let i=new Bd,{propertyMap:r}=z.parsePrimitivesToClassProperties(t,this.token);return i._sxWidth=r.width,i._sxType=r.type,i._sxColor=r.color,i}get width(){return this._sxWidth?.value}get type(){return this._sxType?.type}get color(){return this._sxColor?.color}set width(t){this._sxWidth=new Je(t)}set type(t){this._sxType=new Got(t)}set color(t){this._sxColor=new y7([t.r,t.g,t.b,t.a])}},d(Bd,"token","stroke"),Bd);z.register(mjt);var _jt=["inches","mils","millimeters","automatic"],Yd,yjt=(Yd=class extends z{constructor(t){super();d(this,"token","unit");d(this,"value");typeof t=="number"?this.value=_jt[t]:this.value=t}static fromSexprPrimitives(t){let[i]=t;return new Yd(i)}},d(Yd,"token","unit"),Yd);z.register(yjt);var ti=class extends z{constructor(e){super();d(this,"value");this.value=e}set(e){this.value=e}static fromSexprPrimitives(e){let[t]=e,i;return typeof t=="boolean"?i=t:typeof t=="string"?i=t==="true"||t==="yes":i=!1,new this(i)}getString(){return`(${this.token} ${this.value?"yes":"no"})`}},rR,g7=(rR=class extends ti{constructor(){super(...arguments);d(this,"token","in_bom")}},d(rR,"token","in_bom"),rR);z.register(g7);var sR,x7=(sR=class extends ti{constructor(){super(...arguments);d(this,"token","on_board")}},d(sR,"token","on_board"),sR);z.register(x7);var Dt=n=>{if(n!==void 0){if(typeof n=="number")return n;if(typeof n=="string"){let e=Number(n);return Number.isNaN(e)?void 0:e}}},Xd,Zr=(Xd=class extends z{constructor(t,i){super();d(this,"token","xy");d(this,"x");d(this,"y");this.x=t,this.y=i}static fromSexprPrimitives(t){let[i,r]=t,s=Dt(i)??0,o=Dt(r)??0;return new Xd(s,o)}getChildren(){return[]}getString(){return`(xy ${this.x} ${this.y})`}},d(Xd,"token","xy"),Xd);z.register(Zr);var Ud,Sr=(Ud=class extends z{constructor(t=[]){super();d(this,"token","pts");d(this,"points");this.points=t}static fromSexprPrimitives(t){let i=[];for(let r of t){if(!Array.isArray(r)||r.length===0)throw new Error(`Unexpected primitive inside pts: ${Wi(r)}`);let s=z.parsePrimitiveSexpr(r,{parentToken:this.token});if(s instanceof Zr){i.push(s);continue}if(s instanceof Hot){i.push(s);continue}throw s instanceof z?new Error(`Unsupported child "${s.token}" inside pts expression`):new Error(`Unable to parse child inside pts: ${Wi(r)}`)}return new Ud(i)}getChildren(){return[...this.points]}getString(){let t=["(pts"];for(let i of this.points){let s=i.getString().split(`
`);for(let o of s)t.push(`  ${o}`)}return t.push(")"),t.join(`
`)}},d(Ud,"token","pts"),Ud);z.register(Sr);var Pl,Hot=(Pl=class extends z{constructor(t={}){super();d(this,"token","arc");d(this,"_sxStart");d(this,"_sxMid");d(this,"_sxEnd");t.start!==void 0&&(this.start=t.start),t.mid!==void 0&&(this.mid=t.mid),t.end!==void 0&&(this.end=t.end)}static fromSexprPrimitives(t){let i=new Pl,{propertyMap:r}=z.parsePrimitivesToClassProperties(t,this.token);return i._sxStart=r.start,i._sxMid=r.mid,i._sxEnd=r.end,i}get start(){return this._sxStart}set start(t){if(t===void 0){this._sxStart=void 0;return}if(t instanceof rO){this._sxStart=t;return}this._sxStart=new rO(t.x,t.y)}get mid(){return this._sxMid}set mid(t){if(t===void 0){this._sxMid=void 0;return}if(t instanceof sO){this._sxMid=t;return}this._sxMid=new sO(t.x,t.y)}get end(){return this._sxEnd}set end(t){if(t===void 0){this._sxEnd=void 0;return}if(t instanceof oO){this._sxEnd=t;return}this._sxEnd=new oO(t.x,t.y)}getChildren(){let t=[];return this._sxStart&&t.push(this._sxStart),this._sxMid&&t.push(this._sxMid),this._sxEnd&&t.push(this._sxEnd),t}getString(){let t=["(arc"];return this._sxStart&&t.push(this._sxStart.getStringIndented()),this._sxMid&&t.push(this._sxMid.getStringIndented()),this._sxEnd&&t.push(this._sxEnd.getStringIndented()),t.push(")"),t.join(`
`)}},d(Pl,"token","arc"),d(Pl,"parentToken","pts"),Pl);z.register(Hot);var kl,rO=(kl=class extends z{constructor(t,i){super();d(this,"token","start");this.x=t,this.y=i}static fromSexprPrimitives(t){let i=Dt(t[0])??0,r=Dt(t[1])??0;return new kl(i,r)}getString(){return`(start ${this.x} ${this.y})`}},d(kl,"token","start"),d(kl,"parentToken","arc"),kl);z.register(rO);var Tl,sO=(Tl=class extends z{constructor(t,i){super();d(this,"token","mid");this.x=t,this.y=i}static fromSexprPrimitives(t){let i=Dt(t[0])??0,r=Dt(t[1])??0;return new Tl(i,r)}getString(){return`(mid ${this.x} ${this.y})`}},d(Tl,"token","mid"),d(Tl,"parentToken","arc"),Tl);z.register(sO);var El,oO=(El=class extends z{constructor(t,i){super();d(this,"token","end");this.x=t,this.y=i}static fromSexprPrimitives(t){let i=Dt(t[0])??0,r=Dt(t[1])??0;return new El(i,r)}getString(){return`(end ${this.x} ${this.y})`}},d(El,"token","end"),d(El,"parentToken","arc"),El);z.register(oO);var na,Un=(na=class extends z{constructor(t,i={}){super();d(this,"token","at");d(this,"x");d(this,"y");d(this,"angle");this.x=t[0],this.y=t[1],this.angle=t[2],this.angle&&i.isTextSymbol&&(this.angle*=10)}static from(t,i={}){return t instanceof na?t:Array.isArray(t)?new na(t,i):new na([t.x,t.y,t.angle],i)}static fromSexprPrimitives(t){let[i,r,s]=t;return new na([i,r,s])}getString(){let t=[this.x,this.y];return this.angle!==void 0&&t.push(this.angle),`(at ${t.join(" ")})`}},d(na,"token","at"),na);z.register(Un);var gjt=n=>n.length===0?!0:/[\s()"\\]/.test(n),re=n=>`"${n.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t")}"`,xjt=n=>gjt(n)?re(n):n,bo=class extends z{constructor(e){super();d(this,"value");this.value=e}set(e){this.value=e}static fromSexprPrimitives(e){return new this(e[0])}getString(){return`(${this.token} ${xjt(this.value)})`}},jt=n=>{if(n!==void 0){if(typeof n=="string")return n;if(typeof n=="number"||typeof n=="boolean")return String(n)}},Vd,Wot=(Vd=class extends z{constructor(t={}){super();d(this,"token","effects");d(this,"_sxFont");d(this,"_sxJustify");d(this,"_hiddenText",!1);t.font!==void 0&&(this.font=t.font),t.justify!==void 0&&(this.justify=t.justify),t.hiddenText!==void 0&&(this.hiddenText=t.hiddenText)}get font(){return this._sxFont||(this._sxFont=new qot),this._sxFont}set font(t){this._sxFont=t}get justify(){return this._sxJustify}set justify(t){this._sxJustify=t}get hiddenText(){return this._hiddenText}set hiddenText(t){this._hiddenText=t}static fromSexprPrimitives(t){let i=new Vd,{propertyMap:r}=z.parsePrimitivesToClassProperties(t,this.token);i._sxFont=r.font,i._sxJustify=r.justify;let s=r.hide;s&&(i._hiddenText=s.value);for(let o of t){if(typeof o=="string"){if(o==="hide"){i._hiddenText=!0;continue}throw new Error(`Unknown text effects token: ${o}`)}if(!Array.isArray(o))throw new Error(`Unsupported text effects primitive: ${JSON.stringify(o)}`)}return i}getChildren(){let t=[];return this._sxFont&&t.push(this._sxFont),this._sxJustify&&t.push(this._sxJustify),this._hiddenText&&t.push(new uO(!0)),t}getString(){let t=["(effects"];return this._sxFont&&t.push(this._sxFont.getStringIndented()),this._sxJustify&&t.push(this._sxJustify.getStringIndented()),this._hiddenText&&t.push(new uO(!0).getStringIndented()),t.push(")"),t.join(`
`)}},d(Vd,"token","effects"),Vd);z.register(Wot);var Ml,qot=(Ml=class extends z{constructor(){super(...arguments);d(this,"token","font");d(this,"_sxFace");d(this,"_sxSize");d(this,"_sxThickness");d(this,"_sxLineSpacing");d(this,"_sxBold");d(this,"_sxItalic")}get face(){return this._sxFace?.value}set face(t){this._sxFace=t===void 0?void 0:new Zot(t)}get size(){if(this._sxSize)return{height:this._sxSize.height,width:this._sxSize.width}}set size(t){if(t===void 0){this._sxSize=void 0;return}if(t instanceof aO){this._sxSize=t;return}this._sxSize=new aO(t.height,t.width)}get thickness(){return this._sxThickness?.value}set thickness(t){this._sxThickness=t===void 0?void 0:new Kot(t)}get lineSpacing(){return this._sxLineSpacing?.value}set lineSpacing(t){this._sxLineSpacing=t===void 0?void 0:new Jot(t)}get bold(){return this._sxBold?.value??!1}set bold(t){this._sxBold=t?new cO(t):void 0}get italic(){return this._sxItalic?.value??!1}set italic(t){this._sxItalic=t?new lO(t):void 0}static fromSexprPrimitives(t){let i=new Ml,{propertyMap:r}=z.parsePrimitivesToClassProperties(t,this.token);i._sxFace=r.face,i._sxSize=r.size,i._sxThickness=r.thickness,i._sxLineSpacing=r.line_spacing,i._sxBold=r.bold,i._sxItalic=r.italic;for(let s of t){if(typeof s=="string"){if(s==="bold"){i._sxBold=new cO(!0);continue}if(s==="italic"){i._sxItalic=new lO(!0);continue}throw new Error(`Unknown font token: ${s}`)}if(!Array.isArray(s))throw new Error(`Unsupported font primitive: ${JSON.stringify(s)}`)}return i}getChildren(){let t=[];return this._sxFace&&t.push(this._sxFace),this._sxSize&&t.push(this._sxSize),this._sxThickness&&t.push(this._sxThickness),this._sxBold&&t.push(this._sxBold),this._sxItalic&&t.push(this._sxItalic),this._sxLineSpacing&&t.push(this._sxLineSpacing),t}getString(){let t=["(font"];return this._sxFace&&t.push(this._sxFace.getStringIndented()),this._sxSize&&t.push(this._sxSize.getStringIndented()),this._sxThickness&&t.push(this._sxThickness.getStringIndented()),this._sxBold&&t.push(this._sxBold.getStringIndented()),this._sxItalic&&t.push(this._sxItalic.getStringIndented()),this._sxLineSpacing&&t.push(this._sxLineSpacing.getStringIndented()),t.push(")"),t.join(`
`)}},d(Ml,"token","font"),d(Ml,"parentToken","effects"),Ml);z.register(qot);var ek,Zot=(ek=class extends bo{constructor(){super(...arguments);d(this,"token","face")}getString(){return`(face ${re(this.value)})`}},d(ek,"token","face"),d(ek,"parentToken","font"),ek);z.register(Zot);var Cl,aO=(Cl=class extends z{constructor(t=0,i=0){super();d(this,"token","size");d(this,"_height",0);d(this,"_width",0);this._height=t,this._width=i}static fromSexprPrimitives(t){let i=Dt(t[0])??0,r=Dt(t[1])??0;return new Cl(i,r)}get height(){return this._height}set height(t){this._height=t}get width(){return this._width}set width(t){this._width=t}getString(){return`(size ${this._height} ${this._width})`}},d(Cl,"token","size"),d(Cl,"parentToken","font"),Cl);z.register(aO);var nk,Kot=(nk=class extends rn{constructor(){super(...arguments);d(this,"token","thickness")}},d(nk,"token","thickness"),d(nk,"parentToken","font"),nk);z.register(Kot);var ik,cO=(ik=class extends ti{constructor(e){super(e??!0);d(this,"token","bold")}getString(){return this.value?"bold":""}},d(ik,"token","bold"),d(ik,"parentToken","font"),ik);z.register(cO);var rk,lO=(rk=class extends ti{constructor(e){super(e??!0);d(this,"token","italic")}getString(){return this.value?"italic":""}},d(rk,"token","italic"),d(rk,"parentToken","font"),rk);z.register(lO);var sk,uO=(sk=class extends ti{constructor(e){super(e??!0);d(this,"token","hide")}getString(){return this.value?"(hide yes)":"(hide no)"}},d(sk,"token","hide"),d(sk,"parentToken","effects"),sk);z.register(uO);var ok,Jot=(ok=class extends rn{constructor(){super(...arguments);d(this,"token","line_spacing")}},d(ok,"token","line_spacing"),d(ok,"parentToken","font"),ok);z.register(Jot);var Il,bjt=(Il=class extends z{constructor(t={}){super();d(this,"token","justify");d(this,"_horizontal");d(this,"_vertical");d(this,"_mirror",!1);this._horizontal=t.horizontal,this._vertical=t.vertical,this._mirror=t.mirror??!1}static fromSexprPrimitives(t){let i=new Il;for(let r of t){let s=jt(r);if(s===void 0)throw new Error(`Unsupported justify primitive: ${JSON.stringify(r)}`);if(s==="left"||s==="right"){i._horizontal=s;continue}if(s==="top"||s==="bottom"){i._vertical=s;continue}if(s==="mirror"){i._mirror=!0;continue}throw new Error(`Unknown justify token: ${s}`)}return i}get horizontal(){return this._horizontal}set horizontal(t){this._horizontal=t}get vertical(){return this._vertical}set vertical(t){this._vertical=t}get mirror(){return this._mirror}set mirror(t){this._mirror=t}getString(){let t=["(justify"];return this._horizontal&&t.push(` ${this._horizontal}`),this._vertical&&t.push(` ${this._vertical}`),this._mirror&&t.push(" mirror"),t.push(")"),t.join("")}},d(Il,"token","justify"),d(Il,"parentToken","effects"),Il);z.register(bjt);var oR,Vt=(oR=class extends bo{constructor(){super(...arguments);d(this,"token","uuid")}},d(oR,"token","uuid"),oR);z.register(Vt);function L0(n){if(n===void 0)return"";let e=jt(n);return e!==void 0?e:Wi(n)}var Gd,Qot=(Gd=class extends z{constructor(t={}){super();d(this,"token","title_block");d(this,"_sxTitle");d(this,"_sxDate");d(this,"_sxRev");d(this,"_sxCompany");d(this,"comments",[]);t.title!==void 0&&(this.title=t.title),t.date!==void 0&&(this.date=t.date),t.rev!==void 0&&(this.rev=t.rev),t.company!==void 0&&(this.company=t.company),t.comments!==void 0&&(this.comments=t.comments)}static fromSexprPrimitives(t){let i=new Gd;for(let r of t){if(!Array.isArray(r)||r.length===0)throw new Error(`Unexpected primitive inside title_block: ${Wi(r)}`);let s=z.parsePrimitiveSexpr(r,{parentToken:this.token});if(!(s instanceof z))throw new Error(`Unable to parse child node inside title_block: ${Wi(r)}`);if(s instanceof pO){i._sxTitle=s;continue}if(s instanceof hO){i._sxDate=s;continue}if(s instanceof dO){i._sxRev=s;continue}if(s instanceof fO){i._sxCompany=s;continue}if(s instanceof mO){i.comments.push(s);continue}throw new Error(`Unsupported child "${s.token}" inside title_block expression`)}return i}get title(){return this._sxTitle?.value}set title(t){this._sxTitle=t===void 0?void 0:new pO(t)}get date(){return this._sxDate?.value}set date(t){this._sxDate=t===void 0?void 0:new hO(t)}get rev(){return this._sxRev?.value}set rev(t){this._sxRev=t===void 0?void 0:new dO(t)}get company(){return this._sxCompany?.value}set company(t){this._sxCompany=t===void 0?void 0:new fO(t)}getComment(t){return this.comments.find(i=>i.index===t)?.value}setComment(t,i){let r=this.comments.find(s=>s.index===t);if(r){r.value=i;return}this.comments.push(new mO(t,i))}removeComment(t){this.comments=this.comments.filter(i=>i.index!==t)}getChildren(){let t=[];this._sxTitle&&t.push(this._sxTitle),this._sxDate&&t.push(this._sxDate),this._sxRev&&t.push(this._sxRev),this._sxCompany&&t.push(this._sxCompany);let i=[...this.comments].sort((r,s)=>r.index-s.index);return t.push(...i),t}getString(){let t=["(title_block"];for(let i of this.getChildren())t.push(i.getStringIndented());return t.push(")"),t.join(`
`)}},d(Gd,"token","title_block"),Gd);z.register(Qot);var oT=class extends z{constructor(e){super();d(this,"value");this.value=e}getChildren(){return[]}},Nl,pO=(Nl=class extends oT{constructor(){super(...arguments);d(this,"token","title")}static fromSexprPrimitives(t){let[i]=t;return new Nl(L0(i))}getString(){return`(title ${re(this.value)})`}},d(Nl,"token","title"),d(Nl,"parentToken","title_block"),Nl);z.register(pO);var Al,hO=(Al=class extends oT{constructor(){super(...arguments);d(this,"token","date")}static fromSexprPrimitives(t){let[i]=t;return new Al(L0(i))}getString(){return`(date ${re(this.value)})`}},d(Al,"token","date"),d(Al,"parentToken","title_block"),Al);z.register(hO);var Rl,dO=(Rl=class extends oT{constructor(){super(...arguments);d(this,"token","rev")}static fromSexprPrimitives(t){let[i]=t;return new Rl(L0(i))}getString(){return`(rev ${re(this.value)})`}},d(Rl,"token","rev"),d(Rl,"parentToken","title_block"),Rl);z.register(dO);var Ol,fO=(Ol=class extends oT{constructor(){super(...arguments);d(this,"token","company")}static fromSexprPrimitives(t){let[i]=t;return new Ol(L0(i))}getString(){return`(company ${re(this.value)})`}},d(Ol,"token","company"),d(Ol,"parentToken","title_block"),Ol);z.register(fO);var Ll,mO=(Ll=class extends z{constructor(t,i){super();d(this,"token","comment");d(this,"index");d(this,"value");d(this,"_sxAt");d(this,"_sxEffects");d(this,"_sxUuid");this.index=t,this.value=i}static fromSexprPrimitives(t){let[i,r,...s]=t,o=Dt(i);if(o===void 0)throw new Error("title_block comment requires a numeric index");let a=L0(r),c=new Ll(o,a);for(let l of s){if(!Array.isArray(l)||l.length===0)throw new Error(`Unexpected primitive inside title_block comment: ${Wi(l)}`);let u=z.parsePrimitiveSexpr(l,{parentToken:this.token});if(!(u instanceof z))throw new Error(`Unable to parse child node inside title_block comment: ${Wi(l)}`);if(u instanceof Un){c._sxAt=u;continue}if(u instanceof Wot){c._sxEffects=u;continue}if(u instanceof Vt){c._sxUuid=u;continue}throw new Error(`Unsupported child "${u.token}" inside title_block comment`)}return c}get at(){return this._sxAt}set at(t){this._sxAt=t}get effects(){return this._sxEffects}set effects(t){this._sxEffects=t}get uuid(){return this._sxUuid}set uuid(t){this._sxUuid=t}getChildren(){let t=[];return this._sxAt&&t.push(this._sxAt),this._sxEffects&&t.push(this._sxEffects),this._sxUuid&&t.push(this._sxUuid),t}getString(){let t=this.getChildren();if(t.length===0)return`(comment ${this.index} ${re(this.value)})`;let i=[`(comment ${this.index} ${re(this.value)}`];for(let r of t)i.push(r.getStringIndented());return i.push(")"),i.join(`
`)}},d(Ll,"token","comment"),d(Ll,"parentToken","title_block"),Ll);z.register(mO);var Hd,tat=(Hd=class extends z{constructor(){super(...arguments);d(this,"token","paper");d(this,"_size");d(this,"_width");d(this,"_height");d(this,"_portrait",!1)}static fromSexprPrimitives(t){let i=new Hd,r=[];for(let s of t){if(typeof s=="number"){r.push(s);continue}if(typeof s=="string"){if(s==="portrait"){i._portrait=!0;continue}i._size===void 0&&r.length===0&&(i._size=s)}}return r.length>=2?(i._width=r[0],i._height=r[1]):r.length===1&&(i._width=r[0]),i}get size(){return this._size}set size(t){this._size=t,t!==void 0&&(this._width=void 0,this._height=void 0)}get customSize(){if(typeof this._width=="number"&&typeof this._height=="number")return{width:this._width,height:this._height}}set customSize(t){if(!t){this._width=void 0,this._height=void 0;return}this._width=t.width,this._height=t.height,this._size=void 0}get isPortrait(){return this._portrait}set isPortrait(t){this._portrait=t}getString(){let t=["(paper"];return this._size?t.push(`  ${this._size}`):typeof this._width=="number"&&typeof this._height=="number"&&t.push(`  ${this._width} ${this._height}`),this._portrait&&t.push("  portrait"),t.push(")"),t.join(`
`)}},d(Hd,"token","paper"),Hd);z.register(tat);var Wd,qe=(Wd=class extends z{constructor(t=[]){super();d(this,"token","layer");d(this,"_names",[]);this.names=t.map(i=>String(i))}static fromSexprPrimitives(t){let i=t.map(r=>typeof r=="string"||typeof r=="number"?String(r):Wi(r));return new Wd(i)}get names(){return[...this._names]}set names(t){this._names=t.map(i=>String(i))}addName(t){this._names.push(String(t))}getString(){return`(layer ${this._names.map(i=>/^[^\s()"]+$/u.test(i)&&!["nil","#t","#f"].includes(i)?i:re(i)).join(" ")})`}},d(Wd,"token","layer"),Wd);z.register(qe);var pot=new Set(["at","xy","scale","layer","uuid","data"]),vjt=new Set,qd,eat=(qd=class extends z{constructor(t={}){super();d(this,"token","image");d(this,"_sxPosition");d(this,"_sxScale");d(this,"_sxLayer");d(this,"_sxUuid");d(this,"_sxData");t.position!==void 0&&(this.position=t.position),t.scale!==void 0&&(this.scale=t.scale),t.layer!==void 0&&(this.layer=t.layer),t.uuid!==void 0&&(this.uuid=t.uuid),t.data!==void 0&&(this.data=t.data)}static fromSexprPrimitives(t){let i=new qd,r=[];for(let l of t){if(!Array.isArray(l)||l.length===0)throw new Error(`image encountered invalid child expression: ${JSON.stringify(l)}`);r.push(l)}let{propertyMap:s,arrayPropertyMap:o}=z.parsePrimitivesToClassProperties(r,this.token);for(let l of Object.keys(s))if(!pot.has(l))throw new Error(`image encountered unsupported child token "${l}"`);for(let[l,u]of Object.entries(o)){if(!pot.has(l))throw new Error(`image encountered unsupported child token "${l}"`);if(!vjt.has(l)&&u.length>1)throw new Error(`image does not support repeated child token "${l}"`)}let a=s.at,c=s.xy;if(a&&c)throw new Error("image cannot include both at and xy child tokens");return i._sxPosition=a??c,i._sxScale=s.scale,i._sxLayer=s.layer,i._sxUuid=s.uuid,i._sxData=s.data,i}get position(){return this._sxPosition}set position(t){if(t===void 0){this._sxPosition=void 0;return}if(t instanceof Zr){this._sxPosition=t;return}this._sxPosition=Un.from(t)}get scale(){return this._sxScale}set scale(t){if(t===void 0){this._sxScale=void 0;return}this._sxScale=t instanceof _O?t:new _O(t)}get layer(){return this._sxLayer}set layer(t){if(t===void 0){this._sxLayer=void 0;return}if(t instanceof qe)this._sxLayer=t;else{let i=Array.isArray(t)?t:[t];this._sxLayer=new qe(i)}}get uuid(){return this._sxUuid}set uuid(t){if(t===void 0){this._sxUuid=void 0;return}this._sxUuid=t instanceof Vt?t:new Vt(t)}get data(){return this._sxData}set data(t){if(t===void 0){this._sxData=void 0;return}t instanceof Qk?this._sxData=t:Array.isArray(t)?this._sxData=Qk.fromStrings(t):this._sxData=Qk.fromStrings([t])}getChildren(){let t=[];return this._sxPosition&&t.push(this._sxPosition),this._sxScale&&t.push(this._sxScale),this._sxLayer&&t.push(this._sxLayer),this._sxUuid&&t.push(this._sxUuid),this._sxData&&t.push(this._sxData),t}},d(qd,"token","image"),qd);z.register(eat);var Fl,_O=(Fl=class extends z{constructor(t){super();d(this,"token","scale");d(this,"value");this.value=t}static fromSexprPrimitives(t){let[i]=t,r=Dt(i);return new Fl(r??1)}getChildren(){return[]}getString(){return`(scale ${this.value})`}},d(Fl,"token","scale"),d(Fl,"parentToken","image"),Fl);z.register(_O);var tc,Qk=(tc=class extends z{constructor(t=[]){super();d(this,"token","data");d(this,"_chunks");this._chunks=t}static fromSexprPrimitives(t){let i=t.map(r=>Sjt(r));return new tc(i)}static fromStrings(t){return new tc(t)}get chunks(){return[...this._chunks]}set chunks(t){this._chunks=[...t]}get value(){return this._chunks.join("")}set value(t){this._chunks=[t]}getChildren(){return[]}getString(){return this._chunks.length===0?"(data)":`(data ${this._chunks.map(i=>re(i)).join(" ")})`}},d(tc,"token","data"),d(tc,"parentToken","image"),tc);z.register(Qk);function Sjt(n){let e=jt(n);return e!==void 0?e:Wi(n)}var Zd,wjt=(Zd=class extends z{constructor(t=""){super();d(this,"token","render_cache");d(this,"_text");d(this,"_angle");d(this,"_offsetX");d(this,"_offsetY");d(this,"_elements",[]);this._text=t}static fromSexprPrimitives(t){if(t.length===0)throw new Error("render_cache requires a text argument");let[i,...r]=t,s=jt(i);if(s===void 0)throw new Error(`render_cache text must be a string value, received ${JSON.stringify(i)}`);let o=new Zd(s),a=[];for(let c of r){if(Array.isArray(c)){let u=z.parsePrimitiveSexpr(c,{parentToken:this.token});if(!(u instanceof z))throw new Error(`render_cache child did not resolve to an SxClass: ${JSON.stringify(c)}`);if(!(u instanceof nat))throw new Error(`render_cache encountered unsupported child token "${u.token}"`);o._elements.push(u);continue}let l=Dt(c);if(l===void 0)throw new Error(`render_cache encountered non-numeric parameter ${JSON.stringify(c)}`);a.push(l)}if(a.length>0&&(o._angle=a[0]),a.length>1&&(o._offsetX=a[1]),a.length>2&&(o._offsetY=a[2]),a.length>3)throw new Error("render_cache supports at most three numeric parameters");return o}get text(){return this._text}set text(t){this._text=t}get angle(){return this._angle}set angle(t){this._angle=t}get offsetX(){return this._offsetX}set offsetX(t){this._offsetX=t}get offsetY(){return this._offsetY}set offsetY(t){this._offsetY=t}get elements(){return[...this._elements]}set elements(t){this._elements=[...t]}addElement(t){this._elements.push(t)}getChildren(){return[...this._elements]}getString(){let t=[re(this._text)];if(this._angle!==void 0&&t.push(String(this._angle)),this._offsetX!==void 0&&t.push(String(this._offsetX)),this._offsetY!==void 0&&t.push(String(this._offsetY)),this._elements.length===0)return`(render_cache ${t.join(" ")})`;let i=[`(render_cache ${t.join(" ")}`];for(let r of this._elements)i.push(r.getStringIndented());return i.push(")"),i.join(`
`)}},d(Zd,"token","render_cache"),Zd);z.register(wjt);var zl,nat=(zl=class extends z{constructor(){super(...arguments);d(this,"token","polygon");d(this,"_contours",[])}static fromSexprPrimitives(t){let i=new zl;for(let r of t){if(!Array.isArray(r)||r.length===0)throw new Error(`render_cache polygon encountered invalid child: ${JSON.stringify(r)}`);let s=z.parsePrimitiveSexpr(r,{parentToken:this.token});if(!(s instanceof z))throw new Error(`render_cache polygon child did not resolve to an SxClass: ${JSON.stringify(r)}`);if(!(s instanceof Sr))throw new Error(`render_cache polygon encountered unsupported token "${s.token}"`);i._contours.push(s)}if(i._contours.length===0)throw new Error("render_cache polygon requires at least one pts child");return i}get contours(){return[...this._contours]}set contours(t){this._contours=[...t]}getChildren(){return[...this._contours]}},d(zl,"token","polygon"),d(zl,"parentToken","render_cache"),zl);z.register(nat);var aR,En=(aR=class extends bo{constructor(){super(...arguments);d(this,"token","tstamp")}},d(aR,"token","tstamp"),aR);z.register(En);var Pjt=n=>/^[A-Za-z0-9._-]+$/.test(n),$l,yO=($l=class extends bo{constructor(){super(...arguments);d(this,"token","generator")}static fromSexprPrimitives(t){let[i]=t,r=jt(i);if(r===void 0)throw new Error("generator expects a string argument");return new $l(r)}getString(){return`(generator ${Pjt(this.value)?this.value:re(this.value)})`}},d($l,"token","generator"),d($l,"parentToken","kicad_sch"),$l);z.register(yO);var Dl,gO=(Dl=class extends rn{constructor(){super(...arguments);d(this,"token","version")}static fromSexprPrimitives(t){let[i]=t,r=Dt(i);if(r===void 0)throw new Error("version expects a numeric argument");return new Dl(r)}},d(Dl,"token","version"),d(Dl,"parentToken","kicad_sch"),Dl);z.register(gO);var jl,xO=(jl=class extends bo{constructor(){super(...arguments);d(this,"token","generator_version")}static fromSexprPrimitives(t){let[i]=t,r=jt(i);if(r===void 0)throw new Error("generator_version expects a string argument");return new jl(r)}getString(){return`(generator_version ${/^[^\s()\"]+$/.test(this.value)?this.value:re(this.value)})`}},d(jl,"token","generator_version"),d(jl,"parentToken","kicad_sch"),jl);z.register(xO);var cc=(n,e="  ")=>n.split(`
`).map(t=>`${e}${t}`),cR,b7=(cR=class extends ti{constructor(){super(...arguments);d(this,"token","dnp")}},d(cR,"token","dnp"),cR);z.register(b7);var po,kjt=(po=class extends z{constructor(t=!1){super();d(this,"token","embedded_fonts");d(this,"_enabled",!1);this._enabled=t}static fromSexprPrimitives(t){if(t.length===0)return new po(!1);if(t.length>1)throw new Error("embedded_fonts accepts at most a single value");let[i]=t;if(i===void 0)return new po(!1);if(typeof i=="boolean")return new po(i);if(typeof i=="string"){let r=i.toLowerCase();if(r==="yes")return new po(!0);if(r==="no")return new po(!1);throw new Error(`embedded_fonts expects "yes" or "no", received "${i}"`)}throw new Error(`embedded_fonts encountered unsupported value ${JSON.stringify(i)}`)}get enabled(){return this._enabled}set enabled(t){this._enabled=t}getChildren(){return[]}getString(){return`(embedded_fonts ${this._enabled?"yes":"no"})`}},d(po,"token","embedded_fonts"),po);z.register(kjt);var lR,aT=(lR=class extends ti{constructor(){super(...arguments);d(this,"token","exclude_from_sim")}},d(lR,"token","exclude_from_sim"),lR);z.register(aT);var uR,Tf=(uR=class extends ti{constructor(){super(...arguments);d(this,"token","fields_autoplaced")}},d(uR,"token","fields_autoplaced"),uR);z.register(Tf);var Tjt=new Set(["pts","stroke","uuid"]),Ejt=new Set(["pts","stroke","fill"]),Kd,v7=(Kd=class extends z{constructor(t={}){super();d(this,"token","polyline");d(this,"_sxPts");d(this,"_sxStroke");d(this,"_sxUuid");d(this,"_sxFill");t.points!==void 0&&(this.points=t.points),t.stroke!==void 0&&(this.stroke=t.stroke),t.uuid!==void 0&&(this.uuid=t.uuid),t.fill!==void 0&&(this.fill=t.fill)}static fromSexprPrimitives(t){let i=new Kd,{propertyMap:r,arrayPropertyMap:s}=z.parsePrimitivesToClassProperties(t,this.token),o=this.parentToken==="symbol"?Ejt:Tjt;for(let[c,l]of Object.entries(s)){if(!o.has(c))throw new Error(`Unsupported child tokens inside polyline expression: ${c}`);if(l.length>1)throw new Error(`polyline does not support repeated child tokens: ${c}`)}let a=Object.keys(r).filter(c=>!o.has(c));if(a.length>0)throw new Error(`Unsupported child tokens inside polyline expression: ${a.join(", ")}`);return i._sxPts=s.pts?.[0]??r.pts,i._sxStroke=r.stroke,i._sxUuid=r.uuid,i._sxFill=r.fill,i}get points(){return this._sxPts}set points(t){this._sxPts=t}get stroke(){return this._sxStroke}set stroke(t){this._sxStroke=t}get uuid(){return this._sxUuid}set uuid(t){if(t===void 0){this._sxUuid=void 0;return}this._sxUuid=t instanceof Vt?t:new Vt(t)}get fill(){return this._sxFill}set fill(t){this._sxFill=t}getChildren(){let t=[];return this._sxPts&&t.push(this._sxPts),this._sxStroke&&t.push(this._sxStroke),this._sxFill&&t.push(this._sxFill),this._sxUuid&&t.push(this._sxUuid),t}},d(Kd,"token","polyline"),Kd);z.register(v7);var pR,Mjt=(pR=class extends v7{},d(pR,"parentToken","kicad_sch"),pR);z.register(Mjt);var hR,Cjt=(hR=class extends v7{},d(hR,"parentToken","symbol"),hR);z.register(Cjt);var ec,iat=(ec=class extends rn{constructor(){super(...arguments);d(this,"token","unit")}static from(t){return t instanceof ec?t:new ec(t)}},d(ec,"token","unit"),d(ec,"parentToken","symbol"),ec);z.register(iat);var Bl,Ijt=(Bl=class extends z{constructor(t){super();d(this,"token","lib_id");d(this,"value");this.value=t}static fromSexprPrimitives(t){let[i]=t,r=jt(i);if(r===void 0)throw new Error("lib_id expects a string value");return new Bl(r)}getChildren(){return[]}getString(){return`(lib_id ${re(this.value)})`}},d(Bl,"token","lib_id"),d(Bl,"parentToken","symbol"),Bl);z.register(Ijt);var ak,rat=(ak=class extends ti{constructor(){super(...arguments);d(this,"token","duplicate_pin_numbers_are_jumpers")}},d(ak,"token","duplicate_pin_numbers_are_jumpers"),d(ak,"parentToken","symbol"),ak);z.register(rat);var Yl,bO=(Yl=class extends z{constructor(t){super();d(this,"token","mirror");d(this,"value");this.value=t}static fromSexprPrimitives(t){let[i]=t,r=jt(i);if(r===void 0)throw new Error("mirror expects a string value (x or y)");return new Yl(r)}getChildren(){return[]}getString(){return`(mirror ${this.value})`}},d(Yl,"token","mirror"),d(Yl,"parentToken","symbol"),Yl);z.register(bO);var Xl,Njt=(Xl=class extends z{constructor(){super(...arguments);d(this,"token","pin_numbers");d(this,"_sxHide")}static fromSexprPrimitives(t){let i=new Xl,r=[],s=[];for(let a of t){if(typeof a=="string"){r.push(a);continue}s.push(a)}let{propertyMap:o}=z.parsePrimitivesToClassProperties(s,this.token);i._sxHide=o.hide;for(let a of r){if(a==="hide"){i._sxHide=new vO(!0,{inline:!0});continue}throw new Error(`symbol pin_numbers encountered unsupported flag "${a}"`)}return i}get hide(){return this._sxHide?.value??!1}set hide(t){this._sxHide=new vO(t)}getChildren(){return this._sxHide?[this._sxHide]:[]}},d(Xl,"token","pin_numbers"),d(Xl,"parentToken","symbol"),Xl);z.register(Njt);var ck,vO=(ck=class extends ti{constructor(e,t={}){super(e??!0);d(this,"token","hide");d(this,"inline",!1);this.inline=t.inline??!1}getString(){return this.inline?this.value?"hide":"(hide no)":super.getString()}},d(ck,"token","hide"),d(ck,"parentToken","pin_numbers"),ck);z.register(vO);var Ul,Ajt=(Ul=class extends z{constructor(){super(...arguments);d(this,"token","pin_names");d(this,"_sxOffset");d(this,"_sxHide")}static fromSexprPrimitives(t){let i=new Ul,{propertyMap:r}=z.parsePrimitivesToClassProperties(t,this.token);return i._sxOffset=r.offset,i._sxHide=r.hide,i}get offset(){return this._sxOffset?.value}set offset(t){if(t===void 0){this._sxOffset=void 0;return}this._sxOffset=new sat(t)}get hide(){return this._sxHide?.value??!1}set hide(t){this._sxHide=new oat(t)}getChildren(){let t=[];return this._sxOffset&&t.push(this._sxOffset),this._sxHide&&t.push(this._sxHide),t}},d(Ul,"token","pin_names"),d(Ul,"parentToken","symbol"),Ul);z.register(Ajt);var Vl,sat=(Vl=class extends z{constructor(t){super();d(this,"token","offset");d(this,"value");this.value=t}static fromSexprPrimitives(t){let[i]=t,r=Dt(i);if(r===void 0)throw new Error("pin_names offset expects a numeric value");return new Vl(r)}getChildren(){return[]}getString(){return`(offset ${this.value})`}},d(Vl,"token","offset"),d(Vl,"parentToken","pin_names"),Vl);z.register(sat);var lk,oat=(lk=class extends ti{constructor(){super(...arguments);d(this,"token","hide")}},d(lk,"token","hide"),d(lk,"parentToken","pin_names"),lk);z.register(oat);var my=class extends z{constructor(e,t){super();d(this,"_x");d(this,"_y");this._x=e,this._y=t}static fromSexprPrimitives(e){let[t,i]=e,r=Dt(t),s=Dt(i);if(r===void 0||s===void 0)throw new Error(`${this.name} expects two numeric arguments`);let o=this;return new o(r,s)}get x(){return this._x}set x(e){this._x=e}get y(){return this._y}set y(e){this._y=e}toObject(){return{x:this._x,y:this._y}}getChildren(){return[]}getString(){return`(${this.token} ${this._x} ${this._y})`}},uk,Rjt=(uk=class extends my{constructor(){super(...arguments);d(this,"token","start")}},d(uk,"token","start"),d(uk,"parentToken","rectangle"),uk);z.register(Rjt);var pk,Ojt=(pk=class extends my{constructor(){super(...arguments);d(this,"token","end")}},d(pk,"token","end"),d(pk,"parentToken","rectangle"),pk);z.register(Ojt);var hk,Ljt=(hk=class extends my{constructor(){super(...arguments);d(this,"token","start")}},d(hk,"token","start"),d(hk,"parentToken","arc"),hk);z.register(Ljt);var dk,Fjt=(dk=class extends my{constructor(){super(...arguments);d(this,"token","mid")}},d(dk,"token","mid"),d(dk,"parentToken","arc"),dk);z.register(Fjt);var fk,zjt=(fk=class extends my{constructor(){super(...arguments);d(this,"token","end")}},d(fk,"token","end"),d(fk,"parentToken","arc"),fk);z.register(zjt);var mk,$jt=(mk=class extends my{constructor(){super(...arguments);d(this,"token","center")}},d(mk,"token","center"),d(mk,"parentToken","circle"),mk);z.register($jt);var _k,Djt=(_k=class extends rn{constructor(){super(...arguments);d(this,"token","radius")}},d(_k,"token","radius"),d(_k,"parentToken","circle"),_k);z.register(Djt);var cT=class extends z{constructor(){super(...arguments);d(this,"_sxType")}static fromSexprPrimitives(e){let t=new this,{propertyMap:i}=z.parsePrimitivesToClassProperties(e,"fill");return t._sxType=i.type,t}get type(){return this._sxType?.value}set type(e){if(e===void 0){this._sxType=void 0;return}this._sxType=new aat(e)}getChildren(){return this._sxType?[this._sxType]:[]}},yk,jjt=(yk=class extends cT{constructor(){super(...arguments);d(this,"token","fill")}},d(yk,"token","fill"),d(yk,"parentToken","polyline"),yk);z.register(jjt);var gk,Bjt=(gk=class extends cT{constructor(){super(...arguments);d(this,"token","fill")}},d(gk,"token","fill"),d(gk,"parentToken","rectangle"),gk);z.register(Bjt);var xk,Yjt=(xk=class extends cT{constructor(){super(...arguments);d(this,"token","fill")}},d(xk,"token","fill"),d(xk,"parentToken","circle"),xk);z.register(Yjt);var bk,Xjt=(bk=class extends cT{constructor(){super(...arguments);d(this,"token","fill")}},d(bk,"token","fill"),d(bk,"parentToken","arc"),bk);z.register(Xjt);var Gl,aat=(Gl=class extends z{constructor(t){super();d(this,"token","type");d(this,"value");this.value=t}static fromSexprPrimitives(t){let[i]=t,r=jt(i);if(r===void 0)throw new Error("fill type expects a string value");return new Gl(r)}getChildren(){return[]}getString(){return`(type ${this.value})`}},d(Gl,"token","type"),d(Gl,"parentToken","fill"),Gl);z.register(aat);var Hl,Ujt=(Hl=class extends z{constructor(){super(...arguments);d(this,"token","rectangle");d(this,"_sxStart");d(this,"_sxEnd");d(this,"_sxStroke");d(this,"_sxFill")}static fromSexprPrimitives(t){let i=new Hl,{propertyMap:r}=z.parsePrimitivesToClassProperties(t,this.token);return i._sxStart=r.start,i._sxEnd=r.end,i._sxStroke=r.stroke,i._sxFill=r.fill,i}getChildren(){let t=[];return this._sxStart&&t.push(this._sxStart),this._sxEnd&&t.push(this._sxEnd),this._sxStroke&&t.push(this._sxStroke),this._sxFill&&t.push(this._sxFill),t}},d(Hl,"token","rectangle"),d(Hl,"parentToken","symbol"),Hl);z.register(Ujt);var Wl,Vjt=(Wl=class extends z{constructor(){super(...arguments);d(this,"token","circle");d(this,"_sxCenter");d(this,"_sxRadius");d(this,"_sxStroke");d(this,"_sxFill")}static fromSexprPrimitives(t){let i=new Wl,{propertyMap:r}=z.parsePrimitivesToClassProperties(t,this.token);return i._sxCenter=r.center,i._sxRadius=r.radius,i._sxStroke=r.stroke,i._sxFill=r.fill,i}getChildren(){let t=[];return this._sxCenter&&t.push(this._sxCenter),this._sxRadius&&t.push(this._sxRadius),this._sxStroke&&t.push(this._sxStroke),this._sxFill&&t.push(this._sxFill),t}},d(Wl,"token","circle"),d(Wl,"parentToken","symbol"),Wl);z.register(Vjt);var ql,Gjt=(ql=class extends z{constructor(){super(...arguments);d(this,"token","arc");d(this,"_sxStart");d(this,"_sxMid");d(this,"_sxEnd");d(this,"_sxStroke");d(this,"_sxFill")}static fromSexprPrimitives(t){let i=new ql,{propertyMap:r}=z.parsePrimitivesToClassProperties(t,this.token);return i._sxStart=r.start,i._sxMid=r.mid,i._sxEnd=r.end,i._sxStroke=r.stroke,i._sxFill=r.fill,i}getChildren(){let t=[];return this._sxStart&&t.push(this._sxStart),this._sxMid&&t.push(this._sxMid),this._sxEnd&&t.push(this._sxEnd),this._sxStroke&&t.push(this._sxStroke),this._sxFill&&t.push(this._sxFill),t}},d(ql,"token","arc"),d(ql,"parentToken","symbol"),ql);z.register(Gjt);var Zl,Hjt=(Zl=class extends z{constructor(){super(...arguments);d(this,"token","text");d(this,"_value","");d(this,"_sxAt");d(this,"_sxEffects")}static fromSexprPrimitives(t){let[i,...r]=t,s=jt(i);if(s===void 0)throw new Error("text expects a string value");let o=new Zl;o._value=s;let{propertyMap:a}=z.parsePrimitivesToClassProperties(r,this.token);return o._sxAt=a.at,o._sxEffects=a.effects,o}get value(){return this._value}set value(t){this._value=t}get at(){return this._sxAt}set at(t){this._sxAt=t!==void 0?Un.from(t):void 0}get effects(){return this._sxEffects}set effects(t){this._sxEffects=t}getChildren(){let t=[];return this._sxAt&&t.push(this._sxAt),this._sxEffects&&t.push(this._sxEffects),t}getString(){let t=[`(text ${re(this._value)}`];for(let i of this.getChildren())t.push(i.getStringIndented());return t.push(")"),t.join(`
`)}},d(Zl,"token","text"),d(Zl,"parentToken","symbol"),Zl);z.register(Hjt);var Kl,Wjt=(Kl=class extends z{constructor(){super(...arguments);d(this,"token","power")}static fromSexprPrimitives(){return new Kl}getChildren(){return[]}getString(){return"(power)"}},d(Kl,"token","power"),d(Kl,"parentToken","symbol"),Kl);z.register(Wjt);var Jd,qjt=(Jd=class extends z{constructor(t={}){super();d(this,"token","symbol");d(this,"_sxLibId");d(this,"_sxAt");d(this,"_sxMirror");d(this,"_sxUnit");d(this,"_sxPinNumbers");d(this,"_sxPinNames");d(this,"_sxExcludeFromSim");d(this,"_sxInBom");d(this,"_sxOnBoard");d(this,"_sxDnp");d(this,"_sxUuid");d(this,"_sxDuplicatePinNumbersAreJumpers");d(this,"_sxFieldsAutoplaced");d(this,"properties",[]);d(this,"pins",[]);d(this,"subSymbols",[]);d(this,"polylines",[]);d(this,"rectangles",[]);d(this,"circles",[]);d(this,"arcs",[]);d(this,"texts",[]);d(this,"_sxPower");d(this,"_sxEmbeddedFonts");d(this,"_sxInstances");d(this,"_inlineLibId");t.libraryId!==void 0&&(this.libraryId=t.libraryId),t.at!==void 0&&(this.at=t.at),t.mirror!==void 0&&(this.mirror=t.mirror),t.unit!==void 0&&(this.unit=typeof t.unit=="number"?t.unit:t.unit.value),t.pinNumbers!==void 0&&(this.pinNumbers=t.pinNumbers),t.pinNames!==void 0&&(this.pinNames=t.pinNames),t.excludeFromSim!==void 0&&(this.excludeFromSim=t.excludeFromSim),t.inBom!==void 0&&(this.inBom=t.inBom),t.onBoard!==void 0&&(this.onBoard=t.onBoard),t.dnp!==void 0&&(this.dnp=t.dnp),t.uuid!==void 0&&(this.uuid=t.uuid),t.duplicatePinNumbersAreJumpers!==void 0&&(this.duplicatePinNumbersAreJumpers=t.duplicatePinNumbersAreJumpers),t.fieldsAutoplaced!==void 0&&(this.fieldsAutoplaced=t.fieldsAutoplaced),t.properties!==void 0&&(this.properties=t.properties),t.pins!==void 0&&(this.pins=t.pins),t.subSymbols!==void 0&&(this.subSymbols=t.subSymbols),t.polylines!==void 0&&(this.polylines=t.polylines),t.rectangles!==void 0&&(this.rectangles=t.rectangles),t.circles!==void 0&&(this.circles=t.circles),t.arcs!==void 0&&(this.arcs=t.arcs),t.texts!==void 0&&(this.texts=t.texts),t.embeddedFonts!==void 0&&(this._sxEmbeddedFonts=t.embeddedFonts),t.instances!==void 0&&(this.instances=t.instances)}get libraryId(){return this._sxLibId?.value??this._inlineLibId}set libraryId(t){if(t&&typeof t=="object"){this._sxLibId=t,this._inlineLibId=void 0;return}if(t===void 0||t===""){this._inlineLibId=void 0,this._sxLibId&&(this._sxLibId=void 0);return}this._inlineLibId=t,this._sxLibId=void 0}get at(){return this._sxAt}set at(t){this._sxAt=t!==void 0?Un.from(t):void 0}get mirror(){return this._sxMirror?.value}set mirror(t){if(t===void 0){this._sxMirror=void 0;return}this._sxMirror=t instanceof bO?t:new bO(t)}get unit(){return this._sxUnit?.value}set unit(t){this._sxUnit=t===void 0?void 0:iat.from(t)}get pinNumbers(){return this._sxPinNumbers}set pinNumbers(t){this._sxPinNumbers=t}get pinNames(){return this._sxPinNames}set pinNames(t){this._sxPinNames=t}get inBom(){return this._sxInBom?.value}set inBom(t){this._sxInBom=t===void 0?void 0:new g7(t)}get excludeFromSim(){return this._sxExcludeFromSim?.value??!1}set excludeFromSim(t){this._sxExcludeFromSim=new aT(t)}get onBoard(){return this._sxOnBoard?.value}set onBoard(t){this._sxOnBoard=t===void 0?void 0:new x7(t)}get dnp(){return this._sxDnp?.value??!1}set dnp(t){this._sxDnp=new b7(t)}get fieldsAutoplaced(){return this._sxFieldsAutoplaced?.value??!1}set fieldsAutoplaced(t){this._sxFieldsAutoplaced=new Tf(t)}get uuid(){return this._sxUuid?.value}set uuid(t){this._sxUuid=t===void 0?void 0:new Vt(t)}get duplicatePinNumbersAreJumpers(){return this._sxDuplicatePinNumbersAreJumpers?.value??!1}set duplicatePinNumbersAreJumpers(t){if(t===void 0){this._sxDuplicatePinNumbersAreJumpers=void 0;return}this._sxDuplicatePinNumbersAreJumpers=new rat(t)}get instances(){return this._sxInstances}set instances(t){this._sxInstances=t}static fromSexprPrimitives(t){let i=new Jd,r=t,s;if(r.length>0){let l=r[0];s=jt(l),s!==void 0&&(i._inlineLibId=s,r=r.slice(1))}let{propertyMap:o,arrayPropertyMap:a}=z.parsePrimitivesToClassProperties(r,this.token),c=o.lib_id;return c?i._sxLibId=c:s!==void 0&&(i._inlineLibId=s),i._sxAt=o.at,i._sxMirror=o.mirror,i._sxUnit=o.unit,i._sxPinNumbers=o.pin_numbers,i._sxPinNames=o.pin_names,i._sxExcludeFromSim=o.exclude_from_sim,i._sxInBom=o.in_bom,i._sxOnBoard=o.on_board,i._sxDnp=o.dnp,i._sxUuid=o.uuid,i._sxDuplicatePinNumbersAreJumpers=o.duplicate_pin_numbers_are_jumpers,i._sxFieldsAutoplaced=o.fields_autoplaced,i._sxPower=o.power,i._sxEmbeddedFonts=o.embedded_fonts,i.properties=a.property??[],i.pins=a.pin??[],i.subSymbols=a.symbol??[],i.polylines=a.polyline??[],i.rectangles=a.rectangle??[],i.circles=a.circle??[],i.arcs=a.arc??[],i.texts=a.text??[],i._sxInstances=o.instances,i}getChildren(){let t=[];return this._sxLibId&&t.push(this._sxLibId),this._sxAt&&t.push(this._sxAt),this._sxMirror&&t.push(this._sxMirror),this._sxUnit&&t.push(this._sxUnit),this._sxPinNumbers&&t.push(this._sxPinNumbers),this._sxPinNames&&t.push(this._sxPinNames),this._sxExcludeFromSim&&t.push(this._sxExcludeFromSim),this._sxInBom&&t.push(this._sxInBom),this._sxOnBoard&&t.push(this._sxOnBoard),this._sxDnp&&t.push(this._sxDnp),this._sxUuid&&t.push(this._sxUuid),this._sxDuplicatePinNumbersAreJumpers&&t.push(this._sxDuplicatePinNumbersAreJumpers),this._sxFieldsAutoplaced&&t.push(this._sxFieldsAutoplaced),t.push(...this.properties),t.push(...this.pins),t.push(...this.subSymbols),t.push(...this.polylines),t.push(...this.rectangles),t.push(...this.circles),t.push(...this.arcs),t.push(...this.texts),this._sxPower&&t.push(this._sxPower),this._sxEmbeddedFonts&&t.push(this._sxEmbeddedFonts),this._sxInstances&&t.push(this._sxInstances),t}getString(){let t=this._sxLibId?void 0:this.libraryId,i=t!==void 0&&t!==""?[`(symbol ${re(t)}`]:["(symbol"];for(let r of this.getChildren())i.push(r.getStringIndented());return i.push(")"),i.join(`
`)}},d(Jd,"token","symbol"),Jd);z.register(qjt);var nc,A0=(nc=class extends rn{constructor(){super(...arguments);d(this,"token","id")}static from(t){return t instanceof nc?t:new nc(t)}},d(nc,"token","id"),d(nc,"parentToken","property"),nc);z.register(A0);var Jl,Zjt=(Jl=class extends z{constructor(t){super();d(this,"token","property");d(this,"key");d(this,"value");d(this,"_sxId");d(this,"_sxAt");d(this,"_sxEffects");this.key=t.key,this.value=t.value,this._sxId=t.id!==void 0?A0.from(t.id):void 0,this._sxAt=t.at!==void 0?Un.from(t.at):void 0,this._sxEffects=t.effects}static fromSexprPrimitives(t){let[i,r,...s]=t,o=jt(i)??"",a=jt(r)??"",{propertyMap:c}=z.parsePrimitivesToClassProperties(s,this.token);return new Jl({key:o,value:a,id:c.id,at:c.at,effects:c.effects})}get id(){return this._sxId?.value}set id(t){this._sxId=t===void 0?void 0:A0.from(t)}get at(){return this._sxAt}set at(t){this._sxAt=t!==void 0?Un.from(t):void 0}get effects(){return this._sxEffects}set effects(t){this._sxEffects=t}getChildren(){let t=[];return this._sxId&&t.push(this._sxId),this._sxAt&&t.push(this._sxAt),this._sxEffects&&t.push(this._sxEffects),t}getString(){let t=[`(property ${re(this.key)} ${re(this.value)}`];return this._sxId&&t.push(...cc(this._sxId.getString())),this._sxAt&&t.push(...cc(this._sxAt.getString())),this._sxEffects&&t.push(...cc(this._sxEffects.getString())),t.push(")"),t.join(`
`)}},d(Jl,"token","property"),d(Jl,"parentToken","symbol"),Jl);z.register(Zjt);var Kjt=new Set(["input","output","bidirectional","tri_state","passive","free","unspecified","power_in","power_out","open_collector","open_emitter","no_connect"]),Jjt=new Set(["line","inverted","clock","inverted_clock","input_low","clock_low","output_low","edge_clock_high","non_logic"]),vk,cat=(vk=class extends rn{constructor(){super(...arguments);d(this,"token","length")}},d(vk,"token","length"),d(vk,"parentToken","pin"),vk);z.register(cat);var Ql,lat=(Ql=class extends z{constructor(t){super();d(this,"token","name");d(this,"value");d(this,"_sxEffects");this.value=t.value,this._sxEffects=t.effects}static fromSexprPrimitives(t){let[i,...r]=t,s=jt(i)??"",{propertyMap:o}=z.parsePrimitivesToClassProperties(r,this.token);return new Ql({value:s,effects:o.effects})}get effects(){return this._sxEffects}set effects(t){this._sxEffects=t}getChildren(){return this._sxEffects?[this._sxEffects]:[]}getString(){let t=[`(name ${re(this.value)}`];return this._sxEffects&&t.push(...cc(this._sxEffects.getString())),t.push(")"),t.join(`
`)}},d(Ql,"token","name"),d(Ql,"parentToken","pin"),Ql);z.register(lat);var tu,Qjt=(tu=class extends z{constructor(t){super();d(this,"token","number");d(this,"value");d(this,"_sxEffects");this.value=t.value,this._sxEffects=t.effects}static fromSexprPrimitives(t){let[i,...r]=t,s=jt(i)??"",{propertyMap:o}=z.parsePrimitivesToClassProperties(r,this.token);return new tu({value:s,effects:o.effects})}get effects(){return this._sxEffects}set effects(t){this._sxEffects=t}getChildren(){return this._sxEffects?[this._sxEffects]:[]}getString(){let t=[`(number ${re(this.value)}`];return this._sxEffects&&t.push(...cc(this._sxEffects.getString())),t.push(")"),t.join(`
`)}},d(tu,"token","number"),d(tu,"parentToken","pin"),tu);z.register(Qjt);var eu,tBt=(eu=class extends z{constructor(){super(...arguments);d(this,"token","pin");d(this,"pinElectricalType");d(this,"pinGraphicStyle");d(this,"_sxAt");d(this,"_sxLength");d(this,"_sxName");d(this,"_sxNumber");d(this,"_sxUuid");d(this,"inlineNumber");d(this,"_sxHide")}static fromSexprPrimitives(t){let i=new eu,r=0,s=t[0],o=jt(s);if(o&&Kjt.has(o)){i.pinElectricalType=o,r=1;let p=t[1],f=jt(p);f&&Jjt.has(f)&&(i.pinGraphicStyle=f,r=2)}else o!==void 0&&!Array.isArray(s)&&(i.inlineNumber=o,r=1);let a=t.slice(r),c=[],l=[];for(let p of a){if(typeof p=="string"){c.push(p);continue}l.push(p)}let{propertyMap:u}=z.parsePrimitivesToClassProperties(l,this.token);i._sxAt=u.at,i._sxLength=u.length,i._sxName=u.name,i._sxNumber=u.number,i._sxUuid=u.uuid,i._sxHide=u.hide;for(let p of c){if(p==="hide"){i._sxHide=new SO(!0,{inline:!0});continue}throw new Error(`symbol pin encountered unsupported flag "${p}"`)}return i}get at(){return this._sxAt}set at(t){this._sxAt=t!==void 0?Un.from(t):void 0}get length(){return this._sxLength?.value}set length(t){this._sxLength=t===void 0?void 0:new cat(t)}get name(){return this._sxName?.value}set name(t){if(t===void 0){this._sxName=void 0;return}this._sxName=new lat({value:t})}get numberString(){return this._sxNumber?.value??this.inlineNumber}set numberString(t){if(t===void 0){this._sxNumber=void 0,this.inlineNumber=void 0;return}this.inlineNumber=t,this._sxNumber=void 0}get uuid(){return this._sxUuid?.value}set uuid(t){this._sxUuid=t===void 0?void 0:new Vt(t)}get hidden(){return this._sxHide?.value??!1}set hidden(t){this._sxHide=t?new SO(t):void 0}getChildren(){let t=[];return this._sxAt&&t.push(this._sxAt),this._sxLength&&t.push(this._sxLength),this._sxName&&t.push(this._sxName),this._sxNumber&&t.push(this._sxNumber),this._sxUuid&&t.push(this._sxUuid),this._sxHide&&t.push(this._sxHide),t}getString(){if(this.pinElectricalType){let r=["(pin",this.pinElectricalType];this.pinGraphicStyle&&r.push(this.pinGraphicStyle);let s=[r.join(" ")];for(let o of this.getChildren())s.push(...cc(o.getString()));return s.push(")"),s.join(`
`)}let t=this.numberString??"",i=[`(pin ${re(t)}`];return this._sxUuid&&i.push(...cc(this._sxUuid.getString())),i.push(")"),i.join(`
`)}},d(eu,"token","pin"),d(eu,"parentToken","symbol"),eu);z.register(tBt);var nu,eBt=(nu=class extends z{constructor(){super(...arguments);d(this,"token","instances");d(this,"projects",[])}static fromSexprPrimitives(t){let i=new nu,{arrayPropertyMap:r}=z.parsePrimitivesToClassProperties(t,this.token);return i.projects=r.project??[],i}getChildren(){return[...this.projects]}getString(){let t=["(instances"];for(let i of this.projects)t.push(i.getStringIndented());return t.push(")"),t.join(`
`)}},d(nu,"token","instances"),d(nu,"parentToken","symbol"),nu);z.register(eBt);var Sk,SO=(Sk=class extends ti{constructor(e,t={}){super(e??!0);d(this,"token","hide");d(this,"inline",!1);this.inline=t.inline??!1}getString(){return this.inline?this.value?"hide":"(hide no)":this.value?"(hide yes)":"(hide no)"}},d(Sk,"token","hide"),d(Sk,"parentToken","pin"),Sk);z.register(SO);var iu,nBt=(iu=class extends z{constructor(t){super();d(this,"token","project");d(this,"name");d(this,"paths",[]);this.name=t}static fromSexprPrimitives(t){let[i,...r]=t,s=jt(i)??"",o=new iu(s),{arrayPropertyMap:a}=z.parsePrimitivesToClassProperties(r,this.token);return o.paths=a.path??[],o}getChildren(){return[...this.paths]}getString(){let t=[`(project ${re(this.name)}`];for(let i of this.paths)t.push(i.getStringIndented());return t.push(")"),t.join(`
`)}},d(iu,"token","project"),d(iu,"parentToken","instances"),iu);z.register(nBt);var ru,iBt=(ru=class extends z{constructor(t){super();d(this,"token","path");d(this,"value");d(this,"_sxReference");d(this,"_sxUnit");this.value=t}static fromSexprPrimitives(t){let[i,...r]=t,s=jt(i)??"",o=new ru(s),{propertyMap:a}=z.parsePrimitivesToClassProperties(r,this.token);return o._sxReference=a.reference,o._sxUnit=a.unit,o}get reference(){return this._sxReference?.value}set reference(t){this._sxReference=t===void 0?void 0:new uat(t)}get unit(){return this._sxUnit?.value}set unit(t){this._sxUnit=t===void 0?void 0:new pat(t)}getChildren(){let t=[];return this._sxReference&&t.push(this._sxReference),this._sxUnit&&t.push(this._sxUnit),t}getString(){let t=[`(path ${re(this.value)}`];for(let i of this.getChildren())t.push(i.getStringIndented());return t.push(")"),t.join(`
`)}},d(ru,"token","path"),d(ru,"parentToken","project"),ru);z.register(iBt);var su,uat=(su=class extends z{constructor(t){super();d(this,"token","reference");d(this,"value");this.value=t}static fromSexprPrimitives(t){let[i]=t;return new su(jt(i)??"")}getString(){return`(reference ${re(this.value)})`}},d(su,"token","reference"),d(su,"parentToken","path"),su);z.register(uat);var wk,pat=(wk=class extends rn{constructor(){super(...arguments);d(this,"token","unit")}},d(wk,"token","unit"),d(wk,"parentToken","path"),wk);z.register(pat);var hot=new Set(["symbol"]),ou,rBt=(ou=class extends z{constructor(){super(...arguments);d(this,"token","lib_symbols");d(this,"_symbols",[])}static fromSexprPrimitives(t){let i=new ou,{propertyMap:r,arrayPropertyMap:s}=z.parsePrimitivesToClassProperties(t,this.token),o=Object.keys(r).filter(l=>!hot.has(l));if(o.length>0)throw new Error(`Unsupported child tokens inside lib_symbols expression: ${o.join(", ")}`);let a=Object.keys(s).filter(l=>!hot.has(l));if(a.length>0)throw new Error(`Unsupported repeated child tokens inside lib_symbols expression: ${a.join(", ")}`);let c=s.symbol??[];return!c.length&&r.symbol&&c.push(r.symbol),i._symbols=c,i}get symbols(){return[...this._symbols]}set symbols(t){this._symbols=[...t]}getChildren(){return[...this._symbols]}},d(ou,"token","lib_symbols"),d(ou,"parentToken","kicad_sch"),ou);z.register(rBt);var dot=new Set(["pts","stroke","uuid"]),au,sBt=(au=class extends z{constructor(t={}){super();d(this,"token","wire");d(this,"_sxPts");d(this,"_sxStroke");d(this,"_sxUuid");t.points!==void 0&&(this.points=t.points),t.stroke!==void 0&&(this.stroke=t.stroke),t.uuid!==void 0&&(this.uuid=t.uuid)}static fromSexprPrimitives(t){let i=new au,{propertyMap:r,arrayPropertyMap:s}=z.parsePrimitivesToClassProperties(t,this.token);for(let[a,c]of Object.entries(s)){if(!dot.has(a))throw new Error(`Unsupported child tokens inside wire expression: ${a}`);if(c.length>1)throw new Error(`wire does not support repeated child tokens: ${a}`)}let o=Object.keys(r).filter(a=>!dot.has(a));if(o.length>0)throw new Error(`Unsupported child tokens inside wire expression: ${o.join(", ")}`);return i._sxPts=s.pts?.[0]??r.pts,i._sxStroke=r.stroke,i._sxUuid=r.uuid,i}get points(){return this._sxPts}set points(t){this._sxPts=t}get stroke(){return this._sxStroke}set stroke(t){this._sxStroke=t}get uuid(){return this._sxUuid}set uuid(t){if(t===void 0){this._sxUuid=void 0;return}this._sxUuid=t instanceof Vt?t:new Vt(t)}getChildren(){let t=[];return this._sxPts&&t.push(this._sxPts),this._sxStroke&&t.push(this._sxStroke),this._sxUuid&&t.push(this._sxUuid),t}},d(au,"token","wire"),d(au,"parentToken","kicad_sch"),au);z.register(sBt);var oBt=new Set(["pts","stroke","uuid"]),cu,aBt=(cu=class extends z{constructor(t={}){super();d(this,"token","bus");d(this,"_sxPts");d(this,"_sxStroke");d(this,"_sxUuid");t.points!==void 0&&(this.points=t.points),t.stroke!==void 0&&(this.stroke=t.stroke),t.uuid!==void 0&&(this.uuid=t.uuid)}static fromSexprPrimitives(t){let i=new cu,{propertyMap:r,arrayPropertyMap:s}=z.parsePrimitivesToClassProperties(t,this.token);if(Object.keys(s).length>0){let a=Object.keys(s).join(", ");throw new Error(`bus does not support repeated child tokens: ${a}`)}let o=Object.keys(r).filter(a=>!oBt.has(a));if(o.length>0)throw new Error(`Unsupported child tokens inside bus expression: ${o.join(", ")}`);return i._sxPts=r.pts,i._sxStroke=r.stroke,i._sxUuid=r.uuid,i}get points(){return this._sxPts}set points(t){this._sxPts=t}get stroke(){return this._sxStroke}set stroke(t){this._sxStroke=t}get uuid(){return this._sxUuid}set uuid(t){if(t===void 0){this._sxUuid=void 0;return}this._sxUuid=t instanceof Vt?t:new Vt(t)}getChildren(){let t=[];return this._sxPts&&t.push(this._sxPts),this._sxStroke&&t.push(this._sxStroke),this._sxUuid&&t.push(this._sxUuid),t}},d(cu,"token","bus"),d(cu,"parentToken","kicad_sch"),cu);z.register(aBt);var lu,cBt=(lu=class extends z{constructor(t={}){super();d(this,"token","junction");d(this,"_sxAt");d(this,"_sxDiameter");d(this,"_sxColor");d(this,"_sxUuid");t.at!==void 0&&(this.at=t.at),t.diameter!==void 0&&(t.diameter instanceof tT?this._sxDiameter=t.diameter:this.diameter=t.diameter),t.color!==void 0&&(this.color=t.color),t.uuid!==void 0&&(this.uuid=t.uuid)}static fromSexprPrimitives(t){let i=new lu;for(let r of t){if(!Array.isArray(r)||r.length===0)throw new Error(`junction encountered invalid child expression: ${JSON.stringify(r)}`);let s=z.parsePrimitiveSexpr(r,{parentToken:this.token});if(!(s instanceof z))throw new Error(`junction child did not resolve to an SxClass: ${JSON.stringify(r)}`);if(s instanceof Un){if(i._sxAt)throw new Error("junction encountered duplicate at tokens");i._sxAt=s;continue}if(s instanceof tT){if(i._sxDiameter)throw new Error("junction encountered duplicate diameter tokens");i._sxDiameter=s;continue}if(s instanceof y7){if(i._sxColor)throw new Error("junction encountered duplicate color tokens");i._sxColor=s;continue}if(s instanceof Vt){if(i._sxUuid)throw new Error("junction encountered duplicate uuid tokens");i._sxUuid=s;continue}throw new Error(`Unsupported child tokens inside junction expression: ${s.token}`)}return i}get at(){return this._sxAt}set at(t){this._sxAt=t!==void 0?Un.from(t):void 0}get diameter(){return this._sxDiameter?.value}set diameter(t){this._sxDiameter=t===void 0?void 0:new tT(t)}get color(){return this._sxColor}set color(t){this._sxColor=t}get uuid(){return this._sxUuid}set uuid(t){if(t===void 0){this._sxUuid=void 0;return}this._sxUuid=t instanceof Vt?t:new Vt(t)}getChildren(){let t=[];return this._sxAt&&t.push(this._sxAt),this._sxDiameter&&t.push(this._sxDiameter),this._sxColor&&t.push(this._sxColor),this._sxUuid&&t.push(this._sxUuid),t}},d(lu,"token","junction"),d(lu,"parentToken","kicad_sch"),lu);z.register(cBt);var Pk,tT=(Pk=class extends rn{constructor(){super(...arguments);d(this,"token","diameter")}},d(Pk,"token","diameter"),d(Pk,"parentToken","junction"),Pk);z.register(tT);var fot=new Set(["at","uuid"]),uu,lBt=(uu=class extends z{constructor(t={}){super();d(this,"token","no_connect");d(this,"_sxAt");d(this,"_sxUuid");t.at!==void 0&&(this.at=t.at),t.uuid!==void 0&&(this.uuid=t.uuid)}static fromSexprPrimitives(t){let i=new uu,{propertyMap:r,arrayPropertyMap:s}=z.parsePrimitivesToClassProperties(t,this.token);for(let a of Object.keys(s))if(fot.has(a)&&s[a].length>1)throw new Error(`no_connect does not support repeated child tokens: ${a}`);let o=Object.keys(r).filter(a=>!fot.has(a));if(o.length>0)throw new Error(`Unsupported child tokens inside no_connect expression: ${o.join(", ")}`);return i._sxAt=r.at,i._sxUuid=r.uuid,i}get at(){return this._sxAt}set at(t){this._sxAt=t!==void 0?Un.from(t):void 0}get uuid(){return this._sxUuid}set uuid(t){if(t===void 0){this._sxUuid=void 0;return}this._sxUuid=t instanceof Vt?t:new Vt(t)}getChildren(){let t=[];return this._sxAt&&t.push(this._sxAt),this._sxUuid&&t.push(this._sxUuid),t}},d(uu,"token","no_connect"),d(uu,"parentToken","kicad_sch"),uu);z.register(lBt);var uBt=new Set(["at","size","stroke","uuid"]),pu,pBt=(pu=class extends z{constructor(t={}){super();d(this,"token","bus_entry");d(this,"_sxAt");d(this,"_sxSize");d(this,"_sxStroke");d(this,"_sxUuid");t.at!==void 0&&(this.at=t.at),t.size!==void 0&&(this.size=t.size),t.stroke!==void 0&&(this.stroke=t.stroke),t.uuid!==void 0&&(this.uuid=t.uuid)}static fromSexprPrimitives(t){let i=new pu,{propertyMap:r,arrayPropertyMap:s}=z.parsePrimitivesToClassProperties(t,this.token);if(Object.keys(s).length>0){let a=Object.keys(s).join(", ");throw new Error(`bus_entry does not support repeated child tokens: ${a}`)}let o=Object.keys(r).filter(a=>!uBt.has(a));if(o.length>0)throw new Error(`Unsupported child tokens inside bus_entry expression: ${o.join(", ")}`);return i._sxAt=r.at,i._sxSize=r.size,i._sxStroke=r.stroke,i._sxUuid=r.uuid,i}get at(){return this._sxAt}set at(t){this._sxAt=t!==void 0?Un.from(t):void 0}get size(){return this._sxSize?.toObject()}set size(t){if(t===void 0){this._sxSize=void 0;return}if(t instanceof wO){this._sxSize=t;return}this._sxSize=new wO(t.x,t.y)}get stroke(){return this._sxStroke}set stroke(t){this._sxStroke=t}get uuid(){return this._sxUuid}set uuid(t){if(t===void 0){this._sxUuid=void 0;return}this._sxUuid=t instanceof Vt?t:new Vt(t)}getChildren(){let t=[];return this._sxAt&&t.push(this._sxAt),this._sxSize&&t.push(this._sxSize),this._sxStroke&&t.push(this._sxStroke),this._sxUuid&&t.push(this._sxUuid),t}},d(pu,"token","bus_entry"),d(pu,"parentToken","kicad_sch"),pu);z.register(pBt);var hu,wO=(hu=class extends z{constructor(t,i){super();d(this,"token","size");d(this,"_x");d(this,"_y");this._x=t,this._y=i}static fromSexprPrimitives(t){let[i,r]=t;if(typeof i!="number"||typeof r!="number")throw new Error("bus_entry size expects two numeric arguments");return new hu(i,r)}toObject(){return{x:this._x,y:this._y}}getChildren(){return[]}getString(){return`(size ${this._x} ${this._y})`}},d(hu,"token","size"),d(hu,"parentToken","bus_entry"),hu);z.register(wO);var mot=new Set(["at","effects","uuid","fields_autoplaced"]),du,hBt=(du=class extends z{constructor(t={}){super();d(this,"token","label");d(this,"_value","");d(this,"_sxAt");d(this,"_sxEffects");d(this,"_sxUuid");d(this,"_sxFieldsAutoplaced");t.value!==void 0&&(this.value=t.value),t.at!==void 0&&(this.at=t.at),t.effects!==void 0&&(this.effects=t.effects),t.uuid!==void 0&&(this.uuid=t.uuid),t.fieldsAutoplaced!==void 0&&(t.fieldsAutoplaced instanceof Tf?this._sxFieldsAutoplaced=t.fieldsAutoplaced:this.fieldsAutoplaced=t.fieldsAutoplaced)}static fromSexprPrimitives(t){let[i,...r]=t,s=jt(i);if(s===void 0)throw new Error("label expects a string value");let o=new du;o._value=s;let{propertyMap:a,arrayPropertyMap:c}=z.parsePrimitivesToClassProperties(r,this.token),l=Object.keys(a).filter(u=>!mot.has(u));if(l.length>0)throw new Error(`Unsupported child tokens inside label expression: ${l.join(", ")}`);for(let[u,p]of Object.entries(c)){if(!mot.has(u))throw new Error(`Unsupported child tokens inside label expression: ${u}`);if(p.length>1)throw new Error(`label does not support repeated child tokens: ${u}`)}return o._sxAt=c.at?.[0]??a.at,o._sxEffects=c.effects?.[0]??a.effects,o._sxUuid=c.uuid?.[0]??a.uuid,o._sxFieldsAutoplaced=c.fields_autoplaced?.[0]??a.fields_autoplaced,o}get value(){return this._value}set value(t){this._value=t}get at(){return this._sxAt}set at(t){this._sxAt=t!==void 0?Un.from(t):void 0}get effects(){return this._sxEffects}set effects(t){this._sxEffects=t}get uuid(){return this._sxUuid}set uuid(t){if(t===void 0){this._sxUuid=void 0;return}this._sxUuid=t instanceof Vt?t:new Vt(t)}get fieldsAutoplaced(){return this._sxFieldsAutoplaced?.value??!1}set fieldsAutoplaced(t){this._sxFieldsAutoplaced=new Tf(t)}getChildren(){let t=[];return this._sxAt&&t.push(this._sxAt),this._sxEffects&&t.push(this._sxEffects),this._sxUuid&&t.push(this._sxUuid),this._sxFieldsAutoplaced&&t.push(this._sxFieldsAutoplaced),t}getString(){let t=[`(label ${re(this._value)}`];for(let i of this.getChildren())t.push(i.getStringIndented());return t.push(")"),t.join(`
`)}},d(du,"token","label"),d(du,"parentToken","kicad_sch"),du);z.register(hBt);var kk,PO=(kk=class extends ti{constructor(){super(...arguments);d(this,"token","hide")}},d(kk,"token","hide"),d(kk,"parentToken","property"),kk);z.register(PO);var Tk,kO=(Tk=class extends ti{constructor(){super(...arguments);d(this,"token","unlocked")}},d(Tk,"token","unlocked"),d(Tk,"parentToken","property"),Tk);z.register(kO);var _ot=new Set(["at","xy","layer","uuid","effects","unlocked","hide"]),dBt=(n,e)=>{let t=n[e];if(t&&t.length>1)throw new Error(`property does not support repeated "${e}" children`)},yot=n=>{if(n===void 0)return;let e=jt(n);return e!==void 0?e:Wi(n)},Qd,hat=(Qd=class extends z{constructor(t={},i=""){super();d(this,"token","property");d(this,"_key","");d(this,"_value","");d(this,"_sxAt");d(this,"_sxXy");d(this,"_sxLayer");d(this,"_sxUuid");d(this,"_sxEffects");d(this,"_sxUnlocked");d(this,"_sxHide");if(typeof t=="string")this._key=t,this._value=i;else{let r=t;r.key!==void 0&&(this._key=r.key),r.value!==void 0&&(this._value=r.value),r.position!==void 0&&(this.position=r.position),r.layer!==void 0&&(this.layer=r.layer),r.uuid!==void 0&&(this.uuid=r.uuid),r.effects!==void 0&&(this.effects=r.effects),r.unlocked!==void 0&&(r.unlocked instanceof kO?this._sxUnlocked=r.unlocked:this.unlocked=r.unlocked),r.hidden!==void 0&&(r.hidden instanceof PO?this._sxHide=r.hidden:this.hidden=r.hidden)}}static fromSexprPrimitives(t){if(t.length<2)throw new Error("property requires key and value arguments");let[i,r,...s]=t,o=yot(i),a=yot(r);if(o===void 0)throw new Error("property key must be a printable value");if(a===void 0)throw new Error("property value must be a printable value");for(let y of s){if(!Array.isArray(y))throw new Error(`property encountered unexpected primitive child: ${JSON.stringify(y)}`);if(y.length===0||typeof y[0]!="string")throw new Error(`property encountered invalid child expression: ${JSON.stringify(y)}`)}let c=new Qd(o,a),{propertyMap:l,arrayPropertyMap:u}=z.parsePrimitivesToClassProperties(s,this.token);for(let y of Object.keys(l))if(!_ot.has(y))throw new Error(`property encountered unsupported child token "${y}"`);for(let y of Object.keys(u)){if(!_ot.has(y))throw new Error(`property encountered unsupported child token "${y}"`);dBt(u,y)}let p=l.at,f=l.xy;if(p&&f)throw new Error("property can't include both at and xy children");return c._sxAt=p,c._sxXy=f,c._sxLayer=l.layer,c._sxUuid=l.uuid,c._sxEffects=l.effects,c._sxUnlocked=l.unlocked,c._sxHide=l.hide,c}get key(){return this._key}set key(t){this._key=t}get value(){return this._value}set value(t){this._value=t}get position(){return this._sxAt??this._sxXy}set position(t){if(t===void 0){this._sxAt=void 0,this._sxXy=void 0;return}if(t instanceof Zr){this._sxXy=t,this._sxAt=void 0;return}this._sxAt=Un.from(t),this._sxXy=void 0}get layer(){return this._sxLayer}set layer(t){if(t===void 0){this._sxLayer=void 0;return}if(t instanceof qe){this._sxLayer=t;return}let i=Array.isArray(t)?t:[t];this._sxLayer=new qe(i)}get uuid(){return this._sxUuid}set uuid(t){if(t===void 0){this._sxUuid=void 0;return}this._sxUuid=t instanceof Vt?t:new Vt(t)}get effects(){return this._sxEffects}set effects(t){this._sxEffects=t}get unlocked(){return this._sxUnlocked?.value??!1}set unlocked(t){this._sxUnlocked=new kO(t)}get hidden(){return this._sxHide?.value??!1}set hidden(t){this._sxHide=new PO(t)}getChildren(){let t=[];return this._sxAt&&t.push(this._sxAt),this._sxXy&&t.push(this._sxXy),this._sxUnlocked&&t.push(this._sxUnlocked),this._sxLayer&&t.push(this._sxLayer),this._sxHide&&t.push(this._sxHide),this._sxUuid&&t.push(this._sxUuid),this._sxEffects&&t.push(this._sxEffects),t}getString(){let t=[`(property ${re(this._key)} ${re(this._value)}`];for(let i of this.getChildren())t.push(i.getStringIndented());return t.push(")"),t.join(`
`)}},d(Qd,"token","property"),Qd);z.register(hat);var got=new Set(["shape","at","effects","uuid","fields_autoplaced","property"]),fu,fBt=(fu=class extends z{constructor(t={}){super();d(this,"token","global_label");d(this,"_value","");d(this,"_shape","input");d(this,"_sxAt");d(this,"_sxEffects");d(this,"_sxUuid");d(this,"_sxFieldsAutoplaced");d(this,"_properties",[]);t.value!==void 0&&(this.value=t.value),t.shape!==void 0&&(this.shape=t.shape),t.at!==void 0&&(this.at=t.at),t.effects!==void 0&&(this.effects=t.effects),t.uuid!==void 0&&(this.uuid=t.uuid),t.fieldsAutoplaced!==void 0&&(t.fieldsAutoplaced instanceof Tf?this._sxFieldsAutoplaced=t.fieldsAutoplaced:this.fieldsAutoplaced=t.fieldsAutoplaced),t.properties!==void 0&&(this.properties=t.properties)}static fromSexprPrimitives(t){let[i,...r]=t,s=jt(i);if(s===void 0)throw new Error("global_label expects a string value");let o=new fu;o._value=s;let a=-1;for(let f=0;f<r.length;f++){let y=r[f];if(Array.isArray(y)&&y[0]==="shape"&&y.length===2){a=f;let g=jt(y[1]);g&&(o._shape=g);break}}let c=a>=0?r.filter((f,y)=>y!==a):r,{propertyMap:l,arrayPropertyMap:u}=z.parsePrimitivesToClassProperties(c,this.token),p=Object.keys(l).filter(f=>!got.has(f));if(p.length>0)throw new Error(`Unsupported child tokens inside global_label expression: ${p.join(", ")}`);for(let[f,y]of Object.entries(u)){if(!got.has(f))throw new Error(`Unsupported child tokens inside global_label expression: ${f}`);if(f!=="property"&&y.length>1)throw new Error(`global_label does not support repeated child tokens: ${f}`)}return o._sxAt=u.at?.[0]??l.at,o._sxEffects=u.effects?.[0]??l.effects,o._sxUuid=u.uuid?.[0]??l.uuid,o._sxFieldsAutoplaced=u.fields_autoplaced?.[0]??l.fields_autoplaced,o._properties=u.property??[],o}get value(){return this._value}set value(t){this._value=t}get shape(){return this._shape}set shape(t){this._shape=t}get at(){return this._sxAt}set at(t){this._sxAt=t!==void 0?Un.from(t):void 0}get effects(){return this._sxEffects}set effects(t){this._sxEffects=t}get uuid(){return this._sxUuid}set uuid(t){if(t===void 0){this._sxUuid=void 0;return}this._sxUuid=t instanceof Vt?t:new Vt(t)}get fieldsAutoplaced(){return this._sxFieldsAutoplaced?.value??!1}set fieldsAutoplaced(t){this._sxFieldsAutoplaced=new Tf(t)}get properties(){return[...this._properties]}set properties(t){this._properties=[...t]}getChildren(){let t=[];return this._sxAt&&t.push(this._sxAt),this._sxEffects&&t.push(this._sxEffects),this._sxUuid&&t.push(this._sxUuid),t.push(...this._properties),this._sxFieldsAutoplaced&&t.push(this._sxFieldsAutoplaced),t}getString(){let t=[`(global_label ${re(this._value)}`];t.push(`  (shape ${this._shape})`);for(let i of this.getChildren())t.push(i.getStringIndented());return t.push(")"),t.join(`
`)}},d(fu,"token","global_label"),d(fu,"parentToken","kicad_sch"),fu);z.register(fBt);var xot=new Set(["exclude_from_sim","at","effects","uuid"]),mu,mBt=(mu=class extends z{constructor(t={}){super();d(this,"token","text");d(this,"_value","");d(this,"_sxExcludeFromSim");d(this,"_sxAt");d(this,"_sxEffects");d(this,"_sxUuid");t.value!==void 0&&(this.value=t.value),t.excludeFromSim!==void 0&&(this.excludeFromSim=typeof t.excludeFromSim=="boolean"?t.excludeFromSim:t.excludeFromSim.value),t.at!==void 0&&(this.at=t.at),t.effects!==void 0&&(this.effects=t.effects),t.uuid!==void 0&&(this.uuid=t.uuid)}static fromSexprPrimitives(t){let[i,...r]=t,s=jt(i);if(s===void 0)throw new Error("text expects a string value");let o=new mu;o._value=s;let{propertyMap:a,arrayPropertyMap:c}=z.parsePrimitivesToClassProperties(r,this.token),l=Object.keys(a).filter(u=>!xot.has(u));if(l.length>0)throw new Error(`Unsupported child tokens inside text expression: ${l.join(", ")}`);for(let[u,p]of Object.entries(c)){if(!xot.has(u))throw new Error(`Unsupported child tokens inside text expression: ${u}`);if(p.length>1)throw new Error(`text does not support repeated child tokens: ${u}`)}return o._sxExcludeFromSim=c.exclude_from_sim?.[0]??a.exclude_from_sim,o._sxAt=c.at?.[0]??a.at,o._sxEffects=c.effects?.[0]??a.effects,o._sxUuid=c.uuid?.[0]??a.uuid,o}get value(){return this._value}set value(t){this._value=t}get excludeFromSim(){return this._sxExcludeFromSim?.value??!1}set excludeFromSim(t){this._sxExcludeFromSim=t?new aT(!0):void 0}get at(){return this._sxAt}set at(t){this._sxAt=t!==void 0?Un.from(t):void 0}get effects(){return this._sxEffects}set effects(t){this._sxEffects=t}get uuid(){return this._sxUuid}set uuid(t){if(t===void 0){this._sxUuid=void 0;return}this._sxUuid=t instanceof Vt?t:new Vt(t)}getChildren(){let t=[];return this._sxExcludeFromSim&&t.push(this._sxExcludeFromSim),this._sxAt&&t.push(this._sxAt),this._sxEffects&&t.push(this._sxEffects),this._sxUuid&&t.push(this._sxUuid),t}getString(){let t=[`(text ${re(this._value)}`];for(let i of this.getChildren())t.push(i.getStringIndented());return t.push(")"),t.join(`
`)}},d(mu,"token","text"),d(mu,"parentToken","kicad_sch"),mu);z.register(mBt);var bot=new Set(["page"]),tf,_Bt=(tf=class extends z{constructor(){super(...arguments);d(this,"token","sheet_instances");d(this,"_paths",[])}static fromSexprPrimitives(t){let i=new tf,{propertyMap:r,arrayPropertyMap:s}=z.parsePrimitivesToClassProperties(t,this.token),o=Object.keys(r).filter(l=>l!=="path");if(o.length>0)throw new Error(`Unsupported singular child tokens inside sheet_instances expression: ${o.join(", ")}`);let a=Object.keys(s).filter(l=>l!=="path");if(a.length>0)throw new Error(`Unsupported repeated child tokens inside sheet_instances expression: ${a.join(", ")}`);let c=s.path??[];return!c.length&&r.path&&c.push(r.path),i._paths=c,i}get paths(){return[...this._paths]}set paths(t){this._paths=[...t]}getChildren(){return[...this._paths]}},d(tf,"token","sheet_instances"),tf);z.register(_Bt);var _u,yBt=(_u=class extends z{constructor(){super(...arguments);d(this,"token","path");d(this,"_value","");d(this,"_pages",[])}static fromSexprPrimitives(t){let[i,...r]=t,s=jt(i);if(s===void 0)throw new Error("sheet_instances path requires a string identifier");let o=new _u;o._value=s;let{propertyMap:a,arrayPropertyMap:c}=z.parsePrimitivesToClassProperties(r,"sheet_instances_path"),l=Object.keys(a).filter(f=>!bot.has(f));if(l.length>0)throw new Error(`Unsupported singular child tokens inside sheet_instances path expression: ${l.join(", ")}`);let u=Object.keys(c).filter(f=>!bot.has(f));if(u.length>0)throw new Error(`Unsupported repeated child tokens inside sheet_instances path expression: ${u.join(", ")}`);let p=c.page??[];return!p.length&&a.page&&p.push(a.page),o._pages=p,o}get value(){return this._value}set value(t){this._value=t}get pages(){return[...this._pages]}set pages(t){this._pages=[...t]}getChildren(){return[...this._pages]}getString(){let t=[`(path ${re(this._value)}`];for(let i of this._pages)t.push(i.getStringIndented());return t.push(")"),t.join(`
`)}},d(_u,"token","path"),d(_u,"parentToken","sheet_instances"),_u);z.register(yBt);var yu,gBt=(yu=class extends bo{constructor(){super(...arguments);d(this,"token","page")}static fromSexprPrimitives(t){let[i]=t,r=jt(i);if(r===void 0)throw new Error("sheet_instances page expects a string value");return new yu(r)}getString(){return`(page ${re(this.value)})`}},d(yu,"token","page"),d(yu,"parentToken","sheet_instances_path"),yu);z.register(gBt);var vot=new Set(["project","path"]),dat=n=>{let{propertyMap:e,arrayPropertyMap:t}=z.parsePrimitivesToClassProperties(n,"sheet_instances"),i=Object.keys(e).filter(a=>!vot.has(a));if(i.length>0)throw new Error(`sheet_instances encountered unsupported child token${i.length>1?"s":""} ${i.map(a=>`"${a}"`).join(", ")}`);let r=Object.keys(t).filter(a=>!vot.has(a));if(r.length>0)throw new Error(`sheet_instances encountered unsupported repeated child token${r.length>1?"s":""} ${r.map(a=>`"${a}"`).join(", ")}`);let s=t.project??[];!s.length&&e.project&&s.push(e.project);let o=t.path??[];return!o.length&&e.path&&o.push(e.path),{projects:s,paths:o}},gu,fat=(gu=class extends z{constructor(){super(...arguments);d(this,"token","sheet_instances");d(this,"_projects",[]);d(this,"_paths",[])}static fromSexprPrimitives(t){let i=new gu,{projects:r,paths:s}=dat(t);return i.projects=r,i.paths=s,i}get projects(){return[...this._projects]}set projects(t){this._projects=[...t]}get paths(){return[...this._paths]}set paths(t){this._paths=[...t]}getChildren(){return[...this._projects,...this._paths]}getString(){let t=this.getChildren();if(t.length===0)return`(${this.token})`;let i=[`(${this.token}`];for(let r of t)i.push(r.getStringIndented());return i.push(")"),i.join(`
`)}},d(gu,"token","sheet_instances"),d(gu,"parentToken","kicad_sch"),gu);z.register(fat);var xu,xBt=(xu=class extends fat{constructor(){super(...arguments);d(this,"token","instances")}static fromSexprPrimitives(t){let i=new xu,{projects:r,paths:s}=dat(t);return i.projects=r,i.paths=s,i}},d(xu,"token","instances"),d(xu,"parentToken","sheet"),xu);z.register(xBt);var bu,bBt=(bu=class extends z{constructor(t){super();d(this,"token","project");d(this,"name");d(this,"paths",[]);this.name=t}static fromSexprPrimitives(t){let[i,...r]=t,s=jt(i);if(s===void 0)throw new Error("sheet project instances require a project name");let o=new bu(s),{arrayPropertyMap:a}=z.parsePrimitivesToClassProperties(r,"sheet_project");return o.paths=a.path??[],o}getChildren(){return[...this.paths]}getString(){let t=[`(project ${re(this.name)}`];for(let i of this.paths)t.push(i.getStringIndented());return t.push(")"),t.join(`
`)}},d(bu,"token","project"),d(bu,"parentToken","sheet_instances"),bu);z.register(bBt);var vu,vBt=(vu=class extends z{constructor(t){super();d(this,"token","path");d(this,"value");d(this,"pages",[]);this.value=t}static fromSexprPrimitives(t){let[i,...r]=t,s=jt(i);if(s===void 0)throw new Error("sheet instance path value must be a string");let o=new vu(s),{arrayPropertyMap:a}=z.parsePrimitivesToClassProperties(r,"sheet_path");return o.pages=a.page??[],o}getChildren(){return[...this.pages]}getString(){let t=[`(path ${re(this.value)}`];for(let i of this.pages)t.push(i.getStringIndented());return t.push(")"),t.join(`
`)}},d(vu,"token","path"),d(vu,"parentToken","sheet_project"),vu);z.register(vBt);var Su,SBt=(Su=class extends z{constructor(t){super();d(this,"token","page");d(this,"value");this.value=t}static fromSexprPrimitives(t){let[i]=t,r=jt(i);if(r===void 0)throw new Error("sheet instance page value must be a string");return new Su(r)}getString(){return`(page ${re(this.value)})`}},d(Su,"token","page"),d(Su,"parentToken","sheet_path"),Su);z.register(SBt);var Sot=new Set(["input","output","bidirectional","tri_state","passive"]),wu,wBt=(wu=class extends z{constructor(){super(...arguments);d(this,"token","pin");d(this,"name","");d(this,"electricalType","input");d(this,"_sxAt");d(this,"_sxEffects");d(this,"_sxUuid")}static fromSexprPrimitives(t){if(t.length<2)throw new Error("sheet pin requires a name and electrical type");let[i,r,...s]=t,o=jt(i);if(o===void 0)throw new Error("sheet pin name must be a string");let a=jt(r);if(!a||!Sot.has(a))throw new Error(`sheet pin electrical type must be one of: ${Array.from(Sot).join(", ")}`);let c=new wu;c.name=o,c.electricalType=a;let{propertyMap:l}=z.parsePrimitivesToClassProperties(s,this.token);return c._sxAt=l.at,c._sxEffects=l.effects,c._sxUuid=l.uuid,c}get position(){return this._sxAt}set position(t){this._sxAt=t}get effects(){return this._sxEffects}set effects(t){this._sxEffects=t}get uuid(){return this._sxUuid}set uuid(t){if(t===void 0){this._sxUuid=void 0;return}this._sxUuid=t instanceof Vt?t:new Vt(t)}getChildren(){let t=[];return this._sxAt&&t.push(this._sxAt),this._sxEffects&&t.push(this._sxEffects),this._sxUuid&&t.push(this._sxUuid),t}getString(){let t=`(pin ${re(this.name)} ${this.electricalType}`,i=this.getChildren().flatMap(r=>cc(r.getString()));return i.length===0?`${t})`:[t,...i,")"].join(`
`)}},d(wu,"token","pin"),d(wu,"parentToken","sheet"),wu);z.register(wBt);var Pu,PBt=(Pu=class extends z{constructor(){super(...arguments);d(this,"token","fill");d(this,"_sxColor")}static fromSexprPrimitives(t){let i=new Pu,{propertyMap:r}=z.parsePrimitivesToClassProperties(t,this.token);return i._sxColor=r.color,i}get color(){return this._sxColor}set color(t){this._sxColor=t}getChildren(){return this._sxColor?[this._sxColor]:[]}},d(Pu,"token","fill"),d(Pu,"parentToken","sheet"),Pu);z.register(PBt);var ku,TO=(ku=class extends z{constructor(t,i){super();d(this,"token","size");d(this,"width");d(this,"height");this.width=t,this.height=i}static fromSexprPrimitives(t){let i=Dt(t[0]),r=Dt(t[1]);if(i===void 0||r===void 0)throw new Error("sheet size requires numeric width and height");return new ku(i,r)}toObject(){return{width:this.width,height:this.height}}getString(){return`(size ${this.width} ${this.height})`}},d(ku,"token","size"),d(ku,"parentToken","sheet"),ku);z.register(TO);var Tu,kBt=(Tu=class extends z{constructor(t){super();d(this,"token","property");d(this,"key");d(this,"value");d(this,"_sxId");d(this,"_sxAt");d(this,"_sxEffects");this.key=t.key,this.value=t.value,this.id=t.id,this.at=t.at,this.effects=t.effects}static fromSexprPrimitives(t){let[i,r,...s]=t,o=jt(i),a=jt(r);if(o===void 0||a===void 0)throw new Error("sheet property requires string key and value");let{propertyMap:c}=z.parsePrimitivesToClassProperties(s,this.token);return new Tu({key:o,value:a,id:c.id,at:c.at,effects:c.effects})}get id(){return this._sxId?.value}set id(t){if(t===void 0){this._sxId=void 0;return}this._sxId=t instanceof A0?t:new A0(t)}get idClass(){return this._sxId}get at(){return this._sxAt}set at(t){this._sxAt=t}get effects(){return this._sxEffects}set effects(t){this._sxEffects=t}getChildren(){let t=[];return this._sxId&&t.push(this._sxId),this._sxAt&&t.push(this._sxAt),this._sxEffects&&t.push(this._sxEffects),t}getString(){let t=`(property ${re(this.key)} ${re(this.value)}`,i=this.getChildren().flatMap(r=>cc(r.getString()));return i.length===0?`${t})`:[t,...i,")"].join(`
`)}},d(Tu,"token","property"),d(Tu,"parentToken","sheet"),Tu);z.register(kBt);var ef,TBt=(ef=class extends z{constructor(t={}){super();d(this,"token","sheet");d(this,"_sxAt");d(this,"_sxSize");d(this,"_sxExcludeFromSim");d(this,"_sxInBom");d(this,"_sxOnBoard");d(this,"_sxDnp");d(this,"_sxFieldsAutoplaced");d(this,"_sxStroke");d(this,"_sxFill");d(this,"_sxUuid");d(this,"_properties",[]);d(this,"_pins",[]);d(this,"_sxInstances");t.position!==void 0&&(this.position=t.position),t.size!==void 0&&(this.size=t.size),t.excludeFromSim!==void 0&&(this.excludeFromSim=typeof t.excludeFromSim=="boolean"?t.excludeFromSim:t.excludeFromSim.value),t.inBom!==void 0&&(this.inBom=typeof t.inBom=="boolean"?t.inBom:t.inBom.value),t.onBoard!==void 0&&(this.onBoard=typeof t.onBoard=="boolean"?t.onBoard:t.onBoard.value),t.dnp!==void 0&&(this.dnp=typeof t.dnp=="boolean"?t.dnp:t.dnp.value),t.fieldsAutoplaced!==void 0&&(this.fieldsAutoplaced=typeof t.fieldsAutoplaced=="boolean"?t.fieldsAutoplaced:t.fieldsAutoplaced.value),t.stroke!==void 0&&(this.stroke=t.stroke),t.fill!==void 0&&(this.fill=t.fill),t.uuid!==void 0&&(this.uuid=t.uuid),t.properties!==void 0&&(this.properties=t.properties),t.pins!==void 0&&(this.pins=t.pins),t.instances!==void 0&&(this.instances=t.instances)}static fromSexprPrimitives(t){let i=new ef,{propertyMap:r,arrayPropertyMap:s}=z.parsePrimitivesToClassProperties(t,this.token);return i._sxAt=r.at,i._sxSize=r.size,i._sxExcludeFromSim=r.exclude_from_sim,i._sxInBom=r.in_bom,i._sxOnBoard=r.on_board,i._sxDnp=r.dnp,i._sxFieldsAutoplaced=r.fields_autoplaced,i._sxStroke=r.stroke,i._sxFill=r.fill,i._sxUuid=r.uuid,i._properties=s.property??[],i._pins=s.pin??[],i._sxInstances=r.instances,i}get position(){return this._sxAt}set position(t){this._sxAt=t!==void 0?Un.from(t):void 0}get size(){return this._sxSize?.toObject()}set size(t){if(t===void 0){this._sxSize=void 0;return}if(t instanceof TO){this._sxSize=t;return}this._sxSize=new TO(t.width,t.height)}get excludeFromSim(){return this._sxExcludeFromSim?.value??!1}set excludeFromSim(t){this._sxExcludeFromSim=new aT(t)}get inBom(){return this._sxInBom?.value??!1}set inBom(t){this._sxInBom=new g7(t)}get onBoard(){return this._sxOnBoard?.value??!1}set onBoard(t){this._sxOnBoard=new x7(t)}get dnp(){return this._sxDnp?.value??!1}set dnp(t){this._sxDnp=new b7(t)}get fieldsAutoplaced(){return this._sxFieldsAutoplaced?.value??!1}set fieldsAutoplaced(t){this._sxFieldsAutoplaced=new Tf(t)}get stroke(){return this._sxStroke}set stroke(t){this._sxStroke=t}get fill(){return this._sxFill}set fill(t){this._sxFill=t}get uuid(){return this._sxUuid}set uuid(t){if(t===void 0){this._sxUuid=void 0;return}this._sxUuid=t instanceof Vt?t:new Vt(t)}get properties(){return this._properties}set properties(t){this._properties=t}get pins(){return this._pins}set pins(t){this._pins=t}get instances(){return this._sxInstances}set instances(t){this._sxInstances=t}getChildren(){let t=[];return this._sxAt&&t.push(this._sxAt),this._sxSize&&t.push(this._sxSize),this._sxExcludeFromSim&&t.push(this._sxExcludeFromSim),this._sxInBom&&t.push(this._sxInBom),this._sxOnBoard&&t.push(this._sxOnBoard),this._sxDnp&&t.push(this._sxDnp),this._sxFieldsAutoplaced&&t.push(this._sxFieldsAutoplaced),this._sxStroke&&t.push(this._sxStroke),this._sxFill&&t.push(this._sxFill),this._sxUuid&&t.push(this._sxUuid),t.push(...this._properties),t.push(...this._pins),this._sxInstances&&t.push(this._sxInstances),t}},d(ef,"token","sheet"),ef);z.register(TBt);var EBt=new Set(["version","generator","generator_version","uuid","paper","title_block","lib_symbols","embedded_fonts"]),mat=new Set(["property","image","sheet","symbol","text","label","global_label","junction","wire","no_connect","sheet_instances","polyline"]),wot=new Set([...EBt,...mat]),nf,_at=(nf=class extends z{constructor(t={}){super();d(this,"token","kicad_sch");d(this,"_sxVersion");d(this,"_sxGenerator");d(this,"_sxGeneratorVersion");d(this,"_sxUuid");d(this,"_sxPaper");d(this,"_sxTitleBlock");d(this,"_sxLibSymbols");d(this,"_sheetInstances",[]);d(this,"_sxEmbeddedFonts");d(this,"_properties",[]);d(this,"_images",[]);d(this,"_sheets",[]);d(this,"_symbols",[]);d(this,"_texts",[]);d(this,"_labels",[]);d(this,"_globalLabels",[]);d(this,"_wires",[]);d(this,"_junctions",[]);d(this,"_noConnects",[]);d(this,"_polylines",[]);t.version instanceof gO?this._sxVersion=t.version:t.version!==void 0&&(this.version=t.version),t.generator instanceof yO?this._sxGenerator=t.generator:t.generator!==void 0&&(this.generator=t.generator),t.generatorVersion instanceof xO?this._sxGeneratorVersion=t.generatorVersion:t.generatorVersion!==void 0&&(this.generatorVersion=t.generatorVersion),t.uuid!==void 0&&(this.uuid=t.uuid),t.paper!==void 0&&(this.paper=t.paper),t.titleBlock!==void 0&&(this.titleBlock=t.titleBlock),t.libSymbols!==void 0&&(this.libSymbols=t.libSymbols),t.sheetInstances!==void 0&&(this.sheetInstances=t.sheetInstances),t.embeddedFonts!==void 0&&(this.embeddedFonts=t.embeddedFonts),t.properties!==void 0&&(this.properties=t.properties),t.images!==void 0&&(this.images=t.images),t.sheets!==void 0&&(this.sheets=t.sheets),t.symbols!==void 0&&(this.symbols=t.symbols),t.texts!==void 0&&(this.texts=t.texts),t.labels!==void 0&&(this.labels=t.labels),t.globalLabels!==void 0&&(this.globalLabels=t.globalLabels),t.wires!==void 0&&(this.wires=t.wires),t.junctions!==void 0&&(this.junctions=t.junctions),t.noConnects!==void 0&&(this.noConnects=t.noConnects),t.polylines!==void 0&&(this.polylines=t.polylines)}static fromSexprPrimitives(t){for(let s of t){if(!Array.isArray(s))throw new Error(`kicad_sch encountered unexpected primitive child: ${JSON.stringify(s)}`);if(s.length===0||typeof s[0]!="string")throw new Error(`kicad_sch encountered invalid child expression: ${JSON.stringify(s)}`)}let{propertyMap:i,arrayPropertyMap:r}=z.parsePrimitivesToClassProperties(t,this.token);for(let s of Object.keys(i))if(!wot.has(s))throw new Error(`kicad_sch encountered unsupported child token "${s}"`);for(let[s,o]of Object.entries(r)){if(!wot.has(s))throw new Error(`kicad_sch encountered unsupported child token "${s}"`);if(!mat.has(s)&&o.length>1)throw new Error(`kicad_sch does not support repeated child token "${s}"`)}return new nf({version:i.version,generator:i.generator,generatorVersion:i.generator_version,uuid:i.uuid,paper:i.paper,titleBlock:i.title_block,libSymbols:i.lib_symbols,sheetInstances:r.sheet_instances,embeddedFonts:i.embedded_fonts,properties:r.property??[],images:r.image??[],sheets:r.sheet??[],symbols:r.symbol??[],texts:r.text??[],labels:r.label??[],globalLabels:r.global_label??[],junctions:r.junction??[],wires:r.wire??[],noConnects:r.no_connect??[],polylines:r.polyline??[]})}get version(){return this._sxVersion?.value}set version(t){this._sxVersion=t===void 0?void 0:new gO(t)}get generator(){return this._sxGenerator?.value}set generator(t){this._sxGenerator=t===void 0?void 0:new yO(t)}get generatorVersion(){return this._sxGeneratorVersion?.value}set generatorVersion(t){this._sxGeneratorVersion=t===void 0?void 0:new xO(t)}get uuid(){return this._sxUuid}set uuid(t){if(t===void 0){this._sxUuid=void 0;return}this._sxUuid=t instanceof Vt?t:new Vt(t)}get paper(){return this._sxPaper}set paper(t){this._sxPaper=t}get titleBlock(){return this._sxTitleBlock}set titleBlock(t){this._sxTitleBlock=t}get libSymbols(){return this._sxLibSymbols}set libSymbols(t){this._sxLibSymbols=t}get sheetInstances(){return[...this._sheetInstances]}set sheetInstances(t){if(t===void 0){this._sheetInstances=[];return}this._sheetInstances=Array.isArray(t)?[...t]:[t]}get embeddedFonts(){return this._sxEmbeddedFonts}set embeddedFonts(t){this._sxEmbeddedFonts=t}get properties(){return[...this._properties]}set properties(t){this._properties=[...t]}get images(){return[...this._images]}set images(t){this._images=[...t]}get sheets(){return[...this._sheets]}set sheets(t){this._sheets=[...t]}get symbols(){return[...this._symbols]}set symbols(t){this._symbols=[...t]}get texts(){return[...this._texts]}set texts(t){this._texts=[...t]}get labels(){return[...this._labels]}set labels(t){this._labels=[...t]}get globalLabels(){return[...this._globalLabels]}set globalLabels(t){this._globalLabels=[...t]}get junctions(){return[...this._junctions]}set junctions(t){this._junctions=[...t]}get wires(){return[...this._wires]}set wires(t){this._wires=[...t]}get noConnects(){return[...this._noConnects]}set noConnects(t){this._noConnects=[...t]}get polylines(){return[...this._polylines]}set polylines(t){this._polylines=[...t]}getChildren(){let t=[];return this._sxVersion&&t.push(this._sxVersion),this._sxGenerator&&t.push(this._sxGenerator),this._sxGeneratorVersion&&t.push(this._sxGeneratorVersion),this._sxUuid&&t.push(this._sxUuid),this._sxPaper&&t.push(this._sxPaper),this._sxTitleBlock&&t.push(this._sxTitleBlock),this._sxLibSymbols&&t.push(this._sxLibSymbols),t.push(...this._sheetInstances),this._sxEmbeddedFonts&&t.push(this._sxEmbeddedFonts),t.push(...this._properties),t.push(...this._images),t.push(...this._sheets),t.push(...this._symbols),t.push(...this._texts),t.push(...this._labels),t.push(...this._globalLabels),t.push(...this._junctions),t.push(...this._wires),t.push(...this._noConnects),t.push(...this._polylines),t}},d(nf,"token","kicad_sch"),nf);z.register(_at);var MBt=new Set(["board_only","exclude_from_pos_files","exclude_from_bom","allow_soldermask_bridges"]),Eu,CBt=(Eu=class extends z{constructor(){super(...arguments);d(this,"token","attr");d(this,"_type");d(this,"_boardOnly",!1);d(this,"_excludeFromPosFiles",!1);d(this,"_excludeFromBom",!1);d(this,"_allowSoldermaskBridges",!1)}static fromSexprPrimitives(t){let i=new Eu;for(let r of t){if(typeof r!="string")throw new Error(`attr encountered unsupported child: ${JSON.stringify(r)}`);if(MBt.has(r)){i.applyFlag(r);continue}if(i._type===void 0){i._type=r;continue}throw new Error(`attr encountered duplicate or unknown token "${r}"`)}return i}applyFlag(t){switch(t){case"board_only":this._boardOnly=!0;break;case"exclude_from_pos_files":this._excludeFromPosFiles=!0;break;case"exclude_from_bom":this._excludeFromBom=!0;break;case"allow_soldermask_bridges":this._allowSoldermaskBridges=!0;break}}get type(){return this._type}set type(t){this._type=t}get boardOnly(){return this._boardOnly}set boardOnly(t){this._boardOnly=t}get excludeFromPosFiles(){return this._excludeFromPosFiles}set excludeFromPosFiles(t){this._excludeFromPosFiles=t}get excludeFromBom(){return this._excludeFromBom}set excludeFromBom(t){this._excludeFromBom=t}get allowSoldermaskBridges(){return this._allowSoldermaskBridges}set allowSoldermaskBridges(t){this._allowSoldermaskBridges=t}getChildren(){return[]}getString(){let t=["attr"];return this._type&&t.push(this._type),this._boardOnly&&t.push("board_only"),this._excludeFromPosFiles&&t.push("exclude_from_pos_files"),this._excludeFromBom&&t.push("exclude_from_bom"),this._allowSoldermaskBridges&&t.push("allow_soldermask_bridges"),`(${t.join(" ")})`}},d(Eu,"token","attr"),d(Eu,"parentToken","footprint"),Eu);z.register(CBt);var Ek,EO=(Ek=class extends rn{constructor(){super(...arguments);d(this,"token","autoplace_cost180")}},d(Ek,"token","autoplace_cost180"),d(Ek,"parentToken","footprint"),Ek);z.register(EO);var Mk,MO=(Mk=class extends rn{constructor(){super(...arguments);d(this,"token","autoplace_cost90")}},d(Mk,"token","autoplace_cost90"),d(Mk,"parentToken","footprint"),Mk);z.register(MO);var Ck,CO=(Ck=class extends rn{constructor(){super(...arguments);d(this,"token","clearance")}},d(Ck,"token","clearance"),d(Ck,"parentToken","footprint"),Ck);z.register(CO);var Mu,IO=(Mu=class extends z{constructor(t){super();d(this,"token","descr");d(this,"_value");this._value=t}static fromSexprPrimitives(t){let i=jt(t[0]);if(i===void 0)throw new Error("descr expects a string value");return new Mu(i)}get value(){return this._value}set value(t){this._value=t}getChildren(){return[]}getString(){return`(descr ${re(this._value)})`}},d(Mu,"token","descr"),d(Mu,"parentToken","footprint"),Mu);z.register(IO);var Cu,NO=(Cu=class extends z{constructor(t){super();d(this,"token","net_tie_pad_groups");d(this,"_groups",[]);this.groups=t}static fromSexprPrimitives(t){let i=t.map(r=>{let s=jt(r);if(s===void 0)throw new Error(`net_tie_pad_groups expects string group entries, received ${JSON.stringify(r)}`);return s});return new Cu(i)}get groups(){return[...this._groups]}set groups(t){this._groups=t.map(i=>String(i))}getChildren(){return[]}getString(){return`(net_tie_pad_groups ${this._groups.map(i=>re(i)).join(" ")})`}},d(Cu,"token","net_tie_pad_groups"),d(Cu,"parentToken","footprint"),Cu);z.register(NO);var Iu,AO=(Iu=class extends z{constructor(t){super();d(this,"token","path");d(this,"_value");this._value=t}static fromSexprPrimitives(t){let i=jt(t[0]);if(i===void 0)throw new Error("path expects a string value");return new Iu(i)}get value(){return this._value}set value(t){this._value=t}getChildren(){return[]}getString(){return`(path ${re(this._value)})`}},d(Iu,"token","path"),d(Iu,"parentToken","footprint"),Iu);z.register(AO);var Nu,RO=(Nu=class extends z{constructor(t){super();d(this,"token","private_layers");d(this,"_layers",[]);this.layers=t}static fromSexprPrimitives(t){let i=t.map(r=>{let s=jt(r);if(s===void 0)throw new Error(`private_layers expects string layer names, received ${JSON.stringify(r)}`);return s});return new Nu(i)}get layers(){return[...this._layers]}set layers(t){this._layers=t.map(i=>String(i))}getChildren(){return[]}getString(){return`(private_layers ${this._layers.map(i=>/^[^\s()"]+$/u.test(i)&&!["nil","#t","#f"].includes(i)?i:re(i)).join(" ")})`}},d(Nu,"token","private_layers"),d(Nu,"parentToken","footprint"),Nu);z.register(RO);var Ik,OO=(Ik=class extends rn{constructor(){super(...arguments);d(this,"token","solder_mask_margin")}},d(Ik,"token","solder_mask_margin"),d(Ik,"parentToken","footprint"),Ik);z.register(OO);var Nk,LO=(Nk=class extends rn{constructor(){super(...arguments);d(this,"token","solder_paste_margin")}},d(Nk,"token","solder_paste_margin"),d(Nk,"parentToken","footprint"),Nk);z.register(LO);var Ak,FO=(Ak=class extends rn{constructor(){super(...arguments);d(this,"token","solder_paste_ratio")}},d(Ak,"token","solder_paste_ratio"),d(Ak,"parentToken","footprint"),Ak);z.register(FO);var Au,zO=(Au=class extends z{constructor(t){super();d(this,"token","tags");d(this,"_value");this._value=t}static fromSexprPrimitives(t){let i=jt(t[0]);if(i===void 0)throw new Error("tags expects a string value");return new Au(i)}get value(){return this._value}set value(t){this._value=t}getChildren(){return[]}getString(){return`(tags ${re(this._value)})`}},d(Au,"token","tags"),d(Au,"parentToken","footprint"),Au);z.register(zO);var Ru,$O=(Ru=class extends bo{constructor(){super(...arguments);d(this,"token","tedit")}static fromSexprPrimitives(t){let i=jt(t[0]);if(i===void 0)throw new Error("tedit expects a string value");return new Ru(i)}},d(Ru,"token","tedit"),d(Ru,"parentToken","footprint"),Ru);z.register($O);var Rk,DO=(Rk=class extends rn{constructor(){super(...arguments);d(this,"token","thermal_gap")}},d(Rk,"token","thermal_gap"),d(Rk,"parentToken","footprint"),Rk);z.register(DO);var Ok,jO=(Ok=class extends rn{constructor(){super(...arguments);d(this,"token","thermal_width")}},d(Ok,"token","thermal_width"),d(Ok,"parentToken","footprint"),Ok);z.register(jO);var Lk,BO=(Lk=class extends rn{constructor(){super(...arguments);d(this,"token","zone_connect")}},d(Lk,"token","zone_connect"),d(Lk,"parentToken","footprint"),Lk);z.register(BO);var Ou,IBt=(Ou=class extends z{constructor(t){super();d(this,"token","chamfer");d(this,"_corners",[]);this.corners=t}static fromSexprPrimitives(t){let i=t.map(r=>{let s=jt(r);return s===void 0?Wi(r):s});return new Ou(i)}get corners(){return[...this._corners]}set corners(t){this._corners=t.map(i=>String(i))}getChildren(){return[]}getString(){return this._corners.length===0?"(chamfer)":`(chamfer ${this._corners.join(" ")})`}},d(Ou,"token","chamfer"),d(Ou,"parentToken","pad"),Ou);z.register(IBt);var Fk,yat=(Fk=class extends rn{constructor(){super(...arguments);d(this,"token","chamfer_ratio")}},d(Fk,"token","chamfer_ratio"),d(Fk,"parentToken","pad"),Fk);z.register(yat);var zk,gat=(zk=class extends rn{constructor(){super(...arguments);d(this,"token","clearance")}},d(zk,"token","clearance"),d(zk,"parentToken","pad"),zk);z.register(gat);var $k,xat=($k=class extends rn{constructor(){super(...arguments);d(this,"token","die_length")}},d($k,"token","die_length"),d($k,"parentToken","pad"),$k);z.register(xat);var Lu,dy=(Lu=class extends z{constructor(t,i){super();d(this,"token","offset");d(this,"_x");d(this,"_y");this._x=t,this._y=i}static fromSexprPrimitives(t){let i=Dt(t[0]),r=Dt(t[1]);if(i===void 0||r===void 0)throw new Error("drill offset requires x and y numeric values");return new Lu(i,r)}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}getChildren(){return[]}getString(){return`(offset ${this._x} ${this._y})`}},d(Lu,"token","offset"),d(Lu,"parentToken","drill"),Lu);z.register(dy);var Fu,NBt=(Fu=class extends z{constructor({oval:t=!1,diameter:i,width:r,offset:s}){super();d(this,"token","drill");d(this,"_oval",!1);d(this,"_diameter");d(this,"_width");d(this,"_sxOffset");this._oval=t,this._diameter=i,this._width=r,s instanceof dy?this._sxOffset=s:s&&(this._sxOffset=new dy(s.x,s.y))}static fromSexprPrimitives(t){let i=[...t],r=!1;i[0]==="oval"&&(r=!0,i.shift());let s=Dt(i.shift());if(s===void 0)throw new Error("drill requires a diameter value");let o,a=Dt(i[0]);a!==void 0&&(o=a,i.shift());let c=new Fu({oval:r,diameter:s,width:o});for(let l of i){if(!Array.isArray(l))throw new Error(`drill encountered unexpected primitive child: ${JSON.stringify(l)}`);let u=z.parsePrimitiveSexpr(l,{parentToken:this.token});if(!(u instanceof dy))throw new Error(`drill encountered unsupported child token: ${Wi(l)}`);if(c._sxOffset)throw new Error("drill does not support multiple offset children");c._sxOffset=u}return c}get oval(){return this._oval}set oval(t){this._oval=t}get diameter(){return this._diameter}set diameter(t){this._diameter=t}get width(){return this._width}set width(t){this._width=t}get offset(){return this._sxOffset}set offset(t){if(t===void 0){this._sxOffset=void 0;return}this._sxOffset=t instanceof dy?t:new dy(t.x,t.y)}getChildren(){return this._sxOffset?[this._sxOffset]:[]}getString(){let t=[];if(this._oval&&t.push("oval"),t.push(String(this._diameter)),this._width!==void 0&&t.push(String(this._width)),!this._sxOffset)return`(drill ${t.join(" ")})`;let i=[`(drill ${t.join(" ")}`];return i.push(this._sxOffset.getStringIndented()),i.push(")"),i.join(`
`)}},d(Fu,"token","drill"),d(Fu,"parentToken","pad"),Fu);z.register(NBt);var Jo,bat=(Jo=class extends z{constructor(t){super();d(this,"token","layers");d(this,"_layers",[]);this.layers=t}static from(t){return t instanceof Jo?t:new Jo(t)}static fromSexprPrimitives(t){let i=t.map(r=>{let s=jt(r);return s===void 0?Wi(r):s});return new Jo(i)}get layers(){return[...this._layers]}set layers(t){this._layers=t.map(i=>String(i))}getChildren(){return[]}getString(){return this._layers.length===0?"(layers)":`(layers ${this._layers.map(i=>/^[^\s()"]+$/u.test(i)&&!["nil","#t","#f"].includes(i)?i:re(i)).join(" ")})`}},d(Jo,"token","layers"),d(Jo,"parentToken","pad"),Jo);z.register(bat);var zu,ABt=(zu=class extends z{constructor(t,i){super();d(this,"token","net");d(this,"_id");d(this,"_name");this._id=t,this._name=i}static fromSexprPrimitives(t){let i=Dt(t[0]),r=jt(t[1]);if(i===void 0||r===void 0)throw new Error("pad net requires numeric id and string name");return new zu(i,r)}get id(){return this._id}set id(t){this._id=t}get name(){return this._name}set name(t){this._name=t}getChildren(){return[]}getString(){return`(net ${this._id} ${re(this._name)})`}},d(zu,"token","net"),d(zu,"parentToken","pad"),zu);z.register(ABt);var Pot=["outline","convexhull"],kot=["rect","circle"],$u,RBt=($u=class extends z{constructor(){super(...arguments);d(this,"token","options");d(this,"_sxClearance");d(this,"_sxAnchor")}static fromSexprPrimitives(t){let i=new $u;for(let r of t){if(!Array.isArray(r)||r.length===0)throw new Error(`pad options encountered invalid child expression: ${JSON.stringify(r)}`);let s=z.parsePrimitiveSexpr(r,{parentToken:this.token});if(!(s instanceof z))throw new Error(`pad options child did not resolve to an SxClass: ${JSON.stringify(r)}`);if(s instanceof YO){if(i._sxClearance)throw new Error("pad options encountered duplicate clearance tokens");i._sxClearance=s;continue}if(s instanceof XO){if(i._sxAnchor)throw new Error("pad options encountered duplicate anchor tokens");i._sxAnchor=s;continue}throw new Error(`pad options encountered unsupported token "${s.token}"`)}return i}get clearance(){return this._sxClearance?.type}set clearance(t){this._sxClearance=t?new YO(t):void 0}get anchor(){return this._sxAnchor?.shape}set anchor(t){this._sxAnchor=t?new XO(t):void 0}getChildren(){let t=[];return this._sxClearance&&t.push(this._sxClearance),this._sxAnchor&&t.push(this._sxAnchor),t}},d($u,"token","options"),d($u,"parentToken","pad"),$u);z.register(RBt);var Du,YO=(Du=class extends z{constructor(t){super();d(this,"token","clearance");d(this,"_type");this._type=t}static fromSexprPrimitives(t){let[i]=t,r=jt(i);if(r===void 0)throw new Error("pad options clearance requires a string value");if(!Pot.includes(r))throw new Error(`pad options clearance must be one of ${Pot.join(", ")}`);return new Du(r)}get type(){return this._type}set type(t){this._type=t}getChildren(){return[]}getString(){return`(clearance ${this._type})`}},d(Du,"token","clearance"),d(Du,"parentToken","options"),Du);z.register(YO);var ju,XO=(ju=class extends z{constructor(t){super();d(this,"token","anchor");d(this,"_shape");this._shape=t}static fromSexprPrimitives(t){let[i]=t,r=jt(i);if(r===void 0)throw new Error("pad options anchor requires a string value");if(!kot.includes(r))throw new Error(`pad options anchor must be one of ${kot.join(", ")}`);return new ju(r)}get shape(){return this._shape}set shape(t){this._shape=t}getChildren(){return[]}getString(){return`(anchor ${this._shape})`}},d(ju,"token","anchor"),d(ju,"parentToken","options"),ju);z.register(XO);var Dk,vat=(Dk=class extends bo{constructor(){super(...arguments);d(this,"token","pinfunction")}},d(Dk,"token","pinfunction"),d(Dk,"parentToken","pad"),Dk);z.register(vat);var jk,Sat=(jk=class extends bo{constructor(){super(...arguments);d(this,"token","pintype")}},d(jk,"token","pintype"),d(jk,"parentToken","pad"),jk);z.register(Sat);var Bu,R0=(Bu=class extends z{constructor(t,i){super();d(this,"token","end");d(this,"_x");d(this,"_y");this._x=t,this._y=i}static fromSexprPrimitives(t){let[i,r]=t,s=Dt(i),o=Dt(r);if(s===void 0||o===void 0)throw new Error("gr_line end expects two numeric arguments");return new Bu(s,o)}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}toObject(){return{x:this._x,y:this._y}}getChildren(){return[]}getString(){return`(end ${this._x} ${this._y})`}},d(Bu,"token","end"),d(Bu,"parentToken","gr_line"),Bu);z.register(R0);var Yu,O0=(Yu=class extends z{constructor(t,i){super();d(this,"token","start");d(this,"_x");d(this,"_y");this._x=t,this._y=i}static fromSexprPrimitives(t){let[i,r]=t,s=Dt(i),o=Dt(r);if(s===void 0||o===void 0)throw new Error("gr_line start expects two numeric arguments");return new Yu(s,o)}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}toObject(){return{x:this._x,y:this._y}}getChildren(){return[]}getString(){return`(start ${this._x} ${this._y})`}},d(Yu,"token","start"),d(Yu,"parentToken","gr_line"),Yu);z.register(O0);var Tot=new Set(["start","end","width"]),Xu,wat=(Xu=class extends z{constructor(){super(...arguments);d(this,"token","gr_line");d(this,"_sxStart");d(this,"_sxEnd");d(this,"_sxWidth")}static fromSexprPrimitives(t){let i=new Xu,{propertyMap:r,arrayPropertyMap:s}=z.parsePrimitivesToClassProperties(t,this.token);for(let o of Object.keys(r))if(!Tot.has(o))throw new Error(`pad primitive gr_line encountered unsupported child token "${o}"`);for(let[o,a]of Object.entries(s)){if(!Tot.has(o))throw new Error(`pad primitive gr_line encountered unsupported child token "${o}"`);if(a.length>1)throw new Error(`pad primitive gr_line does not support repeated "${o}" tokens`)}if(i._sxStart=r.start,i._sxEnd=r.end,i._sxWidth=r.width,!i._sxStart)throw new Error("pad primitive gr_line requires a start child token");if(!i._sxEnd)throw new Error("pad primitive gr_line requires an end child token");return i}get start(){return this._sxStart}set start(t){if(t===void 0){this._sxStart=void 0;return}if(t instanceof O0){this._sxStart=t;return}this._sxStart=new O0(t.x,t.y)}get end(){return this._sxEnd}set end(t){if(t===void 0){this._sxEnd=void 0;return}if(t instanceof R0){this._sxEnd=t;return}this._sxEnd=new R0(t.x,t.y)}get width(){return this._sxWidth?.value}set width(t){if(t===void 0){this._sxWidth=void 0;return}this._sxWidth=t instanceof Je?t:new Je(t)}get widthClass(){return this._sxWidth}getChildren(){let t=[];return this._sxStart&&t.push(this._sxStart),this._sxEnd&&t.push(this._sxEnd),this._sxWidth&&t.push(this._sxWidth),t}getString(){let t=["(gr_line"];return this._sxStart&&t.push(this._sxStart.getStringIndented()),this._sxEnd&&t.push(this._sxEnd.getStringIndented()),this._sxWidth&&t.push(this._sxWidth.getStringIndented()),t.push(")"),t.join(`
`)}},d(Xu,"token","gr_line"),d(Xu,"parentToken","primitives"),Xu);z.register(wat);var Eot=new Set(["start","mid","end","width"]),Uu,Pat=(Uu=class extends z{constructor(t={}){super();d(this,"token","gr_arc");d(this,"_sxStart");d(this,"_sxMid");d(this,"_sxEnd");d(this,"_sxWidth");t.start!==void 0&&(this.start=t.start),t.mid!==void 0&&(this.mid=t.mid),t.end!==void 0&&(this.end=t.end),t.width!==void 0&&(this.width=t.width)}static fromSexprPrimitives(t){let i=new Uu,{propertyMap:r,arrayPropertyMap:s}=z.parsePrimitivesToClassProperties(t,this.token);for(let o of Object.keys(r))if(!Eot.has(o))throw new Error(`pad primitive gr_arc encountered unsupported child token "${o}"`);for(let[o,a]of Object.entries(s)){if(!Eot.has(o))throw new Error(`pad primitive gr_arc encountered unsupported child token "${o}"`);if(a.length>1)throw new Error(`pad primitive gr_arc does not support repeated "${o}" tokens`)}if(i._sxStart=r.start,i._sxMid=r.mid,i._sxEnd=r.end,i._sxWidth=r.width,!i._sxStart)throw new Error("pad primitive gr_arc requires a start child token");if(!i._sxMid)throw new Error("pad primitive gr_arc requires a mid child token");if(!i._sxEnd)throw new Error("pad primitive gr_arc requires an end child token");return i}get start(){return this._sxStart}set start(t){this._sxStart=K6(t,kat)}get mid(){return this._sxMid}set mid(t){this._sxMid=K6(t,Tat)}get end(){return this._sxEnd}set end(t){this._sxEnd=K6(t,Eat)}get width(){return this._sxWidth?.value}set width(t){if(t===void 0){this._sxWidth=void 0;return}this._sxWidth=t instanceof Je?t:new Je(t)}get widthClass(){return this._sxWidth}getChildren(){let t=[];return this._sxStart&&t.push(this._sxStart),this._sxMid&&t.push(this._sxMid),this._sxEnd&&t.push(this._sxEnd),this._sxWidth&&t.push(this._sxWidth),t}getString(){let t=["(gr_arc"];return this._sxStart&&t.push(this._sxStart.getStringIndented()),this._sxMid&&t.push(this._sxMid.getStringIndented()),this._sxEnd&&t.push(this._sxEnd.getStringIndented()),this._sxWidth&&t.push(this._sxWidth.getStringIndented()),t.push(")"),t.join(`
`)}},d(Uu,"token","gr_arc"),d(Uu,"parentToken","primitives"),Uu);z.register(Pat);var K6=(n,e)=>{if(n!==void 0)return n instanceof e?n:new e(n.x,n.y)},S7=class extends z{constructor(e,t){super();d(this,"_x");d(this,"_y");this._x=e,this._y=t}get x(){return this._x}set x(e){this._x=e}get y(){return this._y}set y(e){this._y=e}getChildren(){return[]}getString(){return`(${this.token} ${this._x} ${this._y})`}},Vu,kat=(Vu=class extends S7{constructor(t,i){super(t,i);d(this,"token","start")}static fromSexprPrimitives(t){let[i,r]=t,s=Dt(i),o=Dt(r);if(s===void 0||o===void 0)throw new Error("pad primitive gr_arc start expects two numeric arguments");return new Vu(s,o)}},d(Vu,"token","start"),d(Vu,"parentToken","gr_arc"),Vu);z.register(kat);var Gu,Tat=(Gu=class extends S7{constructor(t,i){super(t,i);d(this,"token","mid")}static fromSexprPrimitives(t){let[i,r]=t,s=Dt(i),o=Dt(r);if(s===void 0||o===void 0)throw new Error("pad primitive gr_arc mid expects two numeric arguments");return new Gu(s,o)}},d(Gu,"token","mid"),d(Gu,"parentToken","gr_arc"),Gu);z.register(Tat);var Hu,Eat=(Hu=class extends S7{constructor(t,i){super(t,i);d(this,"token","end")}static fromSexprPrimitives(t){let[i,r]=t,s=Dt(i),o=Dt(r);if(s===void 0||o===void 0)throw new Error("pad primitive gr_arc end expects two numeric arguments");return new Hu(s,o)}},d(Hu,"token","end"),d(Hu,"parentToken","gr_arc"),Hu);z.register(Eat);var Mot=new Set(["center","end","width","fill"]),Wu,Mat=(Wu=class extends z{constructor(t={}){super();d(this,"token","gr_circle");d(this,"_sxCenter");d(this,"_sxEnd");d(this,"_sxWidth");d(this,"_sxFill");t.center!==void 0&&(this.center=t.center),t.end!==void 0&&(this.end=t.end),t.width!==void 0&&(this.width=t.width),t.fill!==void 0&&(this.fill=t.fill)}static fromSexprPrimitives(t){let i=new Wu,{propertyMap:r,arrayPropertyMap:s}=z.parsePrimitivesToClassProperties(t,this.token);for(let o of Object.keys(r))if(!Mot.has(o))throw new Error(`pad primitive gr_circle encountered unsupported child token "${o}"`);for(let[o,a]of Object.entries(s)){if(!Mot.has(o))throw new Error(`pad primitive gr_circle encountered unsupported child token "${o}"`);if(a.length>1)throw new Error(`pad primitive gr_circle does not support repeated "${o}" tokens`)}if(i._sxCenter=r.center,i._sxEnd=r.end,i._sxWidth=r.width,i._sxFill=r.fill,!i._sxCenter)throw new Error("pad primitive gr_circle requires a center child token");if(!i._sxEnd)throw new Error("pad primitive gr_circle requires an end child token");return i}get center(){return this._sxCenter}set center(t){this._sxCenter=Cot(t,Iat)}get end(){return this._sxEnd}set end(t){this._sxEnd=Cot(t,Nat)}get width(){return this._sxWidth?.value}set width(t){if(t===void 0){this._sxWidth=void 0;return}this._sxWidth=t instanceof Je?t:new Je(t)}get widthClass(){return this._sxWidth}get fill(){return this._sxFill?.filled}set fill(t){if(t===void 0){this._sxFill=void 0;return}this._sxFill=t instanceof fy?t:new fy(t)}get fillClass(){return this._sxFill}getChildren(){let t=[];return this._sxCenter&&t.push(this._sxCenter),this._sxEnd&&t.push(this._sxEnd),this._sxWidth&&t.push(this._sxWidth),this._sxFill&&t.push(this._sxFill),t}getString(){let t=["(gr_circle"];return this._sxCenter&&t.push(this._sxCenter.getStringIndented()),this._sxEnd&&t.push(this._sxEnd.getStringIndented()),this._sxWidth&&t.push(this._sxWidth.getStringIndented()),this._sxFill&&t.push(this._sxFill.getStringIndented()),t.push(")"),t.join(`
`)}},d(Wu,"token","gr_circle"),d(Wu,"parentToken","primitives"),Wu);z.register(Mat);var Cot=(n,e)=>{if(n!==void 0)return n instanceof e?n:new e(n.x,n.y)},Cat=class extends z{constructor(e,t){super();d(this,"_x");d(this,"_y");this._x=e,this._y=t}get x(){return this._x}set x(e){this._x=e}get y(){return this._y}set y(e){this._y=e}getChildren(){return[]}getString(){return`(${this.token} ${this._x} ${this._y})`}},qu,Iat=(qu=class extends Cat{constructor(t,i){super(t,i);d(this,"token","center")}static fromSexprPrimitives(t){let[i,r]=t,s=Dt(i),o=Dt(r);if(s===void 0||o===void 0)throw new Error("pad primitive gr_circle center expects two numeric arguments");return new qu(s,o)}},d(qu,"token","center"),d(qu,"parentToken","gr_circle"),qu);z.register(Iat);var Zu,Nat=(Zu=class extends Cat{constructor(t,i){super(t,i);d(this,"token","end")}static fromSexprPrimitives(t){let[i,r]=t,s=Dt(i),o=Dt(r);if(s===void 0||o===void 0)throw new Error("pad primitive gr_circle end expects two numeric arguments");return new Zu(s,o)}},d(Zu,"token","end"),d(Zu,"parentToken","gr_circle"),Zu);z.register(Nat);var Iot=new Set(["yes","true"]),OBt=new Set(["no","false","none"]),Qo,fy=(Qo=class extends z{constructor(t){super();d(this,"token","fill");d(this,"value");t===void 0||t===!1?this.value="no":t===!0?this.value="yes":this.value=t}static fromSexprPrimitives(t){let[i]=t;if(i===void 0)return new Qo("no");if(typeof i=="boolean")return new Qo(i);if(typeof i=="string"){let r=i.toLowerCase();if(Iot.has(r)||OBt.has(r))return new Qo(i)}throw new Error(`pad primitive gr_circle fill expects yes/no/none or boolean, received ${JSON.stringify(i)}`)}get filled(){return Iot.has(this.value.toLowerCase())}set filled(t){this.value=t?"yes":"no"}getString(){return`(fill ${this.value})`}},d(Qo,"token","fill"),d(Qo,"parentToken","gr_circle"),Qo);z.register(fy);var Ku,LBt=(Ku=class extends z{constructor(){super(...arguments);d(this,"token","primitives");d(this,"_graphics",[]);d(this,"_sxWidth");d(this,"_sxFill")}static fromSexprPrimitives(t){let i=new Ku;for(let r of t){if(!Array.isArray(r)||r.length===0)throw new Error(`pad primitives encountered invalid child expression: ${JSON.stringify(r)}`);let s=z.parsePrimitiveSexpr(r,{parentToken:this.token});if(!(s instanceof z))throw new Error(`pad primitives child did not resolve to an SxClass: ${JSON.stringify(r)}`);if(s instanceof Je){if(i._sxWidth)throw new Error("pad primitives encountered duplicate width tokens");i._sxWidth=s;continue}if(s instanceof UO){if(i._sxFill)throw new Error("pad primitives encountered duplicate fill tokens");i._sxFill=s;continue}if(s instanceof Aat){i._graphics.push(s);continue}if(s instanceof wat){i._graphics.push(s);continue}if(s instanceof Pat){i._graphics.push(s);continue}if(s instanceof Mat){i._graphics.push(s);continue}throw new Error(`pad primitives encountered unsupported token "${s.token}"`)}return i}get graphics(){return[...this._graphics]}set graphics(t){this._graphics=[...t]}addGraphic(t){this._graphics.push(t)}get width(){return this._sxWidth?.value}set width(t){this._sxWidth=t===void 0?void 0:new Je(t)}get fill(){return this._sxFill?.value}set fill(t){this._sxFill=t===void 0?void 0:new UO({value:t})}getChildren(){let t=[];return t.push(...this._graphics),this._sxWidth&&t.push(this._sxWidth),this._sxFill&&t.push(this._sxFill),t}},d(Ku,"token","primitives"),d(Ku,"parentToken","pad"),Ku);z.register(LBt);var ho,UO=(ho=class extends ti{constructor(t={}){super(t.value??!1);d(this,"token","fill")}static fromSexprPrimitives(t){let[i]=t,r=typeof i=="string"?i.toLowerCase():i;if(r===void 0)return new ho({value:!1});if(r==="yes")return new ho({value:!0});if(r==="no")return new ho({value:!1});if(typeof r=="boolean")return new ho({value:r});throw new Error(`pad primitives fill expects yes/no or boolean, received ${JSON.stringify(i)}`)}},d(ho,"token","fill"),d(ho,"parentToken","primitives"),ho);z.register(UO);var Ju,Aat=(Ju=class extends z{constructor(){super(...arguments);d(this,"token","gr_poly");d(this,"_contours",[]);d(this,"_sxWidth");d(this,"_sxFill")}static fromSexprPrimitives(t){let i=new Ju;for(let r of t){if(!Array.isArray(r)||r.length===0)throw new Error(`gr_poly primitive encountered invalid child: ${JSON.stringify(r)}`);let s=z.parsePrimitiveSexpr(r,{parentToken:this.token});if(!(s instanceof z))throw new Error(`gr_poly primitive child did not resolve to an SxClass: ${JSON.stringify(r)}`);if(s instanceof Sr){i._contours.push(s);continue}if(s instanceof Je){if(i._sxWidth)throw new Error("gr_poly encountered duplicate width tokens");i._sxWidth=s;continue}if(s instanceof eT){if(i._sxFill)throw new Error("gr_poly encountered duplicate fill tokens");i._sxFill=s;continue}if(s.token==="fill"){if(i._sxFill)throw new Error("gr_poly encountered duplicate fill tokens");let o="value"in s?s.value:"filled"in s?s.filled:!1;i._sxFill=new eT({value:o});continue}throw new Error(`gr_poly encountered unsupported token "${s.token}"`)}if(i._contours.length===0)throw new Error("gr_poly requires at least one pts child");return i}get contours(){return[...this._contours]}set contours(t){this._contours=[...t]}get width(){return this._sxWidth?.value}set width(t){this._sxWidth=t===void 0?void 0:new Je(t)}get filled(){return this._sxFill?.value}set filled(t){this._sxFill=t===void 0?void 0:new eT({value:t})}getChildren(){let t=[];return t.push(...this._contours),this._sxWidth&&t.push(this._sxWidth),this._sxFill&&t.push(this._sxFill),t}},d(Ju,"token","gr_poly"),d(Ju,"parentToken","primitives"),Ju);z.register(Aat);var ta,eT=(ta=class extends ti{constructor(t={}){super(t.value??!1);d(this,"token","fill")}static fromSexprPrimitives(t){let[i]=t;if(i===void 0)return new ta({value:!1});if(typeof i=="boolean")return new ta({value:i});if(typeof i=="string")return new ta({value:i.toLowerCase()==="yes"});throw new Error(`gr_poly fill expects yes/no or boolean, received ${JSON.stringify(i)}`)}getString(){return`(fill ${this.value?"yes":"no"})`}},d(ta,"token","fill"),d(ta,"parentToken","gr_poly"),ta);z.register(eT);var Bk,Rat=(Bk=class extends rn{constructor(){super(...arguments);d(this,"token","roundrect_rratio")}},d(Bk,"token","roundrect_rratio"),d(Bk,"parentToken","pad"),Bk);z.register(Rat);var fo,Oat=(fo=class extends z{constructor(t,i){super();d(this,"token","size");d(this,"_width");d(this,"_height");this._width=t,this._height=i}static from(t){return t instanceof fo?t:Array.isArray(t)?new fo(t[0],t[1]):new fo(t.width,t.height)}static fromSexprPrimitives(t){let i=Dt(t[0]),r=Dt(t[1]);if(i===void 0||r===void 0)throw new Error("size requires width and height numeric values");return new fo(i,r)}get width(){return this._width}set width(t){this._width=t}get height(){return this._height}set height(t){this._height=t}getChildren(){return[]}getString(){return`(size ${this._width} ${this._height})`}},d(fo,"token","size"),d(fo,"parentToken","pad"),fo);z.register(Oat);var Yk,Lat=(Yk=class extends rn{constructor(){super(...arguments);d(this,"token","solder_mask_margin")}},d(Yk,"token","solder_mask_margin"),d(Yk,"parentToken","pad"),Yk);z.register(Lat);var Xk,Fat=(Xk=class extends rn{constructor(){super(...arguments);d(this,"token","solder_paste_margin")}},d(Xk,"token","solder_paste_margin"),d(Xk,"parentToken","pad"),Xk);z.register(Fat);var Uk,zat=(Uk=class extends rn{constructor(){super(...arguments);d(this,"token","solder_paste_margin_ratio")}},d(Uk,"token","solder_paste_margin_ratio"),d(Uk,"parentToken","pad"),Uk);z.register(zat);var Vk,$at=(Vk=class extends rn{constructor(){super(...arguments);d(this,"token","thermal_gap")}},d(Vk,"token","thermal_gap"),d(Vk,"parentToken","pad"),Vk);z.register($at);var Gk,Dat=(Gk=class extends rn{constructor(){super(...arguments);d(this,"token","thermal_width")}},d(Gk,"token","thermal_width"),d(Gk,"parentToken","pad"),Gk);z.register(Dat);var Hk,jat=(Hk=class extends rn{constructor(){super(...arguments);d(this,"token","thermal_bridge_angle")}},d(Hk,"token","thermal_bridge_angle"),d(Hk,"parentToken","pad"),Hk);z.register(jat);var Wk,Bat=(Wk=class extends rn{constructor(){super(...arguments);d(this,"token","zone_connect")}},d(Wk,"token","zone_connect"),d(Wk,"parentToken","pad"),Wk);z.register(Bat);var w7=n=>{let e=jt(n);if(e){if(e==="yes"||e==="true")return!0;if(e==="no"||e==="false")return!1}},Not=new Map([["best_length_ratio","bestLengthRatio"],["max_length","maxLength"],["best_width_ratio","bestWidthRatio"],["max_width","maxWidth"],["filter_ratio","filterRatio"]]),Aot=new Map([["curved_edges","curvedEdges"],["enabled","enabled"],["allow_two_segments","allowTwoSegments"],["prefer_zone_connections","preferZoneConnections"]]),Qu,Yat=(Qu=class extends z{constructor(){super(...arguments);d(this,"token","teardrops");d(this,"_bestLengthRatio");d(this,"_maxLength");d(this,"_bestWidthRatio");d(this,"_maxWidth");d(this,"_filterRatio");d(this,"_curvedEdges");d(this,"_enabled");d(this,"_allowTwoSegments");d(this,"_preferZoneConnections")}static fromSexprPrimitives(t){let i=new Qu;for(let r of t){if(!Array.isArray(r)||r.length===0)throw new Error(`teardrops encountered invalid child expression: ${JSON.stringify(r)}`);let[s,o]=r;if(typeof s!="string")throw new Error(`teardrops encountered non-string token: ${JSON.stringify(s)}`);if(Not.has(s)){let a=Not.get(s),c=Dt(o);if(c===void 0)throw new Error(`teardrops ${s} expects a numeric value, received ${JSON.stringify(o)}`);i[a]=c;continue}if(Aot.has(s)){let a=Aot.get(s),c=w7(o);if(c===void 0)throw new Error(`teardrops ${s} expects yes/no, received ${JSON.stringify(o)}`);i[a]=c;continue}throw new Error(`teardrops encountered unsupported token "${s}"`)}return i}get bestLengthRatio(){return this._bestLengthRatio}set bestLengthRatio(t){this._bestLengthRatio=t}get maxLength(){return this._maxLength}set maxLength(t){this._maxLength=t}get bestWidthRatio(){return this._bestWidthRatio}set bestWidthRatio(t){this._bestWidthRatio=t}get maxWidth(){return this._maxWidth}set maxWidth(t){this._maxWidth=t}get filterRatio(){return this._filterRatio}set filterRatio(t){this._filterRatio=t}get curvedEdges(){return this._curvedEdges}set curvedEdges(t){this._curvedEdges=t}get enabled(){return this._enabled}set enabled(t){this._enabled=t}get allowTwoSegments(){return this._allowTwoSegments}set allowTwoSegments(t){this._allowTwoSegments=t}get preferZoneConnections(){return this._preferZoneConnections}set preferZoneConnections(t){this._preferZoneConnections=t}getChildren(){return[]}getString(){let t=["(teardrops"];return this._bestLengthRatio!==void 0&&t.push(`  (best_length_ratio ${this._bestLengthRatio})`),this._maxLength!==void 0&&t.push(`  (max_length ${this._maxLength})`),this._bestWidthRatio!==void 0&&t.push(`  (best_width_ratio ${this._bestWidthRatio})`),this._maxWidth!==void 0&&t.push(`  (max_width ${this._maxWidth})`),this._curvedEdges!==void 0&&t.push(`  (curved_edges ${this._curvedEdges?"yes":"no"})`),this._filterRatio!==void 0&&t.push(`  (filter_ratio ${this._filterRatio})`),this._enabled!==void 0&&t.push(`  (enabled ${this._enabled?"yes":"no"})`),this._allowTwoSegments!==void 0&&t.push(`  (allow_two_segments ${this._allowTwoSegments?"yes":"no"})`),this._preferZoneConnections!==void 0&&t.push(`  (prefer_zone_connections ${this._preferZoneConnections?"yes":"no"})`),t.push(")"),t.join(`
`)}},d(Qu,"token","teardrops"),d(Qu,"parentToken","pad"),Qu);z.register(Yat);var tp,VO=(tp=class extends z{constructor(t=0,i=0){super();d(this,"token","rect_delta");d(this,"_x");d(this,"_y");this._x=t,this._y=i}static fromSexprPrimitives(t){let[i,r]=t,s=Dt(i),o=Dt(r);if(s===void 0||o===void 0)throw new Error("pad rect_delta expects two numeric arguments");return new tp(s,o)}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}getChildren(){return[]}getString(){return`(rect_delta ${this._x} ${this._y})`}},d(tp,"token","rect_delta"),d(tp,"parentToken","pad"),tp);z.register(VO);var FBt=new Set(["at","size","drill","layers","width","stroke","rect_delta","roundrect_rratio","chamfer_ratio","chamfer","net","tstamp","uuid","pinfunction","pintype","die_length","solder_mask_margin","solder_paste_margin","solder_paste_margin_ratio","clearance","zone_connect","thermal_width","thermal_gap","thermal_bridge_angle","options","primitives","remove_unused_layers","keep_end_layers","teardrops"]),Xat=new Set(["property"]),Rot=new Set([...FBt,...Xat]),Xn=(n,e)=>{let t=n[e];if(t&&t.length>1)throw new Error(`pad does not support repeated "${e}" children`)},rf,zBt=(rf=class extends z{constructor(t,i,r){super();d(this,"token","pad");d(this,"_number","");d(this,"_padType","");d(this,"_shape","");d(this,"_locked",!1);d(this,"_sxRemoveUnusedLayers");d(this,"_sxKeepEndLayers");d(this,"_sxAt");d(this,"_sxSize");d(this,"_sxDrill");d(this,"_sxLayers");d(this,"_sxWidth");d(this,"_sxStroke");d(this,"_properties",[]);d(this,"_sxRoundrectRatio");d(this,"_sxChamferRatio");d(this,"_sxChamfer");d(this,"_sxRectDelta");d(this,"_sxNet");d(this,"_sxTstamp");d(this,"_sxUuid");d(this,"_sxPinFunction");d(this,"_sxPinType");d(this,"_sxDieLength");d(this,"_sxSolderMaskMargin");d(this,"_sxSolderPasteMargin");d(this,"_sxSolderPasteMarginRatio");d(this,"_sxClearance");d(this,"_sxZoneConnect");d(this,"_sxThermalWidth");d(this,"_sxThermalGap");d(this,"_sxThermalBridgeAngle");d(this,"_sxOptions");d(this,"_sxPrimitives");d(this,"_sxTeardrops");if(typeof t=="string"){this._number=t,this._padType=i||"",this._shape=r||"";return}let s=t||{};s.number!==void 0&&(this.number=s.number),s.padType!==void 0&&(this.padType=s.padType),s.shape!==void 0&&(this.shape=s.shape),s.locked!==void 0&&(this.locked=s.locked),s.removeUnusedLayers!==void 0&&(this.removeUnusedLayer=s.removeUnusedLayers),s.keepEndLayers!==void 0&&(this.keepEndLayers=s.keepEndLayers),s.at!==void 0&&(this.at=s.at),s.size!==void 0&&(this.size=s.size),s.drill!==void 0&&(this.drill=s.drill),s.layers!==void 0&&(this.layers=s.layers),s.width!==void 0&&(this.width=s.width),s.stroke!==void 0&&(this.stroke=s.stroke),s.properties!==void 0&&(this.properties=s.properties),s.roundrectRatio!==void 0&&(this.roundrectRatio=s.roundrectRatio),s.chamferRatio!==void 0&&(this.chamferRatio=s.chamferRatio),s.chamfer!==void 0&&(this.chamfer=s.chamfer),s.rectDelta!==void 0&&(this.rectDelta=s.rectDelta),s.net!==void 0&&(this.net=s.net),s.tstamp!==void 0&&(this.tstamp=s.tstamp),s.uuid!==void 0&&(this.uuid=s.uuid),s.pinFunction!==void 0&&(this.pinfunction=s.pinFunction),s.pinType!==void 0&&(this.pintype=s.pinType),s.dieLength!==void 0&&(this.dieLength=s.dieLength),s.solderMaskMargin!==void 0&&(this.solderMaskMargin=s.solderMaskMargin),s.solderPasteMargin!==void 0&&(this.solderPasteMargin=s.solderPasteMargin),s.solderPasteMarginRatio!==void 0&&(this.solderPasteMarginRatio=s.solderPasteMarginRatio),s.clearance!==void 0&&(this.clearance=s.clearance),s.zoneConnect!==void 0&&(this.zoneConnect=s.zoneConnect),s.thermalWidth!==void 0&&(this.thermalWidth=s.thermalWidth),s.thermalGap!==void 0&&(this.thermalGap=s.thermalGap),s.thermalBridgeAngle!==void 0&&(this.thermalBridgeAngle=s.thermalBridgeAngle),s.options!==void 0&&(this.options=s.options),s.primitives!==void 0&&(this.primitives=s.primitives),s.teardrops!==void 0&&(this.teardrops=s.teardrops)}static fromSexprPrimitives(t){if(t.length<3)throw new Error("pad requires number, type, and shape arguments");let[i,r,s,...o]=t,a=jt(i),c=jt(r),l=jt(s);if(a===void 0||c===void 0||l===void 0)throw new Error("pad header tokens must be strings");let u=new rf(a,c,l),p=[],f=[];for(let x of o)if(typeof x=="string")p.push(x);else if(Array.isArray(x))f.push(x);else throw new Error(`pad encountered unexpected primitive child: ${JSON.stringify(x)}`);for(let x of p)switch(x){case"locked":u._locked=!0;break;case"remove_unused_layer":u._sxRemoveUnusedLayers=new GO({value:!0,bareToken:"remove_unused_layer"});break;case"keep_end_layers":u._sxKeepEndLayers=new HO({value:!0,bare:!0});break;default:throw new Error(`pad encountered unsupported flag "${x}"`)}let{propertyMap:y,arrayPropertyMap:g}=z.parsePrimitivesToClassProperties(f,this.token);for(let x of Object.keys(y))if(!Rot.has(x))throw new Error(`pad encountered unsupported child token "${x}"`);for(let[x,v]of Object.entries(g)){if(!Rot.has(x))throw new Error(`pad encountered unsupported child token "${x}"`);if(!Xat.has(x)&&v.length>1)throw new Error(`pad does not support repeated child "${x}"`)}return Xn(g,"at"),Xn(g,"size"),Xn(g,"drill"),Xn(g,"layers"),Xn(g,"width"),Xn(g,"stroke"),Xn(g,"rect_delta"),Xn(g,"roundrect_rratio"),Xn(g,"chamfer_ratio"),Xn(g,"chamfer"),Xn(g,"net"),Xn(g,"uuid"),Xn(g,"pinfunction"),Xn(g,"pintype"),Xn(g,"die_length"),Xn(g,"solder_mask_margin"),Xn(g,"solder_paste_margin"),Xn(g,"solder_paste_margin_ratio"),Xn(g,"clearance"),Xn(g,"zone_connect"),Xn(g,"thermal_width"),Xn(g,"thermal_gap"),Xn(g,"thermal_bridge_angle"),Xn(g,"options"),Xn(g,"primitives"),u._sxAt=y.at,u._sxSize=y.size,u._sxDrill=y.drill,u._sxLayers=y.layers,u._sxWidth=y.width,u._sxStroke=y.stroke,u._sxRectDelta=y.rect_delta,u._properties=g.property??[],u._sxRoundrectRatio=y.roundrect_rratio,u._sxChamferRatio=y.chamfer_ratio,u._sxChamfer=y.chamfer,u._sxNet=y.net,u._sxTstamp=y.tstamp,u._sxUuid=y.uuid,u._sxPinFunction=y.pinfunction,u._sxPinType=y.pintype,u._sxDieLength=y.die_length,u._sxSolderMaskMargin=y.solder_mask_margin,u._sxSolderPasteMargin=y.solder_paste_margin,u._sxSolderPasteMarginRatio=y.solder_paste_margin_ratio,u._sxClearance=y.clearance,u._sxZoneConnect=y.zone_connect,u._sxThermalWidth=y.thermal_width,u._sxThermalGap=y.thermal_gap,u._sxThermalBridgeAngle=y.thermal_bridge_angle,u._sxOptions=y.options,u._sxPrimitives=y.primitives,u._sxRemoveUnusedLayers=g.remove_unused_layers?.[0]??u._sxRemoveUnusedLayers,u._sxKeepEndLayers=g.keep_end_layers?.[0]??u._sxKeepEndLayers,u._sxTeardrops=g.teardrops?.[0]??void 0,u}get number(){return this._number}set number(t){this._number=t}get padType(){return this._padType}set padType(t){this._padType=t}get shape(){return this._shape}set shape(t){this._shape=t}get locked(){return this._locked}set locked(t){this._locked=t}get removeUnusedLayer(){return this._sxRemoveUnusedLayers?.value??!1}set removeUnusedLayer(t){this._sxRemoveUnusedLayers=t?new GO({value:t}):void 0}get keepEndLayers(){return this._sxKeepEndLayers?.value??!1}set keepEndLayers(t){this._sxKeepEndLayers=t?new HO({value:t}):void 0}get at(){return this._sxAt}set at(t){this._sxAt=t!==void 0?Un.from(t):void 0}get size(){return this._sxSize}set size(t){this._sxSize=t!==void 0?Oat.from(t):void 0}get drill(){return this._sxDrill}set drill(t){this._sxDrill=t}get layers(){return this._sxLayers}set layers(t){this._sxLayers=t!==void 0?bat.from(t):void 0}get width(){return this._sxWidth}set width(t){if(t===void 0){this._sxWidth=void 0;return}this._sxWidth=typeof t=="number"?new Je(t):t}get stroke(){return this._sxStroke}set stroke(t){this._sxStroke=t}get properties(){return[...this._properties]}set properties(t){this._properties=[...t]}get roundrectRatio(){return this._sxRoundrectRatio?.value}set roundrectRatio(t){if(t===void 0){this._sxRoundrectRatio=void 0;return}this._sxRoundrectRatio=typeof t=="number"?new Rat(t):t}get chamferRatio(){return this._sxChamferRatio?.value}set chamferRatio(t){if(t===void 0){this._sxChamferRatio=void 0;return}this._sxChamferRatio=typeof t=="number"?new yat(t):t}get chamfer(){return this._sxChamfer}set chamfer(t){this._sxChamfer=t}get chamferCorners(){return this._sxChamfer?.corners}get rectDelta(){return this._sxRectDelta}set rectDelta(t){if(t===void 0){this._sxRectDelta=void 0;return}if(t instanceof VO){this._sxRectDelta=t;return}this._sxRectDelta=new VO(t.x,t.y)}get net(){return this._sxNet}set net(t){this._sxNet=t}get tstamp(){return this._sxTstamp}set tstamp(t){if(t===void 0){this._sxTstamp=void 0;return}this._sxTstamp=t instanceof En?t:new En(t)}get uuid(){return this._sxUuid}set uuid(t){if(t===void 0){this._sxUuid=void 0;return}this._sxUuid=t instanceof Vt?t:new Vt(t)}get pinfunction(){return this._sxPinFunction?.value}set pinfunction(t){if(t===void 0){this._sxPinFunction=void 0;return}this._sxPinFunction=typeof t=="string"?new vat(t):t}get pintype(){return this._sxPinType?.value}set pintype(t){if(t===void 0){this._sxPinType=void 0;return}this._sxPinType=typeof t=="string"?new Sat(t):t}get dieLength(){return this._sxDieLength?.value}set dieLength(t){if(t===void 0){this._sxDieLength=void 0;return}this._sxDieLength=typeof t=="number"?new xat(t):t}get solderMaskMargin(){return this._sxSolderMaskMargin?.value}set solderMaskMargin(t){if(t===void 0){this._sxSolderMaskMargin=void 0;return}this._sxSolderMaskMargin=typeof t=="number"?new Lat(t):t}get solderPasteMargin(){return this._sxSolderPasteMargin?.value}set solderPasteMargin(t){if(t===void 0){this._sxSolderPasteMargin=void 0;return}this._sxSolderPasteMargin=typeof t=="number"?new Fat(t):t}get solderPasteMarginRatio(){return this._sxSolderPasteMarginRatio?.value}set solderPasteMarginRatio(t){if(t===void 0){this._sxSolderPasteMarginRatio=void 0;return}this._sxSolderPasteMarginRatio=typeof t=="number"?new zat(t):t}get clearance(){return this._sxClearance?.value}set clearance(t){if(t===void 0){this._sxClearance=void 0;return}this._sxClearance=typeof t=="number"?new gat(t):t}get zoneConnect(){return this._sxZoneConnect?.value}set zoneConnect(t){if(t===void 0){this._sxZoneConnect=void 0;return}this._sxZoneConnect=typeof t=="number"?new Bat(t):t}get thermalWidth(){return this._sxThermalWidth?.value}set thermalWidth(t){if(t===void 0){this._sxThermalWidth=void 0;return}this._sxThermalWidth=typeof t=="number"?new Dat(t):t}get thermalGap(){return this._sxThermalGap?.value}set thermalGap(t){if(t===void 0){this._sxThermalGap=void 0;return}this._sxThermalGap=typeof t=="number"?new $at(t):t}get thermalBridgeAngle(){return this._sxThermalBridgeAngle?.value}set thermalBridgeAngle(t){if(t===void 0){this._sxThermalBridgeAngle=void 0;return}this._sxThermalBridgeAngle=typeof t=="number"?new jat(t):t}get options(){return this._sxOptions}set options(t){this._sxOptions=t}get primitives(){return this._sxPrimitives}set primitives(t){this._sxPrimitives=t}get teardrops(){return this._sxTeardrops}set teardrops(t){this._sxTeardrops=t}getChildren(){let t=[];return this._sxAt&&t.push(this._sxAt),this._sxSize&&t.push(this._sxSize),this._sxDrill&&t.push(this._sxDrill),this._sxLayers&&t.push(this._sxLayers),this._sxWidth&&t.push(this._sxWidth),this._sxStroke&&t.push(this._sxStroke),t.push(...this._properties),this._sxRoundrectRatio&&t.push(this._sxRoundrectRatio),this._sxChamferRatio&&t.push(this._sxChamferRatio),this._sxChamfer&&t.push(this._sxChamfer),this._sxRectDelta&&t.push(this._sxRectDelta),this._sxNet&&t.push(this._sxNet),this._sxPinFunction&&t.push(this._sxPinFunction),this._sxPinType&&t.push(this._sxPinType),this._sxDieLength&&t.push(this._sxDieLength),this._sxSolderMaskMargin&&t.push(this._sxSolderMaskMargin),this._sxSolderPasteMargin&&t.push(this._sxSolderPasteMargin),this._sxSolderPasteMarginRatio&&t.push(this._sxSolderPasteMarginRatio),this._sxClearance&&t.push(this._sxClearance),this._sxZoneConnect&&t.push(this._sxZoneConnect),this._sxThermalWidth&&t.push(this._sxThermalWidth),this._sxThermalGap&&t.push(this._sxThermalGap),this._sxThermalBridgeAngle&&t.push(this._sxThermalBridgeAngle),this._sxTstamp&&t.push(this._sxTstamp),this._sxUuid&&t.push(this._sxUuid),this._sxRemoveUnusedLayers&&t.push(this._sxRemoveUnusedLayers),this._sxKeepEndLayers&&t.push(this._sxKeepEndLayers),this._sxTeardrops&&t.push(this._sxTeardrops),this._sxOptions&&t.push(this._sxOptions),this._sxPrimitives&&t.push(this._sxPrimitives),t}getString(){let t=[`(pad ${re(this._number)} ${this._padType} ${this._shape}`];for(let i of this.getChildren())t.push(i.getStringIndented());return this._locked&&t.push("  locked"),t.push(")"),t.join(`
`)}},d(rf,"token","pad"),rf);z.register(zBt);var mo,GO=(mo=class extends ti{constructor(t={}){super(t.value??!1);d(this,"token","remove_unused_layers");d(this,"bareToken");this.bareToken=t.bareToken}static fromSexprPrimitives(t){let[i]=t;if(i===void 0)return new mo({value:!1});if(typeof i=="boolean")return new mo({value:i});if(typeof i=="string"){let r=i.toLowerCase();if(r==="yes"||r==="true")return new mo({value:!0});if(r==="no"||r==="false")return new mo({value:!1})}throw new Error(`remove_unused_layers expects yes/no or boolean, received ${JSON.stringify(i)}`)}getString(){return this.bareToken?this.bareToken:`(remove_unused_layers ${this.value?"yes":"no"})`}},d(mo,"token","remove_unused_layers"),d(mo,"parentToken","pad"),mo);z.register(GO);var _o,HO=(_o=class extends ti{constructor(t={}){super(t.value??!1);d(this,"token","keep_end_layers");d(this,"renderBare");this.renderBare=t.bare??!1}static fromSexprPrimitives(t){let[i]=t;if(i===void 0)return new _o({value:!1});if(typeof i=="boolean")return new _o({value:i});if(typeof i=="string"){let r=i.toLowerCase();if(r==="yes"||r==="true")return new _o({value:!0});if(r==="no"||r==="false")return new _o({value:!1})}throw new Error(`keep_end_layers expects yes/no or boolean, received ${JSON.stringify(i)}`)}getString(){return this.renderBare?"keep_end_layers":`(keep_end_layers ${this.value?"yes":"no"})`}},d(_o,"token","keep_end_layers"),d(_o,"parentToken","pad"),_o);z.register(HO);var Oot=new Set(["at","xy","layer","effects","tstamp","uuid","unlocked","hide"]),$Bt=new Set,sf,DBt=(sf=class extends z{constructor(t={}){super();d(this,"token","fp_text");d(this,"_type");d(this,"_text","");d(this,"_sxPosition");d(this,"_sxUnlocked");d(this,"_sxHide");d(this,"_sxLayer");d(this,"_sxEffects");d(this,"_sxTstamp");d(this,"_sxUuid");t.type!==void 0&&(this.type=t.type),t.text!==void 0&&(this.text=t.text),t.position!==void 0&&(this.position=t.position),t.unlocked!==void 0&&(this.unlocked=t.unlocked),t.hidden!==void 0&&(this.hidden=t.hidden),t.layer!==void 0&&(this.layer=t.layer),t.effects!==void 0&&(this.effects=t.effects),t.tstamp!==void 0&&(this.tstamp=t.tstamp),t.uuid!==void 0&&(this.uuid=t.uuid)}static fromSexprPrimitives(t){if(t.length<2)throw new Error("fp_text requires a type and text value");let[i,r,...s]=t,o=new sf;if(typeof i!="string")throw new Error(`fp_text type must be a string token, received ${JSON.stringify(i)}`);o._type=i,o._text=jBt(r);let a=[],c=!1,l=!1;for(let v of s){if(typeof v=="string"){if(v==="unlocked"){if(c)throw new Error("fp_text encountered duplicate bare unlocked tokens");c=!0;continue}if(v==="hide"){if(l)throw new Error("fp_text encountered duplicate bare hide tokens");l=!0;continue}throw new Error(`fp_text encountered unsupported flag "${v}"`)}if(!Array.isArray(v)||v.length===0)throw new Error(`fp_text encountered invalid child expression: ${JSON.stringify(v)}`);a.push(v)}let{propertyMap:u,arrayPropertyMap:p}=z.parsePrimitivesToClassProperties(a,this.token);for(let v of Object.keys(u))if(!Oot.has(v))throw new Error(`fp_text encountered unsupported child token "${v}"`);for(let[v,P]of Object.entries(p)){if(!Oot.has(v))throw new Error(`fp_text encountered unsupported child token "${v}"`);if(!$Bt.has(v)&&P.length>1)throw new Error(`fp_text does not support repeated child token "${v}"`)}let f=u.at,y=u.xy;if(f&&y)throw new Error("fp_text cannot include both at and xy child tokens");o._sxPosition=f??y,o._sxLayer=u.layer,o._sxEffects=u.effects,o._sxTstamp=u.tstamp,o._sxUuid=u.uuid;let g=u.unlocked,x=u.hide;if(g&&c)throw new Error("fp_text encountered both bare and structured unlocked tokens");if(x&&l)throw new Error("fp_text encountered both bare and structured hide tokens");return o._sxUnlocked=g,o._sxHide=x,c&&(o._sxUnlocked=new WO({value:!0,bare:!0})),l&&(o._sxHide=new qO({value:!0,bare:!0})),o}get type(){return this._type}set type(t){this._type=t}get text(){return this._text}set text(t){this._text=t}get position(){return this._sxPosition}set position(t){if(t===void 0){this._sxPosition=void 0;return}if(t instanceof Zr){this._sxPosition=t;return}this._sxPosition=Un.from(t)}get unlocked(){return this._sxUnlocked?.value??!1}set unlocked(t){this._sxUnlocked=t?new WO({value:!0,bare:!0}):void 0}get hidden(){return this._sxHide?.value??!1}set hidden(t){this._sxHide=t?new qO({value:!0,bare:!0}):void 0}get layer(){return this._sxLayer}set layer(t){if(t===void 0){this._sxLayer=void 0;return}if(t instanceof qe)this._sxLayer=t;else{let i=Array.isArray(t)?t:[t];this._sxLayer=new qe(i)}}get effects(){return this._sxEffects}set effects(t){this._sxEffects=t}get tstamp(){return this._sxTstamp}set tstamp(t){if(t===void 0){this._sxTstamp=void 0;return}this._sxTstamp=t instanceof En?t:new En(t)}get uuid(){return this._sxUuid}set uuid(t){if(t===void 0){this._sxUuid=void 0;return}this._sxUuid=t instanceof Vt?t:new Vt(t)}getChildren(){let t=[];return this._sxPosition&&t.push(this._sxPosition),this._sxUnlocked&&t.push(this._sxUnlocked),this._sxLayer&&t.push(this._sxLayer),this._sxHide&&t.push(this._sxHide),this._sxEffects&&t.push(this._sxEffects),this._sxTstamp&&t.push(this._sxTstamp),this._sxUuid&&t.push(this._sxUuid),t}getString(){let t=["(fp_text"];this._type!==void 0&&t.push(`  ${this._type}`),t.push(`  ${re(this._text)}`);for(let i of this.getChildren())t.push(i.getStringIndented());return t.push(")"),t.join(`
`)}},d(sf,"token","fp_text"),sf);z.register(DBt);function jBt(n){if(n===void 0)return"";let e=jt(n);return e!==void 0?e:Wi(n)}var ep,WO=(ep=class extends z{constructor(t={}){super();d(this,"token","unlocked");d(this,"value");d(this,"renderBare");this.value=t.value??!0,this.renderBare=t.bare??!1}static fromSexprPrimitives(t){let[i]=t,r=jt(i),s=r===void 0?!0:!/^(no|false)$/iu.test(r);return new ep({value:s,bare:!1})}getChildren(){return[]}getString(){return this.renderBare?"unlocked":`(unlocked ${this.value?"yes":"no"})`}},d(ep,"token","unlocked"),d(ep,"parentToken","fp_text"),ep);z.register(WO);var np,qO=(np=class extends z{constructor(t={}){super();d(this,"token","hide");d(this,"value");d(this,"renderBare");this.value=t.value??!0,this.renderBare=t.bare??!1}static fromSexprPrimitives(t){let[i]=t,r=jt(i),s=r===void 0?!0:!/^(no|false)$/iu.test(r);return new np({value:s,bare:!1})}getChildren(){return[]}getString(){return this.renderBare?"hide":`(hide ${this.value?"yes":"no"})`}},d(np,"token","hide"),d(np,"parentToken","fp_text"),np);z.register(qO);function BBt(n){if(n===void 0)return"";let e=jt(n);return e!==void 0?e:Wi(n)}var Lot=new Set(["start","end","pts","angle","layer","uuid","effects","stroke","render_cache"]),YBt=new Set,of,XBt=(of=class extends z{constructor(t={}){super();d(this,"token","fp_text_box");d(this,"_sxLocked");d(this,"_text","");d(this,"_sxStart");d(this,"_sxEnd");d(this,"_sxPts");d(this,"_sxAngle");d(this,"_sxLayer");d(this,"_sxUuid");d(this,"_sxEffects");d(this,"_sxStroke");d(this,"_sxRenderCache");t.locked!==void 0&&(this.locked=t.locked),t.text!==void 0&&(this.text=t.text),t.start!==void 0&&(this.start=t.start),t.end!==void 0&&(this.end=t.end),t.pts!==void 0&&(this.pts=t.pts),t.angle!==void 0&&(this.angle=t.angle),t.layer!==void 0&&(this.layer=t.layer),t.uuid!==void 0&&(this.uuid=t.uuid),t.effects!==void 0&&(this.effects=t.effects),t.stroke!==void 0&&(this.stroke=t.stroke),t.renderCache!==void 0&&(this.renderCache=t.renderCache)}static fromSexprPrimitives(t){let i=new of;if(t.length===0)throw new Error("fp_text_box requires a text value");let r=!1,s=!1,o=[];for(let l of t){if(typeof l=="string"){if(l==="locked"){if(s)throw new Error("fp_text_box encountered duplicate locked flags");s=!0;continue}if(!r){i._text=l,r=!0;continue}throw new Error(`fp_text_box encountered unsupported flag "${l}"`)}if(!r){i._text=BBt(l),r=!0;continue}if(!Array.isArray(l)||l.length===0)throw new Error(`fp_text_box encountered invalid child expression: ${JSON.stringify(l)}`);o.push(l)}if(!r)throw new Error("fp_text_box did not include a text value");s&&(i._sxLocked=new QO);let{propertyMap:a,arrayPropertyMap:c}=z.parsePrimitivesToClassProperties(o,this.token);for(let l of Object.keys(a))if(!Lot.has(l))throw new Error(`fp_text_box encountered unsupported child token "${l}"`);for(let[l,u]of Object.entries(c)){if(!Lot.has(l))throw new Error(`fp_text_box encountered unsupported child token "${l}"`);if(!YBt.has(l)&&u.length>1)throw new Error(`fp_text_box does not support repeated child token "${l}"`)}return i._sxStart=a.start,i._sxEnd=a.end,i._sxPts=a.pts,i._sxAngle=a.angle,i._sxLayer=a.layer,i._sxUuid=a.uuid,i._sxEffects=a.effects,i._sxStroke=a.stroke,i._sxRenderCache=a.render_cache,i}get locked(){return this._sxLocked!==void 0}set locked(t){this._sxLocked=t?new QO:void 0}get text(){return this._text}set text(t){this._text=t}get start(){return this._sxStart}set start(t){if(t===void 0){this._sxStart=void 0;return}this._sxStart=t instanceof ZO?t:new ZO([t.x,t.y])}get end(){return this._sxEnd}set end(t){if(t===void 0){this._sxEnd=void 0;return}this._sxEnd=t instanceof KO?t:new KO([t.x,t.y])}get pts(){return this._sxPts}set pts(t){this._sxPts=t}get angle(){return this._sxAngle}set angle(t){if(t===void 0){this._sxAngle=void 0;return}this._sxAngle=t instanceof JO?t:new JO([t])}get layer(){return this._sxLayer}set layer(t){if(t===void 0){this._sxLayer=void 0;return}if(t instanceof qe)this._sxLayer=t;else{let i=Array.isArray(t)?t:[t];this._sxLayer=new qe(i)}}get effects(){return this._sxEffects}set effects(t){this._sxEffects=t}get stroke(){return this._sxStroke}set stroke(t){this._sxStroke=t}get uuid(){return this._sxUuid}set uuid(t){if(t===void 0){this._sxUuid=void 0;return}this._sxUuid=t instanceof Vt?t:new Vt(t)}get renderCache(){return this._sxRenderCache}set renderCache(t){this._sxRenderCache=t}getChildren(){let t=[];return this._sxLocked&&t.push(this._sxLocked),this._sxStart&&t.push(this._sxStart),this._sxEnd&&t.push(this._sxEnd),this._sxPts&&t.push(this._sxPts),this._sxAngle&&t.push(this._sxAngle),this._sxLayer&&t.push(this._sxLayer),this._sxEffects&&t.push(this._sxEffects),this._sxStroke&&t.push(this._sxStroke),this._sxUuid&&t.push(this._sxUuid),this._sxRenderCache&&t.push(this._sxRenderCache),t}getString(){let t=["(fp_text_box"];this._sxLocked&&t.push(this._sxLocked.getStringIndented()),t.push(`  ${re(this._text)}`);for(let i of this.getChildren())i!==this._sxLocked&&t.push(i.getStringIndented());return t.push(")"),t.join(`
`)}},d(of,"token","fp_text_box"),of);z.register(XBt);var ip,ZO=(ip=class extends z{constructor(t){super();d(this,"token","start");d(this,"x");d(this,"y");this.x=t[0],this.y=t[1]}static fromSexprPrimitives(t){let[i,r]=t,s=Number(i),o=Number(r);return new ip([Number.isFinite(s)?s:0,Number.isFinite(o)?o:0])}getChildren(){return[]}getString(){return`(start ${this.x} ${this.y})`}},d(ip,"token","start"),d(ip,"parentToken","fp_text_box"),ip);z.register(ZO);var rp,KO=(rp=class extends z{constructor(t){super();d(this,"token","end");d(this,"x");d(this,"y");this.x=t[0],this.y=t[1]}static fromSexprPrimitives(t){let[i,r]=t,s=Number(i),o=Number(r);return new rp([Number.isFinite(s)?s:0,Number.isFinite(o)?o:0])}getChildren(){return[]}getString(){return`(end ${this.x} ${this.y})`}},d(rp,"token","end"),d(rp,"parentToken","fp_text_box"),rp);z.register(KO);var sp,JO=(sp=class extends z{constructor(t){super();d(this,"token","angle");d(this,"value");this.value=t[0]}static fromSexprPrimitives(t){let[i]=t,r=typeof i=="number"?i:Dt(i)??0;return new sp([r])}getChildren(){return[]}getString(){return`(angle ${this.value})`}},d(sp,"token","angle"),d(sp,"parentToken","fp_text_box"),sp);z.register(JO);var op,QO=(op=class extends z{constructor(){super(...arguments);d(this,"token","locked")}static fromSexprPrimitives(){return new op}getChildren(){return[]}getString(){return"locked"}},d(op,"token","locked"),d(op,"parentToken","fp_text_box"),op);z.register(QO);var af,UBt=(af=class extends z{constructor(t={}){super();d(this,"token","fp_rect");d(this,"_sxStart");d(this,"_sxEnd");d(this,"_sxLayer");d(this,"_sxWidth");d(this,"_sxStroke");d(this,"_sxFill");d(this,"_sxUuid");d(this,"_locked",!1);t.start!==void 0&&(this.start=t.start),t.end!==void 0&&(this.end=t.end),t.layer!==void 0&&(this.layer=t.layer),t.width!==void 0&&(this.width=t.width),t.stroke!==void 0&&(this.stroke=t.stroke),t.fill!==void 0&&(this.fill=t.fill),t.uuid!==void 0&&(this.uuid=t.uuid),t.locked!==void 0&&(this.locked=t.locked)}static fromSexprPrimitives(t){let i=new af,{propertyMap:r}=z.parsePrimitivesToClassProperties(t,this.token);i._sxStart=r.start,i._sxEnd=r.end,i._sxLayer=r.layer,i._sxWidth=r.width,i._sxStroke=r.stroke,i._sxFill=r.fill,i._sxUuid=r.uuid;for(let s of t)s==="locked"&&(i._locked=!0);return i}get start(){return this._sxStart}set start(t){if(t===void 0){this._sxStart=void 0;return}if(t instanceof tL){this._sxStart=t;return}this._sxStart=new tL(t.x,t.y)}get end(){return this._sxEnd}set end(t){if(t===void 0){this._sxEnd=void 0;return}if(t instanceof eL){this._sxEnd=t;return}this._sxEnd=new eL(t.x,t.y)}get layer(){return this._sxLayer}set layer(t){if(t===void 0){this._sxLayer=void 0;return}if(t instanceof qe){this._sxLayer=t;return}let i=Array.isArray(t)?t:[t];this._sxLayer=new qe(i)}get stroke(){return this._sxStroke}set stroke(t){this._sxStroke=t}get width(){return this._sxWidth?.value}set width(t){if(t===void 0){this._sxWidth=void 0;return}if(t instanceof Je){this._sxWidth=t;return}this._sxWidth=new Je(t)}get widthClass(){return this._sxWidth}get fill(){return this._sxFill?.filled}set fill(t){if(t===void 0){this._sxFill=void 0;return}if(t instanceof nL){this._sxFill=t;return}this._sxFill=new nL(t)}get fillClass(){return this._sxFill}get uuid(){return this._sxUuid?.value}set uuid(t){if(t===void 0){this._sxUuid=void 0;return}if(t instanceof Vt){this._sxUuid=t;return}this._sxUuid=new Vt(t)}get uuidClass(){return this._sxUuid}get locked(){return this._locked}set locked(t){this._locked=t}getChildren(){let t=[];return this._sxStart&&t.push(this._sxStart),this._sxEnd&&t.push(this._sxEnd),this._sxLayer&&t.push(this._sxLayer),this._sxWidth&&t.push(this._sxWidth),this._sxStroke&&t.push(this._sxStroke),this._sxFill&&t.push(this._sxFill),this._sxUuid&&t.push(this._sxUuid),t}getString(){let t=["(fp_rect"],i=r=>{r&&t.push(r.getStringIndented())};return i(this._sxStart),i(this._sxEnd),i(this._sxLayer),i(this._sxWidth),i(this._sxStroke),i(this._sxFill),i(this._sxUuid),this._locked&&t.push("  locked"),t.push(")"),t.join(`
`)}},d(af,"token","fp_rect"),af);z.register(UBt);var ap,tL=(ap=class extends z{constructor(t,i){super();d(this,"token","start");d(this,"x");d(this,"y");this.x=t,this.y=i}static fromSexprPrimitives(t){let i=Dt(t[0])??0,r=Dt(t[1])??0;return new ap(i,r)}getString(){return`(start ${this.x} ${this.y})`}},d(ap,"token","start"),d(ap,"parentToken","fp_rect"),ap);z.register(tL);var cp,eL=(cp=class extends z{constructor(t,i){super();d(this,"token","end");d(this,"x");d(this,"y");this.x=t,this.y=i}static fromSexprPrimitives(t){let i=Dt(t[0])??0,r=Dt(t[1])??0;return new cp(i,r)}getString(){return`(end ${this.x} ${this.y})`}},d(cp,"token","end"),d(cp,"parentToken","fp_rect"),cp);z.register(eL);var lp,nL=(lp=class extends z{constructor(t){super();d(this,"token","fill");d(this,"filled");this.filled=t}static fromSexprPrimitives(t){let i=jt(t[0]);return new lp(i==="yes")}getString(){return`(fill ${this.filled?"yes":"no"})`}},d(lp,"token","fill"),d(lp,"parentToken","fp_rect"),lp);z.register(nL);var cf,VBt=(cf=class extends z{constructor(t={}){super();d(this,"token","fp_circle");d(this,"_sxCenter");d(this,"_sxEnd");d(this,"_sxLayer");d(this,"_sxWidth");d(this,"_sxStroke");d(this,"_sxFill");d(this,"_sxUuid");d(this,"_locked",!1);t.center!==void 0&&(this.center=t.center),t.end!==void 0&&(this.end=t.end),t.layer!==void 0&&(this.layer=t.layer),t.width!==void 0&&(this.width=t.width),t.stroke!==void 0&&(this.stroke=t.stroke),t.fill!==void 0&&(this.fill=t.fill),t.uuid!==void 0&&(this.uuid=t.uuid),t.locked!==void 0&&(this.locked=t.locked)}static fromSexprPrimitives(t){let i=new cf,{propertyMap:r}=z.parsePrimitivesToClassProperties(t,this.token);i._sxCenter=r.center,i._sxEnd=r.end,i._sxLayer=r.layer,i._sxWidth=r.width,i._sxStroke=r.stroke,i._sxFill=r.fill,i._sxUuid=r.uuid;for(let s of t)s==="locked"&&(i._locked=!0);return i}get center(){return this._sxCenter}set center(t){if(t===void 0){this._sxCenter=void 0;return}if(t instanceof iL){this._sxCenter=t;return}this._sxCenter=new iL(t.x,t.y)}get end(){return this._sxEnd}set end(t){if(t===void 0){this._sxEnd=void 0;return}if(t instanceof rL){this._sxEnd=t;return}this._sxEnd=new rL(t.x,t.y)}get layer(){return this._sxLayer}set layer(t){if(t===void 0){this._sxLayer=void 0;return}if(t instanceof qe){this._sxLayer=t;return}let i=Array.isArray(t)?t:[t];this._sxLayer=new qe(i)}get width(){return this._sxWidth?.value}set width(t){if(t===void 0){this._sxWidth=void 0;return}if(t instanceof Je){this._sxWidth=t;return}this._sxWidth=new Je(t)}get widthClass(){return this._sxWidth}get stroke(){return this._sxStroke}set stroke(t){this._sxStroke=t}get fill(){return this._sxFill?.filled}set fill(t){if(t===void 0){this._sxFill=void 0;return}if(t instanceof sL){this._sxFill=t;return}this._sxFill=new sL(t)}get fillClass(){return this._sxFill}get uuid(){return this._sxUuid?.value}set uuid(t){if(t===void 0){this._sxUuid=void 0;return}if(t instanceof Vt){this._sxUuid=t;return}this._sxUuid=new Vt(t)}get uuidClass(){return this._sxUuid}get locked(){return this._locked}set locked(t){this._locked=t}getChildren(){let t=[];return this._sxCenter&&t.push(this._sxCenter),this._sxEnd&&t.push(this._sxEnd),this._sxLayer&&t.push(this._sxLayer),this._sxWidth&&t.push(this._sxWidth),this._sxStroke&&t.push(this._sxStroke),this._sxFill&&t.push(this._sxFill),this._sxUuid&&t.push(this._sxUuid),t}getString(){let t=["(fp_circle"],i=r=>{r&&t.push(r.getStringIndented())};return i(this._sxCenter),i(this._sxEnd),i(this._sxLayer),i(this._sxWidth),i(this._sxStroke),i(this._sxFill),i(this._sxUuid),this._locked&&t.push("  locked"),t.push(")"),t.join(`
`)}},d(cf,"token","fp_circle"),cf);z.register(VBt);var up,iL=(up=class extends z{constructor(t,i){super();d(this,"token","center");d(this,"x");d(this,"y");this.x=t,this.y=i}static fromSexprPrimitives(t){let i=Dt(t[0])??0,r=Dt(t[1])??0;return new up(i,r)}getString(){return`(center ${this.x} ${this.y})`}},d(up,"token","center"),d(up,"parentToken","fp_circle"),up);z.register(iL);var pp,rL=(pp=class extends z{constructor(t,i){super();d(this,"token","end");d(this,"x");d(this,"y");this.x=t,this.y=i}static fromSexprPrimitives(t){let i=Dt(t[0])??0,r=Dt(t[1])??0;return new pp(i,r)}getString(){return`(end ${this.x} ${this.y})`}},d(pp,"token","end"),d(pp,"parentToken","fp_circle"),pp);z.register(rL);var hp,sL=(hp=class extends z{constructor(t){super();d(this,"token","fill");d(this,"filled");this.filled=t}static fromSexprPrimitives(t){let i=jt(t[0]);return new hp(i==="yes")}getString(){return`(fill ${this.filled?"yes":"no"})`}},d(hp,"token","fill"),d(hp,"parentToken","fp_circle"),hp);z.register(sL);var lf,GBt=(lf=class extends z{constructor(t={}){super();d(this,"token","fp_arc");d(this,"_sxStart");d(this,"_sxMid");d(this,"_sxEnd");d(this,"_sxLayer");d(this,"_sxWidth");d(this,"_sxStroke");d(this,"_sxTstamp");d(this,"_sxUuid");d(this,"_locked",!1);t.start!==void 0&&(this.start=t.start),t.mid!==void 0&&(this.mid=t.mid),t.end!==void 0&&(this.end=t.end),t.layer!==void 0&&(this.layer=t.layer),t.width!==void 0&&(this.width=t.width),t.stroke!==void 0&&(this.stroke=t.stroke),t.tstamp!==void 0&&(this.tstamp=t.tstamp),t.uuid!==void 0&&(this.uuid=t.uuid),t.locked!==void 0&&(this.locked=t.locked)}static fromSexprPrimitives(t){let i=new lf,{propertyMap:r}=z.parsePrimitivesToClassProperties(t,this.token);i._sxStart=r.start,i._sxMid=r.mid,i._sxEnd=r.end,i._sxLayer=r.layer,i._sxWidth=r.width,i._sxStroke=r.stroke,i._sxTstamp=r.tstamp,i._sxUuid=r.uuid;for(let s of t)s==="locked"&&(i._locked=!0);return i}get start(){return this._sxStart}set start(t){if(t===void 0){this._sxStart=void 0;return}if(t instanceof oL){this._sxStart=t;return}this._sxStart=new oL(t.x,t.y)}get mid(){return this._sxMid}set mid(t){if(t===void 0){this._sxMid=void 0;return}if(t instanceof aL){this._sxMid=t;return}this._sxMid=new aL(t.x,t.y)}get end(){return this._sxEnd}set end(t){if(t===void 0){this._sxEnd=void 0;return}if(t instanceof cL){this._sxEnd=t;return}this._sxEnd=new cL(t.x,t.y)}get layer(){return this._sxLayer}set layer(t){if(t===void 0){this._sxLayer=void 0;return}if(t instanceof qe){this._sxLayer=t;return}let i=Array.isArray(t)?t:[t];this._sxLayer=new qe(i)}get width(){return this._sxWidth?.value}set width(t){if(t===void 0){this._sxWidth=void 0;return}if(t instanceof Je){this._sxWidth=t;return}this._sxWidth=new Je(t)}get widthClass(){return this._sxWidth}get stroke(){return this._sxStroke}set stroke(t){this._sxStroke=t}get tstamp(){return this._sxTstamp}set tstamp(t){if(t===void 0){this._sxTstamp=void 0;return}this._sxTstamp=t instanceof En?t:new En(t)}get uuid(){return this._sxUuid?.value}set uuid(t){if(t===void 0){this._sxUuid=void 0;return}if(t instanceof Vt){this._sxUuid=t;return}this._sxUuid=new Vt(t)}get uuidClass(){return this._sxUuid}get locked(){return this._locked}set locked(t){this._locked=t}getChildren(){let t=[];return this._sxStart&&t.push(this._sxStart),this._sxMid&&t.push(this._sxMid),this._sxEnd&&t.push(this._sxEnd),this._sxLayer&&t.push(this._sxLayer),this._sxWidth&&t.push(this._sxWidth),this._sxStroke&&t.push(this._sxStroke),this._sxTstamp&&t.push(this._sxTstamp),this._sxUuid&&t.push(this._sxUuid),t}getString(){let t=["(fp_arc"],i=r=>{r&&t.push(r.getStringIndented())};return i(this._sxStart),i(this._sxMid),i(this._sxEnd),i(this._sxLayer),i(this._sxWidth),i(this._sxStroke),i(this._sxTstamp),i(this._sxUuid),this._locked&&t.push("  locked"),t.push(")"),t.join(`
`)}},d(lf,"token","fp_arc"),lf);z.register(GBt);var dp,oL=(dp=class extends z{constructor(t,i){super();d(this,"token","start");d(this,"x");d(this,"y");this.x=t,this.y=i}static fromSexprPrimitives(t){let i=Dt(t[0])??0,r=Dt(t[1])??0;return new dp(i,r)}getString(){return`(start ${this.x} ${this.y})`}},d(dp,"token","start"),d(dp,"parentToken","fp_arc"),dp);z.register(oL);var fp,aL=(fp=class extends z{constructor(t,i){super();d(this,"token","mid");d(this,"x");d(this,"y");this.x=t,this.y=i}static fromSexprPrimitives(t){let i=Dt(t[0])??0,r=Dt(t[1])??0;return new fp(i,r)}getString(){return`(mid ${this.x} ${this.y})`}},d(fp,"token","mid"),d(fp,"parentToken","fp_arc"),fp);z.register(aL);var mp,cL=(mp=class extends z{constructor(t,i){super();d(this,"token","end");d(this,"x");d(this,"y");this.x=t,this.y=i}static fromSexprPrimitives(t){let i=Dt(t[0])??0,r=Dt(t[1])??0;return new mp(i,r)}getString(){return`(end ${this.x} ${this.y})`}},d(mp,"token","end"),d(mp,"parentToken","fp_arc"),mp);z.register(cL);var HBt=new Set(["yes","true","1","solid"]),yo,lL=(yo=class extends z{constructor(t){super();d(this,"token","fill");d(this,"value");typeof t=="boolean"?this.value=t?"yes":"no":this.value=t}static fromSexprPrimitives(t){let[i]=t;return i===void 0?new yo("no"):typeof i=="boolean"?new yo(i):typeof i=="string"?new yo(i):new yo("no")}get filled(){return HBt.has(this.value.toLowerCase())}set filled(t){this.value=t?"yes":"no"}getString(){return`(fill ${this.value})`}},d(yo,"token","fill"),d(yo,"parentToken","fp_poly"),yo);z.register(lL);var WBt=new Set(["yes","true","1"]),go,nT=(go=class extends ti{constructor(t){super(t);d(this,"token","locked")}static fromSexprPrimitives(t){let[i]=t;return i===void 0?new go(!0):typeof i=="boolean"?new go(i):typeof i=="string"?new go(WBt.has(i.toLowerCase())):new go(!1)}getString(){return`(locked ${this.value?"yes":"no"})`}},d(go,"token","locked"),d(go,"parentToken","fp_poly"),go);z.register(nT);var J6=new Set(["pts","xy","layer","width","stroke","fill","locked","tstamp","uuid"]),uf,qBt=(uf=class extends z{constructor(t={}){super();d(this,"token","fp_poly");d(this,"_sxPts");d(this,"_sxLayer");d(this,"_sxWidth");d(this,"_sxStroke");d(this,"_sxFill");d(this,"_sxLocked");d(this,"_sxTstamp");d(this,"_sxUuid");t.points!==void 0&&(this.points=t.points),t.layer!==void 0&&(this.layer=t.layer),t.width!==void 0&&(this.width=t.width),t.stroke!==void 0&&(this.stroke=t.stroke),t.fill!==void 0&&(this.fill=t.fill),t.locked!==void 0&&(this.locked=t.locked),t.tstamp!==void 0&&(this.tstamp=t.tstamp),t.uuid!==void 0&&(this.uuid=t.uuid)}static fromSexprPrimitives(t){let i=new uf,{propertyMap:r,arrayPropertyMap:s}=z.parsePrimitivesToClassProperties(t,this.token),o=new Set;for(let p of Object.keys(r))J6.has(p)||o.add(p);for(let p of Object.keys(s))J6.has(p)||o.add(p),p!=="xy"&&s[p].length>1&&o.add(p);if(o.size>0)throw new Error(`Unsupported child tokens inside fp_poly expression: ${[...o].join(", ")}`);let a=s.pts;if(a&&a.length>1)throw new Error("fp_poly does not support repeated pts tokens");let c=s.xy,l=r.pts;if(l&&c&&c.length>0)throw new Error("fp_poly cannot mix pts and xy child tokens");!l&&a?.length&&(l=a[0]),!l&&c&&c.length>0&&(l=new Sr(c)),i._sxPts=l,i._sxLayer=r.layer,i._sxWidth=r.width,i._sxStroke=r.stroke,i._sxFill=r.fill;let u=r.locked;i._sxLocked=u&&u.value?u:void 0,i._sxTstamp=r.tstamp,i._sxUuid=r.uuid;for(let p of t){if(p==="locked"){i._sxLocked||(i._sxLocked=new nT(!0));continue}if(!Array.isArray(p)||p.length===0)throw new Error(`fp_poly encountered unexpected primitive child: ${JSON.stringify(p)}`);let[f,...y]=p;if(typeof f!="string")throw new Error(`fp_poly child token must be a string, received: ${JSON.stringify(f)}`);if(!J6.has(f))throw new Error(`Unsupported child token inside fp_poly expression: ${f}`);f==="locked"&&!i._sxLocked&&(i._sxLocked=nT.fromSexprPrimitives(y),i._sxLocked.value||(i._sxLocked=void 0))}if(!i._sxPts)throw new Error("fp_poly requires pts or xy child tokens");if(!i._sxLayer)throw new Error("fp_poly requires a layer child token");if(!i._sxUuid&&!i._sxTstamp)throw new Error("fp_poly requires a uuid or tstamp child token");return i}get points(){return this._sxPts}set points(t){if(t===void 0){this._sxPts=void 0;return}if(t instanceof Sr){this._sxPts=t;return}if(Array.isArray(t)&&t.every(i=>i instanceof Zr)){this._sxPts=new Sr(t);return}if(Array.isArray(t)){this._sxPts=new Sr(t.map(({x:i,y:r})=>new Zr(i,r)));return}throw new Error("Unsupported points value provided to fp_poly")}get layer(){return this._sxLayer}set layer(t){if(t===void 0){this._sxLayer=void 0;return}if(t instanceof qe){this._sxLayer=t;return}let i=Array.isArray(t)?t:[t];this._sxLayer=new qe(i)}get width(){return this._sxWidth?.value}set width(t){if(t===void 0){this._sxWidth=void 0;return}this._sxWidth=t instanceof Je?t:new Je(t)}get widthClass(){return this._sxWidth}set widthClass(t){this._sxWidth=t}get stroke(){return this._sxStroke}set stroke(t){this._sxStroke=t}get fill(){return this._sxFill}set fill(t){if(t===void 0){this._sxFill=void 0;return}if(t instanceof lL){this._sxFill=t;return}this._sxFill=new lL(t)}get locked(){return this._sxLocked?.value??!1}set locked(t){this._sxLocked=t?new nT(!0):void 0}get tstamp(){return this._sxTstamp}set tstamp(t){if(t===void 0){this._sxTstamp=void 0;return}this._sxTstamp=t instanceof En?t:new En(t)}get uuid(){return this._sxUuid}set uuid(t){if(t===void 0){this._sxUuid=void 0;return}this._sxUuid=t instanceof Vt?t:new Vt(t)}getChildren(){let t=[];return this._sxPts&&t.push(this._sxPts),this._sxLayer&&t.push(this._sxLayer),this._sxWidth&&t.push(this._sxWidth),this._sxStroke&&t.push(this._sxStroke),this._sxFill&&t.push(this._sxFill),this._sxLocked&&t.push(this._sxLocked),this._sxTstamp&&t.push(this._sxTstamp),this._sxUuid&&t.push(this._sxUuid),t}},d(uf,"token","fp_poly"),uf);z.register(qBt);var _p,uL=(_p=class extends z{constructor(t){super();d(this,"token","sheetname");d(this,"_value");this._value=t}static fromSexprPrimitives(t){let i=jt(t[0]);if(i===void 0)throw new Error("sheetname expects a string value");return new _p(i)}get value(){return this._value}set value(t){this._value=t}getChildren(){return[]}getString(){return`(sheetname ${re(this._value)})`}},d(_p,"token","sheetname"),d(_p,"parentToken","footprint"),_p);z.register(uL);var yp,pL=(yp=class extends z{constructor(t){super();d(this,"token","sheetfile");d(this,"_value");this._value=t}static fromSexprPrimitives(t){let i=jt(t[0]);if(i===void 0)throw new Error("sheetfile expects a string value");return new yp(i)}get value(){return this._value}set value(t){this._value=t}getChildren(){return[]}getString(){return`(sheetfile ${re(this._value)})`}},d(yp,"token","sheetfile"),d(yp,"parentToken","footprint"),yp);z.register(pL);var Fot=new Set(["start","end","layer","width","stroke","tstamp","uuid"]),gp,ZBt=(gp=class extends z{constructor(t={}){super();d(this,"token","fp_line");d(this,"_sxStart");d(this,"_sxEnd");d(this,"_sxLayer");d(this,"_sxWidth");d(this,"_sxStroke");d(this,"_sxTstamp");d(this,"_sxUuid");d(this,"_locked",!1);t.start!==void 0&&(this.start=t.start),t.end!==void 0&&(this.end=t.end),t.layer!==void 0&&(this.layer=t.layer),t.width!==void 0&&(this.width=t.width),t.stroke!==void 0&&(this.stroke=t.stroke),t.tstamp!==void 0&&(this.tstamp=t.tstamp),t.uuid!==void 0&&(this.uuid=t.uuid),t.locked!==void 0&&(this.locked=t.locked)}static fromSexprPrimitives(t){let i=new gp,r=[];for(let a of t){if(typeof a=="string"){if(a==="locked"){if(i._locked)throw new Error("fp_line encountered duplicate locked flags");i._locked=!0;continue}throw new Error(`fp_line encountered unsupported flag "${a}"`)}if(!Array.isArray(a)||a.length===0)throw new Error(`fp_line encountered invalid child expression: ${JSON.stringify(a)}`);r.push(a)}let{propertyMap:s,arrayPropertyMap:o}=z.parsePrimitivesToClassProperties(r,this.token);for(let a of Object.keys(s))if(!Fot.has(a))throw new Error(`fp_line encountered unsupported child token "${a}"`);for(let[a,c]of Object.entries(o)){if(!Fot.has(a))throw new Error(`fp_line encountered unsupported child token "${a}"`);if(c.length>1)throw new Error(`fp_line does not support repeated child token "${a}"`)}if(i._sxStart=o.start?.[0]??s.start,i._sxEnd=o.end?.[0]??s.end,i._sxLayer=o.layer?.[0]??s.layer,i._sxWidth=o.width?.[0]??s.width,i._sxStroke=o.stroke?.[0]??s.stroke,i._sxTstamp=o.tstamp?.[0]??s.tstamp,i._sxUuid=o.uuid?.[0]??s.uuid,!i._sxStart)throw new Error("fp_line requires a start child token");if(!i._sxEnd)throw new Error("fp_line requires an end child token");if(!i._sxLayer)throw new Error("fp_line requires a layer child token");return i}get start(){return this._sxStart}set start(t){if(t===void 0){this._sxStart=void 0;return}this._sxStart=t instanceof hL?t:new hL(t.x,t.y)}get end(){return this._sxEnd}set end(t){if(t===void 0){this._sxEnd=void 0;return}this._sxEnd=t instanceof dL?t:new dL(t.x,t.y)}get layer(){return this._sxLayer}set layer(t){if(t===void 0){this._sxLayer=void 0;return}if(t instanceof qe){this._sxLayer=t;return}let i=Array.isArray(t)?t:[t];this._sxLayer=new qe(i)}get width(){return this._sxWidth?.value}set width(t){this._sxWidth=t===void 0?void 0:new Je(t)}get stroke(){return this._sxStroke}set stroke(t){this._sxStroke=t}get tstamp(){return this._sxTstamp}set tstamp(t){if(t===void 0){this._sxTstamp=void 0;return}this._sxTstamp=t instanceof En?t:new En(t)}get uuid(){return this._sxUuid}set uuid(t){if(t===void 0){this._sxUuid=void 0;return}this._sxUuid=t instanceof Vt?t:new Vt(t)}get locked(){return this._locked}set locked(t){this._locked=t}getChildren(){let t=[];return this._sxStart&&t.push(this._sxStart),this._sxEnd&&t.push(this._sxEnd),this._sxStroke?t.push(this._sxStroke):this._sxWidth&&t.push(this._sxWidth),this._sxLayer&&t.push(this._sxLayer),this._sxTstamp&&t.push(this._sxTstamp),this._sxUuid&&t.push(this._sxUuid),this._locked&&t.push(new Uat),t}},d(gp,"token","fp_line"),d(gp,"parentToken","footprint"),gp);z.register(ZBt);var xp,hL=(xp=class extends z{constructor(t,i){super();d(this,"token","start");this.x=t,this.y=i}static fromSexprPrimitives(t){let[i,r]=t,s=Number(i),o=Number(r);if(!Number.isFinite(s)||!Number.isFinite(o))throw new Error("fp_line start expects numeric coordinates");return new xp(s,o)}getChildren(){return[]}getString(){return`(start ${this.x} ${this.y})`}},d(xp,"token","start"),d(xp,"parentToken","fp_line"),xp);z.register(hL);var bp,dL=(bp=class extends z{constructor(t,i){super();d(this,"token","end");this.x=t,this.y=i}static fromSexprPrimitives(t){let[i,r]=t,s=Number(i),o=Number(r);if(!Number.isFinite(s)||!Number.isFinite(o))throw new Error("fp_line end expects numeric coordinates");return new bp(s,o)}getChildren(){return[]}getString(){return`(end ${this.x} ${this.y})`}},d(bp,"token","end"),d(bp,"parentToken","fp_line"),bp);z.register(dL);var vp,Uat=(vp=class extends z{constructor(){super(...arguments);d(this,"token","locked")}static fromSexprPrimitives(){return new vp}getChildren(){return[]}getString(){return"locked"}},d(vp,"token","locked"),d(vp,"parentToken","fp_line"),vp);z.register(Uat);var Q6={x:0,y:0,z:0},Sp,KBt=(Sp=class extends z{constructor(t){super();d(this,"token","model");d(this,"_path");d(this,"_offset");d(this,"_scale");d(this,"_rotate");d(this,"_hide",!1);this._path=t}static fromSexprPrimitives(t){if(t.length===0)throw new Error("model requires a path argument");let[i,...r]=t,s=jt(i);if(s===void 0)throw new Error("model path must be a string value");let o=new Sp(s);for(let a of r){if(typeof a=="string"){if(a==="hide"){o._hide=!0;continue}throw new Error(`model encountered unsupported flag "${a}"`)}if(!Array.isArray(a)||a.length===0)throw new Error(`model encountered invalid child expression: ${JSON.stringify(a)}`);let[c,...l]=a;if(c==="offset"){o._offset=tR(l,"offset");continue}if(c==="scale"){o._scale=tR(l,"scale");continue}if(c==="rotate"){o._rotate=tR(l,"rotate");continue}throw new Error(`model encountered unsupported child token "${c}"`)}return o}get path(){return this._path}set path(t){this._path=t}get offset(){return this._offset?{...this._offset}:void 0}set offset(t){this._offset=t?{...t}:void 0}get scale(){return this._scale?{...this._scale}:void 0}set scale(t){this._scale=t?{...t}:void 0}get rotate(){return this._rotate?{...this._rotate}:void 0}set rotate(t){this._rotate=t?{...t}:void 0}get hide(){return this._hide}set hide(t){this._hide=t}getChildren(){return[]}getString(){let t=[`(model ${re(this._path)}`];return this._hide&&t.push("  hide"),this._offset&&t.push(eR("offset",this._offset)),this._scale&&t.push(eR("scale",this._scale)),this._rotate&&t.push(eR("rotate",this._rotate)),t.push(")"),t.join(`
`)}},d(Sp,"token","model"),d(Sp,"parentToken","footprint"),Sp);z.register(KBt);function tR(n,e){if(n.length!==1)throw new Error(`model ${e} expects a single xyz child`);let[t]=n;if(!Array.isArray(t)||t.length!==4||t[0]!=="xyz")throw new Error(`model ${e} expects (xyz x y z), received ${JSON.stringify(t)}`);let[,i,r,s]=t,o=Dt(i)??Q6.x,a=Dt(r)??Q6.y,c=Dt(s)??Q6.z;return{x:o,y:a,z:c}}function eR(n,e){return`  (${n}
    (xyz ${e.x} ${e.y} ${e.z})
  )`}var ic,iT=(ic=class extends ti{constructor(t=!0){super(t);d(this,"token","locked")}static fromSexprPrimitives(t){if(t.length===0)return new ic(!0);let i=w7(t[0]);if(i===void 0)throw new Error(`locked expects yes/no, received ${JSON.stringify(t[0])}`);return new ic(i)}},d(ic,"token","locked"),d(ic,"parentToken","footprint"),ic);z.register(iT);var rc,rT=(rc=class extends ti{constructor(t=!0){super(t);d(this,"token","placed")}static fromSexprPrimitives(t){if(t.length===0)return new rc(!0);let i=w7(t[0]);if(i===void 0)throw new Error(`placed expects yes/no, received ${JSON.stringify(t[0])}`);return new rc(i)}},d(rc,"token","placed"),d(rc,"parentToken","footprint"),rc);z.register(rT);var JBt=new Set(["layer","locked","placed","tedit","tstamp","uuid","at","xy","descr","tags","path","autoplace_cost90","autoplace_cost180","solder_mask_margin","solder_paste_margin","solder_paste_ratio","clearance","zone_connect","thermal_width","thermal_gap","attr","private_layers","net_tie_pad_groups","sheetname","sheetfile","embedded_fonts"]),Vat=new Set(["property","fp_text","fp_text_box","fp_line","fp_rect","fp_circle","fp_arc","fp_poly","pad","model"]),zot=new Set([...JBt,...Vat]),pf,Gat=(pf=class extends z{constructor(t={}){super();d(this,"token","footprint");d(this,"_libraryLink");d(this,"_sxLocked");d(this,"_sxPlaced");d(this,"_sxLayer");d(this,"_sxTedit");d(this,"_sxTstamp");d(this,"_sxUuid");d(this,"_sxAt");d(this,"_sxXy");d(this,"_sxDescr");d(this,"_sxTags");d(this,"_sxPath");d(this,"_sxAutoplaceCost90");d(this,"_sxAutoplaceCost180");d(this,"_sxSolderMaskMargin");d(this,"_sxSolderPasteMargin");d(this,"_sxSolderPasteRatio");d(this,"_sxClearance");d(this,"_sxZoneConnect");d(this,"_sxThermalWidth");d(this,"_sxThermalGap");d(this,"_sxAttr");d(this,"_sxPrivateLayers");d(this,"_sxNetTiePadGroups");d(this,"_sxSheetname");d(this,"_sxSheetfile");d(this,"_sxEmbeddedFonts");d(this,"_properties",[]);d(this,"_fpTexts",[]);d(this,"_fpTextBoxes",[]);d(this,"_fpLines",[]);d(this,"_fpRects",[]);d(this,"_fpCircles",[]);d(this,"_fpArcs",[]);d(this,"_fpPolys",[]);d(this,"_fpPads",[]);d(this,"_models",[]);t.libraryLink!==void 0&&(this.libraryLink=t.libraryLink),t.locked!==void 0&&(this.locked=t.locked),t.placed!==void 0&&(this.placed=t.placed),t.layer!==void 0&&(this.layer=t.layer),t.tstamp!==void 0&&(this.tstamp=t.tstamp),t.uuid!==void 0&&(this.uuid=t.uuid),t.at!==void 0&&(this.position=t.at),t.descr!==void 0&&(this.descr=t.descr),t.tags!==void 0&&(this.tags=t.tags),t.path!==void 0&&(this.path=t.path),t.autoplaceCost90!==void 0&&(this.autoplaceCost90=t.autoplaceCost90),t.autoplaceCost180!==void 0&&(this.autoplaceCost180=t.autoplaceCost180),t.solderMaskMargin!==void 0&&(this.solderMaskMargin=t.solderMaskMargin),t.solderPasteMargin!==void 0&&(this.solderPasteMargin=t.solderPasteMargin),t.solderPasteRatio!==void 0&&(this.solderPasteRatio=t.solderPasteRatio),t.clearance!==void 0&&(this.clearance=t.clearance),t.zoneConnect!==void 0&&(this.zoneConnect=t.zoneConnect),t.thermalWidth!==void 0&&(this.thermalWidth=t.thermalWidth),t.thermalGap!==void 0&&(this.thermalGap=t.thermalGap),t.attr!==void 0&&(this.attr=t.attr),t.privateLayers!==void 0&&(this.privateLayers=t.privateLayers),t.netTiePadGroups!==void 0&&(this.netTiePadGroups=t.netTiePadGroups),t.sheetname!==void 0&&(this.sheetname=t.sheetname),t.sheetfile!==void 0&&(this.sheetfile=t.sheetfile),t.embeddedFonts!==void 0&&(this.embeddedFonts=t.embeddedFonts),t.properties!==void 0&&(this.properties=t.properties),t.fpTexts!==void 0&&(this.fpTexts=t.fpTexts),t.fpTextBoxes!==void 0&&(this.fpTextBoxes=t.fpTextBoxes),t.fpLines!==void 0&&(this.fpLines=t.fpLines),t.fpRects!==void 0&&(this.fpRects=t.fpRects),t.fpCircles!==void 0&&(this.fpCircles=t.fpCircles),t.fpArcs!==void 0&&(this.fpArcs=t.fpArcs),t.fpPolys!==void 0&&(this.fpPolys=t.fpPolys),t.pads!==void 0&&(this.fpPads=t.pads),t.models!==void 0&&(this.models=t.models)}static fromSexprPrimitives(t){let i=new pf,r=[],s=[];for(let l of t){if(typeof l=="string"){r.push(l);continue}if(Array.isArray(l)){s.push(l);continue}throw new Error(`footprint encountered unsupported primitive child: ${JSON.stringify(l)}`)}let o=[];r.length>0&&(i._libraryLink=r[0],o=r.slice(1));let{propertyMap:a,arrayPropertyMap:c}=z.parsePrimitivesToClassProperties(s,this.token);for(let l of Object.keys(a))if(!zot.has(l))throw new Error(`footprint encountered unsupported child token "${l}"`);for(let[l,u]of Object.entries(c)){if(!zot.has(l))throw new Error(`footprint encountered unsupported child token "${l}"`);if(!Vat.has(l)&&u.length>1)throw new Error(`footprint does not support repeated child token "${l}"`)}if(i._sxLocked=a.locked,i._sxLocked&&!i._sxLocked.value&&(i._sxLocked=void 0),i._sxPlaced=a.placed,i._sxPlaced&&!i._sxPlaced.value&&(i._sxPlaced=void 0),i._sxLayer=a.layer,i._sxTedit=a.tedit,i._sxTstamp=a.tstamp,i._sxUuid=a.uuid,i._sxAt=a.at,i._sxXy=a.xy,i._sxAt&&i._sxXy)throw new Error("footprint cannot include both at and xy children");i._sxDescr=a.descr,i._sxTags=a.tags,i._sxPath=a.path,i._sxAutoplaceCost90=a.autoplace_cost90,i._sxAutoplaceCost180=a.autoplace_cost180,i._sxSolderMaskMargin=a.solder_mask_margin,i._sxSolderPasteMargin=a.solder_paste_margin,i._sxSolderPasteRatio=a.solder_paste_ratio,i._sxClearance=a.clearance,i._sxZoneConnect=a.zone_connect,i._sxThermalWidth=a.thermal_width,i._sxThermalGap=a.thermal_gap,i._sxAttr=a.attr,i._sxPrivateLayers=a.private_layers,i._sxNetTiePadGroups=a.net_tie_pad_groups,i._sxSheetname=a.sheetname,i._sxSheetfile=a.sheetfile,i._sxEmbeddedFonts=a.embedded_fonts,i._properties=c.property??[],i._fpTexts=c.fp_text??[],i._fpTextBoxes=c.fp_text_box??[],i._fpLines=c.fp_line??[],i._fpRects=c.fp_rect??[],i._fpCircles=c.fp_circle??[],i._fpArcs=c.fp_arc??[],i._fpPolys=c.fp_poly??[],i._fpPads=c.pad??[],i._models=c.model??[];for(let l of o){if(l==="locked"){if(i._sxLocked)throw new Error("footprint encountered duplicate locked tokens");i._sxLocked=new iT(!0);continue}if(l==="placed"){if(i._sxPlaced)throw new Error("footprint encountered duplicate placed tokens");i._sxPlaced=new rT(!0);continue}throw new Error(`footprint encountered unsupported flag "${l}"`)}return i}get libraryLink(){return this._libraryLink}set libraryLink(t){this._libraryLink=t}get locked(){return this._sxLocked?.value??!1}set locked(t){if(t===void 0){this._sxLocked=void 0;return}if(t instanceof iT){this._sxLocked=t.value?t:void 0;return}this._sxLocked=t?new iT(!0):void 0}get placed(){return this._sxPlaced?.value??!1}set placed(t){if(t===void 0){this._sxPlaced=void 0;return}if(t instanceof rT){this._sxPlaced=t.value?t:void 0;return}this._sxPlaced=t?new rT(!0):void 0}get layer(){return this._sxLayer}set layer(t){if(t===void 0){this._sxLayer=void 0;return}if(t instanceof qe)this._sxLayer=t;else{let i=Array.isArray(t)?t:[t];this._sxLayer=new qe(i)}}get tedit(){return this._sxTedit}set tedit(t){if(t===void 0){this._sxTedit=void 0;return}this._sxTedit=t instanceof $O?t:new $O(t)}get tstamp(){return this._sxTstamp}set tstamp(t){if(t===void 0){this._sxTstamp=void 0;return}this._sxTstamp=t instanceof En?t:new En(t)}get uuid(){return this._sxUuid}set uuid(t){if(t===void 0){this._sxUuid=void 0;return}this._sxUuid=t instanceof Vt?t:new Vt(t)}get position(){return this._sxAt??this._sxXy}set position(t){if(t===void 0){this._sxAt=void 0,this._sxXy=void 0;return}if(t instanceof Zr){this._sxXy=t,this._sxAt=void 0;return}this._sxAt=Un.from(t),this._sxXy=void 0}get descr(){return this._sxDescr}set descr(t){if(t===void 0){this._sxDescr=void 0;return}this._sxDescr=t instanceof IO?t:new IO(t)}get tags(){return this._sxTags}set tags(t){if(t===void 0){this._sxTags=void 0;return}if(t instanceof zO){this._sxTags=t;return}let i=Array.isArray(t)?t.join(" "):t;this._sxTags=new zO(i)}get path(){return this._sxPath}set path(t){if(t===void 0){this._sxPath=void 0;return}this._sxPath=t instanceof AO?t:new AO(t)}get autoplaceCost90(){return this._sxAutoplaceCost90}set autoplaceCost90(t){if(t===void 0){this._sxAutoplaceCost90=void 0;return}this._sxAutoplaceCost90=t instanceof MO?t:new MO(t)}get autoplaceCost180(){return this._sxAutoplaceCost180}set autoplaceCost180(t){if(t===void 0){this._sxAutoplaceCost180=void 0;return}this._sxAutoplaceCost180=t instanceof EO?t:new EO(t)}get solderMaskMargin(){return this._sxSolderMaskMargin}set solderMaskMargin(t){if(t===void 0){this._sxSolderMaskMargin=void 0;return}this._sxSolderMaskMargin=t instanceof OO?t:new OO(t)}get solderPasteMargin(){return this._sxSolderPasteMargin}set solderPasteMargin(t){if(t===void 0){this._sxSolderPasteMargin=void 0;return}this._sxSolderPasteMargin=t instanceof LO?t:new LO(t)}get solderPasteRatio(){return this._sxSolderPasteRatio}set solderPasteRatio(t){if(t===void 0){this._sxSolderPasteRatio=void 0;return}this._sxSolderPasteRatio=t instanceof FO?t:new FO(t)}get clearance(){return this._sxClearance}set clearance(t){if(t===void 0){this._sxClearance=void 0;return}this._sxClearance=t instanceof CO?t:new CO(t)}get zoneConnect(){return this._sxZoneConnect}set zoneConnect(t){if(t===void 0){this._sxZoneConnect=void 0;return}this._sxZoneConnect=t instanceof BO?t:new BO(t)}get thermalWidth(){return this._sxThermalWidth}set thermalWidth(t){if(t===void 0){this._sxThermalWidth=void 0;return}this._sxThermalWidth=t instanceof jO?t:new jO(t)}get thermalGap(){return this._sxThermalGap}set thermalGap(t){if(t===void 0){this._sxThermalGap=void 0;return}this._sxThermalGap=t instanceof DO?t:new DO(t)}get attr(){return this._sxAttr}set attr(t){this._sxAttr=t}get privateLayers(){return this._sxPrivateLayers}set privateLayers(t){if(t===void 0){this._sxPrivateLayers=void 0;return}this._sxPrivateLayers=t instanceof RO?t:new RO(t)}get netTiePadGroups(){return this._sxNetTiePadGroups}set netTiePadGroups(t){if(t===void 0){this._sxNetTiePadGroups=void 0;return}this._sxNetTiePadGroups=t instanceof NO?t:new NO(t)}get sheetname(){return this._sxSheetname?.value}set sheetname(t){if(t===void 0){this._sxSheetname=void 0;return}this._sxSheetname=t instanceof uL?t:new uL(t)}get sheetfile(){return this._sxSheetfile?.value}set sheetfile(t){if(t===void 0){this._sxSheetfile=void 0;return}this._sxSheetfile=t instanceof pL?t:new pL(t)}get embeddedFonts(){return this._sxEmbeddedFonts}set embeddedFonts(t){this._sxEmbeddedFonts=t}get properties(){return[...this._properties]}set properties(t){this._properties=[...t]}get fpTexts(){return[...this._fpTexts]}set fpTexts(t){this._fpTexts=[...t]}get fpTextBoxes(){return[...this._fpTextBoxes]}set fpTextBoxes(t){this._fpTextBoxes=[...t]}get fpLines(){return[...this._fpLines]}set fpLines(t){this._fpLines=[...t]}get fpRects(){return[...this._fpRects]}set fpRects(t){this._fpRects=[...t]}get fpCircles(){return[...this._fpCircles]}set fpCircles(t){this._fpCircles=[...t]}get fpArcs(){return[...this._fpArcs]}set fpArcs(t){this._fpArcs=[...t]}get fpPolys(){return[...this._fpPolys]}set fpPolys(t){this._fpPolys=[...t]}get fpPads(){return[...this._fpPads]}set fpPads(t){this._fpPads=[...t]}get models(){return[...this._models]}set models(t){this._models=[...t]}getChildren(){let t=[];return this._sxLocked&&t.push(this._sxLocked),this._sxPlaced&&t.push(this._sxPlaced),this._sxLayer&&t.push(this._sxLayer),this._sxTedit&&t.push(this._sxTedit),this._sxTstamp&&t.push(this._sxTstamp),this._sxUuid&&t.push(this._sxUuid),this._sxAt&&t.push(this._sxAt),this._sxXy&&t.push(this._sxXy),this._sxDescr&&t.push(this._sxDescr),this._sxTags&&t.push(this._sxTags),this._sxPath&&t.push(this._sxPath),this._sxAutoplaceCost90&&t.push(this._sxAutoplaceCost90),this._sxAutoplaceCost180&&t.push(this._sxAutoplaceCost180),this._sxSolderMaskMargin&&t.push(this._sxSolderMaskMargin),this._sxSolderPasteMargin&&t.push(this._sxSolderPasteMargin),this._sxSolderPasteRatio&&t.push(this._sxSolderPasteRatio),this._sxClearance&&t.push(this._sxClearance),this._sxZoneConnect&&t.push(this._sxZoneConnect),this._sxThermalWidth&&t.push(this._sxThermalWidth),this._sxThermalGap&&t.push(this._sxThermalGap),this._sxAttr&&t.push(this._sxAttr),this._sxPrivateLayers&&t.push(this._sxPrivateLayers),this._sxNetTiePadGroups&&t.push(this._sxNetTiePadGroups),this._sxSheetname&&t.push(this._sxSheetname),this._sxSheetfile&&t.push(this._sxSheetfile),this._sxEmbeddedFonts&&t.push(this._sxEmbeddedFonts),t.push(...this._properties),t.push(...this._fpTexts),t.push(...this._fpTextBoxes),t.push(...this._fpLines),t.push(...this._fpRects),t.push(...this._fpCircles),t.push(...this._fpArcs),t.push(...this._fpPolys),t.push(...this._fpPads),t.push(...this._models),t}getString(){let t=["(footprint"];this._libraryLink!==void 0&&t.push(`  ${re(this._libraryLink)}`);for(let i of this.getChildren())t.push(i.getStringIndented());return t.push(")"),t.join(`
`)}},d(pf,"token","footprint"),pf);z.register(Gat);var $ot=new Set(["start","mid","end","layer","width","stroke","tstamp","uuid"]),hf,QBt=(hf=class extends z{constructor(t={}){super();d(this,"token","gr_arc");d(this,"_sxStart");d(this,"_sxMid");d(this,"_sxEnd");d(this,"_sxLayer");d(this,"_sxWidth");d(this,"_sxStroke");d(this,"_sxTstamp");d(this,"_sxUuid");t.start!==void 0&&(this.start=t.start),t.mid!==void 0&&(this.mid=t.mid),t.end!==void 0&&(this.end=t.end),t.layer!==void 0&&(this.layer=t.layer),t.width!==void 0&&(this.width=t.width),t.stroke!==void 0&&(this.stroke=t.stroke),t.tstamp!==void 0&&(this.tstamp=t.tstamp),t.uuid!==void 0&&(this.uuid=t.uuid)}static fromSexprPrimitives(t){let i=new hf,{propertyMap:r,arrayPropertyMap:s}=z.parsePrimitivesToClassProperties(t,this.token),o=new Set;for(let a of Object.keys(r))$ot.has(a)||o.add(a);for(let a of Object.keys(s)){if(!$ot.has(a)){o.add(a);continue}if(s[a].length>1)throw new Error(`gr_arc does not support repeated child tokens: ${a}`)}if(o.size>0)throw new Error(`Unsupported child tokens inside gr_arc expression: ${[...o].join(", ")}`);for(let a of t)if(!Array.isArray(a))throw new Error(`gr_arc encountered unexpected primitive child: ${JSON.stringify(a)}`);if(i._sxStart=r.start,i._sxMid=r.mid,i._sxEnd=r.end,i._sxLayer=r.layer,i._sxWidth=r.width,i._sxStroke=r.stroke,i._sxTstamp=r.tstamp,i._sxUuid=r.uuid,!i._sxStart)throw new Error("gr_arc requires a start child token");if(!i._sxMid)throw new Error("gr_arc requires a mid child token");if(!i._sxEnd)throw new Error("gr_arc requires an end child token");if(!i._sxLayer)throw new Error("gr_arc requires a layer child token");return i}get start(){return this._sxStart}set start(t){this._sxStart=this.normalizeStart(t)}get mid(){return this._sxMid}set mid(t){this._sxMid=this.normalizeMid(t)}get end(){return this._sxEnd}set end(t){this._sxEnd=this.normalizeEnd(t)}get startPoint(){return this._sxStart?.toObject()}get midPoint(){return this._sxMid?.toObject()}get endPoint(){return this._sxEnd?.toObject()}get layer(){return this._sxLayer}set layer(t){if(t===void 0){this._sxLayer=void 0;return}if(t instanceof qe){this._sxLayer=t;return}let i=Array.isArray(t)?t:[t];this._sxLayer=new qe(i)}get width(){return this._sxWidth?.value}set width(t){if(t===void 0){this._sxWidth=void 0;return}this._sxWidth=t instanceof Je?t:new Je(t)}get widthClass(){return this._sxWidth}set widthClass(t){this._sxWidth=t}get stroke(){return this._sxStroke}set stroke(t){this._sxStroke=t}get tstamp(){return this._sxTstamp}set tstamp(t){if(t===void 0){this._sxTstamp=void 0;return}this._sxTstamp=t instanceof En?t:new En(t)}get uuid(){return this._sxUuid}set uuid(t){if(t===void 0){this._sxUuid=void 0;return}this._sxUuid=t instanceof Vt?t:new Vt(t)}getChildren(){let t=[];return this._sxStart&&t.push(this._sxStart),this._sxMid&&t.push(this._sxMid),this._sxEnd&&t.push(this._sxEnd),this._sxStroke&&t.push(this._sxStroke),this._sxWidth&&t.push(this._sxWidth),this._sxLayer&&t.push(this._sxLayer),this._sxTstamp&&t.push(this._sxTstamp),this._sxUuid&&t.push(this._sxUuid),t}normalizeStart(t){if(t!==void 0)return t instanceof fL?t:new fL(t.x,t.y)}normalizeMid(t){if(t!==void 0)return t instanceof mL?t:new mL(t.x,t.y)}normalizeEnd(t){if(t!==void 0)return t instanceof _L?t:new _L(t.x,t.y)}},d(hf,"token","gr_arc"),hf);z.register(QBt);var wp,fL=(wp=class extends z{constructor(t,i){super();d(this,"token","start");this.x=t,this.y=i}static fromSexprPrimitives(t){let[i,r]=t,s=Number(i),o=Number(r);if(!Number.isFinite(s)||!Number.isFinite(o))throw new Error("gr_arc start expects numeric coordinates");return new wp(s,o)}toObject(){return{x:this.x,y:this.y}}getChildren(){return[]}getString(){return`(start ${this.x} ${this.y})`}},d(wp,"token","start"),d(wp,"parentToken","gr_arc"),wp);z.register(fL);var Pp,mL=(Pp=class extends z{constructor(t,i){super();d(this,"token","mid");this.x=t,this.y=i}static fromSexprPrimitives(t){let[i,r]=t,s=Number(i),o=Number(r);if(!Number.isFinite(s)||!Number.isFinite(o))throw new Error("gr_arc mid expects numeric coordinates");return new Pp(s,o)}toObject(){return{x:this.x,y:this.y}}getChildren(){return[]}getString(){return`(mid ${this.x} ${this.y})`}},d(Pp,"token","mid"),d(Pp,"parentToken","gr_arc"),Pp);z.register(mL);var kp,_L=(kp=class extends z{constructor(t,i){super();d(this,"token","end");this.x=t,this.y=i}static fromSexprPrimitives(t){let[i,r]=t,s=Number(i),o=Number(r);if(!Number.isFinite(s)||!Number.isFinite(o))throw new Error("gr_arc end expects numeric coordinates");return new kp(s,o)}toObject(){return{x:this.x,y:this.y}}getChildren(){return[]}getString(){return`(end ${this.x} ${this.y})`}},d(kp,"token","end"),d(kp,"parentToken","gr_arc"),kp);z.register(_L);var Dot=new Set(["center","end","layer","width","stroke","fill","locked","tstamp","uuid"]),df,tYt=(df=class extends z{constructor(t={}){super();d(this,"token","gr_circle");d(this,"_sxCenter");d(this,"_sxEnd");d(this,"_sxLayer");d(this,"_sxWidth");d(this,"_sxStroke");d(this,"_sxFill");d(this,"_sxLocked");d(this,"_sxTstamp");d(this,"_sxUuid");t.center!==void 0&&(this.center=t.center),t.end!==void 0&&(this.end=t.end),t.layer!==void 0&&(this.layer=t.layer),t.width!==void 0&&(this.width=t.width),t.stroke!==void 0&&(this.stroke=t.stroke),t.fill!==void 0&&(this.fill=t.fill),t.locked!==void 0&&(this.locked=t.locked),t.tstamp!==void 0&&(this.tstamp=t.tstamp),t.uuid!==void 0&&(this.uuid=t.uuid)}static fromSexprPrimitives(t){let i=new df,{propertyMap:r,arrayPropertyMap:s}=z.parsePrimitivesToClassProperties(t,this.token),o=new Set;for(let c of Object.keys(r))Dot.has(c)||o.add(c);for(let c of Object.keys(s)){if(!Dot.has(c)){o.add(c);continue}if(s[c].length>1)throw new Error(`gr_circle does not support repeated child tokens: ${c}`)}if(o.size>0)throw new Error(`Unsupported child tokens inside gr_circle expression: ${[...o].join(", ")}`);for(let c of t)if(!Array.isArray(c))throw new Error(`gr_circle encountered unexpected primitive child: ${JSON.stringify(c)}`);i._sxCenter=r.center,i._sxEnd=r.end,i._sxLayer=r.layer,i._sxWidth=r.width,i._sxStroke=r.stroke,i._sxFill=r.fill;let a=r.locked;if(i._sxLocked=a&&a.value?a:void 0,i._sxTstamp=r.tstamp,i._sxUuid=r.uuid,!i._sxCenter)throw new Error("gr_circle requires a center child token");if(!i._sxEnd)throw new Error("gr_circle requires an end child token");if(!i._sxLayer)throw new Error("gr_circle requires a layer child token");return i}get center(){return this._sxCenter}set center(t){this._sxCenter=this.normalizeCenter(t)}get end(){return this._sxEnd}set end(t){this._sxEnd=this.normalizeEnd(t)}get centerPoint(){return this._sxCenter?.toObject()}get endPoint(){return this._sxEnd?.toObject()}get layer(){return this._sxLayer}set layer(t){if(t===void 0){this._sxLayer=void 0;return}if(t instanceof qe){this._sxLayer=t;return}let i=Array.isArray(t)?t:[t];this._sxLayer=new qe(i)}get width(){return this._sxWidth?.value}set width(t){if(t===void 0){this._sxWidth=void 0;return}this._sxWidth=t instanceof Je?t:new Je(t)}get widthClass(){return this._sxWidth}set widthClass(t){this._sxWidth=t}get stroke(){return this._sxStroke}set stroke(t){this._sxStroke=t}get fill(){return this._sxFill}set fill(t){if(t===void 0){this._sxFill=void 0;return}if(t instanceof fy){this._sxFill=t;return}let i=t==="yes"||t==="true"?!0:t==="no"||t==="false"?!1:t;typeof i=="boolean"?this._sxFill=new fy(i):this._sxFill=new fy(t!=="none")}get tstamp(){return this._sxTstamp}set tstamp(t){if(t===void 0){this._sxTstamp=void 0;return}this._sxTstamp=t instanceof En?t:new En(t)}get uuid(){return this._sxUuid?.value}get uuidClass(){return this._sxUuid}set uuid(t){if(t===void 0){this._sxUuid=void 0;return}this._sxUuid=t instanceof Vt?t:new Vt(t)}get locked(){return this._sxLocked?.value??!1}set locked(t){this._sxLocked=t?new Hat(!0):void 0}getChildren(){let t=[];return this._sxCenter&&t.push(this._sxCenter),this._sxEnd&&t.push(this._sxEnd),this._sxStroke&&t.push(this._sxStroke),this._sxWidth&&t.push(this._sxWidth),this._sxFill&&t.push(this._sxFill),this._sxLocked&&t.push(this._sxLocked),this._sxLayer&&t.push(this._sxLayer),this._sxTstamp&&t.push(this._sxTstamp),this._sxUuid&&t.push(this._sxUuid),t}normalizeCenter(t){if(t!==void 0)return t instanceof yL?t:new yL(t.x,t.y)}normalizeEnd(t){if(t!==void 0)return t instanceof gL?t:new gL(t.x,t.y)}},d(df,"token","gr_circle"),df);z.register(tYt);var Tp,yL=(Tp=class extends z{constructor(t,i){super();d(this,"token","center");this.x=t,this.y=i}static fromSexprPrimitives(t){let[i,r]=t,s=Number(i),o=Number(r);if(!Number.isFinite(s)||!Number.isFinite(o))throw new Error("gr_circle center expects numeric coordinates");return new Tp(s,o)}toObject(){return{x:this.x,y:this.y}}getChildren(){return[]}getString(){return`(center ${this.x} ${this.y})`}},d(Tp,"token","center"),d(Tp,"parentToken","gr_circle"),Tp);z.register(yL);var Ep,gL=(Ep=class extends z{constructor(t,i){super();d(this,"token","end");this.x=t,this.y=i}static fromSexprPrimitives(t){let[i,r]=t,s=Number(i),o=Number(r);if(!Number.isFinite(s)||!Number.isFinite(o))throw new Error("gr_circle end expects numeric coordinates");return new Ep(s,o)}toObject(){return{x:this.x,y:this.y}}getChildren(){return[]}getString(){return`(end ${this.x} ${this.y})`}},d(Ep,"token","end"),d(Ep,"parentToken","gr_circle"),Ep);z.register(gL);var sc,Hat=(sc=class extends z{constructor(t){super();d(this,"token","locked");d(this,"value");this.value=t}static fromSexprPrimitives(t){if(t.length===0)return new sc(!0);let i=String(t[0]);return new sc(i==="yes")}getString(){return this.value?"(locked yes)":"(locked no)"}},d(sc,"token","locked"),d(sc,"parentToken","gr_circle"),sc);z.register(Hat);var jot=new Set(["pts","xy","layer","width","stroke","tstamp","uuid"]),ff,eYt=(ff=class extends z{constructor(t={}){super();d(this,"token","gr_curve");d(this,"_sxPts");d(this,"_sxLayer");d(this,"_sxWidth");d(this,"_sxStroke");d(this,"_sxTstamp");d(this,"_sxUuid");t.points!==void 0&&(this.points=t.points),t.layer!==void 0&&(this.layer=t.layer),t.width!==void 0&&(this.width=t.width),t.stroke!==void 0&&(this.stroke=t.stroke),t.tstamp!==void 0&&(this.tstamp=t.tstamp),t.uuid!==void 0&&(this.uuid=t.uuid)}static fromSexprPrimitives(t){let i=new ff,{propertyMap:r,arrayPropertyMap:s}=z.parsePrimitivesToClassProperties(t,this.token),o=new Set;for(let u of Object.keys(r))jot.has(u)||o.add(u);for(let u of Object.keys(s)){if(!jot.has(u)){o.add(u);continue}if(u!=="xy"&&s[u].length>1)throw new Error(`gr_curve does not support repeated child token "${u}"`)}if(o.size>0)throw new Error(`Unsupported child tokens inside gr_curve expression: ${[...o].join(", ")}`);let a=s.pts;if(a&&a.length>1)throw new Error("gr_curve does not support repeated pts tokens");let c=s.xy,l=r.pts;if(l&&c&&c.length>0)throw new Error("gr_curve cannot mix pts and xy child tokens");!l&&a?.length&&(l=a[0]),!l&&c&&c.length>0&&(l=new Sr(c)),i._sxPts=l,i._sxLayer=r.layer,i._sxWidth=r.width,i._sxStroke=r.stroke,i._sxTstamp=r.tstamp,i._sxUuid=r.uuid;for(let u of t)if(!Array.isArray(u))throw new Error(`gr_curve encountered unexpected primitive child: ${JSON.stringify(u)}`);if(!i._sxPts)throw new Error("gr_curve requires pts or xy child tokens");if(!i._sxLayer)throw new Error("gr_curve requires a layer child token");return i}get points(){return this._sxPts}set points(t){if(t===void 0){this._sxPts=void 0;return}if(t instanceof Sr){this._sxPts=t;return}if(Array.isArray(t)&&t.every(i=>i instanceof Zr)){this._sxPts=new Sr(t);return}if(Array.isArray(t)){this._sxPts=new Sr(t.map(({x:i,y:r})=>new Zr(i,r)));return}throw new Error("Unsupported points value provided to gr_curve")}get layer(){return this._sxLayer}set layer(t){if(t===void 0){this._sxLayer=void 0;return}if(t instanceof qe){this._sxLayer=t;return}let i=Array.isArray(t)?t:[t];this._sxLayer=new qe(i)}get width(){return this._sxWidth?.value}set width(t){if(t===void 0){this._sxWidth=void 0;return}this._sxWidth=t instanceof Je?t:new Je(t)}get widthClass(){return this._sxWidth}set widthClass(t){this._sxWidth=t}get stroke(){return this._sxStroke}set stroke(t){this._sxStroke=t}get tstamp(){return this._sxTstamp}set tstamp(t){if(t===void 0){this._sxTstamp=void 0;return}this._sxTstamp=t instanceof En?t:new En(t)}get uuid(){return this._sxUuid}set uuid(t){if(t===void 0){this._sxUuid=void 0;return}this._sxUuid=t instanceof Vt?t:new Vt(t)}getChildren(){let t=[];return this._sxPts&&t.push(this._sxPts),this._sxLayer&&t.push(this._sxLayer),this._sxWidth&&t.push(this._sxWidth),this._sxStroke&&t.push(this._sxStroke),this._sxTstamp&&t.push(this._sxTstamp),this._sxUuid&&t.push(this._sxUuid),t}},d(ff,"token","gr_curve"),ff);z.register(eYt);var Mp,Wat=(Mp=class extends rn{constructor(t){super(t);d(this,"token","angle")}static fromSexprPrimitives(t){let[i]=t,r=Dt(i);if(r===void 0)throw new Error("gr_line angle expects a numeric value");return new Mp(r)}getString(){return`(angle ${this.value})`}},d(Mp,"token","angle"),d(Mp,"parentToken","gr_line"),Mp);z.register(Wat);var nYt=new Set(["true","yes","1"]),xo,qat=(xo=class extends ti{constructor(t){super(t);d(this,"token","locked")}static fromSexprPrimitives(t){let[i]=t;return i===void 0?new xo(!0):typeof i=="boolean"?new xo(i):typeof i=="string"?new xo(nYt.has(i.toLowerCase())):new xo(!1)}getString(){return`(locked ${this.value?"yes":"no"})`}},d(xo,"token","locked"),d(xo,"parentToken","gr_line"),xo);z.register(qat);var Bot=new Set(["start","end","angle","layer","width","stroke","tstamp","uuid","locked"]),mf,Zat=(mf=class extends z{constructor(t={}){super();d(this,"token","gr_line");d(this,"_sxStart");d(this,"_sxEnd");d(this,"_sxAngle");d(this,"_sxLayer");d(this,"_sxWidth");d(this,"_sxStroke");d(this,"_sxTstamp");d(this,"_sxUuid");d(this,"_sxLocked");t.start!==void 0&&(this.start=t.start),t.end!==void 0&&(this.end=t.end),t.angle!==void 0&&(this.angle=t.angle),t.layer!==void 0&&(this.layer=t.layer),t.width!==void 0&&(this.width=t.width),t.stroke!==void 0&&(this.stroke=t.stroke),t.tstamp!==void 0&&(this.tstamp=t.tstamp),t.uuid!==void 0&&(this.uuid=t.uuid),t.locked!==void 0&&(this.locked=t.locked)}static fromSexprPrimitives(t){let i=new mf,{propertyMap:r,arrayPropertyMap:s}=z.parsePrimitivesToClassProperties(t,this.token),o=new Set;for(let c of Object.keys(r))Bot.has(c)||o.add(c);for(let c of Object.keys(s)){if(!Bot.has(c)){o.add(c);continue}if(s[c].length>1)throw new Error(`gr_line does not support repeated child tokens: ${c}`)}if(o.size>0)throw new Error(`Unsupported child tokens inside gr_line expression: ${[...o].join(", ")}`);for(let c of t)if(!Array.isArray(c))throw new Error(`gr_line encountered unexpected primitive child: ${JSON.stringify(c)}`);i._sxStart=r.start,i._sxEnd=r.end,i._sxAngle=r.angle,i._sxLayer=r.layer,i._sxWidth=r.width,i._sxStroke=r.stroke;let a=r.locked;if(i._sxLocked=a&&a.value?a:void 0,i._sxTstamp=r.tstamp,i._sxUuid=r.uuid,!i._sxStart)throw new Error("gr_line requires a start child token");if(!i._sxEnd)throw new Error("gr_line requires an end child token");if(!i._sxLayer)throw new Error("gr_line requires a layer child token");return i}get start(){return this._sxStart}set start(t){this._sxStart=this.normalizeStart(t)}get end(){return this._sxEnd}set end(t){this._sxEnd=this.normalizeEnd(t)}get startPoint(){return this._sxStart?.toObject()}get endPoint(){return this._sxEnd?.toObject()}get angle(){return this._sxAngle?.value}set angle(t){if(t===void 0){this._sxAngle=void 0;return}this._sxAngle=new Wat(t)}get layer(){return this._sxLayer}set layer(t){if(t===void 0){this._sxLayer=void 0;return}if(t instanceof qe){this._sxLayer=t;return}let i=Array.isArray(t)?t:[t];this._sxLayer=new qe(i)}get width(){return this._sxWidth?.value}set width(t){if(t===void 0){this._sxWidth=void 0;return}this._sxWidth=t instanceof Je?t:new Je(t)}get widthClass(){return this._sxWidth}set widthClass(t){this._sxWidth=t}get stroke(){return this._sxStroke}set stroke(t){this._sxStroke=t}get tstamp(){return this._sxTstamp}set tstamp(t){if(t===void 0){this._sxTstamp=void 0;return}this._sxTstamp=t instanceof En?t:new En(t)}get uuid(){return this._sxUuid}set uuid(t){if(t===void 0){this._sxUuid=void 0;return}this._sxUuid=t instanceof Vt?t:new Vt(t)}get locked(){return this._sxLocked?.value??!1}set locked(t){this._sxLocked=t?new qat(!0):void 0}getChildren(){let t=[];return this._sxStart&&t.push(this._sxStart),this._sxEnd&&t.push(this._sxEnd),this._sxAngle&&t.push(this._sxAngle),this._sxStroke&&t.push(this._sxStroke),this._sxWidth&&t.push(this._sxWidth),this._sxLocked&&t.push(this._sxLocked),this._sxLayer&&t.push(this._sxLayer),this._sxTstamp&&t.push(this._sxTstamp),this._sxUuid&&t.push(this._sxUuid),t}normalizeStart(t){if(t!==void 0)return t instanceof O0?t:new O0(t.x,t.y)}normalizeEnd(t){if(t!==void 0)return t instanceof R0?t:new R0(t.x,t.y)}},d(mf,"token","gr_line"),mf);z.register(Zat);var Yot=new Set(["start","end","layer","width","stroke","fill","uuid","locked"]),_f,Kat=(_f=class extends z{constructor(t={}){super();d(this,"token","gr_rect");d(this,"_sxStart");d(this,"_sxEnd");d(this,"_sxLayer");d(this,"_sxWidth");d(this,"_sxStroke");d(this,"_sxFill");d(this,"_sxUuid");d(this,"_sxLocked");t.start!==void 0&&(this.start=t.start),t.end!==void 0&&(this.end=t.end),t.layer!==void 0&&(this.layer=t.layer),t.width!==void 0&&(this.width=t.width),t.stroke!==void 0&&(this.stroke=t.stroke),t.fill!==void 0&&(this.fill=t.fill),t.uuid!==void 0&&(this.uuid=t.uuid),t.locked!==void 0&&(this.locked=t.locked)}static fromSexprPrimitives(t){let i=new _f,{propertyMap:r,arrayPropertyMap:s}=z.parsePrimitivesToClassProperties(t,this.token),o=new Set;for(let c of Object.keys(r))Yot.has(c)||o.add(c);for(let c of Object.keys(s)){if(!Yot.has(c)){o.add(c);continue}if(s[c].length>1)throw new Error(`gr_rect does not support repeated child tokens: ${c}`)}if(o.size>0)throw new Error(`Unsupported child tokens inside gr_rect expression: ${[...o].join(", ")}`);for(let c of t)if(!Array.isArray(c))throw new Error(`gr_rect encountered unexpected primitive child: ${JSON.stringify(c)}`);i._sxStart=r.start,i._sxEnd=r.end,i._sxLayer=r.layer,i._sxWidth=r.width,i._sxStroke=r.stroke,i._sxFill=r.fill;let a=r.locked;if(i._sxLocked=a&&a.value?a:void 0,i._sxUuid=r.uuid,!i._sxStart)throw new Error("gr_rect requires a start child token");if(!i._sxEnd)throw new Error("gr_rect requires an end child token");if(!i._sxLayer)throw new Error("gr_rect requires a layer child token");return i}get start(){return this._sxStart}set start(t){if(t===void 0){this._sxStart=void 0;return}if(t instanceof xL){this._sxStart=t;return}this._sxStart=new xL(t.x,t.y)}get end(){return this._sxEnd}set end(t){if(t===void 0){this._sxEnd=void 0;return}if(t instanceof bL){this._sxEnd=t;return}this._sxEnd=new bL(t.x,t.y)}get startPoint(){return this._sxStart?{x:this._sxStart.x,y:this._sxStart.y}:void 0}get endPoint(){return this._sxEnd?{x:this._sxEnd.x,y:this._sxEnd.y}:void 0}get layer(){return this._sxLayer}set layer(t){if(t===void 0){this._sxLayer=void 0;return}if(t instanceof qe){this._sxLayer=t;return}let i=Array.isArray(t)?t:[t];this._sxLayer=new qe(i)}get stroke(){return this._sxStroke}set stroke(t){this._sxStroke=t}get width(){return this._sxWidth?.value}set width(t){if(t===void 0){this._sxWidth=void 0;return}if(t instanceof Je){this._sxWidth=t;return}this._sxWidth=new Je(t)}get widthClass(){return this._sxWidth}set widthClass(t){this._sxWidth=t}get fill(){return this._sxFill?.filled}set fill(t){if(t===void 0){this._sxFill=void 0;return}if(t instanceof vL){this._sxFill=t;return}this._sxFill=new vL(t)}get fillClass(){return this._sxFill}get uuid(){return this._sxUuid?.value}set uuid(t){if(t===void 0){this._sxUuid=void 0;return}if(t instanceof Vt){this._sxUuid=t;return}this._sxUuid=new Vt(t)}get uuidClass(){return this._sxUuid}get locked(){return this._sxLocked?.value??!1}set locked(t){this._sxLocked=t?new Jat(!0):void 0}getChildren(){let t=[];return this._sxStart&&t.push(this._sxStart),this._sxEnd&&t.push(this._sxEnd),this._sxStroke&&t.push(this._sxStroke),this._sxWidth&&t.push(this._sxWidth),this._sxFill&&t.push(this._sxFill),this._sxLocked&&t.push(this._sxLocked),this._sxLayer&&t.push(this._sxLayer),this._sxUuid&&t.push(this._sxUuid),t}},d(_f,"token","gr_rect"),_f);z.register(Kat);var Cp,xL=(Cp=class extends z{constructor(t,i){super();d(this,"token","start");d(this,"_x");d(this,"_y");this._x=t,this._y=i}static fromSexprPrimitives(t){let[i,r]=t,s=Dt(i),o=Dt(r);if(s===void 0||o===void 0)throw new Error("gr_rect start expects two numeric arguments");return new Cp(s,o)}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}toObject(){return{x:this._x,y:this._y}}getChildren(){return[]}getString(){return`(start ${this._x} ${this._y})`}},d(Cp,"token","start"),d(Cp,"parentToken","gr_rect"),Cp);z.register(xL);var Ip,bL=(Ip=class extends z{constructor(t,i){super();d(this,"token","end");d(this,"_x");d(this,"_y");this._x=t,this._y=i}static fromSexprPrimitives(t){let[i,r]=t,s=Dt(i),o=Dt(r);if(s===void 0||o===void 0)throw new Error("gr_rect end expects two numeric arguments");return new Ip(s,o)}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}toObject(){return{x:this._x,y:this._y}}getChildren(){return[]}getString(){return`(end ${this._x} ${this._y})`}},d(Ip,"token","end"),d(Ip,"parentToken","gr_rect"),Ip);z.register(bL);var Np,vL=(Np=class extends z{constructor(t){super();d(this,"token","fill");d(this,"filled");this.filled=t}static fromSexprPrimitives(t){let i=jt(t[0]);return new Np(i==="yes")}getString(){return`(fill ${this.filled?"yes":"no"})`}},d(Np,"token","fill"),d(Np,"parentToken","gr_rect"),Np);z.register(vL);var oc,Jat=(oc=class extends z{constructor(t){super();d(this,"token","locked");d(this,"value");this.value=t}static fromSexprPrimitives(t){if(t.length===0)return new oc(!0);let i=jt(t[0]);return new oc(i==="yes")}getString(){return this.value?"(locked yes)":"(locked no)"}},d(oc,"token","locked"),d(oc,"parentToken","gr_rect"),oc);z.register(Jat);var iYt=new Set(["at","xy","layer","tstamp","uuid","effects","render_cache"]),rYt=new Set(["at","xy","layer","tstamp","uuid","effects","render_cache"]),yf,Qat=(yf=class extends z{constructor(t={}){super();d(this,"token","gr_text");d(this,"_text","");d(this,"_sxPosition");d(this,"_sxLayer");d(this,"_sxTstamp");d(this,"_sxUuid");d(this,"_sxEffects");d(this,"_renderCaches",[]);typeof t=="string"?this.text=t:(t.text!==void 0&&(this.text=t.text),t.position!==void 0&&(this.position=t.position),t.layer!==void 0&&(this.layer=t.layer),t.tstamp!==void 0&&(this.tstamp=t.tstamp),t.uuid!==void 0&&(this.uuid=t.uuid),t.effects!==void 0&&(this.effects=t.effects),t.renderCaches!==void 0&&(this.renderCaches=t.renderCaches))}static fromSexprPrimitives(t){if(t.length===0)throw new Error("gr_text requires a text argument");let[i,...r]=t,s=jt(i);if(s===void 0)throw new Error("gr_text text must be a string value");let o=new yf(s),{propertyMap:a,arrayPropertyMap:c}=z.parsePrimitivesToClassProperties(r,this.token),l=new Set;for(let y of Object.keys(a))iYt.has(y)||l.add(y);for(let y of Object.keys(c)){if(!rYt.has(y)){l.add(y);continue}if(y!=="render_cache"&&c[y].length>1)throw new Error(`gr_text does not support repeated child tokens: ${y}`)}if(l.size>0)throw new Error(`Unsupported child tokens inside gr_text expression: ${[...l].join(", ")}`);for(let y of r)if(!Array.isArray(y))throw new Error(`gr_text encountered unexpected primitive child: ${JSON.stringify(y)}`);let u=a.at,p=a.xy;if(u&&p)throw new Error("gr_text cannot include both at and xy tokens");o._sxPosition=u??p,o._sxLayer=a.layer,o._sxTstamp=a.tstamp,o._sxUuid=a.uuid,o._sxEffects=a.effects;let f=c.render_cache;if(f&&f.length>0&&(o._renderCaches=f),!o._sxPosition)throw new Error("gr_text requires a position child token");if(!o._sxLayer)throw new Error("gr_text requires a layer child token");if(!o._sxUuid&&!o._sxTstamp)throw new Error("gr_text requires a uuid or tstamp child token");if(!o._sxEffects)throw new Error("gr_text requires an effects child token");return o}get text(){return this._text}set text(t){this._text=t}get position(){return this._sxPosition}set position(t){if(t===void 0){this._sxPosition=void 0;return}if(t instanceof Zr){this._sxPosition=t;return}if(typeof t=="object"&&"x"in t&&"y"in t&&!Array.isArray(t)&&!(t instanceof Un)){let{x:i,y:r,angle:s}=t;s!==void 0?this._sxPosition=new Un([i,r,s]):this._sxPosition=new Zr(i,r);return}this._sxPosition=Un.from(t)}get layer(){return this._sxLayer}set layer(t){if(t===void 0){this._sxLayer=void 0;return}if(t instanceof qe){this._sxLayer=t;return}let i=Array.isArray(t)?t:[t];this._sxLayer=new qe(i)}get tstamp(){return this._sxTstamp}set tstamp(t){if(t===void 0){this._sxTstamp=void 0;return}this._sxTstamp=t instanceof En?t:new En(t)}get uuid(){return this._sxUuid}set uuid(t){if(t===void 0){this._sxUuid=void 0;return}this._sxUuid=t instanceof Vt?t:new Vt(t)}get effects(){return this._sxEffects}set effects(t){this._sxEffects=t}get renderCaches(){return[...this._renderCaches]}set renderCaches(t){this._renderCaches=[...t]}getChildren(){let t=[];return this._sxPosition&&t.push(this._sxPosition),this._sxLayer&&t.push(this._sxLayer),this._sxTstamp&&t.push(this._sxTstamp),this._sxUuid&&t.push(this._sxUuid),this._sxEffects&&t.push(this._sxEffects),t.push(...this._renderCaches),t}getString(){let t=["(gr_text",`  ${re(this._text)}`];for(let i of this.getChildren())t.push(i.getStringIndented());return t.push(")"),t.join(`
`)}},d(yf,"token","gr_text"),yf);z.register(Qat);var Ap,sYt=(Ap=class extends z{constructor(t={}){super();d(this,"token","render_cache");d(this,"_text","");d(this,"_angle",0);d(this,"_polygons",[]);t.text!==void 0&&(this._text=t.text),t.angle!==void 0&&(this._angle=t.angle),t.polygons!==void 0&&(this._polygons=t.polygons)}static fromSexprPrimitives(t){let i=new Ap;t.length>=1&&(i._text=jt(t[0])??""),t.length>=2&&(i._angle=Dt(t[1])??0);for(let r=2;r<t.length;r++){let s=t[r];if(!Array.isArray(s)||s.length===0)continue;let o=z.parsePrimitiveSexpr(s,{parentToken:this.token});o instanceof tct&&i._polygons.push(o)}return i}get text(){return this._text}set text(t){this._text=t}get angle(){return this._angle}set angle(t){this._angle=t}get polygons(){return[...this._polygons]}set polygons(t){this._polygons=[...t]}getChildren(){return[...this._polygons]}getString(){let t=[`(render_cache ${re(this._text)} ${this._angle}`];for(let i of this._polygons)t.push(i.getStringIndented());return t.push(")"),t.join(`
`)}},d(Ap,"token","render_cache"),d(Ap,"parentToken","gr_text"),Ap);z.register(sYt);var Rp,tct=(Rp=class extends z{constructor(t={}){super();d(this,"token","polygon");d(this,"_pts");t.pts!==void 0&&(this._pts=t.pts)}static fromSexprPrimitives(t){let i=new Rp;for(let r of t){if(!Array.isArray(r)||r.length===0)continue;let s=z.parsePrimitiveSexpr(r,{parentToken:this.token});s instanceof Sr&&(i._pts=s)}return i}get pts(){return this._pts}set pts(t){this._pts=t}getChildren(){return this._pts?[this._pts]:[]}getString(){if(!this._pts)return"(polygon)";let t=["(polygon"];return t.push(this._pts.getStringIndented()),t.push(")"),t.join(`
`)}},d(Rp,"token","polygon"),d(Rp,"parentToken","render_cache"),Rp);z.register(tct);var Op,SL=(Op=class extends z{constructor(t){super();d(this,"token","fill");d(this,"filled");this.filled=t}static fromSexprPrimitives(t){let i=jt(t[0]);return new Op(i==="yes")}getString(){return`(fill ${this.filled?"yes":"no"})`}},d(Op,"token","fill"),d(Op,"parentToken","gr_poly"),Op);z.register(SL);var nR=new Set(["pts","xy","layer","width","stroke","fill","uuid"]),gf,ect=(gf=class extends z{constructor(t={}){super();d(this,"token","gr_poly");d(this,"_sxPts");d(this,"_sxLayer");d(this,"_sxWidth");d(this,"_sxStroke");d(this,"_sxFill");d(this,"_sxUuid");t.points!==void 0&&(this.points=t.points),t.layer!==void 0&&(this.layer=t.layer),t.width!==void 0&&(this.width=t.width),t.stroke!==void 0&&(this.stroke=t.stroke),t.fill!==void 0&&(this.fill=t.fill),t.uuid!==void 0&&(this.uuid=t.uuid)}static fromSexprPrimitives(t){let i=new gf,{propertyMap:r,arrayPropertyMap:s}=z.parsePrimitivesToClassProperties(t,this.token),o=new Set;for(let u of Object.keys(r))nR.has(u)||o.add(u);for(let u of Object.keys(s))nR.has(u)||o.add(u),u!=="xy"&&s[u].length>1&&o.add(u);if(o.size>0)throw new Error(`Unsupported child tokens inside gr_poly expression: ${[...o].join(", ")}`);let a=s.pts;if(a&&a.length>1)throw new Error("gr_poly does not support repeated pts tokens");let c=s.xy,l=r.pts;if(l&&c&&c.length>0)throw new Error("gr_poly cannot mix pts and xy child tokens");!l&&a?.length&&(l=a[0]),!l&&c&&c.length>0&&(l=new Sr(c)),i._sxPts=l,i._sxLayer=r.layer,i._sxWidth=r.width,i._sxStroke=r.stroke,i._sxFill=r.fill,i._sxUuid=r.uuid;for(let u of t){if(!Array.isArray(u)||u.length===0)throw new Error(`gr_poly encountered unexpected primitive child: ${JSON.stringify(u)}`);let[p,...f]=u;if(typeof p!="string")throw new Error(`gr_poly child token must be a string, received: ${JSON.stringify(p)}`);if(!nR.has(p))throw new Error(`Unsupported child token inside gr_poly expression: ${p}`)}if(!i._sxPts)throw new Error("gr_poly requires pts or xy child tokens");if(!i._sxLayer)throw new Error("gr_poly requires a layer child token");return i}get points(){return this._sxPts}set points(t){if(t===void 0){this._sxPts=void 0;return}if(t instanceof Sr){this._sxPts=t;return}if(Array.isArray(t)&&t.every(i=>i instanceof Zr)){this._sxPts=new Sr(t);return}if(Array.isArray(t)){this._sxPts=new Sr(t.map(({x:i,y:r})=>new Zr(i,r)));return}throw new Error("Unsupported points value provided to gr_poly")}get layer(){return this._sxLayer}set layer(t){if(t===void 0){this._sxLayer=void 0;return}if(t instanceof qe){this._sxLayer=t;return}let i=Array.isArray(t)?t:[t];this._sxLayer=new qe(i)}get width(){return this._sxWidth?.value}set width(t){if(t===void 0){this._sxWidth=void 0;return}this._sxWidth=t instanceof Je?t:new Je(t)}get widthClass(){return this._sxWidth}set widthClass(t){this._sxWidth=t}get stroke(){return this._sxStroke}set stroke(t){this._sxStroke=t}get fill(){if(this._sxFill){if("filled"in this._sxFill)return this._sxFill.filled;if("value"in this._sxFill)return this._sxFill.value}}set fill(t){if(t===void 0){this._sxFill=void 0;return}if(t instanceof SL){this._sxFill=t;return}this._sxFill=new SL(t)}get fillClass(){return this._sxFill}get uuid(){return this._sxUuid?.value}set uuid(t){if(t===void 0){this._sxUuid=void 0;return}this._sxUuid=t instanceof Vt?t:new Vt(t)}get uuidClass(){return this._sxUuid}getChildren(){let t=[];return this._sxPts&&t.push(this._sxPts),this._sxStroke&&t.push(this._sxStroke),this._sxWidth&&t.push(this._sxWidth),this._sxFill&&t.push(this._sxFill),this._sxLayer&&t.push(this._sxLayer),this._sxUuid&&t.push(this._sxUuid),t}},d(gf,"token","gr_poly"),gf);z.register(ect);var Xot=new Set(["uuid","locked","members"]),xf,oYt=(xf=class extends z{constructor(t={}){super();d(this,"token","group");d(this,"_name","");d(this,"_sxUuid");d(this,"_sxLocked");d(this,"_sxMembers");t.name!==void 0&&(this.name=t.name),t.uuid!==void 0&&(this.uuid=t.uuid),t.locked!==void 0&&(this.locked=t.locked),t.members!==void 0&&(this.members=t.members)}static fromSexprPrimitives(t){let i=new xf;t.length>0&&typeof t[0]=="string"&&(i._name=t[0]);let{propertyMap:r,arrayPropertyMap:s}=z.parsePrimitivesToClassProperties(t.slice(1),this.token),o=new Set;for(let c of Object.keys(r))Xot.has(c)||o.add(c);for(let c of Object.keys(s)){if(!Xot.has(c)){o.add(c);continue}if(s[c].length>1)throw new Error(`group does not support repeated child tokens: ${c}`)}if(o.size>0)throw new Error(`Unsupported child tokens inside group expression: ${[...o].join(", ")}`);for(let c of t.slice(1))if(!Array.isArray(c))throw new Error(`group encountered unexpected primitive child: ${JSON.stringify(c)}`);i._sxUuid=r.uuid;let a=r.locked;return i._sxLocked=a&&a.value?a:void 0,i._sxMembers=r.members,i}get name(){return this._name}set name(t){this._name=t}get uuid(){return this._sxUuid?.value}set uuid(t){if(t===void 0){this._sxUuid=void 0;return}this._sxUuid=t instanceof Vt?t:new Vt(t)}get uuidClass(){return this._sxUuid}get locked(){return this._sxLocked?.value??!1}set locked(t){this._sxLocked=t?new nct(!0):void 0}get members(){return this._sxMembers?.members??[]}set members(t){this._sxMembers=new ict(t)}get membersClass(){return this._sxMembers}getChildren(){let t=[];return this._sxUuid&&t.push(this._sxUuid),this._sxLocked&&t.push(this._sxLocked),this._sxMembers&&t.push(this._sxMembers),t}getString(){let t=[`(group "${this._name}"`],i=r=>{r&&t.push(r.getStringIndented())};return i(this._sxUuid),i(this._sxLocked),i(this._sxMembers),t.push(")"),t.join(`
`)}},d(xf,"token","group"),xf);z.register(oYt);var ac,nct=(ac=class extends z{constructor(t){super();d(this,"token","locked");d(this,"value");this.value=t}static fromSexprPrimitives(t){if(t.length===0)return new ac(!0);let i=jt(t[0]);return new ac(i==="yes")}getString(){return this.value?"(locked yes)":"(locked no)"}},d(ac,"token","locked"),d(ac,"parentToken","group"),ac);z.register(nct);var Lp,ict=(Lp=class extends z{constructor(t){super();d(this,"token","members");d(this,"members");this.members=t}static fromSexprPrimitives(t){let i=[];for(let r of t){let s=jt(r);s&&i.push(s)}return new Lp(i)}getString(){return this.members.length===0?"(members)":`(members ${this.members.map(i=>`"${i}"`).join(" ")})`}},d(Lp,"token","members"),d(Lp,"parentToken","group"),Lp);z.register(ict);var Fp,wL=(Fp=class extends z{constructor(t,i){super();d(this,"token","end");d(this,"_x");d(this,"_y");this._x=t,this._y=i}static fromSexprPrimitives(t){let[i,r]=t,s=Dt(i),o=Dt(r);if(s===void 0||o===void 0)throw new Error("end expects two numeric arguments");return new Fp(s,o)}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}toObject(){return{x:this._x,y:this._y}}getChildren(){return[]}getString(){return`(end ${this._x} ${this._y})`}},d(Fp,"token","end"),d(Fp,"parentToken","segment"),Fp);z.register(wL);var aYt=new Set(["true","yes","1"]),ea,rct=(ea=class extends ti{constructor(t){super(t);d(this,"token","locked")}static fromSexprPrimitives(t){let[i]=t;return typeof i=="boolean"?new ea(i):typeof i=="string"?new ea(aYt.has(i.toLowerCase())):new ea(!1)}getString(){return`(locked ${this.value?"yes":"no"})`}},d(ea,"token","locked"),d(ea,"parentToken","segment"),ea);z.register(rct);var zp,PL=(zp=class extends z{constructor(t,i){super();d(this,"token","net");d(this,"_id");d(this,"_name");this._id=t,this._name=i}static fromSexprPrimitives(t){let[i,r]=t,s=Dt(i);if(s===void 0)throw new Error("net expects a numeric identifier");let o=r===void 0?void 0:jt(r);return new zp(s,o??void 0)}get id(){return this._id}set id(t){this._id=t}get name(){return this._name}set name(t){this._name=t===""?void 0:t}toObject(){return this._name===void 0?{id:this._id}:{id:this._id,name:this._name}}getChildren(){return[]}getString(){let t=this._name?` ${re(this._name)}`:"";return`(net ${this._id}${t})`}},d(zp,"token","net"),d(zp,"parentToken","segment"),zp);z.register(PL);var $p,kL=($p=class extends z{constructor(t,i){super();d(this,"token","start");d(this,"_x");d(this,"_y");this._x=t,this._y=i}static fromSexprPrimitives(t){let[i,r]=t,s=Dt(i),o=Dt(r);if(s===void 0||o===void 0)throw new Error("start expects two numeric arguments");return new $p(s,o)}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}toObject(){return{x:this._x,y:this._y}}getChildren(){return[]}getString(){return`(start ${this._x} ${this._y})`}},d($p,"token","start"),d($p,"parentToken","segment"),$p);z.register(kL);var Uot=new Set(["start","end","width","layer","net","tstamp","uuid","locked"]),bf,sct=(bf=class extends z{constructor(t={}){super();d(this,"token","segment");d(this,"_sxStart");d(this,"_sxEnd");d(this,"_sxWidth");d(this,"_sxLayer");d(this,"_sxNet");d(this,"_sxTstamp");d(this,"_sxUuid");d(this,"_sxLocked");t.start!==void 0&&(this.start=t.start),t.end!==void 0&&(this.end=t.end),t.width!==void 0&&(this.width=t.width),t.layer!==void 0&&(this.layer=t.layer),t.net!==void 0&&(this.net=t.net),t.tstamp!==void 0&&(this.tstamp=t.tstamp),t.uuid!==void 0&&(this.uuid=t.uuid),t.locked!==void 0&&(this.locked=t.locked)}static fromSexprPrimitives(t){let i=new bf,{propertyMap:r,arrayPropertyMap:s}=z.parsePrimitivesToClassProperties(t,this.token),o=Object.keys(r).filter(c=>!Uot.has(c));if(o.length>0)throw new Error(`Unsupported child tokens inside segment expression: ${o.join(", ")}`);for(let[c,l]of Object.entries(s)){if(!Uot.has(c))throw new Error(`Unsupported child tokens inside segment expression: ${c}`);if(l.length>1)throw new Error(`Segment does not support repeated child tokens: ${c}`)}i._sxStart=s.start?.[0]??r.start,i._sxEnd=s.end?.[0]??r.end,i._sxWidth=s.width?.[0]??r.width,i._sxLayer=s.layer?.[0]??r.layer,i._sxNet=s.net?.[0]??r.net;let a=s.locked?.[0]??r.locked;return i._sxLocked=a&&a.value?a:void 0,i._sxTstamp=s.tstamp?.[0]??r.tstamp,i._sxUuid=s.uuid?.[0]??r.uuid,i}get start(){return this._sxStart}set start(t){this._sxStart=this.normalizeStart(t)}get end(){return this._sxEnd}set end(t){this._sxEnd=this.normalizeEnd(t)}get startPoint(){return this._sxStart?.toObject()}get endPoint(){return this._sxEnd?.toObject()}get width(){return this._sxWidth?.value}set width(t){if(t===void 0){this._sxWidth=void 0;return}this._sxWidth=t instanceof Je?t:new Je(t)}get widthClass(){return this._sxWidth}set widthClass(t){this._sxWidth=t}get layer(){return this._sxLayer}set layer(t){if(t===void 0){this._sxLayer=void 0;return}if(t instanceof qe){this._sxLayer=t;return}let i=Array.isArray(t)?t:[t];this._sxLayer=new qe(i)}get net(){return this._sxNet}set net(t){if(t===void 0){this._sxNet=void 0;return}if(t instanceof PL){this._sxNet=t;return}this._sxNet=new PL(t.id,t.name)}get tstamp(){return this._sxTstamp}set tstamp(t){if(t===void 0){this._sxTstamp=void 0;return}this._sxTstamp=t instanceof En?t:new En(t)}get uuid(){return this._sxUuid}set uuid(t){if(t===void 0){this._sxUuid=void 0;return}this._sxUuid=t instanceof Vt?t:new Vt(t)}get locked(){return this._sxLocked?.value??!1}set locked(t){this._sxLocked=t?new rct(!0):void 0}getChildren(){let t=[];return this._sxStart&&t.push(this._sxStart),this._sxEnd&&t.push(this._sxEnd),this._sxWidth&&t.push(this._sxWidth),this._sxLayer&&t.push(this._sxLayer),this._sxNet&&t.push(this._sxNet),this._sxLocked&&t.push(this._sxLocked),this._sxTstamp&&t.push(this._sxTstamp),this._sxUuid&&t.push(this._sxUuid),t}normalizeStart(t){if(t!==void 0)return t instanceof kL?t:new kL(t.x,t.y)}normalizeEnd(t){if(t!==void 0)return t instanceof wL?t:new wL(t.x,t.y)}},d(bf,"token","segment"),bf);z.register(sct);var vf,oct=(vf=class extends z{constructor(){super(...arguments);d(this,"token","zone");d(this,"_rawChildren",[])}static fromSexprPrimitives(t){let i=new vf;return i._rawChildren=[...t],i}get rawChildren(){return[...this._rawChildren]}set rawChildren(t){this._rawChildren=[...t]}getChildren(){return[]}getString(){let t=["(zone"];for(let i of this._rawChildren)t.push(`  ${Wi(i)}`);return t.push(")"),t.join(`
`)}},d(vf,"token","zone"),vf);z.register(oct);var Sf,sT=(Sf=class extends z{constructor(t=[]){super();d(this,"token","layers");d(this,"_names",[]);this.names=t}static fromSexprPrimitives(t){let i=t.map(r=>typeof r=="string"||typeof r=="number"?String(r):Wi(r));return new Sf(i)}get names(){return[...this._names]}set names(t){this._names=t.map(i=>String(i))}getString(){return`(layers ${this._names.map(i=>/^[^\s()"]+$/u.test(i)&&!["nil","#t","#f"].includes(i)?i:re(i)).join(" ")})`}},d(Sf,"token","layers"),Sf);z.register(sT);var F0=class extends z{constructor(e){super();d(this,"_value");d(this,"quoteStringValue",!1);this._value=e}static fromSexprPrimitives(e){let[t]=e,i=this.parsePrimitiveValue(t),r=this;return new r(i)}static parsePrimitiveValue(e){let t=jt(e);if(t===void 0)throw new Error(`${this.name} expects a primitive value`);return t}get value(){return this._value}set value(e){this._value=e}getChildren(){return[]}formatValue(){return typeof this._value=="string"?this.quoteStringValue?re(this._value):this._value:`${this._value}`}getString(){return`(${this.token} ${this.formatValue()})`}},cYt=class extends z{constructor(e){super();d(this,"_values");this._values=e}static fromSexprPrimitives(e){let t=e.map(r=>{let s=Dt(r);if(s===void 0)throw new Error(`${this.name} expects numeric primitives but received ${r}`);return s}),i=this;return new i(t)}get values(){return[...this._values]}set values(e){this._values=[...e]}getChildren(){return[]}getString(){return`(${this.token} ${this._values.join(" ")})`}},lYt=class extends z{constructor(e,t){super();d(this,"_x");d(this,"_y");this._x=e,this._y=t}static fromSexprPrimitives(e){let[t,i]=e,r=Dt(t),s=Dt(i);if(r===void 0||s===void 0)throw new Error(`${this.name} expects two numeric values`);let o=this;return new o(r,s)}get x(){return this._x}set x(e){this._x=e}get y(){return this._y}set y(e){this._y=e}getChildren(){return[]}getString(){return`(${this.token} ${this._x} ${this._y})`}},dR,Ze=(dR=class extends F0{},d(dR,"parentToken","pcbplotparams"),dR),Ys=class extends Ze{static parsePrimitiveValue(n){let e=Dt(n);if(e===void 0)throw new Error(`pcbplotparams ${this.token} expects a numeric value`);return e}},fR,act=(fR=class extends Ze{constructor(){super(...arguments);d(this,"token","layerselection")}},d(fR,"token","layerselection"),fR);z.register(act);var mR,cct=(mR=class extends Ze{constructor(){super(...arguments);d(this,"token","plot_on_all_layers_selection")}},d(mR,"token","plot_on_all_layers_selection"),mR);z.register(cct);var _R,lct=(_R=class extends Ys{constructor(){super(...arguments);d(this,"token","dashed_line_dash_ratio")}},d(_R,"token","dashed_line_dash_ratio"),_R);z.register(lct);var yR,uct=(yR=class extends Ys{constructor(){super(...arguments);d(this,"token","dashed_line_gap_ratio")}},d(yR,"token","dashed_line_gap_ratio"),yR);z.register(uct);var gR,pct=(gR=class extends Ys{constructor(){super(...arguments);d(this,"token","svgprecision")}},d(gR,"token","svgprecision"),gR);z.register(pct);var xR,hct=(xR=class extends Ys{constructor(){super(...arguments);d(this,"token","linewidth")}},d(xR,"token","linewidth"),xR);z.register(hct);var bR,dct=(bR=class extends Ys{constructor(){super(...arguments);d(this,"token","mode")}},d(bR,"token","mode"),bR);z.register(dct);var vR,fct=(vR=class extends Ys{constructor(){super(...arguments);d(this,"token","hpglpennumber")}},d(vR,"token","hpglpennumber"),vR);z.register(fct);var SR,mct=(SR=class extends Ys{constructor(){super(...arguments);d(this,"token","hpglpenspeed")}},d(SR,"token","hpglpenspeed"),SR);z.register(mct);var wR,_ct=(wR=class extends Ys{constructor(){super(...arguments);d(this,"token","hpglpendiameter")}},d(wR,"token","hpglpendiameter"),wR);z.register(_ct);var PR,yct=(PR=class extends Ys{constructor(){super(...arguments);d(this,"token","hpglpenoverlay")}},d(PR,"token","hpglpenoverlay"),PR);z.register(yct);var kR,gct=(kR=class extends Ys{constructor(){super(...arguments);d(this,"token","outputformat")}},d(kR,"token","outputformat"),kR);z.register(gct);var TR,xct=(TR=class extends Ys{constructor(){super(...arguments);d(this,"token","drillshape")}},d(TR,"token","drillshape"),TR);z.register(xct);var ER,bct=(ER=class extends Ys{constructor(){super(...arguments);d(this,"token","scaleselection")}},d(ER,"token","scaleselection"),ER);z.register(bct);var MR,vct=(MR=class extends Ze{constructor(){super(...arguments);d(this,"token","disableapertmacros")}},d(MR,"token","disableapertmacros"),MR);z.register(vct);var CR,Sct=(CR=class extends Ze{constructor(){super(...arguments);d(this,"token","usegerberextensions")}},d(CR,"token","usegerberextensions"),CR);z.register(Sct);var IR,wct=(IR=class extends Ze{constructor(){super(...arguments);d(this,"token","usegerberattributes")}},d(IR,"token","usegerberattributes"),IR);z.register(wct);var NR,Pct=(NR=class extends Ze{constructor(){super(...arguments);d(this,"token","usegerberadvancedattributes")}},d(NR,"token","usegerberadvancedattributes"),NR);z.register(Pct);var AR,kct=(AR=class extends Ze{constructor(){super(...arguments);d(this,"token","creategerberjobfile")}},d(AR,"token","creategerberjobfile"),AR);z.register(kct);var RR,Tct=(RR=class extends Ze{constructor(){super(...arguments);d(this,"token","excludeedgelayer")}},d(RR,"token","excludeedgelayer"),RR);z.register(Tct);var OR,Ect=(OR=class extends Ze{constructor(){super(...arguments);d(this,"token","plotframeref")}},d(OR,"token","plotframeref"),OR);z.register(Ect);var LR,Mct=(LR=class extends Ze{constructor(){super(...arguments);d(this,"token","viasonmask")}},d(LR,"token","viasonmask"),LR);z.register(Mct);var FR,Cct=(FR=class extends Ze{constructor(){super(...arguments);d(this,"token","useauxorigin")}},d(FR,"token","useauxorigin"),FR);z.register(Cct);var zR,Ict=(zR=class extends Ze{constructor(){super(...arguments);d(this,"token","pdf_front_fp_property_popups")}},d(zR,"token","pdf_front_fp_property_popups"),zR);z.register(Ict);var $R,Nct=($R=class extends Ze{constructor(){super(...arguments);d(this,"token","pdf_back_fp_property_popups")}},d($R,"token","pdf_back_fp_property_popups"),$R);z.register(Nct);var DR,Act=(DR=class extends Ze{constructor(){super(...arguments);d(this,"token","pdf_metadata")}},d(DR,"token","pdf_metadata"),DR);z.register(Act);var jR,Rct=(jR=class extends Ze{constructor(){super(...arguments);d(this,"token","pdf_single_document")}},d(jR,"token","pdf_single_document"),jR);z.register(Rct);var BR,Oct=(BR=class extends Ze{constructor(){super(...arguments);d(this,"token","dxfpolygonmode")}},d(BR,"token","dxfpolygonmode"),BR);z.register(Oct);var YR,Lct=(YR=class extends Ze{constructor(){super(...arguments);d(this,"token","dxfimperialunits")}},d(YR,"token","dxfimperialunits"),YR);z.register(Lct);var XR,Fct=(XR=class extends Ze{constructor(){super(...arguments);d(this,"token","dxfusepcbnewfont")}},d(XR,"token","dxfusepcbnewfont"),XR);z.register(Fct);var UR,zct=(UR=class extends Ze{constructor(){super(...arguments);d(this,"token","psnegative")}},d(UR,"token","psnegative"),UR);z.register(zct);var VR,$ct=(VR=class extends Ze{constructor(){super(...arguments);d(this,"token","psa4output")}},d(VR,"token","psa4output"),VR);z.register($ct);var GR,Dct=(GR=class extends Ze{constructor(){super(...arguments);d(this,"token","plotreference")}},d(GR,"token","plotreference"),GR);z.register(Dct);var HR,jct=(HR=class extends Ze{constructor(){super(...arguments);d(this,"token","plotvalue")}},d(HR,"token","plotvalue"),HR);z.register(jct);var WR,Bct=(WR=class extends Ze{constructor(){super(...arguments);d(this,"token","plotothertext")}},d(WR,"token","plotothertext"),WR);z.register(Bct);var qR,Yct=(qR=class extends Ze{constructor(){super(...arguments);d(this,"token","plotinvisibletext")}},d(qR,"token","plotinvisibletext"),qR);z.register(Yct);var ZR,Xct=(ZR=class extends Ze{constructor(){super(...arguments);d(this,"token","padsonsilk")}},d(ZR,"token","padsonsilk"),ZR);z.register(Xct);var KR,Uct=(KR=class extends Ze{constructor(){super(...arguments);d(this,"token","sketchpadsonfab")}},d(KR,"token","sketchpadsonfab"),KR);z.register(Uct);var JR,Vct=(JR=class extends Ze{constructor(){super(...arguments);d(this,"token","plotpadnumbers")}},d(JR,"token","plotpadnumbers"),JR);z.register(Vct);var QR,Gct=(QR=class extends Ze{constructor(){super(...arguments);d(this,"token","hidednponfab")}},d(QR,"token","hidednponfab"),QR);z.register(Gct);var t8,Hct=(t8=class extends Ze{constructor(){super(...arguments);d(this,"token","sketchdnponfab")}},d(t8,"token","sketchdnponfab"),t8);z.register(Hct);var e8,Wct=(e8=class extends Ze{constructor(){super(...arguments);d(this,"token","crossoutdnponfab")}},d(e8,"token","crossoutdnponfab"),e8);z.register(Wct);var n8,qct=(n8=class extends Ze{constructor(){super(...arguments);d(this,"token","subtractmaskfromsilk")}},d(n8,"token","subtractmaskfromsilk"),n8);z.register(qct);var i8,Zct=(i8=class extends Ze{constructor(){super(...arguments);d(this,"token","plot_black_and_white")}},d(i8,"token","plot_black_and_white"),i8);z.register(Zct);var r8,Kct=(r8=class extends Ze{constructor(){super(...arguments);d(this,"token","mirror")}},d(r8,"token","mirror"),r8);z.register(Kct);var s8,Jct=(s8=class extends Ze{constructor(){super(...arguments);d(this,"token","outputdirectory");d(this,"quoteStringValue",!0)}},d(s8,"token","outputdirectory"),s8);z.register(Jct);var o8,Qct=(o8=class extends Ze{constructor(){super(...arguments);d(this,"token","plot_on_all_layers")}},d(o8,"token","plot_on_all_layers"),o8);z.register(Qct);var a8,tlt=(a8=class extends Ze{constructor(){super(...arguments);d(this,"token","plotinvisible")}},d(a8,"token","plotinvisible"),a8);z.register(tlt);var uYt={layerselection:"layerselection",plot_on_all_layers_selection:"plot_on_all_layers_selection",disableapertmacros:"disableapertmacros",usegerberextensions:"usegerberextensions",usegerberattributes:"usegerberattributes",usegerberadvancedattributes:"usegerberadvancedattributes",creategerberjobfile:"creategerberjobfile",excludeedgelayer:"excludeedgelayer",dashed_line_dash_ratio:"dashed_line_dash_ratio",dashed_line_gap_ratio:"dashed_line_gap_ratio",svgprecision:"svgprecision",linewidth:"linewidth",plotframeref:"plotframeref",plotreference:"plotreference",plotvalue:"plotvalue",plotothertext:"plotothertext",plotinvisibletext:"plotinvisibletext",padsonsilk:"padsonsilk",sketchpadsonfab:"sketchpadsonfab",plotpadnumbers:"plotpadnumbers",hidednponfab:"hidednponfab",sketchdnponfab:"sketchdnponfab",crossoutdnponfab:"crossoutdnponfab",subtractmaskfromsilk:"subtractmaskfromsilk",plot_black_and_white:"plot_black_and_white",plot_on_all_layers:"plot_on_all_layers",plotinvisible:"plotinvisible",mode:"mode",useauxorigin:"useauxorigin",viasonmask:"viasonmask",hpglpennumber:"hpglpennumber",hpglpenspeed:"hpglpenspeed",hpglpendiameter:"hpglpendiameter",hpglpenoverlay:"hpglpenoverlay",pdf_front_fp_property_popups:"pdf_front_fp_property_popups",pdf_back_fp_property_popups:"pdf_back_fp_property_popups",pdf_metadata:"pdf_metadata",pdf_single_document:"pdf_single_document",dxfpolygonmode:"dxfpolygonmode",dxfimperialunits:"dxfimperialunits",dxfusepcbnewfont:"dxfusepcbnewfont",psnegative:"psnegative",psa4output:"psa4output",mirror:"mirror",outputformat:"outputformat",drillshape:"drillshape",scaleselection:"scaleselection",outputdirectory:"outputdirectory"},pYt=["layerselection","plot_on_all_layers_selection","disableapertmacros","usegerberextensions","usegerberattributes","usegerberadvancedattributes","creategerberjobfile","excludeedgelayer","dashed_line_dash_ratio","dashed_line_gap_ratio","svgprecision","linewidth","plotframeref","plotreference","plotvalue","plotothertext","mode","useauxorigin","viasonmask","hpglpennumber","hpglpenspeed","hpglpendiameter","hpglpenoverlay","pdf_front_fp_property_popups","pdf_back_fp_property_popups","pdf_metadata","pdf_single_document","dxfpolygonmode","dxfimperialunits","dxfusepcbnewfont","psnegative","psa4output","plot_black_and_white","plot_on_all_layers","plotinvisible","plotinvisibletext","padsonsilk","sketchpadsonfab","plotpadnumbers","hidednponfab","sketchdnponfab","crossoutdnponfab","subtractmaskfromsilk","outputformat","mirror","drillshape","scaleselection","outputdirectory"],Dp,TL=(Dp=class extends z{constructor(){super(...arguments);d(this,"token","pcbplotparams");d(this,"_properties",{})}static fromSexprPrimitives(t){let i=new Dp,{propertyMap:r}=z.parsePrimitivesToClassProperties(t,this.token);for(let[s,o]of Object.entries(r)){let a=uYt[s];if(!a)throw new Error(`Unsupported pcbplotparams token: ${s}`);i._properties[a]=o}return i}getChildren(){let t=[];for(let i of pYt){let r=this._properties[i];r&&t.push(r)}return t}clearProperty(t){delete this._properties[t]}setStringProperty(t,i,r){if(i===void 0){this.clearProperty(t);return}this._properties[t]=new r(i)}setNumberProperty(t,i,r){if(i===void 0){this.clearProperty(t);return}this._properties[t]=new r(i)}setStringOrNumberProperty(t,i,r){if(i===void 0){this.clearProperty(t);return}this._properties[t]=new r(i)}get layerselection(){return this._properties.layerselection?.value}set layerselection(t){this.setStringOrNumberProperty("layerselection",t,act)}get plot_on_all_layers_selection(){return this._properties.plot_on_all_layers_selection?.value}set plot_on_all_layers_selection(t){this.setStringOrNumberProperty("plot_on_all_layers_selection",t,cct)}get disableapertmacros(){return this._properties.disableapertmacros?.value}set disableapertmacros(t){this.setStringProperty("disableapertmacros",t,vct)}get usegerberextensions(){return this._properties.usegerberextensions?.value}set usegerberextensions(t){this.setStringProperty("usegerberextensions",t,Sct)}get usegerberattributes(){return this._properties.usegerberattributes?.value}set usegerberattributes(t){this.setStringProperty("usegerberattributes",t,wct)}get usegerberadvancedattributes(){return this._properties.usegerberadvancedattributes?.value}set usegerberadvancedattributes(t){this.setStringProperty("usegerberadvancedattributes",t,Pct)}get creategerberjobfile(){return this._properties.creategerberjobfile?.value}set creategerberjobfile(t){this.setStringProperty("creategerberjobfile",t,kct)}get excludeedgelayer(){return this._properties.excludeedgelayer?.value}set excludeedgelayer(t){this.setStringProperty("excludeedgelayer",t,Tct)}get dashed_line_dash_ratio(){return this._properties.dashed_line_dash_ratio?.value}set dashed_line_dash_ratio(t){this.setNumberProperty("dashed_line_dash_ratio",t,lct)}get dashed_line_gap_ratio(){return this._properties.dashed_line_gap_ratio?.value}set dashed_line_gap_ratio(t){this.setNumberProperty("dashed_line_gap_ratio",t,uct)}get svgprecision(){return this._properties.svgprecision?.value}set svgprecision(t){this.setNumberProperty("svgprecision",t,pct)}get linewidth(){return this._properties.linewidth?.value}set linewidth(t){this.setNumberProperty("linewidth",t,hct)}get plotframeref(){return this._properties.plotframeref?.value}set plotframeref(t){this.setStringProperty("plotframeref",t,Ect)}get plotreference(){return this._properties.plotreference?.value}set plotreference(t){this.setStringProperty("plotreference",t,Dct)}get plotvalue(){return this._properties.plotvalue?.value}set plotvalue(t){this.setStringProperty("plotvalue",t,jct)}get plotothertext(){return this._properties.plotothertext?.value}set plotothertext(t){this.setStringProperty("plotothertext",t,Bct)}get plotinvisibletext(){return this._properties.plotinvisibletext?.value}set plotinvisibletext(t){this.setStringProperty("plotinvisibletext",t,Yct)}get padsonsilk(){return this._properties.padsonsilk?.value}set padsonsilk(t){this.setStringProperty("padsonsilk",t,Xct)}get plotpadnumbers(){return this._properties.plotpadnumbers?.value}set plotpadnumbers(t){this.setStringProperty("plotpadnumbers",t,Vct)}get sketchpadsonfab(){return this._properties.sketchpadsonfab?.value}set sketchpadsonfab(t){this.setStringProperty("sketchpadsonfab",t,Uct)}get hidednponfab(){return this._properties.hidednponfab?.value}set hidednponfab(t){this.setStringProperty("hidednponfab",t,Gct)}get sketchdnponfab(){return this._properties.sketchdnponfab?.value}set sketchdnponfab(t){this.setStringProperty("sketchdnponfab",t,Hct)}get crossoutdnponfab(){return this._properties.crossoutdnponfab?.value}set crossoutdnponfab(t){this.setStringProperty("crossoutdnponfab",t,Wct)}get subtractmaskfromsilk(){return this._properties.subtractmaskfromsilk?.value}set subtractmaskfromsilk(t){this.setStringProperty("subtractmaskfromsilk",t,qct)}get plot_black_and_white(){return this._properties.plot_black_and_white?.value}set plot_black_and_white(t){this.setStringProperty("plot_black_and_white",t,Zct)}get plot_on_all_layers(){return this._properties.plot_on_all_layers?.value}set plot_on_all_layers(t){this.setStringProperty("plot_on_all_layers",t,Qct)}get plotinvisible(){return this._properties.plotinvisible?.value}set plotinvisible(t){this.setStringProperty("plotinvisible",t,tlt)}get mode(){return this._properties.mode?.value}set mode(t){this.setNumberProperty("mode",t,dct)}get useauxorigin(){return this._properties.useauxorigin?.value}set useauxorigin(t){this.setStringProperty("useauxorigin",t,Cct)}get viasonmask(){return this._properties.viasonmask?.value}set viasonmask(t){this.setStringProperty("viasonmask",t,Mct)}get hpglpennumber(){return this._properties.hpglpennumber?.value}set hpglpennumber(t){this.setNumberProperty("hpglpennumber",t,fct)}get hpglpenspeed(){return this._properties.hpglpenspeed?.value}set hpglpenspeed(t){this.setNumberProperty("hpglpenspeed",t,mct)}get hpglpendiameter(){return this._properties.hpglpendiameter?.value}set hpglpendiameter(t){this.setNumberProperty("hpglpendiameter",t,_ct)}get hpglpenoverlay(){return this._properties.hpglpenoverlay?.value}set hpglpenoverlay(t){this.setNumberProperty("hpglpenoverlay",t,yct)}get pdf_front_fp_property_popups(){return this._properties.pdf_front_fp_property_popups?.value}set pdf_front_fp_property_popups(t){this.setStringProperty("pdf_front_fp_property_popups",t,Ict)}get pdf_back_fp_property_popups(){return this._properties.pdf_back_fp_property_popups?.value}set pdf_back_fp_property_popups(t){this.setStringProperty("pdf_back_fp_property_popups",t,Nct)}get pdf_metadata(){return this._properties.pdf_metadata?.value}set pdf_metadata(t){this.setStringProperty("pdf_metadata",t,Act)}get pdf_single_document(){return this._properties.pdf_single_document?.value}set pdf_single_document(t){this.setStringProperty("pdf_single_document",t,Rct)}get dxfpolygonmode(){return this._properties.dxfpolygonmode?.value}set dxfpolygonmode(t){this.setStringProperty("dxfpolygonmode",t,Oct)}get dxfimperialunits(){return this._properties.dxfimperialunits?.value}set dxfimperialunits(t){this.setStringProperty("dxfimperialunits",t,Lct)}get dxfusepcbnewfont(){return this._properties.dxfusepcbnewfont?.value}set dxfusepcbnewfont(t){this.setStringProperty("dxfusepcbnewfont",t,Fct)}get psnegative(){return this._properties.psnegative?.value}set psnegative(t){this.setStringProperty("psnegative",t,zct)}get psa4output(){return this._properties.psa4output?.value}set psa4output(t){this.setStringProperty("psa4output",t,$ct)}get mirror(){return this._properties.mirror?.value}set mirror(t){this.setStringProperty("mirror",t,Kct)}get outputformat(){return this._properties.outputformat?.value}set outputformat(t){this.setNumberProperty("outputformat",t,gct)}get drillshape(){return this._properties.drillshape?.value}set drillshape(t){this.setNumberProperty("drillshape",t,xct)}get scaleselection(){return this._properties.scaleselection?.value}set scaleselection(t){this.setNumberProperty("scaleselection",t,bct)}get outputdirectory(){return this._properties.outputdirectory?.value}set outputdirectory(t){this.setStringProperty("outputdirectory",t,Jct)}},d(Dp,"token","pcbplotparams"),d(Dp,"parentToken","setup"),Dp);z.register(TL);var c8,lT=(c8=class extends F0{},d(c8,"parentToken","setup"),c8),l8,EL=(l8=class extends lT{constructor(){super(...arguments);d(this,"token","zone_45_only")}},d(l8,"token","zone_45_only"),l8);z.register(EL);var u8,ML=(u8=class extends lT{constructor(){super(...arguments);d(this,"token","allow_soldermask_bridges_in_footprints")}},d(u8,"token","allow_soldermask_bridges_in_footprints"),u8);z.register(ML);var p8,CL=(p8=class extends lT{constructor(){super(...arguments);d(this,"token","visible_elements")}},d(p8,"token","visible_elements"),p8);z.register(CL);var h8,IL=(h8=class extends lT{constructor(){super(...arguments);d(this,"token","uvias_allowed")}},d(h8,"token","uvias_allowed"),h8);z.register(IL);var jp,NL=(jp=class extends z{constructor(t=[]){super();d(this,"token","tenting");d(this,"_sides",[]);this.sides=t}static fromSexprPrimitives(t){let i=t.map(r=>jt(r)).filter(r=>r!==void 0);return new jp(i)}get sides(){return[...this._sides]}set sides(t){this._sides=t.map(i=>String(i))}getChildren(){return[]}getString(){return this._sides.length===0?"(tenting)":`(tenting ${this._sides.join(" ")})`}},d(jp,"token","tenting"),d(jp,"parentToken","setup"),jp);z.register(NL);var d8,z0=(d8=class extends cYt{},d(d8,"parentToken","setup"),d8),f8,elt=(f8=class extends lYt{},d(f8,"parentToken","setup"),f8),m8,AL=(m8=class extends z0{constructor(){super(...arguments);d(this,"token","pcb_text_size")}},d(m8,"token","pcb_text_size"),m8);z.register(AL);var _8,RL=(_8=class extends z0{constructor(){super(...arguments);d(this,"token","mod_text_size")}},d(_8,"token","mod_text_size"),_8);z.register(RL);var y8,OL=(y8=class extends z0{constructor(){super(...arguments);d(this,"token","pad_size")}},d(y8,"token","pad_size"),y8);z.register(OL);var g8,LL=(g8=class extends z0{constructor(){super(...arguments);d(this,"token","pad_to_paste_clearance_values")}},d(g8,"token","pad_to_paste_clearance_values"),g8);z.register(LL);var x8,FL=(x8=class extends z0{constructor(){super(...arguments);d(this,"token","trace_width")}},d(x8,"token","trace_width"),x8);z.register(FL);var b8,zL=(b8=class extends elt{constructor(){super(...arguments);d(this,"token","aux_axis_origin")}},d(b8,"token","aux_axis_origin"),b8);z.register(zL);var v8,$L=(v8=class extends elt{constructor(){super(...arguments);d(this,"token","grid_origin")}},d(v8,"token","grid_origin"),v8);z.register($L);var S8,ui=(S8=class extends F0{static parsePrimitiveValue(n){let e=Dt(n);if(e===void 0)throw new Error(`${this.name} expects a numeric value`);return e}},d(S8,"parentToken","setup"),S8),w8,DL=(w8=class extends ui{constructor(){super(...arguments);d(this,"token","pad_to_mask_clearance")}},d(w8,"token","pad_to_mask_clearance"),w8);z.register(DL);var P8,jL=(P8=class extends ui{constructor(){super(...arguments);d(this,"token","solder_mask_min_width")}},d(P8,"token","solder_mask_min_width"),P8);z.register(jL);var k8,BL=(k8=class extends ui{constructor(){super(...arguments);d(this,"token","pad_to_paste_clearance")}},d(k8,"token","pad_to_paste_clearance"),k8);z.register(BL);var T8,YL=(T8=class extends ui{constructor(){super(...arguments);d(this,"token","pad_to_paste_clearance_ratio")}},d(T8,"token","pad_to_paste_clearance_ratio"),T8);z.register(YL);var E8,XL=(E8=class extends ui{constructor(){super(...arguments);d(this,"token","last_trace_width")}},d(E8,"token","last_trace_width"),E8);z.register(XL);var M8,UL=(M8=class extends ui{constructor(){super(...arguments);d(this,"token","trace_clearance")}},d(M8,"token","trace_clearance"),M8);z.register(UL);var C8,VL=(C8=class extends ui{constructor(){super(...arguments);d(this,"token","zone_clearance")}},d(C8,"token","zone_clearance"),C8);z.register(VL);var I8,GL=(I8=class extends ui{constructor(){super(...arguments);d(this,"token","trace_min")}},d(I8,"token","trace_min"),I8);z.register(GL);var N8,HL=(N8=class extends ui{constructor(){super(...arguments);d(this,"token","segment_width")}},d(N8,"token","segment_width"),N8);z.register(HL);var A8,WL=(A8=class extends ui{constructor(){super(...arguments);d(this,"token","edge_width")}},d(A8,"token","edge_width"),A8);z.register(WL);var R8,qL=(R8=class extends ui{constructor(){super(...arguments);d(this,"token","via_size")}},d(R8,"token","via_size"),R8);z.register(qL);var O8,ZL=(O8=class extends ui{constructor(){super(...arguments);d(this,"token","via_drill")}},d(O8,"token","via_drill"),O8);z.register(ZL);var L8,KL=(L8=class extends ui{constructor(){super(...arguments);d(this,"token","via_min_size")}},d(L8,"token","via_min_size"),L8);z.register(KL);var F8,JL=(F8=class extends ui{constructor(){super(...arguments);d(this,"token","via_min_drill")}},d(F8,"token","via_min_drill"),F8);z.register(JL);var z8,QL=(z8=class extends ui{constructor(){super(...arguments);d(this,"token","uvia_size")}},d(z8,"token","uvia_size"),z8);z.register(QL);var $8,t7=($8=class extends ui{constructor(){super(...arguments);d(this,"token","uvia_drill")}},d($8,"token","uvia_drill"),$8);z.register(t7);var D8,e7=(D8=class extends ui{constructor(){super(...arguments);d(this,"token","uvia_min_size")}},d(D8,"token","uvia_min_size"),D8);z.register(e7);var j8,n7=(j8=class extends ui{constructor(){super(...arguments);d(this,"token","uvia_min_drill")}},d(j8,"token","uvia_min_drill"),j8);z.register(n7);var B8,i7=(B8=class extends ui{constructor(){super(...arguments);d(this,"token","pcb_text_width")}},d(B8,"token","pcb_text_width"),B8);z.register(i7);var Y8,r7=(Y8=class extends ui{constructor(){super(...arguments);d(this,"token","mod_edge_width")}},d(Y8,"token","mod_edge_width"),Y8);z.register(r7);var X8,s7=(X8=class extends ui{constructor(){super(...arguments);d(this,"token","mod_text_width")}},d(X8,"token","mod_text_width"),X8);z.register(s7);var U8,o7=(U8=class extends ui{constructor(){super(...arguments);d(this,"token","pad_drill")}},d(U8,"token","pad_drill"),U8);z.register(o7);var V8,$0=(V8=class extends F0{},d(V8,"parentToken","stackup"),V8),G8,nlt=(G8=class extends $0{constructor(){super(...arguments);d(this,"token","copper_finish");d(this,"quoteStringValue",!0)}},d(G8,"token","copper_finish"),G8);z.register(nlt);var H8,ilt=(H8=class extends $0{constructor(){super(...arguments);d(this,"token","dielectric_constraints")}},d(H8,"token","dielectric_constraints"),H8);z.register(ilt);var W8,rlt=(W8=class extends $0{constructor(){super(...arguments);d(this,"token","edge_connector")}},d(W8,"token","edge_connector"),W8);z.register(rlt);var q8,slt=(q8=class extends $0{constructor(){super(...arguments);d(this,"token","castellated_pads")}},d(q8,"token","castellated_pads"),q8);z.register(slt);var Z8,olt=(Z8=class extends $0{constructor(){super(...arguments);d(this,"token","edge_plating")}},d(Z8,"token","edge_plating"),Z8);z.register(olt);var K8,_y=(K8=class extends F0{},d(K8,"parentToken","layer"),K8),J8,a7=(J8=class extends _y{constructor(){super(...arguments);d(this,"token","type");d(this,"quoteStringValue",!0)}},d(J8,"token","type"),J8);z.register(a7);var Q8,c7=(Q8=class extends _y{constructor(){super(...arguments);d(this,"token","color");d(this,"quoteStringValue",!0)}},d(Q8,"token","color"),Q8);z.register(c7);var tO,l7=(tO=class extends _y{constructor(){super(...arguments);d(this,"token","thickness")}static parsePrimitiveValue(e){let t=Dt(e);if(t===void 0)throw new Error("Stackup layer thickness expects a numeric value");return t}},d(tO,"token","thickness"),tO);z.register(l7);var eO,u7=(eO=class extends _y{constructor(){super(...arguments);d(this,"token","material");d(this,"quoteStringValue",!0)}},d(eO,"token","material"),eO);z.register(u7);var nO,p7=(nO=class extends _y{constructor(){super(...arguments);d(this,"token","epsilon_r")}static parsePrimitiveValue(e){let t=Dt(e);if(t===void 0)throw new Error("Stackup layer epsilon_r expects a numeric value");return t}},d(nO,"token","epsilon_r"),nO);z.register(p7);var iO,h7=(iO=class extends _y{constructor(){super(...arguments);d(this,"token","loss_tangent")}static parsePrimitiveValue(e){let t=Dt(e);if(t===void 0)throw new Error("Stackup layer loss_tangent expects a numeric value");return t}},d(iO,"token","loss_tangent"),iO);z.register(h7);var Bp,alt=(Bp=class extends z{constructor(t,i={}){super();d(this,"token","layer");d(this,"_name");d(this,"_number");d(this,"_sxType");d(this,"_sxColor");d(this,"_sxThickness");d(this,"_sxMaterial");d(this,"_sxEpsilonR");d(this,"_sxLossTangent");this._name=t,this._number=i.number,this._sxType=i.type,this._sxColor=i.color,this._sxThickness=i.thickness,this._sxMaterial=i.material,this._sxEpsilonR=i.epsilonR,this._sxLossTangent=i.lossTangent}static fromSexprPrimitives(t){if(t.length===0)throw new Error("Stackup layer requires at least a name");let i=jt(t[0]);if(i===void 0)throw new Error("Stackup layer name must be a string");let r=1,s,o=t[r],a=Dt(o);a!==void 0&&(s=a,r+=1);let c=t.slice(r),{propertyMap:l}=z.parsePrimitivesToClassProperties(c,this.token);return new Bp(i,{number:s,type:l.type,color:l.color,thickness:l.thickness,material:l.material,epsilonR:l.epsilon_r,lossTangent:l.loss_tangent})}get name(){return this._name}set name(t){let i=jt(t);if(i===void 0)throw new Error("Stackup layer name must be a string");this._name=i}get number(){return this._number}set number(t){if(t===void 0){this._number=void 0;return}let i=Dt(t);if(i===void 0)throw new Error("Stackup layer number must be numeric");this._number=i}get type(){return this._sxType?.value}set type(t){if(t===void 0){this._sxType=void 0;return}this._sxType=t instanceof a7?t:new a7(t)}get color(){return this._sxColor?.value}set color(t){if(t===void 0){this._sxColor=void 0;return}this._sxColor=t instanceof c7?t:new c7(t)}get thickness(){return this._sxThickness?.value}set thickness(t){if(t===void 0){this._sxThickness=void 0;return}this._sxThickness=t instanceof l7?t:new l7(t)}get material(){return this._sxMaterial?.value}set material(t){if(t===void 0){this._sxMaterial=void 0;return}this._sxMaterial=t instanceof u7?t:new u7(t)}get epsilonR(){return this._sxEpsilonR?.value}set epsilonR(t){if(t===void 0){this._sxEpsilonR=void 0;return}this._sxEpsilonR=t instanceof p7?t:new p7(t)}get lossTangent(){return this._sxLossTangent?.value}set lossTangent(t){if(t===void 0){this._sxLossTangent=void 0;return}this._sxLossTangent=t instanceof h7?t:new h7(t)}getChildren(){let t=[];return this._sxType&&t.push(this._sxType),this._sxColor&&t.push(this._sxColor),this._sxThickness&&t.push(this._sxThickness),this._sxMaterial&&t.push(this._sxMaterial),this._sxEpsilonR&&t.push(this._sxEpsilonR),this._sxLossTangent&&t.push(this._sxLossTangent),t}getString(){let t=`(layer ${re(this._name)}${this._number!==void 0?` ${this._number}`:""}`,i=this.getChildren();if(i.length===0)return`${t})`;let r=[t];for(let s of i)r.push(s.getStringIndented());return r.push(")"),r.join(`
`)}},d(Bp,"token","layer"),d(Bp,"parentToken","stackup"),Bp);z.register(alt);var Yp,d7=(Yp=class extends z{constructor(t={}){super();d(this,"token","stackup");d(this,"_layers",[]);d(this,"_sxCopperFinish");d(this,"_sxDielectricConstraints");d(this,"_sxEdgeConnector");d(this,"_sxCastellatedPads");d(this,"_sxEdgePlating");this.layers=t.layers??[],this._sxCopperFinish=t.copperFinish,this._sxDielectricConstraints=t.dielectricConstraints,this._sxEdgeConnector=t.edgeConnector,this._sxCastellatedPads=t.castellatedPads,this._sxEdgePlating=t.edgePlating}static fromSexprPrimitives(t){let{propertyMap:i,arrayPropertyMap:r}=z.parsePrimitivesToClassProperties(t,this.token);return new Yp({layers:r.layer??[],copperFinish:i.copper_finish,dielectricConstraints:i.dielectric_constraints,edgeConnector:i.edge_connector,castellatedPads:i.castellated_pads,edgePlating:i.edge_plating})}get layers(){return[...this._layers]}set layers(t){this._layers=t.map(i=>{if(!(i instanceof alt))throw new Error("Stackup layers must be StackupLayer instances");return i})}get copperFinish(){return this._sxCopperFinish?.value}set copperFinish(t){this._sxCopperFinish=t?new nlt(t):void 0}get dielectricConstraints(){return this._sxDielectricConstraints?.value}set dielectricConstraints(t){this._sxDielectricConstraints=t?new ilt(t):void 0}get edgeConnector(){return this._sxEdgeConnector?.value}set edgeConnector(t){this._sxEdgeConnector=t?new rlt(t):void 0}get castellatedPads(){return this._sxCastellatedPads?.value}set castellatedPads(t){this._sxCastellatedPads=t?new slt(t):void 0}get edgePlating(){return this._sxEdgePlating?.value}set edgePlating(t){this._sxEdgePlating=t?new olt(t):void 0}getChildren(){let t=[...this._layers],i=[this._sxCopperFinish,this._sxDielectricConstraints,this._sxEdgeConnector,this._sxCastellatedPads,this._sxEdgePlating];for(let r of i)r&&t.push(r);return t}},d(Yp,"token","stackup"),d(Yp,"parentToken","setup"),Yp);z.register(d7);var hYt={stackup:"stackup",pcbplotparams:"pcbPlotParams",pad_to_mask_clearance:"padToMaskClearance",solder_mask_min_width:"solderMaskMinWidth",pad_to_paste_clearance:"padToPasteClearance",pad_to_paste_clearance_ratio:"padToPasteClearanceRatio",last_trace_width:"lastTraceWidth",trace_clearance:"traceClearance",zone_clearance:"zoneClearance",zone_45_only:"zone45Only",trace_min:"traceMin",segment_width:"segmentWidth",edge_width:"edgeWidth",via_size:"viaSize",via_drill:"viaDrill",via_min_size:"viaMinSize",via_min_drill:"viaMinDrill",uvias_allowed:"uviasAllowed",uvia_size:"uviaSize",uvia_drill:"uviaDrill",uvia_min_size:"uviaMinSize",uvia_min_drill:"uviaMinDrill",pcb_text_width:"pcbTextWidth",pcb_text_size:"pcbTextSize",mod_edge_width:"modEdgeWidth",mod_text_size:"modTextSize",mod_text_width:"modTextWidth",pad_size:"padSize",pad_drill:"padDrill",allow_soldermask_bridges_in_footprints:"allowSoldermaskBridgesInFootprints",tenting:"tenting",aux_axis_origin:"auxAxisOrigin",grid_origin:"gridOrigin",visible_elements:"visibleElements",pad_to_paste_clearance_values:"padToPasteClearanceValues",trace_width:"traceWidth"},dYt=["stackup","padToMaskClearance","solderMaskMinWidth","padToPasteClearance","padToPasteClearanceRatio","lastTraceWidth","traceClearance","zoneClearance","zone45Only","traceMin","segmentWidth","edgeWidth","viaSize","viaDrill","viaMinSize","viaMinDrill","uviaSize","uviaDrill","uviasAllowed","uviaMinSize","uviaMinDrill","pcbTextWidth","pcbTextSize","modEdgeWidth","modTextSize","modTextWidth","padSize","padDrill","allowSoldermaskBridgesInFootprints","tenting","auxAxisOrigin","gridOrigin","visibleElements","padToPasteClearanceValues","traceWidth","pcbPlotParams"],wf,clt=(wf=class extends z{constructor(){super(...arguments);d(this,"token","setup");d(this,"_properties",{})}static fromSexprPrimitives(t){let i=new wf,{propertyMap:r}=z.parsePrimitivesToClassProperties(t,this.token);for(let[s,o]of Object.entries(r)){let a=hYt[s];if(!a)throw new Error(`Unsupported setup property token: ${s}`);i._properties[a]=o}return i}getChildren(){let t=[];for(let i of dYt){let r=this._properties[i];r&&t.push(r)}return t}setProperty(t,i){if(i){this._properties[t]=i;return}delete this._properties[t]}setNumberProperty(t,i,r){if(i===void 0){delete this._properties[t];return}this._properties[t]=new r(i)}getPropertyInstance(t,i){let r=this._properties[t];return r instanceof i?r:void 0}get stackup(){return this.getPropertyInstance("stackup",d7)}set stackup(t){if(t!==void 0&&!(t instanceof d7))throw new Error("stackup must be a Stackup instance");this.setProperty("stackup",t)}get pcbPlotParams(){return this.getPropertyInstance("pcbPlotParams",TL)}set pcbPlotParams(t){if(t!==void 0&&!(t instanceof TL))throw new Error("pcbPlotParams must be a PcbPlotParams instance");this.setProperty("pcbPlotParams",t)}get padToMaskClearance(){return this.getPropertyInstance("padToMaskClearance",DL)?.value}set padToMaskClearance(t){this.setNumberProperty("padToMaskClearance",t,DL)}get solderMaskMinWidth(){return this.getPropertyInstance("solderMaskMinWidth",jL)?.value}set solderMaskMinWidth(t){this.setNumberProperty("solderMaskMinWidth",t,jL)}get padToPasteClearance(){return this.getPropertyInstance("padToPasteClearance",BL)?.value}set padToPasteClearance(t){this.setNumberProperty("padToPasteClearance",t,BL)}get padToPasteClearanceRatio(){return this.getPropertyInstance("padToPasteClearanceRatio",YL)?.value}set padToPasteClearanceRatio(t){this.setNumberProperty("padToPasteClearanceRatio",t,YL)}get lastTraceWidth(){return this.getPropertyInstance("lastTraceWidth",XL)?.value}set lastTraceWidth(t){this.setNumberProperty("lastTraceWidth",t,XL)}get traceClearance(){return this.getPropertyInstance("traceClearance",UL)?.value}set traceClearance(t){this.setNumberProperty("traceClearance",t,UL)}get zoneClearance(){return this.getPropertyInstance("zoneClearance",VL)?.value}set zoneClearance(t){this.setNumberProperty("zoneClearance",t,VL)}get zone45Only(){return this.getPropertyInstance("zone45Only",EL)?.value}set zone45Only(t){this.setProperty("zone45Only",t===void 0?void 0:new EL(t))}get traceMin(){return this.getPropertyInstance("traceMin",GL)?.value}set traceMin(t){this.setNumberProperty("traceMin",t,GL)}get segmentWidth(){return this.getPropertyInstance("segmentWidth",HL)?.value}set segmentWidth(t){this.setNumberProperty("segmentWidth",t,HL)}get edgeWidth(){return this.getPropertyInstance("edgeWidth",WL)?.value}set edgeWidth(t){this.setNumberProperty("edgeWidth",t,WL)}get viaSize(){return this.getPropertyInstance("viaSize",qL)?.value}set viaSize(t){this.setNumberProperty("viaSize",t,qL)}get viaDrill(){return this.getPropertyInstance("viaDrill",ZL)?.value}set viaDrill(t){this.setNumberProperty("viaDrill",t,ZL)}get viaMinSize(){return this.getPropertyInstance("viaMinSize",KL)?.value}set viaMinSize(t){this.setNumberProperty("viaMinSize",t,KL)}get viaMinDrill(){return this.getPropertyInstance("viaMinDrill",JL)?.value}set viaMinDrill(t){this.setNumberProperty("viaMinDrill",t,JL)}get uviasAllowed(){return this.getPropertyInstance("uviasAllowed",IL)?.value}set uviasAllowed(t){this.setProperty("uviasAllowed",t===void 0?void 0:new IL(t))}get uviaSize(){return this.getPropertyInstance("uviaSize",QL)?.value}set uviaSize(t){this.setNumberProperty("uviaSize",t,QL)}get uviaDrill(){return this.getPropertyInstance("uviaDrill",t7)?.value}set uviaDrill(t){this.setNumberProperty("uviaDrill",t,t7)}get uviaMinSize(){return this.getPropertyInstance("uviaMinSize",e7)?.value}set uviaMinSize(t){this.setNumberProperty("uviaMinSize",t,e7)}get uviaMinDrill(){return this.getPropertyInstance("uviaMinDrill",n7)?.value}set uviaMinDrill(t){this.setNumberProperty("uviaMinDrill",t,n7)}get pcbTextWidth(){return this.getPropertyInstance("pcbTextWidth",i7)?.value}set pcbTextWidth(t){this.setNumberProperty("pcbTextWidth",t,i7)}get pcbTextSize(){return this.getPropertyInstance("pcbTextSize",AL)?.values}set pcbTextSize(t){if(t===void 0){delete this._properties.pcbTextSize;return}this.setProperty("pcbTextSize",new AL(t))}get modEdgeWidth(){return this.getPropertyInstance("modEdgeWidth",r7)?.value}set modEdgeWidth(t){this.setNumberProperty("modEdgeWidth",t,r7)}get modTextSize(){return this.getPropertyInstance("modTextSize",RL)?.values}set modTextSize(t){if(t===void 0){delete this._properties.modTextSize;return}this.setProperty("modTextSize",new RL(t))}get modTextWidth(){return this.getPropertyInstance("modTextWidth",s7)?.value}set modTextWidth(t){this.setNumberProperty("modTextWidth",t,s7)}get padSize(){return this.getPropertyInstance("padSize",OL)?.values}set padSize(t){if(t===void 0){delete this._properties.padSize;return}this.setProperty("padSize",new OL(t))}get padDrill(){return this.getPropertyInstance("padDrill",o7)?.value}set padDrill(t){this.setNumberProperty("padDrill",t,o7)}get allowSoldermaskBridgesInFootprints(){return this.getPropertyInstance("allowSoldermaskBridgesInFootprints",ML)?.value}set allowSoldermaskBridgesInFootprints(t){this.setProperty("allowSoldermaskBridgesInFootprints",t===void 0?void 0:new ML(t))}get tenting(){return this.getPropertyInstance("tenting",NL)?.sides}set tenting(t){if(t===void 0){delete this._properties.tenting;return}this.setProperty("tenting",new NL(t))}get auxAxisOrigin(){let t=this.getPropertyInstance("auxAxisOrigin",zL);if(t)return{x:t.x,y:t.y}}set auxAxisOrigin(t){if(!t){delete this._properties.auxAxisOrigin;return}this.setProperty("auxAxisOrigin",new zL(t.x,t.y))}get gridOrigin(){let t=this.getPropertyInstance("gridOrigin",$L);if(t)return{x:t.x,y:t.y}}set gridOrigin(t){if(!t){delete this._properties.gridOrigin;return}this.setProperty("gridOrigin",new $L(t.x,t.y))}get visibleElements(){return this.getPropertyInstance("visibleElements",CL)?.value}set visibleElements(t){this.setProperty("visibleElements",t===void 0?void 0:new CL(t))}get padToPasteClearanceValues(){return this.getPropertyInstance("padToPasteClearanceValues",LL)?.values}set padToPasteClearanceValues(t){if(t===void 0){delete this._properties.padToPasteClearanceValues;return}this.setProperty("padToPasteClearanceValues",new LL(t))}get traceWidth(){return this.getPropertyInstance("traceWidth",FL)?.values}set traceWidth(t){if(t===void 0){delete this._properties.traceWidth;return}this.setProperty("traceWidth",new FL(t))}},d(wf,"token","setup"),wf);z.register(clt);var qk,llt=(qk=class extends rn{constructor(){super(...arguments);d(this,"token","thickness")}},d(qk,"token","thickness"),d(qk,"parentToken","general"),qk);z.register(llt);var Xp,ult=(Xp=class extends z{constructor(t){super();d(this,"token","legacy_teardrops");d(this,"_enabled");this._enabled=t}static fromSexprPrimitives(t){let i=jt(t[0]);if(i===void 0)throw new Error("legacy_teardrops expects a string value");let r=/^(yes|true)$/iu.test(i);return new Xp(r)}get enabled(){return this._enabled}set enabled(t){this._enabled=t}getChildren(){return[]}getString(){return`(legacy_teardrops ${this._enabled?"yes":"no"})`}},d(Xp,"token","legacy_teardrops"),d(Xp,"parentToken","general"),Xp);z.register(ult);var Vot=new Set(["thickness","legacy_teardrops"]),Up,plt=(Up=class extends z{constructor(){super(...arguments);d(this,"token","general");d(this,"_sxThickness");d(this,"_sxLegacyTeardrops")}static fromSexprPrimitives(t){let i=new Up,{propertyMap:r,arrayPropertyMap:s}=z.parsePrimitivesToClassProperties(t,this.token);for(let o of Object.keys(r))if(!Vot.has(o))throw new Error(`general encountered unsupported child token "${o}"`);for(let[o,a]of Object.entries(s)){if(!Vot.has(o))throw new Error(`general encountered unsupported child token "${o}"`);if(a.length>1)throw new Error(`general encountered repeated child token "${o}"`)}return i._sxThickness=s.thickness?.[0]??r.thickness,i._sxLegacyTeardrops=s.legacy_teardrops?.[0]??r.legacy_teardrops,i}get thickness(){return this._sxThickness?.value}set thickness(t){this._sxThickness=t===void 0?void 0:new llt(t)}get legacyTeardrops(){return this._sxLegacyTeardrops?.enabled}set legacyTeardrops(t){if(t===void 0){this._sxLegacyTeardrops=void 0;return}this._sxLegacyTeardrops=new ult(t)}getChildren(){let t=[];return this._sxThickness&&t.push(this._sxThickness),this._sxLegacyTeardrops&&t.push(this._sxLegacyTeardrops),t}},d(Up,"token","general"),d(Up,"parentToken","kicad_pcb"),Up);z.register(plt);var Vp,hlt=(Vp=class extends z{constructor(t){super();d(this,"token","__pcb_layer_definition__");d(this,"_index");d(this,"_name");d(this,"_type");d(this,"_userName");this._index=t.index,this._name=t.name,this._type=t.type,this._userName=t.userName}static fromPrimitive(t){if(!Array.isArray(t)||t.length<3)throw new Error(`layers entry must be an array with at least index, name, and type: ${JSON.stringify(t)}`);let[i,r,s,o]=t,a=Dt(i),c=jt(r),l=jt(s),u=o===void 0?void 0:jt(o);if(a===void 0||c===void 0||l===void 0)throw new Error(`layers entry is missing required values: ${JSON.stringify(t)}`);return new Vp({index:a,name:c,type:l,userName:u})}get index(){return this._index}set index(t){this._index=t}get name(){return this._name}set name(t){this._name=t}get type(){return this._type}set type(t){this._type=t}get userName(){return this._userName}set userName(t){this._userName=t}getChildren(){return[]}getString(){if(this._index===void 0||this._name===void 0||this._type===void 0)return"()";let t=[String(this._index),re(this._name),this._type];return this._userName!==void 0&&t.push(re(this._userName)),`(${t.join(" ")})`}},d(Vp,"token","__pcb_layer_definition__"),d(Vp,"parentToken","layers"),Vp);z.register(hlt);var Gp,dlt=(Gp=class extends z{constructor(){super(...arguments);d(this,"token","layers");d(this,"_definitions",[])}static fromSexprPrimitives(t){let i=new Gp;return i._definitions=t.map(r=>hlt.fromPrimitive(r)),i}get definitions(){return[...this._definitions]}set definitions(t){this._definitions=[...t]}getChildren(){return[...this._definitions]}},d(Gp,"token","layers"),d(Gp,"parentToken","kicad_pcb"),Gp);z.register(dlt);var Hp,flt=(Hp=class extends z{constructor(t,i){super();d(this,"token","net");d(this,"_id");d(this,"_name");this._id=t,this._name=i}static fromSexprPrimitives(t){let i=Dt(t[0]),r=jt(t[1]);if(i===void 0||r===void 0)throw new Error("net requires numeric id and string name");return new Hp(i,r)}get id(){return this._id}set id(t){this._id=t}get name(){return this._name}set name(t){this._name=t}getChildren(){return[]}getString(){return`(net ${this._id} ${re(this._name)})`}},d(Hp,"token","net"),d(Hp,"parentToken","kicad_pcb"),Hp);z.register(flt);var Zk,f7=(Zk=class extends rn{constructor(){super(...arguments);d(this,"token","version")}},d(Zk,"token","version"),d(Zk,"parentToken","kicad_pcb"),Zk);z.register(f7);var fYt=n=>/^[A-Za-z0-9._-]+$/.test(n),Kk,m7=(Kk=class extends bo{constructor(){super(...arguments);d(this,"token","generator")}getString(){return`(generator ${fYt(this.value)?this.value:re(this.value)})`}},d(Kk,"token","generator"),d(Kk,"parentToken","kicad_pcb"),Kk);z.register(m7);var mYt=n=>/^[A-Za-z0-9._-]+$/.test(n),Jk,_7=(Jk=class extends bo{constructor(){super(...arguments);d(this,"token","generator_version")}getString(){return`(generator_version ${mYt(this.value)?this.value:re(this.value)})`}},d(Jk,"token","generator_version"),d(Jk,"parentToken","kicad_pcb"),Jk);z.register(_7);var Wp,mlt=(Wp=class extends z{constructor(t,i){super();d(this,"token","net");d(this,"_id");d(this,"_name");this._id=t,this._name=i}static fromSexprPrimitives(t){let i=Dt(t[0]);if(i===void 0)throw new Error("via net requires a numeric id");let r=t.length>1?jt(t[1]):void 0;return new Wp(i,r)}get id(){return this._id}set id(t){this._id=t}get name(){return this._name}set name(t){this._name=t}getChildren(){return[]}getString(){return this._name!==void 0?`(net ${this._id} ${re(this._name)})`:`(net ${this._id})`}},d(Wp,"token","net"),d(Wp,"parentToken","via"),Wp);z.register(mlt);var _Yt=new Set(["locked","free","remove_unused_layers","keep_end_layers"]),Pf,_lt=(Pf=class extends z{constructor(t={}){super();d(this,"token","via");d(this,"_type");d(this,"_locked",!1);d(this,"_free",!1);d(this,"_removeUnusedLayers",!1);d(this,"_keepEndLayers",!1);d(this,"_sxAt");d(this,"_size");d(this,"_drill");d(this,"_sxLayers");d(this,"_sxNet");d(this,"_sxUuid");d(this,"_sxTstamp");d(this,"_sxTeardrops");t.type!==void 0&&(this.type=t.type),t.locked!==void 0&&(this.locked=t.locked),t.free!==void 0&&(this.free=t.free),t.removeUnusedLayers!==void 0&&(this.removeUnusedLayers=t.removeUnusedLayers),t.keepEndLayers!==void 0&&(this.keepEndLayers=t.keepEndLayers),t.at!==void 0&&(this.at=t.at),t.size!==void 0&&(this.size=t.size),t.drill!==void 0&&(this.drill=t.drill),t.layers!==void 0&&(this.layers=t.layers),t.net!==void 0&&(this.net=t.net),t.uuid!==void 0&&(this.uuid=t.uuid),t.tstamp!==void 0&&(this.tstamp=t.tstamp),t.teardrops!==void 0&&(this.teardrops=t.teardrops)}static fromSexprPrimitives(t){let i=new Pf;for(let r of t){if(typeof r=="string"){i.consumeBareToken(r);continue}if(!Array.isArray(r)||r.length===0)throw new Error(`via encountered unsupported primitive child: ${JSON.stringify(r)}`);let[s,...o]=r;if(typeof s!="string")throw new Error(`via encountered child with non-string token: ${JSON.stringify(r)}`);i.consumeNode(s,o)}return i}consumeBareToken(t){if(t==="blind"||t==="micro"){this._type=t;return}if(!_Yt.has(t))throw new Error(`via encountered unsupported flag "${t}"`);switch(t){case"locked":this._locked=!0;break;case"free":this._free=!0;break;case"remove_unused_layers":this._removeUnusedLayers=!0;break;case"keep_end_layers":this._keepEndLayers=!0;break}}consumeNode(t,i){switch(t){case"type":{let r=jt(i[0]);if(r===void 0)throw new Error("via type expects a string value");this._type=r;return}case"locked":this._locked=this.parseYesNo(i);return;case"free":this._free=this.parseYesNo(i);return;case"remove_unused_layers":this._removeUnusedLayers=this.parseYesNo(i);return;case"keep_end_layers":this._keepEndLayers=this.parseYesNo(i);return;case"at":{let r=z.parsePrimitiveSexpr(["at",...i],{parentToken:this.token});if(!(r instanceof Un))throw new Error("via failed to parse at child");this._sxAt=r;return}case"size":{let r=Dt(i[0]);if(r===void 0)throw new Error("via size expects a numeric value");this._size=r;return}case"drill":{let r=Dt(i[0]);if(r===void 0)throw new Error("via drill expects a numeric value");this._drill=r;return}case"layers":{this._sxLayers=sT.fromSexprPrimitives(i);return}case"net":{this._sxNet=mlt.fromSexprPrimitives(i);return}case"teardrops":{this._sxTeardrops=Yat.fromSexprPrimitives(i);return}case"uuid":{let r=jt(i[0]);if(r===void 0)throw new Error("via uuid expects a string value");this._sxUuid=new Vt(r);return}case"tstamp":{let r=jt(i[0]);if(r===void 0)throw new Error("via tstamp expects a string value");this._sxTstamp=new En(r);return}default:throw new Error(`via encountered unsupported child token "${t}"`)}}parseYesNo(t){if(t.length===0)return!0;let i=jt(t[0]);if(i===void 0)throw new Error("Expected string when parsing via boolean child");return/^(yes|true)$/iu.test(i)}get type(){return this._type}set type(t){this._type=t}get locked(){return this._locked}set locked(t){this._locked=t}get free(){return this._free}set free(t){this._free=t}get removeUnusedLayers(){return this._removeUnusedLayers}set removeUnusedLayers(t){this._removeUnusedLayers=t}get keepEndLayers(){return this._keepEndLayers}set keepEndLayers(t){this._keepEndLayers=t}get at(){return this._sxAt}set at(t){this._sxAt=t!==void 0?Un.from(t):void 0}get size(){return this._size}set size(t){this._size=t}get drill(){return this._drill}set drill(t){this._drill=t}get layers(){return this._sxLayers}set layers(t){if(t===void 0){this._sxLayers=void 0;return}this._sxLayers=t instanceof sT?t:new sT(t)}get net(){return this._sxNet}set net(t){this._sxNet=t}get uuid(){return this._sxUuid}set uuid(t){if(t===void 0){this._sxUuid=void 0;return}this._sxUuid=t instanceof Vt?t:new Vt(t)}get teardrops(){return this._sxTeardrops}set teardrops(t){this._sxTeardrops=t}get tstamp(){return this._sxTstamp}set tstamp(t){if(t===void 0){this._sxTstamp=void 0;return}this._sxTstamp=t instanceof En?t:new En(t)}getChildren(){let t=[];return this._sxAt&&t.push(this._sxAt),this._sxLayers&&t.push(this._sxLayers),this._sxNet&&t.push(this._sxNet),this._sxUuid&&t.push(this._sxUuid),this._sxTstamp&&t.push(this._sxTstamp),this._sxTeardrops&&t.push(this._sxTeardrops),t}getString(){let t=["(via"];return this._type!==void 0&&t.push(`  (type ${this._type})`),this._locked&&t.push("  (locked)"),this._free&&t.push("  (free)"),this._removeUnusedLayers&&t.push("  (remove_unused_layers)"),this._keepEndLayers&&t.push("  (keep_end_layers)"),this._sxAt&&t.push(this._sxAt.getStringIndented()),this._size!==void 0&&t.push(`  (size ${this._size})`),this._drill!==void 0&&t.push(`  (drill ${this._drill})`),this._sxLayers&&t.push(this._sxLayers.getStringIndented()),this._sxNet&&t.push(this._sxNet.getStringIndented()),this._sxUuid&&t.push(this._sxUuid.getStringIndented()),this._sxTstamp&&t.push(this._sxTstamp.getStringIndented()),this._sxTeardrops&&t.push(this._sxTeardrops.getStringIndented()),t.push(")"),t.join(`
`)}},d(Pf,"token","via"),Pf);z.register(_lt);var kf,ylt=(kf=class extends z{constructor(t={}){super();d(this,"token","kicad_pcb");d(this,"_sxVersion");d(this,"_sxGenerator");d(this,"_sxGeneratorVersion");d(this,"_sxGeneral");d(this,"_sxPaper");d(this,"_sxTitleBlock");d(this,"_sxLayers");d(this,"_sxSetup");d(this,"_properties",[]);d(this,"_nets",[]);d(this,"_footprints",[]);d(this,"_images",[]);d(this,"_segments",[]);d(this,"_grLines",[]);d(this,"_grTexts",[]);d(this,"_grPolys",[]);d(this,"_grRects",[]);d(this,"_vias",[]);d(this,"_zones",[]);d(this,"_otherChildren",[]);t.version!==void 0&&(this.version=t.version),t.generator!==void 0&&(this.generator=t.generator),t.generatorVersion!==void 0&&(this.generatorVersion=t.generatorVersion),t.general!==void 0&&(this.general=t.general),t.paper!==void 0&&(this.paper=t.paper),t.titleBlock!==void 0&&(this.titleBlock=t.titleBlock),t.layers!==void 0&&(this.layers=t.layers),t.setup!==void 0&&(this.setup=t.setup),t.properties!==void 0&&(this.properties=t.properties),t.nets!==void 0&&(this.nets=t.nets),t.footprints!==void 0&&(this.footprints=t.footprints),t.images!==void 0&&(this.images=t.images),t.segments!==void 0&&(this.segments=t.segments),t.graphicLines!==void 0&&(this.graphicLines=t.graphicLines),t.graphicTexts!==void 0&&(this.graphicTexts=t.graphicTexts),t.graphicPolys!==void 0&&(this.graphicPolys=t.graphicPolys),t.graphicRects!==void 0&&(this.graphicRects=t.graphicRects),t.vias!==void 0&&(this.vias=t.vias),t.zones!==void 0&&(this.zones=t.zones),t.otherChildren!==void 0&&(this.otherChildren=t.otherChildren)}static fromSexprPrimitives(t){let i=new kf;for(let r of t){if(!Array.isArray(r)||r.length===0)throw new Error(`kicad_pcb encountered unsupported primitive child: ${JSON.stringify(r)}`);let s=z.parsePrimitiveSexpr(r,{parentToken:this.token});if(!(s instanceof z))throw new Error(`kicad_pcb expected SxClass child, received ${JSON.stringify(r)}`);i.consumeChild(s)}return i}consumeChild(t){if(t instanceof f7){this._sxVersion=t;return}if(t instanceof m7){this._sxGenerator=t;return}if(t instanceof _7){this._sxGeneratorVersion=t;return}if(t instanceof plt){this._sxGeneral=t;return}if(t instanceof tat){this._sxPaper=t;return}if(t instanceof Qot){this._sxTitleBlock=t;return}if(t instanceof dlt){this._sxLayers=t;return}if(t instanceof clt){this._sxSetup=t;return}if(t instanceof hat){this._properties.push(t);return}if(t instanceof flt){this._nets.push(t);return}if(t instanceof Gat){this._footprints.push(t);return}if(t instanceof eat){this._images.push(t);return}if(t instanceof sct){this._segments.push(t);return}if(t instanceof Zat){this._grLines.push(t);return}if(t instanceof Qat){this._grTexts.push(t);return}if(t instanceof ect){this._grPolys.push(t);return}if(t instanceof Kat){this._grRects.push(t);return}if(t instanceof _lt){this._vias.push(t);return}if(t instanceof oct){this._zones.push(t);return}this._otherChildren.push(t)}get version(){return this._sxVersion?.value}set version(t){this._sxVersion=t===void 0?void 0:new f7(t)}get generator(){return this._sxGenerator?.value}set generator(t){this._sxGenerator=t===void 0?void 0:new m7(t)}get generatorVersion(){return this._sxGeneratorVersion?.value}set generatorVersion(t){this._sxGeneratorVersion=t===void 0?void 0:new _7(t)}get general(){return this._sxGeneral}set general(t){this._sxGeneral=t}get paper(){return this._sxPaper}set paper(t){this._sxPaper=t}get titleBlock(){return this._sxTitleBlock}set titleBlock(t){this._sxTitleBlock=t}get layers(){return this._sxLayers}set layers(t){this._sxLayers=t}get setup(){return this._sxSetup}set setup(t){this._sxSetup=t}get properties(){return[...this._properties]}set properties(t){this._properties=[...t]}get nets(){return[...this._nets]}set nets(t){this._nets=[...t]}get footprints(){return[...this._footprints]}set footprints(t){this._footprints=[...t]}get images(){return[...this._images]}set images(t){this._images=[...t]}get segments(){return[...this._segments]}set segments(t){this._segments=[...t]}get graphicLines(){return[...this._grLines]}set graphicLines(t){this._grLines=[...t]}get graphicTexts(){return[...this._grTexts]}set graphicTexts(t){this._grTexts=[...t]}get graphicPolys(){return[...this._grPolys]}set graphicPolys(t){this._grPolys=[...t]}get graphicRects(){return[...this._grRects]}set graphicRects(t){this._grRects=[...t]}get vias(){return[...this._vias]}set vias(t){this._vias=[...t]}get zones(){return[...this._zones]}set zones(t){this._zones=[...t]}get otherChildren(){return[...this._otherChildren]}set otherChildren(t){this._otherChildren=[...t]}getChildren(){let t=[];return this._sxVersion&&t.push(this._sxVersion),this._sxGenerator&&t.push(this._sxGenerator),this._sxGeneratorVersion&&t.push(this._sxGeneratorVersion),this._sxGeneral&&t.push(this._sxGeneral),this._sxPaper&&t.push(this._sxPaper),this._sxTitleBlock&&t.push(this._sxTitleBlock),this._sxLayers&&t.push(this._sxLayers),this._sxSetup&&t.push(this._sxSetup),t.push(...this._properties),t.push(...this._nets),t.push(...this._footprints),t.push(...this._images),t.push(...this._segments),t.push(...this._grLines),t.push(...this._grTexts),t.push(...this._grPolys),t.push(...this._grRects),t.push(...this._vias),t.push(...this._zones),t.push(...this._otherChildren),t}},d(kf,"token","kicad_pcb"),kf);z.register(ylt);var glt=n=>z.parse(n),xlt=n=>{let[e]=glt(n);if(!(e instanceof _at))throw new Error(`Expected KicadSch root, got ${e?.constructor.name??"undefined"}`);return e},blt=n=>{let[e]=glt(n);if(!(e instanceof ylt))throw new Error(`Expected KicadPcb root, got ${e?.constructor.name??"undefined"}`);return e};si();si();si();si();si();si();si();si();si();si();si();si();var vo=class{constructor(n){d(this,"MAX_ITERATIONS",100);d(this,"iterationCount",0);d(this,"finished",!1);this.ctx=n}runUntilFinished(){for(this.iterationCount=0;!this.finished&&this.iterationCount<this.MAX_ITERATIONS;)this.step()||(this.finished=!0),this.iterationCount++;this.iterationCount>=this.MAX_ITERATIONS&&(this.ctx.warnings=this.ctx.warnings||[],this.ctx.warnings.push(`Stage ${this.constructor.name} exceeded maximum iterations (${this.MAX_ITERATIONS})`),this.finished=!0)}},yYt=class extends vo{step(){if(!this.ctx.kicadSch)return this.finished=!0,!1;let n=105,e=148.5,t=n,i=e,r=0,s=0;return this.ctx.k2cMatSch=eo(Kn(r,s),Cs(1/15,-1/15),Kn(-t,-i)),this.ctx.symbolUuidToComponentId=new Map,this.ctx.warnings=this.ctx.warnings||[],this.ctx.stats=this.ctx.stats||{},this.finished=!0,!1}};function wlt(n){let e=(n%360+360)%360;return e>=315||e<45?"up":e>=45&&e<135?"right":e>=135&&e<225?"down":"left"}function gYt({libId:n,reference:e,rotation:t}){let i=n.toLowerCase(),r=wlt(t);if(i.includes(":r_")||i.includes(":r")&&e.startsWith("R"))return`boxresistor_${r}`;if(i.includes(":c_")||i.includes(":c")&&e.startsWith("C"))return i.includes("polarized")||i.includes("_pol")?`capacitor_${r}`:`capacitor_${r}`;if(i.includes(":l_")||i.includes(":l")&&e.startsWith("L"))return`inductor_${r}`;if(i.includes(":d_")||i.includes("diode")||e.startsWith("D"))return i.includes("led")?`led_${r}`:i.includes("schottky")?`schottky_diode_${r}`:i.includes("zener")?`zener_diode_${r}`:`diode_${r}`;if(i.includes(":q_")||e.startsWith("Q"))return i.includes("npn")?`npn_bipolar_transistor_${r}`:i.includes("pnp")?`pnp_bipolar_transistor_${r}`:i.includes("_n_")||i.includes("nmos")?`n_channel_mosfet_transistor_${r}`:i.includes("_p_")||i.includes("pmos")?`p_channel_mosfet_transistor_${r}`:`npn_bipolar_transistor_${r}`;i.includes("gnd")||i.includes("ground")||i.includes("vcc")||i.includes("vdd")||i.includes("power")}var xYt=class extends vo{constructor(){super(...arguments);d(this,"processedSymbols",new Set)}step(){if(!this.ctx.kicadSch||!this.ctx.k2cMatSch)return this.finished=!0,!1;let e=this.ctx.kicadSch.symbols||[];for(let t of e){let i=t.uuid;!i||this.processedSymbols.has(i)||(this.processSymbol(t),this.processedSymbols.add(i))}return this.finished=!0,!1}processSymbol(e){if(!this.ctx.k2cMatSch)return;let t=this.getProperty(e,"Reference")||"U?",i=this.getProperty(e,"Value")||"",r=e.libraryId||"",s=e.at,o={x:s?.x??0,y:s?.y??0},a=oe(this.ctx.k2cMatSch,o),c=s?.angle??0,l=this.inferFtype(r,t),u=`${r}_source`;this.ctx.db.source_component.list().find(v=>v.source_component_id===u)||this.ctx.db.source_component.insert({name:r||t,ftype:l,manufacturer_part_number:i||void 0});let f=e.uuid;if(!f)return;let y=gYt({libId:r,reference:t,rotation:c}),x=this.ctx.db.schematic_component.insert({source_component_id:u,center:{x:a.x,y:a.y},size:this.estimateSize(e),...y?{symbol_name:y}:{}}).schematic_component_id;this.ctx.symbolUuidToComponentId?.set(f,x),this.createPorts(e,x),this.ctx.stats&&(this.ctx.stats.components=(this.ctx.stats.components||0)+1)}getProperty(e,t){return(e.properties||[]).find(s=>s.key===t)?.value}inferFtype(e,t){let i=e.toLowerCase();return i.includes(":r_")||t.startsWith("R")?"simple_resistor":i.includes(":c_")||t.startsWith("C")?"simple_capacitor":i.includes(":l_")||t.startsWith("L")?"simple_inductor":i.includes(":d_")||t.startsWith("D")?"simple_diode":i.includes(":led")||t.startsWith("LED")?"simple_led":i.includes(":q_")||t.startsWith("Q")?"simple_transistor":"simple_chip"}estimateSize(e){return{width:1,height:1}}createPorts(e,t){let i=e.libraryId,r=this.ctx.kicadSch?.libSymbols?.symbols?.find(a=>a.libraryId===i);if(!r)return;let s=[];if(r.pins&&Array.isArray(r.pins)&&r.pins.length>0?s.push(...r.pins):r.pins&&!Array.isArray(r.pins)&&s.push(r.pins),r.subSymbols&&Array.isArray(r.subSymbols))for(let a of r.subSymbols)a.pins&&Array.isArray(a.pins)&&a.pins.length>0?s.push(...a.pins):a.pins&&!Array.isArray(a.pins)&&s.push(a.pins);if(s.length===0)return;let o=e.at?.angle??0;for(let a of s){let c=a._sxAt;if(!c)continue;let l=o*Math.PI/180,u=Math.cos(l),p=Math.sin(l),f={x:c.x*u-c.y*p,y:c.x*p+c.y*u},y=Math.abs(this.ctx.k2cMatSch?.a||1/15),g={x:f.x*y,y:-f.y*y};this.ctx.db.schematic_port.insert({schematic_component_id:t,center:g,facing_direction:this.inferPinDirection(a,o),pin_number:a._sxNumber?.value??a.pinNumber??void 0})}}inferPinDirection(e,t){let r=(e.at?.angle??0)+t;return wlt(r)}},bYt=class extends vo{step(){if(!this.ctx.kicadSch||!this.ctx.k2cMatSch)return this.finished=!0,!1;let n=this.ctx.kicadSch.wires||[],e=Array.isArray(n)?n:[n];for(let r of e)this.processWire(r);let t=this.ctx.kicadSch.junctions||[],i=Array.isArray(t)?t:[t];for(let r of i)this.processJunction(r);return this.finished=!0,!1}processWire(n){if(!this.ctx.k2cMatSch||!n.pts)return;let e=Array.isArray(n.pts.xy)?n.pts.xy:[n.pts.xy];if(e.length<2)return;let t=[];for(let i=0;i<e.length-1;i++){let r=oe(this.ctx.k2cMatSch,{x:e[i].x,y:e[i].y}),s=oe(this.ctx.k2cMatSch,{x:e[i+1].x,y:e[i+1].y});t.push({from:r,to:s})}this.ctx.db.schematic_trace.insert({edges:t}),this.ctx.stats&&(this.ctx.stats.traces=(this.ctx.stats.traces||0)+1)}processJunction(n){if(!this.ctx.k2cMatSch||!n.at)return;let e=oe(this.ctx.k2cMatSch,{x:n.at.x,y:n.at.y});this.ctx.db.schematic_trace.insert({edges:[],junctions:[e]})}},vYt=class extends vo{step(){if(!this.ctx.kicadPcb)return this.finished=!0,!1;let n=this.calculateBoardCenter();return this.ctx.k2cMatPcb=eo(Cs(1,-1),Kn(-n.x,-n.y)),this.ctx.netNumToName=new Map,this.ctx.footprintUuidToComponentId=new Map,this.finished=!0,!1}calculateBoardCenter(){if(!this.ctx.kicadPcb)return{x:0,y:0};let n=this.ctx.kicadPcb.graphicLines||[],t=(Array.isArray(n)?n:[n]).filter(l=>{let u=l.layer;return(typeof u=="string"?[u]:u?.names||[]).join(" ").includes("Edge.Cuts")});if(t.length===0)return{x:0,y:0};let i=[],r=[];for(let l of t)l.start&&(i.push(l.start.x),r.push(l.start.y)),l.end&&(i.push(l.end.x),r.push(l.end.y));if(i.length===0||r.length===0)return{x:0,y:0};let s=Math.min(...i),o=Math.max(...i),a=Math.min(...r),c=Math.max(...r);return{x:(s+o)/2,y:(a+c)/2}}},SYt=class extends vo{step(){if(!this.ctx.kicadPcb||!this.ctx.netNumToName)return this.finished=!0,!1;let n=this.ctx.kicadPcb.nets||[],e=Array.isArray(n)?n:[n];for(let t of e){let i=t._id??t.number??t.ordinal??0,r=t._name??t.name??`Net-${i}`;this.ctx.netNumToName.set(i,r)}return this.ctx.netNumToName.has(0)||this.ctx.netNumToName.set(0,""),this.finished=!0,!1}};function wYt(n){return(n.layer?.names||[]).some(i=>i.includes("B.Cu")||i.includes("Back"))?"bottom":"top"}function Plt(n){let e=Array.isArray(n)?n:n?._layers||[];return e.includes("B.Cu")||e.includes("Back")?"bottom":"top"}function uT(n){let e=typeof n=="string"?n:n?.names?.join(" ")||"";return e.includes("B.")||e.includes("Back")?"bottom":"top"}function vlt(n,e){let t=n.fpTexts||[];return(Array.isArray(t)?t:[t]).find(s=>s.type===e)?.text}function Slt(n,e){let t=n.properties||[];return(Array.isArray(t)?t:[t]).find(s=>s.key===e)?.value}function PYt(n,e){let t=n,i=Slt(e,"Reference")||vlt(e,"reference")||"?",r=Slt(e,"Value")||vlt(e,"value")||"";return t=t.replace(/\$\{REFERENCE\}/g,i),t=t.replace(/\$\{VALUE\}/g,r),t}function kYt({ctx:n,componentId:e,padInfo:t}){if(!t.layers||t.layers.length===0)return!1;let i=`${e}_port_${t.padNumber}`;return n.db.pcb_port.insert({pcb_component_id:e,source_port_id:i,x:t.position.x,y:t.position.y,layers:t.layers}),!0}function TYt(n,e,t,i,r){if(!n.k2cMatPcb)return;let s=e.fpPads||[],o=Array.isArray(s)?s:[s];for(let a of o)EYt({ctx:n,pad:a,componentId:t,kicadComponentPos:i,componentRotation:r})}function EYt({ctx:n,pad:e,componentId:t,kicadComponentPos:i,componentRotation:r}){if(!n.k2cMatPcb)return;let s=e.at||{x:0,y:0,angle:0},o=e.padType||e.type||"thru_hole",a=e.shape||"circle",c=s.angle||0,l=-r*Math.PI/180,u=s.x*Math.cos(l)-s.y*Math.sin(l),p=s.x*Math.sin(l)+s.y*Math.cos(l),f={x:i.x+u,y:i.y+p},y=oe(n.k2cMatPcb,f),g=1,x=1;e.size&&(Array.isArray(e.size)?(g=e.size[0]||1,x=e.size[1]||1):typeof e.size=="object"&&(g=e.size._width||e.size.x||1,x=e.size._height||e.size.y||1));let v={x:g,y:x},P=e.drill,w=-r-c,k=e.number?.toString();if(k){let T={padNumber:k,padType:o,layers:o==="smd"?[Plt(e.layers||[])]:[],position:y};kYt({ctx:n,componentId:t,padInfo:T})}o==="smd"?MYt({ctx:n,pad:e,componentId:t,pos:y,size:v,shape:a}):o==="np_thru_hole"?IYt(n,e,t,y,P):CYt(n,e,t,y,v,P,a,w)}function MYt({ctx:n,pad:e,componentId:t,pos:i,size:r,shape:s}){let o=e.layers||[],a=Plt(o);if(s==="custom"){let l=e._sxPrimitives?._graphics||e.primitives||[],u=Array.isArray(l)?l:[l];for(let p of u)if(p.token==="gr_poly"||p.gr_poly||p.type==="gr_poly"){let f=p.gr_poly||p,y=f._contours||f.contours||[],g=Array.isArray(y)?y:[y],x=[];for(let v of g){let P=v.points||v.pts||[],w=Array.isArray(P)?P:[P];for(let k of w)k.x!==void 0&&k.y!==void 0&&x.push({x:k.x,y:-k.y})}if(x.length>0){let v={type:"pcb_smtpad",shape:"polygon",pcb_component_id:t,layer:a,port_hints:[e.number?.toString()],points:x.map(P=>({x:i.x+P.x,y:i.y+P.y}))};n.db.pcb_smtpad.insert(v),n.stats&&(n.stats.pads=(n.stats.pads||0)+1);return}}}let c={type:"pcb_smtpad",pcb_component_id:t,x:i.x,y:i.y,width:r.x,height:r.y,layer:a,port_hints:[e.number?.toString()]};if(s==="circle")c.shape="circle",c.radius=Math.max(r.x,r.y)/2;else if(s==="rect"||s==="roundrect"){c.shape="rect";let l=e._sxRoundrectRatio?.value??e.roundrect_rratio;if(s==="roundrect"&&l!==void 0){let p=Math.min(r.x,r.y)*l/2;c.corner_radius=p}}else c.shape="rect";n.db.pcb_smtpad.insert(c),n.stats&&(n.stats.pads=(n.stats.pads||0)+1)}function CYt(n,e,t,i,r,s,o,a=0){let c=typeof s=="object"?s?.diameter||s?.x||.8:s||.8,l="circle",u=typeof s=="object"&&s.x!==void 0&&s.y!==void 0&&s.x!==s.y,p=a%360;p<0&&(p+=360);let f=p>=45&&p<135||p>=225&&p<315,y=r.x,g=r.y;f&&o==="oval"&&(y=r.y,g=r.x);let x={pcb_component_id:t,x:i.x,y:i.y,port_hints:[e.number?.toString()]};o==="circle"?(x.shape="circle",x.hole_diameter=c,x.outer_diameter=Math.max(y,g),x.layers=["top","bottom"]):o==="oval"?(x.shape="pill",x.hole_width=c,x.hole_height=c,x.outer_width=y,x.outer_height=g,x.layers=["top","bottom"]):(o==="rect"||o==="square")&&(x.shape="pill_hole_with_rect_pad",x.hole_shape="circle",x.pad_shape="rect",x.hole_width=c,x.hole_height=c,x.rect_pad_width=y,x.rect_pad_height=g,x.layers=["top","bottom"]),n.db.pcb_plated_hole.insert(x),n.stats&&(n.stats.pads=(n.stats.pads||0)+1)}function IYt(n,e,t,i,r){let s=r?.diameter||r||1;n.db.pcb_hole.insert({x:i.x,y:i.y,hole_diameter:s,hole_shape:"circle"})}function NYt(n,e,t,i,r){if(!n.k2cMatPcb)return;AYt(n,e,t,i,r);let s=e.fpTexts||[],o=Array.isArray(s)?s:[s];for(let a of o){let c=typeof a.layer=="string"?a.layer:a.layer?.names?.join(" ")||"";if(!(c.includes("SilkS")||c.includes("Silk")))continue;let u={text:a.text,at:a._sxPosition||a.at,layer:a.layer,effects:a._sxEffects||a.effects,_sxEffects:a._sxEffects};klt(n,u,t,i,r,e)}}function AYt(n,e,t,i,r){if(!n.k2cMatPcb)return;let s=e.properties||[],o=Array.isArray(s)?s:[s];for(let a of o){if(!a.layer)continue;let c=typeof a.layer=="string"?a.layer:a.layer?.names?.join(" ")||"";if(!(c.includes("SilkS")||c.includes("Silk")))continue;let u={text:a.value,at:a._sxAt,layer:a.layer,effects:a._sxEffects||a.effects,_sxEffects:a._sxEffects};klt(n,u,t,i,r,e)}}function klt(n,e,t,i,r,s){if(!n.k2cMatPcb)return;let o=e.at,a=o?.x??0,c=o?.y??0,l=-r*Math.PI/180,u=a*Math.cos(l)-c*Math.sin(l),p=a*Math.sin(l)+c*Math.cos(l),f={x:i.x+u,y:i.y+p},y=oe(n.k2cMatPcb,f),g=uT(e.layer),x=PYt(e.text||"",s),v=e._sxEffects?._sxFont?._sxSize?._height||e.effects?.font?.size?.y||1;n.db.pcb_silkscreen_text.insert({pcb_component_id:t,font:"tscircuit2024",font_size:v*1.5,text:x,anchor_position:y,layer:g})}function yy(n,e,t){let i=t*Math.PI/180;return{x:n*Math.cos(i)-e*Math.sin(i),y:n*Math.sin(i)+e*Math.cos(i)}}function RYt(n,e,t,i,r){if(!n.k2cMatPcb)return;let s=e.fpLines||[],o=Array.isArray(s)?s:s?[s]:[];for(let p of o)OYt(n,p,t,i,r);let a=e.fpCircles||[],c=Array.isArray(a)?a:a?[a]:[];for(let p of c)LYt(n,p,t,i,r);let l=e.fpArcs||[],u=Array.isArray(l)?l:l?[l]:[];for(let p of u)zYt(n,p,t,i,r)}function OYt(n,e,t,i,r){if(!n.k2cMatPcb)return;let s=e.start||{x:0,y:0},o=e.end||{x:0,y:0},a=yy(s.x,s.y,-r),c=yy(o.x,o.y,-r),l={x:i.x+a.x,y:i.y+a.y},u={x:i.x+c.x,y:i.y+c.y},p=oe(n.k2cMatPcb,l),f=oe(n.k2cMatPcb,u),y=uT(e.layer),g=e.stroke?.width||e.width||.12;n.db.pcb_silkscreen_path.insert({pcb_component_id:t,layer:y,route:[p,f],stroke_width:g})}function LYt(n,e,t,i,r){if(!n.k2cMatPcb)return;let s=e.center||{x:0,y:0},o=e.end||{x:0,y:0},a=Math.sqrt((o.x-s.x)**2+(o.y-s.y)**2),c=yy(s.x,s.y,-r),l={x:i.x+c.x,y:i.y+c.y},u=oe(n.k2cMatPcb,l),p=uT(e.layer),f=e.stroke?.width||e.width||.12,y=16,g=[];for(let x=0;x<=y;x++){let v=x/y*2*Math.PI,P=u.x+a*Math.cos(v),w=u.y+a*Math.sin(v);g.push({x:P,y:w})}n.db.pcb_silkscreen_path.insert({pcb_component_id:t,layer:p,route:g,stroke_width:f})}function FYt(n,e,t){let i=n.x-e.x,r=n.y-e.y,s=e.x-t.x,o=e.y-t.y,a=2*(i*o-r*s);if(Math.abs(a)<1e-10)return null;let c=n.x*n.x+n.y*n.y-e.x*e.x-e.y*e.y,l=e.x*e.x+e.y*e.y-t.x*t.x-t.y*t.y,u=(c*o-l*r)/a,p=(i*l-s*c)/a,f=Math.sqrt((n.x-u)**2+(n.y-p)**2);return{center:{x:u,y:p},radius:f}}function zYt(n,e,t,i,r){if(!n.k2cMatPcb)return;let s=e.start||{x:0,y:0},o=e.mid||{x:0,y:0},a=e.end||{x:0,y:0},c=yy(s.x,s.y,-r),l=yy(o.x,o.y,-r),u=yy(a.x,a.y,-r),p={x:i.x+c.x,y:i.y+c.y},f={x:i.x+l.x,y:i.y+l.y},y={x:i.x+u.x,y:i.y+u.y},g=uT(e.layer),x=e.stroke?.width||e.width||.12,v=FYt(p,f,y);if(!v){let U=oe(n.k2cMatPcb,p),H=oe(n.k2cMatPcb,y);n.db.pcb_silkscreen_path.insert({pcb_component_id:t,layer:g,route:[U,H],stroke_width:x});return}let{center:P,radius:w}=v,k=Math.atan2(p.y-P.y,p.x-P.x),T=Math.atan2(f.y-P.y,f.x-P.x),E=Math.atan2(y.y-P.y,y.x-P.x)-k,N=T-k;for(;E>Math.PI;)E-=2*Math.PI;for(;E<-Math.PI;)E+=2*Math.PI;for(;N>Math.PI;)N-=2*Math.PI;for(;N<-Math.PI;)N+=2*Math.PI;let M=E>0;M&&N>0&&N<E||!M&&N<0&&N>E||(E=E>0?E-2*Math.PI:E+2*Math.PI);let R=Math.abs(w*E),B=Math.max(2,Math.ceil(R/.1)),G=[];for(let U=0;U<=B;U++){let H=U/B,tt=k+E*H,et={x:P.x+w*Math.cos(tt),y:P.y+w*Math.sin(tt)},mt=oe(n.k2cMatPcb,et);G.push(mt)}n.db.pcb_silkscreen_path.insert({pcb_component_id:t,layer:g,route:G,stroke_width:x})}function $Yt(n,e){if(!n.k2cMatPcb)return;let t=e.position,i={x:t?.x??0,y:t?.y??0},r=oe(n.k2cMatPcb,i),s=t?.angle??0,o=e.uuid?.value||e.tstamp?.value;if(!o)return;let c=n.db.pcb_component.insert({center:{x:r.x,y:r.y},layer:wYt(e),rotation:-s,width:0,height:0}).pcb_component_id;n.footprintUuidToComponentId?.set(o,c),TYt(n,e,c,i,s),NYt(n,e,c,i,s),RYt(n,e,c,i,s),n.stats&&(n.stats.components=(n.stats.components||0)+1)}var DYt=class extends vo{constructor(){super(...arguments);d(this,"processedFootprints",new Set)}step(){if(!this.ctx.kicadPcb||!this.ctx.k2cMatPcb)return this.finished=!0,!1;let e=this.ctx.kicadPcb.footprints||[],t=Array.isArray(e)?e:[e];for(let i of t){let r=i.uuid?.value||i.tstamp?.value;r&&(this.processedFootprints.has(r)||($Yt(this.ctx,i),this.processedFootprints.add(r)))}return this.finished=!0,!1}},jYt=class extends vo{step(){if(!this.ctx.kicadPcb||!this.ctx.k2cMatPcb||!this.ctx.netNumToName)return this.finished=!0,!1;let n=this.ctx.kicadPcb.segments||[],e=Array.isArray(n)?n:[n];for(let t of e)this.createTraceFromSegment(t);return this.finished=!0,!1}createTraceFromSegment(n){if(!this.ctx.k2cMatPcb||!this.ctx.netNumToName)return;let e=n.start||{x:0,y:0},t=n.end||{x:0,y:0},i=n.width||.2,o=(n.layer?.names||[]).join(" "),a=this.mapLayer(o),c=n.net||0,l=this.ctx.netNumToName.get(c)||"",u=oe(this.ctx.k2cMatPcb,{x:e.x,y:e.y}),p=oe(this.ctx.k2cMatPcb,{x:t.x,y:t.y}),f=[{route_type:"wire",x:u.x,y:u.y,width:i,layer:a},{route_type:"wire",x:p.x,y:p.y,width:i,layer:a}];this.ctx.db.pcb_trace.insert({route:f,pcb_port_id:void 0}),this.ctx.stats&&(this.ctx.stats.traces=(this.ctx.stats.traces||0)+1)}mapLayer(n){return n?.includes("B.Cu")||n?.includes("Back")?"bottom":"top"}},BYt=class extends vo{step(){if(!this.ctx.kicadPcb||!this.ctx.k2cMatPcb||!this.ctx.netNumToName)return this.finished=!0,!1;let n=this.ctx.kicadPcb.vias||[],e=Array.isArray(n)?n:[n];for(let t of e)this.processVia(t);return this.finished=!0,!1}processVia(n){if(!this.ctx.k2cMatPcb||!this.ctx.netNumToName)return;let e=n.at||{x:0,y:0},t=oe(this.ctx.k2cMatPcb,{x:e.x,y:e.y}),i=n.size||.8,r=n.drill||.4,s=n.net||0,o=this.ctx.netNumToName.get(s)||"",a="top",c="bottom";if(n.layers){let l=Array.isArray(n.layers)?n.layers:n.layers._layers||[];l.length>0&&(a=this.mapLayer(l[0]),l.length>1&&(c=this.mapLayer(l[l.length-1])))}this.ctx.db.pcb_via.insert({x:t.x,y:t.y,outer_diameter:i,hole_diameter:r,layers:[a,c]}),this.ctx.stats&&(this.ctx.stats.vias=(this.ctx.stats.vias||0)+1)}mapLayer(n){return n?.includes("B.Cu")||n?.includes("Back")||n?.includes("B_Cu")?"bottom":"top"}},YYt=class extends vo{step(){if(!this.ctx.kicadPcb||!this.ctx.k2cMatPcb||!this.ctx.netNumToName)return this.finished=!0,!1;let n=this.ctx.kicadPcb.zones||[],e=Array.isArray(n)?n:[n];for(let t of e)this.isZoneFilled(t)&&this.createCopperPourFromZone(t);return this.finished=!0,!1}isZoneFilled(n){if(!n._rawChildren||!Array.isArray(n._rawChildren))return!1;let e=n._rawChildren.find(i=>Array.isArray(i)&&i[0]==="fill");return e&&e[1]==="yes"?!0:n._rawChildren.some(i=>Array.isArray(i)&&i[0]==="filled_polygon")}createCopperPourFromZone(n){if(!this.ctx.k2cMatPcb||!this.ctx.netNumToName||!n._rawChildren||!Array.isArray(n._rawChildren))return;let e=this.parseZoneData(n._rawChildren),t=this.extractFilledPolygons(n._rawChildren);if(t.length===0){let o=this.extractMainPolygon(n._rawChildren);o.length>0&&t.push(o)}if(t.length===0){this.ctx.warnings&&this.ctx.warnings.push(`Zone on layer ${e.layer||"unknown"} has no valid polygon points`);return}let i=this.mapLayer(e.layer),r=e.net||0,s=this.ctx.netNumToName.get(r)||e.netName||"";for(let o of t){let a=o.map(c=>oe(this.ctx.k2cMatPcb,{x:c.x,y:c.y}));this.ctx.db.pcb_copper_pour.insert({layer:i,net_name:s,points:a,shape:"polygon"}),this.ctx.stats&&(this.ctx.stats.copper_pours=(this.ctx.stats.copper_pours||0)+1)}}parseZoneData(n){let e={};for(let t of n)if(Array.isArray(t))switch(t[0]){case"net":e.net=t[1];break;case"net_name":e.netName=t[1];break;case"layer":e.layer=t[1];break}return e}extractMainPolygon(n){let e=n.find(t=>Array.isArray(t)&&t[0]==="polygon");return e?this.extractPointsFromPolygonEntry(e):[]}extractFilledPolygons(n){let e=n.filter(i=>Array.isArray(i)&&i[0]==="filled_polygon"),t=[];for(let i of e){let r=this.extractPointsFromPolygonEntry(i);r.length>0&&t.push(r)}return t}extractPointsFromPolygonEntry(n){let e=[],t=n.find(i=>Array.isArray(i)&&i[0]==="pts");if(!t)return[];for(let i=1;i<t.length;i++){let r=t[i];if(Array.isArray(r)&&r[0]==="xy"&&r.length>=3){let s=r[1],o=r[2];typeof s=="number"&&typeof o=="number"&&e.push({x:s,y:o})}}return e}mapLayer(n){let e=typeof n=="string"?n:n?.names?.join(" ")||n?.name||"";return e.includes("B.Cu")||e.includes("Back")||e.includes("Bottom")?"bottom":"top"}},XYt=class extends vo{step(){if(!this.ctx.kicadPcb||!this.ctx.k2cMatPcb)return this.finished=!0,!1;let n=this.ctx.kicadPcb.graphicLines||[],e=Array.isArray(n)?n:[n],t=[],i=[];for(let l of e){let u=l.layer,f=(typeof u=="string"?[u]:u?.names||[]).join(" ");f.includes("Edge.Cuts")?t.push(l):f.includes("SilkS")&&i.push(l)}t.length>0&&this.createBoardOutline(t);for(let l of i)this.createSilkscreenPath(l);let r=this.ctx.kicadPcb.graphicRects||[];for(let l of r)this.processRectangle(l);let s=this.ctx.kicadPcb.graphicPolys||[],o=Array.isArray(s)?s:[s];for(let l of o)this.processPolygon(l);let a=this.ctx.kicadPcb.graphicTexts||[],c=Array.isArray(a)?a:[a];for(let l of c){let u=l.layer;(typeof u=="string"?[u]:u?.names||[]).some(f=>f.includes("SilkS")||f.includes(".Cu")||f.includes("Fab"))&&this.createSilkscreenText(l)}return this.finished=!0,!1}createBoardOutline(n){if(!this.ctx.k2cMatPcb)return;let e=n.map(o=>({start:o.start??{x:0,y:0},end:o.end??{x:0,y:0}})),t=[],i=[...e];if(i.length>0)for(t.push(i.shift());i.length>0;){let a=t[t.length-1].end,c=i.findIndex(l=>this.pointsEqualKicad(l.start,a));if(c===-1&&(c=i.findIndex(l=>this.pointsEqualKicad(l.end,a)),c!==-1)){let l=i[c];t.push({start:l.end,end:l.start}),i.splice(c,1);continue}c!==-1?t.push(i.splice(c,1)[0]):t.push(i.shift())}let r=[];for(let o of t){let a=oe(this.ctx.k2cMatPcb,{x:o.start.x,y:o.start.y}),c=r[r.length-1];(!c||!this.pointsEqual(c,a))&&r.push(a)}if(t.length>0){let o=t[t.length-1],a=oe(this.ctx.k2cMatPcb,{x:o.end.x,y:o.end.y}),c=r[0];c&&!this.pointsEqual(c,a)&&r.push(a)}let s=this.ctx.db.pcb_board.list()[0];s?(s.outline=r,s.width=this.calculateWidth(r),s.height=this.calculateHeight(r)):this.ctx.db.pcb_board.insert({outline:r,width:this.calculateWidth(r),height:this.calculateHeight(r)})}createSilkscreenPath(n){if(!this.ctx.k2cMatPcb)return;let e=n.start||{x:0,y:0},t=n.end||{x:0,y:0},i=oe(this.ctx.k2cMatPcb,{x:e.x,y:e.y}),r=oe(this.ctx.k2cMatPcb,{x:t.x,y:t.y}),s=this.mapLayer(n.layer),o=n.width||.15;this.ctx.db.pcb_silkscreen_path.insert({pcb_component_id:"",layer:s,route:[i,r],stroke_width:o})}processRectangle(n){if(!this.ctx.k2cMatPcb)return;let e={x:n._sxStart?._x??0,y:n._sxStart?._y??0},t={x:n._sxEnd?._x??0,y:n._sxEnd?._y??0},r=(n._sxLayer?._names||[]).join(" "),s=n._sxFill&&(n._sxFill.isFilled===!0||String(n._sxFill).includes("fill yes")),o=r.includes(".Cu");if(!s||!o)return;let a={x:(e.x+t.x)/2,y:(e.y+t.y)/2},c=Math.abs(t.x-e.x),l=Math.abs(t.y-e.y),u=oe(this.ctx.k2cMatPcb,a),p=this.mapLayer(n._sxLayer);this.ctx.db.pcb_smtpad.insert({pcb_component_id:"",x:u.x,y:u.y,width:c,height:l,layer:p,shape:"rect",port_hints:[]}),this.ctx.stats&&(this.ctx.stats.pads=(this.ctx.stats.pads||0)+1)}createSilkscreenText(n){if(!this.ctx.k2cMatPcb)return;let e=n.at||n._sxPosition,t=oe(this.ctx.k2cMatPcb,{x:e?.x??0,y:e?.y??0}),i=this.mapLayer(n.layer),s=(n._sxEffects?._sxFont?._sxSize?._height||n.effects?.font?.size?.y||1)*1.5;this.ctx.db.pcb_silkscreen_text.insert({pcb_component_id:"",text:n.text||n._text||"",anchor_position:t,layer:i,font_size:s,font:"tscircuit2024"})}mapLayer(n){let e=typeof n=="string"?n:n?.names?.join(" ")||"";return e.includes("B.")||e.includes("Back")?"bottom":"top"}pointsEqual(n,e){return Math.abs(n.x-e.x)<.001&&Math.abs(n.y-e.y)<.001}pointsEqualKicad(n,e){return Math.abs(n.x-e.x)<.001&&Math.abs(n.y-e.y)<.001}calculateWidth(n){if(n.length===0)return 0;let e=n.map(t=>t.x);return Math.max(...e)-Math.min(...e)}calculateHeight(n){if(n.length===0)return 0;let e=n.map(t=>t.y);return Math.max(...e)-Math.min(...e)}processPolygon(n){if(!this.ctx.k2cMatPcb)return;let t=(n._sxLayer?._names||[]).join(" "),i=n._sxFill?.filled===!0,r=t.includes(".Cu");if(!i||!r)return;let s=n._sxPts?.points||[],o=[];for(let l of s)if(l.token==="xy")o.push({x:l.x,y:l.y});else if(l.token==="arc"){let u=this.convertArcToPoints({x:l._sxStart?._x,y:l._sxStart?._y},{x:l._sxMid?._x,y:l._sxMid?._y},{x:l._sxEnd?._x,y:l._sxEnd?._y});o.push(...u)}if(o.length<3)return;let a=o.map(l=>oe(this.ctx.k2cMatPcb,l)),c=this.mapLayer(n._sxLayer);this.ctx.db.pcb_smtpad.insert({pcb_component_id:"",shape:"polygon",points:a,layer:c,port_hints:[]}),this.ctx.stats&&(this.ctx.stats.pads=(this.ctx.stats.pads||0)+1)}convertArcToPoints(n,e,t,i=8){let r=[],{center:s,radius:o}=this.calculateArcCenter(n,e,t);if(!s||o===0)return[n,t];let a=Math.atan2(n.y-s.y,n.x-s.x),c=Math.atan2(t.y-s.y,t.x-s.x),l=Math.atan2(e.y-s.y,e.x-s.x),u=c-a,p=l-a,f=c-a,y=(p+Math.PI)%(2*Math.PI)-Math.PI,g=(f+Math.PI)%(2*Math.PI)-Math.PI;(g>0&&(y<0||y>g)||g<0&&(y>0||y<g))&&(u=u-Math.sign(u)*2*Math.PI);for(let x=1;x<i;x++){let v=x/i,P=a+u*v;r.push({x:s.x+o*Math.cos(P),y:s.y+o*Math.sin(P)})}return r.push(t),r}calculateArcCenter(n,e,t){let i=n.x,r=n.y,s=e.x,o=e.y,a=t.x,c=t.y,l=2*(i*(o-c)+s*(c-r)+a*(r-o));if(Math.abs(l)<1e-10)return{center:null,radius:0};let u=((i*i+r*r)*(o-c)+(s*s+o*o)*(c-r)+(a*a+c*c)*(r-o))/l,p=((i*i+r*r)*(a-s)+(s*s+o*o)*(i-a)+(a*a+c*c)*(s-i))/l,f=Math.sqrt((i-u)**2+(r-p)**2);return{center:{x:u,y:p},radius:f}}},UYt=class extends vo{constructor(){super(...arguments);d(this,"processedNets",new Set)}step(){if(!this.ctx.kicadPcb||!this.ctx.netNumToName)return this.finished=!0,!1;let e=new Map,t=this.ctx.kicadPcb.footprints||[],i=Array.isArray(t)?t:[t];for(let r of i)this.processFootprintPads(r,e);for(let[r,s]of e.entries())s.length<2||this.processedNets.has(r)||(this.createSourceTrace(r,s),this.processedNets.add(r));return this.finished=!0,!1}processFootprintPads(e,t){let i=e.uuid?.value||e.tstamp?.value;if(!i)return;let r=this.ctx.footprintUuidToComponentId?.get(i);if(!r)return;let s=e.fpPads||[],o=Array.isArray(s)?s:[s];for(let a of o){let c=a.number?.toString();if(!c)continue;let l=this.getPadNet(a);if(l==null||l===0)continue;let u=this.getOrCreateSourcePort(r,c,e);t.has(l)||t.set(l,[]),t.get(l).push({componentId:r,padNumber:c,sourcePortId:u})}}getPadNet(e){let t=e._sxNet||e.net;return t?typeof t=="number"?t:typeof t=="object"?t._id??t.number??t.ordinal??null:null:null}getOrCreateSourcePort(e,t,i){let r=`${e}_port_${t}`;if(!this.ctx.db.source_port.list().find(o=>o.source_port_id===r)){let o=this.getFootprintReference(i);this.ctx.db.source_port.insert({source_port_id:r,source_component_id:e,name:`${o||"U"}.${t}`,pin_number:parseInt(t,10)||void 0})}return r}getFootprintReference(e){let t=e.properties||[],i=Array.isArray(t)?t:[t];for(let o of i)if(o.key==="Reference"||o.name==="Reference")return o.value;let r=e.fpTexts||[],s=Array.isArray(r)?r:[r];for(let o of s)if(o.type==="reference")return o.text}createSourceTrace(e,t){let i=this.ctx.netNumToName?.get(e)||`Net-${e}`;this.ctx.db.source_trace.insert({connected_source_port_ids:t.map(r=>r.sourcePortId),connected_source_net_ids:[],display_name:i}),this.ctx.stats&&(this.ctx.stats.traces=(this.ctx.stats.traces||0)+1)}},Tlt=class{constructor(){d(this,"fsMap",{});d(this,"ctx");d(this,"currentStageIndex",0);d(this,"pipeline")}get currentStage(){return this.pipeline?.[this.currentStageIndex]}addFile(n,e){this.fsMap[n]=e}_findFileWithExtension(n){let e=Object.keys(this.fsMap).filter(t=>t.endsWith(n));if(e.length>1)throw new Error(`Expected 0 or 1 file with extension ${n}, got ${e.length}. Files: ${e.join(", ")}`);return e[0]??null}initializePipeline(){let n=this._findFileWithExtension(".kicad_pcb"),e=this._findFileWithExtension(".kicad_sch");this.ctx={db:Ke([]),kicadPcb:n?blt(this.fsMap[n]):void 0,kicadSch:e?xlt(this.fsMap[e]):void 0,warnings:[],stats:{}},this.pipeline=[],this.ctx.kicadSch&&this.pipeline.push(new yYt(this.ctx),new xYt(this.ctx),new bYt(this.ctx)),this.ctx.kicadPcb&&this.pipeline.push(new vYt(this.ctx),new SYt(this.ctx),new DYt(this.ctx),new jYt(this.ctx),new BYt(this.ctx),new YYt(this.ctx),new XYt(this.ctx),new UYt(this.ctx))}step(){return this.pipeline||this.initializePipeline(),this.currentStage?((!this.currentStage.step()||this.currentStage.finished)&&this.currentStageIndex++,this.currentStageIndex<(this.pipeline?.length||0)):!1}runUntilFinished(){this.pipeline||this.initializePipeline();for(let n of this.pipeline||[])n.runUntilFinished()}getOutput(){this.ctx||(this.initializePipeline(),this.runUntilFinished());let n=[],e=["source_component","source_port","source_trace","schematic_component","schematic_port","schematic_trace","schematic_net_label","pcb_component","pcb_port","pcb_smtpad","pcb_plated_hole","pcb_hole","pcb_trace","pcb_via","pcb_copper_pour","pcb_board","pcb_silkscreen_text","pcb_silkscreen_path"];for(let t of e){let i=this.ctx.db[t];if(i&&typeof i.list=="function"){let r=i.list();r&&Array.isArray(r)&&n.push(...r)}}return n}getOutputString(){return JSON.stringify(this.getOutput(),null,2)}getWarnings(){return this.ctx?.warnings||[]}getStats(){return this.ctx?.stats||{}}};var gy=(0,Elt.default)("tsci:eval:import-local-file"),D0=async(n,e,t=0)=>{gy("importLocalFile called with:",{importName:n});let{fsMap:i,preSuppliedImports:r,importStack:s,currentlyImporting:o}=e,a=_P(n,i,void 0,{tsConfig:e.tsConfig});if(gy("fsPath:",a),o.has(a)){let l=s.indexOf(a),u=l>=0?s.slice(l).concat(a):[...s,a];throw new Error(`Circular dependency detected while importing "${a}". The following import chain forms a cycle:

${u.join(" -> ")}`)}if(!e.fsMap[a])throw gy("fsPath not found in fsMap:",a),new Error(`File "${a}" not found`);let c=i[a];gy("fileContent:",c?.slice(0,100)),o.add(a),s.push(a);try{if(a.endsWith(".json")){let l=JSON.parse(c);r[a]={__esModule:!0,default:l}}else if(a.endsWith(".kicad_pcb")){let l=new Tlt;l.addFile(a,c),l.runUntilFinished();let u=l.getOutput();r[a]={__esModule:!0,circuitJson:u}}else if($it(a)){let l;if(c==="__STATIC_ASSET__")l=`${e.circuit.platform?.projectBaseUrl??""}/${a.startsWith("./")?a.slice(2):a}`;else{let u=new Blob([c],{type:a.endsWith(".kicad_mod")?"text/plain":"application/octet-stream"});l=URL.createObjectURL(u)}r[a]={__esModule:!0,default:l}}else if(a.endsWith(".tsx")||a.endsWith(".ts")){let l=yP(c);for(let u of l)r[u]||await Ef(u,e,t+1,{cwd:co(a)});try{let u=N0(c,a);gy("evalCompiledJs called with:",{code:u.slice(0,100),dirname:co(a)});let p=Rd(u,r,co(a));gy("importRunResult:",{fsPath:a,importRunResult:p}),r[a]=p.exports}catch(u){throw new Error(`Eval compiled js error for "${n}": ${u.message}`)}}else if(a.endsWith(".js"))r[a]=Rd(N0(c,a),r,co(a)).exports;else throw new Error(`Unsupported file extension "${a.split(".").pop()}" for "${a}"`)}finally{s.pop(),o.delete(a)}};async function Mlt(n,e,t=0){let{preSuppliedImports:i}=e,r=n.replace("@tsci/","").replace(".","/"),{cjs:s,error:o}=await globalThis.fetch(`${e.cjsRegistryUrl}/${r}`).then(async a=>({cjs:await a.text(),error:null})).catch(a=>({error:a,cjs:null}));if(o){console.error("Error fetching import",n,o);return}try{i[n]=Rd(s,i).exports}catch(a){console.error("Error importing snippet",a)}}function VYt(n,e,t){return{fsMap:e,extensions:[".js",".jsx",".ts",".tsx",".json"],basePath:t,modulePath:n}}function GYt(n,e){let t=`${n}/package.json`;if(!e.fsMap[t])return null;try{return JSON.parse(e.fsMap[t])}catch{return null}}function k7(n,e){if(e.fsMap[n])return n;for(let t of e.extensions){let i=n.replace(/\.js$|\.jsx$/,"")+t;if(e.fsMap[i])return i}return null}function P7(n,e,t){let i=`${n}/${e.replace(/^\.\//,"")}`;return k7(i,t)}function HYt(n,e,t,i){if(!e.exports)return null;let r=e.exports["."];if(t===""&&r&&typeof r=="string"){let a=P7(n,r,i);if(a)return a}let s=t?e.exports[`./${t}`]:null;if(s&&typeof s=="string"){let a=P7(n,s,i);if(a)return a}let o=e.exports.import;if(t===""&&o&&typeof o=="string"){let a=P7(n,o,i);if(a)return a}return null}function WYt(n,e,t){let i=e.module||e.main||"index.js",r=`${n}/${i}`;return k7(r,t)}function qYt(n,e,t){if(!e){for(let s of t.extensions){let o=`${n}/index${s}`;if(t.fsMap[o])return o}return null}let i=`${n}/${e}`,r=k7(i,t);if(r)return r;for(let s of t.extensions){let o=`${i}/index${s}`;if(t.fsMap[o])return o}return null}function Clt(n,e){let t=e.modulePath.split("/"),i=t[0].startsWith("@")?t.slice(0,2).join("/"):t[0],r=t.slice(i.includes("/")?2:1).join("/"),s=`${n=="."?"":`${n}/`}node_modules/${i}`,o=GYt(s,e);if(o){let l=HYt(s,o,r,e);if(l)return l;let u=WYt(s,o,e);if(u)return u}let a=qYt(s,r,e);if(a)return a;let c=co(n);return c&&c!==n?Clt(c,e):null}function pT(n,e,t){let i=VYt(n,e,t);return Clt(i.basePath,i)}var Ilt=Gt(Mn(),1),hT=(0,Ilt.default)("tsci:eval:import-node-module"),T7=async(n,e,t=0)=>{let{preSuppliedImports:i}=e;if(i[n])return;let r=pT(n,e.fsMap,"");if(!r){let o=e.circuit?.platform;if(o?.nodeModulesResolver){hT(`Attempting to resolve "${n}" using nodeModulesResolver`);try{let a=await o.nodeModulesResolver(n);if(a){hT(`Successfully resolved "${n}" via nodeModulesResolver`);let c=`node_modules/${n}.ts`;e.fsMap[c]=a,await D0(c,e,t),i[n]=i[c];let l=c.replace(/^node_modules\//,"");i[l]=i[c];return}hT(`nodeModulesResolver returned null for "${n}"`)}catch(a){hT(`nodeModulesResolver failed for "${n}":`,a)}}throw new Error(`Node module "${n}" not found`)}await D0(r,e,t),i[n]=i[r];let s=r.replace(/^node_modules\//,"");if(i[s]=i[r],r.endsWith("/index.tsx")||r.endsWith("/index.ts")||r.endsWith("/index.js")){let a=r.replace(/\/index\.(tsx?|js)$/,"").replace(/^node_modules\//,"");if(i[a]=i[r],a.startsWith("@")){let c=a.split("/");if(c.length>=2){let l=`${c[0]}/${c[1]}`;i[l]=i[r]}}}};var Nlt=Gt(Mn(),1);var ZYt=(0,Nlt.default)("tsci:eval:import-npm-package");function KYt(n){let e="https://cdn.jsdelivr.net/npm/";return n.startsWith(e)?n.substring(e.length).replace(/\/\+esm$/,""):n}async function E7(n,e,t=0){ZYt(`importing npm package: ${n}`);let{preSuppliedImports:i}=e;if(i[n])return;let r=`https://cdn.jsdelivr.net/npm/${n}/+esm`,s,{content:o,error:a}=await globalThis.fetch(r).then(async f=>{if(s=f.url,!f.ok)throw new Error(`Could not fetch "${n}" from jsdelivr: ${f.statusText}

${e.logger.stringifyLogs()}`);return{content:await f.text(),error:null}}).catch(f=>({error:f,content:null}));if(a)throw console.error("Error fetching npm import",n,a),a;let c=KYt(s),l=co(c),u=yP(o);for(let f of u)i[f]||await Ef(f,e,t+1,{cwd:l});let p=N0(o,c||n);try{let f=Rd(p,i,l).exports;i[n]=f,i[c]=f,i[s]=f}catch(f){throw new Error(`Eval npm package error for "${n}": ${f.message}

${e.logger.stringifyLogs()}`)}}var Rlt=Gt(Mn(),1),Alt=(0,Rlt.default)("tsci:eval:import-eval-path");async function Ef(n,e,t=0,i={}){Alt("importEvalPath called with:",{importName:n,depth:t,opts:i}),e.logger.info(`importEvalPath("${n}", {cwd: "${i.cwd}", depth: ${t}})`),Alt(`${"  ".repeat(t)}\u27A1\uFE0F`,n);let{preSuppliedImports:r}=e;if(r[n]){e.logger.info(`Import "${n}" in preSuppliedImports[1]`);return}if(n.startsWith("./")&&r[n.slice(2)]){e.logger.info(`Import "${n}" in preSuppliedImports[2]`);return}if(t>30)throw new Error(`Max depth for imports reached (30) Import Path: ${e.importStack.join(" -> ")}`);if(n.startsWith("/npm/")){let c=n.replace(/^\/npm\//,"").replace(/\/\+esm$/,"");e.logger.info(`importNpmPackage("${c}")`),await E7(c,e,t);let l=r[c];l&&(r[n]=l);return}let s=H1(n,e.fsMap,i.cwd,{tsConfig:e.tsConfig});if(s){e.logger.info(`importLocalFile("${s}")`),await D0(s,e,t),n!==s&&(r[n]=r[s]);return}let o=e.tsConfig??G1(e.fsMap);if(!e.tsConfig&&o&&(e.tsConfig=o),zit(n,o))throw new Error(`Import "${n}" matches a tsconfig path alias but could not be resolved to an existing file${i.cwd?` from directory "${i.cwd}"`:""}

${e.logger.stringifyLogs()}`);let a=pT(n,e.fsMap,i.cwd||"");if(a)return e.logger.info(`resolvedNodeModulePath="${a}"`),e.logger.info(`importNodeModule("${n}")`),T7(n,e,t);if(!n.startsWith(".")&&!n.startsWith("/")&&!n.startsWith("@tsci/")&&e.circuit?.platform?.nodeModulesResolver){e.logger.info(`importNodeModule("${n}") via nodeModulesResolver`);try{await T7(n,e,t);return}catch{e.logger.info(`nodeModulesResolver failed for "${n}", falling back to npm CDN`)}}if(n.startsWith("@tsci/"))return e.logger.info(`importSnippet("${n}")`),Mlt(n,e,t);if(!n.startsWith(".")&&!n.startsWith("/"))return e.logger.info(`importNpmPackage("${n}")`),E7(n,e,t);throw new Error(`Unresolved import "${n}" ${i.cwd?`from directory "${i.cwd}"`:""}

${e.logger.stringifyLogs()}`)}var Olt=Gt(Mn(),1),JYt=(0,Olt.default)("tsci:eval:setupDefaultEntrypointIfNeeded"),Llt=n=>{if(!n.entrypoint&&!n.mainComponentPath)if("index.tsx"in n.fsMap)n.mainComponentPath="index.tsx";else if("index.ts"in n.fsMap)n.mainComponentPath="index.ts";else if(Object.keys(n.fsMap).filter(e=>e.endsWith(".tsx")).length===1)n.mainComponentPath=Object.keys(n.fsMap)[0];else if("tscircuit.config.json"in n.fsMap){let e=n.fsMap["tscircuit.config.json"];try{let t=JSON.parse(e);t.mainEntrypoint&&(n.entrypoint=t.mainEntrypoint)}catch(t){console.warn("Failed to parse tscircuit.config.json:",t)}}else throw new Error("Either entrypoint or mainComponentPath must be provided (no index file, could not infer entrypoint)");if(!n.entrypoint&&n.mainComponentPath){if(n.entrypoint="entrypoint.tsx",!n.fsMap[_P(n.mainComponentPath,n.fsMap)])throw new Error(`Main component path "${n.mainComponentPath}" not found in fsMap. Available paths: ${Object.keys(n.fsMap).join(", ")}`);n.fsMap[n.entrypoint]=`
     import * as UserComponents from "./${n.mainComponentPath}";
          
      ${n.mainComponentName?`
        const ComponentToRender = UserComponents["${n.mainComponentName}"]
        `:`const ComponentToRender = UserComponents.default || 
          Object.entries(UserComponents)
          .filter(([name]) => !name.startsWith("use"))
          .map(([_, component]) => component)[0] || (() => null);`}

           ${JYt.enabled?`
     console.log({ UserComponents })
     console.log("ComponentToRender " + ComponentToRender.toString(),  { ComponentToRender })
     `:""}

      circuit.add(       
          <ComponentToRender ${n.mainComponentProps?`{...${JSON.stringify(n.mainComponentProps,null,2)}}`:""} /> 
      );
`}!n.name&&n.mainComponentName&&(n.name=n.mainComponentName)};var M7=(n,e)=>{if(n instanceof Error&&e&&n.message.includes("RootCircuit has no children")&&!n.message.includes('"entrypoint":')){let t=e.startsWith("./")?e.slice(2):e;n.message=`${n.message}. "entrypoint": "${t}" is set in the runner configuration, entrypoints must contain "circuit.add(...)", you might be looking to use mainComponentPath instead if your file exports a component.`}return n};var Flt=()=>{let n=new Map,e=0;function t(r,s){let o=++e;return new Promise((a,c)=>{n.set(o,{resolve:a,reject:c});let l,u=s?{...s}:{};if(typeof r=="string"||r instanceof URL?l=r.toString():(l=r.url,u={...u,method:r.method,headers:(()=>{let p={};return r.headers.forEach((f,y)=>{p[y]=f}),p})(),body:r.bodyUsed?void 0:r.body}),u.headers instanceof Headers){let p={};u.headers.forEach((f,y)=>{p[y]=f}),u.headers=p}globalThis.postMessage({type:"worker_fetch",requestId:o,input:l,init:u})})}function i(r){let s=r.data;if(s){if(s.type==="override_global_fetch"){globalThis.fetch=t;return}if(s.type==="worker_fetch_result"){let o=n.get(s.requestId);if(!o)return;if(n.delete(s.requestId),s.success){let a=new Response(s.response.body,{status:s.response.status,statusText:s.response.statusText,headers:s.response.headers});o.resolve(a)}else{let a=new Error(s.error.message);s.error.name&&(a.name=s.error.name),s.error.stack&&(a.stack=s.error.stack),o.reject(a)}}}}globalThis.addEventListener("message",i)};function C7(n,e,t){let i=e.split("."),r=n;for(let s=0;s<i.length;s++){let o=i[s];s===i.length-1?r[o]=t:((!Object.prototype.hasOwnProperty.call(r,o)||typeof r[o]!="object"||r[o]===null||Array.isArray(r[o]))&&(r[o]={}),r=r[o])}}globalThis.React=A7;Flt();globalThis.global=globalThis.global||globalThis;var fn=null,dT,Ci={snippetsApiBaseUrl:"https://registry-api.tscircuit.com",cjsRegistryUrl:"https://cjs.tscircuit.com",verbose:!1,platform:void 0,projectConfig:void 0},ia={};function N7(n){if(!n||typeof n!="object")return n;if(n.__isSerializedReactElement){let e=QYt(n.props);return A7.createElement(n.type,e)}return n}function QYt(n){if(!n||typeof n!="object")return n;let e={};for(let[t,i]of Object.entries(n))t==="children"?Array.isArray(i)?e.children=i.map(N7):e.children=N7(i):e[t]=i;return e}function I7(n){for(let e in ia)for(let t of ia[e])n.on(e,t)}var tXt={setSnippetsApiBaseUrl:async n=>{Ci.snippetsApiBaseUrl=n},setPlatformConfig:async n=>{throw new Error("setPlatformConfig can't be used against the webworker directly due to comlink limitations, use setPlatformConfigProperty instead (or a wrapper)")},setPlatformConfigProperty:async(n,e)=>{Ci.platform||(Ci.platform={}),C7(Ci.platform,n,e)},setProjectConfig:async n=>{throw new Error("setProjectConfig can't be used against the webworker directly due to comlink limitations, use setProjectConfigProperty instead (or a wrapper)")},setProjectConfigProperty:async(n,e)=>{Ci.projectConfig||(Ci.projectConfig={}),C7(Ci.projectConfig,n,e)},enableDebug:async n=>{dT=n,fn&&fn.circuit.enableDebug?.(n)},version:async()=>"0.0.0",async executeWithFsMap(n){Ci.verbose&&console.log("[Worker] executeWithFsMap called with:",{entrypoint:n.entrypoint,fsMapKeys:Object.keys(n.fsMap),name:n.name}),Llt(n);let e=n.entrypoint;if(fn=fP(Ci,{name:n.name,platform:Ci.platform,projectConfig:Ci.projectConfig,debugNamespace:dT}),I7(fn.circuit),fn.entrypoint=e,fn.fsMap=Lit(n.fsMap),fn.tsConfig=G1(fn.fsMap),!fn.fsMap[e])throw new Error(`Entrypoint "${n.entrypoint}" not found`);globalThis.__tscircuit_circuit=fn.circuit,e.startsWith("./")||(e=`./${e}`),await Ef(e,fn)},async execute(n,e={}){Ci.verbose&&console.log("[Worker] execute called with code length:",n.length),fn=fP(Ci,{...e,platform:Ci.platform,projectConfig:Ci.projectConfig,debugNamespace:dT}),I7(fn.circuit),fn.fsMap["entrypoint.tsx"]=n,fn.tsConfig=G1(fn.fsMap),globalThis.__tscircuit_circuit=fn.circuit,await Ef("./entrypoint.tsx",fn)},async executeComponent(n,e={}){Ci.verbose&&console.log("[Worker] executeComponent called"),fn=fP(Ci,{...e,platform:Ci.platform,projectConfig:Ci.projectConfig,debugNamespace:dT}),I7(fn.circuit),globalThis.__tscircuit_circuit=fn.circuit,fn.tsConfig=null;let t;typeof n=="function"?t=n():n?.__isSerializedReactElement?t=N7(n):t=n,fn.circuit.add(t)},on:(n,e)=>{ia[n]??(ia[n]=[]),ia[n].push(e),fn?.circuit.on(n,e)},renderUntilSettled:async()=>{if(!fn)throw new Error("No circuit has been created");try{await fn.circuit.renderUntilSettled()}catch(n){throw M7(n,fn.entrypoint)}},getCircuitJson:async()=>{if(!fn)throw new Error("No circuit has been created");try{return fn.circuit.getCircuitJson()}catch(n){throw M7(n,fn.entrypoint)}},clearEventListeners:()=>{if(fn?.circuit)for(let n in ia)for(let e of ia[n]){let t=fn.circuit;t.removeListener&&t.removeListener(n,e)}for(let n in ia)delete ia[n]},kill:async()=>{}};Ax(tXt);
/*! Bundled license information:

react/cjs/react.production.js:
  (**
   * @license React
   * react.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

scheduler/cjs/scheduler.production.js:
  (**
   * @license React
   * scheduler.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

react-reconciler/cjs/react-reconciler.production.js:
  (**
   * @license React
   * react-reconciler.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

react-reconciler/cjs/react-reconciler-constants.production.js:
  (**
   * @license React
   * react-reconciler-constants.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

svgson/dist/svgson.umd.js:
is-buffer/index.js:
  (*!
   * Determine if an object is a Buffer
   *
   * @author   Feross Aboukhadijeh <https://feross.org>
   * @license  MIT
   *)

is-whitespace/index.js:
  (*!
   * is-whitespace <https://github.com/jonschlinkert/is-whitespace>
   *
   * Copyright (c) 2014-2015, Jon Schlinkert.
   * Licensed under the MIT License.
   *)

is-extendable/index.js:
  (*!
   * is-extendable <https://github.com/jonschlinkert/is-extendable>
   *
   * Copyright (c) 2015, Jon Schlinkert.
   * Licensed under the MIT License.
   *)

condense-newlines/index.js:
  (*!
   * condense-newlines <https://github.com/jonschlinkert/condense-newlines>
   *
   * Copyright (c) 2014 Jon Schlinkert, contributors.
   * Licensed under the MIT License
   *)

pretty/index.js:
  (*!
   * pretty <https://github.com/jonschlinkert/pretty>
   *
   * Copyright (c) 2013-2015, 2017, Jon Schlinkert.
   * Released under the MIT License.
   *)

react/cjs/react-jsx-runtime.production.js:
  (**
   * @license React
   * react-jsx-runtime.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

comlink/dist/esm/comlink.mjs:
  (**
   * @license
   * Copyright 2019 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   *)
*/
